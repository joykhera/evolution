{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2578193716744266, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.503942574899663, "policy_loss": -0.019200901946585094, "vf_loss": 7.520739770566345, "vf_explained_var": 0.025394460700807118, "kl": 0.012018536491487077, "entropy": 1.6008232410622651, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1231308931948016, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.033926806121907, "policy_loss": -0.02058054597250053, "vf_loss": 6.052443178873213, "vf_explained_var": 0.024126143367202195, "kl": 0.010320830141396198, "entropy": 1.6008950178585355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.72458335072929, "num_env_steps_trained_throughput_per_sec": 77.72458335072929, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 51463.779, "restore_workers_time_ms": 0.021, "training_step_time_ms": 51463.716, "sample_time_ms": 3881.923, "learn_time_ms": 47553.322, "learn_throughput": 84.116, "synch_weights_time_ms": 13.814}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "fed12_00000", "date": "2024-08-21_18-05-23", "timestamp": 1724243723, "time_this_iter_s": 51.50386118888855, "time_total_s": 51.50386118888855, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f1b4a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 51.50386118888855, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 30.487837837837837, "ram_util_percent": 83.27702702702702}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3753475916133358, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.921471134821574, "policy_loss": -0.020992991158359304, "vf_loss": 5.939973389913165, "vf_explained_var": 0.10093622053111041, "kl": 0.01245364817228937, "entropy": 1.58918175583794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8253491187852526, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.6973728264450396, "policy_loss": -0.021905787733122312, "vf_loss": 3.7173871153876896, "vf_explained_var": 0.11421474467509637, "kl": 0.009457524416465609, "entropy": 1.5925451795890848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.36864806757207, "num_env_steps_trained_throughput_per_sec": 80.36864806757207, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 50617.219, "restore_workers_time_ms": 0.018, "training_step_time_ms": 50617.162, "sample_time_ms": 3060.391, "learn_time_ms": 47533.551, "learn_throughput": 84.151, "synch_weights_time_ms": 14.184}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "fed12_00000", "date": "2024-08-21_18-06-15", "timestamp": 1724243775, "time_this_iter_s": 49.81635499000549, "time_total_s": 101.32021617889404, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f310820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 101.32021617889404, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 30.574324324324323, "ram_util_percent": 83.18513513513513}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.484249797226891, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.925684511346161, "policy_loss": -0.02753555578224006, "vf_loss": 5.950642005476372, "vf_explained_var": 0.2011867988677252, "kl": 0.012890298542487756, "entropy": 1.5745362139883496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6308392638567264, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.3801831529254005, "policy_loss": -0.019322997097310328, "vf_loss": 3.397733433032162, "vf_explained_var": 0.11336400647642751, "kl": 0.008863603481936648, "entropy": 1.5874082279583765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.57246743297512, "num_env_steps_trained_throughput_per_sec": 81.57246743297512, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 50090.201, "restore_workers_time_ms": 0.018, "training_step_time_ms": 50090.141, "sample_time_ms": 2765.558, "learn_time_ms": 47303.795, "learn_throughput": 84.56, "synch_weights_time_ms": 13.811}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "fed12_00000", "date": "2024-08-21_18-07-04", "timestamp": 1724243824, "time_this_iter_s": 49.07618308067322, "time_total_s": 150.39639925956726, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f320af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 150.39639925956726, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 27.324637681159423, "ram_util_percent": 83.15942028985505}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.070262486814822, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.158047509067273, "policy_loss": -0.02243815421658967, "vf_loss": 6.178004718709875, "vf_explained_var": 0.2634776736693408, "kl": 0.012404726368187872, "entropy": 1.560976202904232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.535970305497684, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.340835450629078, "policy_loss": -0.01811787516652316, "vf_loss": 2.3574358426704607, "vf_explained_var": 0.12196713130940835, "kl": 0.007587404642746877, "entropy": 1.5819432560728972, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.93616839049398, "num_env_steps_trained_throughput_per_sec": 81.93616839049398, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 49772.275, "restore_workers_time_ms": 0.019, "training_step_time_ms": 49772.217, "sample_time_ms": 2579.473, "learn_time_ms": 47172.681, "learn_throughput": 84.795, "synch_weights_time_ms": 14.275}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "fed12_00000", "date": "2024-08-21_18-07-53", "timestamp": 1724243873, "time_this_iter_s": 48.868305921554565, "time_total_s": 199.26470518112183, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f320280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 199.26470518112183, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 24.868115942028986, "ram_util_percent": 82.90579710144927}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.385090609549215, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.071426313137882, "policy_loss": -0.024996929299874755, "vf_loss": 6.093721310549943, "vf_explained_var": 0.37228241209630614, "kl": 0.01350970889402248, "entropy": 1.5551168442403198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.849320983003687, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.0057477578914984, "policy_loss": -0.024914521575171166, "vf_loss": 2.0288126345034, "vf_explained_var": 0.1412616565744713, "kl": 0.009248211751223872, "entropy": 1.5771409384788029, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.8624846364756, "num_env_steps_trained_throughput_per_sec": 79.8624846364756, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 49835.04, "restore_workers_time_ms": 0.017, "training_step_time_ms": 49834.985, "sample_time_ms": 2700.801, "learn_time_ms": 47114.33, "learn_throughput": 84.9, "synch_weights_time_ms": 14.691}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "fed12_00000", "date": "2024-08-21_18-08-43", "timestamp": 1724243923, "time_this_iter_s": 50.12704110145569, "time_total_s": 249.39174628257751, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f3118b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 249.39174628257751, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 25.938028169014085, "ram_util_percent": 83.12253521126759}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.263896258419783, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.196665157842888, "policy_loss": -0.02261580243440611, "vf_loss": 6.2169748293659675, "vf_explained_var": 0.4615296290980445, "kl": 0.011530536655632277, "entropy": 1.5607894811049972, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5207644638718751, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 1.5782470783228597, "policy_loss": -0.020926991327315885, "vf_loss": 1.5973567004399325, "vf_explained_var": 0.13922099562549087, "kl": 0.009086879984864956, "entropy": 1.5701228057265912, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.57887919133144, "num_env_steps_trained_throughput_per_sec": 81.57887919133144, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 49701.251, "restore_workers_time_ms": 0.017, "training_step_time_ms": 49701.198, "sample_time_ms": 2642.955, "learn_time_ms": 47039.331, "learn_throughput": 85.035, "synch_weights_time_ms": 14.342}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "fed12_00000", "date": "2024-08-21_18-09-32", "timestamp": 1724243972, "time_this_iter_s": 49.06432795524597, "time_total_s": 298.4560742378235, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4a4b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 298.4560742378235, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 24.14927536231884, "ram_util_percent": 82.9840579710145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.937625004816308, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.712727879973316, "policy_loss": -0.026483864093041688, "vf_loss": 6.73668045543489, "vf_explained_var": 0.49317279729262864, "kl": 0.012656413267056148, "entropy": 1.5444190467476213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999993}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7510008517081144, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.141948099994155, "policy_loss": -0.026337267154280745, "vf_loss": 2.1661978670528956, "vf_explained_var": 0.15970333461408262, "kl": 0.010437510359081286, "entropy": 1.5487475679665015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999993}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 596.2, "episode_reward_min": 50.14817390893885, "episode_reward_mean": 330.20280058316354, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 20400, "policy_reward_min": {"prey_policy": -692.1655184110501, "predator_policy": 3.5075795354352417}, "policy_reward_max": {"prey_policy": 390.50082934801765, "predator_policy": 652.553836784755}, "policy_reward_mean": {"prey_policy": 14.284799179940558, "predator_policy": 150.81660111164106}, "custom_metrics": {}, "hist_stats": {"episode_reward": [386.1000000000015, 197.51835524911462, 596.1133809444206, 196.82703865013434, 438.7999999999996, 596.2, 511.20000000000067, 203.18947686234648, 50.14817390893885, 453.9775392428047, 394.100000000002, 409.20000000000243, 328.33818928255846, 218.72539877141233, 372.16697885096926, 63.47596536965264, 201.97310418243262, 408.5802691429035, 75.3, 570.5999999999997, 330.0999999999993, 443.8000000000007, 527.6000000000003, 565.4000000000002, 337.6000000000006, 192.6976408470236, 312.60000000000105, 341.87156402485107, 521.2999999999993, 290.5999999999994, 267.50000000000017, 95.8000000000002, 345.9000000000006, 81.00000000000031, 303.59999999999945, 243.29999999999947, 64.69074051648902, 423.3328881936959, 494.3000000000046, 431.1639428760358, 238.85970682838445, 521.192475997154, 63.000000000000625, 369.20000000000164, 280.5, 217.60000000000025, 464.6, 419.0999999999999, 448.3999999999994, 419.00000000000296, 112.2000000000005], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [279.37360550246325, -64.52834072636338, -136.77718655049136, -0.031948734072287266, 343.4949423932625, 114.04895497364518, -132.07230458932005, -188.7765379953822, 51.744028535255964, 185.10613406520133, 102.36990408594093, 211.02020827678015, 228.27467196829085, 146.45206807049533, -97.59057190660336, 0.21240843152950362, -154.79070745979166, -412.4425028389413, 68.98774845900061, -115.1846861092391, -54.47351984583348, 324.7294064240282, -5.1712459260533645, 257.29441301270015, -228.14355686844348, 293.630609747124, -105.54083218977273, -117.60635095779426, -218.77362574454676, 283.38327201872437, -396.3842771140124, -82.03328312605838, -154.68012806623338, 116.57676910674631, -227.94068108817837, 217.44710794903918, -1.6862262170132958, 12.512551624066083, 201.82556947417834, 195.1376655174451, 134.0988212642963, -115.10792456894939, -193.0829223502661, 371.4943485643124, 111.1660982065138, 381.8682343310198, -19.786426204394502, 315.58000201389154, 219.30049416896995, -185.0886805128669, 72.26019901473623, -497.75851779512556, 19.75119593505214, 88.59120514007608, -58.74019494929354, -692.1655184110501, 161.4941873976433, 189.14571736775025, 81.01919670437637, -10.15290333869329, -99.64919657755951, 10.30497486222798, -32.13909198940963, -30.110663089082408, -121.22859884405565, 236.69787735784607, -125.06827545440558, 20.65506370846417, -21.77571323288374, -81.24050767289316, 102.10568001080523, -100.26899179574221, -45.410809389453306, -19.144922026836653, 128.00877444276432, -54.573409347023116, 84.48176888654483, 362.70423199661786, -16.845855756134853, -463.65908784744124, -429.29057945275053, 109.28648642249532, 20.15727253091118, 99.99218036776695, -269.03559979468884, -35.850943529005455, 27.10326518145648, 257.76323328871666, 34.44678394650214, 233.45220368567644, 54.9676980715976, 20.662042959925728, 165.85145745946483, -98.04269391087496, 111.04650768849966, 198.87034731521612, 211.7186172308135, 109.28317036790244, 390.50082934801765, -256.63569710382865, 87.59222572317776, -433.51267724517515], "policy_predator_policy_reward": [70.1263944975367, 101.1283407263613, 267.5986988336185, 66.7287917000595, 7.0321094199421275, 131.5373741575703, 177.1662505879205, 340.509630646915, 96.75597146474357, 105.19386593479838, 167.83009591405877, 114.97979172321988, 12.291903085736012, 124.1813568754777, 215.3392514545002, 85.2283888829188, 189.02060428578372, 428.3607799218877, 229.71156134552947, 270.46291554751383, 89.1735198458331, 34.670593575971836, 73.27124592605338, 83.80558698729985, 259.3435568684434, 3.5075795354352417, 134.68838841238886, 307.18419350658957, 154.16475784204818, 153.39257473474274, 397.7456523750817, 144.14787323464358, 85.80925049738894, 154.26721264452922, 194.64068464416886, 224.4331576378701, 39.18622621701358, 25.287448375933916, 83.25341697209858, 90.38334803627781, 74.59014760338508, 236.51895570126692, 146.97885624676084, 118.40971753919162, 25.433901793486164, 9.131765668980211, 225.6864262043939, 43.91999798610836, 88.29950583103006, 215.08868051286538, 450.15547837608034, 168.0404812513352, 24.192401816982073, 180.06519710788962, 652.553836784755, 440.22344060044225, 45.80581260235696, 124.8542826322498, 140.5701968977511, 79.16350973656613, 221.44919657755977, 135.3950251377718, 93.03909198940985, 65.01066308908291, 139.95168193788064, 90.47903954832795, 174.768655675599, 10.644556070342302, 209.41401213227462, 197.2022087735011, 174.2529480035777, 67.21036378135953, 91.93325671059789, 37.31321522218078, 249.68897169108126, 100.20855140687378, 23.718231113454113, 23.395768003382095, 607.2694014313035, 304.39948504830835, 534.3030218057464, 24.56077805289866, 355.8263777805508, 45.21664531792486, 297.9355997946953, 69.95094352900595, 33.74014099697644, 50.593360532850625, 5.053216053498084, 7.54779631432365, 27.532301928402518, 114.43795704007323, 107.3485425405353, 289.44269391087505, 55.44586271640393, 53.73728227988038, 61.3853150079954, 66.01289739328901, 3.699170651982424, 281.43569710383366, 5.007774276822439, 453.11267724517404]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.866249530075694, "mean_inference_ms": 3.699028710651771, "mean_action_processing_ms": 1.7135076985171436, "mean_env_wait_ms": 9.048553614250686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003751352721569585, "StateBufferConnector_ms": 0.02460012248918122, "ViewRequirementAgentConnector_ms": 0.10036767697801777}, "num_episodes": 51, "episode_return_max": 596.2, "episode_return_min": 50.14817390893885, "episode_return_mean": 330.20280058316354, "episodes_this_iter": 51}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.86240693953377, "num_env_steps_trained_throughput_per_sec": 82.86240693953377, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 49497.187, "restore_workers_time_ms": 0.016, "training_step_time_ms": 49497.135, "sample_time_ms": 2562.591, "learn_time_ms": 46915.827, "learn_throughput": 85.259, "synch_weights_time_ms": 14.284}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "fed12_00000", "date": "2024-08-21_18-10-21", "timestamp": 1724244021, "time_this_iter_s": 48.325517892837524, "time_total_s": 346.781592130661, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f310c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 346.781592130661, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 23.91176470588235, "ram_util_percent": 82.86470588235295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.833257388059424, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.391019645822111, "policy_loss": -0.032984358648813904, "vf_loss": 7.42014537437883, "vf_explained_var": 0.3531958462700011, "kl": 0.0192931495811396, "entropy": 1.4836871063267743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999993}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8140712595175184, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.045407872225241, "policy_loss": -0.02862404972418315, "vf_loss": 5.071018408845972, "vf_explained_var": 0.14934209730259326, "kl": 0.01506760343219395, "entropy": 1.4664294807368485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999993}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 596.2, "episode_reward_min": 50.14817390893885, "episode_reward_mean": 342.9182192953029, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -692.1655184110501, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 393.65714923920245, "predator_policy": 652.553836784755}, "policy_reward_mean": {"prey_policy": 26.12453783241734, "predator_policy": 145.33457181523406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [386.1000000000015, 197.51835524911462, 596.1133809444206, 196.82703865013434, 438.7999999999996, 596.2, 511.20000000000067, 203.18947686234648, 50.14817390893885, 453.9775392428047, 394.100000000002, 409.20000000000243, 328.33818928255846, 218.72539877141233, 372.16697885096926, 63.47596536965264, 201.97310418243262, 408.5802691429035, 75.3, 570.5999999999997, 330.0999999999993, 443.8000000000007, 527.6000000000003, 565.4000000000002, 337.6000000000006, 192.6976408470236, 312.60000000000105, 341.87156402485107, 521.2999999999993, 290.5999999999994, 267.50000000000017, 95.8000000000002, 345.9000000000006, 81.00000000000031, 303.59999999999945, 243.29999999999947, 64.69074051648902, 423.3328881936959, 494.3000000000046, 431.1639428760358, 238.85970682838445, 521.192475997154, 63.000000000000625, 369.20000000000164, 280.5, 217.60000000000025, 464.6, 419.0999999999999, 448.3999999999994, 419.00000000000296, 112.2000000000005, 279.1096472870081, 312.7000000000005, 416.4000000000015, 529.4999999999998, 394.3000000000019, 580.8999999999993, 296.6999999999996, 265.7999999999995, 191.79999999999959, 301.9, 433.30000000000314, 434.71654103849653, 306.50000000000034, 286.4999999999992, 561.0999999999999, 58.10000000000056, 320.68412243336354, 448.40000000000003, 554.291043895983, 482.4000000000001, 394.6676048656137], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [279.37360550246325, -64.52834072636338, -136.77718655049136, -0.031948734072287266, 343.4949423932625, 114.04895497364518, -132.07230458932005, -188.7765379953822, 51.744028535255964, 185.10613406520133, 102.36990408594093, 211.02020827678015, 228.27467196829085, 146.45206807049533, -97.59057190660336, 0.21240843152950362, -154.79070745979166, -412.4425028389413, 68.98774845900061, -115.1846861092391, -54.47351984583348, 324.7294064240282, -5.1712459260533645, 257.29441301270015, -228.14355686844348, 293.630609747124, -105.54083218977273, -117.60635095779426, -218.77362574454676, 283.38327201872437, -396.3842771140124, -82.03328312605838, -154.68012806623338, 116.57676910674631, -227.94068108817837, 217.44710794903918, -1.6862262170132958, 12.512551624066083, 201.82556947417834, 195.1376655174451, 134.0988212642963, -115.10792456894939, -193.0829223502661, 371.4943485643124, 111.1660982065138, 381.8682343310198, -19.786426204394502, 315.58000201389154, 219.30049416896995, -185.0886805128669, 72.26019901473623, -497.75851779512556, 19.75119593505214, 88.59120514007608, -58.74019494929354, -692.1655184110501, 161.4941873976433, 189.14571736775025, 81.01919670437637, -10.15290333869329, -99.64919657755951, 10.30497486222798, -32.13909198940963, -30.110663089082408, -121.22859884405565, 236.69787735784607, -125.06827545440558, 20.65506370846417, -21.77571323288374, -81.24050767289316, 102.10568001080523, -100.26899179574221, -45.410809389453306, -19.144922026836653, 128.00877444276432, -54.573409347023116, 84.48176888654483, 362.70423199661786, -16.845855756134853, -463.65908784744124, -429.29057945275053, 109.28648642249532, 20.15727253091118, 99.99218036776695, -269.03559979468884, -35.850943529005455, 27.10326518145648, 257.76323328871666, 34.44678394650214, 233.45220368567644, 54.9676980715976, 20.662042959925728, 165.85145745946483, -98.04269391087496, 111.04650768849966, 198.87034731521612, 211.7186172308135, 109.28317036790244, 390.50082934801765, -256.63569710382865, 87.59222572317776, -433.51267724517515, 22.88639018245472, -293.05634202734655, 65.20000000000041, 211.05263990390034, 393.65714923920245, -400.55233931519484, 133.67548607735617, 265.6114396478128, -287.19639052009893, 307.2905164065658, 331.71669494846054, 188.96735297747418, 208.41001977811445, 76.72049618151783, 73.11622318628682, -27.84330402064569, 32.13014581546037, 103.94820213298061, -190.09807030605654, 204.06757911278595, 49.167571163531974, 350.8085339151728, 203.5222201408425, 23.5799680610196, -283.35683351327646, -6.011027885811416, 47.793213055760695, 211.90000000000003, 218.63737703900338, 140.16548901750804, -205.63906381638023, -171.2280060097446, -82.0644873520675, -35.019174483015775, 34.273546202241306, 159.30386208923906, 331.8027028408861, -241.10541029771193, 210.50158949078167, -88.77639277881971, 6.511838523731001, 10.41252671023733], "policy_predator_policy_reward": [70.1263944975367, 101.1283407263613, 267.5986988336185, 66.7287917000595, 7.0321094199421275, 131.5373741575703, 177.1662505879205, 340.509630646915, 96.75597146474357, 105.19386593479838, 167.83009591405877, 114.97979172321988, 12.291903085736012, 124.1813568754777, 215.3392514545002, 85.2283888829188, 189.02060428578372, 428.3607799218877, 229.71156134552947, 270.46291554751383, 89.1735198458331, 34.670593575971836, 73.27124592605338, 83.80558698729985, 259.3435568684434, 3.5075795354352417, 134.68838841238886, 307.18419350658957, 154.16475784204818, 153.39257473474274, 397.7456523750817, 144.14787323464358, 85.80925049738894, 154.26721264452922, 194.64068464416886, 224.4331576378701, 39.18622621701358, 25.287448375933916, 83.25341697209858, 90.38334803627781, 74.59014760338508, 236.51895570126692, 146.97885624676084, 118.40971753919162, 25.433901793486164, 9.131765668980211, 225.6864262043939, 43.91999798610836, 88.29950583103006, 215.08868051286538, 450.15547837608034, 168.0404812513352, 24.192401816982073, 180.06519710788962, 652.553836784755, 440.22344060044225, 45.80581260235696, 124.8542826322498, 140.5701968977511, 79.16350973656613, 221.44919657755977, 135.3950251377718, 93.03909198940985, 65.01066308908291, 139.95168193788064, 90.47903954832795, 174.768655675599, 10.644556070342302, 209.41401213227462, 197.2022087735011, 174.2529480035777, 67.21036378135953, 91.93325671059789, 37.31321522218078, 249.68897169108126, 100.20855140687378, 23.718231113454113, 23.395768003382095, 607.2694014313035, 304.39948504830835, 534.3030218057464, 24.56077805289866, 355.8263777805508, 45.21664531792486, 297.9355997946953, 69.95094352900595, 33.74014099697644, 50.593360532850625, 5.053216053498084, 7.54779631432365, 27.532301928402518, 114.43795704007323, 107.3485425405353, 289.44269391087505, 55.44586271640393, 53.73728227988038, 61.3853150079954, 66.01289739328901, 3.699170651982424, 281.43569710383366, 5.007774276822439, 453.11267724517404, 231.7812112685353, 317.4983878633647, 0.0, 36.44736009609975, 0.8428507607975394, 422.4523393151963, 85.22451392264398, 44.988560352187264, 316.29639052010555, 57.90948359343419, 35.87324851691365, 24.34270355715166, 5.689980221885493, 5.879503818482311, 100.96649365446027, 119.56058717989919, 52.24200540626445, 3.479646645294846, 227.49807030605498, 60.432420887214185, 9.732428836468484, 23.59146608482728, 184.8273428404908, 22.787009996144956, 309.15683351327954, 286.7110278858118, 26.806786944239796, 0.0, 37.31231331640524, 164.9848206270833, 200.65111446728594, 234.31595535883562, 374.7059799147782, 63.06180435366925, 182.02645379775836, 72.79613791076063, 176.23603327858473, 287.357718074224, 68.99841050921837, 291.67639277882, 215.71085131332805, 162.0323883183163]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8440386334219756, "mean_inference_ms": 3.6741589086444133, "mean_action_processing_ms": 1.6833511054481936, "mean_env_wait_ms": 9.062522895964001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037946634822421605, "StateBufferConnector_ms": 0.018554760350121394, "ViewRequirementAgentConnector_ms": 0.09811619917551677}, "num_episodes": 21, "episode_return_max": 596.2, "episode_return_min": 50.14817390893885, "episode_return_mean": 342.9182192953029, "episodes_this_iter": 21}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.92345806168346, "num_env_steps_trained_throughput_per_sec": 82.92345806168346, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 49339.697, "restore_workers_time_ms": 0.016, "training_step_time_ms": 49339.645, "sample_time_ms": 2500.413, "learn_time_ms": 46820.805, "learn_throughput": 85.432, "synch_weights_time_ms": 14.214}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "fed12_00000", "date": "2024-08-21_18-11-09", "timestamp": 1724244069, "time_this_iter_s": 48.29378318786621, "time_total_s": 395.0753753185272, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f330820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 395.0753753185272, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 24.627941176470586, "ram_util_percent": 83.03235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.076793197885392, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.2869074427892295, "policy_loss": -0.02971768308968022, "vf_loss": 7.313156402931011, "vf_explained_var": 0.40213271344780294, "kl": 0.01734369672371676, "entropy": 1.4883809902680614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.714561078062764, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.210213349357484, "policy_loss": -0.025429230833810473, "vf_loss": 5.232658148442627, "vf_explained_var": 0.12030622372551569, "kl": 0.014922192907355056, "entropy": 1.4555200063362324, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 596.2, "episode_reward_min": 50.14817390893885, "episode_reward_mean": 342.9182192953029, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -692.1655184110501, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 393.65714923920245, "predator_policy": 652.553836784755}, "policy_reward_mean": {"prey_policy": 26.12453783241734, "predator_policy": 145.33457181523406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [386.1000000000015, 197.51835524911462, 596.1133809444206, 196.82703865013434, 438.7999999999996, 596.2, 511.20000000000067, 203.18947686234648, 50.14817390893885, 453.9775392428047, 394.100000000002, 409.20000000000243, 328.33818928255846, 218.72539877141233, 372.16697885096926, 63.47596536965264, 201.97310418243262, 408.5802691429035, 75.3, 570.5999999999997, 330.0999999999993, 443.8000000000007, 527.6000000000003, 565.4000000000002, 337.6000000000006, 192.6976408470236, 312.60000000000105, 341.87156402485107, 521.2999999999993, 290.5999999999994, 267.50000000000017, 95.8000000000002, 345.9000000000006, 81.00000000000031, 303.59999999999945, 243.29999999999947, 64.69074051648902, 423.3328881936959, 494.3000000000046, 431.1639428760358, 238.85970682838445, 521.192475997154, 63.000000000000625, 369.20000000000164, 280.5, 217.60000000000025, 464.6, 419.0999999999999, 448.3999999999994, 419.00000000000296, 112.2000000000005, 279.1096472870081, 312.7000000000005, 416.4000000000015, 529.4999999999998, 394.3000000000019, 580.8999999999993, 296.6999999999996, 265.7999999999995, 191.79999999999959, 301.9, 433.30000000000314, 434.71654103849653, 306.50000000000034, 286.4999999999992, 561.0999999999999, 58.10000000000056, 320.68412243336354, 448.40000000000003, 554.291043895983, 482.4000000000001, 394.6676048656137], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [279.37360550246325, -64.52834072636338, -136.77718655049136, -0.031948734072287266, 343.4949423932625, 114.04895497364518, -132.07230458932005, -188.7765379953822, 51.744028535255964, 185.10613406520133, 102.36990408594093, 211.02020827678015, 228.27467196829085, 146.45206807049533, -97.59057190660336, 0.21240843152950362, -154.79070745979166, -412.4425028389413, 68.98774845900061, -115.1846861092391, -54.47351984583348, 324.7294064240282, -5.1712459260533645, 257.29441301270015, -228.14355686844348, 293.630609747124, -105.54083218977273, -117.60635095779426, -218.77362574454676, 283.38327201872437, -396.3842771140124, -82.03328312605838, -154.68012806623338, 116.57676910674631, -227.94068108817837, 217.44710794903918, -1.6862262170132958, 12.512551624066083, 201.82556947417834, 195.1376655174451, 134.0988212642963, -115.10792456894939, -193.0829223502661, 371.4943485643124, 111.1660982065138, 381.8682343310198, -19.786426204394502, 315.58000201389154, 219.30049416896995, -185.0886805128669, 72.26019901473623, -497.75851779512556, 19.75119593505214, 88.59120514007608, -58.74019494929354, -692.1655184110501, 161.4941873976433, 189.14571736775025, 81.01919670437637, -10.15290333869329, -99.64919657755951, 10.30497486222798, -32.13909198940963, -30.110663089082408, -121.22859884405565, 236.69787735784607, -125.06827545440558, 20.65506370846417, -21.77571323288374, -81.24050767289316, 102.10568001080523, -100.26899179574221, -45.410809389453306, -19.144922026836653, 128.00877444276432, -54.573409347023116, 84.48176888654483, 362.70423199661786, -16.845855756134853, -463.65908784744124, -429.29057945275053, 109.28648642249532, 20.15727253091118, 99.99218036776695, -269.03559979468884, -35.850943529005455, 27.10326518145648, 257.76323328871666, 34.44678394650214, 233.45220368567644, 54.9676980715976, 20.662042959925728, 165.85145745946483, -98.04269391087496, 111.04650768849966, 198.87034731521612, 211.7186172308135, 109.28317036790244, 390.50082934801765, -256.63569710382865, 87.59222572317776, -433.51267724517515, 22.88639018245472, -293.05634202734655, 65.20000000000041, 211.05263990390034, 393.65714923920245, -400.55233931519484, 133.67548607735617, 265.6114396478128, -287.19639052009893, 307.2905164065658, 331.71669494846054, 188.96735297747418, 208.41001977811445, 76.72049618151783, 73.11622318628682, -27.84330402064569, 32.13014581546037, 103.94820213298061, -190.09807030605654, 204.06757911278595, 49.167571163531974, 350.8085339151728, 203.5222201408425, 23.5799680610196, -283.35683351327646, -6.011027885811416, 47.793213055760695, 211.90000000000003, 218.63737703900338, 140.16548901750804, -205.63906381638023, -171.2280060097446, -82.0644873520675, -35.019174483015775, 34.273546202241306, 159.30386208923906, 331.8027028408861, -241.10541029771193, 210.50158949078167, -88.77639277881971, 6.511838523731001, 10.41252671023733], "policy_predator_policy_reward": [70.1263944975367, 101.1283407263613, 267.5986988336185, 66.7287917000595, 7.0321094199421275, 131.5373741575703, 177.1662505879205, 340.509630646915, 96.75597146474357, 105.19386593479838, 167.83009591405877, 114.97979172321988, 12.291903085736012, 124.1813568754777, 215.3392514545002, 85.2283888829188, 189.02060428578372, 428.3607799218877, 229.71156134552947, 270.46291554751383, 89.1735198458331, 34.670593575971836, 73.27124592605338, 83.80558698729985, 259.3435568684434, 3.5075795354352417, 134.68838841238886, 307.18419350658957, 154.16475784204818, 153.39257473474274, 397.7456523750817, 144.14787323464358, 85.80925049738894, 154.26721264452922, 194.64068464416886, 224.4331576378701, 39.18622621701358, 25.287448375933916, 83.25341697209858, 90.38334803627781, 74.59014760338508, 236.51895570126692, 146.97885624676084, 118.40971753919162, 25.433901793486164, 9.131765668980211, 225.6864262043939, 43.91999798610836, 88.29950583103006, 215.08868051286538, 450.15547837608034, 168.0404812513352, 24.192401816982073, 180.06519710788962, 652.553836784755, 440.22344060044225, 45.80581260235696, 124.8542826322498, 140.5701968977511, 79.16350973656613, 221.44919657755977, 135.3950251377718, 93.03909198940985, 65.01066308908291, 139.95168193788064, 90.47903954832795, 174.768655675599, 10.644556070342302, 209.41401213227462, 197.2022087735011, 174.2529480035777, 67.21036378135953, 91.93325671059789, 37.31321522218078, 249.68897169108126, 100.20855140687378, 23.718231113454113, 23.395768003382095, 607.2694014313035, 304.39948504830835, 534.3030218057464, 24.56077805289866, 355.8263777805508, 45.21664531792486, 297.9355997946953, 69.95094352900595, 33.74014099697644, 50.593360532850625, 5.053216053498084, 7.54779631432365, 27.532301928402518, 114.43795704007323, 107.3485425405353, 289.44269391087505, 55.44586271640393, 53.73728227988038, 61.3853150079954, 66.01289739328901, 3.699170651982424, 281.43569710383366, 5.007774276822439, 453.11267724517404, 231.7812112685353, 317.4983878633647, 0.0, 36.44736009609975, 0.8428507607975394, 422.4523393151963, 85.22451392264398, 44.988560352187264, 316.29639052010555, 57.90948359343419, 35.87324851691365, 24.34270355715166, 5.689980221885493, 5.879503818482311, 100.96649365446027, 119.56058717989919, 52.24200540626445, 3.479646645294846, 227.49807030605498, 60.432420887214185, 9.732428836468484, 23.59146608482728, 184.8273428404908, 22.787009996144956, 309.15683351327954, 286.7110278858118, 26.806786944239796, 0.0, 37.31231331640524, 164.9848206270833, 200.65111446728594, 234.31595535883562, 374.7059799147782, 63.06180435366925, 182.02645379775836, 72.79613791076063, 176.23603327858473, 287.357718074224, 68.99841050921837, 291.67639277882, 215.71085131332805, 162.0323883183163]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8440386334219756, "mean_inference_ms": 3.6741589086444133, "mean_action_processing_ms": 1.6833511054481936, "mean_env_wait_ms": 9.062522895964001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037946634822421605, "StateBufferConnector_ms": 0.018554760350121394, "ViewRequirementAgentConnector_ms": 0.09811619917551677}, "num_episodes": 0, "episode_return_max": 596.2, "episode_return_min": 50.14817390893885, "episode_return_mean": 342.9182192953029, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.08692223326415, "num_env_steps_trained_throughput_per_sec": 82.08692223326415, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 49271.824, "restore_workers_time_ms": 0.016, "training_step_time_ms": 49271.77, "sample_time_ms": 2442.928, "learn_time_ms": 46810.212, "learn_throughput": 85.451, "synch_weights_time_ms": 14.223}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "fed12_00000", "date": "2024-08-21_18-11-58", "timestamp": 1724244118, "time_this_iter_s": 48.767876863479614, "time_total_s": 443.84325218200684, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4cbf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 443.84325218200684, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 24.5768115942029, "ram_util_percent": 82.48260869565217}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.901625216070306, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.288134902621072, "policy_loss": -0.027364371214480824, "vf_loss": 7.312279569535028, "vf_explained_var": 0.451779037398636, "kl": 0.016098536742190837, "entropy": 1.478996721083525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.98124535121615, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.171765131799002, "policy_loss": -0.022833568218198638, "vf_loss": 4.191628414360935, "vf_explained_var": 0.17807526929037912, "kl": 0.014851422125729855, "entropy": 1.4543916478989616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 596.2, "episode_reward_min": 50.14817390893885, "episode_reward_mean": 342.9182192953029, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -692.1655184110501, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 393.65714923920245, "predator_policy": 652.553836784755}, "policy_reward_mean": {"prey_policy": 26.12453783241734, "predator_policy": 145.33457181523406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [386.1000000000015, 197.51835524911462, 596.1133809444206, 196.82703865013434, 438.7999999999996, 596.2, 511.20000000000067, 203.18947686234648, 50.14817390893885, 453.9775392428047, 394.100000000002, 409.20000000000243, 328.33818928255846, 218.72539877141233, 372.16697885096926, 63.47596536965264, 201.97310418243262, 408.5802691429035, 75.3, 570.5999999999997, 330.0999999999993, 443.8000000000007, 527.6000000000003, 565.4000000000002, 337.6000000000006, 192.6976408470236, 312.60000000000105, 341.87156402485107, 521.2999999999993, 290.5999999999994, 267.50000000000017, 95.8000000000002, 345.9000000000006, 81.00000000000031, 303.59999999999945, 243.29999999999947, 64.69074051648902, 423.3328881936959, 494.3000000000046, 431.1639428760358, 238.85970682838445, 521.192475997154, 63.000000000000625, 369.20000000000164, 280.5, 217.60000000000025, 464.6, 419.0999999999999, 448.3999999999994, 419.00000000000296, 112.2000000000005, 279.1096472870081, 312.7000000000005, 416.4000000000015, 529.4999999999998, 394.3000000000019, 580.8999999999993, 296.6999999999996, 265.7999999999995, 191.79999999999959, 301.9, 433.30000000000314, 434.71654103849653, 306.50000000000034, 286.4999999999992, 561.0999999999999, 58.10000000000056, 320.68412243336354, 448.40000000000003, 554.291043895983, 482.4000000000001, 394.6676048656137], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [279.37360550246325, -64.52834072636338, -136.77718655049136, -0.031948734072287266, 343.4949423932625, 114.04895497364518, -132.07230458932005, -188.7765379953822, 51.744028535255964, 185.10613406520133, 102.36990408594093, 211.02020827678015, 228.27467196829085, 146.45206807049533, -97.59057190660336, 0.21240843152950362, -154.79070745979166, -412.4425028389413, 68.98774845900061, -115.1846861092391, -54.47351984583348, 324.7294064240282, -5.1712459260533645, 257.29441301270015, -228.14355686844348, 293.630609747124, -105.54083218977273, -117.60635095779426, -218.77362574454676, 283.38327201872437, -396.3842771140124, -82.03328312605838, -154.68012806623338, 116.57676910674631, -227.94068108817837, 217.44710794903918, -1.6862262170132958, 12.512551624066083, 201.82556947417834, 195.1376655174451, 134.0988212642963, -115.10792456894939, -193.0829223502661, 371.4943485643124, 111.1660982065138, 381.8682343310198, -19.786426204394502, 315.58000201389154, 219.30049416896995, -185.0886805128669, 72.26019901473623, -497.75851779512556, 19.75119593505214, 88.59120514007608, -58.74019494929354, -692.1655184110501, 161.4941873976433, 189.14571736775025, 81.01919670437637, -10.15290333869329, -99.64919657755951, 10.30497486222798, -32.13909198940963, -30.110663089082408, -121.22859884405565, 236.69787735784607, -125.06827545440558, 20.65506370846417, -21.77571323288374, -81.24050767289316, 102.10568001080523, -100.26899179574221, -45.410809389453306, -19.144922026836653, 128.00877444276432, -54.573409347023116, 84.48176888654483, 362.70423199661786, -16.845855756134853, -463.65908784744124, -429.29057945275053, 109.28648642249532, 20.15727253091118, 99.99218036776695, -269.03559979468884, -35.850943529005455, 27.10326518145648, 257.76323328871666, 34.44678394650214, 233.45220368567644, 54.9676980715976, 20.662042959925728, 165.85145745946483, -98.04269391087496, 111.04650768849966, 198.87034731521612, 211.7186172308135, 109.28317036790244, 390.50082934801765, -256.63569710382865, 87.59222572317776, -433.51267724517515, 22.88639018245472, -293.05634202734655, 65.20000000000041, 211.05263990390034, 393.65714923920245, -400.55233931519484, 133.67548607735617, 265.6114396478128, -287.19639052009893, 307.2905164065658, 331.71669494846054, 188.96735297747418, 208.41001977811445, 76.72049618151783, 73.11622318628682, -27.84330402064569, 32.13014581546037, 103.94820213298061, -190.09807030605654, 204.06757911278595, 49.167571163531974, 350.8085339151728, 203.5222201408425, 23.5799680610196, -283.35683351327646, -6.011027885811416, 47.793213055760695, 211.90000000000003, 218.63737703900338, 140.16548901750804, -205.63906381638023, -171.2280060097446, -82.0644873520675, -35.019174483015775, 34.273546202241306, 159.30386208923906, 331.8027028408861, -241.10541029771193, 210.50158949078167, -88.77639277881971, 6.511838523731001, 10.41252671023733], "policy_predator_policy_reward": [70.1263944975367, 101.1283407263613, 267.5986988336185, 66.7287917000595, 7.0321094199421275, 131.5373741575703, 177.1662505879205, 340.509630646915, 96.75597146474357, 105.19386593479838, 167.83009591405877, 114.97979172321988, 12.291903085736012, 124.1813568754777, 215.3392514545002, 85.2283888829188, 189.02060428578372, 428.3607799218877, 229.71156134552947, 270.46291554751383, 89.1735198458331, 34.670593575971836, 73.27124592605338, 83.80558698729985, 259.3435568684434, 3.5075795354352417, 134.68838841238886, 307.18419350658957, 154.16475784204818, 153.39257473474274, 397.7456523750817, 144.14787323464358, 85.80925049738894, 154.26721264452922, 194.64068464416886, 224.4331576378701, 39.18622621701358, 25.287448375933916, 83.25341697209858, 90.38334803627781, 74.59014760338508, 236.51895570126692, 146.97885624676084, 118.40971753919162, 25.433901793486164, 9.131765668980211, 225.6864262043939, 43.91999798610836, 88.29950583103006, 215.08868051286538, 450.15547837608034, 168.0404812513352, 24.192401816982073, 180.06519710788962, 652.553836784755, 440.22344060044225, 45.80581260235696, 124.8542826322498, 140.5701968977511, 79.16350973656613, 221.44919657755977, 135.3950251377718, 93.03909198940985, 65.01066308908291, 139.95168193788064, 90.47903954832795, 174.768655675599, 10.644556070342302, 209.41401213227462, 197.2022087735011, 174.2529480035777, 67.21036378135953, 91.93325671059789, 37.31321522218078, 249.68897169108126, 100.20855140687378, 23.718231113454113, 23.395768003382095, 607.2694014313035, 304.39948504830835, 534.3030218057464, 24.56077805289866, 355.8263777805508, 45.21664531792486, 297.9355997946953, 69.95094352900595, 33.74014099697644, 50.593360532850625, 5.053216053498084, 7.54779631432365, 27.532301928402518, 114.43795704007323, 107.3485425405353, 289.44269391087505, 55.44586271640393, 53.73728227988038, 61.3853150079954, 66.01289739328901, 3.699170651982424, 281.43569710383366, 5.007774276822439, 453.11267724517404, 231.7812112685353, 317.4983878633647, 0.0, 36.44736009609975, 0.8428507607975394, 422.4523393151963, 85.22451392264398, 44.988560352187264, 316.29639052010555, 57.90948359343419, 35.87324851691365, 24.34270355715166, 5.689980221885493, 5.879503818482311, 100.96649365446027, 119.56058717989919, 52.24200540626445, 3.479646645294846, 227.49807030605498, 60.432420887214185, 9.732428836468484, 23.59146608482728, 184.8273428404908, 22.787009996144956, 309.15683351327954, 286.7110278858118, 26.806786944239796, 0.0, 37.31231331640524, 164.9848206270833, 200.65111446728594, 234.31595535883562, 374.7059799147782, 63.06180435366925, 182.02645379775836, 72.79613791076063, 176.23603327858473, 287.357718074224, 68.99841050921837, 291.67639277882, 215.71085131332805, 162.0323883183163]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8440386334219756, "mean_inference_ms": 3.6741589086444133, "mean_action_processing_ms": 1.6833511054481936, "mean_env_wait_ms": 9.062522895964001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037946634822421605, "StateBufferConnector_ms": 0.018554760350121394, "ViewRequirementAgentConnector_ms": 0.09811619917551677}, "num_episodes": 0, "episode_return_max": 596.2, "episode_return_min": 50.14817390893885, "episode_return_mean": 342.9182192953029, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.9406175877193, "num_env_steps_trained_throughput_per_sec": 81.9406175877193, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 49226.226, "restore_workers_time_ms": 0.016, "training_step_time_ms": 49226.168, "sample_time_ms": 2410.652, "learn_time_ms": 46796.709, "learn_throughput": 85.476, "synch_weights_time_ms": 14.423}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "fed12_00000", "date": "2024-08-21_18-12-47", "timestamp": 1724244167, "time_this_iter_s": 48.8590772151947, "time_total_s": 492.70232939720154, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f1b4d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 492.70232939720154, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 25.559420289855076, "ram_util_percent": 83.07536231884059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.888645400950518, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.269662998845337, "policy_loss": -0.025439260747263985, "vf_loss": 7.292176267835829, "vf_explained_var": 0.4663975093099806, "kl": 0.01462995273445452, "entropy": 1.4872169991649649, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3019630685685173, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.7875970241253967, "policy_loss": -0.025057283475029248, "vf_loss": 3.8092715943301165, "vf_explained_var": 0.1636769881008794, "kl": 0.016913517604202583, "entropy": 1.4459534435045152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 596.2, "episode_reward_min": 50.14817390893885, "episode_reward_mean": 342.9182192953029, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -692.1655184110501, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 393.65714923920245, "predator_policy": 652.553836784755}, "policy_reward_mean": {"prey_policy": 26.12453783241734, "predator_policy": 145.33457181523406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [386.1000000000015, 197.51835524911462, 596.1133809444206, 196.82703865013434, 438.7999999999996, 596.2, 511.20000000000067, 203.18947686234648, 50.14817390893885, 453.9775392428047, 394.100000000002, 409.20000000000243, 328.33818928255846, 218.72539877141233, 372.16697885096926, 63.47596536965264, 201.97310418243262, 408.5802691429035, 75.3, 570.5999999999997, 330.0999999999993, 443.8000000000007, 527.6000000000003, 565.4000000000002, 337.6000000000006, 192.6976408470236, 312.60000000000105, 341.87156402485107, 521.2999999999993, 290.5999999999994, 267.50000000000017, 95.8000000000002, 345.9000000000006, 81.00000000000031, 303.59999999999945, 243.29999999999947, 64.69074051648902, 423.3328881936959, 494.3000000000046, 431.1639428760358, 238.85970682838445, 521.192475997154, 63.000000000000625, 369.20000000000164, 280.5, 217.60000000000025, 464.6, 419.0999999999999, 448.3999999999994, 419.00000000000296, 112.2000000000005, 279.1096472870081, 312.7000000000005, 416.4000000000015, 529.4999999999998, 394.3000000000019, 580.8999999999993, 296.6999999999996, 265.7999999999995, 191.79999999999959, 301.9, 433.30000000000314, 434.71654103849653, 306.50000000000034, 286.4999999999992, 561.0999999999999, 58.10000000000056, 320.68412243336354, 448.40000000000003, 554.291043895983, 482.4000000000001, 394.6676048656137], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [279.37360550246325, -64.52834072636338, -136.77718655049136, -0.031948734072287266, 343.4949423932625, 114.04895497364518, -132.07230458932005, -188.7765379953822, 51.744028535255964, 185.10613406520133, 102.36990408594093, 211.02020827678015, 228.27467196829085, 146.45206807049533, -97.59057190660336, 0.21240843152950362, -154.79070745979166, -412.4425028389413, 68.98774845900061, -115.1846861092391, -54.47351984583348, 324.7294064240282, -5.1712459260533645, 257.29441301270015, -228.14355686844348, 293.630609747124, -105.54083218977273, -117.60635095779426, -218.77362574454676, 283.38327201872437, -396.3842771140124, -82.03328312605838, -154.68012806623338, 116.57676910674631, -227.94068108817837, 217.44710794903918, -1.6862262170132958, 12.512551624066083, 201.82556947417834, 195.1376655174451, 134.0988212642963, -115.10792456894939, -193.0829223502661, 371.4943485643124, 111.1660982065138, 381.8682343310198, -19.786426204394502, 315.58000201389154, 219.30049416896995, -185.0886805128669, 72.26019901473623, -497.75851779512556, 19.75119593505214, 88.59120514007608, -58.74019494929354, -692.1655184110501, 161.4941873976433, 189.14571736775025, 81.01919670437637, -10.15290333869329, -99.64919657755951, 10.30497486222798, -32.13909198940963, -30.110663089082408, -121.22859884405565, 236.69787735784607, -125.06827545440558, 20.65506370846417, -21.77571323288374, -81.24050767289316, 102.10568001080523, -100.26899179574221, -45.410809389453306, -19.144922026836653, 128.00877444276432, -54.573409347023116, 84.48176888654483, 362.70423199661786, -16.845855756134853, -463.65908784744124, -429.29057945275053, 109.28648642249532, 20.15727253091118, 99.99218036776695, -269.03559979468884, -35.850943529005455, 27.10326518145648, 257.76323328871666, 34.44678394650214, 233.45220368567644, 54.9676980715976, 20.662042959925728, 165.85145745946483, -98.04269391087496, 111.04650768849966, 198.87034731521612, 211.7186172308135, 109.28317036790244, 390.50082934801765, -256.63569710382865, 87.59222572317776, -433.51267724517515, 22.88639018245472, -293.05634202734655, 65.20000000000041, 211.05263990390034, 393.65714923920245, -400.55233931519484, 133.67548607735617, 265.6114396478128, -287.19639052009893, 307.2905164065658, 331.71669494846054, 188.96735297747418, 208.41001977811445, 76.72049618151783, 73.11622318628682, -27.84330402064569, 32.13014581546037, 103.94820213298061, -190.09807030605654, 204.06757911278595, 49.167571163531974, 350.8085339151728, 203.5222201408425, 23.5799680610196, -283.35683351327646, -6.011027885811416, 47.793213055760695, 211.90000000000003, 218.63737703900338, 140.16548901750804, -205.63906381638023, -171.2280060097446, -82.0644873520675, -35.019174483015775, 34.273546202241306, 159.30386208923906, 331.8027028408861, -241.10541029771193, 210.50158949078167, -88.77639277881971, 6.511838523731001, 10.41252671023733], "policy_predator_policy_reward": [70.1263944975367, 101.1283407263613, 267.5986988336185, 66.7287917000595, 7.0321094199421275, 131.5373741575703, 177.1662505879205, 340.509630646915, 96.75597146474357, 105.19386593479838, 167.83009591405877, 114.97979172321988, 12.291903085736012, 124.1813568754777, 215.3392514545002, 85.2283888829188, 189.02060428578372, 428.3607799218877, 229.71156134552947, 270.46291554751383, 89.1735198458331, 34.670593575971836, 73.27124592605338, 83.80558698729985, 259.3435568684434, 3.5075795354352417, 134.68838841238886, 307.18419350658957, 154.16475784204818, 153.39257473474274, 397.7456523750817, 144.14787323464358, 85.80925049738894, 154.26721264452922, 194.64068464416886, 224.4331576378701, 39.18622621701358, 25.287448375933916, 83.25341697209858, 90.38334803627781, 74.59014760338508, 236.51895570126692, 146.97885624676084, 118.40971753919162, 25.433901793486164, 9.131765668980211, 225.6864262043939, 43.91999798610836, 88.29950583103006, 215.08868051286538, 450.15547837608034, 168.0404812513352, 24.192401816982073, 180.06519710788962, 652.553836784755, 440.22344060044225, 45.80581260235696, 124.8542826322498, 140.5701968977511, 79.16350973656613, 221.44919657755977, 135.3950251377718, 93.03909198940985, 65.01066308908291, 139.95168193788064, 90.47903954832795, 174.768655675599, 10.644556070342302, 209.41401213227462, 197.2022087735011, 174.2529480035777, 67.21036378135953, 91.93325671059789, 37.31321522218078, 249.68897169108126, 100.20855140687378, 23.718231113454113, 23.395768003382095, 607.2694014313035, 304.39948504830835, 534.3030218057464, 24.56077805289866, 355.8263777805508, 45.21664531792486, 297.9355997946953, 69.95094352900595, 33.74014099697644, 50.593360532850625, 5.053216053498084, 7.54779631432365, 27.532301928402518, 114.43795704007323, 107.3485425405353, 289.44269391087505, 55.44586271640393, 53.73728227988038, 61.3853150079954, 66.01289739328901, 3.699170651982424, 281.43569710383366, 5.007774276822439, 453.11267724517404, 231.7812112685353, 317.4983878633647, 0.0, 36.44736009609975, 0.8428507607975394, 422.4523393151963, 85.22451392264398, 44.988560352187264, 316.29639052010555, 57.90948359343419, 35.87324851691365, 24.34270355715166, 5.689980221885493, 5.879503818482311, 100.96649365446027, 119.56058717989919, 52.24200540626445, 3.479646645294846, 227.49807030605498, 60.432420887214185, 9.732428836468484, 23.59146608482728, 184.8273428404908, 22.787009996144956, 309.15683351327954, 286.7110278858118, 26.806786944239796, 0.0, 37.31231331640524, 164.9848206270833, 200.65111446728594, 234.31595535883562, 374.7059799147782, 63.06180435366925, 182.02645379775836, 72.79613791076063, 176.23603327858473, 287.357718074224, 68.99841050921837, 291.67639277882, 215.71085131332805, 162.0323883183163]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8440386334219756, "mean_inference_ms": 3.6741589086444133, "mean_action_processing_ms": 1.6833511054481936, "mean_env_wait_ms": 9.062522895964001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037946634822421605, "StateBufferConnector_ms": 0.018554760350121394, "ViewRequirementAgentConnector_ms": 0.09811619917551677}, "num_episodes": 0, "episode_return_max": 596.2, "episode_return_min": 50.14817390893885, "episode_return_mean": 342.9182192953029, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.33887045824243, "num_env_steps_trained_throughput_per_sec": 82.33887045824243, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 48937.822, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48937.764, "sample_time_ms": 2222.985, "learn_time_ms": 46697.357, "learn_throughput": 85.658, "synch_weights_time_ms": 14.323}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "fed12_00000", "date": "2024-08-21_18-13-35", "timestamp": 1724244215, "time_this_iter_s": 48.63395285606384, "time_total_s": 541.3362822532654, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f317c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 541.3362822532654, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 24.11014492753623, "ram_util_percent": 83.02753623188404}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.60079682579747, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.177652832061526, "policy_loss": -0.02517315535436547, "vf_loss": 7.199951235705583, "vf_explained_var": 0.35466975248049176, "kl": 0.014373789093501512, "entropy": 1.4850178084045491, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.353891542538133, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.7033173784377085, "policy_loss": -0.02665422618359564, "vf_loss": 3.726773763459826, "vf_explained_var": 0.16241771922540413, "kl": 0.01598918280864834, "entropy": 1.4336618779197572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 596.2, "episode_reward_min": 50.14817390893885, "episode_reward_mean": 342.9182192953029, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -692.1655184110501, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 393.65714923920245, "predator_policy": 652.553836784755}, "policy_reward_mean": {"prey_policy": 26.12453783241734, "predator_policy": 145.33457181523406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [386.1000000000015, 197.51835524911462, 596.1133809444206, 196.82703865013434, 438.7999999999996, 596.2, 511.20000000000067, 203.18947686234648, 50.14817390893885, 453.9775392428047, 394.100000000002, 409.20000000000243, 328.33818928255846, 218.72539877141233, 372.16697885096926, 63.47596536965264, 201.97310418243262, 408.5802691429035, 75.3, 570.5999999999997, 330.0999999999993, 443.8000000000007, 527.6000000000003, 565.4000000000002, 337.6000000000006, 192.6976408470236, 312.60000000000105, 341.87156402485107, 521.2999999999993, 290.5999999999994, 267.50000000000017, 95.8000000000002, 345.9000000000006, 81.00000000000031, 303.59999999999945, 243.29999999999947, 64.69074051648902, 423.3328881936959, 494.3000000000046, 431.1639428760358, 238.85970682838445, 521.192475997154, 63.000000000000625, 369.20000000000164, 280.5, 217.60000000000025, 464.6, 419.0999999999999, 448.3999999999994, 419.00000000000296, 112.2000000000005, 279.1096472870081, 312.7000000000005, 416.4000000000015, 529.4999999999998, 394.3000000000019, 580.8999999999993, 296.6999999999996, 265.7999999999995, 191.79999999999959, 301.9, 433.30000000000314, 434.71654103849653, 306.50000000000034, 286.4999999999992, 561.0999999999999, 58.10000000000056, 320.68412243336354, 448.40000000000003, 554.291043895983, 482.4000000000001, 394.6676048656137], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [279.37360550246325, -64.52834072636338, -136.77718655049136, -0.031948734072287266, 343.4949423932625, 114.04895497364518, -132.07230458932005, -188.7765379953822, 51.744028535255964, 185.10613406520133, 102.36990408594093, 211.02020827678015, 228.27467196829085, 146.45206807049533, -97.59057190660336, 0.21240843152950362, -154.79070745979166, -412.4425028389413, 68.98774845900061, -115.1846861092391, -54.47351984583348, 324.7294064240282, -5.1712459260533645, 257.29441301270015, -228.14355686844348, 293.630609747124, -105.54083218977273, -117.60635095779426, -218.77362574454676, 283.38327201872437, -396.3842771140124, -82.03328312605838, -154.68012806623338, 116.57676910674631, -227.94068108817837, 217.44710794903918, -1.6862262170132958, 12.512551624066083, 201.82556947417834, 195.1376655174451, 134.0988212642963, -115.10792456894939, -193.0829223502661, 371.4943485643124, 111.1660982065138, 381.8682343310198, -19.786426204394502, 315.58000201389154, 219.30049416896995, -185.0886805128669, 72.26019901473623, -497.75851779512556, 19.75119593505214, 88.59120514007608, -58.74019494929354, -692.1655184110501, 161.4941873976433, 189.14571736775025, 81.01919670437637, -10.15290333869329, -99.64919657755951, 10.30497486222798, -32.13909198940963, -30.110663089082408, -121.22859884405565, 236.69787735784607, -125.06827545440558, 20.65506370846417, -21.77571323288374, -81.24050767289316, 102.10568001080523, -100.26899179574221, -45.410809389453306, -19.144922026836653, 128.00877444276432, -54.573409347023116, 84.48176888654483, 362.70423199661786, -16.845855756134853, -463.65908784744124, -429.29057945275053, 109.28648642249532, 20.15727253091118, 99.99218036776695, -269.03559979468884, -35.850943529005455, 27.10326518145648, 257.76323328871666, 34.44678394650214, 233.45220368567644, 54.9676980715976, 20.662042959925728, 165.85145745946483, -98.04269391087496, 111.04650768849966, 198.87034731521612, 211.7186172308135, 109.28317036790244, 390.50082934801765, -256.63569710382865, 87.59222572317776, -433.51267724517515, 22.88639018245472, -293.05634202734655, 65.20000000000041, 211.05263990390034, 393.65714923920245, -400.55233931519484, 133.67548607735617, 265.6114396478128, -287.19639052009893, 307.2905164065658, 331.71669494846054, 188.96735297747418, 208.41001977811445, 76.72049618151783, 73.11622318628682, -27.84330402064569, 32.13014581546037, 103.94820213298061, -190.09807030605654, 204.06757911278595, 49.167571163531974, 350.8085339151728, 203.5222201408425, 23.5799680610196, -283.35683351327646, -6.011027885811416, 47.793213055760695, 211.90000000000003, 218.63737703900338, 140.16548901750804, -205.63906381638023, -171.2280060097446, -82.0644873520675, -35.019174483015775, 34.273546202241306, 159.30386208923906, 331.8027028408861, -241.10541029771193, 210.50158949078167, -88.77639277881971, 6.511838523731001, 10.41252671023733], "policy_predator_policy_reward": [70.1263944975367, 101.1283407263613, 267.5986988336185, 66.7287917000595, 7.0321094199421275, 131.5373741575703, 177.1662505879205, 340.509630646915, 96.75597146474357, 105.19386593479838, 167.83009591405877, 114.97979172321988, 12.291903085736012, 124.1813568754777, 215.3392514545002, 85.2283888829188, 189.02060428578372, 428.3607799218877, 229.71156134552947, 270.46291554751383, 89.1735198458331, 34.670593575971836, 73.27124592605338, 83.80558698729985, 259.3435568684434, 3.5075795354352417, 134.68838841238886, 307.18419350658957, 154.16475784204818, 153.39257473474274, 397.7456523750817, 144.14787323464358, 85.80925049738894, 154.26721264452922, 194.64068464416886, 224.4331576378701, 39.18622621701358, 25.287448375933916, 83.25341697209858, 90.38334803627781, 74.59014760338508, 236.51895570126692, 146.97885624676084, 118.40971753919162, 25.433901793486164, 9.131765668980211, 225.6864262043939, 43.91999798610836, 88.29950583103006, 215.08868051286538, 450.15547837608034, 168.0404812513352, 24.192401816982073, 180.06519710788962, 652.553836784755, 440.22344060044225, 45.80581260235696, 124.8542826322498, 140.5701968977511, 79.16350973656613, 221.44919657755977, 135.3950251377718, 93.03909198940985, 65.01066308908291, 139.95168193788064, 90.47903954832795, 174.768655675599, 10.644556070342302, 209.41401213227462, 197.2022087735011, 174.2529480035777, 67.21036378135953, 91.93325671059789, 37.31321522218078, 249.68897169108126, 100.20855140687378, 23.718231113454113, 23.395768003382095, 607.2694014313035, 304.39948504830835, 534.3030218057464, 24.56077805289866, 355.8263777805508, 45.21664531792486, 297.9355997946953, 69.95094352900595, 33.74014099697644, 50.593360532850625, 5.053216053498084, 7.54779631432365, 27.532301928402518, 114.43795704007323, 107.3485425405353, 289.44269391087505, 55.44586271640393, 53.73728227988038, 61.3853150079954, 66.01289739328901, 3.699170651982424, 281.43569710383366, 5.007774276822439, 453.11267724517404, 231.7812112685353, 317.4983878633647, 0.0, 36.44736009609975, 0.8428507607975394, 422.4523393151963, 85.22451392264398, 44.988560352187264, 316.29639052010555, 57.90948359343419, 35.87324851691365, 24.34270355715166, 5.689980221885493, 5.879503818482311, 100.96649365446027, 119.56058717989919, 52.24200540626445, 3.479646645294846, 227.49807030605498, 60.432420887214185, 9.732428836468484, 23.59146608482728, 184.8273428404908, 22.787009996144956, 309.15683351327954, 286.7110278858118, 26.806786944239796, 0.0, 37.31231331640524, 164.9848206270833, 200.65111446728594, 234.31595535883562, 374.7059799147782, 63.06180435366925, 182.02645379775836, 72.79613791076063, 176.23603327858473, 287.357718074224, 68.99841050921837, 291.67639277882, 215.71085131332805, 162.0323883183163]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8440386334219756, "mean_inference_ms": 3.6741589086444133, "mean_action_processing_ms": 1.6833511054481936, "mean_env_wait_ms": 9.062522895964001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037946634822421605, "StateBufferConnector_ms": 0.018554760350121394, "ViewRequirementAgentConnector_ms": 0.09811619917551677}, "num_episodes": 0, "episode_return_max": 596.2, "episode_return_min": 50.14817390893885, "episode_return_mean": 342.9182192953029, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.81919220327806, "num_env_steps_trained_throughput_per_sec": 81.81919220327806, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 48849.585, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48849.528, "sample_time_ms": 2229.175, "learn_time_ms": 46603.198, "learn_throughput": 85.831, "synch_weights_time_ms": 14.3}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "fed12_00000", "date": "2024-08-21_18-14-24", "timestamp": 1724244264, "time_this_iter_s": 48.948468923568726, "time_total_s": 590.2847511768341, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f33fb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 590.2847511768341, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 25.095652173913045, "ram_util_percent": 82.79999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.58687034176771, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.466993066999647, "policy_loss": -0.02384741785862143, "vf_loss": 7.487921970357339, "vf_explained_var": 0.2507842241456269, "kl": 0.014592599449925638, "entropy": 1.469075305436654, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.028562991770487, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.221973696587578, "policy_loss": -0.021824251549692933, "vf_loss": 4.240464256301759, "vf_explained_var": 0.1725243987229766, "kl": 0.01666848623026261, "entropy": 1.400358734433613, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 714.7, "episode_reward_min": 50.14817390893885, "episode_reward_mean": 356.7823162373653, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 32800, "policy_reward_min": {"prey_policy": -804.0541286987267, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 393.65714923920245, "predator_policy": 694.4243348694733}, "policy_reward_mean": {"prey_policy": 28.57773644707103, "predator_policy": 149.81342167161154}, "custom_metrics": {}, "hist_stats": {"episode_reward": [386.1000000000015, 197.51835524911462, 596.1133809444206, 196.82703865013434, 438.7999999999996, 596.2, 511.20000000000067, 203.18947686234648, 50.14817390893885, 453.9775392428047, 394.100000000002, 409.20000000000243, 328.33818928255846, 218.72539877141233, 372.16697885096926, 63.47596536965264, 201.97310418243262, 408.5802691429035, 75.3, 570.5999999999997, 330.0999999999993, 443.8000000000007, 527.6000000000003, 565.4000000000002, 337.6000000000006, 192.6976408470236, 312.60000000000105, 341.87156402485107, 521.2999999999993, 290.5999999999994, 267.50000000000017, 95.8000000000002, 345.9000000000006, 81.00000000000031, 303.59999999999945, 243.29999999999947, 64.69074051648902, 423.3328881936959, 494.3000000000046, 431.1639428760358, 238.85970682838445, 521.192475997154, 63.000000000000625, 369.20000000000164, 280.5, 217.60000000000025, 464.6, 419.0999999999999, 448.3999999999994, 419.00000000000296, 112.2000000000005, 279.1096472870081, 312.7000000000005, 416.4000000000015, 529.4999999999998, 394.3000000000019, 580.8999999999993, 296.6999999999996, 265.7999999999995, 191.79999999999959, 301.9, 433.30000000000314, 434.71654103849653, 306.50000000000034, 286.4999999999992, 561.0999999999999, 58.10000000000056, 320.68412243336354, 448.40000000000003, 554.291043895983, 482.4000000000001, 394.6676048656137, 73.20000000000051, 662.033220009229, 536.9757200947306, 313.74403646001616, 656.0, 714.7, 546.3999999999993, 324.4698940468212, 195.4999999999988, 543.0152715913472], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [279.37360550246325, -64.52834072636338, -136.77718655049136, -0.031948734072287266, 343.4949423932625, 114.04895497364518, -132.07230458932005, -188.7765379953822, 51.744028535255964, 185.10613406520133, 102.36990408594093, 211.02020827678015, 228.27467196829085, 146.45206807049533, -97.59057190660336, 0.21240843152950362, -154.79070745979166, -412.4425028389413, 68.98774845900061, -115.1846861092391, -54.47351984583348, 324.7294064240282, -5.1712459260533645, 257.29441301270015, -228.14355686844348, 293.630609747124, -105.54083218977273, -117.60635095779426, -218.77362574454676, 283.38327201872437, -396.3842771140124, -82.03328312605838, -154.68012806623338, 116.57676910674631, -227.94068108817837, 217.44710794903918, -1.6862262170132958, 12.512551624066083, 201.82556947417834, 195.1376655174451, 134.0988212642963, -115.10792456894939, -193.0829223502661, 371.4943485643124, 111.1660982065138, 381.8682343310198, -19.786426204394502, 315.58000201389154, 219.30049416896995, -185.0886805128669, 72.26019901473623, -497.75851779512556, 19.75119593505214, 88.59120514007608, -58.74019494929354, -692.1655184110501, 161.4941873976433, 189.14571736775025, 81.01919670437637, -10.15290333869329, -99.64919657755951, 10.30497486222798, -32.13909198940963, -30.110663089082408, -121.22859884405565, 236.69787735784607, -125.06827545440558, 20.65506370846417, -21.77571323288374, -81.24050767289316, 102.10568001080523, -100.26899179574221, -45.410809389453306, -19.144922026836653, 128.00877444276432, -54.573409347023116, 84.48176888654483, 362.70423199661786, -16.845855756134853, -463.65908784744124, -429.29057945275053, 109.28648642249532, 20.15727253091118, 99.99218036776695, -269.03559979468884, -35.850943529005455, 27.10326518145648, 257.76323328871666, 34.44678394650214, 233.45220368567644, 54.9676980715976, 20.662042959925728, 165.85145745946483, -98.04269391087496, 111.04650768849966, 198.87034731521612, 211.7186172308135, 109.28317036790244, 390.50082934801765, -256.63569710382865, 87.59222572317776, -433.51267724517515, 22.88639018245472, -293.05634202734655, 65.20000000000041, 211.05263990390034, 393.65714923920245, -400.55233931519484, 133.67548607735617, 265.6114396478128, -287.19639052009893, 307.2905164065658, 331.71669494846054, 188.96735297747418, 208.41001977811445, 76.72049618151783, 73.11622318628682, -27.84330402064569, 32.13014581546037, 103.94820213298061, -190.09807030605654, 204.06757911278595, 49.167571163531974, 350.8085339151728, 203.5222201408425, 23.5799680610196, -283.35683351327646, -6.011027885811416, 47.793213055760695, 211.90000000000003, 218.63737703900338, 140.16548901750804, -205.63906381638023, -171.2280060097446, -82.0644873520675, -35.019174483015775, 34.273546202241306, 159.30386208923906, 331.8027028408861, -241.10541029771193, 210.50158949078167, -88.77639277881971, 6.511838523731001, 10.41252671023733, -103.57059063305935, -83.41022537710765, 300.04941035647363, 210.46419530815467, 247.10844644825042, 2.08204294335449, -432.3090228100289, 105.7843586775592, 331.20465024970144, -2.379567192357541, 326.2575007725435, 287.1165325078351, 365.49290273733664, 25.334607500629787, 122.96873023153115, 40.0000000000003, -456.09979031069577, 73.05453750953427, -804.0541286987267, 369.72073923062493], "policy_predator_policy_reward": [70.1263944975367, 101.1283407263613, 267.5986988336185, 66.7287917000595, 7.0321094199421275, 131.5373741575703, 177.1662505879205, 340.509630646915, 96.75597146474357, 105.19386593479838, 167.83009591405877, 114.97979172321988, 12.291903085736012, 124.1813568754777, 215.3392514545002, 85.2283888829188, 189.02060428578372, 428.3607799218877, 229.71156134552947, 270.46291554751383, 89.1735198458331, 34.670593575971836, 73.27124592605338, 83.80558698729985, 259.3435568684434, 3.5075795354352417, 134.68838841238886, 307.18419350658957, 154.16475784204818, 153.39257473474274, 397.7456523750817, 144.14787323464358, 85.80925049738894, 154.26721264452922, 194.64068464416886, 224.4331576378701, 39.18622621701358, 25.287448375933916, 83.25341697209858, 90.38334803627781, 74.59014760338508, 236.51895570126692, 146.97885624676084, 118.40971753919162, 25.433901793486164, 9.131765668980211, 225.6864262043939, 43.91999798610836, 88.29950583103006, 215.08868051286538, 450.15547837608034, 168.0404812513352, 24.192401816982073, 180.06519710788962, 652.553836784755, 440.22344060044225, 45.80581260235696, 124.8542826322498, 140.5701968977511, 79.16350973656613, 221.44919657755977, 135.3950251377718, 93.03909198940985, 65.01066308908291, 139.95168193788064, 90.47903954832795, 174.768655675599, 10.644556070342302, 209.41401213227462, 197.2022087735011, 174.2529480035777, 67.21036378135953, 91.93325671059789, 37.31321522218078, 249.68897169108126, 100.20855140687378, 23.718231113454113, 23.395768003382095, 607.2694014313035, 304.39948504830835, 534.3030218057464, 24.56077805289866, 355.8263777805508, 45.21664531792486, 297.9355997946953, 69.95094352900595, 33.74014099697644, 50.593360532850625, 5.053216053498084, 7.54779631432365, 27.532301928402518, 114.43795704007323, 107.3485425405353, 289.44269391087505, 55.44586271640393, 53.73728227988038, 61.3853150079954, 66.01289739328901, 3.699170651982424, 281.43569710383366, 5.007774276822439, 453.11267724517404, 231.7812112685353, 317.4983878633647, 0.0, 36.44736009609975, 0.8428507607975394, 422.4523393151963, 85.22451392264398, 44.988560352187264, 316.29639052010555, 57.90948359343419, 35.87324851691365, 24.34270355715166, 5.689980221885493, 5.879503818482311, 100.96649365446027, 119.56058717989919, 52.24200540626445, 3.479646645294846, 227.49807030605498, 60.432420887214185, 9.732428836468484, 23.59146608482728, 184.8273428404908, 22.787009996144956, 309.15683351327954, 286.7110278858118, 26.806786944239796, 0.0, 37.31231331640524, 164.9848206270833, 200.65111446728594, 234.31595535883562, 374.7059799147782, 63.06180435366925, 182.02645379775836, 72.79613791076063, 176.23603327858473, 287.357718074224, 68.99841050921837, 291.67639277882, 215.71085131332805, 162.0323883183163, 142.37059063305784, 117.8102253771057, 47.28380965275516, 104.2358046918453, 13.491891749785237, 274.2933389533412, 129.08153096872255, 511.1871696237642, 45.618006928954905, 281.5569100137014, 41.77204043750459, 59.553926282116805, 0.0, 155.57248976203377, 13.829561370286548, 147.67160244500133, 177.59724254446854, 400.94801025669335, 694.4243348694733, 282.924326189976]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8275367954603228, "mean_inference_ms": 3.6612890151557425, "mean_action_processing_ms": 1.6377968264086618, "mean_env_wait_ms": 9.113975559922478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038062653890470178, "StateBufferConnector_ms": 0.01680967284411919, "ViewRequirementAgentConnector_ms": 0.09794540521575183}, "num_episodes": 10, "episode_return_max": 714.7, "episode_return_min": 50.14817390893885, "episode_return_mean": 356.7823162373653, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.93735167452209, "num_env_steps_trained_throughput_per_sec": 81.93735167452209, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 48827.748, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48827.693, "sample_time_ms": 2219.356, "learn_time_ms": 46591.066, "learn_throughput": 85.853, "synch_weights_time_ms": 14.444}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "fed12_00000", "date": "2024-08-21_18-15-13", "timestamp": 1724244313, "time_this_iter_s": 48.856005907058716, "time_total_s": 639.1407570838928, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f1b48b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 639.1407570838928, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 26.072463768115938, "ram_util_percent": 82.80869565217392}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.832156304203012, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.6762400228510455, "policy_loss": -0.024194272303529992, "vf_loss": 7.697237187592441, "vf_explained_var": 0.3076845387302378, "kl": 0.015985521969075003, "entropy": 1.4197542367158114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6206195332070505, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.415480722825994, "policy_loss": -0.026125075546014443, "vf_loss": 5.438168477255201, "vf_explained_var": 0.1711306526862755, "kl": 0.01718655790167826, "entropy": 1.304728057334032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 714.7, "episode_reward_min": 50.14817390893885, "episode_reward_mean": 350.54174009993534, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -920.3825420464145, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 393.65714923920245, "predator_policy": 963.0645080576669}, "policy_reward_mean": {"prey_policy": -20.06668844703261, "predator_policy": 195.33755849700032}, "custom_metrics": {}, "hist_stats": {"episode_reward": [511.20000000000067, 203.18947686234648, 50.14817390893885, 453.9775392428047, 394.100000000002, 409.20000000000243, 328.33818928255846, 218.72539877141233, 372.16697885096926, 63.47596536965264, 201.97310418243262, 408.5802691429035, 75.3, 570.5999999999997, 330.0999999999993, 443.8000000000007, 527.6000000000003, 565.4000000000002, 337.6000000000006, 192.6976408470236, 312.60000000000105, 341.87156402485107, 521.2999999999993, 290.5999999999994, 267.50000000000017, 95.8000000000002, 345.9000000000006, 81.00000000000031, 303.59999999999945, 243.29999999999947, 64.69074051648902, 423.3328881936959, 494.3000000000046, 431.1639428760358, 238.85970682838445, 521.192475997154, 63.000000000000625, 369.20000000000164, 280.5, 217.60000000000025, 464.6, 419.0999999999999, 448.3999999999994, 419.00000000000296, 112.2000000000005, 279.1096472870081, 312.7000000000005, 416.4000000000015, 529.4999999999998, 394.3000000000019, 580.8999999999993, 296.6999999999996, 265.7999999999995, 191.79999999999959, 301.9, 433.30000000000314, 434.71654103849653, 306.50000000000034, 286.4999999999992, 561.0999999999999, 58.10000000000056, 320.68412243336354, 448.40000000000003, 554.291043895983, 482.4000000000001, 394.6676048656137, 73.20000000000051, 662.033220009229, 536.9757200947306, 313.74403646001616, 656.0, 714.7, 546.3999999999993, 324.4698940468212, 195.4999999999988, 543.0152715913472, 123.50000000000021, 330.6000000000005, 416.6914268662387, 406.8883303875136, 287.4554184501087, 397.23282554406046, 142.29999999999902, 300.9881441011586, 228.05864844252835, 413.1388858909183, 581.9255834599579, 303.7000000000002, 365.5581136377143, 408.68561879497076, 332.2079808073913, 264.3797508919558, 351.31803398874985, 502.8351882908192, 119.28071052577937, 284.29999999999916, 248.28196601124958, 462.7997234360565, 400.1226804767784, 537.3338233692972], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [228.27467196829085, 146.45206807049533, -97.59057190660336, 0.21240843152950362, -154.79070745979166, -412.4425028389413, 68.98774845900061, -115.1846861092391, -54.47351984583348, 324.7294064240282, -5.1712459260533645, 257.29441301270015, -228.14355686844348, 293.630609747124, -105.54083218977273, -117.60635095779426, -218.77362574454676, 283.38327201872437, -396.3842771140124, -82.03328312605838, -154.68012806623338, 116.57676910674631, -227.94068108817837, 217.44710794903918, -1.6862262170132958, 12.512551624066083, 201.82556947417834, 195.1376655174451, 134.0988212642963, -115.10792456894939, -193.0829223502661, 371.4943485643124, 111.1660982065138, 381.8682343310198, -19.786426204394502, 315.58000201389154, 219.30049416896995, -185.0886805128669, 72.26019901473623, -497.75851779512556, 19.75119593505214, 88.59120514007608, -58.74019494929354, -692.1655184110501, 161.4941873976433, 189.14571736775025, 81.01919670437637, -10.15290333869329, -99.64919657755951, 10.30497486222798, -32.13909198940963, -30.110663089082408, -121.22859884405565, 236.69787735784607, -125.06827545440558, 20.65506370846417, -21.77571323288374, -81.24050767289316, 102.10568001080523, -100.26899179574221, -45.410809389453306, -19.144922026836653, 128.00877444276432, -54.573409347023116, 84.48176888654483, 362.70423199661786, -16.845855756134853, -463.65908784744124, -429.29057945275053, 109.28648642249532, 20.15727253091118, 99.99218036776695, -269.03559979468884, -35.850943529005455, 27.10326518145648, 257.76323328871666, 34.44678394650214, 233.45220368567644, 54.9676980715976, 20.662042959925728, 165.85145745946483, -98.04269391087496, 111.04650768849966, 198.87034731521612, 211.7186172308135, 109.28317036790244, 390.50082934801765, -256.63569710382865, 87.59222572317776, -433.51267724517515, 22.88639018245472, -293.05634202734655, 65.20000000000041, 211.05263990390034, 393.65714923920245, -400.55233931519484, 133.67548607735617, 265.6114396478128, -287.19639052009893, 307.2905164065658, 331.71669494846054, 188.96735297747418, 208.41001977811445, 76.72049618151783, 73.11622318628682, -27.84330402064569, 32.13014581546037, 103.94820213298061, -190.09807030605654, 204.06757911278595, 49.167571163531974, 350.8085339151728, 203.5222201408425, 23.5799680610196, -283.35683351327646, -6.011027885811416, 47.793213055760695, 211.90000000000003, 218.63737703900338, 140.16548901750804, -205.63906381638023, -171.2280060097446, -82.0644873520675, -35.019174483015775, 34.273546202241306, 159.30386208923906, 331.8027028408861, -241.10541029771193, 210.50158949078167, -88.77639277881971, 6.511838523731001, 10.41252671023733, -103.57059063305935, -83.41022537710765, 300.04941035647363, 210.46419530815467, 247.10844644825042, 2.08204294335449, -432.3090228100289, 105.7843586775592, 331.20465024970144, -2.379567192357541, 326.2575007725435, 287.1165325078351, 365.49290273733664, 25.334607500629787, 122.96873023153115, 40.0000000000003, -456.09979031069577, 73.05453750953427, -804.0541286987267, 369.72073923062493, -24.988158942720716, 37.404446332797775, -281.0549222874019, 149.02676624700908, -343.9238023197122, -137.8997443156002, -446.38445971443326, 237.60972236287424, -149.57607775007767, -264.95692976630824, 4.874096986018742, -216.907356677235, -514.0398003536236, -420.6505836084567, -587.7811836234108, -98.49265349893088, -348.6967788676099, -519.6447264930814, -643.4924226161053, 152.00698783224172, 65.09852475680002, 242.08625705476632, -307.4842859192785, -44.52872539979478, 27.227764638655003, 143.42155969767225, -90.11667946527858, -193.21399808130644, -596.8864737567019, 81.52941930949544, -226.9966253442678, -80.43263256284682, -844.5950004332931, 176.81478650203263, -89.17184017170399, 2.9632151725938978, -255.73867223691443, -225.18185496142036, -240.25793886839426, 0.9647563879292989, -920.3825420464145, -227.22309124590734, 234.37480051984915, -402.2324926065478, 131.33243313167947, -319.2000771671261, 319.6177553866605, 120.66423129357521], "policy_predator_policy_reward": [12.291903085736012, 124.1813568754777, 215.3392514545002, 85.2283888829188, 189.02060428578372, 428.3607799218877, 229.71156134552947, 270.46291554751383, 89.1735198458331, 34.670593575971836, 73.27124592605338, 83.80558698729985, 259.3435568684434, 3.5075795354352417, 134.68838841238886, 307.18419350658957, 154.16475784204818, 153.39257473474274, 397.7456523750817, 144.14787323464358, 85.80925049738894, 154.26721264452922, 194.64068464416886, 224.4331576378701, 39.18622621701358, 25.287448375933916, 83.25341697209858, 90.38334803627781, 74.59014760338508, 236.51895570126692, 146.97885624676084, 118.40971753919162, 25.433901793486164, 9.131765668980211, 225.6864262043939, 43.91999798610836, 88.29950583103006, 215.08868051286538, 450.15547837608034, 168.0404812513352, 24.192401816982073, 180.06519710788962, 652.553836784755, 440.22344060044225, 45.80581260235696, 124.8542826322498, 140.5701968977511, 79.16350973656613, 221.44919657755977, 135.3950251377718, 93.03909198940985, 65.01066308908291, 139.95168193788064, 90.47903954832795, 174.768655675599, 10.644556070342302, 209.41401213227462, 197.2022087735011, 174.2529480035777, 67.21036378135953, 91.93325671059789, 37.31321522218078, 249.68897169108126, 100.20855140687378, 23.718231113454113, 23.395768003382095, 607.2694014313035, 304.39948504830835, 534.3030218057464, 24.56077805289866, 355.8263777805508, 45.21664531792486, 297.9355997946953, 69.95094352900595, 33.74014099697644, 50.593360532850625, 5.053216053498084, 7.54779631432365, 27.532301928402518, 114.43795704007323, 107.3485425405353, 289.44269391087505, 55.44586271640393, 53.73728227988038, 61.3853150079954, 66.01289739328901, 3.699170651982424, 281.43569710383366, 5.007774276822439, 453.11267724517404, 231.7812112685353, 317.4983878633647, 0.0, 36.44736009609975, 0.8428507607975394, 422.4523393151963, 85.22451392264398, 44.988560352187264, 316.29639052010555, 57.90948359343419, 35.87324851691365, 24.34270355715166, 5.689980221885493, 5.879503818482311, 100.96649365446027, 119.56058717989919, 52.24200540626445, 3.479646645294846, 227.49807030605498, 60.432420887214185, 9.732428836468484, 23.59146608482728, 184.8273428404908, 22.787009996144956, 309.15683351327954, 286.7110278858118, 26.806786944239796, 0.0, 37.31231331640524, 164.9848206270833, 200.65111446728594, 234.31595535883562, 374.7059799147782, 63.06180435366925, 182.02645379775836, 72.79613791076063, 176.23603327858473, 287.357718074224, 68.99841050921837, 291.67639277882, 215.71085131332805, 162.0323883183163, 142.37059063305784, 117.8102253771057, 47.28380965275516, 104.2358046918453, 13.491891749785237, 274.2933389533412, 129.08153096872255, 511.1871696237642, 45.618006928954905, 281.5569100137014, 41.77204043750459, 59.553926282116805, 0.0, 155.57248976203377, 13.829561370286548, 147.67160244500133, 177.59724254446854, 400.94801025669335, 694.4243348694733, 282.924326189976, 108.68815894271894, 2.395553667202486, 312.1549222874058, 150.47323375299078, 619.3281569157961, 279.18681658575525, 40.98993957845551, 574.6731281606177, 505.09051821119715, 196.89790775529505, 32.304943579676305, 576.9611416556007, 637.039800353623, 439.95058360846053, 398.65505864432043, 588.6069225791799, 419.940981070201, 676.4591727330178, 307.490063770841, 597.1342569039407, 93.94314762554583, 180.79765402284556, 336.1842859192825, 319.5287253997946, 18.330348999058053, 176.57844030232775, 44.029288170565245, 647.9870081709885, 128.17256986341886, 719.3924653911787, 442.80313965292476, 129.00586914614405, 852.1710244131034, 166.92722350690767, 225.15202959769232, 363.891783692237, 277.285325064824, 322.9159126592959, 410.61388173956897, 112.9793007408983, 963.0645080576669, 432.8230912459073, 69.19233463802598, 561.465080884731, 102.66499306426313, 485.32533144796196, 69.43283577745933, 27.619000911603095]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7877710353495306, "mean_inference_ms": 3.632863871308332, "mean_action_processing_ms": 1.5605699883238913, "mean_env_wait_ms": 9.24003394709327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003951430320739746, "StateBufferConnector_ms": 0.014669299125671387, "ViewRequirementAgentConnector_ms": 0.12070655822753906}, "num_episodes": 24, "episode_return_max": 714.7, "episode_return_min": 50.14817390893885, "episode_return_mean": 350.54174009993534, "episodes_this_iter": 24}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.46974836578218, "num_env_steps_trained_throughput_per_sec": 81.46974836578218, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 48855.697, "restore_workers_time_ms": 0.013, "training_step_time_ms": 48855.643, "sample_time_ms": 2240.379, "learn_time_ms": 46597.587, "learn_throughput": 85.841, "synch_weights_time_ms": 14.689}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "fed12_00000", "date": "2024-08-21_18-16-02", "timestamp": 1724244362, "time_this_iter_s": 49.13675093650818, "time_total_s": 688.277508020401, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f33fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 688.277508020401, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 25.1, "ram_util_percent": 82.72753623188407}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.71909257425833, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.432444052721458, "policy_loss": -0.028049582654176643, "vf_loss": 8.456870366908886, "vf_explained_var": 0.29114210006421204, "kl": 0.01811631522584884, "entropy": 1.3910592059609752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.153433487781141, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.6064480007010165, "policy_loss": -0.020911782424128243, "vf_loss": 6.623769503295737, "vf_explained_var": 0.16567053025361722, "kl": 0.017951347317211527, "entropy": 1.2059370225068753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 714.7, "episode_reward_min": 58.10000000000056, "episode_reward_mean": 359.4794216028577, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -920.3825420464145, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 393.65714923920245, "predator_policy": 963.0645080576669}, "policy_reward_mean": {"prey_policy": -52.344620843090524, "predator_policy": 232.08433164451952}, "custom_metrics": {}, "hist_stats": {"episode_reward": [521.2999999999993, 290.5999999999994, 267.50000000000017, 95.8000000000002, 345.9000000000006, 81.00000000000031, 303.59999999999945, 243.29999999999947, 64.69074051648902, 423.3328881936959, 494.3000000000046, 431.1639428760358, 238.85970682838445, 521.192475997154, 63.000000000000625, 369.20000000000164, 280.5, 217.60000000000025, 464.6, 419.0999999999999, 448.3999999999994, 419.00000000000296, 112.2000000000005, 279.1096472870081, 312.7000000000005, 416.4000000000015, 529.4999999999998, 394.3000000000019, 580.8999999999993, 296.6999999999996, 265.7999999999995, 191.79999999999959, 301.9, 433.30000000000314, 434.71654103849653, 306.50000000000034, 286.4999999999992, 561.0999999999999, 58.10000000000056, 320.68412243336354, 448.40000000000003, 554.291043895983, 482.4000000000001, 394.6676048656137, 73.20000000000051, 662.033220009229, 536.9757200947306, 313.74403646001616, 656.0, 714.7, 546.3999999999993, 324.4698940468212, 195.4999999999988, 543.0152715913472, 123.50000000000021, 330.6000000000005, 416.6914268662387, 406.8883303875136, 287.4554184501087, 397.23282554406046, 142.29999999999902, 300.9881441011586, 228.05864844252835, 413.1388858909183, 581.9255834599579, 303.7000000000002, 365.5581136377143, 408.68561879497076, 332.2079808073913, 264.3797508919558, 351.31803398874985, 502.8351882908192, 119.28071052577937, 284.29999999999916, 248.28196601124958, 462.7997234360565, 400.1226804767784, 537.3338233692972, 337.44524903746196, 646.425029942791, 265.89337524529765, 366.2578664414934, 343.30000000000047, 320.1783407851516, 275.00563359097794, 545.7060629858365, 226.8495465950384, 207.634375389322, 576.9633939484314, 492.44902465861367, 160.88298648829795, 292.25816565228195, 564.5772581691606, 221.60510479192266, 396.10000000000207, 290.26432400896715, 293.8218398258553, 495.12145554084856, 425.4087178810514, 462.26469979933944], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [161.4941873976433, 189.14571736775025, 81.01919670437637, -10.15290333869329, -99.64919657755951, 10.30497486222798, -32.13909198940963, -30.110663089082408, -121.22859884405565, 236.69787735784607, -125.06827545440558, 20.65506370846417, -21.77571323288374, -81.24050767289316, 102.10568001080523, -100.26899179574221, -45.410809389453306, -19.144922026836653, 128.00877444276432, -54.573409347023116, 84.48176888654483, 362.70423199661786, -16.845855756134853, -463.65908784744124, -429.29057945275053, 109.28648642249532, 20.15727253091118, 99.99218036776695, -269.03559979468884, -35.850943529005455, 27.10326518145648, 257.76323328871666, 34.44678394650214, 233.45220368567644, 54.9676980715976, 20.662042959925728, 165.85145745946483, -98.04269391087496, 111.04650768849966, 198.87034731521612, 211.7186172308135, 109.28317036790244, 390.50082934801765, -256.63569710382865, 87.59222572317776, -433.51267724517515, 22.88639018245472, -293.05634202734655, 65.20000000000041, 211.05263990390034, 393.65714923920245, -400.55233931519484, 133.67548607735617, 265.6114396478128, -287.19639052009893, 307.2905164065658, 331.71669494846054, 188.96735297747418, 208.41001977811445, 76.72049618151783, 73.11622318628682, -27.84330402064569, 32.13014581546037, 103.94820213298061, -190.09807030605654, 204.06757911278595, 49.167571163531974, 350.8085339151728, 203.5222201408425, 23.5799680610196, -283.35683351327646, -6.011027885811416, 47.793213055760695, 211.90000000000003, 218.63737703900338, 140.16548901750804, -205.63906381638023, -171.2280060097446, -82.0644873520675, -35.019174483015775, 34.273546202241306, 159.30386208923906, 331.8027028408861, -241.10541029771193, 210.50158949078167, -88.77639277881971, 6.511838523731001, 10.41252671023733, -103.57059063305935, -83.41022537710765, 300.04941035647363, 210.46419530815467, 247.10844644825042, 2.08204294335449, -432.3090228100289, 105.7843586775592, 331.20465024970144, -2.379567192357541, 326.2575007725435, 287.1165325078351, 365.49290273733664, 25.334607500629787, 122.96873023153115, 40.0000000000003, -456.09979031069577, 73.05453750953427, -804.0541286987267, 369.72073923062493, -24.988158942720716, 37.404446332797775, -281.0549222874019, 149.02676624700908, -343.9238023197122, -137.8997443156002, -446.38445971443326, 237.60972236287424, -149.57607775007767, -264.95692976630824, 4.874096986018742, -216.907356677235, -514.0398003536236, -420.6505836084567, -587.7811836234108, -98.49265349893088, -348.6967788676099, -519.6447264930814, -643.4924226161053, 152.00698783224172, 65.09852475680002, 242.08625705476632, -307.4842859192785, -44.52872539979478, 27.227764638655003, 143.42155969767225, -90.11667946527858, -193.21399808130644, -596.8864737567019, 81.52941930949544, -226.9966253442678, -80.43263256284682, -844.5950004332931, 176.81478650203263, -89.17184017170399, 2.9632151725938978, -255.73867223691443, -225.18185496142036, -240.25793886839426, 0.9647563879292989, -920.3825420464145, -227.22309124590734, 234.37480051984915, -402.2324926065478, 131.33243313167947, -319.2000771671261, 319.6177553866605, 120.66423129357521, -97.28725287720287, -570.6163366608296, 144.56544909255024, 303.69121519462686, -315.9334048377125, -289.8540671529937, 109.5828799876, -584.5701871867004, 1.5108193465220232, -178.55588479417258, -286.7749480133737, -78.64806327175036, -514.269551395352, -110.64213195656997, 173.3451434517006, -28.215598731026624, -405.5275285227403, -494.79659293961504, -543.2801337230935, -274.94438051340387, 265.8325551620684, 50.97658078305879, 79.76627189166939, -84.07662547243636, -690.8251448199063, -107.48939668167014, -172.42473260012227, -44.346390304053166, -358.82519356582065, 297.64256095134317, -641.5876385897881, -256.78921942515944, 239.58032285827784, 29.053721745056215, -444.6220538861353, -18.558049317709944, -532.9612376197878, -286.20913667510905, -3.2197174032913782, 163.66918102260578, -153.7048557165888, 247.21858676698253, -0.7599860405863086, -65.30384657916588], "policy_predator_policy_reward": [45.80581260235696, 124.8542826322498, 140.5701968977511, 79.16350973656613, 221.44919657755977, 135.3950251377718, 93.03909198940985, 65.01066308908291, 139.95168193788064, 90.47903954832795, 174.768655675599, 10.644556070342302, 209.41401213227462, 197.2022087735011, 174.2529480035777, 67.21036378135953, 91.93325671059789, 37.31321522218078, 249.68897169108126, 100.20855140687378, 23.718231113454113, 23.395768003382095, 607.2694014313035, 304.39948504830835, 534.3030218057464, 24.56077805289866, 355.8263777805508, 45.21664531792486, 297.9355997946953, 69.95094352900595, 33.74014099697644, 50.593360532850625, 5.053216053498084, 7.54779631432365, 27.532301928402518, 114.43795704007323, 107.3485425405353, 289.44269391087505, 55.44586271640393, 53.73728227988038, 61.3853150079954, 66.01289739328901, 3.699170651982424, 281.43569710383366, 5.007774276822439, 453.11267724517404, 231.7812112685353, 317.4983878633647, 0.0, 36.44736009609975, 0.8428507607975394, 422.4523393151963, 85.22451392264398, 44.988560352187264, 316.29639052010555, 57.90948359343419, 35.87324851691365, 24.34270355715166, 5.689980221885493, 5.879503818482311, 100.96649365446027, 119.56058717989919, 52.24200540626445, 3.479646645294846, 227.49807030605498, 60.432420887214185, 9.732428836468484, 23.59146608482728, 184.8273428404908, 22.787009996144956, 309.15683351327954, 286.7110278858118, 26.806786944239796, 0.0, 37.31231331640524, 164.9848206270833, 200.65111446728594, 234.31595535883562, 374.7059799147782, 63.06180435366925, 182.02645379775836, 72.79613791076063, 176.23603327858473, 287.357718074224, 68.99841050921837, 291.67639277882, 215.71085131332805, 162.0323883183163, 142.37059063305784, 117.8102253771057, 47.28380965275516, 104.2358046918453, 13.491891749785237, 274.2933389533412, 129.08153096872255, 511.1871696237642, 45.618006928954905, 281.5569100137014, 41.77204043750459, 59.553926282116805, 0.0, 155.57248976203377, 13.829561370286548, 147.67160244500133, 177.59724254446854, 400.94801025669335, 694.4243348694733, 282.924326189976, 108.68815894271894, 2.395553667202486, 312.1549222874058, 150.47323375299078, 619.3281569157961, 279.18681658575525, 40.98993957845551, 574.6731281606177, 505.09051821119715, 196.89790775529505, 32.304943579676305, 576.9611416556007, 637.039800353623, 439.95058360846053, 398.65505864432043, 588.6069225791799, 419.940981070201, 676.4591727330178, 307.490063770841, 597.1342569039407, 93.94314762554583, 180.79765402284556, 336.1842859192825, 319.5287253997946, 18.330348999058053, 176.57844030232775, 44.029288170565245, 647.9870081709885, 128.17256986341886, 719.3924653911787, 442.80313965292476, 129.00586914614405, 852.1710244131034, 166.92722350690767, 225.15202959769232, 363.891783692237, 277.285325064824, 322.9159126592959, 410.61388173956897, 112.9793007408983, 963.0645080576669, 432.8230912459073, 69.19233463802598, 561.465080884731, 102.66499306426313, 485.32533144796196, 69.43283577745933, 27.619000911603095, 470.0944227763296, 535.2544157991647, 167.23005034940803, 30.93831530620575, 11.628173582203349, 860.0526736538028, 26.56992888111423, 814.6752447594789, 272.4891806534781, 247.85588479417098, 315.4520152550003, 370.14933681527225, 549.161120613019, 350.75619632987997, 295.6158788951344, 104.96063937002813, 540.598323024218, 586.5753450331756, 607.0053956518641, 418.85349397395476, 48.72003555830683, 211.43422244499752, 182.8167440397152, 313.9426341996656, 807.9358750885766, 151.26165290129768, 234.41665232084273, 274.61263623561564, 107.16333732881503, 518.5965534548232, 704.0887936630894, 415.893169143781, 117.51967714172214, 9.946278254943948, 650.2861526401919, 103.15827457262061, 665.1738265737699, 447.81838754698225, 52.13669092667582, 282.5353009948579, 147.74738109395986, 184.14760573669815, 308.49808977543995, 219.8304426436516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6956361728524625, "mean_inference_ms": 3.5820680498688535, "mean_action_processing_ms": 1.5206848232424517, "mean_env_wait_ms": 9.391750282581526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003857851028442383, "StateBufferConnector_ms": 0.014744400978088379, "ViewRequirementAgentConnector_ms": 0.12601101398468018}, "num_episodes": 22, "episode_return_max": 714.7, "episode_return_min": 58.10000000000056, "episode_return_mean": 359.4794216028577, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.16828986334787, "num_env_steps_trained_throughput_per_sec": 82.16828986334787, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 48715.146, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48715.092, "sample_time_ms": 2133.822, "learn_time_ms": 46563.871, "learn_throughput": 85.904, "synch_weights_time_ms": 14.559}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "fed12_00000", "date": "2024-08-21_18-16-51", "timestamp": 1724244411, "time_this_iter_s": 48.68679094314575, "time_total_s": 736.9642989635468, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f3119d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 736.9642989635468, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 25.415942028985512, "ram_util_percent": 82.15507246376811}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.436740419978188, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.484747886910009, "policy_loss": -0.02315515397220022, "vf_loss": 8.504376759352507, "vf_explained_var": 0.19234154016252547, "kl": 0.017631429954673403, "entropy": 1.3440954887047016, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999993}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.543507621212611, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.510523637388118, "policy_loss": -0.018703012077246235, "vf_loss": 7.526205016696264, "vf_explained_var": 0.17039461665683323, "kl": 0.015108139528129151, "entropy": 1.1377524348793837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999993}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 714.7, "episode_reward_min": 58.10000000000056, "episode_reward_mean": 367.5829777444098, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -996.5479513264862, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 393.65714923920245, "predator_policy": 1049.3001384391534}, "policy_reward_mean": {"prey_policy": -85.25372760692848, "predator_policy": 269.0452164791335}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.5, 217.60000000000025, 464.6, 419.0999999999999, 448.3999999999994, 419.00000000000296, 112.2000000000005, 279.1096472870081, 312.7000000000005, 416.4000000000015, 529.4999999999998, 394.3000000000019, 580.8999999999993, 296.6999999999996, 265.7999999999995, 191.79999999999959, 301.9, 433.30000000000314, 434.71654103849653, 306.50000000000034, 286.4999999999992, 561.0999999999999, 58.10000000000056, 320.68412243336354, 448.40000000000003, 554.291043895983, 482.4000000000001, 394.6676048656137, 73.20000000000051, 662.033220009229, 536.9757200947306, 313.74403646001616, 656.0, 714.7, 546.3999999999993, 324.4698940468212, 195.4999999999988, 543.0152715913472, 123.50000000000021, 330.6000000000005, 416.6914268662387, 406.8883303875136, 287.4554184501087, 397.23282554406046, 142.29999999999902, 300.9881441011586, 228.05864844252835, 413.1388858909183, 581.9255834599579, 303.7000000000002, 365.5581136377143, 408.68561879497076, 332.2079808073913, 264.3797508919558, 351.31803398874985, 502.8351882908192, 119.28071052577937, 284.29999999999916, 248.28196601124958, 462.7997234360565, 400.1226804767784, 537.3338233692972, 337.44524903746196, 646.425029942791, 265.89337524529765, 366.2578664414934, 343.30000000000047, 320.1783407851516, 275.00563359097794, 545.7060629858365, 226.8495465950384, 207.634375389322, 576.9633939484314, 492.44902465861367, 160.88298648829795, 292.25816565228195, 564.5772581691606, 221.60510479192266, 396.10000000000207, 290.26432400896715, 293.8218398258553, 495.12145554084856, 425.4087178810514, 462.26469979933944, 154.10736224123673, 489.6373373892453, 306.13373751211014, 401.1376735926828, 122.82363176457257, 329.3614530705435, 203.59999999999943, 597.0781880519073, 416.84120419997, 318.5705613514498, 477.3954869331041, 407.76176332249815, 332.90876272604334, 213.3685278558723, 505.4278472061666, 288.94183134957996], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [34.44678394650214, 233.45220368567644, 54.9676980715976, 20.662042959925728, 165.85145745946483, -98.04269391087496, 111.04650768849966, 198.87034731521612, 211.7186172308135, 109.28317036790244, 390.50082934801765, -256.63569710382865, 87.59222572317776, -433.51267724517515, 22.88639018245472, -293.05634202734655, 65.20000000000041, 211.05263990390034, 393.65714923920245, -400.55233931519484, 133.67548607735617, 265.6114396478128, -287.19639052009893, 307.2905164065658, 331.71669494846054, 188.96735297747418, 208.41001977811445, 76.72049618151783, 73.11622318628682, -27.84330402064569, 32.13014581546037, 103.94820213298061, -190.09807030605654, 204.06757911278595, 49.167571163531974, 350.8085339151728, 203.5222201408425, 23.5799680610196, -283.35683351327646, -6.011027885811416, 47.793213055760695, 211.90000000000003, 218.63737703900338, 140.16548901750804, -205.63906381638023, -171.2280060097446, -82.0644873520675, -35.019174483015775, 34.273546202241306, 159.30386208923906, 331.8027028408861, -241.10541029771193, 210.50158949078167, -88.77639277881971, 6.511838523731001, 10.41252671023733, -103.57059063305935, -83.41022537710765, 300.04941035647363, 210.46419530815467, 247.10844644825042, 2.08204294335449, -432.3090228100289, 105.7843586775592, 331.20465024970144, -2.379567192357541, 326.2575007725435, 287.1165325078351, 365.49290273733664, 25.334607500629787, 122.96873023153115, 40.0000000000003, -456.09979031069577, 73.05453750953427, -804.0541286987267, 369.72073923062493, -24.988158942720716, 37.404446332797775, -281.0549222874019, 149.02676624700908, -343.9238023197122, -137.8997443156002, -446.38445971443326, 237.60972236287424, -149.57607775007767, -264.95692976630824, 4.874096986018742, -216.907356677235, -514.0398003536236, -420.6505836084567, -587.7811836234108, -98.49265349893088, -348.6967788676099, -519.6447264930814, -643.4924226161053, 152.00698783224172, 65.09852475680002, 242.08625705476632, -307.4842859192785, -44.52872539979478, 27.227764638655003, 143.42155969767225, -90.11667946527858, -193.21399808130644, -596.8864737567019, 81.52941930949544, -226.9966253442678, -80.43263256284682, -844.5950004332931, 176.81478650203263, -89.17184017170399, 2.9632151725938978, -255.73867223691443, -225.18185496142036, -240.25793886839426, 0.9647563879292989, -920.3825420464145, -227.22309124590734, 234.37480051984915, -402.2324926065478, 131.33243313167947, -319.2000771671261, 319.6177553866605, 120.66423129357521, -97.28725287720287, -570.6163366608296, 144.56544909255024, 303.69121519462686, -315.9334048377125, -289.8540671529937, 109.5828799876, -584.5701871867004, 1.5108193465220232, -178.55588479417258, -286.7749480133737, -78.64806327175036, -514.269551395352, -110.64213195656997, 173.3451434517006, -28.215598731026624, -405.5275285227403, -494.79659293961504, -543.2801337230935, -274.94438051340387, 265.8325551620684, 50.97658078305879, 79.76627189166939, -84.07662547243636, -690.8251448199063, -107.48939668167014, -172.42473260012227, -44.346390304053166, -358.82519356582065, 297.64256095134317, -641.5876385897881, -256.78921942515944, 239.58032285827784, 29.053721745056215, -444.6220538861353, -18.558049317709944, -532.9612376197878, -286.20913667510905, -3.2197174032913782, 163.66918102260578, -153.7048557165888, 247.21858676698253, -0.7599860405863086, -65.30384657916588, -418.95248136990284, 2.1675874418962526, 289.80932483364927, -609.849653256575, -303.05073584660664, -72.40574361791808, 235.99079060264123, -754.1871835662688, -996.5479513264862, -611.8889477716192, -21.063090113849967, 70.08337974842662, -193.7584629047521, -139.46757741649986, 376.5990243808458, -357.21622699558867, -392.9331798089448, 142.0714028357631, -667.8595622845363, 77.68605268928866, -2.831852359477997, -21.34708814928001, -20.28446557866834, -254.3998696062032, -270.0511514927424, -237.79243315717625, -302.20921077619204, -232.9009236194393, 85.79789913715051, -246.55046830643806, -561.024603163705, -237.97919056005463], "policy_predator_policy_reward": [5.053216053498084, 7.54779631432365, 27.532301928402518, 114.43795704007323, 107.3485425405353, 289.44269391087505, 55.44586271640393, 53.73728227988038, 61.3853150079954, 66.01289739328901, 3.699170651982424, 281.43569710383366, 5.007774276822439, 453.11267724517404, 231.7812112685353, 317.4983878633647, 0.0, 36.44736009609975, 0.8428507607975394, 422.4523393151963, 85.22451392264398, 44.988560352187264, 316.29639052010555, 57.90948359343419, 35.87324851691365, 24.34270355715166, 5.689980221885493, 5.879503818482311, 100.96649365446027, 119.56058717989919, 52.24200540626445, 3.479646645294846, 227.49807030605498, 60.432420887214185, 9.732428836468484, 23.59146608482728, 184.8273428404908, 22.787009996144956, 309.15683351327954, 286.7110278858118, 26.806786944239796, 0.0, 37.31231331640524, 164.9848206270833, 200.65111446728594, 234.31595535883562, 374.7059799147782, 63.06180435366925, 182.02645379775836, 72.79613791076063, 176.23603327858473, 287.357718074224, 68.99841050921837, 291.67639277882, 215.71085131332805, 162.0323883183163, 142.37059063305784, 117.8102253771057, 47.28380965275516, 104.2358046918453, 13.491891749785237, 274.2933389533412, 129.08153096872255, 511.1871696237642, 45.618006928954905, 281.5569100137014, 41.77204043750459, 59.553926282116805, 0.0, 155.57248976203377, 13.829561370286548, 147.67160244500133, 177.59724254446854, 400.94801025669335, 694.4243348694733, 282.924326189976, 108.68815894271894, 2.395553667202486, 312.1549222874058, 150.47323375299078, 619.3281569157961, 279.18681658575525, 40.98993957845551, 574.6731281606177, 505.09051821119715, 196.89790775529505, 32.304943579676305, 576.9611416556007, 637.039800353623, 439.95058360846053, 398.65505864432043, 588.6069225791799, 419.940981070201, 676.4591727330178, 307.490063770841, 597.1342569039407, 93.94314762554583, 180.79765402284556, 336.1842859192825, 319.5287253997946, 18.330348999058053, 176.57844030232775, 44.029288170565245, 647.9870081709885, 128.17256986341886, 719.3924653911787, 442.80313965292476, 129.00586914614405, 852.1710244131034, 166.92722350690767, 225.15202959769232, 363.891783692237, 277.285325064824, 322.9159126592959, 410.61388173956897, 112.9793007408983, 963.0645080576669, 432.8230912459073, 69.19233463802598, 561.465080884731, 102.66499306426313, 485.32533144796196, 69.43283577745933, 27.619000911603095, 470.0944227763296, 535.2544157991647, 167.23005034940803, 30.93831530620575, 11.628173582203349, 860.0526736538028, 26.56992888111423, 814.6752447594789, 272.4891806534781, 247.85588479417098, 315.4520152550003, 370.14933681527225, 549.161120613019, 350.75619632987997, 295.6158788951344, 104.96063937002813, 540.598323024218, 586.5753450331756, 607.0053956518641, 418.85349397395476, 48.72003555830683, 211.43422244499752, 182.8167440397152, 313.9426341996656, 807.9358750885766, 151.26165290129768, 234.41665232084273, 274.61263623561564, 107.16333732881503, 518.5965534548232, 704.0887936630894, 415.893169143781, 117.51967714172214, 9.946278254943948, 650.2861526401919, 103.15827457262061, 665.1738265737699, 447.81838754698225, 52.13669092667582, 282.5353009948579, 147.74738109395986, 184.14760573669815, 308.49808977543995, 219.8304426436516, 488.49975346699216, 82.39250270225259, 460.56478406220515, 349.1128817499654, 381.6677650182157, 299.9224519584193, 14.017702634634716, 905.3163639216768, 681.9603924235232, 1049.3001384391534, 280.3411634359682, 0.0, 362.9584629047534, 173.8675774164979, 263.09004483227994, 314.60534583437, 657.3986108366034, 10.304370336547207, 874.8453825112366, 33.898688435460755, 402.9728622620519, 98.60156517980992, 226.6917245821155, 455.75437392525447, 572.5076607016533, 268.2446866743092, 608.0393790239406, 140.4392832275626, 365.4918931202727, 300.68852325518156, 523.8943387963201, 564.0512862770191]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6652127163355797, "mean_inference_ms": 3.5253381732731905, "mean_action_processing_ms": 1.464191526844781, "mean_env_wait_ms": 9.465466615585864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.005212187767028809, "ViewRequirementAgentConnector_ms": 0.15870893001556396}, "num_episodes": 16, "episode_return_max": 714.7, "episode_return_min": 58.10000000000056, "episode_return_mean": 367.5829777444098, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.75402296660562, "num_env_steps_trained_throughput_per_sec": 81.75402296660562, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 48704.641, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48704.587, "sample_time_ms": 2145.53, "learn_time_ms": 46540.88, "learn_throughput": 85.946, "synch_weights_time_ms": 14.903}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "fed12_00000", "date": "2024-08-21_18-17-40", "timestamp": 1724244460, "time_this_iter_s": 48.974857807159424, "time_total_s": 785.9391567707062, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f33f4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 785.9391567707062, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 25.46376811594203, "ram_util_percent": 82.66811594202896}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.041631658998115, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.599539615742113, "policy_loss": -0.022953844801202494, "vf_loss": 8.619521383507541, "vf_explained_var": 0.19348180527409548, "kl": 0.014860305441888395, "entropy": 1.3263181692708736, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.324080893696931, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.04924196969895, "policy_loss": -0.02312206555103696, "vf_loss": 8.068668508529663, "vf_explained_var": 0.1817765040057046, "kl": 0.018477595675115786, "entropy": 1.0752639992842599, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 714.7, "episode_reward_min": 58.10000000000056, "episode_reward_mean": 367.5829777444098, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -996.5479513264862, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 393.65714923920245, "predator_policy": 1049.3001384391534}, "policy_reward_mean": {"prey_policy": -85.25372760692848, "predator_policy": 269.0452164791335}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.5, 217.60000000000025, 464.6, 419.0999999999999, 448.3999999999994, 419.00000000000296, 112.2000000000005, 279.1096472870081, 312.7000000000005, 416.4000000000015, 529.4999999999998, 394.3000000000019, 580.8999999999993, 296.6999999999996, 265.7999999999995, 191.79999999999959, 301.9, 433.30000000000314, 434.71654103849653, 306.50000000000034, 286.4999999999992, 561.0999999999999, 58.10000000000056, 320.68412243336354, 448.40000000000003, 554.291043895983, 482.4000000000001, 394.6676048656137, 73.20000000000051, 662.033220009229, 536.9757200947306, 313.74403646001616, 656.0, 714.7, 546.3999999999993, 324.4698940468212, 195.4999999999988, 543.0152715913472, 123.50000000000021, 330.6000000000005, 416.6914268662387, 406.8883303875136, 287.4554184501087, 397.23282554406046, 142.29999999999902, 300.9881441011586, 228.05864844252835, 413.1388858909183, 581.9255834599579, 303.7000000000002, 365.5581136377143, 408.68561879497076, 332.2079808073913, 264.3797508919558, 351.31803398874985, 502.8351882908192, 119.28071052577937, 284.29999999999916, 248.28196601124958, 462.7997234360565, 400.1226804767784, 537.3338233692972, 337.44524903746196, 646.425029942791, 265.89337524529765, 366.2578664414934, 343.30000000000047, 320.1783407851516, 275.00563359097794, 545.7060629858365, 226.8495465950384, 207.634375389322, 576.9633939484314, 492.44902465861367, 160.88298648829795, 292.25816565228195, 564.5772581691606, 221.60510479192266, 396.10000000000207, 290.26432400896715, 293.8218398258553, 495.12145554084856, 425.4087178810514, 462.26469979933944, 154.10736224123673, 489.6373373892453, 306.13373751211014, 401.1376735926828, 122.82363176457257, 329.3614530705435, 203.59999999999943, 597.0781880519073, 416.84120419997, 318.5705613514498, 477.3954869331041, 407.76176332249815, 332.90876272604334, 213.3685278558723, 505.4278472061666, 288.94183134957996], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [34.44678394650214, 233.45220368567644, 54.9676980715976, 20.662042959925728, 165.85145745946483, -98.04269391087496, 111.04650768849966, 198.87034731521612, 211.7186172308135, 109.28317036790244, 390.50082934801765, -256.63569710382865, 87.59222572317776, -433.51267724517515, 22.88639018245472, -293.05634202734655, 65.20000000000041, 211.05263990390034, 393.65714923920245, -400.55233931519484, 133.67548607735617, 265.6114396478128, -287.19639052009893, 307.2905164065658, 331.71669494846054, 188.96735297747418, 208.41001977811445, 76.72049618151783, 73.11622318628682, -27.84330402064569, 32.13014581546037, 103.94820213298061, -190.09807030605654, 204.06757911278595, 49.167571163531974, 350.8085339151728, 203.5222201408425, 23.5799680610196, -283.35683351327646, -6.011027885811416, 47.793213055760695, 211.90000000000003, 218.63737703900338, 140.16548901750804, -205.63906381638023, -171.2280060097446, -82.0644873520675, -35.019174483015775, 34.273546202241306, 159.30386208923906, 331.8027028408861, -241.10541029771193, 210.50158949078167, -88.77639277881971, 6.511838523731001, 10.41252671023733, -103.57059063305935, -83.41022537710765, 300.04941035647363, 210.46419530815467, 247.10844644825042, 2.08204294335449, -432.3090228100289, 105.7843586775592, 331.20465024970144, -2.379567192357541, 326.2575007725435, 287.1165325078351, 365.49290273733664, 25.334607500629787, 122.96873023153115, 40.0000000000003, -456.09979031069577, 73.05453750953427, -804.0541286987267, 369.72073923062493, -24.988158942720716, 37.404446332797775, -281.0549222874019, 149.02676624700908, -343.9238023197122, -137.8997443156002, -446.38445971443326, 237.60972236287424, -149.57607775007767, -264.95692976630824, 4.874096986018742, -216.907356677235, -514.0398003536236, -420.6505836084567, -587.7811836234108, -98.49265349893088, -348.6967788676099, -519.6447264930814, -643.4924226161053, 152.00698783224172, 65.09852475680002, 242.08625705476632, -307.4842859192785, -44.52872539979478, 27.227764638655003, 143.42155969767225, -90.11667946527858, -193.21399808130644, -596.8864737567019, 81.52941930949544, -226.9966253442678, -80.43263256284682, -844.5950004332931, 176.81478650203263, -89.17184017170399, 2.9632151725938978, -255.73867223691443, -225.18185496142036, -240.25793886839426, 0.9647563879292989, -920.3825420464145, -227.22309124590734, 234.37480051984915, -402.2324926065478, 131.33243313167947, -319.2000771671261, 319.6177553866605, 120.66423129357521, -97.28725287720287, -570.6163366608296, 144.56544909255024, 303.69121519462686, -315.9334048377125, -289.8540671529937, 109.5828799876, -584.5701871867004, 1.5108193465220232, -178.55588479417258, -286.7749480133737, -78.64806327175036, -514.269551395352, -110.64213195656997, 173.3451434517006, -28.215598731026624, -405.5275285227403, -494.79659293961504, -543.2801337230935, -274.94438051340387, 265.8325551620684, 50.97658078305879, 79.76627189166939, -84.07662547243636, -690.8251448199063, -107.48939668167014, -172.42473260012227, -44.346390304053166, -358.82519356582065, 297.64256095134317, -641.5876385897881, -256.78921942515944, 239.58032285827784, 29.053721745056215, -444.6220538861353, -18.558049317709944, -532.9612376197878, -286.20913667510905, -3.2197174032913782, 163.66918102260578, -153.7048557165888, 247.21858676698253, -0.7599860405863086, -65.30384657916588, -418.95248136990284, 2.1675874418962526, 289.80932483364927, -609.849653256575, -303.05073584660664, -72.40574361791808, 235.99079060264123, -754.1871835662688, -996.5479513264862, -611.8889477716192, -21.063090113849967, 70.08337974842662, -193.7584629047521, -139.46757741649986, 376.5990243808458, -357.21622699558867, -392.9331798089448, 142.0714028357631, -667.8595622845363, 77.68605268928866, -2.831852359477997, -21.34708814928001, -20.28446557866834, -254.3998696062032, -270.0511514927424, -237.79243315717625, -302.20921077619204, -232.9009236194393, 85.79789913715051, -246.55046830643806, -561.024603163705, -237.97919056005463], "policy_predator_policy_reward": [5.053216053498084, 7.54779631432365, 27.532301928402518, 114.43795704007323, 107.3485425405353, 289.44269391087505, 55.44586271640393, 53.73728227988038, 61.3853150079954, 66.01289739328901, 3.699170651982424, 281.43569710383366, 5.007774276822439, 453.11267724517404, 231.7812112685353, 317.4983878633647, 0.0, 36.44736009609975, 0.8428507607975394, 422.4523393151963, 85.22451392264398, 44.988560352187264, 316.29639052010555, 57.90948359343419, 35.87324851691365, 24.34270355715166, 5.689980221885493, 5.879503818482311, 100.96649365446027, 119.56058717989919, 52.24200540626445, 3.479646645294846, 227.49807030605498, 60.432420887214185, 9.732428836468484, 23.59146608482728, 184.8273428404908, 22.787009996144956, 309.15683351327954, 286.7110278858118, 26.806786944239796, 0.0, 37.31231331640524, 164.9848206270833, 200.65111446728594, 234.31595535883562, 374.7059799147782, 63.06180435366925, 182.02645379775836, 72.79613791076063, 176.23603327858473, 287.357718074224, 68.99841050921837, 291.67639277882, 215.71085131332805, 162.0323883183163, 142.37059063305784, 117.8102253771057, 47.28380965275516, 104.2358046918453, 13.491891749785237, 274.2933389533412, 129.08153096872255, 511.1871696237642, 45.618006928954905, 281.5569100137014, 41.77204043750459, 59.553926282116805, 0.0, 155.57248976203377, 13.829561370286548, 147.67160244500133, 177.59724254446854, 400.94801025669335, 694.4243348694733, 282.924326189976, 108.68815894271894, 2.395553667202486, 312.1549222874058, 150.47323375299078, 619.3281569157961, 279.18681658575525, 40.98993957845551, 574.6731281606177, 505.09051821119715, 196.89790775529505, 32.304943579676305, 576.9611416556007, 637.039800353623, 439.95058360846053, 398.65505864432043, 588.6069225791799, 419.940981070201, 676.4591727330178, 307.490063770841, 597.1342569039407, 93.94314762554583, 180.79765402284556, 336.1842859192825, 319.5287253997946, 18.330348999058053, 176.57844030232775, 44.029288170565245, 647.9870081709885, 128.17256986341886, 719.3924653911787, 442.80313965292476, 129.00586914614405, 852.1710244131034, 166.92722350690767, 225.15202959769232, 363.891783692237, 277.285325064824, 322.9159126592959, 410.61388173956897, 112.9793007408983, 963.0645080576669, 432.8230912459073, 69.19233463802598, 561.465080884731, 102.66499306426313, 485.32533144796196, 69.43283577745933, 27.619000911603095, 470.0944227763296, 535.2544157991647, 167.23005034940803, 30.93831530620575, 11.628173582203349, 860.0526736538028, 26.56992888111423, 814.6752447594789, 272.4891806534781, 247.85588479417098, 315.4520152550003, 370.14933681527225, 549.161120613019, 350.75619632987997, 295.6158788951344, 104.96063937002813, 540.598323024218, 586.5753450331756, 607.0053956518641, 418.85349397395476, 48.72003555830683, 211.43422244499752, 182.8167440397152, 313.9426341996656, 807.9358750885766, 151.26165290129768, 234.41665232084273, 274.61263623561564, 107.16333732881503, 518.5965534548232, 704.0887936630894, 415.893169143781, 117.51967714172214, 9.946278254943948, 650.2861526401919, 103.15827457262061, 665.1738265737699, 447.81838754698225, 52.13669092667582, 282.5353009948579, 147.74738109395986, 184.14760573669815, 308.49808977543995, 219.8304426436516, 488.49975346699216, 82.39250270225259, 460.56478406220515, 349.1128817499654, 381.6677650182157, 299.9224519584193, 14.017702634634716, 905.3163639216768, 681.9603924235232, 1049.3001384391534, 280.3411634359682, 0.0, 362.9584629047534, 173.8675774164979, 263.09004483227994, 314.60534583437, 657.3986108366034, 10.304370336547207, 874.8453825112366, 33.898688435460755, 402.9728622620519, 98.60156517980992, 226.6917245821155, 455.75437392525447, 572.5076607016533, 268.2446866743092, 608.0393790239406, 140.4392832275626, 365.4918931202727, 300.68852325518156, 523.8943387963201, 564.0512862770191]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6652127163355797, "mean_inference_ms": 3.5253381732731905, "mean_action_processing_ms": 1.464191526844781, "mean_env_wait_ms": 9.465466615585864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.005212187767028809, "ViewRequirementAgentConnector_ms": 0.15870893001556396}, "num_episodes": 0, "episode_return_max": 714.7, "episode_return_min": 58.10000000000056, "episode_return_mean": 367.5829777444098, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.12056907079966, "num_env_steps_trained_throughput_per_sec": 81.12056907079966, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 48808.294, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48808.239, "sample_time_ms": 2186.644, "learn_time_ms": 46602.898, "learn_throughput": 85.832, "synch_weights_time_ms": 14.953}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "fed12_00000", "date": "2024-08-21_18-18-29", "timestamp": 1724244509, "time_this_iter_s": 49.344977140426636, "time_total_s": 835.2841339111328, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4bdf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 835.2841339111328, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 27.395714285714288, "ram_util_percent": 82.81142857142859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.05444393858077, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.275341566529855, "policy_loss": -0.01974783002881816, "vf_loss": 8.292284384227933, "vf_explained_var": 0.1599675290168278, "kl": 0.014024956368166145, "entropy": 1.3286615151576895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.35981239591326, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.640064482714133, "policy_loss": -0.02187093427853176, "vf_loss": 7.658663696208328, "vf_explained_var": 0.21836216083910098, "kl": 0.016358670922952196, "entropy": 1.0567966765827603, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 714.7, "episode_reward_min": 58.10000000000056, "episode_reward_mean": 367.5829777444098, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -996.5479513264862, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 393.65714923920245, "predator_policy": 1049.3001384391534}, "policy_reward_mean": {"prey_policy": -85.25372760692848, "predator_policy": 269.0452164791335}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.5, 217.60000000000025, 464.6, 419.0999999999999, 448.3999999999994, 419.00000000000296, 112.2000000000005, 279.1096472870081, 312.7000000000005, 416.4000000000015, 529.4999999999998, 394.3000000000019, 580.8999999999993, 296.6999999999996, 265.7999999999995, 191.79999999999959, 301.9, 433.30000000000314, 434.71654103849653, 306.50000000000034, 286.4999999999992, 561.0999999999999, 58.10000000000056, 320.68412243336354, 448.40000000000003, 554.291043895983, 482.4000000000001, 394.6676048656137, 73.20000000000051, 662.033220009229, 536.9757200947306, 313.74403646001616, 656.0, 714.7, 546.3999999999993, 324.4698940468212, 195.4999999999988, 543.0152715913472, 123.50000000000021, 330.6000000000005, 416.6914268662387, 406.8883303875136, 287.4554184501087, 397.23282554406046, 142.29999999999902, 300.9881441011586, 228.05864844252835, 413.1388858909183, 581.9255834599579, 303.7000000000002, 365.5581136377143, 408.68561879497076, 332.2079808073913, 264.3797508919558, 351.31803398874985, 502.8351882908192, 119.28071052577937, 284.29999999999916, 248.28196601124958, 462.7997234360565, 400.1226804767784, 537.3338233692972, 337.44524903746196, 646.425029942791, 265.89337524529765, 366.2578664414934, 343.30000000000047, 320.1783407851516, 275.00563359097794, 545.7060629858365, 226.8495465950384, 207.634375389322, 576.9633939484314, 492.44902465861367, 160.88298648829795, 292.25816565228195, 564.5772581691606, 221.60510479192266, 396.10000000000207, 290.26432400896715, 293.8218398258553, 495.12145554084856, 425.4087178810514, 462.26469979933944, 154.10736224123673, 489.6373373892453, 306.13373751211014, 401.1376735926828, 122.82363176457257, 329.3614530705435, 203.59999999999943, 597.0781880519073, 416.84120419997, 318.5705613514498, 477.3954869331041, 407.76176332249815, 332.90876272604334, 213.3685278558723, 505.4278472061666, 288.94183134957996], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [34.44678394650214, 233.45220368567644, 54.9676980715976, 20.662042959925728, 165.85145745946483, -98.04269391087496, 111.04650768849966, 198.87034731521612, 211.7186172308135, 109.28317036790244, 390.50082934801765, -256.63569710382865, 87.59222572317776, -433.51267724517515, 22.88639018245472, -293.05634202734655, 65.20000000000041, 211.05263990390034, 393.65714923920245, -400.55233931519484, 133.67548607735617, 265.6114396478128, -287.19639052009893, 307.2905164065658, 331.71669494846054, 188.96735297747418, 208.41001977811445, 76.72049618151783, 73.11622318628682, -27.84330402064569, 32.13014581546037, 103.94820213298061, -190.09807030605654, 204.06757911278595, 49.167571163531974, 350.8085339151728, 203.5222201408425, 23.5799680610196, -283.35683351327646, -6.011027885811416, 47.793213055760695, 211.90000000000003, 218.63737703900338, 140.16548901750804, -205.63906381638023, -171.2280060097446, -82.0644873520675, -35.019174483015775, 34.273546202241306, 159.30386208923906, 331.8027028408861, -241.10541029771193, 210.50158949078167, -88.77639277881971, 6.511838523731001, 10.41252671023733, -103.57059063305935, -83.41022537710765, 300.04941035647363, 210.46419530815467, 247.10844644825042, 2.08204294335449, -432.3090228100289, 105.7843586775592, 331.20465024970144, -2.379567192357541, 326.2575007725435, 287.1165325078351, 365.49290273733664, 25.334607500629787, 122.96873023153115, 40.0000000000003, -456.09979031069577, 73.05453750953427, -804.0541286987267, 369.72073923062493, -24.988158942720716, 37.404446332797775, -281.0549222874019, 149.02676624700908, -343.9238023197122, -137.8997443156002, -446.38445971443326, 237.60972236287424, -149.57607775007767, -264.95692976630824, 4.874096986018742, -216.907356677235, -514.0398003536236, -420.6505836084567, -587.7811836234108, -98.49265349893088, -348.6967788676099, -519.6447264930814, -643.4924226161053, 152.00698783224172, 65.09852475680002, 242.08625705476632, -307.4842859192785, -44.52872539979478, 27.227764638655003, 143.42155969767225, -90.11667946527858, -193.21399808130644, -596.8864737567019, 81.52941930949544, -226.9966253442678, -80.43263256284682, -844.5950004332931, 176.81478650203263, -89.17184017170399, 2.9632151725938978, -255.73867223691443, -225.18185496142036, -240.25793886839426, 0.9647563879292989, -920.3825420464145, -227.22309124590734, 234.37480051984915, -402.2324926065478, 131.33243313167947, -319.2000771671261, 319.6177553866605, 120.66423129357521, -97.28725287720287, -570.6163366608296, 144.56544909255024, 303.69121519462686, -315.9334048377125, -289.8540671529937, 109.5828799876, -584.5701871867004, 1.5108193465220232, -178.55588479417258, -286.7749480133737, -78.64806327175036, -514.269551395352, -110.64213195656997, 173.3451434517006, -28.215598731026624, -405.5275285227403, -494.79659293961504, -543.2801337230935, -274.94438051340387, 265.8325551620684, 50.97658078305879, 79.76627189166939, -84.07662547243636, -690.8251448199063, -107.48939668167014, -172.42473260012227, -44.346390304053166, -358.82519356582065, 297.64256095134317, -641.5876385897881, -256.78921942515944, 239.58032285827784, 29.053721745056215, -444.6220538861353, -18.558049317709944, -532.9612376197878, -286.20913667510905, -3.2197174032913782, 163.66918102260578, -153.7048557165888, 247.21858676698253, -0.7599860405863086, -65.30384657916588, -418.95248136990284, 2.1675874418962526, 289.80932483364927, -609.849653256575, -303.05073584660664, -72.40574361791808, 235.99079060264123, -754.1871835662688, -996.5479513264862, -611.8889477716192, -21.063090113849967, 70.08337974842662, -193.7584629047521, -139.46757741649986, 376.5990243808458, -357.21622699558867, -392.9331798089448, 142.0714028357631, -667.8595622845363, 77.68605268928866, -2.831852359477997, -21.34708814928001, -20.28446557866834, -254.3998696062032, -270.0511514927424, -237.79243315717625, -302.20921077619204, -232.9009236194393, 85.79789913715051, -246.55046830643806, -561.024603163705, -237.97919056005463], "policy_predator_policy_reward": [5.053216053498084, 7.54779631432365, 27.532301928402518, 114.43795704007323, 107.3485425405353, 289.44269391087505, 55.44586271640393, 53.73728227988038, 61.3853150079954, 66.01289739328901, 3.699170651982424, 281.43569710383366, 5.007774276822439, 453.11267724517404, 231.7812112685353, 317.4983878633647, 0.0, 36.44736009609975, 0.8428507607975394, 422.4523393151963, 85.22451392264398, 44.988560352187264, 316.29639052010555, 57.90948359343419, 35.87324851691365, 24.34270355715166, 5.689980221885493, 5.879503818482311, 100.96649365446027, 119.56058717989919, 52.24200540626445, 3.479646645294846, 227.49807030605498, 60.432420887214185, 9.732428836468484, 23.59146608482728, 184.8273428404908, 22.787009996144956, 309.15683351327954, 286.7110278858118, 26.806786944239796, 0.0, 37.31231331640524, 164.9848206270833, 200.65111446728594, 234.31595535883562, 374.7059799147782, 63.06180435366925, 182.02645379775836, 72.79613791076063, 176.23603327858473, 287.357718074224, 68.99841050921837, 291.67639277882, 215.71085131332805, 162.0323883183163, 142.37059063305784, 117.8102253771057, 47.28380965275516, 104.2358046918453, 13.491891749785237, 274.2933389533412, 129.08153096872255, 511.1871696237642, 45.618006928954905, 281.5569100137014, 41.77204043750459, 59.553926282116805, 0.0, 155.57248976203377, 13.829561370286548, 147.67160244500133, 177.59724254446854, 400.94801025669335, 694.4243348694733, 282.924326189976, 108.68815894271894, 2.395553667202486, 312.1549222874058, 150.47323375299078, 619.3281569157961, 279.18681658575525, 40.98993957845551, 574.6731281606177, 505.09051821119715, 196.89790775529505, 32.304943579676305, 576.9611416556007, 637.039800353623, 439.95058360846053, 398.65505864432043, 588.6069225791799, 419.940981070201, 676.4591727330178, 307.490063770841, 597.1342569039407, 93.94314762554583, 180.79765402284556, 336.1842859192825, 319.5287253997946, 18.330348999058053, 176.57844030232775, 44.029288170565245, 647.9870081709885, 128.17256986341886, 719.3924653911787, 442.80313965292476, 129.00586914614405, 852.1710244131034, 166.92722350690767, 225.15202959769232, 363.891783692237, 277.285325064824, 322.9159126592959, 410.61388173956897, 112.9793007408983, 963.0645080576669, 432.8230912459073, 69.19233463802598, 561.465080884731, 102.66499306426313, 485.32533144796196, 69.43283577745933, 27.619000911603095, 470.0944227763296, 535.2544157991647, 167.23005034940803, 30.93831530620575, 11.628173582203349, 860.0526736538028, 26.56992888111423, 814.6752447594789, 272.4891806534781, 247.85588479417098, 315.4520152550003, 370.14933681527225, 549.161120613019, 350.75619632987997, 295.6158788951344, 104.96063937002813, 540.598323024218, 586.5753450331756, 607.0053956518641, 418.85349397395476, 48.72003555830683, 211.43422244499752, 182.8167440397152, 313.9426341996656, 807.9358750885766, 151.26165290129768, 234.41665232084273, 274.61263623561564, 107.16333732881503, 518.5965534548232, 704.0887936630894, 415.893169143781, 117.51967714172214, 9.946278254943948, 650.2861526401919, 103.15827457262061, 665.1738265737699, 447.81838754698225, 52.13669092667582, 282.5353009948579, 147.74738109395986, 184.14760573669815, 308.49808977543995, 219.8304426436516, 488.49975346699216, 82.39250270225259, 460.56478406220515, 349.1128817499654, 381.6677650182157, 299.9224519584193, 14.017702634634716, 905.3163639216768, 681.9603924235232, 1049.3001384391534, 280.3411634359682, 0.0, 362.9584629047534, 173.8675774164979, 263.09004483227994, 314.60534583437, 657.3986108366034, 10.304370336547207, 874.8453825112366, 33.898688435460755, 402.9728622620519, 98.60156517980992, 226.6917245821155, 455.75437392525447, 572.5076607016533, 268.2446866743092, 608.0393790239406, 140.4392832275626, 365.4918931202727, 300.68852325518156, 523.8943387963201, 564.0512862770191]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6652127163355797, "mean_inference_ms": 3.5253381732731905, "mean_action_processing_ms": 1.464191526844781, "mean_env_wait_ms": 9.465466615585864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.005212187767028809, "ViewRequirementAgentConnector_ms": 0.15870893001556396}, "num_episodes": 0, "episode_return_max": 714.7, "episode_return_min": 58.10000000000056, "episode_return_mean": 367.5829777444098, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.28459262413422, "num_env_steps_trained_throughput_per_sec": 81.28459262413422, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 48905.55, "restore_workers_time_ms": 0.013, "training_step_time_ms": 48905.495, "sample_time_ms": 2212.8, "learn_time_ms": 46674.035, "learn_throughput": 85.701, "synch_weights_time_ms": 14.974}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "fed12_00000", "date": "2024-08-21_18-19-19", "timestamp": 1724244559, "time_this_iter_s": 49.2571542263031, "time_total_s": 884.5412881374359, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f33fb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 884.5412881374359, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 26.263768115942028, "ram_util_percent": 80.95072463768116}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.573804902273512, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.39449604554151, "policy_loss": -0.02299412605648358, "vf_loss": 8.41429454838788, "vf_explained_var": 0.24135307120898414, "kl": 0.01597820261429266, "entropy": 1.3100821995230578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.733184749928732, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.584674285959315, "policy_loss": -0.020952230003519506, "vf_loss": 7.602155327418494, "vf_explained_var": 0.2685326011407943, "kl": 0.017355934604164704, "entropy": 1.035823006920083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 714.7, "episode_reward_min": 58.10000000000056, "episode_reward_mean": 368.92780195639637, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -996.5479513264862, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 393.65714923920245, "predator_policy": 1202.21998020858}, "policy_reward_mean": {"prey_policy": -93.01054523823022, "predator_policy": 277.47444621642853}, "custom_metrics": {}, "hist_stats": {"episode_reward": [419.0999999999999, 448.3999999999994, 419.00000000000296, 112.2000000000005, 279.1096472870081, 312.7000000000005, 416.4000000000015, 529.4999999999998, 394.3000000000019, 580.8999999999993, 296.6999999999996, 265.7999999999995, 191.79999999999959, 301.9, 433.30000000000314, 434.71654103849653, 306.50000000000034, 286.4999999999992, 561.0999999999999, 58.10000000000056, 320.68412243336354, 448.40000000000003, 554.291043895983, 482.4000000000001, 394.6676048656137, 73.20000000000051, 662.033220009229, 536.9757200947306, 313.74403646001616, 656.0, 714.7, 546.3999999999993, 324.4698940468212, 195.4999999999988, 543.0152715913472, 123.50000000000021, 330.6000000000005, 416.6914268662387, 406.8883303875136, 287.4554184501087, 397.23282554406046, 142.29999999999902, 300.9881441011586, 228.05864844252835, 413.1388858909183, 581.9255834599579, 303.7000000000002, 365.5581136377143, 408.68561879497076, 332.2079808073913, 264.3797508919558, 351.31803398874985, 502.8351882908192, 119.28071052577937, 284.29999999999916, 248.28196601124958, 462.7997234360565, 400.1226804767784, 537.3338233692972, 337.44524903746196, 646.425029942791, 265.89337524529765, 366.2578664414934, 343.30000000000047, 320.1783407851516, 275.00563359097794, 545.7060629858365, 226.8495465950384, 207.634375389322, 576.9633939484314, 492.44902465861367, 160.88298648829795, 292.25816565228195, 564.5772581691606, 221.60510479192266, 396.10000000000207, 290.26432400896715, 293.8218398258553, 495.12145554084856, 425.4087178810514, 462.26469979933944, 154.10736224123673, 489.6373373892453, 306.13373751211014, 401.1376735926828, 122.82363176457257, 329.3614530705435, 203.59999999999943, 597.0781880519073, 416.84120419997, 318.5705613514498, 477.3954869331041, 407.76176332249815, 332.90876272604334, 213.3685278558723, 505.4278472061666, 288.94183134957996, 394.21932836142713, 327.66309283722626, 375.30000000000155], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [111.04650768849966, 198.87034731521612, 211.7186172308135, 109.28317036790244, 390.50082934801765, -256.63569710382865, 87.59222572317776, -433.51267724517515, 22.88639018245472, -293.05634202734655, 65.20000000000041, 211.05263990390034, 393.65714923920245, -400.55233931519484, 133.67548607735617, 265.6114396478128, -287.19639052009893, 307.2905164065658, 331.71669494846054, 188.96735297747418, 208.41001977811445, 76.72049618151783, 73.11622318628682, -27.84330402064569, 32.13014581546037, 103.94820213298061, -190.09807030605654, 204.06757911278595, 49.167571163531974, 350.8085339151728, 203.5222201408425, 23.5799680610196, -283.35683351327646, -6.011027885811416, 47.793213055760695, 211.90000000000003, 218.63737703900338, 140.16548901750804, -205.63906381638023, -171.2280060097446, -82.0644873520675, -35.019174483015775, 34.273546202241306, 159.30386208923906, 331.8027028408861, -241.10541029771193, 210.50158949078167, -88.77639277881971, 6.511838523731001, 10.41252671023733, -103.57059063305935, -83.41022537710765, 300.04941035647363, 210.46419530815467, 247.10844644825042, 2.08204294335449, -432.3090228100289, 105.7843586775592, 331.20465024970144, -2.379567192357541, 326.2575007725435, 287.1165325078351, 365.49290273733664, 25.334607500629787, 122.96873023153115, 40.0000000000003, -456.09979031069577, 73.05453750953427, -804.0541286987267, 369.72073923062493, -24.988158942720716, 37.404446332797775, -281.0549222874019, 149.02676624700908, -343.9238023197122, -137.8997443156002, -446.38445971443326, 237.60972236287424, -149.57607775007767, -264.95692976630824, 4.874096986018742, -216.907356677235, -514.0398003536236, -420.6505836084567, -587.7811836234108, -98.49265349893088, -348.6967788676099, -519.6447264930814, -643.4924226161053, 152.00698783224172, 65.09852475680002, 242.08625705476632, -307.4842859192785, -44.52872539979478, 27.227764638655003, 143.42155969767225, -90.11667946527858, -193.21399808130644, -596.8864737567019, 81.52941930949544, -226.9966253442678, -80.43263256284682, -844.5950004332931, 176.81478650203263, -89.17184017170399, 2.9632151725938978, -255.73867223691443, -225.18185496142036, -240.25793886839426, 0.9647563879292989, -920.3825420464145, -227.22309124590734, 234.37480051984915, -402.2324926065478, 131.33243313167947, -319.2000771671261, 319.6177553866605, 120.66423129357521, -97.28725287720287, -570.6163366608296, 144.56544909255024, 303.69121519462686, -315.9334048377125, -289.8540671529937, 109.5828799876, -584.5701871867004, 1.5108193465220232, -178.55588479417258, -286.7749480133737, -78.64806327175036, -514.269551395352, -110.64213195656997, 173.3451434517006, -28.215598731026624, -405.5275285227403, -494.79659293961504, -543.2801337230935, -274.94438051340387, 265.8325551620684, 50.97658078305879, 79.76627189166939, -84.07662547243636, -690.8251448199063, -107.48939668167014, -172.42473260012227, -44.346390304053166, -358.82519356582065, 297.64256095134317, -641.5876385897881, -256.78921942515944, 239.58032285827784, 29.053721745056215, -444.6220538861353, -18.558049317709944, -532.9612376197878, -286.20913667510905, -3.2197174032913782, 163.66918102260578, -153.7048557165888, 247.21858676698253, -0.7599860405863086, -65.30384657916588, -418.95248136990284, 2.1675874418962526, 289.80932483364927, -609.849653256575, -303.05073584660664, -72.40574361791808, 235.99079060264123, -754.1871835662688, -996.5479513264862, -611.8889477716192, -21.063090113849967, 70.08337974842662, -193.7584629047521, -139.46757741649986, 376.5990243808458, -357.21622699558867, -392.9331798089448, 142.0714028357631, -667.8595622845363, 77.68605268928866, -2.831852359477997, -21.34708814928001, -20.28446557866834, -254.3998696062032, -270.0511514927424, -237.79243315717625, -302.20921077619204, -232.9009236194393, 85.79789913715051, -246.55046830643806, -561.024603163705, -237.97919056005463, -388.4570816717729, -173.686053892008, -718.9224072082114, -177.63114152213143, 287.66497984394556, 31.005670402120227], "policy_predator_policy_reward": [55.44586271640393, 53.73728227988038, 61.3853150079954, 66.01289739328901, 3.699170651982424, 281.43569710383366, 5.007774276822439, 453.11267724517404, 231.7812112685353, 317.4983878633647, 0.0, 36.44736009609975, 0.8428507607975394, 422.4523393151963, 85.22451392264398, 44.988560352187264, 316.29639052010555, 57.90948359343419, 35.87324851691365, 24.34270355715166, 5.689980221885493, 5.879503818482311, 100.96649365446027, 119.56058717989919, 52.24200540626445, 3.479646645294846, 227.49807030605498, 60.432420887214185, 9.732428836468484, 23.59146608482728, 184.8273428404908, 22.787009996144956, 309.15683351327954, 286.7110278858118, 26.806786944239796, 0.0, 37.31231331640524, 164.9848206270833, 200.65111446728594, 234.31595535883562, 374.7059799147782, 63.06180435366925, 182.02645379775836, 72.79613791076063, 176.23603327858473, 287.357718074224, 68.99841050921837, 291.67639277882, 215.71085131332805, 162.0323883183163, 142.37059063305784, 117.8102253771057, 47.28380965275516, 104.2358046918453, 13.491891749785237, 274.2933389533412, 129.08153096872255, 511.1871696237642, 45.618006928954905, 281.5569100137014, 41.77204043750459, 59.553926282116805, 0.0, 155.57248976203377, 13.829561370286548, 147.67160244500133, 177.59724254446854, 400.94801025669335, 694.4243348694733, 282.924326189976, 108.68815894271894, 2.395553667202486, 312.1549222874058, 150.47323375299078, 619.3281569157961, 279.18681658575525, 40.98993957845551, 574.6731281606177, 505.09051821119715, 196.89790775529505, 32.304943579676305, 576.9611416556007, 637.039800353623, 439.95058360846053, 398.65505864432043, 588.6069225791799, 419.940981070201, 676.4591727330178, 307.490063770841, 597.1342569039407, 93.94314762554583, 180.79765402284556, 336.1842859192825, 319.5287253997946, 18.330348999058053, 176.57844030232775, 44.029288170565245, 647.9870081709885, 128.17256986341886, 719.3924653911787, 442.80313965292476, 129.00586914614405, 852.1710244131034, 166.92722350690767, 225.15202959769232, 363.891783692237, 277.285325064824, 322.9159126592959, 410.61388173956897, 112.9793007408983, 963.0645080576669, 432.8230912459073, 69.19233463802598, 561.465080884731, 102.66499306426313, 485.32533144796196, 69.43283577745933, 27.619000911603095, 470.0944227763296, 535.2544157991647, 167.23005034940803, 30.93831530620575, 11.628173582203349, 860.0526736538028, 26.56992888111423, 814.6752447594789, 272.4891806534781, 247.85588479417098, 315.4520152550003, 370.14933681527225, 549.161120613019, 350.75619632987997, 295.6158788951344, 104.96063937002813, 540.598323024218, 586.5753450331756, 607.0053956518641, 418.85349397395476, 48.72003555830683, 211.43422244499752, 182.8167440397152, 313.9426341996656, 807.9358750885766, 151.26165290129768, 234.41665232084273, 274.61263623561564, 107.16333732881503, 518.5965534548232, 704.0887936630894, 415.893169143781, 117.51967714172214, 9.946278254943948, 650.2861526401919, 103.15827457262061, 665.1738265737699, 447.81838754698225, 52.13669092667582, 282.5353009948579, 147.74738109395986, 184.14760573669815, 308.49808977543995, 219.8304426436516, 488.49975346699216, 82.39250270225259, 460.56478406220515, 349.1128817499654, 381.6677650182157, 299.9224519584193, 14.017702634634716, 905.3163639216768, 681.9603924235232, 1049.3001384391534, 280.3411634359682, 0.0, 362.9584629047534, 173.8675774164979, 263.09004483227994, 314.60534583437, 657.3986108366034, 10.304370336547207, 874.8453825112366, 33.898688435460755, 402.9728622620519, 98.60156517980992, 226.6917245821155, 455.75437392525447, 572.5076607016533, 268.2446866743092, 608.0393790239406, 140.4392832275626, 365.4918931202727, 300.68852325518156, 523.8943387963201, 564.0512862770191, 133.06554824359176, 823.2969156816166, 1202.21998020858, 21.9966613589915, 28.522649515762087, 28.106700238172344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6753834500075055, "mean_inference_ms": 3.5265153653244035, "mean_action_processing_ms": 1.4396560841286397, "mean_env_wait_ms": 9.493005331885747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004219174385070801, "StateBufferConnector_ms": 0.005575895309448242, "ViewRequirementAgentConnector_ms": 0.15954148769378662}, "num_episodes": 3, "episode_return_max": 714.7, "episode_return_min": 58.10000000000056, "episode_return_mean": 368.92780195639637, "episodes_this_iter": 3}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.90464199781042, "num_env_steps_trained_throughput_per_sec": 82.90464199781042, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 48857.487, "restore_workers_time_ms": 0.013, "training_step_time_ms": 48857.434, "sample_time_ms": 2214.122, "learn_time_ms": 46625.219, "learn_throughput": 85.79, "synch_weights_time_ms": 14.885}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "fed12_00000", "date": "2024-08-21_18-20-07", "timestamp": 1724244607, "time_this_iter_s": 48.254159688949585, "time_total_s": 932.7954478263855, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31d553820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 932.7954478263855, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 23.764705882352946, "ram_util_percent": 80.51764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.330800219944544, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.928364562988281, "policy_loss": -0.021739718763689908, "vf_loss": 7.9466904170929435, "vf_explained_var": 0.22344431643763546, "kl": 0.01706933620972214, "entropy": 1.274230391323251, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.225061910745328, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.661491001472271, "policy_loss": -0.02174591262548886, "vf_loss": 7.679820254492381, "vf_explained_var": 0.27071384692948963, "kl": 0.017083332793806832, "entropy": 0.99708848617695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 714.7, "episode_reward_min": 58.10000000000056, "episode_reward_mean": 351.1680327525667, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1210.6325168941555, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 376.5990243808458, "predator_policy": 1254.884887330226}, "policy_reward_mean": {"prey_policy": -203.47887661773166, "predator_policy": 379.06289299401504}, "custom_metrics": {}, "hist_stats": {"episode_reward": [433.30000000000314, 434.71654103849653, 306.50000000000034, 286.4999999999992, 561.0999999999999, 58.10000000000056, 320.68412243336354, 448.40000000000003, 554.291043895983, 482.4000000000001, 394.6676048656137, 73.20000000000051, 662.033220009229, 536.9757200947306, 313.74403646001616, 656.0, 714.7, 546.3999999999993, 324.4698940468212, 195.4999999999988, 543.0152715913472, 123.50000000000021, 330.6000000000005, 416.6914268662387, 406.8883303875136, 287.4554184501087, 397.23282554406046, 142.29999999999902, 300.9881441011586, 228.05864844252835, 413.1388858909183, 581.9255834599579, 303.7000000000002, 365.5581136377143, 408.68561879497076, 332.2079808073913, 264.3797508919558, 351.31803398874985, 502.8351882908192, 119.28071052577937, 284.29999999999916, 248.28196601124958, 462.7997234360565, 400.1226804767784, 537.3338233692972, 337.44524903746196, 646.425029942791, 265.89337524529765, 366.2578664414934, 343.30000000000047, 320.1783407851516, 275.00563359097794, 545.7060629858365, 226.8495465950384, 207.634375389322, 576.9633939484314, 492.44902465861367, 160.88298648829795, 292.25816565228195, 564.5772581691606, 221.60510479192266, 396.10000000000207, 290.26432400896715, 293.8218398258553, 495.12145554084856, 425.4087178810514, 462.26469979933944, 154.10736224123673, 489.6373373892453, 306.13373751211014, 401.1376735926828, 122.82363176457257, 329.3614530705435, 203.59999999999943, 597.0781880519073, 416.84120419997, 318.5705613514498, 477.3954869331041, 407.76176332249815, 332.90876272604334, 213.3685278558723, 505.4278472061666, 288.94183134957996, 394.21932836142713, 327.66309283722626, 375.30000000000155, 208.19459162010534, 394.68285401314716, 87.03771314328017, 188.33595090021356, 101.10251721497542, 172.14912727590365, 322.5150764162826, 329.964246935987, 175.65489817033279, 356.28667210272516, 106.00995319414832, 141.93183106104811, 342.62418565463486, 265.3431092012609], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [49.167571163531974, 350.8085339151728, 203.5222201408425, 23.5799680610196, -283.35683351327646, -6.011027885811416, 47.793213055760695, 211.90000000000003, 218.63737703900338, 140.16548901750804, -205.63906381638023, -171.2280060097446, -82.0644873520675, -35.019174483015775, 34.273546202241306, 159.30386208923906, 331.8027028408861, -241.10541029771193, 210.50158949078167, -88.77639277881971, 6.511838523731001, 10.41252671023733, -103.57059063305935, -83.41022537710765, 300.04941035647363, 210.46419530815467, 247.10844644825042, 2.08204294335449, -432.3090228100289, 105.7843586775592, 331.20465024970144, -2.379567192357541, 326.2575007725435, 287.1165325078351, 365.49290273733664, 25.334607500629787, 122.96873023153115, 40.0000000000003, -456.09979031069577, 73.05453750953427, -804.0541286987267, 369.72073923062493, -24.988158942720716, 37.404446332797775, -281.0549222874019, 149.02676624700908, -343.9238023197122, -137.8997443156002, -446.38445971443326, 237.60972236287424, -149.57607775007767, -264.95692976630824, 4.874096986018742, -216.907356677235, -514.0398003536236, -420.6505836084567, -587.7811836234108, -98.49265349893088, -348.6967788676099, -519.6447264930814, -643.4924226161053, 152.00698783224172, 65.09852475680002, 242.08625705476632, -307.4842859192785, -44.52872539979478, 27.227764638655003, 143.42155969767225, -90.11667946527858, -193.21399808130644, -596.8864737567019, 81.52941930949544, -226.9966253442678, -80.43263256284682, -844.5950004332931, 176.81478650203263, -89.17184017170399, 2.9632151725938978, -255.73867223691443, -225.18185496142036, -240.25793886839426, 0.9647563879292989, -920.3825420464145, -227.22309124590734, 234.37480051984915, -402.2324926065478, 131.33243313167947, -319.2000771671261, 319.6177553866605, 120.66423129357521, -97.28725287720287, -570.6163366608296, 144.56544909255024, 303.69121519462686, -315.9334048377125, -289.8540671529937, 109.5828799876, -584.5701871867004, 1.5108193465220232, -178.55588479417258, -286.7749480133737, -78.64806327175036, -514.269551395352, -110.64213195656997, 173.3451434517006, -28.215598731026624, -405.5275285227403, -494.79659293961504, -543.2801337230935, -274.94438051340387, 265.8325551620684, 50.97658078305879, 79.76627189166939, -84.07662547243636, -690.8251448199063, -107.48939668167014, -172.42473260012227, -44.346390304053166, -358.82519356582065, 297.64256095134317, -641.5876385897881, -256.78921942515944, 239.58032285827784, 29.053721745056215, -444.6220538861353, -18.558049317709944, -532.9612376197878, -286.20913667510905, -3.2197174032913782, 163.66918102260578, -153.7048557165888, 247.21858676698253, -0.7599860405863086, -65.30384657916588, -418.95248136990284, 2.1675874418962526, 289.80932483364927, -609.849653256575, -303.05073584660664, -72.40574361791808, 235.99079060264123, -754.1871835662688, -996.5479513264862, -611.8889477716192, -21.063090113849967, 70.08337974842662, -193.7584629047521, -139.46757741649986, 376.5990243808458, -357.21622699558867, -392.9331798089448, 142.0714028357631, -667.8595622845363, 77.68605268928866, -2.831852359477997, -21.34708814928001, -20.28446557866834, -254.3998696062032, -270.0511514927424, -237.79243315717625, -302.20921077619204, -232.9009236194393, 85.79789913715051, -246.55046830643806, -561.024603163705, -237.97919056005463, -388.4570816717729, -173.686053892008, -718.9224072082114, -177.63114152213143, 287.66497984394556, 31.005670402120227, -797.7438469550011, -738.0260475070893, -831.2343315564065, -789.0031886616539, -926.2761294299785, -923.4187151132238, -751.34674358521, -488.9354772763404, -839.9070652438392, -1150.4855311542217, -890.5642947945425, -731.7446089106136, -512.5808965387911, -1066.5858115641802, -362.2744848989038, -246.9714006484947, -657.5677137399719, -1210.6325168941555, -145.74515125032252, -551.3628079947075, -1007.0812439428712, -811.4792315417295, -1059.3286837217686, -810.7862462450578, -708.7982803736598, -239.10516508218936, -875.6393042973864, -130.4741442523205], "policy_predator_policy_reward": [9.732428836468484, 23.59146608482728, 184.8273428404908, 22.787009996144956, 309.15683351327954, 286.7110278858118, 26.806786944239796, 0.0, 37.31231331640524, 164.9848206270833, 200.65111446728594, 234.31595535883562, 374.7059799147782, 63.06180435366925, 182.02645379775836, 72.79613791076063, 176.23603327858473, 287.357718074224, 68.99841050921837, 291.67639277882, 215.71085131332805, 162.0323883183163, 142.37059063305784, 117.8102253771057, 47.28380965275516, 104.2358046918453, 13.491891749785237, 274.2933389533412, 129.08153096872255, 511.1871696237642, 45.618006928954905, 281.5569100137014, 41.77204043750459, 59.553926282116805, 0.0, 155.57248976203377, 13.829561370286548, 147.67160244500133, 177.59724254446854, 400.94801025669335, 694.4243348694733, 282.924326189976, 108.68815894271894, 2.395553667202486, 312.1549222874058, 150.47323375299078, 619.3281569157961, 279.18681658575525, 40.98993957845551, 574.6731281606177, 505.09051821119715, 196.89790775529505, 32.304943579676305, 576.9611416556007, 637.039800353623, 439.95058360846053, 398.65505864432043, 588.6069225791799, 419.940981070201, 676.4591727330178, 307.490063770841, 597.1342569039407, 93.94314762554583, 180.79765402284556, 336.1842859192825, 319.5287253997946, 18.330348999058053, 176.57844030232775, 44.029288170565245, 647.9870081709885, 128.17256986341886, 719.3924653911787, 442.80313965292476, 129.00586914614405, 852.1710244131034, 166.92722350690767, 225.15202959769232, 363.891783692237, 277.285325064824, 322.9159126592959, 410.61388173956897, 112.9793007408983, 963.0645080576669, 432.8230912459073, 69.19233463802598, 561.465080884731, 102.66499306426313, 485.32533144796196, 69.43283577745933, 27.619000911603095, 470.0944227763296, 535.2544157991647, 167.23005034940803, 30.93831530620575, 11.628173582203349, 860.0526736538028, 26.56992888111423, 814.6752447594789, 272.4891806534781, 247.85588479417098, 315.4520152550003, 370.14933681527225, 549.161120613019, 350.75619632987997, 295.6158788951344, 104.96063937002813, 540.598323024218, 586.5753450331756, 607.0053956518641, 418.85349397395476, 48.72003555830683, 211.43422244499752, 182.8167440397152, 313.9426341996656, 807.9358750885766, 151.26165290129768, 234.41665232084273, 274.61263623561564, 107.16333732881503, 518.5965534548232, 704.0887936630894, 415.893169143781, 117.51967714172214, 9.946278254943948, 650.2861526401919, 103.15827457262061, 665.1738265737699, 447.81838754698225, 52.13669092667582, 282.5353009948579, 147.74738109395986, 184.14760573669815, 308.49808977543995, 219.8304426436516, 488.49975346699216, 82.39250270225259, 460.56478406220515, 349.1128817499654, 381.6677650182157, 299.9224519584193, 14.017702634634716, 905.3163639216768, 681.9603924235232, 1049.3001384391534, 280.3411634359682, 0.0, 362.9584629047534, 173.8675774164979, 263.09004483227994, 314.60534583437, 657.3986108366034, 10.304370336547207, 874.8453825112366, 33.898688435460755, 402.9728622620519, 98.60156517980992, 226.6917245821155, 455.75437392525447, 572.5076607016533, 268.2446866743092, 608.0393790239406, 140.4392832275626, 365.4918931202727, 300.68852325518156, 523.8943387963201, 564.0512862770191, 133.06554824359176, 823.2969156816166, 1202.21998020858, 21.9966613589915, 28.522649515762087, 28.106700238172344, 1085.4474392996228, 658.5170467825733, 1021.3339634861793, 993.5864107450283, 895.3310118369903, 1041.4015458494919, 905.0020206296696, 523.6161511320986, 1011.6985596190319, 1079.796553994004, 831.3061797077778, 963.1518512732828, 1057.615575596627, 844.0662089226265, 687.215941320968, 251.99419116241768, 1254.884887330226, 788.9702414742333, 430.1616048905188, 623.2330264572373, 817.1936397182741, 1107.3767889604742, 958.0776442833594, 1053.9691167445108, 831.9231649178342, 458.6044661926496, 453.73257994705085, 817.7239778039134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.64709776140251, "mean_inference_ms": 3.518434301962878, "mean_action_processing_ms": 1.382993104654077, "mean_env_wait_ms": 9.578665428223234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004380345344543457, "StateBufferConnector_ms": 0.005619406700134277, "ViewRequirementAgentConnector_ms": 0.16582047939300537}, "num_episodes": 14, "episode_return_max": 714.7, "episode_return_min": 58.10000000000056, "episode_return_mean": 351.1680327525667, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.34494656496763, "num_env_steps_trained_throughput_per_sec": 82.34494656496763, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 48833.518, "restore_workers_time_ms": 0.013, "training_step_time_ms": 48833.47, "sample_time_ms": 2202.498, "learn_time_ms": 46613.462, "learn_throughput": 85.812, "synch_weights_time_ms": 14.457}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "fed12_00000", "date": "2024-08-21_18-20-56", "timestamp": 1724244656, "time_this_iter_s": 48.61504626274109, "time_total_s": 981.4104940891266, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4ad820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 981.4104940891266, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 25.63333333333333, "ram_util_percent": 81.41014492753624}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.84424975744631, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.050054454803467, "policy_loss": -0.01915985178251667, "vf_loss": 8.066100338527134, "vf_explained_var": 0.18015409093054513, "kl": 0.01556977554835458, "entropy": 1.2647572451167637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.357789423856786, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.728833642081609, "policy_loss": -0.019705498561745992, "vf_loss": 7.745667930633303, "vf_explained_var": 0.26437897940792104, "kl": 0.014356077927110529, "entropy": 0.9763987255790246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 646.425029942791, "episode_reward_min": 31.65058770489012, "episode_reward_mean": 312.51076413008036, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1377.1599066802164, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 376.5990243808458, "predator_policy": 1254.884887330226}, "policy_reward_mean": {"prey_policy": -325.33384464310103, "predator_policy": 481.5892267081414}, "custom_metrics": {}, "hist_stats": {"episode_reward": [324.4698940468212, 195.4999999999988, 543.0152715913472, 123.50000000000021, 330.6000000000005, 416.6914268662387, 406.8883303875136, 287.4554184501087, 397.23282554406046, 142.29999999999902, 300.9881441011586, 228.05864844252835, 413.1388858909183, 581.9255834599579, 303.7000000000002, 365.5581136377143, 408.68561879497076, 332.2079808073913, 264.3797508919558, 351.31803398874985, 502.8351882908192, 119.28071052577937, 284.29999999999916, 248.28196601124958, 462.7997234360565, 400.1226804767784, 537.3338233692972, 337.44524903746196, 646.425029942791, 265.89337524529765, 366.2578664414934, 343.30000000000047, 320.1783407851516, 275.00563359097794, 545.7060629858365, 226.8495465950384, 207.634375389322, 576.9633939484314, 492.44902465861367, 160.88298648829795, 292.25816565228195, 564.5772581691606, 221.60510479192266, 396.10000000000207, 290.26432400896715, 293.8218398258553, 495.12145554084856, 425.4087178810514, 462.26469979933944, 154.10736224123673, 489.6373373892453, 306.13373751211014, 401.1376735926828, 122.82363176457257, 329.3614530705435, 203.59999999999943, 597.0781880519073, 416.84120419997, 318.5705613514498, 477.3954869331041, 407.76176332249815, 332.90876272604334, 213.3685278558723, 505.4278472061666, 288.94183134957996, 394.21932836142713, 327.66309283722626, 375.30000000000155, 208.19459162010534, 394.68285401314716, 87.03771314328017, 188.33595090021356, 101.10251721497542, 172.14912727590365, 322.5150764162826, 329.964246935987, 175.65489817033279, 356.28667210272516, 106.00995319414832, 141.93183106104811, 342.62418565463486, 265.3431092012609, 231.3390281066847, 161.6478183988567, 231.28631602448053, 405.94768733860866, 365.9206110981813, 163.53544127579195, 236.74524785948532, 272.71093430894814, 187.41317261941825, 235.02810515076538, 194.586344712568, 307.4237325142271, 54.86092783622064, 161.67776414025013, 300.5607751994489, 31.65058770489012, 207.586768941298, 168.06416331867192], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [122.96873023153115, 40.0000000000003, -456.09979031069577, 73.05453750953427, -804.0541286987267, 369.72073923062493, -24.988158942720716, 37.404446332797775, -281.0549222874019, 149.02676624700908, -343.9238023197122, -137.8997443156002, -446.38445971443326, 237.60972236287424, -149.57607775007767, -264.95692976630824, 4.874096986018742, -216.907356677235, -514.0398003536236, -420.6505836084567, -587.7811836234108, -98.49265349893088, -348.6967788676099, -519.6447264930814, -643.4924226161053, 152.00698783224172, 65.09852475680002, 242.08625705476632, -307.4842859192785, -44.52872539979478, 27.227764638655003, 143.42155969767225, -90.11667946527858, -193.21399808130644, -596.8864737567019, 81.52941930949544, -226.9966253442678, -80.43263256284682, -844.5950004332931, 176.81478650203263, -89.17184017170399, 2.9632151725938978, -255.73867223691443, -225.18185496142036, -240.25793886839426, 0.9647563879292989, -920.3825420464145, -227.22309124590734, 234.37480051984915, -402.2324926065478, 131.33243313167947, -319.2000771671261, 319.6177553866605, 120.66423129357521, -97.28725287720287, -570.6163366608296, 144.56544909255024, 303.69121519462686, -315.9334048377125, -289.8540671529937, 109.5828799876, -584.5701871867004, 1.5108193465220232, -178.55588479417258, -286.7749480133737, -78.64806327175036, -514.269551395352, -110.64213195656997, 173.3451434517006, -28.215598731026624, -405.5275285227403, -494.79659293961504, -543.2801337230935, -274.94438051340387, 265.8325551620684, 50.97658078305879, 79.76627189166939, -84.07662547243636, -690.8251448199063, -107.48939668167014, -172.42473260012227, -44.346390304053166, -358.82519356582065, 297.64256095134317, -641.5876385897881, -256.78921942515944, 239.58032285827784, 29.053721745056215, -444.6220538861353, -18.558049317709944, -532.9612376197878, -286.20913667510905, -3.2197174032913782, 163.66918102260578, -153.7048557165888, 247.21858676698253, -0.7599860405863086, -65.30384657916588, -418.95248136990284, 2.1675874418962526, 289.80932483364927, -609.849653256575, -303.05073584660664, -72.40574361791808, 235.99079060264123, -754.1871835662688, -996.5479513264862, -611.8889477716192, -21.063090113849967, 70.08337974842662, -193.7584629047521, -139.46757741649986, 376.5990243808458, -357.21622699558867, -392.9331798089448, 142.0714028357631, -667.8595622845363, 77.68605268928866, -2.831852359477997, -21.34708814928001, -20.28446557866834, -254.3998696062032, -270.0511514927424, -237.79243315717625, -302.20921077619204, -232.9009236194393, 85.79789913715051, -246.55046830643806, -561.024603163705, -237.97919056005463, -388.4570816717729, -173.686053892008, -718.9224072082114, -177.63114152213143, 287.66497984394556, 31.005670402120227, -797.7438469550011, -738.0260475070893, -831.2343315564065, -789.0031886616539, -926.2761294299785, -923.4187151132238, -751.34674358521, -488.9354772763404, -839.9070652438392, -1150.4855311542217, -890.5642947945425, -731.7446089106136, -512.5808965387911, -1066.5858115641802, -362.2744848989038, -246.9714006484947, -657.5677137399719, -1210.6325168941555, -145.74515125032252, -551.3628079947075, -1007.0812439428712, -811.4792315417295, -1059.3286837217686, -810.7862462450578, -708.7982803736598, -239.10516508218936, -875.6393042973864, -130.4741442523205, -477.9789743417339, -313.80186993045976, -316.9379139173587, -321.335357104323, -578.401766200406, -303.882733115195, -379.70315757984764, -597.6482084071868, 357.1912068365049, -1018.9423367762291, -222.86173349929328, -1155.3317982455849, -153.96812598394308, -1377.1599066802164, -1168.4823746717864, 35.20743924998394, -1084.8500300668873, 38.91584951970631, -166.81958921455026, -77.51741811890027, -571.341945528108, -685.7559414415562, -377.3619773135682, -516.701252177006, -728.2817460408498, -1082.0377920863039, -747.6781777429532, -1110.066291201272, -837.445462548547, -457.7840471813754, -1026.1314894635448, -1238.128954762792, -861.4947297676762, -940.3282542477111, -449.1070707797131, -992.6343909407744], "policy_predator_policy_reward": [13.829561370286548, 147.67160244500133, 177.59724254446854, 400.94801025669335, 694.4243348694733, 282.924326189976, 108.68815894271894, 2.395553667202486, 312.1549222874058, 150.47323375299078, 619.3281569157961, 279.18681658575525, 40.98993957845551, 574.6731281606177, 505.09051821119715, 196.89790775529505, 32.304943579676305, 576.9611416556007, 637.039800353623, 439.95058360846053, 398.65505864432043, 588.6069225791799, 419.940981070201, 676.4591727330178, 307.490063770841, 597.1342569039407, 93.94314762554583, 180.79765402284556, 336.1842859192825, 319.5287253997946, 18.330348999058053, 176.57844030232775, 44.029288170565245, 647.9870081709885, 128.17256986341886, 719.3924653911787, 442.80313965292476, 129.00586914614405, 852.1710244131034, 166.92722350690767, 225.15202959769232, 363.891783692237, 277.285325064824, 322.9159126592959, 410.61388173956897, 112.9793007408983, 963.0645080576669, 432.8230912459073, 69.19233463802598, 561.465080884731, 102.66499306426313, 485.32533144796196, 69.43283577745933, 27.619000911603095, 470.0944227763296, 535.2544157991647, 167.23005034940803, 30.93831530620575, 11.628173582203349, 860.0526736538028, 26.56992888111423, 814.6752447594789, 272.4891806534781, 247.85588479417098, 315.4520152550003, 370.14933681527225, 549.161120613019, 350.75619632987997, 295.6158788951344, 104.96063937002813, 540.598323024218, 586.5753450331756, 607.0053956518641, 418.85349397395476, 48.72003555830683, 211.43422244499752, 182.8167440397152, 313.9426341996656, 807.9358750885766, 151.26165290129768, 234.41665232084273, 274.61263623561564, 107.16333732881503, 518.5965534548232, 704.0887936630894, 415.893169143781, 117.51967714172214, 9.946278254943948, 650.2861526401919, 103.15827457262061, 665.1738265737699, 447.81838754698225, 52.13669092667582, 282.5353009948579, 147.74738109395986, 184.14760573669815, 308.49808977543995, 219.8304426436516, 488.49975346699216, 82.39250270225259, 460.56478406220515, 349.1128817499654, 381.6677650182157, 299.9224519584193, 14.017702634634716, 905.3163639216768, 681.9603924235232, 1049.3001384391534, 280.3411634359682, 0.0, 362.9584629047534, 173.8675774164979, 263.09004483227994, 314.60534583437, 657.3986108366034, 10.304370336547207, 874.8453825112366, 33.898688435460755, 402.9728622620519, 98.60156517980992, 226.6917245821155, 455.75437392525447, 572.5076607016533, 268.2446866743092, 608.0393790239406, 140.4392832275626, 365.4918931202727, 300.68852325518156, 523.8943387963201, 564.0512862770191, 133.06554824359176, 823.2969156816166, 1202.21998020858, 21.9966613589915, 28.522649515762087, 28.106700238172344, 1085.4474392996228, 658.5170467825733, 1021.3339634861793, 993.5864107450283, 895.3310118369903, 1041.4015458494919, 905.0020206296696, 523.6161511320986, 1011.6985596190319, 1079.796553994004, 831.3061797077778, 963.1518512732828, 1057.615575596627, 844.0662089226265, 687.215941320968, 251.99419116241768, 1254.884887330226, 788.9702414742333, 430.1616048905188, 623.2330264572373, 817.1936397182741, 1107.3767889604742, 958.0776442833594, 1053.9691167445108, 831.9231649178342, 458.6044661926496, 453.73257994705085, 817.7239778039134, 0.7799131685665955, 1022.3399592103125, 462.7099923595163, 337.2110970610302, 540.7612577316025, 572.8095576084836, 644.718569320336, 738.5804840053077, 2.690106296848361, 1024.9816347410572, 378.83338243769515, 1162.8955905829753, 903.8958679219642, 863.9774126016769, 988.5477022884377, 417.4381674423126, 243.64584654263376, 989.7015066239682, 102.16036948327802, 377.2047430009378, 419.2601952472431, 1032.4240364349885, 32.83592464735306, 1168.6510373574483, 726.5971911236063, 1138.5832748397695, 1026.8892833689572, 992.5329497155195, 879.9627730618075, 715.827511867564, 1069.8752938333153, 1226.0357380979124, 1036.1229191542395, 973.2868338024449, 656.9824478459315, 952.8231771932307]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6415581334976936, "mean_inference_ms": 3.5001931798472974, "mean_action_processing_ms": 1.3490521637629849, "mean_env_wait_ms": 9.670656959957396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005132079124450684, "StateBufferConnector_ms": 0.005958676338195801, "ViewRequirementAgentConnector_ms": 0.172806978225708}, "num_episodes": 18, "episode_return_max": 646.425029942791, "episode_return_min": 31.65058770489012, "episode_return_mean": 312.51076413008036, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.28796030919455, "num_env_steps_trained_throughput_per_sec": 81.28796030919455, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 48896.323, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48896.277, "sample_time_ms": 2269.177, "learn_time_ms": 46609.36, "learn_throughput": 85.82, "synch_weights_time_ms": 14.762}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "fed12_00000", "date": "2024-08-21_18-21-45", "timestamp": 1724244705, "time_this_iter_s": 49.21630525588989, "time_total_s": 1030.6267993450165, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4bdee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1030.6267993450165, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 25.609999999999996, "ram_util_percent": 81.84142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.950299354772719, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.879319013615764, "policy_loss": -0.01796958973537638, "vf_loss": 7.8944539186185, "vf_explained_var": 0.23344670354373873, "kl": 0.014173486869210604, "entropy": 1.2584500567622916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.807820771642463, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.45404670427716, "policy_loss": -0.016740138887886016, "vf_loss": 7.468079008879485, "vf_explained_var": 0.3142057623812761, "kl": 0.013539062853577354, "entropy": 0.9576441383235669, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 646.425029942791, "episode_reward_min": 31.65058770489012, "episode_reward_mean": 304.53933427266963, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1377.1599066802164, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 376.5990243808458, "predator_policy": 1254.884887330226}, "policy_reward_mean": {"prey_policy": -387.6559708901192, "predator_policy": 539.9256380264543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [581.9255834599579, 303.7000000000002, 365.5581136377143, 408.68561879497076, 332.2079808073913, 264.3797508919558, 351.31803398874985, 502.8351882908192, 119.28071052577937, 284.29999999999916, 248.28196601124958, 462.7997234360565, 400.1226804767784, 537.3338233692972, 337.44524903746196, 646.425029942791, 265.89337524529765, 366.2578664414934, 343.30000000000047, 320.1783407851516, 275.00563359097794, 545.7060629858365, 226.8495465950384, 207.634375389322, 576.9633939484314, 492.44902465861367, 160.88298648829795, 292.25816565228195, 564.5772581691606, 221.60510479192266, 396.10000000000207, 290.26432400896715, 293.8218398258553, 495.12145554084856, 425.4087178810514, 462.26469979933944, 154.10736224123673, 489.6373373892453, 306.13373751211014, 401.1376735926828, 122.82363176457257, 329.3614530705435, 203.59999999999943, 597.0781880519073, 416.84120419997, 318.5705613514498, 477.3954869331041, 407.76176332249815, 332.90876272604334, 213.3685278558723, 505.4278472061666, 288.94183134957996, 394.21932836142713, 327.66309283722626, 375.30000000000155, 208.19459162010534, 394.68285401314716, 87.03771314328017, 188.33595090021356, 101.10251721497542, 172.14912727590365, 322.5150764162826, 329.964246935987, 175.65489817033279, 356.28667210272516, 106.00995319414832, 141.93183106104811, 342.62418565463486, 265.3431092012609, 231.3390281066847, 161.6478183988567, 231.28631602448053, 405.94768733860866, 365.9206110981813, 163.53544127579195, 236.74524785948532, 272.71093430894814, 187.41317261941825, 235.02810515076538, 194.586344712568, 307.4237325142271, 54.86092783622064, 161.67776414025013, 300.5607751994489, 31.65058770489012, 207.586768941298, 168.06416331867192, 162.7061198501114, 582.0865649097859, 174.57690589692186, 44.602512763722665, 261.18525088389055, 289.78365999175315, 48.79177299486338, 444.50362581214006, 392.0541675600187, 343.70596643683905, 97.95624294993846, 124.32154333339244, 346.42152619624613], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [65.09852475680002, 242.08625705476632, -307.4842859192785, -44.52872539979478, 27.227764638655003, 143.42155969767225, -90.11667946527858, -193.21399808130644, -596.8864737567019, 81.52941930949544, -226.9966253442678, -80.43263256284682, -844.5950004332931, 176.81478650203263, -89.17184017170399, 2.9632151725938978, -255.73867223691443, -225.18185496142036, -240.25793886839426, 0.9647563879292989, -920.3825420464145, -227.22309124590734, 234.37480051984915, -402.2324926065478, 131.33243313167947, -319.2000771671261, 319.6177553866605, 120.66423129357521, -97.28725287720287, -570.6163366608296, 144.56544909255024, 303.69121519462686, -315.9334048377125, -289.8540671529937, 109.5828799876, -584.5701871867004, 1.5108193465220232, -178.55588479417258, -286.7749480133737, -78.64806327175036, -514.269551395352, -110.64213195656997, 173.3451434517006, -28.215598731026624, -405.5275285227403, -494.79659293961504, -543.2801337230935, -274.94438051340387, 265.8325551620684, 50.97658078305879, 79.76627189166939, -84.07662547243636, -690.8251448199063, -107.48939668167014, -172.42473260012227, -44.346390304053166, -358.82519356582065, 297.64256095134317, -641.5876385897881, -256.78921942515944, 239.58032285827784, 29.053721745056215, -444.6220538861353, -18.558049317709944, -532.9612376197878, -286.20913667510905, -3.2197174032913782, 163.66918102260578, -153.7048557165888, 247.21858676698253, -0.7599860405863086, -65.30384657916588, -418.95248136990284, 2.1675874418962526, 289.80932483364927, -609.849653256575, -303.05073584660664, -72.40574361791808, 235.99079060264123, -754.1871835662688, -996.5479513264862, -611.8889477716192, -21.063090113849967, 70.08337974842662, -193.7584629047521, -139.46757741649986, 376.5990243808458, -357.21622699558867, -392.9331798089448, 142.0714028357631, -667.8595622845363, 77.68605268928866, -2.831852359477997, -21.34708814928001, -20.28446557866834, -254.3998696062032, -270.0511514927424, -237.79243315717625, -302.20921077619204, -232.9009236194393, 85.79789913715051, -246.55046830643806, -561.024603163705, -237.97919056005463, -388.4570816717729, -173.686053892008, -718.9224072082114, -177.63114152213143, 287.66497984394556, 31.005670402120227, -797.7438469550011, -738.0260475070893, -831.2343315564065, -789.0031886616539, -926.2761294299785, -923.4187151132238, -751.34674358521, -488.9354772763404, -839.9070652438392, -1150.4855311542217, -890.5642947945425, -731.7446089106136, -512.5808965387911, -1066.5858115641802, -362.2744848989038, -246.9714006484947, -657.5677137399719, -1210.6325168941555, -145.74515125032252, -551.3628079947075, -1007.0812439428712, -811.4792315417295, -1059.3286837217686, -810.7862462450578, -708.7982803736598, -239.10516508218936, -875.6393042973864, -130.4741442523205, -477.9789743417339, -313.80186993045976, -316.9379139173587, -321.335357104323, -578.401766200406, -303.882733115195, -379.70315757984764, -597.6482084071868, 357.1912068365049, -1018.9423367762291, -222.86173349929328, -1155.3317982455849, -153.96812598394308, -1377.1599066802164, -1168.4823746717864, 35.20743924998394, -1084.8500300668873, 38.91584951970631, -166.81958921455026, -77.51741811890027, -571.341945528108, -685.7559414415562, -377.3619773135682, -516.701252177006, -728.2817460408498, -1082.0377920863039, -747.6781777429532, -1110.066291201272, -837.445462548547, -457.7840471813754, -1026.1314894635448, -1238.128954762792, -861.4947297676762, -940.3282542477111, -449.1070707797131, -992.6343909407744, -433.2140827021212, -940.9047026089181, -289.7908964435728, 248.95810659592883, -847.6975793167871, -1225.2160178412869, -1102.059403102999, -1129.5368887200327, -846.0596988465993, -792.7900902666643, -603.6187804000896, -364.3177354961411, -1201.8997331981957, -455.4013124622381, -784.2016067065596, -690.8785717304041, -56.029763830870266, -905.9726083058507, -504.0819986570972, -106.34646603105864, -1131.8549116330764, -695.9539792704338, -1010.0198013035631, -612.0262485532639, -324.5267220505547, -730.9612496326904], "policy_predator_policy_reward": [93.94314762554583, 180.79765402284556, 336.1842859192825, 319.5287253997946, 18.330348999058053, 176.57844030232775, 44.029288170565245, 647.9870081709885, 128.17256986341886, 719.3924653911787, 442.80313965292476, 129.00586914614405, 852.1710244131034, 166.92722350690767, 225.15202959769232, 363.891783692237, 277.285325064824, 322.9159126592959, 410.61388173956897, 112.9793007408983, 963.0645080576669, 432.8230912459073, 69.19233463802598, 561.465080884731, 102.66499306426313, 485.32533144796196, 69.43283577745933, 27.619000911603095, 470.0944227763296, 535.2544157991647, 167.23005034940803, 30.93831530620575, 11.628173582203349, 860.0526736538028, 26.56992888111423, 814.6752447594789, 272.4891806534781, 247.85588479417098, 315.4520152550003, 370.14933681527225, 549.161120613019, 350.75619632987997, 295.6158788951344, 104.96063937002813, 540.598323024218, 586.5753450331756, 607.0053956518641, 418.85349397395476, 48.72003555830683, 211.43422244499752, 182.8167440397152, 313.9426341996656, 807.9358750885766, 151.26165290129768, 234.41665232084273, 274.61263623561564, 107.16333732881503, 518.5965534548232, 704.0887936630894, 415.893169143781, 117.51967714172214, 9.946278254943948, 650.2861526401919, 103.15827457262061, 665.1738265737699, 447.81838754698225, 52.13669092667582, 282.5353009948579, 147.74738109395986, 184.14760573669815, 308.49808977543995, 219.8304426436516, 488.49975346699216, 82.39250270225259, 460.56478406220515, 349.1128817499654, 381.6677650182157, 299.9224519584193, 14.017702634634716, 905.3163639216768, 681.9603924235232, 1049.3001384391534, 280.3411634359682, 0.0, 362.9584629047534, 173.8675774164979, 263.09004483227994, 314.60534583437, 657.3986108366034, 10.304370336547207, 874.8453825112366, 33.898688435460755, 402.9728622620519, 98.60156517980992, 226.6917245821155, 455.75437392525447, 572.5076607016533, 268.2446866743092, 608.0393790239406, 140.4392832275626, 365.4918931202727, 300.68852325518156, 523.8943387963201, 564.0512862770191, 133.06554824359176, 823.2969156816166, 1202.21998020858, 21.9966613589915, 28.522649515762087, 28.106700238172344, 1085.4474392996228, 658.5170467825733, 1021.3339634861793, 993.5864107450283, 895.3310118369903, 1041.4015458494919, 905.0020206296696, 523.6161511320986, 1011.6985596190319, 1079.796553994004, 831.3061797077778, 963.1518512732828, 1057.615575596627, 844.0662089226265, 687.215941320968, 251.99419116241768, 1254.884887330226, 788.9702414742333, 430.1616048905188, 623.2330264572373, 817.1936397182741, 1107.3767889604742, 958.0776442833594, 1053.9691167445108, 831.9231649178342, 458.6044661926496, 453.73257994705085, 817.7239778039134, 0.7799131685665955, 1022.3399592103125, 462.7099923595163, 337.2110970610302, 540.7612577316025, 572.8095576084836, 644.718569320336, 738.5804840053077, 2.690106296848361, 1024.9816347410572, 378.83338243769515, 1162.8955905829753, 903.8958679219642, 863.9774126016769, 988.5477022884377, 417.4381674423126, 243.64584654263376, 989.7015066239682, 102.16036948327802, 377.2047430009378, 419.2601952472431, 1032.4240364349885, 32.83592464735306, 1168.6510373574483, 726.5971911236063, 1138.5832748397695, 1026.8892833689572, 992.5329497155195, 879.9627730618075, 715.827511867564, 1069.8752938333153, 1226.0357380979124, 1036.1229191542395, 973.2868338024449, 656.9824478459315, 952.8231771932307, 829.7506861465912, 707.0742190145615, 523.0908964435729, 99.82845831385701, 1037.3367001674794, 1210.1538028875168, 1130.4619158667222, 1145.7368887200323, 969.4762448842735, 930.5587951128833, 541.5519758872339, 716.1682000007504, 1202.8997331981957, 503.19308545710123, 839.5831113036218, 1080.0006929454821, 568.0503104509847, 786.0062292457546, 512.0481944596714, 442.08623666531946, 1145.3568248956453, 780.408308957803, 1094.4672020181977, 651.9003911720242, 1081.7117349044984, 320.1977629749923]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.652745744776839, "mean_inference_ms": 3.493383071402676, "mean_action_processing_ms": 1.3501179703935713, "mean_env_wait_ms": 9.695899491482159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004960775375366211, "StateBufferConnector_ms": 0.011387109756469727, "ViewRequirementAgentConnector_ms": 0.1701124906539917}, "num_episodes": 13, "episode_return_max": 646.425029942791, "episode_return_min": 31.65058770489012, "episode_return_mean": 304.53933427266963, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.41898214461943, "num_env_steps_trained_throughput_per_sec": 82.41898214461943, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 48860.745, "restore_workers_time_ms": 0.013, "training_step_time_ms": 48860.699, "sample_time_ms": 2234.64, "learn_time_ms": 46608.068, "learn_throughput": 85.822, "synch_weights_time_ms": 14.954}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "fed12_00000", "date": "2024-08-21_18-22-34", "timestamp": 1724244754, "time_this_iter_s": 48.58903384208679, "time_total_s": 1079.2158331871033, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f317040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1079.2158331871033, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 23.936764705882354, "ram_util_percent": 81.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.257481426095206, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.872578398386637, "policy_loss": -0.020929226151879424, "vf_loss": 7.890384286547464, "vf_explained_var": 0.15952304191690272, "kl": 0.015616562909559992, "entropy": 1.2322377187865121, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.728529585984649, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.061292773958236, "policy_loss": -0.02036038604170754, "vf_loss": 8.078594022579294, "vf_explained_var": 0.26050367308041406, "kl": 0.015295754962911209, "entropy": 0.8954316621734982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 646.425029942791, "episode_reward_min": 31.65058770489012, "episode_reward_mean": 285.1062500542129, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1382.406352127582, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 376.5990243808458, "predator_policy": 1384.8516503685453}, "policy_reward_mean": {"prey_policy": -461.22393536811126, "predator_policy": 603.777060395218}, "custom_metrics": {}, "hist_stats": {"episode_reward": [537.3338233692972, 337.44524903746196, 646.425029942791, 265.89337524529765, 366.2578664414934, 343.30000000000047, 320.1783407851516, 275.00563359097794, 545.7060629858365, 226.8495465950384, 207.634375389322, 576.9633939484314, 492.44902465861367, 160.88298648829795, 292.25816565228195, 564.5772581691606, 221.60510479192266, 396.10000000000207, 290.26432400896715, 293.8218398258553, 495.12145554084856, 425.4087178810514, 462.26469979933944, 154.10736224123673, 489.6373373892453, 306.13373751211014, 401.1376735926828, 122.82363176457257, 329.3614530705435, 203.59999999999943, 597.0781880519073, 416.84120419997, 318.5705613514498, 477.3954869331041, 407.76176332249815, 332.90876272604334, 213.3685278558723, 505.4278472061666, 288.94183134957996, 394.21932836142713, 327.66309283722626, 375.30000000000155, 208.19459162010534, 394.68285401314716, 87.03771314328017, 188.33595090021356, 101.10251721497542, 172.14912727590365, 322.5150764162826, 329.964246935987, 175.65489817033279, 356.28667210272516, 106.00995319414832, 141.93183106104811, 342.62418565463486, 265.3431092012609, 231.3390281066847, 161.6478183988567, 231.28631602448053, 405.94768733860866, 365.9206110981813, 163.53544127579195, 236.74524785948532, 272.71093430894814, 187.41317261941825, 235.02810515076538, 194.586344712568, 307.4237325142271, 54.86092783622064, 161.67776414025013, 300.5607751994489, 31.65058770489012, 207.586768941298, 168.06416331867192, 162.7061198501114, 582.0865649097859, 174.57690589692186, 44.602512763722665, 261.18525088389055, 289.78365999175315, 48.79177299486338, 444.50362581214006, 392.0541675600187, 343.70596643683905, 97.95624294993846, 124.32154333339244, 346.42152619624613, 418.17276708291115, 154.3800789504543, 432.63487589795767, 92.76001013370663, 219.6237440659582, 223.12515784717277, 36.50662733468277, 148.31498469129093, 452.8313663279074, 44.60326819717515, 245.26282325998628, 99.66299871707034, 114.20822596948497], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [319.6177553866605, 120.66423129357521, -97.28725287720287, -570.6163366608296, 144.56544909255024, 303.69121519462686, -315.9334048377125, -289.8540671529937, 109.5828799876, -584.5701871867004, 1.5108193465220232, -178.55588479417258, -286.7749480133737, -78.64806327175036, -514.269551395352, -110.64213195656997, 173.3451434517006, -28.215598731026624, -405.5275285227403, -494.79659293961504, -543.2801337230935, -274.94438051340387, 265.8325551620684, 50.97658078305879, 79.76627189166939, -84.07662547243636, -690.8251448199063, -107.48939668167014, -172.42473260012227, -44.346390304053166, -358.82519356582065, 297.64256095134317, -641.5876385897881, -256.78921942515944, 239.58032285827784, 29.053721745056215, -444.6220538861353, -18.558049317709944, -532.9612376197878, -286.20913667510905, -3.2197174032913782, 163.66918102260578, -153.7048557165888, 247.21858676698253, -0.7599860405863086, -65.30384657916588, -418.95248136990284, 2.1675874418962526, 289.80932483364927, -609.849653256575, -303.05073584660664, -72.40574361791808, 235.99079060264123, -754.1871835662688, -996.5479513264862, -611.8889477716192, -21.063090113849967, 70.08337974842662, -193.7584629047521, -139.46757741649986, 376.5990243808458, -357.21622699558867, -392.9331798089448, 142.0714028357631, -667.8595622845363, 77.68605268928866, -2.831852359477997, -21.34708814928001, -20.28446557866834, -254.3998696062032, -270.0511514927424, -237.79243315717625, -302.20921077619204, -232.9009236194393, 85.79789913715051, -246.55046830643806, -561.024603163705, -237.97919056005463, -388.4570816717729, -173.686053892008, -718.9224072082114, -177.63114152213143, 287.66497984394556, 31.005670402120227, -797.7438469550011, -738.0260475070893, -831.2343315564065, -789.0031886616539, -926.2761294299785, -923.4187151132238, -751.34674358521, -488.9354772763404, -839.9070652438392, -1150.4855311542217, -890.5642947945425, -731.7446089106136, -512.5808965387911, -1066.5858115641802, -362.2744848989038, -246.9714006484947, -657.5677137399719, -1210.6325168941555, -145.74515125032252, -551.3628079947075, -1007.0812439428712, -811.4792315417295, -1059.3286837217686, -810.7862462450578, -708.7982803736598, -239.10516508218936, -875.6393042973864, -130.4741442523205, -477.9789743417339, -313.80186993045976, -316.9379139173587, -321.335357104323, -578.401766200406, -303.882733115195, -379.70315757984764, -597.6482084071868, 357.1912068365049, -1018.9423367762291, -222.86173349929328, -1155.3317982455849, -153.96812598394308, -1377.1599066802164, -1168.4823746717864, 35.20743924998394, -1084.8500300668873, 38.91584951970631, -166.81958921455026, -77.51741811890027, -571.341945528108, -685.7559414415562, -377.3619773135682, -516.701252177006, -728.2817460408498, -1082.0377920863039, -747.6781777429532, -1110.066291201272, -837.445462548547, -457.7840471813754, -1026.1314894635448, -1238.128954762792, -861.4947297676762, -940.3282542477111, -449.1070707797131, -992.6343909407744, -433.2140827021212, -940.9047026089181, -289.7908964435728, 248.95810659592883, -847.6975793167871, -1225.2160178412869, -1102.059403102999, -1129.5368887200327, -846.0596988465993, -792.7900902666643, -603.6187804000896, -364.3177354961411, -1201.8997331981957, -455.4013124622381, -784.2016067065596, -690.8785717304041, -56.029763830870266, -905.9726083058507, -504.0819986570972, -106.34646603105864, -1131.8549116330764, -695.9539792704338, -1010.0198013035631, -612.0262485532639, -324.5267220505547, -730.9612496326904, -935.2805862261114, -148.44892389817295, -169.80937882994127, -1125.398452393014, -1182.9299579937547, -0.48899194860008666, -995.8335117657991, -1231.155507693005, -397.06303180062895, -121.90458067257316, -363.95874924775615, -528.7005093180359, -1034.209091809126, -817.2202515059887, -683.738747380776, -935.9156917635119, -404.75943260286675, -1211.6610713221594, -1382.406352127582, -913.5003592701047, -407.4821424391196, -551.32166575727, -330.16986535287884, -1198.1923134374074, -902.6589449146717, -697.2141972232781], "policy_predator_policy_reward": [69.43283577745933, 27.619000911603095, 470.0944227763296, 535.2544157991647, 167.23005034940803, 30.93831530620575, 11.628173582203349, 860.0526736538028, 26.56992888111423, 814.6752447594789, 272.4891806534781, 247.85588479417098, 315.4520152550003, 370.14933681527225, 549.161120613019, 350.75619632987997, 295.6158788951344, 104.96063937002813, 540.598323024218, 586.5753450331756, 607.0053956518641, 418.85349397395476, 48.72003555830683, 211.43422244499752, 182.8167440397152, 313.9426341996656, 807.9358750885766, 151.26165290129768, 234.41665232084273, 274.61263623561564, 107.16333732881503, 518.5965534548232, 704.0887936630894, 415.893169143781, 117.51967714172214, 9.946278254943948, 650.2861526401919, 103.15827457262061, 665.1738265737699, 447.81838754698225, 52.13669092667582, 282.5353009948579, 147.74738109395986, 184.14760573669815, 308.49808977543995, 219.8304426436516, 488.49975346699216, 82.39250270225259, 460.56478406220515, 349.1128817499654, 381.6677650182157, 299.9224519584193, 14.017702634634716, 905.3163639216768, 681.9603924235232, 1049.3001384391534, 280.3411634359682, 0.0, 362.9584629047534, 173.8675774164979, 263.09004483227994, 314.60534583437, 657.3986108366034, 10.304370336547207, 874.8453825112366, 33.898688435460755, 402.9728622620519, 98.60156517980992, 226.6917245821155, 455.75437392525447, 572.5076607016533, 268.2446866743092, 608.0393790239406, 140.4392832275626, 365.4918931202727, 300.68852325518156, 523.8943387963201, 564.0512862770191, 133.06554824359176, 823.2969156816166, 1202.21998020858, 21.9966613589915, 28.522649515762087, 28.106700238172344, 1085.4474392996228, 658.5170467825733, 1021.3339634861793, 993.5864107450283, 895.3310118369903, 1041.4015458494919, 905.0020206296696, 523.6161511320986, 1011.6985596190319, 1079.796553994004, 831.3061797077778, 963.1518512732828, 1057.615575596627, 844.0662089226265, 687.215941320968, 251.99419116241768, 1254.884887330226, 788.9702414742333, 430.1616048905188, 623.2330264572373, 817.1936397182741, 1107.3767889604742, 958.0776442833594, 1053.9691167445108, 831.9231649178342, 458.6044661926496, 453.73257994705085, 817.7239778039134, 0.7799131685665955, 1022.3399592103125, 462.7099923595163, 337.2110970610302, 540.7612577316025, 572.8095576084836, 644.718569320336, 738.5804840053077, 2.690106296848361, 1024.9816347410572, 378.83338243769515, 1162.8955905829753, 903.8958679219642, 863.9774126016769, 988.5477022884377, 417.4381674423126, 243.64584654263376, 989.7015066239682, 102.16036948327802, 377.2047430009378, 419.2601952472431, 1032.4240364349885, 32.83592464735306, 1168.6510373574483, 726.5971911236063, 1138.5832748397695, 1026.8892833689572, 992.5329497155195, 879.9627730618075, 715.827511867564, 1069.8752938333153, 1226.0357380979124, 1036.1229191542395, 973.2868338024449, 656.9824478459315, 952.8231771932307, 829.7506861465912, 707.0742190145615, 523.0908964435729, 99.82845831385701, 1037.3367001674794, 1210.1538028875168, 1130.4619158667222, 1145.7368887200323, 969.4762448842735, 930.5587951128833, 541.5519758872339, 716.1682000007504, 1202.8997331981957, 503.19308545710123, 839.5831113036218, 1080.0006929454821, 568.0503104509847, 786.0062292457546, 512.0481944596714, 442.08623666531946, 1145.3568248956453, 780.408308957803, 1094.4672020181977, 651.9003911720242, 1081.7117349044984, 320.1977629749923, 533.8331882059857, 968.0690890012108, 350.2438035032452, 1099.3441066701637, 968.2694214969312, 647.7844043433797, 1301.2385695637854, 1018.510460028725, 369.8697468765884, 368.7216096625755, 205.4465439759638, 910.3378724370016, 781.047578765073, 1106.8883918847264, 841.8009499480532, 926.1684738875302, 1183.5516630827617, 885.7002071701709, 1384.8516503685453, 955.6583292263161, 658.1465870488307, 545.9200444075516, 336.7914084626523, 1291.233769044709, 1205.539417070095, 508.5419510373391]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.665245153510418, "mean_inference_ms": 3.470162626352086, "mean_action_processing_ms": 1.344274583759625, "mean_env_wait_ms": 9.713067958029562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004934191703796387, "StateBufferConnector_ms": 0.011408329010009766, "ViewRequirementAgentConnector_ms": 0.15040147304534912}, "num_episodes": 13, "episode_return_max": 646.425029942791, "episode_return_min": 31.65058770489012, "episode_return_mean": 285.1062500542129, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.14208162608696, "num_env_steps_trained_throughput_per_sec": 82.14208162608696, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 48848.578, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48848.531, "sample_time_ms": 2220.735, "learn_time_ms": 46609.465, "learn_throughput": 85.819, "synch_weights_time_ms": 15.339}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "fed12_00000", "date": "2024-08-21_18-23-22", "timestamp": 1724244802, "time_this_iter_s": 48.75000596046448, "time_total_s": 1127.9658391475677, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f598ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1127.9658391475677, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 25.16666666666667, "ram_util_percent": 82.30289855072462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.53138849274822, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.157463911349181, "policy_loss": -0.02153017004463999, "vf_loss": 8.176271510754944, "vf_explained_var": 0.2178821415812881, "kl": 0.013612850372822434, "entropy": 1.1913529196744244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.9601205263819015, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.23047961305689, "policy_loss": -0.01895929256468893, "vf_loss": 8.246523409545738, "vf_explained_var": 0.269167759494176, "kl": 0.014577423260059385, "entropy": 0.8281125646734995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 668.890036736282, "episode_reward_min": 31.65058770489012, "episode_reward_mean": 275.9565694327335, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1382.406352127582, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 376.5990243808458, "predator_policy": 1384.8516503685453}, "policy_reward_mean": {"prey_policy": -509.0176843116852, "predator_policy": 646.9959690280521}, "custom_metrics": {}, "hist_stats": {"episode_reward": [576.9633939484314, 492.44902465861367, 160.88298648829795, 292.25816565228195, 564.5772581691606, 221.60510479192266, 396.10000000000207, 290.26432400896715, 293.8218398258553, 495.12145554084856, 425.4087178810514, 462.26469979933944, 154.10736224123673, 489.6373373892453, 306.13373751211014, 401.1376735926828, 122.82363176457257, 329.3614530705435, 203.59999999999943, 597.0781880519073, 416.84120419997, 318.5705613514498, 477.3954869331041, 407.76176332249815, 332.90876272604334, 213.3685278558723, 505.4278472061666, 288.94183134957996, 394.21932836142713, 327.66309283722626, 375.30000000000155, 208.19459162010534, 394.68285401314716, 87.03771314328017, 188.33595090021356, 101.10251721497542, 172.14912727590365, 322.5150764162826, 329.964246935987, 175.65489817033279, 356.28667210272516, 106.00995319414832, 141.93183106104811, 342.62418565463486, 265.3431092012609, 231.3390281066847, 161.6478183988567, 231.28631602448053, 405.94768733860866, 365.9206110981813, 163.53544127579195, 236.74524785948532, 272.71093430894814, 187.41317261941825, 235.02810515076538, 194.586344712568, 307.4237325142271, 54.86092783622064, 161.67776414025013, 300.5607751994489, 31.65058770489012, 207.586768941298, 168.06416331867192, 162.7061198501114, 582.0865649097859, 174.57690589692186, 44.602512763722665, 261.18525088389055, 289.78365999175315, 48.79177299486338, 444.50362581214006, 392.0541675600187, 343.70596643683905, 97.95624294993846, 124.32154333339244, 346.42152619624613, 418.17276708291115, 154.3800789504543, 432.63487589795767, 92.76001013370663, 219.6237440659582, 223.12515784717277, 36.50662733468277, 148.31498469129093, 452.8313663279074, 44.60326819717515, 245.26282325998628, 99.66299871707034, 114.20822596948497, 335.89511147697027, 384.66288123450414, 158.58509426039066, 268.81766070636576, 80.25622852419764, 253.85031114616248, 209.8149323339247, 668.890036736282, 296.62552290666923, 254.8409415023654, 244.82252040688547], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [265.8325551620684, 50.97658078305879, 79.76627189166939, -84.07662547243636, -690.8251448199063, -107.48939668167014, -172.42473260012227, -44.346390304053166, -358.82519356582065, 297.64256095134317, -641.5876385897881, -256.78921942515944, 239.58032285827784, 29.053721745056215, -444.6220538861353, -18.558049317709944, -532.9612376197878, -286.20913667510905, -3.2197174032913782, 163.66918102260578, -153.7048557165888, 247.21858676698253, -0.7599860405863086, -65.30384657916588, -418.95248136990284, 2.1675874418962526, 289.80932483364927, -609.849653256575, -303.05073584660664, -72.40574361791808, 235.99079060264123, -754.1871835662688, -996.5479513264862, -611.8889477716192, -21.063090113849967, 70.08337974842662, -193.7584629047521, -139.46757741649986, 376.5990243808458, -357.21622699558867, -392.9331798089448, 142.0714028357631, -667.8595622845363, 77.68605268928866, -2.831852359477997, -21.34708814928001, -20.28446557866834, -254.3998696062032, -270.0511514927424, -237.79243315717625, -302.20921077619204, -232.9009236194393, 85.79789913715051, -246.55046830643806, -561.024603163705, -237.97919056005463, -388.4570816717729, -173.686053892008, -718.9224072082114, -177.63114152213143, 287.66497984394556, 31.005670402120227, -797.7438469550011, -738.0260475070893, -831.2343315564065, -789.0031886616539, -926.2761294299785, -923.4187151132238, -751.34674358521, -488.9354772763404, -839.9070652438392, -1150.4855311542217, -890.5642947945425, -731.7446089106136, -512.5808965387911, -1066.5858115641802, -362.2744848989038, -246.9714006484947, -657.5677137399719, -1210.6325168941555, -145.74515125032252, -551.3628079947075, -1007.0812439428712, -811.4792315417295, -1059.3286837217686, -810.7862462450578, -708.7982803736598, -239.10516508218936, -875.6393042973864, -130.4741442523205, -477.9789743417339, -313.80186993045976, -316.9379139173587, -321.335357104323, -578.401766200406, -303.882733115195, -379.70315757984764, -597.6482084071868, 357.1912068365049, -1018.9423367762291, -222.86173349929328, -1155.3317982455849, -153.96812598394308, -1377.1599066802164, -1168.4823746717864, 35.20743924998394, -1084.8500300668873, 38.91584951970631, -166.81958921455026, -77.51741811890027, -571.341945528108, -685.7559414415562, -377.3619773135682, -516.701252177006, -728.2817460408498, -1082.0377920863039, -747.6781777429532, -1110.066291201272, -837.445462548547, -457.7840471813754, -1026.1314894635448, -1238.128954762792, -861.4947297676762, -940.3282542477111, -449.1070707797131, -992.6343909407744, -433.2140827021212, -940.9047026089181, -289.7908964435728, 248.95810659592883, -847.6975793167871, -1225.2160178412869, -1102.059403102999, -1129.5368887200327, -846.0596988465993, -792.7900902666643, -603.6187804000896, -364.3177354961411, -1201.8997331981957, -455.4013124622381, -784.2016067065596, -690.8785717304041, -56.029763830870266, -905.9726083058507, -504.0819986570972, -106.34646603105864, -1131.8549116330764, -695.9539792704338, -1010.0198013035631, -612.0262485532639, -324.5267220505547, -730.9612496326904, -935.2805862261114, -148.44892389817295, -169.80937882994127, -1125.398452393014, -1182.9299579937547, -0.48899194860008666, -995.8335117657991, -1231.155507693005, -397.06303180062895, -121.90458067257316, -363.95874924775615, -528.7005093180359, -1034.209091809126, -817.2202515059887, -683.738747380776, -935.9156917635119, -404.75943260286675, -1211.6610713221594, -1382.406352127582, -913.5003592701047, -407.4821424391196, -551.32166575727, -330.16986535287884, -1198.1923134374074, -902.6589449146717, -697.2141972232781, -279.27949249923523, -1000.9678362931688, -446.6432068931443, -173.6063176133674, -593.5187370072331, -1087.5290663090025, -506.39308498954034, -517.8297905669167, -1199.786421171918, -953.4600918705863, -1016.797838778905, -220.66779735244748, -847.2256654478573, -816.9081702826047, 133.1309788955138, 334.7089103032256, -750.3387618555212, 18.20667937270867, -524.9527890558771, -1096.5084110157964, -671.9663090504929, -941.3551380558968], "policy_predator_policy_reward": [48.72003555830683, 211.43422244499752, 182.8167440397152, 313.9426341996656, 807.9358750885766, 151.26165290129768, 234.41665232084273, 274.61263623561564, 107.16333732881503, 518.5965534548232, 704.0887936630894, 415.893169143781, 117.51967714172214, 9.946278254943948, 650.2861526401919, 103.15827457262061, 665.1738265737699, 447.81838754698225, 52.13669092667582, 282.5353009948579, 147.74738109395986, 184.14760573669815, 308.49808977543995, 219.8304426436516, 488.49975346699216, 82.39250270225259, 460.56478406220515, 349.1128817499654, 381.6677650182157, 299.9224519584193, 14.017702634634716, 905.3163639216768, 681.9603924235232, 1049.3001384391534, 280.3411634359682, 0.0, 362.9584629047534, 173.8675774164979, 263.09004483227994, 314.60534583437, 657.3986108366034, 10.304370336547207, 874.8453825112366, 33.898688435460755, 402.9728622620519, 98.60156517980992, 226.6917245821155, 455.75437392525447, 572.5076607016533, 268.2446866743092, 608.0393790239406, 140.4392832275626, 365.4918931202727, 300.68852325518156, 523.8943387963201, 564.0512862770191, 133.06554824359176, 823.2969156816166, 1202.21998020858, 21.9966613589915, 28.522649515762087, 28.106700238172344, 1085.4474392996228, 658.5170467825733, 1021.3339634861793, 993.5864107450283, 895.3310118369903, 1041.4015458494919, 905.0020206296696, 523.6161511320986, 1011.6985596190319, 1079.796553994004, 831.3061797077778, 963.1518512732828, 1057.615575596627, 844.0662089226265, 687.215941320968, 251.99419116241768, 1254.884887330226, 788.9702414742333, 430.1616048905188, 623.2330264572373, 817.1936397182741, 1107.3767889604742, 958.0776442833594, 1053.9691167445108, 831.9231649178342, 458.6044661926496, 453.73257994705085, 817.7239778039134, 0.7799131685665955, 1022.3399592103125, 462.7099923595163, 337.2110970610302, 540.7612577316025, 572.8095576084836, 644.718569320336, 738.5804840053077, 2.690106296848361, 1024.9816347410572, 378.83338243769515, 1162.8955905829753, 903.8958679219642, 863.9774126016769, 988.5477022884377, 417.4381674423126, 243.64584654263376, 989.7015066239682, 102.16036948327802, 377.2047430009378, 419.2601952472431, 1032.4240364349885, 32.83592464735306, 1168.6510373574483, 726.5971911236063, 1138.5832748397695, 1026.8892833689572, 992.5329497155195, 879.9627730618075, 715.827511867564, 1069.8752938333153, 1226.0357380979124, 1036.1229191542395, 973.2868338024449, 656.9824478459315, 952.8231771932307, 829.7506861465912, 707.0742190145615, 523.0908964435729, 99.82845831385701, 1037.3367001674794, 1210.1538028875168, 1130.4619158667222, 1145.7368887200323, 969.4762448842735, 930.5587951128833, 541.5519758872339, 716.1682000007504, 1202.8997331981957, 503.19308545710123, 839.5831113036218, 1080.0006929454821, 568.0503104509847, 786.0062292457546, 512.0481944596714, 442.08623666531946, 1145.3568248956453, 780.408308957803, 1094.4672020181977, 651.9003911720242, 1081.7117349044984, 320.1977629749923, 533.8331882059857, 968.0690890012108, 350.2438035032452, 1099.3441066701637, 968.2694214969312, 647.7844043433797, 1301.2385695637854, 1018.510460028725, 369.8697468765884, 368.7216096625755, 205.4465439759638, 910.3378724370016, 781.047578765073, 1106.8883918847264, 841.8009499480532, 926.1684738875302, 1183.5516630827617, 885.7002071701709, 1384.8516503685453, 955.6583292263161, 658.1465870488307, 545.9200444075516, 336.7914084626523, 1291.233769044709, 1205.539417070095, 508.5419510373391, 492.8254295437035, 1123.3170107256751, 4.932495066170105, 999.9799106748461, 1041.4129963765117, 798.219901200118, 363.8333809349885, 929.2071553278345, 1185.0851682972989, 1048.4175732694025, 254.82678539534683, 1236.4891618821678, 710.0313538912676, 1163.9174141731219, 128.48642304030503, 72.56372449723744, 219.36817805297454, 809.3894273365074, 926.4394766952826, 949.8626648787563, 883.9345417825249, 974.2094257307504]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.679804872251716, "mean_inference_ms": 3.4728449115510296, "mean_action_processing_ms": 1.3401168937664087, "mean_env_wait_ms": 9.727315251875492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054132938385009766, "StateBufferConnector_ms": 0.011599898338317871, "ViewRequirementAgentConnector_ms": 0.15823721885681152}, "num_episodes": 11, "episode_return_max": 668.890036736282, "episode_return_min": 31.65058770489012, "episode_return_mean": 275.9565694327335, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.63538965891972, "num_env_steps_trained_throughput_per_sec": 82.63538965891972, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 48779.321, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48779.273, "sample_time_ms": 2193.235, "learn_time_ms": 46568.408, "learn_throughput": 85.895, "synch_weights_time_ms": 14.934}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "fed12_00000", "date": "2024-08-21_18-24-11", "timestamp": 1724244851, "time_this_iter_s": 48.4121150970459, "time_total_s": 1176.3779542446136, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4bdd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1176.3779542446136, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 24.73676470588235, "ram_util_percent": 82.67352941176469}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.563018677663552, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.319841799912629, "policy_loss": -0.0187626168324006, "vf_loss": 8.33587867267548, "vf_explained_var": 0.23875584703273875, "kl": 0.013628629927410098, "entropy": 1.2084696031752087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.355619168123871, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.237042671536642, "policy_loss": -0.020041131295470728, "vf_loss": 8.253955622324868, "vf_explained_var": 0.2788573902120035, "kl": 0.015640933105781202, "entropy": 0.8308734089609177, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 668.890036736282, "episode_reward_min": 31.65058770489012, "episode_reward_mean": 275.9565694327335, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1382.406352127582, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 376.5990243808458, "predator_policy": 1384.8516503685453}, "policy_reward_mean": {"prey_policy": -509.0176843116852, "predator_policy": 646.9959690280521}, "custom_metrics": {}, "hist_stats": {"episode_reward": [576.9633939484314, 492.44902465861367, 160.88298648829795, 292.25816565228195, 564.5772581691606, 221.60510479192266, 396.10000000000207, 290.26432400896715, 293.8218398258553, 495.12145554084856, 425.4087178810514, 462.26469979933944, 154.10736224123673, 489.6373373892453, 306.13373751211014, 401.1376735926828, 122.82363176457257, 329.3614530705435, 203.59999999999943, 597.0781880519073, 416.84120419997, 318.5705613514498, 477.3954869331041, 407.76176332249815, 332.90876272604334, 213.3685278558723, 505.4278472061666, 288.94183134957996, 394.21932836142713, 327.66309283722626, 375.30000000000155, 208.19459162010534, 394.68285401314716, 87.03771314328017, 188.33595090021356, 101.10251721497542, 172.14912727590365, 322.5150764162826, 329.964246935987, 175.65489817033279, 356.28667210272516, 106.00995319414832, 141.93183106104811, 342.62418565463486, 265.3431092012609, 231.3390281066847, 161.6478183988567, 231.28631602448053, 405.94768733860866, 365.9206110981813, 163.53544127579195, 236.74524785948532, 272.71093430894814, 187.41317261941825, 235.02810515076538, 194.586344712568, 307.4237325142271, 54.86092783622064, 161.67776414025013, 300.5607751994489, 31.65058770489012, 207.586768941298, 168.06416331867192, 162.7061198501114, 582.0865649097859, 174.57690589692186, 44.602512763722665, 261.18525088389055, 289.78365999175315, 48.79177299486338, 444.50362581214006, 392.0541675600187, 343.70596643683905, 97.95624294993846, 124.32154333339244, 346.42152619624613, 418.17276708291115, 154.3800789504543, 432.63487589795767, 92.76001013370663, 219.6237440659582, 223.12515784717277, 36.50662733468277, 148.31498469129093, 452.8313663279074, 44.60326819717515, 245.26282325998628, 99.66299871707034, 114.20822596948497, 335.89511147697027, 384.66288123450414, 158.58509426039066, 268.81766070636576, 80.25622852419764, 253.85031114616248, 209.8149323339247, 668.890036736282, 296.62552290666923, 254.8409415023654, 244.82252040688547], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [265.8325551620684, 50.97658078305879, 79.76627189166939, -84.07662547243636, -690.8251448199063, -107.48939668167014, -172.42473260012227, -44.346390304053166, -358.82519356582065, 297.64256095134317, -641.5876385897881, -256.78921942515944, 239.58032285827784, 29.053721745056215, -444.6220538861353, -18.558049317709944, -532.9612376197878, -286.20913667510905, -3.2197174032913782, 163.66918102260578, -153.7048557165888, 247.21858676698253, -0.7599860405863086, -65.30384657916588, -418.95248136990284, 2.1675874418962526, 289.80932483364927, -609.849653256575, -303.05073584660664, -72.40574361791808, 235.99079060264123, -754.1871835662688, -996.5479513264862, -611.8889477716192, -21.063090113849967, 70.08337974842662, -193.7584629047521, -139.46757741649986, 376.5990243808458, -357.21622699558867, -392.9331798089448, 142.0714028357631, -667.8595622845363, 77.68605268928866, -2.831852359477997, -21.34708814928001, -20.28446557866834, -254.3998696062032, -270.0511514927424, -237.79243315717625, -302.20921077619204, -232.9009236194393, 85.79789913715051, -246.55046830643806, -561.024603163705, -237.97919056005463, -388.4570816717729, -173.686053892008, -718.9224072082114, -177.63114152213143, 287.66497984394556, 31.005670402120227, -797.7438469550011, -738.0260475070893, -831.2343315564065, -789.0031886616539, -926.2761294299785, -923.4187151132238, -751.34674358521, -488.9354772763404, -839.9070652438392, -1150.4855311542217, -890.5642947945425, -731.7446089106136, -512.5808965387911, -1066.5858115641802, -362.2744848989038, -246.9714006484947, -657.5677137399719, -1210.6325168941555, -145.74515125032252, -551.3628079947075, -1007.0812439428712, -811.4792315417295, -1059.3286837217686, -810.7862462450578, -708.7982803736598, -239.10516508218936, -875.6393042973864, -130.4741442523205, -477.9789743417339, -313.80186993045976, -316.9379139173587, -321.335357104323, -578.401766200406, -303.882733115195, -379.70315757984764, -597.6482084071868, 357.1912068365049, -1018.9423367762291, -222.86173349929328, -1155.3317982455849, -153.96812598394308, -1377.1599066802164, -1168.4823746717864, 35.20743924998394, -1084.8500300668873, 38.91584951970631, -166.81958921455026, -77.51741811890027, -571.341945528108, -685.7559414415562, -377.3619773135682, -516.701252177006, -728.2817460408498, -1082.0377920863039, -747.6781777429532, -1110.066291201272, -837.445462548547, -457.7840471813754, -1026.1314894635448, -1238.128954762792, -861.4947297676762, -940.3282542477111, -449.1070707797131, -992.6343909407744, -433.2140827021212, -940.9047026089181, -289.7908964435728, 248.95810659592883, -847.6975793167871, -1225.2160178412869, -1102.059403102999, -1129.5368887200327, -846.0596988465993, -792.7900902666643, -603.6187804000896, -364.3177354961411, -1201.8997331981957, -455.4013124622381, -784.2016067065596, -690.8785717304041, -56.029763830870266, -905.9726083058507, -504.0819986570972, -106.34646603105864, -1131.8549116330764, -695.9539792704338, -1010.0198013035631, -612.0262485532639, -324.5267220505547, -730.9612496326904, -935.2805862261114, -148.44892389817295, -169.80937882994127, -1125.398452393014, -1182.9299579937547, -0.48899194860008666, -995.8335117657991, -1231.155507693005, -397.06303180062895, -121.90458067257316, -363.95874924775615, -528.7005093180359, -1034.209091809126, -817.2202515059887, -683.738747380776, -935.9156917635119, -404.75943260286675, -1211.6610713221594, -1382.406352127582, -913.5003592701047, -407.4821424391196, -551.32166575727, -330.16986535287884, -1198.1923134374074, -902.6589449146717, -697.2141972232781, -279.27949249923523, -1000.9678362931688, -446.6432068931443, -173.6063176133674, -593.5187370072331, -1087.5290663090025, -506.39308498954034, -517.8297905669167, -1199.786421171918, -953.4600918705863, -1016.797838778905, -220.66779735244748, -847.2256654478573, -816.9081702826047, 133.1309788955138, 334.7089103032256, -750.3387618555212, 18.20667937270867, -524.9527890558771, -1096.5084110157964, -671.9663090504929, -941.3551380558968], "policy_predator_policy_reward": [48.72003555830683, 211.43422244499752, 182.8167440397152, 313.9426341996656, 807.9358750885766, 151.26165290129768, 234.41665232084273, 274.61263623561564, 107.16333732881503, 518.5965534548232, 704.0887936630894, 415.893169143781, 117.51967714172214, 9.946278254943948, 650.2861526401919, 103.15827457262061, 665.1738265737699, 447.81838754698225, 52.13669092667582, 282.5353009948579, 147.74738109395986, 184.14760573669815, 308.49808977543995, 219.8304426436516, 488.49975346699216, 82.39250270225259, 460.56478406220515, 349.1128817499654, 381.6677650182157, 299.9224519584193, 14.017702634634716, 905.3163639216768, 681.9603924235232, 1049.3001384391534, 280.3411634359682, 0.0, 362.9584629047534, 173.8675774164979, 263.09004483227994, 314.60534583437, 657.3986108366034, 10.304370336547207, 874.8453825112366, 33.898688435460755, 402.9728622620519, 98.60156517980992, 226.6917245821155, 455.75437392525447, 572.5076607016533, 268.2446866743092, 608.0393790239406, 140.4392832275626, 365.4918931202727, 300.68852325518156, 523.8943387963201, 564.0512862770191, 133.06554824359176, 823.2969156816166, 1202.21998020858, 21.9966613589915, 28.522649515762087, 28.106700238172344, 1085.4474392996228, 658.5170467825733, 1021.3339634861793, 993.5864107450283, 895.3310118369903, 1041.4015458494919, 905.0020206296696, 523.6161511320986, 1011.6985596190319, 1079.796553994004, 831.3061797077778, 963.1518512732828, 1057.615575596627, 844.0662089226265, 687.215941320968, 251.99419116241768, 1254.884887330226, 788.9702414742333, 430.1616048905188, 623.2330264572373, 817.1936397182741, 1107.3767889604742, 958.0776442833594, 1053.9691167445108, 831.9231649178342, 458.6044661926496, 453.73257994705085, 817.7239778039134, 0.7799131685665955, 1022.3399592103125, 462.7099923595163, 337.2110970610302, 540.7612577316025, 572.8095576084836, 644.718569320336, 738.5804840053077, 2.690106296848361, 1024.9816347410572, 378.83338243769515, 1162.8955905829753, 903.8958679219642, 863.9774126016769, 988.5477022884377, 417.4381674423126, 243.64584654263376, 989.7015066239682, 102.16036948327802, 377.2047430009378, 419.2601952472431, 1032.4240364349885, 32.83592464735306, 1168.6510373574483, 726.5971911236063, 1138.5832748397695, 1026.8892833689572, 992.5329497155195, 879.9627730618075, 715.827511867564, 1069.8752938333153, 1226.0357380979124, 1036.1229191542395, 973.2868338024449, 656.9824478459315, 952.8231771932307, 829.7506861465912, 707.0742190145615, 523.0908964435729, 99.82845831385701, 1037.3367001674794, 1210.1538028875168, 1130.4619158667222, 1145.7368887200323, 969.4762448842735, 930.5587951128833, 541.5519758872339, 716.1682000007504, 1202.8997331981957, 503.19308545710123, 839.5831113036218, 1080.0006929454821, 568.0503104509847, 786.0062292457546, 512.0481944596714, 442.08623666531946, 1145.3568248956453, 780.408308957803, 1094.4672020181977, 651.9003911720242, 1081.7117349044984, 320.1977629749923, 533.8331882059857, 968.0690890012108, 350.2438035032452, 1099.3441066701637, 968.2694214969312, 647.7844043433797, 1301.2385695637854, 1018.510460028725, 369.8697468765884, 368.7216096625755, 205.4465439759638, 910.3378724370016, 781.047578765073, 1106.8883918847264, 841.8009499480532, 926.1684738875302, 1183.5516630827617, 885.7002071701709, 1384.8516503685453, 955.6583292263161, 658.1465870488307, 545.9200444075516, 336.7914084626523, 1291.233769044709, 1205.539417070095, 508.5419510373391, 492.8254295437035, 1123.3170107256751, 4.932495066170105, 999.9799106748461, 1041.4129963765117, 798.219901200118, 363.8333809349885, 929.2071553278345, 1185.0851682972989, 1048.4175732694025, 254.82678539534683, 1236.4891618821678, 710.0313538912676, 1163.9174141731219, 128.48642304030503, 72.56372449723744, 219.36817805297454, 809.3894273365074, 926.4394766952826, 949.8626648787563, 883.9345417825249, 974.2094257307504]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.679804872251716, "mean_inference_ms": 3.4728449115510296, "mean_action_processing_ms": 1.3401168937664087, "mean_env_wait_ms": 9.727315251875492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054132938385009766, "StateBufferConnector_ms": 0.011599898338317871, "ViewRequirementAgentConnector_ms": 0.15823721885681152}, "num_episodes": 0, "episode_return_max": 668.890036736282, "episode_return_min": 31.65058770489012, "episode_return_mean": 275.9565694327335, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.29512230380564, "num_env_steps_trained_throughput_per_sec": 82.29512230380564, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 48771.819, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48771.771, "sample_time_ms": 2178.24, "learn_time_ms": 46576.046, "learn_throughput": 85.881, "synch_weights_time_ms": 14.699}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "fed12_00000", "date": "2024-08-21_18-24-59", "timestamp": 1724244899, "time_this_iter_s": 48.66435503959656, "time_total_s": 1225.0423092842102, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f310820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1225.0423092842102, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 24.617391304347827, "ram_util_percent": 81.79999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.022664174106385, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.983012640665448, "policy_loss": -0.01984242462644245, "vf_loss": 7.999866603669666, "vf_explained_var": 0.23156412054621983, "kl": 0.014942218828946353, "entropy": 1.2073215865584277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.94463526464644, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.833497494238395, "policy_loss": -0.017522325559775467, "vf_loss": 7.848316566780131, "vf_explained_var": 0.33516872522061464, "kl": 0.013516166848105885, "entropy": 0.8193967571964971, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 668.890036736282, "episode_reward_min": 17.299999999999997, "episode_reward_mean": 260.90870977463914, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1382.406352127582, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 376.5990243808458, "predator_policy": 1387.4533341743165}, "policy_reward_mean": {"prey_policy": -575.3595170924507, "predator_policy": 705.8138719797705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [495.12145554084856, 425.4087178810514, 462.26469979933944, 154.10736224123673, 489.6373373892453, 306.13373751211014, 401.1376735926828, 122.82363176457257, 329.3614530705435, 203.59999999999943, 597.0781880519073, 416.84120419997, 318.5705613514498, 477.3954869331041, 407.76176332249815, 332.90876272604334, 213.3685278558723, 505.4278472061666, 288.94183134957996, 394.21932836142713, 327.66309283722626, 375.30000000000155, 208.19459162010534, 394.68285401314716, 87.03771314328017, 188.33595090021356, 101.10251721497542, 172.14912727590365, 322.5150764162826, 329.964246935987, 175.65489817033279, 356.28667210272516, 106.00995319414832, 141.93183106104811, 342.62418565463486, 265.3431092012609, 231.3390281066847, 161.6478183988567, 231.28631602448053, 405.94768733860866, 365.9206110981813, 163.53544127579195, 236.74524785948532, 272.71093430894814, 187.41317261941825, 235.02810515076538, 194.586344712568, 307.4237325142271, 54.86092783622064, 161.67776414025013, 300.5607751994489, 31.65058770489012, 207.586768941298, 168.06416331867192, 162.7061198501114, 582.0865649097859, 174.57690589692186, 44.602512763722665, 261.18525088389055, 289.78365999175315, 48.79177299486338, 444.50362581214006, 392.0541675600187, 343.70596643683905, 97.95624294993846, 124.32154333339244, 346.42152619624613, 418.17276708291115, 154.3800789504543, 432.63487589795767, 92.76001013370663, 219.6237440659582, 223.12515784717277, 36.50662733468277, 148.31498469129093, 452.8313663279074, 44.60326819717515, 245.26282325998628, 99.66299871707034, 114.20822596948497, 335.89511147697027, 384.66288123450414, 158.58509426039066, 268.81766070636576, 80.25622852419764, 253.85031114616248, 209.8149323339247, 668.890036736282, 296.62552290666923, 254.8409415023654, 244.82252040688547, 109.76636426647869, 446.3849055604791, 44.06306062730222, 411.9211277085188, 17.299999999999997, 60.20094982414935, 316.19489059675703, 327.52550223111825, 50.779330919291226], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-3.2197174032913782, 163.66918102260578, -153.7048557165888, 247.21858676698253, -0.7599860405863086, -65.30384657916588, -418.95248136990284, 2.1675874418962526, 289.80932483364927, -609.849653256575, -303.05073584660664, -72.40574361791808, 235.99079060264123, -754.1871835662688, -996.5479513264862, -611.8889477716192, -21.063090113849967, 70.08337974842662, -193.7584629047521, -139.46757741649986, 376.5990243808458, -357.21622699558867, -392.9331798089448, 142.0714028357631, -667.8595622845363, 77.68605268928866, -2.831852359477997, -21.34708814928001, -20.28446557866834, -254.3998696062032, -270.0511514927424, -237.79243315717625, -302.20921077619204, -232.9009236194393, 85.79789913715051, -246.55046830643806, -561.024603163705, -237.97919056005463, -388.4570816717729, -173.686053892008, -718.9224072082114, -177.63114152213143, 287.66497984394556, 31.005670402120227, -797.7438469550011, -738.0260475070893, -831.2343315564065, -789.0031886616539, -926.2761294299785, -923.4187151132238, -751.34674358521, -488.9354772763404, -839.9070652438392, -1150.4855311542217, -890.5642947945425, -731.7446089106136, -512.5808965387911, -1066.5858115641802, -362.2744848989038, -246.9714006484947, -657.5677137399719, -1210.6325168941555, -145.74515125032252, -551.3628079947075, -1007.0812439428712, -811.4792315417295, -1059.3286837217686, -810.7862462450578, -708.7982803736598, -239.10516508218936, -875.6393042973864, -130.4741442523205, -477.9789743417339, -313.80186993045976, -316.9379139173587, -321.335357104323, -578.401766200406, -303.882733115195, -379.70315757984764, -597.6482084071868, 357.1912068365049, -1018.9423367762291, -222.86173349929328, -1155.3317982455849, -153.96812598394308, -1377.1599066802164, -1168.4823746717864, 35.20743924998394, -1084.8500300668873, 38.91584951970631, -166.81958921455026, -77.51741811890027, -571.341945528108, -685.7559414415562, -377.3619773135682, -516.701252177006, -728.2817460408498, -1082.0377920863039, -747.6781777429532, -1110.066291201272, -837.445462548547, -457.7840471813754, -1026.1314894635448, -1238.128954762792, -861.4947297676762, -940.3282542477111, -449.1070707797131, -992.6343909407744, -433.2140827021212, -940.9047026089181, -289.7908964435728, 248.95810659592883, -847.6975793167871, -1225.2160178412869, -1102.059403102999, -1129.5368887200327, -846.0596988465993, -792.7900902666643, -603.6187804000896, -364.3177354961411, -1201.8997331981957, -455.4013124622381, -784.2016067065596, -690.8785717304041, -56.029763830870266, -905.9726083058507, -504.0819986570972, -106.34646603105864, -1131.8549116330764, -695.9539792704338, -1010.0198013035631, -612.0262485532639, -324.5267220505547, -730.9612496326904, -935.2805862261114, -148.44892389817295, -169.80937882994127, -1125.398452393014, -1182.9299579937547, -0.48899194860008666, -995.8335117657991, -1231.155507693005, -397.06303180062895, -121.90458067257316, -363.95874924775615, -528.7005093180359, -1034.209091809126, -817.2202515059887, -683.738747380776, -935.9156917635119, -404.75943260286675, -1211.6610713221594, -1382.406352127582, -913.5003592701047, -407.4821424391196, -551.32166575727, -330.16986535287884, -1198.1923134374074, -902.6589449146717, -697.2141972232781, -279.27949249923523, -1000.9678362931688, -446.6432068931443, -173.6063176133674, -593.5187370072331, -1087.5290663090025, -506.39308498954034, -517.8297905669167, -1199.786421171918, -953.4600918705863, -1016.797838778905, -220.66779735244748, -847.2256654478573, -816.9081702826047, 133.1309788955138, 334.7089103032256, -750.3387618555212, 18.20667937270867, -524.9527890558771, -1096.5084110157964, -671.9663090504929, -941.3551380558968, -997.618831647233, -1116.967724224598, -32.847078546051236, -1167.2343716036742, -1181.9553623351599, -1161.17358753075, -585.3342914330955, -1353.8237654056084, -1172.6361030876806, -1144.3398669167227, -1002.1490220297721, -1093.0248967445755, -510.04772442063745, -172.17889403447342, 281.9124136744257, -1250.178649974291, -1106.159641490521, -1178.4719639689242], "policy_predator_policy_reward": [52.13669092667582, 282.5353009948579, 147.74738109395986, 184.14760573669815, 308.49808977543995, 219.8304426436516, 488.49975346699216, 82.39250270225259, 460.56478406220515, 349.1128817499654, 381.6677650182157, 299.9224519584193, 14.017702634634716, 905.3163639216768, 681.9603924235232, 1049.3001384391534, 280.3411634359682, 0.0, 362.9584629047534, 173.8675774164979, 263.09004483227994, 314.60534583437, 657.3986108366034, 10.304370336547207, 874.8453825112366, 33.898688435460755, 402.9728622620519, 98.60156517980992, 226.6917245821155, 455.75437392525447, 572.5076607016533, 268.2446866743092, 608.0393790239406, 140.4392832275626, 365.4918931202727, 300.68852325518156, 523.8943387963201, 564.0512862770191, 133.06554824359176, 823.2969156816166, 1202.21998020858, 21.9966613589915, 28.522649515762087, 28.106700238172344, 1085.4474392996228, 658.5170467825733, 1021.3339634861793, 993.5864107450283, 895.3310118369903, 1041.4015458494919, 905.0020206296696, 523.6161511320986, 1011.6985596190319, 1079.796553994004, 831.3061797077778, 963.1518512732828, 1057.615575596627, 844.0662089226265, 687.215941320968, 251.99419116241768, 1254.884887330226, 788.9702414742333, 430.1616048905188, 623.2330264572373, 817.1936397182741, 1107.3767889604742, 958.0776442833594, 1053.9691167445108, 831.9231649178342, 458.6044661926496, 453.73257994705085, 817.7239778039134, 0.7799131685665955, 1022.3399592103125, 462.7099923595163, 337.2110970610302, 540.7612577316025, 572.8095576084836, 644.718569320336, 738.5804840053077, 2.690106296848361, 1024.9816347410572, 378.83338243769515, 1162.8955905829753, 903.8958679219642, 863.9774126016769, 988.5477022884377, 417.4381674423126, 243.64584654263376, 989.7015066239682, 102.16036948327802, 377.2047430009378, 419.2601952472431, 1032.4240364349885, 32.83592464735306, 1168.6510373574483, 726.5971911236063, 1138.5832748397695, 1026.8892833689572, 992.5329497155195, 879.9627730618075, 715.827511867564, 1069.8752938333153, 1226.0357380979124, 1036.1229191542395, 973.2868338024449, 656.9824478459315, 952.8231771932307, 829.7506861465912, 707.0742190145615, 523.0908964435729, 99.82845831385701, 1037.3367001674794, 1210.1538028875168, 1130.4619158667222, 1145.7368887200323, 969.4762448842735, 930.5587951128833, 541.5519758872339, 716.1682000007504, 1202.8997331981957, 503.19308545710123, 839.5831113036218, 1080.0006929454821, 568.0503104509847, 786.0062292457546, 512.0481944596714, 442.08623666531946, 1145.3568248956453, 780.408308957803, 1094.4672020181977, 651.9003911720242, 1081.7117349044984, 320.1977629749923, 533.8331882059857, 968.0690890012108, 350.2438035032452, 1099.3441066701637, 968.2694214969312, 647.7844043433797, 1301.2385695637854, 1018.510460028725, 369.8697468765884, 368.7216096625755, 205.4465439759638, 910.3378724370016, 781.047578765073, 1106.8883918847264, 841.8009499480532, 926.1684738875302, 1183.5516630827617, 885.7002071701709, 1384.8516503685453, 955.6583292263161, 658.1465870488307, 545.9200444075516, 336.7914084626523, 1291.233769044709, 1205.539417070095, 508.5419510373391, 492.8254295437035, 1123.3170107256751, 4.932495066170105, 999.9799106748461, 1041.4129963765117, 798.219901200118, 363.8333809349885, 929.2071553278345, 1185.0851682972989, 1048.4175732694025, 254.82678539534683, 1236.4891618821678, 710.0313538912676, 1163.9174141731219, 128.48642304030503, 72.56372449723744, 219.36817805297454, 809.3894273365074, 926.4394766952826, 949.8626648787563, 883.9345417825249, 974.2094257307504, 1105.7368109140193, 1118.61610922429, 804.5706049861217, 841.8957507240823, 1387.4533341743165, 999.7386763188895, 1126.5089605004323, 1224.5702240467895, 1172.6361030876806, 1161.6398669167227, 929.0536335339846, 1226.3212350645122, 555.2323698927994, 443.18913915906217, 1187.8062200341526, 107.98551849683028, 1137.3751749429698, 1198.0357614357656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.682801135710869, "mean_inference_ms": 3.466767129060774, "mean_action_processing_ms": 1.3308408218448904, "mean_env_wait_ms": 9.73937623106049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054454803466796875, "StateBufferConnector_ms": 0.01139819622039795, "ViewRequirementAgentConnector_ms": 0.15023517608642578}, "num_episodes": 9, "episode_return_max": 668.890036736282, "episode_return_min": 17.299999999999997, "episode_return_mean": 260.90870977463914, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.17257851325887, "num_env_steps_trained_throughput_per_sec": 81.17257851325887, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 48806.866, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48806.816, "sample_time_ms": 2134.599, "learn_time_ms": 46655.041, "learn_throughput": 85.736, "synch_weights_time_ms": 14.573}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "fed12_00000", "date": "2024-08-21_18-25-49", "timestamp": 1724244949, "time_this_iter_s": 49.322580099105835, "time_total_s": 1274.364889383316, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4ad310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1274.364889383316, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 32.13, "ram_util_percent": 82.86999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.560733510135973, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.894270150371329, "policy_loss": -0.021614868193741633, "vf_loss": 7.912978447555865, "vf_explained_var": 0.24357092503517394, "kl": 0.014532793479326067, "entropy": 1.183166785214944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.219803090953322, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.961159883983552, "policy_loss": -0.016250100246477852, "vf_loss": 7.9745105019322144, "vf_explained_var": 0.3470445548731183, "kl": 0.014497348622581552, "entropy": 0.8085865173074934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 668.890036736282, "episode_reward_min": 17.299999999999997, "episode_reward_mean": 248.6942752487703, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1382.406352127582, "predator_policy": 0.7799131685665955}, "policy_reward_max": {"prey_policy": 357.1912068365049, "predator_policy": 1387.4533341743165}, "policy_reward_mean": {"prey_policy": -638.2203693621153, "predator_policy": 762.5675069865006}, "custom_metrics": {}, "hist_stats": {"episode_reward": [416.84120419997, 318.5705613514498, 477.3954869331041, 407.76176332249815, 332.90876272604334, 213.3685278558723, 505.4278472061666, 288.94183134957996, 394.21932836142713, 327.66309283722626, 375.30000000000155, 208.19459162010534, 394.68285401314716, 87.03771314328017, 188.33595090021356, 101.10251721497542, 172.14912727590365, 322.5150764162826, 329.964246935987, 175.65489817033279, 356.28667210272516, 106.00995319414832, 141.93183106104811, 342.62418565463486, 265.3431092012609, 231.3390281066847, 161.6478183988567, 231.28631602448053, 405.94768733860866, 365.9206110981813, 163.53544127579195, 236.74524785948532, 272.71093430894814, 187.41317261941825, 235.02810515076538, 194.586344712568, 307.4237325142271, 54.86092783622064, 161.67776414025013, 300.5607751994489, 31.65058770489012, 207.586768941298, 168.06416331867192, 162.7061198501114, 582.0865649097859, 174.57690589692186, 44.602512763722665, 261.18525088389055, 289.78365999175315, 48.79177299486338, 444.50362581214006, 392.0541675600187, 343.70596643683905, 97.95624294993846, 124.32154333339244, 346.42152619624613, 418.17276708291115, 154.3800789504543, 432.63487589795767, 92.76001013370663, 219.6237440659582, 223.12515784717277, 36.50662733468277, 148.31498469129093, 452.8313663279074, 44.60326819717515, 245.26282325998628, 99.66299871707034, 114.20822596948497, 335.89511147697027, 384.66288123450414, 158.58509426039066, 268.81766070636576, 80.25622852419764, 253.85031114616248, 209.8149323339247, 668.890036736282, 296.62552290666923, 254.8409415023654, 244.82252040688547, 109.76636426647869, 446.3849055604791, 44.06306062730222, 411.9211277085188, 17.299999999999997, 60.20094982414935, 316.19489059675703, 327.52550223111825, 50.779330919291226, 542.6700811483506, 62.31198212528431, 249.80975918939293, 319.37331247368115, 212.8221357741914, 490.53818727476664, 53.000000000000355, 262.5800137441671, 252.84475934603398, 286.78057318079334, 32.50000000000019], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-392.9331798089448, 142.0714028357631, -667.8595622845363, 77.68605268928866, -2.831852359477997, -21.34708814928001, -20.28446557866834, -254.3998696062032, -270.0511514927424, -237.79243315717625, -302.20921077619204, -232.9009236194393, 85.79789913715051, -246.55046830643806, -561.024603163705, -237.97919056005463, -388.4570816717729, -173.686053892008, -718.9224072082114, -177.63114152213143, 287.66497984394556, 31.005670402120227, -797.7438469550011, -738.0260475070893, -831.2343315564065, -789.0031886616539, -926.2761294299785, -923.4187151132238, -751.34674358521, -488.9354772763404, -839.9070652438392, -1150.4855311542217, -890.5642947945425, -731.7446089106136, -512.5808965387911, -1066.5858115641802, -362.2744848989038, -246.9714006484947, -657.5677137399719, -1210.6325168941555, -145.74515125032252, -551.3628079947075, -1007.0812439428712, -811.4792315417295, -1059.3286837217686, -810.7862462450578, -708.7982803736598, -239.10516508218936, -875.6393042973864, -130.4741442523205, -477.9789743417339, -313.80186993045976, -316.9379139173587, -321.335357104323, -578.401766200406, -303.882733115195, -379.70315757984764, -597.6482084071868, 357.1912068365049, -1018.9423367762291, -222.86173349929328, -1155.3317982455849, -153.96812598394308, -1377.1599066802164, -1168.4823746717864, 35.20743924998394, -1084.8500300668873, 38.91584951970631, -166.81958921455026, -77.51741811890027, -571.341945528108, -685.7559414415562, -377.3619773135682, -516.701252177006, -728.2817460408498, -1082.0377920863039, -747.6781777429532, -1110.066291201272, -837.445462548547, -457.7840471813754, -1026.1314894635448, -1238.128954762792, -861.4947297676762, -940.3282542477111, -449.1070707797131, -992.6343909407744, -433.2140827021212, -940.9047026089181, -289.7908964435728, 248.95810659592883, -847.6975793167871, -1225.2160178412869, -1102.059403102999, -1129.5368887200327, -846.0596988465993, -792.7900902666643, -603.6187804000896, -364.3177354961411, -1201.8997331981957, -455.4013124622381, -784.2016067065596, -690.8785717304041, -56.029763830870266, -905.9726083058507, -504.0819986570972, -106.34646603105864, -1131.8549116330764, -695.9539792704338, -1010.0198013035631, -612.0262485532639, -324.5267220505547, -730.9612496326904, -935.2805862261114, -148.44892389817295, -169.80937882994127, -1125.398452393014, -1182.9299579937547, -0.48899194860008666, -995.8335117657991, -1231.155507693005, -397.06303180062895, -121.90458067257316, -363.95874924775615, -528.7005093180359, -1034.209091809126, -817.2202515059887, -683.738747380776, -935.9156917635119, -404.75943260286675, -1211.6610713221594, -1382.406352127582, -913.5003592701047, -407.4821424391196, -551.32166575727, -330.16986535287884, -1198.1923134374074, -902.6589449146717, -697.2141972232781, -279.27949249923523, -1000.9678362931688, -446.6432068931443, -173.6063176133674, -593.5187370072331, -1087.5290663090025, -506.39308498954034, -517.8297905669167, -1199.786421171918, -953.4600918705863, -1016.797838778905, -220.66779735244748, -847.2256654478573, -816.9081702826047, 133.1309788955138, 334.7089103032256, -750.3387618555212, 18.20667937270867, -524.9527890558771, -1096.5084110157964, -671.9663090504929, -941.3551380558968, -997.618831647233, -1116.967724224598, -32.847078546051236, -1167.2343716036742, -1181.9553623351599, -1161.17358753075, -585.3342914330955, -1353.8237654056084, -1172.6361030876806, -1144.3398669167227, -1002.1490220297721, -1093.0248967445755, -510.04772442063745, -172.17889403447342, 281.9124136744257, -1250.178649974291, -1106.159641490521, -1178.4719639689242, -579.3147017677999, -675.6967576319272, -1171.6225447451689, -1113.3232044987867, -1060.4495562471113, -1069.402201383163, -42.4171592910828, -1238.20715481148, -638.9652601765887, -627.317395453179, -314.7040790100525, -1292.268388028655, -24.635128176377798, -1210.072245648344, -263.6345126604208, -1025.5370184054677, -885.4648563294106, -214.07012620034223, -15.822207746973584, -1006.7685753788818, -144.1572952050727, -1274.158670265272], "policy_predator_policy_reward": [657.3986108366034, 10.304370336547207, 874.8453825112366, 33.898688435460755, 402.9728622620519, 98.60156517980992, 226.6917245821155, 455.75437392525447, 572.5076607016533, 268.2446866743092, 608.0393790239406, 140.4392832275626, 365.4918931202727, 300.68852325518156, 523.8943387963201, 564.0512862770191, 133.06554824359176, 823.2969156816166, 1202.21998020858, 21.9966613589915, 28.522649515762087, 28.106700238172344, 1085.4474392996228, 658.5170467825733, 1021.3339634861793, 993.5864107450283, 895.3310118369903, 1041.4015458494919, 905.0020206296696, 523.6161511320986, 1011.6985596190319, 1079.796553994004, 831.3061797077778, 963.1518512732828, 1057.615575596627, 844.0662089226265, 687.215941320968, 251.99419116241768, 1254.884887330226, 788.9702414742333, 430.1616048905188, 623.2330264572373, 817.1936397182741, 1107.3767889604742, 958.0776442833594, 1053.9691167445108, 831.9231649178342, 458.6044661926496, 453.73257994705085, 817.7239778039134, 0.7799131685665955, 1022.3399592103125, 462.7099923595163, 337.2110970610302, 540.7612577316025, 572.8095576084836, 644.718569320336, 738.5804840053077, 2.690106296848361, 1024.9816347410572, 378.83338243769515, 1162.8955905829753, 903.8958679219642, 863.9774126016769, 988.5477022884377, 417.4381674423126, 243.64584654263376, 989.7015066239682, 102.16036948327802, 377.2047430009378, 419.2601952472431, 1032.4240364349885, 32.83592464735306, 1168.6510373574483, 726.5971911236063, 1138.5832748397695, 1026.8892833689572, 992.5329497155195, 879.9627730618075, 715.827511867564, 1069.8752938333153, 1226.0357380979124, 1036.1229191542395, 973.2868338024449, 656.9824478459315, 952.8231771932307, 829.7506861465912, 707.0742190145615, 523.0908964435729, 99.82845831385701, 1037.3367001674794, 1210.1538028875168, 1130.4619158667222, 1145.7368887200323, 969.4762448842735, 930.5587951128833, 541.5519758872339, 716.1682000007504, 1202.8997331981957, 503.19308545710123, 839.5831113036218, 1080.0006929454821, 568.0503104509847, 786.0062292457546, 512.0481944596714, 442.08623666531946, 1145.3568248956453, 780.408308957803, 1094.4672020181977, 651.9003911720242, 1081.7117349044984, 320.1977629749923, 533.8331882059857, 968.0690890012108, 350.2438035032452, 1099.3441066701637, 968.2694214969312, 647.7844043433797, 1301.2385695637854, 1018.510460028725, 369.8697468765884, 368.7216096625755, 205.4465439759638, 910.3378724370016, 781.047578765073, 1106.8883918847264, 841.8009499480532, 926.1684738875302, 1183.5516630827617, 885.7002071701709, 1384.8516503685453, 955.6583292263161, 658.1465870488307, 545.9200444075516, 336.7914084626523, 1291.233769044709, 1205.539417070095, 508.5419510373391, 492.8254295437035, 1123.3170107256751, 4.932495066170105, 999.9799106748461, 1041.4129963765117, 798.219901200118, 363.8333809349885, 929.2071553278345, 1185.0851682972989, 1048.4175732694025, 254.82678539534683, 1236.4891618821678, 710.0313538912676, 1163.9174141731219, 128.48642304030503, 72.56372449723744, 219.36817805297454, 809.3894273365074, 926.4394766952826, 949.8626648787563, 883.9345417825249, 974.2094257307504, 1105.7368109140193, 1118.61610922429, 804.5706049861217, 841.8957507240823, 1387.4533341743165, 999.7386763188895, 1126.5089605004323, 1224.5702240467895, 1172.6361030876806, 1161.6398669167227, 929.0536335339846, 1226.3212350645122, 555.2323698927994, 443.18913915906217, 1187.8062200341526, 107.98551849683028, 1137.3751749429698, 1198.0357614357656, 806.1332886935039, 991.5482518545737, 1079.9948061024709, 1267.262925266768, 1189.4156355863668, 1190.2458812332993, 596.076351622511, 1003.9212749537305, 806.4174127951532, 672.68737860881, 1183.2408389983443, 914.2698153151291, 853.5707839836062, 434.1365898411142, 572.4186698274068, 979.3328749826496, 515.3011781913249, 837.0785636844623, 37.53770074965067, 1271.8336555569986, 176.55729520507086, 1274.258670265272]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6746724861911293, "mean_inference_ms": 3.4575880368035414, "mean_action_processing_ms": 1.3260836151676387, "mean_env_wait_ms": 9.744899568657845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005300998687744141, "StateBufferConnector_ms": 0.010689139366149902, "ViewRequirementAgentConnector_ms": 0.1426922082901001}, "num_episodes": 11, "episode_return_max": 668.890036736282, "episode_return_min": 17.299999999999997, "episode_return_mean": 248.6942752487703, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.94577290588093, "num_env_steps_trained_throughput_per_sec": 81.94577290588093, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 48757.211, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48757.161, "sample_time_ms": 2095.098, "learn_time_ms": 46645.667, "learn_throughput": 85.753, "synch_weights_time_ms": 14.444}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "fed12_00000", "date": "2024-08-21_18-26-38", "timestamp": 1724244998, "time_this_iter_s": 48.8686420917511, "time_total_s": 1323.2335314750671, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4bdd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1323.2335314750671, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 24.215942028985506, "ram_util_percent": 82.3260869565217}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.021695807308117, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.088023446602795, "policy_loss": -0.02229165538120522, "vf_loss": 8.107361823541147, "vf_explained_var": 0.2048399897164138, "kl": 0.014766336241786285, "entropy": 1.147273219136334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.488441136652831, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.00113743802227, "policy_loss": -0.017432816270443182, "vf_loss": 8.016030896908392, "vf_explained_var": 0.3387108538201246, "kl": 0.01269678488822171, "entropy": 0.7730390762210523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 668.890036736282, "episode_reward_min": 17.299999999999997, "episode_reward_mean": 229.81901182650137, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1596.3233771816265, "predator_policy": 0.7799131685665955}, "policy_reward_max": {"prey_policy": 357.1912068365049, "predator_policy": 1527.5537325430962}, "policy_reward_mean": {"prey_policy": -702.3671026696284, "predator_policy": 817.2766085828791}, "custom_metrics": {}, "hist_stats": {"episode_reward": [375.30000000000155, 208.19459162010534, 394.68285401314716, 87.03771314328017, 188.33595090021356, 101.10251721497542, 172.14912727590365, 322.5150764162826, 329.964246935987, 175.65489817033279, 356.28667210272516, 106.00995319414832, 141.93183106104811, 342.62418565463486, 265.3431092012609, 231.3390281066847, 161.6478183988567, 231.28631602448053, 405.94768733860866, 365.9206110981813, 163.53544127579195, 236.74524785948532, 272.71093430894814, 187.41317261941825, 235.02810515076538, 194.586344712568, 307.4237325142271, 54.86092783622064, 161.67776414025013, 300.5607751994489, 31.65058770489012, 207.586768941298, 168.06416331867192, 162.7061198501114, 582.0865649097859, 174.57690589692186, 44.602512763722665, 261.18525088389055, 289.78365999175315, 48.79177299486338, 444.50362581214006, 392.0541675600187, 343.70596643683905, 97.95624294993846, 124.32154333339244, 346.42152619624613, 418.17276708291115, 154.3800789504543, 432.63487589795767, 92.76001013370663, 219.6237440659582, 223.12515784717277, 36.50662733468277, 148.31498469129093, 452.8313663279074, 44.60326819717515, 245.26282325998628, 99.66299871707034, 114.20822596948497, 335.89511147697027, 384.66288123450414, 158.58509426039066, 268.81766070636576, 80.25622852419764, 253.85031114616248, 209.8149323339247, 668.890036736282, 296.62552290666923, 254.8409415023654, 244.82252040688547, 109.76636426647869, 446.3849055604791, 44.06306062730222, 411.9211277085188, 17.299999999999997, 60.20094982414935, 316.19489059675703, 327.52550223111825, 50.779330919291226, 542.6700811483506, 62.31198212528431, 249.80975918939293, 319.37331247368115, 212.8221357741914, 490.53818727476664, 53.000000000000355, 262.5800137441671, 252.84475934603398, 286.78057318079334, 32.50000000000019, 121.7981361476516, 145.136885193188, 211.3366508604586, 190.832864024981, 159.56031648431693, 45.43737208555157, 101.6488287922777, 76.93269766009884, 512.0727980916744, 230.8155145762386], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [287.66497984394556, 31.005670402120227, -797.7438469550011, -738.0260475070893, -831.2343315564065, -789.0031886616539, -926.2761294299785, -923.4187151132238, -751.34674358521, -488.9354772763404, -839.9070652438392, -1150.4855311542217, -890.5642947945425, -731.7446089106136, -512.5808965387911, -1066.5858115641802, -362.2744848989038, -246.9714006484947, -657.5677137399719, -1210.6325168941555, -145.74515125032252, -551.3628079947075, -1007.0812439428712, -811.4792315417295, -1059.3286837217686, -810.7862462450578, -708.7982803736598, -239.10516508218936, -875.6393042973864, -130.4741442523205, -477.9789743417339, -313.80186993045976, -316.9379139173587, -321.335357104323, -578.401766200406, -303.882733115195, -379.70315757984764, -597.6482084071868, 357.1912068365049, -1018.9423367762291, -222.86173349929328, -1155.3317982455849, -153.96812598394308, -1377.1599066802164, -1168.4823746717864, 35.20743924998394, -1084.8500300668873, 38.91584951970631, -166.81958921455026, -77.51741811890027, -571.341945528108, -685.7559414415562, -377.3619773135682, -516.701252177006, -728.2817460408498, -1082.0377920863039, -747.6781777429532, -1110.066291201272, -837.445462548547, -457.7840471813754, -1026.1314894635448, -1238.128954762792, -861.4947297676762, -940.3282542477111, -449.1070707797131, -992.6343909407744, -433.2140827021212, -940.9047026089181, -289.7908964435728, 248.95810659592883, -847.6975793167871, -1225.2160178412869, -1102.059403102999, -1129.5368887200327, -846.0596988465993, -792.7900902666643, -603.6187804000896, -364.3177354961411, -1201.8997331981957, -455.4013124622381, -784.2016067065596, -690.8785717304041, -56.029763830870266, -905.9726083058507, -504.0819986570972, -106.34646603105864, -1131.8549116330764, -695.9539792704338, -1010.0198013035631, -612.0262485532639, -324.5267220505547, -730.9612496326904, -935.2805862261114, -148.44892389817295, -169.80937882994127, -1125.398452393014, -1182.9299579937547, -0.48899194860008666, -995.8335117657991, -1231.155507693005, -397.06303180062895, -121.90458067257316, -363.95874924775615, -528.7005093180359, -1034.209091809126, -817.2202515059887, -683.738747380776, -935.9156917635119, -404.75943260286675, -1211.6610713221594, -1382.406352127582, -913.5003592701047, -407.4821424391196, -551.32166575727, -330.16986535287884, -1198.1923134374074, -902.6589449146717, -697.2141972232781, -279.27949249923523, -1000.9678362931688, -446.6432068931443, -173.6063176133674, -593.5187370072331, -1087.5290663090025, -506.39308498954034, -517.8297905669167, -1199.786421171918, -953.4600918705863, -1016.797838778905, -220.66779735244748, -847.2256654478573, -816.9081702826047, 133.1309788955138, 334.7089103032256, -750.3387618555212, 18.20667937270867, -524.9527890558771, -1096.5084110157964, -671.9663090504929, -941.3551380558968, -997.618831647233, -1116.967724224598, -32.847078546051236, -1167.2343716036742, -1181.9553623351599, -1161.17358753075, -585.3342914330955, -1353.8237654056084, -1172.6361030876806, -1144.3398669167227, -1002.1490220297721, -1093.0248967445755, -510.04772442063745, -172.17889403447342, 281.9124136744257, -1250.178649974291, -1106.159641490521, -1178.4719639689242, -579.3147017677999, -675.6967576319272, -1171.6225447451689, -1113.3232044987867, -1060.4495562471113, -1069.402201383163, -42.4171592910828, -1238.20715481148, -638.9652601765887, -627.317395453179, -314.7040790100525, -1292.268388028655, -24.635128176377798, -1210.072245648344, -263.6345126604208, -1025.5370184054677, -885.4648563294106, -214.07012620034223, -15.822207746973584, -1006.7685753788818, -144.1572952050727, -1274.158670265272, -945.9285242747017, -822.0697041783687, -1250.2474508154105, 36.18034309043458, -1109.1251190086548, -559.1696393785937, -1217.6869352050567, 32.65071149148428, -900.2032691215774, -711.6459160624684, -1339.6308014401252, -826.8534498849482, -1189.1193804065504, -1026.3407315555069, -1103.823667457065, -1560.63582892536, 38.99951005449123, -1596.3233771816265, -533.7163062149932, -845.9624535228153], "policy_predator_policy_reward": [28.522649515762087, 28.106700238172344, 1085.4474392996228, 658.5170467825733, 1021.3339634861793, 993.5864107450283, 895.3310118369903, 1041.4015458494919, 905.0020206296696, 523.6161511320986, 1011.6985596190319, 1079.796553994004, 831.3061797077778, 963.1518512732828, 1057.615575596627, 844.0662089226265, 687.215941320968, 251.99419116241768, 1254.884887330226, 788.9702414742333, 430.1616048905188, 623.2330264572373, 817.1936397182741, 1107.3767889604742, 958.0776442833594, 1053.9691167445108, 831.9231649178342, 458.6044661926496, 453.73257994705085, 817.7239778039134, 0.7799131685665955, 1022.3399592103125, 462.7099923595163, 337.2110970610302, 540.7612577316025, 572.8095576084836, 644.718569320336, 738.5804840053077, 2.690106296848361, 1024.9816347410572, 378.83338243769515, 1162.8955905829753, 903.8958679219642, 863.9774126016769, 988.5477022884377, 417.4381674423126, 243.64584654263376, 989.7015066239682, 102.16036948327802, 377.2047430009378, 419.2601952472431, 1032.4240364349885, 32.83592464735306, 1168.6510373574483, 726.5971911236063, 1138.5832748397695, 1026.8892833689572, 992.5329497155195, 879.9627730618075, 715.827511867564, 1069.8752938333153, 1226.0357380979124, 1036.1229191542395, 973.2868338024449, 656.9824478459315, 952.8231771932307, 829.7506861465912, 707.0742190145615, 523.0908964435729, 99.82845831385701, 1037.3367001674794, 1210.1538028875168, 1130.4619158667222, 1145.7368887200323, 969.4762448842735, 930.5587951128833, 541.5519758872339, 716.1682000007504, 1202.8997331981957, 503.19308545710123, 839.5831113036218, 1080.0006929454821, 568.0503104509847, 786.0062292457546, 512.0481944596714, 442.08623666531946, 1145.3568248956453, 780.408308957803, 1094.4672020181977, 651.9003911720242, 1081.7117349044984, 320.1977629749923, 533.8331882059857, 968.0690890012108, 350.2438035032452, 1099.3441066701637, 968.2694214969312, 647.7844043433797, 1301.2385695637854, 1018.510460028725, 369.8697468765884, 368.7216096625755, 205.4465439759638, 910.3378724370016, 781.047578765073, 1106.8883918847264, 841.8009499480532, 926.1684738875302, 1183.5516630827617, 885.7002071701709, 1384.8516503685453, 955.6583292263161, 658.1465870488307, 545.9200444075516, 336.7914084626523, 1291.233769044709, 1205.539417070095, 508.5419510373391, 492.8254295437035, 1123.3170107256751, 4.932495066170105, 999.9799106748461, 1041.4129963765117, 798.219901200118, 363.8333809349885, 929.2071553278345, 1185.0851682972989, 1048.4175732694025, 254.82678539534683, 1236.4891618821678, 710.0313538912676, 1163.9174141731219, 128.48642304030503, 72.56372449723744, 219.36817805297454, 809.3894273365074, 926.4394766952826, 949.8626648787563, 883.9345417825249, 974.2094257307504, 1105.7368109140193, 1118.61610922429, 804.5706049861217, 841.8957507240823, 1387.4533341743165, 999.7386763188895, 1126.5089605004323, 1224.5702240467895, 1172.6361030876806, 1161.6398669167227, 929.0536335339846, 1226.3212350645122, 555.2323698927994, 443.18913915906217, 1187.8062200341526, 107.98551849683028, 1137.3751749429698, 1198.0357614357656, 806.1332886935039, 991.5482518545737, 1079.9948061024709, 1267.262925266768, 1189.4156355863668, 1190.2458812332993, 596.076351622511, 1003.9212749537305, 806.4174127951532, 672.68737860881, 1183.2408389983443, 914.2698153151291, 853.5707839836062, 434.1365898411142, 572.4186698274068, 979.3328749826496, 515.3011781913249, 837.0785636844623, 37.53770074965067, 1271.8336555569986, 176.55729520507086, 1274.258670265272, 914.0419138225162, 975.7544507782068, 476.57463305155534, 882.6293598666105, 1199.1438288685736, 680.4875803791326, 1203.9467547999084, 171.9223329386447, 1060.8120723375546, 710.5974293308085, 1342.630801440125, 869.2908219704996, 1169.4177868634313, 1147.6911538909044, 1213.8384614994293, 1527.5537325430962, 1273.1444286745368, 796.2522365442692, 676.1832920689312, 934.3109822451191]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.667698053377229, "mean_inference_ms": 3.4389626626077163, "mean_action_processing_ms": 1.3170505519829812, "mean_env_wait_ms": 9.757918364957355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005089163780212402, "StateBufferConnector_ms": 0.010395169258117676, "ViewRequirementAgentConnector_ms": 0.12400341033935547}, "num_episodes": 10, "episode_return_max": 668.890036736282, "episode_return_min": 17.299999999999997, "episode_return_mean": 229.81901182650137, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.6530636626078, "num_env_steps_trained_throughput_per_sec": 82.6530636626078, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 48675.735, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48675.685, "sample_time_ms": 2081.605, "learn_time_ms": 46577.744, "learn_throughput": 85.878, "synch_weights_time_ms": 14.463}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "fed12_00000", "date": "2024-08-21_18-27-26", "timestamp": 1724245046, "time_this_iter_s": 48.40716290473938, "time_total_s": 1371.6406943798065, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f3170d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1371.6406943798065, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 25.473529411764705, "ram_util_percent": 82.68970588235295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.95958828730558, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.728336273677765, "policy_loss": -0.02236699592125006, "vf_loss": 7.7475274091044435, "vf_explained_var": 0.28782987856360337, "kl": 0.015879343513635888, "entropy": 1.1185426122297055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 996.4749999999985}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.799306932391312, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.01290294051801, "policy_loss": -0.015567356533932663, "vf_loss": 8.02610661693351, "vf_explained_var": 0.3181377323216231, "kl": 0.011818381109910589, "entropy": 0.7529738412647651, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 996.4749999999985}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 668.890036736282, "episode_reward_min": 6.700000000000003, "episode_reward_mean": 221.82849705671924, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1596.3233771816265, "predator_policy": 0.7799131685665955}, "policy_reward_max": {"prey_policy": 357.1912068365049, "predator_policy": 1527.5537325430962}, "policy_reward_mean": {"prey_policy": -717.3923066054382, "predator_policy": 828.3065551337979}, "custom_metrics": {}, "hist_stats": {"episode_reward": [141.93183106104811, 342.62418565463486, 265.3431092012609, 231.3390281066847, 161.6478183988567, 231.28631602448053, 405.94768733860866, 365.9206110981813, 163.53544127579195, 236.74524785948532, 272.71093430894814, 187.41317261941825, 235.02810515076538, 194.586344712568, 307.4237325142271, 54.86092783622064, 161.67776414025013, 300.5607751994489, 31.65058770489012, 207.586768941298, 168.06416331867192, 162.7061198501114, 582.0865649097859, 174.57690589692186, 44.602512763722665, 261.18525088389055, 289.78365999175315, 48.79177299486338, 444.50362581214006, 392.0541675600187, 343.70596643683905, 97.95624294993846, 124.32154333339244, 346.42152619624613, 418.17276708291115, 154.3800789504543, 432.63487589795767, 92.76001013370663, 219.6237440659582, 223.12515784717277, 36.50662733468277, 148.31498469129093, 452.8313663279074, 44.60326819717515, 245.26282325998628, 99.66299871707034, 114.20822596948497, 335.89511147697027, 384.66288123450414, 158.58509426039066, 268.81766070636576, 80.25622852419764, 253.85031114616248, 209.8149323339247, 668.890036736282, 296.62552290666923, 254.8409415023654, 244.82252040688547, 109.76636426647869, 446.3849055604791, 44.06306062730222, 411.9211277085188, 17.299999999999997, 60.20094982414935, 316.19489059675703, 327.52550223111825, 50.779330919291226, 542.6700811483506, 62.31198212528431, 249.80975918939293, 319.37331247368115, 212.8221357741914, 490.53818727476664, 53.000000000000355, 262.5800137441671, 252.84475934603398, 286.78057318079334, 32.50000000000019, 121.7981361476516, 145.136885193188, 211.3366508604586, 190.832864024981, 159.56031648431693, 45.43737208555157, 101.6488287922777, 76.93269766009884, 512.0727980916744, 230.8155145762386, 344.98718121052775, 293.9962916199459, 179.57123965867635, 22.977253667810132, 241.15044369857205, 354.5335086472801, 62.300000000000416, 154.20418909423228, 87.37899904690958, 103.68214255781122, 6.700000000000003, 166.7008748071209], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1059.3286837217686, -810.7862462450578, -708.7982803736598, -239.10516508218936, -875.6393042973864, -130.4741442523205, -477.9789743417339, -313.80186993045976, -316.9379139173587, -321.335357104323, -578.401766200406, -303.882733115195, -379.70315757984764, -597.6482084071868, 357.1912068365049, -1018.9423367762291, -222.86173349929328, -1155.3317982455849, -153.96812598394308, -1377.1599066802164, -1168.4823746717864, 35.20743924998394, -1084.8500300668873, 38.91584951970631, -166.81958921455026, -77.51741811890027, -571.341945528108, -685.7559414415562, -377.3619773135682, -516.701252177006, -728.2817460408498, -1082.0377920863039, -747.6781777429532, -1110.066291201272, -837.445462548547, -457.7840471813754, -1026.1314894635448, -1238.128954762792, -861.4947297676762, -940.3282542477111, -449.1070707797131, -992.6343909407744, -433.2140827021212, -940.9047026089181, -289.7908964435728, 248.95810659592883, -847.6975793167871, -1225.2160178412869, -1102.059403102999, -1129.5368887200327, -846.0596988465993, -792.7900902666643, -603.6187804000896, -364.3177354961411, -1201.8997331981957, -455.4013124622381, -784.2016067065596, -690.8785717304041, -56.029763830870266, -905.9726083058507, -504.0819986570972, -106.34646603105864, -1131.8549116330764, -695.9539792704338, -1010.0198013035631, -612.0262485532639, -324.5267220505547, -730.9612496326904, -935.2805862261114, -148.44892389817295, -169.80937882994127, -1125.398452393014, -1182.9299579937547, -0.48899194860008666, -995.8335117657991, -1231.155507693005, -397.06303180062895, -121.90458067257316, -363.95874924775615, -528.7005093180359, -1034.209091809126, -817.2202515059887, -683.738747380776, -935.9156917635119, -404.75943260286675, -1211.6610713221594, -1382.406352127582, -913.5003592701047, -407.4821424391196, -551.32166575727, -330.16986535287884, -1198.1923134374074, -902.6589449146717, -697.2141972232781, -279.27949249923523, -1000.9678362931688, -446.6432068931443, -173.6063176133674, -593.5187370072331, -1087.5290663090025, -506.39308498954034, -517.8297905669167, -1199.786421171918, -953.4600918705863, -1016.797838778905, -220.66779735244748, -847.2256654478573, -816.9081702826047, 133.1309788955138, 334.7089103032256, -750.3387618555212, 18.20667937270867, -524.9527890558771, -1096.5084110157964, -671.9663090504929, -941.3551380558968, -997.618831647233, -1116.967724224598, -32.847078546051236, -1167.2343716036742, -1181.9553623351599, -1161.17358753075, -585.3342914330955, -1353.8237654056084, -1172.6361030876806, -1144.3398669167227, -1002.1490220297721, -1093.0248967445755, -510.04772442063745, -172.17889403447342, 281.9124136744257, -1250.178649974291, -1106.159641490521, -1178.4719639689242, -579.3147017677999, -675.6967576319272, -1171.6225447451689, -1113.3232044987867, -1060.4495562471113, -1069.402201383163, -42.4171592910828, -1238.20715481148, -638.9652601765887, -627.317395453179, -314.7040790100525, -1292.268388028655, -24.635128176377798, -1210.072245648344, -263.6345126604208, -1025.5370184054677, -885.4648563294106, -214.07012620034223, -15.822207746973584, -1006.7685753788818, -144.1572952050727, -1274.158670265272, -945.9285242747017, -822.0697041783687, -1250.2474508154105, 36.18034309043458, -1109.1251190086548, -559.1696393785937, -1217.6869352050567, 32.65071149148428, -900.2032691215774, -711.6459160624684, -1339.6308014401252, -826.8534498849482, -1189.1193804065504, -1026.3407315555069, -1103.823667457065, -1560.63582892536, 38.99951005449123, -1596.3233771816265, -533.7163062149932, -845.9624535228153, -1378.5871101196456, 335.54064024423235, -1010.7678696154, -317.68111493658193, -1114.6031480035326, -1194.2328328309459, -938.6016501111347, -1363.6405057791173, -746.2084585827375, -413.8812361272515, -857.2137407898866, 298.77631308272464, -68.62585497290651, -665.4821207803201, -1383.7465017282084, -419.9391438794263, -731.8543034403814, -977.4514393436334, -1422.4519621991299, 20.959673664598792, -1371.721790120936, -1207.6557887572415, -939.6415175370955, -1248.6259134541874], "policy_predator_policy_reward": [958.0776442833594, 1053.9691167445108, 831.9231649178342, 458.6044661926496, 453.73257994705085, 817.7239778039134, 0.7799131685665955, 1022.3399592103125, 462.7099923595163, 337.2110970610302, 540.7612577316025, 572.8095576084836, 644.718569320336, 738.5804840053077, 2.690106296848361, 1024.9816347410572, 378.83338243769515, 1162.8955905829753, 903.8958679219642, 863.9774126016769, 988.5477022884377, 417.4381674423126, 243.64584654263376, 989.7015066239682, 102.16036948327802, 377.2047430009378, 419.2601952472431, 1032.4240364349885, 32.83592464735306, 1168.6510373574483, 726.5971911236063, 1138.5832748397695, 1026.8892833689572, 992.5329497155195, 879.9627730618075, 715.827511867564, 1069.8752938333153, 1226.0357380979124, 1036.1229191542395, 973.2868338024449, 656.9824478459315, 952.8231771932307, 829.7506861465912, 707.0742190145615, 523.0908964435729, 99.82845831385701, 1037.3367001674794, 1210.1538028875168, 1130.4619158667222, 1145.7368887200323, 969.4762448842735, 930.5587951128833, 541.5519758872339, 716.1682000007504, 1202.8997331981957, 503.19308545710123, 839.5831113036218, 1080.0006929454821, 568.0503104509847, 786.0062292457546, 512.0481944596714, 442.08623666531946, 1145.3568248956453, 780.408308957803, 1094.4672020181977, 651.9003911720242, 1081.7117349044984, 320.1977629749923, 533.8331882059857, 968.0690890012108, 350.2438035032452, 1099.3441066701637, 968.2694214969312, 647.7844043433797, 1301.2385695637854, 1018.510460028725, 369.8697468765884, 368.7216096625755, 205.4465439759638, 910.3378724370016, 781.047578765073, 1106.8883918847264, 841.8009499480532, 926.1684738875302, 1183.5516630827617, 885.7002071701709, 1384.8516503685453, 955.6583292263161, 658.1465870488307, 545.9200444075516, 336.7914084626523, 1291.233769044709, 1205.539417070095, 508.5419510373391, 492.8254295437035, 1123.3170107256751, 4.932495066170105, 999.9799106748461, 1041.4129963765117, 798.219901200118, 363.8333809349885, 929.2071553278345, 1185.0851682972989, 1048.4175732694025, 254.82678539534683, 1236.4891618821678, 710.0313538912676, 1163.9174141731219, 128.48642304030503, 72.56372449723744, 219.36817805297454, 809.3894273365074, 926.4394766952826, 949.8626648787563, 883.9345417825249, 974.2094257307504, 1105.7368109140193, 1118.61610922429, 804.5706049861217, 841.8957507240823, 1387.4533341743165, 999.7386763188895, 1126.5089605004323, 1224.5702240467895, 1172.6361030876806, 1161.6398669167227, 929.0536335339846, 1226.3212350645122, 555.2323698927994, 443.18913915906217, 1187.8062200341526, 107.98551849683028, 1137.3751749429698, 1198.0357614357656, 806.1332886935039, 991.5482518545737, 1079.9948061024709, 1267.262925266768, 1189.4156355863668, 1190.2458812332993, 596.076351622511, 1003.9212749537305, 806.4174127951532, 672.68737860881, 1183.2408389983443, 914.2698153151291, 853.5707839836062, 434.1365898411142, 572.4186698274068, 979.3328749826496, 515.3011781913249, 837.0785636844623, 37.53770074965067, 1271.8336555569986, 176.55729520507086, 1274.258670265272, 914.0419138225162, 975.7544507782068, 476.57463305155534, 882.6293598666105, 1199.1438288685736, 680.4875803791326, 1203.9467547999084, 171.9223329386447, 1060.8120723375546, 710.5974293308085, 1342.630801440125, 869.2908219704996, 1169.4177868634313, 1147.6911538909044, 1213.8384614994293, 1527.5537325430962, 1273.1444286745368, 796.2522365442692, 676.1832920689312, 934.3109822451191, 1378.5871101196456, 9.44654096629541, 479.3361670636524, 1143.109109108275, 1285.977343560526, 1202.4298769326301, 956.578903778945, 1368.6405057791173, 683.9233051153111, 717.3168332932541, 872.11374078989, 40.857195564553756, 112.22585497290486, 684.1821207803243, 1388.628407370493, 569.2614273313746, 764.1866276463512, 1032.498114184576, 107.26418196906096, 1397.910249123283, 1376.721790120936, 1209.3557887572413, 1127.5831904545523, 1227.3851153438518]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6572370965026466, "mean_inference_ms": 3.4245735466816565, "mean_action_processing_ms": 1.3145625248064485, "mean_env_wait_ms": 9.762544205314676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052988529205322266, "StateBufferConnector_ms": 0.010080695152282715, "ViewRequirementAgentConnector_ms": 0.11893999576568604}, "num_episodes": 12, "episode_return_max": 668.890036736282, "episode_return_min": 6.700000000000003, "episode_return_mean": 221.82849705671924, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.41958826598336, "num_env_steps_trained_throughput_per_sec": 82.41958826598336, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 48704.13, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48704.08, "sample_time_ms": 2091.554, "learn_time_ms": 46595.891, "learn_throughput": 85.844, "synch_weights_time_ms": 14.626}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "fed12_00000", "date": "2024-08-21_18-28-15", "timestamp": 1724245095, "time_this_iter_s": 48.585577964782715, "time_total_s": 1420.2262723445892, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4b5e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1420.2262723445892, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 24.891304347826082, "ram_util_percent": 82.59855072463769}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.760300041727287, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.841186616029689, "policy_loss": -0.021134381256899034, "vf_loss": 7.8592136953242875, "vf_explained_var": 0.3243405298581199, "kl": 0.015536480769268656, "entropy": 1.1099730021423764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.599937807819831, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.842615874608358, "policy_loss": -0.016040144015409093, "vf_loss": 7.855847920564116, "vf_explained_var": 0.3559272627981882, "kl": 0.014040515618152404, "entropy": 0.7442194487051988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 668.890036736282, "episode_reward_min": 6.700000000000003, "episode_reward_mean": 217.6172286707457, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1596.3233771816265, "predator_policy": 4.932495066170105}, "policy_reward_max": {"prey_policy": 335.54064024423235, "predator_policy": 1527.5537325430962}, "policy_reward_mean": {"prey_policy": -741.8976466184171, "predator_policy": 850.7062609537902}, "custom_metrics": {}, "hist_stats": {"episode_reward": [236.74524785948532, 272.71093430894814, 187.41317261941825, 235.02810515076538, 194.586344712568, 307.4237325142271, 54.86092783622064, 161.67776414025013, 300.5607751994489, 31.65058770489012, 207.586768941298, 168.06416331867192, 162.7061198501114, 582.0865649097859, 174.57690589692186, 44.602512763722665, 261.18525088389055, 289.78365999175315, 48.79177299486338, 444.50362581214006, 392.0541675600187, 343.70596643683905, 97.95624294993846, 124.32154333339244, 346.42152619624613, 418.17276708291115, 154.3800789504543, 432.63487589795767, 92.76001013370663, 219.6237440659582, 223.12515784717277, 36.50662733468277, 148.31498469129093, 452.8313663279074, 44.60326819717515, 245.26282325998628, 99.66299871707034, 114.20822596948497, 335.89511147697027, 384.66288123450414, 158.58509426039066, 268.81766070636576, 80.25622852419764, 253.85031114616248, 209.8149323339247, 668.890036736282, 296.62552290666923, 254.8409415023654, 244.82252040688547, 109.76636426647869, 446.3849055604791, 44.06306062730222, 411.9211277085188, 17.299999999999997, 60.20094982414935, 316.19489059675703, 327.52550223111825, 50.779330919291226, 542.6700811483506, 62.31198212528431, 249.80975918939293, 319.37331247368115, 212.8221357741914, 490.53818727476664, 53.000000000000355, 262.5800137441671, 252.84475934603398, 286.78057318079334, 32.50000000000019, 121.7981361476516, 145.136885193188, 211.3366508604586, 190.832864024981, 159.56031648431693, 45.43737208555157, 101.6488287922777, 76.93269766009884, 512.0727980916744, 230.8155145762386, 344.98718121052775, 293.9962916199459, 179.57123965867635, 22.977253667810132, 241.15044369857205, 354.5335086472801, 62.300000000000416, 154.20418909423228, 87.37899904690958, 103.68214255781122, 6.700000000000003, 166.7008748071209, 53.05265209807261, 347.800283269513, 250.24977161022122, 296.33263804617775, 433.95390492589036, 16.266736975861505, 229.4494237977554, 238.15991862286214, 23.18386021584314], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-153.96812598394308, -1377.1599066802164, -1168.4823746717864, 35.20743924998394, -1084.8500300668873, 38.91584951970631, -166.81958921455026, -77.51741811890027, -571.341945528108, -685.7559414415562, -377.3619773135682, -516.701252177006, -728.2817460408498, -1082.0377920863039, -747.6781777429532, -1110.066291201272, -837.445462548547, -457.7840471813754, -1026.1314894635448, -1238.128954762792, -861.4947297676762, -940.3282542477111, -449.1070707797131, -992.6343909407744, -433.2140827021212, -940.9047026089181, -289.7908964435728, 248.95810659592883, -847.6975793167871, -1225.2160178412869, -1102.059403102999, -1129.5368887200327, -846.0596988465993, -792.7900902666643, -603.6187804000896, -364.3177354961411, -1201.8997331981957, -455.4013124622381, -784.2016067065596, -690.8785717304041, -56.029763830870266, -905.9726083058507, -504.0819986570972, -106.34646603105864, -1131.8549116330764, -695.9539792704338, -1010.0198013035631, -612.0262485532639, -324.5267220505547, -730.9612496326904, -935.2805862261114, -148.44892389817295, -169.80937882994127, -1125.398452393014, -1182.9299579937547, -0.48899194860008666, -995.8335117657991, -1231.155507693005, -397.06303180062895, -121.90458067257316, -363.95874924775615, -528.7005093180359, -1034.209091809126, -817.2202515059887, -683.738747380776, -935.9156917635119, -404.75943260286675, -1211.6610713221594, -1382.406352127582, -913.5003592701047, -407.4821424391196, -551.32166575727, -330.16986535287884, -1198.1923134374074, -902.6589449146717, -697.2141972232781, -279.27949249923523, -1000.9678362931688, -446.6432068931443, -173.6063176133674, -593.5187370072331, -1087.5290663090025, -506.39308498954034, -517.8297905669167, -1199.786421171918, -953.4600918705863, -1016.797838778905, -220.66779735244748, -847.2256654478573, -816.9081702826047, 133.1309788955138, 334.7089103032256, -750.3387618555212, 18.20667937270867, -524.9527890558771, -1096.5084110157964, -671.9663090504929, -941.3551380558968, -997.618831647233, -1116.967724224598, -32.847078546051236, -1167.2343716036742, -1181.9553623351599, -1161.17358753075, -585.3342914330955, -1353.8237654056084, -1172.6361030876806, -1144.3398669167227, -1002.1490220297721, -1093.0248967445755, -510.04772442063745, -172.17889403447342, 281.9124136744257, -1250.178649974291, -1106.159641490521, -1178.4719639689242, -579.3147017677999, -675.6967576319272, -1171.6225447451689, -1113.3232044987867, -1060.4495562471113, -1069.402201383163, -42.4171592910828, -1238.20715481148, -638.9652601765887, -627.317395453179, -314.7040790100525, -1292.268388028655, -24.635128176377798, -1210.072245648344, -263.6345126604208, -1025.5370184054677, -885.4648563294106, -214.07012620034223, -15.822207746973584, -1006.7685753788818, -144.1572952050727, -1274.158670265272, -945.9285242747017, -822.0697041783687, -1250.2474508154105, 36.18034309043458, -1109.1251190086548, -559.1696393785937, -1217.6869352050567, 32.65071149148428, -900.2032691215774, -711.6459160624684, -1339.6308014401252, -826.8534498849482, -1189.1193804065504, -1026.3407315555069, -1103.823667457065, -1560.63582892536, 38.99951005449123, -1596.3233771816265, -533.7163062149932, -845.9624535228153, -1378.5871101196456, 335.54064024423235, -1010.7678696154, -317.68111493658193, -1114.6031480035326, -1194.2328328309459, -938.6016501111347, -1363.6405057791173, -746.2084585827375, -413.8812361272515, -857.2137407898866, 298.77631308272464, -68.62585497290651, -665.4821207803201, -1383.7465017282084, -419.9391438794263, -731.8543034403814, -977.4514393436334, -1422.4519621991299, 20.959673664598792, -1371.721790120936, -1207.6557887572415, -939.6415175370955, -1248.6259134541874, -1036.8424707605643, -1349.755658733542, -547.8556561385408, -624.2155800987586, -851.7838747825748, -564.4128962108615, -543.2243663568697, -861.5961473273092, -268.2116115868974, -597.0904768030215, -1188.956614192685, -1292.326047817655, -213.22710665763734, -551.5604843872189, -587.107432393183, -898.6454964518647, -659.1981211106227, -1418.8244270394741], "policy_predator_policy_reward": [903.8958679219642, 863.9774126016769, 988.5477022884377, 417.4381674423126, 243.64584654263376, 989.7015066239682, 102.16036948327802, 377.2047430009378, 419.2601952472431, 1032.4240364349885, 32.83592464735306, 1168.6510373574483, 726.5971911236063, 1138.5832748397695, 1026.8892833689572, 992.5329497155195, 879.9627730618075, 715.827511867564, 1069.8752938333153, 1226.0357380979124, 1036.1229191542395, 973.2868338024449, 656.9824478459315, 952.8231771932307, 829.7506861465912, 707.0742190145615, 523.0908964435729, 99.82845831385701, 1037.3367001674794, 1210.1538028875168, 1130.4619158667222, 1145.7368887200323, 969.4762448842735, 930.5587951128833, 541.5519758872339, 716.1682000007504, 1202.8997331981957, 503.19308545710123, 839.5831113036218, 1080.0006929454821, 568.0503104509847, 786.0062292457546, 512.0481944596714, 442.08623666531946, 1145.3568248956453, 780.408308957803, 1094.4672020181977, 651.9003911720242, 1081.7117349044984, 320.1977629749923, 533.8331882059857, 968.0690890012108, 350.2438035032452, 1099.3441066701637, 968.2694214969312, 647.7844043433797, 1301.2385695637854, 1018.510460028725, 369.8697468765884, 368.7216096625755, 205.4465439759638, 910.3378724370016, 781.047578765073, 1106.8883918847264, 841.8009499480532, 926.1684738875302, 1183.5516630827617, 885.7002071701709, 1384.8516503685453, 955.6583292263161, 658.1465870488307, 545.9200444075516, 336.7914084626523, 1291.233769044709, 1205.539417070095, 508.5419510373391, 492.8254295437035, 1123.3170107256751, 4.932495066170105, 999.9799106748461, 1041.4129963765117, 798.219901200118, 363.8333809349885, 929.2071553278345, 1185.0851682972989, 1048.4175732694025, 254.82678539534683, 1236.4891618821678, 710.0313538912676, 1163.9174141731219, 128.48642304030503, 72.56372449723744, 219.36817805297454, 809.3894273365074, 926.4394766952826, 949.8626648787563, 883.9345417825249, 974.2094257307504, 1105.7368109140193, 1118.61610922429, 804.5706049861217, 841.8957507240823, 1387.4533341743165, 999.7386763188895, 1126.5089605004323, 1224.5702240467895, 1172.6361030876806, 1161.6398669167227, 929.0536335339846, 1226.3212350645122, 555.2323698927994, 443.18913915906217, 1187.8062200341526, 107.98551849683028, 1137.3751749429698, 1198.0357614357656, 806.1332886935039, 991.5482518545737, 1079.9948061024709, 1267.262925266768, 1189.4156355863668, 1190.2458812332993, 596.076351622511, 1003.9212749537305, 806.4174127951532, 672.68737860881, 1183.2408389983443, 914.2698153151291, 853.5707839836062, 434.1365898411142, 572.4186698274068, 979.3328749826496, 515.3011781913249, 837.0785636844623, 37.53770074965067, 1271.8336555569986, 176.55729520507086, 1274.258670265272, 914.0419138225162, 975.7544507782068, 476.57463305155534, 882.6293598666105, 1199.1438288685736, 680.4875803791326, 1203.9467547999084, 171.9223329386447, 1060.8120723375546, 710.5974293308085, 1342.630801440125, 869.2908219704996, 1169.4177868634313, 1147.6911538909044, 1213.8384614994293, 1527.5537325430962, 1273.1444286745368, 796.2522365442692, 676.1832920689312, 934.3109822451191, 1378.5871101196456, 9.44654096629541, 479.3361670636524, 1143.109109108275, 1285.977343560526, 1202.4298769326301, 956.578903778945, 1368.6405057791173, 683.9233051153111, 717.3168332932541, 872.11374078989, 40.857195564553756, 112.22585497290486, 684.1821207803243, 1388.628407370493, 569.2614273313746, 764.1866276463512, 1032.498114184576, 107.26418196906096, 1397.910249123283, 1376.721790120936, 1209.3557887572413, 1127.5831904545523, 1227.3851153438518, 1077.8951228586366, 1361.755658733542, 627.2396111938465, 892.6319083129694, 597.8269288691582, 1068.6196137345053, 969.4502186639544, 731.7029330664019, 989.628088365436, 309.627904950374, 1205.694738024149, 1291.854660962053, 130.69180631268173, 863.5452085299304, 861.4343653624393, 862.4784821054704, 682.2819813264697, 1418.9244270394743]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.639786343416103, "mean_inference_ms": 3.41437566535164, "mean_action_processing_ms": 1.3082074919631694, "mean_env_wait_ms": 9.767194854654601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005138397216796875, "StateBufferConnector_ms": 0.01009213924407959, "ViewRequirementAgentConnector_ms": 0.11916124820709229}, "num_episodes": 9, "episode_return_max": 668.890036736282, "episode_return_min": 6.700000000000003, "episode_return_mean": 217.6172286707457, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.4296012880372, "num_env_steps_trained_throughput_per_sec": 82.4296012880372, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 48699.141, "restore_workers_time_ms": 0.016, "training_step_time_ms": 48699.091, "sample_time_ms": 2092.984, "learn_time_ms": 46589.4, "learn_throughput": 85.856, "synch_weights_time_ms": 14.789}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "fed12_00000", "date": "2024-08-21_18-29-03", "timestamp": 1724245143, "time_this_iter_s": 48.587767124176025, "time_total_s": 1468.8140394687653, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f33f5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1468.8140394687653, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 24.750000000000004, "ram_util_percent": 82.48235294117646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.630735010318656, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.9159764368067345, "policy_loss": -0.022230642992589207, "vf_loss": 7.935067829505476, "vf_explained_var": 0.33844489877816863, "kl": 0.015696275542199455, "entropy": 1.0887564589106848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.545980014687492, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.9563462370917915, "policy_loss": -0.014808317039053512, "vf_loss": 7.968618011222315, "vf_explained_var": 0.3529659357020464, "kl": 0.012682765451501364, "entropy": 0.7261603233360109, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 668.890036736282, "episode_reward_min": 4.658450324358563, "episode_reward_mean": 222.1221836001519, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1596.3233771816265, "predator_policy": 4.932495066170105}, "policy_reward_max": {"prey_policy": 335.54064024423235, "predator_policy": 1527.5537325430962}, "policy_reward_mean": {"prey_policy": -779.4268332980515, "predator_policy": 890.4879250981278}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.57690589692186, 44.602512763722665, 261.18525088389055, 289.78365999175315, 48.79177299486338, 444.50362581214006, 392.0541675600187, 343.70596643683905, 97.95624294993846, 124.32154333339244, 346.42152619624613, 418.17276708291115, 154.3800789504543, 432.63487589795767, 92.76001013370663, 219.6237440659582, 223.12515784717277, 36.50662733468277, 148.31498469129093, 452.8313663279074, 44.60326819717515, 245.26282325998628, 99.66299871707034, 114.20822596948497, 335.89511147697027, 384.66288123450414, 158.58509426039066, 268.81766070636576, 80.25622852419764, 253.85031114616248, 209.8149323339247, 668.890036736282, 296.62552290666923, 254.8409415023654, 244.82252040688547, 109.76636426647869, 446.3849055604791, 44.06306062730222, 411.9211277085188, 17.299999999999997, 60.20094982414935, 316.19489059675703, 327.52550223111825, 50.779330919291226, 542.6700811483506, 62.31198212528431, 249.80975918939293, 319.37331247368115, 212.8221357741914, 490.53818727476664, 53.000000000000355, 262.5800137441671, 252.84475934603398, 286.78057318079334, 32.50000000000019, 121.7981361476516, 145.136885193188, 211.3366508604586, 190.832864024981, 159.56031648431693, 45.43737208555157, 101.6488287922777, 76.93269766009884, 512.0727980916744, 230.8155145762386, 344.98718121052775, 293.9962916199459, 179.57123965867635, 22.977253667810132, 241.15044369857205, 354.5335086472801, 62.300000000000416, 154.20418909423228, 87.37899904690958, 103.68214255781122, 6.700000000000003, 166.7008748071209, 53.05265209807261, 347.800283269513, 250.24977161022122, 296.33263804617775, 433.95390492589036, 16.266736975861505, 229.4494237977554, 238.15991862286214, 23.18386021584314, 92.7105629907254, 346.93167861382045, 217.06904753985626, 47.96772952010954, 320.6142807626224, 150.89945574479336, 4.658450324358563, 464.909895449422, 148.61506514266057, 591.5453260817993, 276.6097147788547, 280.01697717118356, 393.77106415273914, 217.27745373376965], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-847.6975793167871, -1225.2160178412869, -1102.059403102999, -1129.5368887200327, -846.0596988465993, -792.7900902666643, -603.6187804000896, -364.3177354961411, -1201.8997331981957, -455.4013124622381, -784.2016067065596, -690.8785717304041, -56.029763830870266, -905.9726083058507, -504.0819986570972, -106.34646603105864, -1131.8549116330764, -695.9539792704338, -1010.0198013035631, -612.0262485532639, -324.5267220505547, -730.9612496326904, -935.2805862261114, -148.44892389817295, -169.80937882994127, -1125.398452393014, -1182.9299579937547, -0.48899194860008666, -995.8335117657991, -1231.155507693005, -397.06303180062895, -121.90458067257316, -363.95874924775615, -528.7005093180359, -1034.209091809126, -817.2202515059887, -683.738747380776, -935.9156917635119, -404.75943260286675, -1211.6610713221594, -1382.406352127582, -913.5003592701047, -407.4821424391196, -551.32166575727, -330.16986535287884, -1198.1923134374074, -902.6589449146717, -697.2141972232781, -279.27949249923523, -1000.9678362931688, -446.6432068931443, -173.6063176133674, -593.5187370072331, -1087.5290663090025, -506.39308498954034, -517.8297905669167, -1199.786421171918, -953.4600918705863, -1016.797838778905, -220.66779735244748, -847.2256654478573, -816.9081702826047, 133.1309788955138, 334.7089103032256, -750.3387618555212, 18.20667937270867, -524.9527890558771, -1096.5084110157964, -671.9663090504929, -941.3551380558968, -997.618831647233, -1116.967724224598, -32.847078546051236, -1167.2343716036742, -1181.9553623351599, -1161.17358753075, -585.3342914330955, -1353.8237654056084, -1172.6361030876806, -1144.3398669167227, -1002.1490220297721, -1093.0248967445755, -510.04772442063745, -172.17889403447342, 281.9124136744257, -1250.178649974291, -1106.159641490521, -1178.4719639689242, -579.3147017677999, -675.6967576319272, -1171.6225447451689, -1113.3232044987867, -1060.4495562471113, -1069.402201383163, -42.4171592910828, -1238.20715481148, -638.9652601765887, -627.317395453179, -314.7040790100525, -1292.268388028655, -24.635128176377798, -1210.072245648344, -263.6345126604208, -1025.5370184054677, -885.4648563294106, -214.07012620034223, -15.822207746973584, -1006.7685753788818, -144.1572952050727, -1274.158670265272, -945.9285242747017, -822.0697041783687, -1250.2474508154105, 36.18034309043458, -1109.1251190086548, -559.1696393785937, -1217.6869352050567, 32.65071149148428, -900.2032691215774, -711.6459160624684, -1339.6308014401252, -826.8534498849482, -1189.1193804065504, -1026.3407315555069, -1103.823667457065, -1560.63582892536, 38.99951005449123, -1596.3233771816265, -533.7163062149932, -845.9624535228153, -1378.5871101196456, 335.54064024423235, -1010.7678696154, -317.68111493658193, -1114.6031480035326, -1194.2328328309459, -938.6016501111347, -1363.6405057791173, -746.2084585827375, -413.8812361272515, -857.2137407898866, 298.77631308272464, -68.62585497290651, -665.4821207803201, -1383.7465017282084, -419.9391438794263, -731.8543034403814, -977.4514393436334, -1422.4519621991299, 20.959673664598792, -1371.721790120936, -1207.6557887572415, -939.6415175370955, -1248.6259134541874, -1036.8424707605643, -1349.755658733542, -547.8556561385408, -624.2155800987586, -851.7838747825748, -564.4128962108615, -543.2243663568697, -861.5961473273092, -268.2116115868974, -597.0904768030215, -1188.956614192685, -1292.326047817655, -213.22710665763734, -551.5604843872189, -587.107432393183, -898.6454964518647, -659.1981211106227, -1418.8244270394741, -956.7707665368721, -1037.5251271600678, -1110.7000211478664, -211.77054113345773, -711.7998590162406, -840.815388907439, -1191.7986872883005, -1392.6546573017415, -9.482825697744108, -1461.8944324552524, -742.3369100468024, -1216.1906965117319, -1146.209605064565, -1194.3312044554361, -631.2879933951397, -1231.579307045328, -603.1290939335661, -1383.4704881641555, -374.6356061842516, -1183.9544032209858, -525.4170842320024, -1360.989358008976, -835.64013048555, -126.91849709058289, -935.1518676565486, -829.2232853135419, -1169.0716369054358, -1082.9931159163157], "policy_predator_policy_reward": [1037.3367001674794, 1210.1538028875168, 1130.4619158667222, 1145.7368887200323, 969.4762448842735, 930.5587951128833, 541.5519758872339, 716.1682000007504, 1202.8997331981957, 503.19308545710123, 839.5831113036218, 1080.0006929454821, 568.0503104509847, 786.0062292457546, 512.0481944596714, 442.08623666531946, 1145.3568248956453, 780.408308957803, 1094.4672020181977, 651.9003911720242, 1081.7117349044984, 320.1977629749923, 533.8331882059857, 968.0690890012108, 350.2438035032452, 1099.3441066701637, 968.2694214969312, 647.7844043433797, 1301.2385695637854, 1018.510460028725, 369.8697468765884, 368.7216096625755, 205.4465439759638, 910.3378724370016, 781.047578765073, 1106.8883918847264, 841.8009499480532, 926.1684738875302, 1183.5516630827617, 885.7002071701709, 1384.8516503685453, 955.6583292263161, 658.1465870488307, 545.9200444075516, 336.7914084626523, 1291.233769044709, 1205.539417070095, 508.5419510373391, 492.8254295437035, 1123.3170107256751, 4.932495066170105, 999.9799106748461, 1041.4129963765117, 798.219901200118, 363.8333809349885, 929.2071553278345, 1185.0851682972989, 1048.4175732694025, 254.82678539534683, 1236.4891618821678, 710.0313538912676, 1163.9174141731219, 128.48642304030503, 72.56372449723744, 219.36817805297454, 809.3894273365074, 926.4394766952826, 949.8626648787563, 883.9345417825249, 974.2094257307504, 1105.7368109140193, 1118.61610922429, 804.5706049861217, 841.8957507240823, 1387.4533341743165, 999.7386763188895, 1126.5089605004323, 1224.5702240467895, 1172.6361030876806, 1161.6398669167227, 929.0536335339846, 1226.3212350645122, 555.2323698927994, 443.18913915906217, 1187.8062200341526, 107.98551849683028, 1137.3751749429698, 1198.0357614357656, 806.1332886935039, 991.5482518545737, 1079.9948061024709, 1267.262925266768, 1189.4156355863668, 1190.2458812332993, 596.076351622511, 1003.9212749537305, 806.4174127951532, 672.68737860881, 1183.2408389983443, 914.2698153151291, 853.5707839836062, 434.1365898411142, 572.4186698274068, 979.3328749826496, 515.3011781913249, 837.0785636844623, 37.53770074965067, 1271.8336555569986, 176.55729520507086, 1274.258670265272, 914.0419138225162, 975.7544507782068, 476.57463305155534, 882.6293598666105, 1199.1438288685736, 680.4875803791326, 1203.9467547999084, 171.9223329386447, 1060.8120723375546, 710.5974293308085, 1342.630801440125, 869.2908219704996, 1169.4177868634313, 1147.6911538909044, 1213.8384614994293, 1527.5537325430962, 1273.1444286745368, 796.2522365442692, 676.1832920689312, 934.3109822451191, 1378.5871101196456, 9.44654096629541, 479.3361670636524, 1143.109109108275, 1285.977343560526, 1202.4298769326301, 956.578903778945, 1368.6405057791173, 683.9233051153111, 717.3168332932541, 872.11374078989, 40.857195564553756, 112.22585497290486, 684.1821207803243, 1388.628407370493, 569.2614273313746, 764.1866276463512, 1032.498114184576, 107.26418196906096, 1397.910249123283, 1376.721790120936, 1209.3557887572413, 1127.5831904545523, 1227.3851153438518, 1077.8951228586366, 1361.755658733542, 627.2396111938465, 892.6319083129694, 597.8269288691582, 1068.6196137345053, 969.4502186639544, 731.7029330664019, 989.628088365436, 309.627904950374, 1205.694738024149, 1291.854660962053, 130.69180631268173, 863.5452085299304, 861.4343653624393, 862.4784821054704, 682.2819813264697, 1418.9244270394743, 816.5235480910754, 1270.4829085965903, 996.430187466374, 672.9720534287709, 697.433933294217, 1072.2503621693197, 1242.7162476965468, 1389.7048264136045, 506.5308297633486, 1285.4607091522735, 893.2363657915955, 1216.1906965117319, 1140.6886769183923, 1204.5105829259637, 1271.9182312042085, 1055.85896468568, 751.744159076227, 1383.4704881641555, 1049.1176291242882, 1101.0177063627452, 1158.8296233992821, 1004.1865336205516, 21.055418901153047, 1221.5201858461614, 986.0399620018961, 1172.1062551209336, 1094.644106715677, 1374.6980998398435]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6279929214061992, "mean_inference_ms": 3.3911016385862034, "mean_action_processing_ms": 1.2857360237136128, "mean_env_wait_ms": 9.755456728797267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00457310676574707, "StateBufferConnector_ms": 0.009669303894042969, "ViewRequirementAgentConnector_ms": 0.10971391201019287}, "num_episodes": 14, "episode_return_max": 668.890036736282, "episode_return_min": 4.658450324358563, "episode_return_mean": 222.1221836001519, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.1238897992355, "num_env_steps_trained_throughput_per_sec": 82.1238897992355, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 48649.055, "restore_workers_time_ms": 0.016, "training_step_time_ms": 48649.004, "sample_time_ms": 2039.856, "learn_time_ms": 46592.51, "learn_throughput": 85.851, "synch_weights_time_ms": 14.669}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "fed12_00000", "date": "2024-08-21_18-29-52", "timestamp": 1724245192, "time_this_iter_s": 48.71764397621155, "time_total_s": 1517.5316834449768, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f3118b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1517.5316834449768, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 24.678260869565218, "ram_util_percent": 82.0449275362319}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.181939665034966, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.635566407915146, "policy_loss": -0.02173642108793415, "vf_loss": 7.653958348117809, "vf_explained_var": 0.40410769660636864, "kl": 0.016722482523915394, "entropy": 1.0784503236964897, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.71460625311685, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.660899475894908, "policy_loss": -0.016174435699062923, "vf_loss": 7.674425321407419, "vf_explained_var": 0.4114622360184079, "kl": 0.01324299797662115, "entropy": 0.709904136796477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 668.890036736282, "episode_reward_min": 4.658450324358563, "episode_reward_mean": 221.98838578577707, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1596.3233771816265, "predator_policy": 4.932495066170105}, "policy_reward_max": {"prey_policy": 335.54064024423235, "predator_policy": 1540.9546697386836}, "policy_reward_mean": {"prey_policy": -778.882179312769, "predator_policy": 889.876372205658}, "custom_metrics": {}, "hist_stats": {"episode_reward": [418.17276708291115, 154.3800789504543, 432.63487589795767, 92.76001013370663, 219.6237440659582, 223.12515784717277, 36.50662733468277, 148.31498469129093, 452.8313663279074, 44.60326819717515, 245.26282325998628, 99.66299871707034, 114.20822596948497, 335.89511147697027, 384.66288123450414, 158.58509426039066, 268.81766070636576, 80.25622852419764, 253.85031114616248, 209.8149323339247, 668.890036736282, 296.62552290666923, 254.8409415023654, 244.82252040688547, 109.76636426647869, 446.3849055604791, 44.06306062730222, 411.9211277085188, 17.299999999999997, 60.20094982414935, 316.19489059675703, 327.52550223111825, 50.779330919291226, 542.6700811483506, 62.31198212528431, 249.80975918939293, 319.37331247368115, 212.8221357741914, 490.53818727476664, 53.000000000000355, 262.5800137441671, 252.84475934603398, 286.78057318079334, 32.50000000000019, 121.7981361476516, 145.136885193188, 211.3366508604586, 190.832864024981, 159.56031648431693, 45.43737208555157, 101.6488287922777, 76.93269766009884, 512.0727980916744, 230.8155145762386, 344.98718121052775, 293.9962916199459, 179.57123965867635, 22.977253667810132, 241.15044369857205, 354.5335086472801, 62.300000000000416, 154.20418909423228, 87.37899904690958, 103.68214255781122, 6.700000000000003, 166.7008748071209, 53.05265209807261, 347.800283269513, 250.24977161022122, 296.33263804617775, 433.95390492589036, 16.266736975861505, 229.4494237977554, 238.15991862286214, 23.18386021584314, 92.7105629907254, 346.93167861382045, 217.06904753985626, 47.96772952010954, 320.6142807626224, 150.89945574479336, 4.658450324358563, 464.909895449422, 148.61506514266057, 591.5453260817993, 276.6097147788547, 280.01697717118356, 393.77106415273914, 217.27745373376965, 237.68418886645895, 71.65764306441969, 152.715006079375, 552.9599501190694, 144.33162512095382, 308.8531371507339, 454.205893491686, 174.93458719446303, 397.7650033756623, 13.413747185023611, 46.00261173438991], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-935.2805862261114, -148.44892389817295, -169.80937882994127, -1125.398452393014, -1182.9299579937547, -0.48899194860008666, -995.8335117657991, -1231.155507693005, -397.06303180062895, -121.90458067257316, -363.95874924775615, -528.7005093180359, -1034.209091809126, -817.2202515059887, -683.738747380776, -935.9156917635119, -404.75943260286675, -1211.6610713221594, -1382.406352127582, -913.5003592701047, -407.4821424391196, -551.32166575727, -330.16986535287884, -1198.1923134374074, -902.6589449146717, -697.2141972232781, -279.27949249923523, -1000.9678362931688, -446.6432068931443, -173.6063176133674, -593.5187370072331, -1087.5290663090025, -506.39308498954034, -517.8297905669167, -1199.786421171918, -953.4600918705863, -1016.797838778905, -220.66779735244748, -847.2256654478573, -816.9081702826047, 133.1309788955138, 334.7089103032256, -750.3387618555212, 18.20667937270867, -524.9527890558771, -1096.5084110157964, -671.9663090504929, -941.3551380558968, -997.618831647233, -1116.967724224598, -32.847078546051236, -1167.2343716036742, -1181.9553623351599, -1161.17358753075, -585.3342914330955, -1353.8237654056084, -1172.6361030876806, -1144.3398669167227, -1002.1490220297721, -1093.0248967445755, -510.04772442063745, -172.17889403447342, 281.9124136744257, -1250.178649974291, -1106.159641490521, -1178.4719639689242, -579.3147017677999, -675.6967576319272, -1171.6225447451689, -1113.3232044987867, -1060.4495562471113, -1069.402201383163, -42.4171592910828, -1238.20715481148, -638.9652601765887, -627.317395453179, -314.7040790100525, -1292.268388028655, -24.635128176377798, -1210.072245648344, -263.6345126604208, -1025.5370184054677, -885.4648563294106, -214.07012620034223, -15.822207746973584, -1006.7685753788818, -144.1572952050727, -1274.158670265272, -945.9285242747017, -822.0697041783687, -1250.2474508154105, 36.18034309043458, -1109.1251190086548, -559.1696393785937, -1217.6869352050567, 32.65071149148428, -900.2032691215774, -711.6459160624684, -1339.6308014401252, -826.8534498849482, -1189.1193804065504, -1026.3407315555069, -1103.823667457065, -1560.63582892536, 38.99951005449123, -1596.3233771816265, -533.7163062149932, -845.9624535228153, -1378.5871101196456, 335.54064024423235, -1010.7678696154, -317.68111493658193, -1114.6031480035326, -1194.2328328309459, -938.6016501111347, -1363.6405057791173, -746.2084585827375, -413.8812361272515, -857.2137407898866, 298.77631308272464, -68.62585497290651, -665.4821207803201, -1383.7465017282084, -419.9391438794263, -731.8543034403814, -977.4514393436334, -1422.4519621991299, 20.959673664598792, -1371.721790120936, -1207.6557887572415, -939.6415175370955, -1248.6259134541874, -1036.8424707605643, -1349.755658733542, -547.8556561385408, -624.2155800987586, -851.7838747825748, -564.4128962108615, -543.2243663568697, -861.5961473273092, -268.2116115868974, -597.0904768030215, -1188.956614192685, -1292.326047817655, -213.22710665763734, -551.5604843872189, -587.107432393183, -898.6454964518647, -659.1981211106227, -1418.8244270394741, -956.7707665368721, -1037.5251271600678, -1110.7000211478664, -211.77054113345773, -711.7998590162406, -840.815388907439, -1191.7986872883005, -1392.6546573017415, -9.482825697744108, -1461.8944324552524, -742.3369100468024, -1216.1906965117319, -1146.209605064565, -1194.3312044554361, -631.2879933951397, -1231.579307045328, -603.1290939335661, -1383.4704881641555, -374.6356061842516, -1183.9544032209858, -525.4170842320024, -1360.989358008976, -835.64013048555, -126.91849709058289, -935.1518676565486, -829.2232853135419, -1169.0716369054358, -1082.9931159163157, -100.30029209104822, -935.0755089266835, -1197.8250003418214, -483.20208508016043, -1130.9882161560986, -202.9161285218359, 36.898029599226795, -1459.4460665543595, -584.3344346350439, -865.6440614128858, -1258.1034916328172, -581.2406256250197, -1261.002723898413, -43.60497119953699, -691.4708585569211, -587.656424698759, -510.13577524484595, -226.13714871515324, -702.8142433990918, -1349.0156931524846, -337.54998031754775, -1540.9546697386836], "policy_predator_policy_reward": [533.8331882059857, 968.0690890012108, 350.2438035032452, 1099.3441066701637, 968.2694214969312, 647.7844043433797, 1301.2385695637854, 1018.510460028725, 369.8697468765884, 368.7216096625755, 205.4465439759638, 910.3378724370016, 781.047578765073, 1106.8883918847264, 841.8009499480532, 926.1684738875302, 1183.5516630827617, 885.7002071701709, 1384.8516503685453, 955.6583292263161, 658.1465870488307, 545.9200444075516, 336.7914084626523, 1291.233769044709, 1205.539417070095, 508.5419510373391, 492.8254295437035, 1123.3170107256751, 4.932495066170105, 999.9799106748461, 1041.4129963765117, 798.219901200118, 363.8333809349885, 929.2071553278345, 1185.0851682972989, 1048.4175732694025, 254.82678539534683, 1236.4891618821678, 710.0313538912676, 1163.9174141731219, 128.48642304030503, 72.56372449723744, 219.36817805297454, 809.3894273365074, 926.4394766952826, 949.8626648787563, 883.9345417825249, 974.2094257307504, 1105.7368109140193, 1118.61610922429, 804.5706049861217, 841.8957507240823, 1387.4533341743165, 999.7386763188895, 1126.5089605004323, 1224.5702240467895, 1172.6361030876806, 1161.6398669167227, 929.0536335339846, 1226.3212350645122, 555.2323698927994, 443.18913915906217, 1187.8062200341526, 107.98551849683028, 1137.3751749429698, 1198.0357614357656, 806.1332886935039, 991.5482518545737, 1079.9948061024709, 1267.262925266768, 1189.4156355863668, 1190.2458812332993, 596.076351622511, 1003.9212749537305, 806.4174127951532, 672.68737860881, 1183.2408389983443, 914.2698153151291, 853.5707839836062, 434.1365898411142, 572.4186698274068, 979.3328749826496, 515.3011781913249, 837.0785636844623, 37.53770074965067, 1271.8336555569986, 176.55729520507086, 1274.258670265272, 914.0419138225162, 975.7544507782068, 476.57463305155534, 882.6293598666105, 1199.1438288685736, 680.4875803791326, 1203.9467547999084, 171.9223329386447, 1060.8120723375546, 710.5974293308085, 1342.630801440125, 869.2908219704996, 1169.4177868634313, 1147.6911538909044, 1213.8384614994293, 1527.5537325430962, 1273.1444286745368, 796.2522365442692, 676.1832920689312, 934.3109822451191, 1378.5871101196456, 9.44654096629541, 479.3361670636524, 1143.109109108275, 1285.977343560526, 1202.4298769326301, 956.578903778945, 1368.6405057791173, 683.9233051153111, 717.3168332932541, 872.11374078989, 40.857195564553756, 112.22585497290486, 684.1821207803243, 1388.628407370493, 569.2614273313746, 764.1866276463512, 1032.498114184576, 107.26418196906096, 1397.910249123283, 1376.721790120936, 1209.3557887572413, 1127.5831904545523, 1227.3851153438518, 1077.8951228586366, 1361.755658733542, 627.2396111938465, 892.6319083129694, 597.8269288691582, 1068.6196137345053, 969.4502186639544, 731.7029330664019, 989.628088365436, 309.627904950374, 1205.694738024149, 1291.854660962053, 130.69180631268173, 863.5452085299304, 861.4343653624393, 862.4784821054704, 682.2819813264697, 1418.9244270394743, 816.5235480910754, 1270.4829085965903, 996.430187466374, 672.9720534287709, 697.433933294217, 1072.2503621693197, 1242.7162476965468, 1389.7048264136045, 506.5308297633486, 1285.4607091522735, 893.2363657915955, 1216.1906965117319, 1140.6886769183923, 1204.5105829259637, 1271.9182312042085, 1055.85896468568, 751.744159076227, 1383.4704881641555, 1049.1176291242882, 1101.0177063627452, 1158.8296233992821, 1004.1865336205516, 21.055418901153047, 1221.5201858461614, 986.0399620018961, 1172.1062551209336, 1094.644106715677, 1374.6980998398435, 436.5532236560276, 836.5067662281615, 1250.7748321525078, 501.9098963338989, 40.09093965318317, 1446.5284111041258, 732.6930960759164, 1242.8148909982842, 829.6278789247983, 764.6822422440928, 1055.0657282485201, 1093.1315261600525, 1237.8094971408966, 521.0040914487395, 677.8887581361352, 776.1731123140088, 181.09629271693868, 952.9416346187232, 715.6142433990947, 1349.6294403375082, 383.5525920519423, 1540.9546697386836]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6185863127380906, "mean_inference_ms": 3.3782484298626763, "mean_action_processing_ms": 1.2693503812804663, "mean_env_wait_ms": 9.750092445761354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004651188850402832, "StateBufferConnector_ms": 0.004108428955078125, "ViewRequirementAgentConnector_ms": 0.11126172542572021}, "num_episodes": 11, "episode_return_max": 668.890036736282, "episode_return_min": 4.658450324358563, "episode_return_mean": 221.98838578577707, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.44925320122275, "num_env_steps_trained_throughput_per_sec": 83.44925320122275, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 48589.137, "restore_workers_time_ms": 0.016, "training_step_time_ms": 48589.085, "sample_time_ms": 2037.518, "learn_time_ms": 46535.196, "learn_throughput": 85.956, "synch_weights_time_ms": 14.374}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "fed12_00000", "date": "2024-08-21_18-30-40", "timestamp": 1724245240, "time_this_iter_s": 47.98151707649231, "time_total_s": 1565.5132005214691, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4ad550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1565.5132005214691, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 24.10882352941176, "ram_util_percent": 81.94411764705885}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.346713737016001, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.714302577669659, "policy_loss": -0.021192852587306073, "vf_loss": 7.732464164653153, "vf_explained_var": 0.4161751306561566, "kl": 0.015156367405135401, "entropy": 1.0772936825083677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.541267498870376, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.737513967039724, "policy_loss": -0.015607969802878206, "vf_loss": 7.750116011453053, "vf_explained_var": 0.39094911318607434, "kl": 0.0150294940435776, "entropy": 0.7159325097603773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 668.890036736282, "episode_reward_min": -2.316814613494996, "episode_reward_mean": 215.84598989362254, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1596.3233771816265, "predator_policy": 4.932495066170105}, "policy_reward_max": {"prey_policy": 335.54064024423235, "predator_policy": 1540.9546697386836}, "policy_reward_mean": {"prey_policy": -802.3671440034843, "predator_policy": 910.2901389502956}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.60326819717515, 245.26282325998628, 99.66299871707034, 114.20822596948497, 335.89511147697027, 384.66288123450414, 158.58509426039066, 268.81766070636576, 80.25622852419764, 253.85031114616248, 209.8149323339247, 668.890036736282, 296.62552290666923, 254.8409415023654, 244.82252040688547, 109.76636426647869, 446.3849055604791, 44.06306062730222, 411.9211277085188, 17.299999999999997, 60.20094982414935, 316.19489059675703, 327.52550223111825, 50.779330919291226, 542.6700811483506, 62.31198212528431, 249.80975918939293, 319.37331247368115, 212.8221357741914, 490.53818727476664, 53.000000000000355, 262.5800137441671, 252.84475934603398, 286.78057318079334, 32.50000000000019, 121.7981361476516, 145.136885193188, 211.3366508604586, 190.832864024981, 159.56031648431693, 45.43737208555157, 101.6488287922777, 76.93269766009884, 512.0727980916744, 230.8155145762386, 344.98718121052775, 293.9962916199459, 179.57123965867635, 22.977253667810132, 241.15044369857205, 354.5335086472801, 62.300000000000416, 154.20418909423228, 87.37899904690958, 103.68214255781122, 6.700000000000003, 166.7008748071209, 53.05265209807261, 347.800283269513, 250.24977161022122, 296.33263804617775, 433.95390492589036, 16.266736975861505, 229.4494237977554, 238.15991862286214, 23.18386021584314, 92.7105629907254, 346.93167861382045, 217.06904753985626, 47.96772952010954, 320.6142807626224, 150.89945574479336, 4.658450324358563, 464.909895449422, 148.61506514266057, 591.5453260817993, 276.6097147788547, 280.01697717118356, 393.77106415273914, 217.27745373376965, 237.68418886645895, 71.65764306441969, 152.715006079375, 552.9599501190694, 144.33162512095382, 308.8531371507339, 454.205893491686, 174.93458719446303, 397.7650033756623, 13.413747185023611, 46.00261173438991, 1.4259867437927856, 143.922475969465, 337.322040592702, 329.6999371708161, 201.63025846285274, 484.872711867643, 55.100000000000485, -2.316814613494996, 12.45342692281461], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1382.406352127582, -913.5003592701047, -407.4821424391196, -551.32166575727, -330.16986535287884, -1198.1923134374074, -902.6589449146717, -697.2141972232781, -279.27949249923523, -1000.9678362931688, -446.6432068931443, -173.6063176133674, -593.5187370072331, -1087.5290663090025, -506.39308498954034, -517.8297905669167, -1199.786421171918, -953.4600918705863, -1016.797838778905, -220.66779735244748, -847.2256654478573, -816.9081702826047, 133.1309788955138, 334.7089103032256, -750.3387618555212, 18.20667937270867, -524.9527890558771, -1096.5084110157964, -671.9663090504929, -941.3551380558968, -997.618831647233, -1116.967724224598, -32.847078546051236, -1167.2343716036742, -1181.9553623351599, -1161.17358753075, -585.3342914330955, -1353.8237654056084, -1172.6361030876806, -1144.3398669167227, -1002.1490220297721, -1093.0248967445755, -510.04772442063745, -172.17889403447342, 281.9124136744257, -1250.178649974291, -1106.159641490521, -1178.4719639689242, -579.3147017677999, -675.6967576319272, -1171.6225447451689, -1113.3232044987867, -1060.4495562471113, -1069.402201383163, -42.4171592910828, -1238.20715481148, -638.9652601765887, -627.317395453179, -314.7040790100525, -1292.268388028655, -24.635128176377798, -1210.072245648344, -263.6345126604208, -1025.5370184054677, -885.4648563294106, -214.07012620034223, -15.822207746973584, -1006.7685753788818, -144.1572952050727, -1274.158670265272, -945.9285242747017, -822.0697041783687, -1250.2474508154105, 36.18034309043458, -1109.1251190086548, -559.1696393785937, -1217.6869352050567, 32.65071149148428, -900.2032691215774, -711.6459160624684, -1339.6308014401252, -826.8534498849482, -1189.1193804065504, -1026.3407315555069, -1103.823667457065, -1560.63582892536, 38.99951005449123, -1596.3233771816265, -533.7163062149932, -845.9624535228153, -1378.5871101196456, 335.54064024423235, -1010.7678696154, -317.68111493658193, -1114.6031480035326, -1194.2328328309459, -938.6016501111347, -1363.6405057791173, -746.2084585827375, -413.8812361272515, -857.2137407898866, 298.77631308272464, -68.62585497290651, -665.4821207803201, -1383.7465017282084, -419.9391438794263, -731.8543034403814, -977.4514393436334, -1422.4519621991299, 20.959673664598792, -1371.721790120936, -1207.6557887572415, -939.6415175370955, -1248.6259134541874, -1036.8424707605643, -1349.755658733542, -547.8556561385408, -624.2155800987586, -851.7838747825748, -564.4128962108615, -543.2243663568697, -861.5961473273092, -268.2116115868974, -597.0904768030215, -1188.956614192685, -1292.326047817655, -213.22710665763734, -551.5604843872189, -587.107432393183, -898.6454964518647, -659.1981211106227, -1418.8244270394741, -956.7707665368721, -1037.5251271600678, -1110.7000211478664, -211.77054113345773, -711.7998590162406, -840.815388907439, -1191.7986872883005, -1392.6546573017415, -9.482825697744108, -1461.8944324552524, -742.3369100468024, -1216.1906965117319, -1146.209605064565, -1194.3312044554361, -631.2879933951397, -1231.579307045328, -603.1290939335661, -1383.4704881641555, -374.6356061842516, -1183.9544032209858, -525.4170842320024, -1360.989358008976, -835.64013048555, -126.91849709058289, -935.1518676565486, -829.2232853135419, -1169.0716369054358, -1082.9931159163157, -100.30029209104822, -935.0755089266835, -1197.8250003418214, -483.20208508016043, -1130.9882161560986, -202.9161285218359, 36.898029599226795, -1459.4460665543595, -584.3344346350439, -865.6440614128858, -1258.1034916328172, -581.2406256250197, -1261.002723898413, -43.60497119953699, -691.4708585569211, -587.656424698759, -510.13577524484595, -226.13714871515324, -702.8142433990918, -1349.0156931524846, -337.54998031754775, -1540.9546697386836, -1454.0556631500945, -1413.1794117655154, -1348.8679096400888, -526.2977074779474, -944.1196885561834, -1198.2930366199414, -218.6585491601147, -982.8891627358004, -674.9345113700855, -689.8696434577558, -352.9335047092639, -1035.1783600978733, 28.01083110743778, -759.5391328232622, -1413.8672939427556, -1344.7039589697472, -1330.529563117413, -1325.5631398284472], "policy_predator_policy_reward": [1384.8516503685453, 955.6583292263161, 658.1465870488307, 545.9200444075516, 336.7914084626523, 1291.233769044709, 1205.539417070095, 508.5419510373391, 492.8254295437035, 1123.3170107256751, 4.932495066170105, 999.9799106748461, 1041.4129963765117, 798.219901200118, 363.8333809349885, 929.2071553278345, 1185.0851682972989, 1048.4175732694025, 254.82678539534683, 1236.4891618821678, 710.0313538912676, 1163.9174141731219, 128.48642304030503, 72.56372449723744, 219.36817805297454, 809.3894273365074, 926.4394766952826, 949.8626648787563, 883.9345417825249, 974.2094257307504, 1105.7368109140193, 1118.61610922429, 804.5706049861217, 841.8957507240823, 1387.4533341743165, 999.7386763188895, 1126.5089605004323, 1224.5702240467895, 1172.6361030876806, 1161.6398669167227, 929.0536335339846, 1226.3212350645122, 555.2323698927994, 443.18913915906217, 1187.8062200341526, 107.98551849683028, 1137.3751749429698, 1198.0357614357656, 806.1332886935039, 991.5482518545737, 1079.9948061024709, 1267.262925266768, 1189.4156355863668, 1190.2458812332993, 596.076351622511, 1003.9212749537305, 806.4174127951532, 672.68737860881, 1183.2408389983443, 914.2698153151291, 853.5707839836062, 434.1365898411142, 572.4186698274068, 979.3328749826496, 515.3011781913249, 837.0785636844623, 37.53770074965067, 1271.8336555569986, 176.55729520507086, 1274.258670265272, 914.0419138225162, 975.7544507782068, 476.57463305155534, 882.6293598666105, 1199.1438288685736, 680.4875803791326, 1203.9467547999084, 171.9223329386447, 1060.8120723375546, 710.5974293308085, 1342.630801440125, 869.2908219704996, 1169.4177868634313, 1147.6911538909044, 1213.8384614994293, 1527.5537325430962, 1273.1444286745368, 796.2522365442692, 676.1832920689312, 934.3109822451191, 1378.5871101196456, 9.44654096629541, 479.3361670636524, 1143.109109108275, 1285.977343560526, 1202.4298769326301, 956.578903778945, 1368.6405057791173, 683.9233051153111, 717.3168332932541, 872.11374078989, 40.857195564553756, 112.22585497290486, 684.1821207803243, 1388.628407370493, 569.2614273313746, 764.1866276463512, 1032.498114184576, 107.26418196906096, 1397.910249123283, 1376.721790120936, 1209.3557887572413, 1127.5831904545523, 1227.3851153438518, 1077.8951228586366, 1361.755658733542, 627.2396111938465, 892.6319083129694, 597.8269288691582, 1068.6196137345053, 969.4502186639544, 731.7029330664019, 989.628088365436, 309.627904950374, 1205.694738024149, 1291.854660962053, 130.69180631268173, 863.5452085299304, 861.4343653624393, 862.4784821054704, 682.2819813264697, 1418.9244270394743, 816.5235480910754, 1270.4829085965903, 996.430187466374, 672.9720534287709, 697.433933294217, 1072.2503621693197, 1242.7162476965468, 1389.7048264136045, 506.5308297633486, 1285.4607091522735, 893.2363657915955, 1216.1906965117319, 1140.6886769183923, 1204.5105829259637, 1271.9182312042085, 1055.85896468568, 751.744159076227, 1383.4704881641555, 1049.1176291242882, 1101.0177063627452, 1158.8296233992821, 1004.1865336205516, 21.055418901153047, 1221.5201858461614, 986.0399620018961, 1172.1062551209336, 1094.644106715677, 1374.6980998398435, 436.5532236560276, 836.5067662281615, 1250.7748321525078, 501.9098963338989, 40.09093965318317, 1446.5284111041258, 732.6930960759164, 1242.8148909982842, 829.6278789247983, 764.6822422440928, 1055.0657282485201, 1093.1315261600525, 1237.8094971408966, 521.0040914487395, 677.8887581361352, 776.1731123140088, 181.09629271693868, 952.9416346187232, 715.6142433990947, 1349.6294403375082, 383.5525920519423, 1540.9546697386836, 1454.051191825557, 1414.6098698338453, 1348.8679096400888, 670.2201834474131, 1192.043386205642, 1287.6913795631815, 691.0078249880419, 840.2398240786896, 819.5002906501098, 746.9341226405883, 1081.9085712308463, 791.076005443932, 11.189168892562327, 775.4391328232654, 1407.2223145851856, 1349.032123713822, 1331.212109838436, 1337.334020030239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6072966961586026, "mean_inference_ms": 3.3790886803035263, "mean_action_processing_ms": 1.2545873638711331, "mean_env_wait_ms": 9.753603248750117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004535794258117676, "StateBufferConnector_ms": 0.004030346870422363, "ViewRequirementAgentConnector_ms": 0.10745787620544434}, "num_episodes": 9, "episode_return_max": 668.890036736282, "episode_return_min": -2.316814613494996, "episode_return_mean": 215.84598989362254, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.38921988283948, "num_env_steps_trained_throughput_per_sec": 82.38921988283948, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 48574.53, "restore_workers_time_ms": 0.016, "training_step_time_ms": 48574.478, "sample_time_ms": 2033.42, "learn_time_ms": 46525.287, "learn_throughput": 85.975, "synch_weights_time_ms": 13.802}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "fed12_00000", "date": "2024-08-21_18-31-29", "timestamp": 1724245289, "time_this_iter_s": 48.562947034835815, "time_total_s": 1614.076147556305, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f33f790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1614.076147556305, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 24.826086956521735, "ram_util_percent": 82.31304347826087}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.001652603616158, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.199153557530156, "policy_loss": -0.02137132125078804, "vf_loss": 7.21723767941591, "vf_explained_var": 0.4551850808045221, "kl": 0.016436007896576215, "entropy": 1.0622958000059481, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 996.9475000000019}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.78398315452394, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.488458317802066, "policy_loss": -0.012994084938887566, "vf_loss": 7.498594584036126, "vf_explained_var": 0.4328237203063158, "kl": 0.01428910835779139, "entropy": 0.7133623085955464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 996.9475000000019}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 668.890036736282, "episode_reward_min": -2.316814613494996, "episode_reward_mean": 214.66960473608094, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1596.3233771816265, "predator_policy": 9.44654096629541}, "policy_reward_max": {"prey_policy": 335.54064024423235, "predator_policy": 1540.9546697386836}, "policy_reward_mean": {"prey_policy": -801.172374606604, "predator_policy": 908.5071769746445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [80.25622852419764, 253.85031114616248, 209.8149323339247, 668.890036736282, 296.62552290666923, 254.8409415023654, 244.82252040688547, 109.76636426647869, 446.3849055604791, 44.06306062730222, 411.9211277085188, 17.299999999999997, 60.20094982414935, 316.19489059675703, 327.52550223111825, 50.779330919291226, 542.6700811483506, 62.31198212528431, 249.80975918939293, 319.37331247368115, 212.8221357741914, 490.53818727476664, 53.000000000000355, 262.5800137441671, 252.84475934603398, 286.78057318079334, 32.50000000000019, 121.7981361476516, 145.136885193188, 211.3366508604586, 190.832864024981, 159.56031648431693, 45.43737208555157, 101.6488287922777, 76.93269766009884, 512.0727980916744, 230.8155145762386, 344.98718121052775, 293.9962916199459, 179.57123965867635, 22.977253667810132, 241.15044369857205, 354.5335086472801, 62.300000000000416, 154.20418909423228, 87.37899904690958, 103.68214255781122, 6.700000000000003, 166.7008748071209, 53.05265209807261, 347.800283269513, 250.24977161022122, 296.33263804617775, 433.95390492589036, 16.266736975861505, 229.4494237977554, 238.15991862286214, 23.18386021584314, 92.7105629907254, 346.93167861382045, 217.06904753985626, 47.96772952010954, 320.6142807626224, 150.89945574479336, 4.658450324358563, 464.909895449422, 148.61506514266057, 591.5453260817993, 276.6097147788547, 280.01697717118356, 393.77106415273914, 217.27745373376965, 237.68418886645895, 71.65764306441969, 152.715006079375, 552.9599501190694, 144.33162512095382, 308.8531371507339, 454.205893491686, 174.93458719446303, 397.7650033756623, 13.413747185023611, 46.00261173438991, 1.4259867437927856, 143.922475969465, 337.322040592702, 329.6999371708161, 201.63025846285274, 484.872711867643, 55.100000000000485, -2.316814613494996, 12.45342692281461, 178.58114451050525, 332.36200092060716, 117.76150873367317, 140.28032177819753, 116.34547495569004, 166.99029603547785, 3.5122076252615475, 478.2265935083731], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1199.786421171918, -953.4600918705863, -1016.797838778905, -220.66779735244748, -847.2256654478573, -816.9081702826047, 133.1309788955138, 334.7089103032256, -750.3387618555212, 18.20667937270867, -524.9527890558771, -1096.5084110157964, -671.9663090504929, -941.3551380558968, -997.618831647233, -1116.967724224598, -32.847078546051236, -1167.2343716036742, -1181.9553623351599, -1161.17358753075, -585.3342914330955, -1353.8237654056084, -1172.6361030876806, -1144.3398669167227, -1002.1490220297721, -1093.0248967445755, -510.04772442063745, -172.17889403447342, 281.9124136744257, -1250.178649974291, -1106.159641490521, -1178.4719639689242, -579.3147017677999, -675.6967576319272, -1171.6225447451689, -1113.3232044987867, -1060.4495562471113, -1069.402201383163, -42.4171592910828, -1238.20715481148, -638.9652601765887, -627.317395453179, -314.7040790100525, -1292.268388028655, -24.635128176377798, -1210.072245648344, -263.6345126604208, -1025.5370184054677, -885.4648563294106, -214.07012620034223, -15.822207746973584, -1006.7685753788818, -144.1572952050727, -1274.158670265272, -945.9285242747017, -822.0697041783687, -1250.2474508154105, 36.18034309043458, -1109.1251190086548, -559.1696393785937, -1217.6869352050567, 32.65071149148428, -900.2032691215774, -711.6459160624684, -1339.6308014401252, -826.8534498849482, -1189.1193804065504, -1026.3407315555069, -1103.823667457065, -1560.63582892536, 38.99951005449123, -1596.3233771816265, -533.7163062149932, -845.9624535228153, -1378.5871101196456, 335.54064024423235, -1010.7678696154, -317.68111493658193, -1114.6031480035326, -1194.2328328309459, -938.6016501111347, -1363.6405057791173, -746.2084585827375, -413.8812361272515, -857.2137407898866, 298.77631308272464, -68.62585497290651, -665.4821207803201, -1383.7465017282084, -419.9391438794263, -731.8543034403814, -977.4514393436334, -1422.4519621991299, 20.959673664598792, -1371.721790120936, -1207.6557887572415, -939.6415175370955, -1248.6259134541874, -1036.8424707605643, -1349.755658733542, -547.8556561385408, -624.2155800987586, -851.7838747825748, -564.4128962108615, -543.2243663568697, -861.5961473273092, -268.2116115868974, -597.0904768030215, -1188.956614192685, -1292.326047817655, -213.22710665763734, -551.5604843872189, -587.107432393183, -898.6454964518647, -659.1981211106227, -1418.8244270394741, -956.7707665368721, -1037.5251271600678, -1110.7000211478664, -211.77054113345773, -711.7998590162406, -840.815388907439, -1191.7986872883005, -1392.6546573017415, -9.482825697744108, -1461.8944324552524, -742.3369100468024, -1216.1906965117319, -1146.209605064565, -1194.3312044554361, -631.2879933951397, -1231.579307045328, -603.1290939335661, -1383.4704881641555, -374.6356061842516, -1183.9544032209858, -525.4170842320024, -1360.989358008976, -835.64013048555, -126.91849709058289, -935.1518676565486, -829.2232853135419, -1169.0716369054358, -1082.9931159163157, -100.30029209104822, -935.0755089266835, -1197.8250003418214, -483.20208508016043, -1130.9882161560986, -202.9161285218359, 36.898029599226795, -1459.4460665543595, -584.3344346350439, -865.6440614128858, -1258.1034916328172, -581.2406256250197, -1261.002723898413, -43.60497119953699, -691.4708585569211, -587.656424698759, -510.13577524484595, -226.13714871515324, -702.8142433990918, -1349.0156931524846, -337.54998031754775, -1540.9546697386836, -1454.0556631500945, -1413.1794117655154, -1348.8679096400888, -526.2977074779474, -944.1196885561834, -1198.2930366199414, -218.6585491601147, -982.8891627358004, -674.9345113700855, -689.8696434577558, -352.9335047092639, -1035.1783600978733, 28.01083110743778, -759.5391328232622, -1413.8672939427556, -1344.7039589697472, -1330.529563117413, -1325.5631398284472, 1.74770535182862, -1333.2910796933977, 54.402224414891535, -871.1005495175158, -568.5502582839383, -1184.5272989589919, -1195.8818022627577, -87.15085723215385, -846.8709015796682, -53.60955997296274, -1157.652154439427, -2.329362365799342, -1085.1230685572466, -1421.269304296249, -1287.1531625154253, 288.5999365909596], "policy_predator_policy_reward": [1185.0851682972989, 1048.4175732694025, 254.82678539534683, 1236.4891618821678, 710.0313538912676, 1163.9174141731219, 128.48642304030503, 72.56372449723744, 219.36817805297454, 809.3894273365074, 926.4394766952826, 949.8626648787563, 883.9345417825249, 974.2094257307504, 1105.7368109140193, 1118.61610922429, 804.5706049861217, 841.8957507240823, 1387.4533341743165, 999.7386763188895, 1126.5089605004323, 1224.5702240467895, 1172.6361030876806, 1161.6398669167227, 929.0536335339846, 1226.3212350645122, 555.2323698927994, 443.18913915906217, 1187.8062200341526, 107.98551849683028, 1137.3751749429698, 1198.0357614357656, 806.1332886935039, 991.5482518545737, 1079.9948061024709, 1267.262925266768, 1189.4156355863668, 1190.2458812332993, 596.076351622511, 1003.9212749537305, 806.4174127951532, 672.68737860881, 1183.2408389983443, 914.2698153151291, 853.5707839836062, 434.1365898411142, 572.4186698274068, 979.3328749826496, 515.3011781913249, 837.0785636844623, 37.53770074965067, 1271.8336555569986, 176.55729520507086, 1274.258670265272, 914.0419138225162, 975.7544507782068, 476.57463305155534, 882.6293598666105, 1199.1438288685736, 680.4875803791326, 1203.9467547999084, 171.9223329386447, 1060.8120723375546, 710.5974293308085, 1342.630801440125, 869.2908219704996, 1169.4177868634313, 1147.6911538909044, 1213.8384614994293, 1527.5537325430962, 1273.1444286745368, 796.2522365442692, 676.1832920689312, 934.3109822451191, 1378.5871101196456, 9.44654096629541, 479.3361670636524, 1143.109109108275, 1285.977343560526, 1202.4298769326301, 956.578903778945, 1368.6405057791173, 683.9233051153111, 717.3168332932541, 872.11374078989, 40.857195564553756, 112.22585497290486, 684.1821207803243, 1388.628407370493, 569.2614273313746, 764.1866276463512, 1032.498114184576, 107.26418196906096, 1397.910249123283, 1376.721790120936, 1209.3557887572413, 1127.5831904545523, 1227.3851153438518, 1077.8951228586366, 1361.755658733542, 627.2396111938465, 892.6319083129694, 597.8269288691582, 1068.6196137345053, 969.4502186639544, 731.7029330664019, 989.628088365436, 309.627904950374, 1205.694738024149, 1291.854660962053, 130.69180631268173, 863.5452085299304, 861.4343653624393, 862.4784821054704, 682.2819813264697, 1418.9244270394743, 816.5235480910754, 1270.4829085965903, 996.430187466374, 672.9720534287709, 697.433933294217, 1072.2503621693197, 1242.7162476965468, 1389.7048264136045, 506.5308297633486, 1285.4607091522735, 893.2363657915955, 1216.1906965117319, 1140.6886769183923, 1204.5105829259637, 1271.9182312042085, 1055.85896468568, 751.744159076227, 1383.4704881641555, 1049.1176291242882, 1101.0177063627452, 1158.8296233992821, 1004.1865336205516, 21.055418901153047, 1221.5201858461614, 986.0399620018961, 1172.1062551209336, 1094.644106715677, 1374.6980998398435, 436.5532236560276, 836.5067662281615, 1250.7748321525078, 501.9098963338989, 40.09093965318317, 1446.5284111041258, 732.6930960759164, 1242.8148909982842, 829.6278789247983, 764.6822422440928, 1055.0657282485201, 1093.1315261600525, 1237.8094971408966, 521.0040914487395, 677.8887581361352, 776.1731123140088, 181.09629271693868, 952.9416346187232, 715.6142433990947, 1349.6294403375082, 383.5525920519423, 1540.9546697386836, 1454.051191825557, 1414.6098698338453, 1348.8679096400888, 670.2201834474131, 1192.043386205642, 1287.6913795631815, 691.0078249880419, 840.2398240786896, 819.5002906501098, 746.9341226405883, 1081.9085712308463, 791.076005443932, 11.189168892562327, 775.4391328232654, 1407.2223145851856, 1349.032123713822, 1331.212109838436, 1337.334020030239, 599.1222138315507, 911.002305020528, 950.8423097285761, 198.21801629465395, 556.7408292595293, 1314.0982367170782, 1176.8275190373763, 246.48546223573302, 928.7626976471691, 88.06323886115271, 1162.7481705818936, 164.22364225881162, 1085.5657153542973, 1424.3388651244597, 208.8501465491767, 1267.9296728836616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5950446981360282, "mean_inference_ms": 3.3694386926756277, "mean_action_processing_ms": 1.245876050778521, "mean_env_wait_ms": 9.754190273577441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004247546195983887, "StateBufferConnector_ms": 0.003860950469970703, "ViewRequirementAgentConnector_ms": 0.1046823263168335}, "num_episodes": 8, "episode_return_max": 668.890036736282, "episode_return_min": -2.316814613494996, "episode_return_mean": 214.66960473608094, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.00396357000415, "num_env_steps_trained_throughput_per_sec": 82.00396357000415, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 48611.802, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48611.75, "sample_time_ms": 2038.145, "learn_time_ms": 46557.306, "learn_throughput": 85.916, "synch_weights_time_ms": 14.105}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "fed12_00000", "date": "2024-08-21_18-32-18", "timestamp": 1724245338, "time_this_iter_s": 48.835246086120605, "time_total_s": 1662.9113936424255, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4b5790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1662.9113936424255, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 25.90434782608696, "ram_util_percent": 82.51884057971014}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.78592706243828, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.4104535231514586, "policy_loss": -0.02268766084225188, "vf_loss": 7.429812428055617, "vf_explained_var": 0.47265144842011586, "kl": 0.0166437932797683, "entropy": 1.0698609354950133, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.954459645319238, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.5398880968648925, "policy_loss": -0.016182375710368867, "vf_loss": 7.553679047185908, "vf_explained_var": 0.4102650354778956, "kl": 0.011957175660356091, "entropy": 0.7291089135187644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 591.5453260817993, "episode_reward_min": -2.316814613494996, "episode_reward_mean": 205.1834484482563, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1596.3233771816265, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 335.54064024423235, "predator_policy": 1540.9546697386836}, "policy_reward_mean": {"prey_policy": -824.1254697039578, "predator_policy": 926.7171939280862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [446.3849055604791, 44.06306062730222, 411.9211277085188, 17.299999999999997, 60.20094982414935, 316.19489059675703, 327.52550223111825, 50.779330919291226, 542.6700811483506, 62.31198212528431, 249.80975918939293, 319.37331247368115, 212.8221357741914, 490.53818727476664, 53.000000000000355, 262.5800137441671, 252.84475934603398, 286.78057318079334, 32.50000000000019, 121.7981361476516, 145.136885193188, 211.3366508604586, 190.832864024981, 159.56031648431693, 45.43737208555157, 101.6488287922777, 76.93269766009884, 512.0727980916744, 230.8155145762386, 344.98718121052775, 293.9962916199459, 179.57123965867635, 22.977253667810132, 241.15044369857205, 354.5335086472801, 62.300000000000416, 154.20418909423228, 87.37899904690958, 103.68214255781122, 6.700000000000003, 166.7008748071209, 53.05265209807261, 347.800283269513, 250.24977161022122, 296.33263804617775, 433.95390492589036, 16.266736975861505, 229.4494237977554, 238.15991862286214, 23.18386021584314, 92.7105629907254, 346.93167861382045, 217.06904753985626, 47.96772952010954, 320.6142807626224, 150.89945574479336, 4.658450324358563, 464.909895449422, 148.61506514266057, 591.5453260817993, 276.6097147788547, 280.01697717118356, 393.77106415273914, 217.27745373376965, 237.68418886645895, 71.65764306441969, 152.715006079375, 552.9599501190694, 144.33162512095382, 308.8531371507339, 454.205893491686, 174.93458719446303, 397.7650033756623, 13.413747185023611, 46.00261173438991, 1.4259867437927856, 143.922475969465, 337.322040592702, 329.6999371708161, 201.63025846285274, 484.872711867643, 55.100000000000485, -2.316814613494996, 12.45342692281461, 178.58114451050525, 332.36200092060716, 117.76150873367317, 140.28032177819753, 116.34547495569004, 166.99029603547785, 3.5122076252615475, 478.2265935083731, 2.0425830160168914, 208.16992849272108, 190.09629755628464, 134.80096141120092, 15.04962989867605, 92.35871243012144, 375.9115000815684, 151.82161615391325], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-32.847078546051236, -1167.2343716036742, -1181.9553623351599, -1161.17358753075, -585.3342914330955, -1353.8237654056084, -1172.6361030876806, -1144.3398669167227, -1002.1490220297721, -1093.0248967445755, -510.04772442063745, -172.17889403447342, 281.9124136744257, -1250.178649974291, -1106.159641490521, -1178.4719639689242, -579.3147017677999, -675.6967576319272, -1171.6225447451689, -1113.3232044987867, -1060.4495562471113, -1069.402201383163, -42.4171592910828, -1238.20715481148, -638.9652601765887, -627.317395453179, -314.7040790100525, -1292.268388028655, -24.635128176377798, -1210.072245648344, -263.6345126604208, -1025.5370184054677, -885.4648563294106, -214.07012620034223, -15.822207746973584, -1006.7685753788818, -144.1572952050727, -1274.158670265272, -945.9285242747017, -822.0697041783687, -1250.2474508154105, 36.18034309043458, -1109.1251190086548, -559.1696393785937, -1217.6869352050567, 32.65071149148428, -900.2032691215774, -711.6459160624684, -1339.6308014401252, -826.8534498849482, -1189.1193804065504, -1026.3407315555069, -1103.823667457065, -1560.63582892536, 38.99951005449123, -1596.3233771816265, -533.7163062149932, -845.9624535228153, -1378.5871101196456, 335.54064024423235, -1010.7678696154, -317.68111493658193, -1114.6031480035326, -1194.2328328309459, -938.6016501111347, -1363.6405057791173, -746.2084585827375, -413.8812361272515, -857.2137407898866, 298.77631308272464, -68.62585497290651, -665.4821207803201, -1383.7465017282084, -419.9391438794263, -731.8543034403814, -977.4514393436334, -1422.4519621991299, 20.959673664598792, -1371.721790120936, -1207.6557887572415, -939.6415175370955, -1248.6259134541874, -1036.8424707605643, -1349.755658733542, -547.8556561385408, -624.2155800987586, -851.7838747825748, -564.4128962108615, -543.2243663568697, -861.5961473273092, -268.2116115868974, -597.0904768030215, -1188.956614192685, -1292.326047817655, -213.22710665763734, -551.5604843872189, -587.107432393183, -898.6454964518647, -659.1981211106227, -1418.8244270394741, -956.7707665368721, -1037.5251271600678, -1110.7000211478664, -211.77054113345773, -711.7998590162406, -840.815388907439, -1191.7986872883005, -1392.6546573017415, -9.482825697744108, -1461.8944324552524, -742.3369100468024, -1216.1906965117319, -1146.209605064565, -1194.3312044554361, -631.2879933951397, -1231.579307045328, -603.1290939335661, -1383.4704881641555, -374.6356061842516, -1183.9544032209858, -525.4170842320024, -1360.989358008976, -835.64013048555, -126.91849709058289, -935.1518676565486, -829.2232853135419, -1169.0716369054358, -1082.9931159163157, -100.30029209104822, -935.0755089266835, -1197.8250003418214, -483.20208508016043, -1130.9882161560986, -202.9161285218359, 36.898029599226795, -1459.4460665543595, -584.3344346350439, -865.6440614128858, -1258.1034916328172, -581.2406256250197, -1261.002723898413, -43.60497119953699, -691.4708585569211, -587.656424698759, -510.13577524484595, -226.13714871515324, -702.8142433990918, -1349.0156931524846, -337.54998031754775, -1540.9546697386836, -1454.0556631500945, -1413.1794117655154, -1348.8679096400888, -526.2977074779474, -944.1196885561834, -1198.2930366199414, -218.6585491601147, -982.8891627358004, -674.9345113700855, -689.8696434577558, -352.9335047092639, -1035.1783600978733, 28.01083110743778, -759.5391328232622, -1413.8672939427556, -1344.7039589697472, -1330.529563117413, -1325.5631398284472, 1.74770535182862, -1333.2910796933977, 54.402224414891535, -871.1005495175158, -568.5502582839383, -1184.5272989589919, -1195.8818022627577, -87.15085723215385, -846.8709015796682, -53.60955997296274, -1157.652154439427, -2.329362365799342, -1085.1230685572466, -1421.269304296249, -1287.1531625154253, 288.5999365909596, -1266.1596142896178, -1313.1879451865868, -1353.3305802944915, -198.29630895521407, -642.9509533228451, -1137.4236741127572, -1163.662087550377, -1022.7775944711121, -1237.0438853937117, -1204.29118121423, -744.376682083079, -790.3447102400833, -1098.9310340563422, 331.9115000815684, -1101.1557312953012, -1317.1059183248867], "policy_predator_policy_reward": [804.5706049861217, 841.8957507240823, 1387.4533341743165, 999.7386763188895, 1126.5089605004323, 1224.5702240467895, 1172.6361030876806, 1161.6398669167227, 929.0536335339846, 1226.3212350645122, 555.2323698927994, 443.18913915906217, 1187.8062200341526, 107.98551849683028, 1137.3751749429698, 1198.0357614357656, 806.1332886935039, 991.5482518545737, 1079.9948061024709, 1267.262925266768, 1189.4156355863668, 1190.2458812332993, 596.076351622511, 1003.9212749537305, 806.4174127951532, 672.68737860881, 1183.2408389983443, 914.2698153151291, 853.5707839836062, 434.1365898411142, 572.4186698274068, 979.3328749826496, 515.3011781913249, 837.0785636844623, 37.53770074965067, 1271.8336555569986, 176.55729520507086, 1274.258670265272, 914.0419138225162, 975.7544507782068, 476.57463305155534, 882.6293598666105, 1199.1438288685736, 680.4875803791326, 1203.9467547999084, 171.9223329386447, 1060.8120723375546, 710.5974293308085, 1342.630801440125, 869.2908219704996, 1169.4177868634313, 1147.6911538909044, 1213.8384614994293, 1527.5537325430962, 1273.1444286745368, 796.2522365442692, 676.1832920689312, 934.3109822451191, 1378.5871101196456, 9.44654096629541, 479.3361670636524, 1143.109109108275, 1285.977343560526, 1202.4298769326301, 956.578903778945, 1368.6405057791173, 683.9233051153111, 717.3168332932541, 872.11374078989, 40.857195564553756, 112.22585497290486, 684.1821207803243, 1388.628407370493, 569.2614273313746, 764.1866276463512, 1032.498114184576, 107.26418196906096, 1397.910249123283, 1376.721790120936, 1209.3557887572413, 1127.5831904545523, 1227.3851153438518, 1077.8951228586366, 1361.755658733542, 627.2396111938465, 892.6319083129694, 597.8269288691582, 1068.6196137345053, 969.4502186639544, 731.7029330664019, 989.628088365436, 309.627904950374, 1205.694738024149, 1291.854660962053, 130.69180631268173, 863.5452085299304, 861.4343653624393, 862.4784821054704, 682.2819813264697, 1418.9244270394743, 816.5235480910754, 1270.4829085965903, 996.430187466374, 672.9720534287709, 697.433933294217, 1072.2503621693197, 1242.7162476965468, 1389.7048264136045, 506.5308297633486, 1285.4607091522735, 893.2363657915955, 1216.1906965117319, 1140.6886769183923, 1204.5105829259637, 1271.9182312042085, 1055.85896468568, 751.744159076227, 1383.4704881641555, 1049.1176291242882, 1101.0177063627452, 1158.8296233992821, 1004.1865336205516, 21.055418901153047, 1221.5201858461614, 986.0399620018961, 1172.1062551209336, 1094.644106715677, 1374.6980998398435, 436.5532236560276, 836.5067662281615, 1250.7748321525078, 501.9098963338989, 40.09093965318317, 1446.5284111041258, 732.6930960759164, 1242.8148909982842, 829.6278789247983, 764.6822422440928, 1055.0657282485201, 1093.1315261600525, 1237.8094971408966, 521.0040914487395, 677.8887581361352, 776.1731123140088, 181.09629271693868, 952.9416346187232, 715.6142433990947, 1349.6294403375082, 383.5525920519423, 1540.9546697386836, 1454.051191825557, 1414.6098698338453, 1348.8679096400888, 670.2201834474131, 1192.043386205642, 1287.6913795631815, 691.0078249880419, 840.2398240786896, 819.5002906501098, 746.9341226405883, 1081.9085712308463, 791.076005443932, 11.189168892562327, 775.4391328232654, 1407.2223145851856, 1349.032123713822, 1331.212109838436, 1337.334020030239, 599.1222138315507, 911.002305020528, 950.8423097285761, 198.21801629465395, 556.7408292595293, 1314.0982367170782, 1176.8275190373763, 246.48546223573302, 928.7626976471691, 88.06323886115271, 1162.7481705818936, 164.22364225881162, 1085.5657153542973, 1424.3388651244597, 208.8501465491767, 1267.9296728836616, 1268.1021973056347, 1313.2879451865867, 1318.3277048050584, 441.4691129373666, 868.3993097114313, 1102.0716152804564, 1154.7662199637884, 1166.4744234688992, 1250.310985902754, 1206.0737106038637, 318.3589689214088, 1308.7211358318777, 1142.931034056342, 0.0, 1342.5135464308544, 1227.5697193432466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5860918005611593, "mean_inference_ms": 3.3542385700781763, "mean_action_processing_ms": 1.237778152040654, "mean_env_wait_ms": 9.75447324165716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004220128059387207, "StateBufferConnector_ms": 0.0047910213470458984, "ViewRequirementAgentConnector_ms": 0.09612739086151123}, "num_episodes": 8, "episode_return_max": 591.5453260817993, "episode_return_min": -2.316814613494996, "episode_return_mean": 205.1834484482563, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.05800168541258, "num_env_steps_trained_throughput_per_sec": 82.05800168541258, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 48625.847, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48625.795, "sample_time_ms": 2052.015, "learn_time_ms": 46557.473, "learn_throughput": 85.915, "synch_weights_time_ms": 14.049}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "fed12_00000", "date": "2024-08-21_18-33-06", "timestamp": 1724245386, "time_this_iter_s": 48.7967050075531, "time_total_s": 1711.7080986499786, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4cadc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1711.7080986499786, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 24.655882352941177, "ram_util_percent": 82.60735294117649}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.499870789177205, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.326716339020502, "policy_loss": -0.022386005010317872, "vf_loss": 7.345743650355667, "vf_explained_var": 0.4856849704154585, "kl": 0.01679343308060967, "entropy": 1.0142170749644124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.456577276994311, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.637350713639032, "policy_loss": -0.01437312338929919, "vf_loss": 7.6491565777511195, "vf_explained_var": 0.4275857822920279, "kl": 0.012836313285869818, "entropy": 0.6805724298512494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 720.3907363095723, "episode_reward_min": -2.316814613494996, "episode_reward_mean": 214.8030798239359, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1596.3233771816265, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 335.54064024423235, "predator_policy": 1540.9546697386836}, "policy_reward_mean": {"prey_policy": -820.8494237984775, "predator_policy": 928.2509637104458}, "custom_metrics": {}, "hist_stats": {"episode_reward": [249.80975918939293, 319.37331247368115, 212.8221357741914, 490.53818727476664, 53.000000000000355, 262.5800137441671, 252.84475934603398, 286.78057318079334, 32.50000000000019, 121.7981361476516, 145.136885193188, 211.3366508604586, 190.832864024981, 159.56031648431693, 45.43737208555157, 101.6488287922777, 76.93269766009884, 512.0727980916744, 230.8155145762386, 344.98718121052775, 293.9962916199459, 179.57123965867635, 22.977253667810132, 241.15044369857205, 354.5335086472801, 62.300000000000416, 154.20418909423228, 87.37899904690958, 103.68214255781122, 6.700000000000003, 166.7008748071209, 53.05265209807261, 347.800283269513, 250.24977161022122, 296.33263804617775, 433.95390492589036, 16.266736975861505, 229.4494237977554, 238.15991862286214, 23.18386021584314, 92.7105629907254, 346.93167861382045, 217.06904753985626, 47.96772952010954, 320.6142807626224, 150.89945574479336, 4.658450324358563, 464.909895449422, 148.61506514266057, 591.5453260817993, 276.6097147788547, 280.01697717118356, 393.77106415273914, 217.27745373376965, 237.68418886645895, 71.65764306441969, 152.715006079375, 552.9599501190694, 144.33162512095382, 308.8531371507339, 454.205893491686, 174.93458719446303, 397.7650033756623, 13.413747185023611, 46.00261173438991, 1.4259867437927856, 143.922475969465, 337.322040592702, 329.6999371708161, 201.63025846285274, 484.872711867643, 55.100000000000485, -2.316814613494996, 12.45342692281461, 178.58114451050525, 332.36200092060716, 117.76150873367317, 140.28032177819753, 116.34547495569004, 166.99029603547785, 3.5122076252615475, 478.2265935083731, 2.0425830160168914, 208.16992849272108, 190.09629755628464, 134.80096141120092, 15.04962989867605, 92.35871243012144, 375.9115000815684, 151.82161615391325, 414.375214785727, 459.34278204615134, 720.3907363095723, 0.06615230507734893, 332.01367557728935, 239.37557044778526, 314.83215512830503, 634.5520615316982, 5.838295393369962, 120.52832478423302], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1060.4495562471113, -1069.402201383163, -42.4171592910828, -1238.20715481148, -638.9652601765887, -627.317395453179, -314.7040790100525, -1292.268388028655, -24.635128176377798, -1210.072245648344, -263.6345126604208, -1025.5370184054677, -885.4648563294106, -214.07012620034223, -15.822207746973584, -1006.7685753788818, -144.1572952050727, -1274.158670265272, -945.9285242747017, -822.0697041783687, -1250.2474508154105, 36.18034309043458, -1109.1251190086548, -559.1696393785937, -1217.6869352050567, 32.65071149148428, -900.2032691215774, -711.6459160624684, -1339.6308014401252, -826.8534498849482, -1189.1193804065504, -1026.3407315555069, -1103.823667457065, -1560.63582892536, 38.99951005449123, -1596.3233771816265, -533.7163062149932, -845.9624535228153, -1378.5871101196456, 335.54064024423235, -1010.7678696154, -317.68111493658193, -1114.6031480035326, -1194.2328328309459, -938.6016501111347, -1363.6405057791173, -746.2084585827375, -413.8812361272515, -857.2137407898866, 298.77631308272464, -68.62585497290651, -665.4821207803201, -1383.7465017282084, -419.9391438794263, -731.8543034403814, -977.4514393436334, -1422.4519621991299, 20.959673664598792, -1371.721790120936, -1207.6557887572415, -939.6415175370955, -1248.6259134541874, -1036.8424707605643, -1349.755658733542, -547.8556561385408, -624.2155800987586, -851.7838747825748, -564.4128962108615, -543.2243663568697, -861.5961473273092, -268.2116115868974, -597.0904768030215, -1188.956614192685, -1292.326047817655, -213.22710665763734, -551.5604843872189, -587.107432393183, -898.6454964518647, -659.1981211106227, -1418.8244270394741, -956.7707665368721, -1037.5251271600678, -1110.7000211478664, -211.77054113345773, -711.7998590162406, -840.815388907439, -1191.7986872883005, -1392.6546573017415, -9.482825697744108, -1461.8944324552524, -742.3369100468024, -1216.1906965117319, -1146.209605064565, -1194.3312044554361, -631.2879933951397, -1231.579307045328, -603.1290939335661, -1383.4704881641555, -374.6356061842516, -1183.9544032209858, -525.4170842320024, -1360.989358008976, -835.64013048555, -126.91849709058289, -935.1518676565486, -829.2232853135419, -1169.0716369054358, -1082.9931159163157, -100.30029209104822, -935.0755089266835, -1197.8250003418214, -483.20208508016043, -1130.9882161560986, -202.9161285218359, 36.898029599226795, -1459.4460665543595, -584.3344346350439, -865.6440614128858, -1258.1034916328172, -581.2406256250197, -1261.002723898413, -43.60497119953699, -691.4708585569211, -587.656424698759, -510.13577524484595, -226.13714871515324, -702.8142433990918, -1349.0156931524846, -337.54998031754775, -1540.9546697386836, -1454.0556631500945, -1413.1794117655154, -1348.8679096400888, -526.2977074779474, -944.1196885561834, -1198.2930366199414, -218.6585491601147, -982.8891627358004, -674.9345113700855, -689.8696434577558, -352.9335047092639, -1035.1783600978733, 28.01083110743778, -759.5391328232622, -1413.8672939427556, -1344.7039589697472, -1330.529563117413, -1325.5631398284472, 1.74770535182862, -1333.2910796933977, 54.402224414891535, -871.1005495175158, -568.5502582839383, -1184.5272989589919, -1195.8818022627577, -87.15085723215385, -846.8709015796682, -53.60955997296274, -1157.652154439427, -2.329362365799342, -1085.1230685572466, -1421.269304296249, -1287.1531625154253, 288.5999365909596, -1266.1596142896178, -1313.1879451865868, -1353.3305802944915, -198.29630895521407, -642.9509533228451, -1137.4236741127572, -1163.662087550377, -1022.7775944711121, -1237.0438853937117, -1204.29118121423, -744.376682083079, -790.3447102400833, -1098.9310340563422, 331.9115000815684, -1101.1557312953012, -1317.1059183248867, -978.1401788387017, -738.6254213340367, 245.42704470834678, -958.8467405726144, -916.8959365759088, -535.0003099468464, -1297.046880376408, -1274.7278177984874, -273.17761411982946, -974.7599046008844, -885.1301764255303, -1326.804974752922, -808.6069927418689, -452.36462036867783, -894.802319364046, -332.6815965528713, -1470.871758869058, -1352.0215025677912, -1510.6850688178738, 21.371936520892923], "policy_predator_policy_reward": [1189.4156355863668, 1190.2458812332993, 596.076351622511, 1003.9212749537305, 806.4174127951532, 672.68737860881, 1183.2408389983443, 914.2698153151291, 853.5707839836062, 434.1365898411142, 572.4186698274068, 979.3328749826496, 515.3011781913249, 837.0785636844623, 37.53770074965067, 1271.8336555569986, 176.55729520507086, 1274.258670265272, 914.0419138225162, 975.7544507782068, 476.57463305155534, 882.6293598666105, 1199.1438288685736, 680.4875803791326, 1203.9467547999084, 171.9223329386447, 1060.8120723375546, 710.5974293308085, 1342.630801440125, 869.2908219704996, 1169.4177868634313, 1147.6911538909044, 1213.8384614994293, 1527.5537325430962, 1273.1444286745368, 796.2522365442692, 676.1832920689312, 934.3109822451191, 1378.5871101196456, 9.44654096629541, 479.3361670636524, 1143.109109108275, 1285.977343560526, 1202.4298769326301, 956.578903778945, 1368.6405057791173, 683.9233051153111, 717.3168332932541, 872.11374078989, 40.857195564553756, 112.22585497290486, 684.1821207803243, 1388.628407370493, 569.2614273313746, 764.1866276463512, 1032.498114184576, 107.26418196906096, 1397.910249123283, 1376.721790120936, 1209.3557887572413, 1127.5831904545523, 1227.3851153438518, 1077.8951228586366, 1361.755658733542, 627.2396111938465, 892.6319083129694, 597.8269288691582, 1068.6196137345053, 969.4502186639544, 731.7029330664019, 989.628088365436, 309.627904950374, 1205.694738024149, 1291.854660962053, 130.69180631268173, 863.5452085299304, 861.4343653624393, 862.4784821054704, 682.2819813264697, 1418.9244270394743, 816.5235480910754, 1270.4829085965903, 996.430187466374, 672.9720534287709, 697.433933294217, 1072.2503621693197, 1242.7162476965468, 1389.7048264136045, 506.5308297633486, 1285.4607091522735, 893.2363657915955, 1216.1906965117319, 1140.6886769183923, 1204.5105829259637, 1271.9182312042085, 1055.85896468568, 751.744159076227, 1383.4704881641555, 1049.1176291242882, 1101.0177063627452, 1158.8296233992821, 1004.1865336205516, 21.055418901153047, 1221.5201858461614, 986.0399620018961, 1172.1062551209336, 1094.644106715677, 1374.6980998398435, 436.5532236560276, 836.5067662281615, 1250.7748321525078, 501.9098963338989, 40.09093965318317, 1446.5284111041258, 732.6930960759164, 1242.8148909982842, 829.6278789247983, 764.6822422440928, 1055.0657282485201, 1093.1315261600525, 1237.8094971408966, 521.0040914487395, 677.8887581361352, 776.1731123140088, 181.09629271693868, 952.9416346187232, 715.6142433990947, 1349.6294403375082, 383.5525920519423, 1540.9546697386836, 1454.051191825557, 1414.6098698338453, 1348.8679096400888, 670.2201834474131, 1192.043386205642, 1287.6913795631815, 691.0078249880419, 840.2398240786896, 819.5002906501098, 746.9341226405883, 1081.9085712308463, 791.076005443932, 11.189168892562327, 775.4391328232654, 1407.2223145851856, 1349.032123713822, 1331.212109838436, 1337.334020030239, 599.1222138315507, 911.002305020528, 950.8423097285761, 198.21801629465395, 556.7408292595293, 1314.0982367170782, 1176.8275190373763, 246.48546223573302, 928.7626976471691, 88.06323886115271, 1162.7481705818936, 164.22364225881162, 1085.5657153542973, 1424.3388651244597, 208.8501465491767, 1267.9296728836616, 1268.1021973056347, 1313.2879451865867, 1318.3277048050584, 441.4691129373666, 868.3993097114313, 1102.0716152804564, 1154.7662199637884, 1166.4744234688992, 1250.310985902754, 1206.0737106038637, 318.3589689214088, 1308.7211358318777, 1142.931034056342, 0.0, 1342.5135464308544, 1227.5697193432466, 894.4142135870139, 1236.726601371451, 899.7566550384236, 273.00582287199563, 1343.4561013382545, 828.8308814940696, 1297.1130326814853, 1274.7278177984874, 566.1582020613916, 1013.7929922366117, 1194.0038806981797, 1257.3068409280588, 879.9109737029198, 695.8927945359316, 601.6380471241465, 1260.3979303244698, 1390.3591840910483, 1438.3723727391712, 1509.9671891978544, 99.87426788336069]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.578261308813235, "mean_inference_ms": 3.337518623156965, "mean_action_processing_ms": 1.2369066073911938, "mean_env_wait_ms": 9.758616796559217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004150509834289551, "StateBufferConnector_ms": 0.00478053092956543, "ViewRequirementAgentConnector_ms": 0.09585070610046387}, "num_episodes": 10, "episode_return_max": 720.3907363095723, "episode_return_min": -2.316814613494996, "episode_return_mean": 214.8030798239359, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.87931152359205, "num_env_steps_trained_throughput_per_sec": 80.87931152359205, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 48643.715, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48643.665, "sample_time_ms": 2080.51, "learn_time_ms": 46546.981, "learn_throughput": 85.935, "synch_weights_time_ms": 14.09}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "fed12_00000", "date": "2024-08-21_18-33-56", "timestamp": 1724245436, "time_this_iter_s": 49.48904085159302, "time_total_s": 1761.1971395015717, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f33fdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1761.1971395015717, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 26.68714285714286, "ram_util_percent": 82.88857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.437427367987457, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.944539307791089, "policy_loss": -0.019594035348386833, "vf_loss": 6.961236976946473, "vf_explained_var": 0.4518427101392595, "kl": 0.014481922194716477, "entropy": 0.9941417541138079, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 970.9600000000065}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.733259722984657, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.552839505230939, "policy_loss": -0.015800130817295106, "vf_loss": 7.566186467175761, "vf_explained_var": 0.42718229612345415, "kl": 0.01226591848886557, "entropy": 0.6874475181418122, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 970.9600000000065}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 720.3907363095723, "episode_reward_min": -2.316814613494996, "episode_reward_mean": 216.41958372626326, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1596.3233771816265, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 345.4624419609055, "predator_policy": 1540.9546697386836}, "policy_reward_mean": {"prey_policy": -818.5987929279876, "predator_policy": 926.8085847911195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [211.3366508604586, 190.832864024981, 159.56031648431693, 45.43737208555157, 101.6488287922777, 76.93269766009884, 512.0727980916744, 230.8155145762386, 344.98718121052775, 293.9962916199459, 179.57123965867635, 22.977253667810132, 241.15044369857205, 354.5335086472801, 62.300000000000416, 154.20418909423228, 87.37899904690958, 103.68214255781122, 6.700000000000003, 166.7008748071209, 53.05265209807261, 347.800283269513, 250.24977161022122, 296.33263804617775, 433.95390492589036, 16.266736975861505, 229.4494237977554, 238.15991862286214, 23.18386021584314, 92.7105629907254, 346.93167861382045, 217.06904753985626, 47.96772952010954, 320.6142807626224, 150.89945574479336, 4.658450324358563, 464.909895449422, 148.61506514266057, 591.5453260817993, 276.6097147788547, 280.01697717118356, 393.77106415273914, 217.27745373376965, 237.68418886645895, 71.65764306441969, 152.715006079375, 552.9599501190694, 144.33162512095382, 308.8531371507339, 454.205893491686, 174.93458719446303, 397.7650033756623, 13.413747185023611, 46.00261173438991, 1.4259867437927856, 143.922475969465, 337.322040592702, 329.6999371708161, 201.63025846285274, 484.872711867643, 55.100000000000485, -2.316814613494996, 12.45342692281461, 178.58114451050525, 332.36200092060716, 117.76150873367317, 140.28032177819753, 116.34547495569004, 166.99029603547785, 3.5122076252615475, 478.2265935083731, 2.0425830160168914, 208.16992849272108, 190.09629755628464, 134.80096141120092, 15.04962989867605, 92.35871243012144, 375.9115000815684, 151.82161615391325, 414.375214785727, 459.34278204615134, 720.3907363095723, 0.06615230507734893, 332.01367557728935, 239.37557044778526, 314.83215512830503, 634.5520615316982, 5.838295393369962, 120.52832478423302, 231.1185507113621, 195.39538733324204, 29.30105918759164, 28.866205020296047, 205.78388769355382, 224.58198718247013, 408.0598949115361, 89.87893315928358, 369.68442789986676, 387.5078071195132, 418.65601233789283], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1109.1251190086548, -559.1696393785937, -1217.6869352050567, 32.65071149148428, -900.2032691215774, -711.6459160624684, -1339.6308014401252, -826.8534498849482, -1189.1193804065504, -1026.3407315555069, -1103.823667457065, -1560.63582892536, 38.99951005449123, -1596.3233771816265, -533.7163062149932, -845.9624535228153, -1378.5871101196456, 335.54064024423235, -1010.7678696154, -317.68111493658193, -1114.6031480035326, -1194.2328328309459, -938.6016501111347, -1363.6405057791173, -746.2084585827375, -413.8812361272515, -857.2137407898866, 298.77631308272464, -68.62585497290651, -665.4821207803201, -1383.7465017282084, -419.9391438794263, -731.8543034403814, -977.4514393436334, -1422.4519621991299, 20.959673664598792, -1371.721790120936, -1207.6557887572415, -939.6415175370955, -1248.6259134541874, -1036.8424707605643, -1349.755658733542, -547.8556561385408, -624.2155800987586, -851.7838747825748, -564.4128962108615, -543.2243663568697, -861.5961473273092, -268.2116115868974, -597.0904768030215, -1188.956614192685, -1292.326047817655, -213.22710665763734, -551.5604843872189, -587.107432393183, -898.6454964518647, -659.1981211106227, -1418.8244270394741, -956.7707665368721, -1037.5251271600678, -1110.7000211478664, -211.77054113345773, -711.7998590162406, -840.815388907439, -1191.7986872883005, -1392.6546573017415, -9.482825697744108, -1461.8944324552524, -742.3369100468024, -1216.1906965117319, -1146.209605064565, -1194.3312044554361, -631.2879933951397, -1231.579307045328, -603.1290939335661, -1383.4704881641555, -374.6356061842516, -1183.9544032209858, -525.4170842320024, -1360.989358008976, -835.64013048555, -126.91849709058289, -935.1518676565486, -829.2232853135419, -1169.0716369054358, -1082.9931159163157, -100.30029209104822, -935.0755089266835, -1197.8250003418214, -483.20208508016043, -1130.9882161560986, -202.9161285218359, 36.898029599226795, -1459.4460665543595, -584.3344346350439, -865.6440614128858, -1258.1034916328172, -581.2406256250197, -1261.002723898413, -43.60497119953699, -691.4708585569211, -587.656424698759, -510.13577524484595, -226.13714871515324, -702.8142433990918, -1349.0156931524846, -337.54998031754775, -1540.9546697386836, -1454.0556631500945, -1413.1794117655154, -1348.8679096400888, -526.2977074779474, -944.1196885561834, -1198.2930366199414, -218.6585491601147, -982.8891627358004, -674.9345113700855, -689.8696434577558, -352.9335047092639, -1035.1783600978733, 28.01083110743778, -759.5391328232622, -1413.8672939427556, -1344.7039589697472, -1330.529563117413, -1325.5631398284472, 1.74770535182862, -1333.2910796933977, 54.402224414891535, -871.1005495175158, -568.5502582839383, -1184.5272989589919, -1195.8818022627577, -87.15085723215385, -846.8709015796682, -53.60955997296274, -1157.652154439427, -2.329362365799342, -1085.1230685572466, -1421.269304296249, -1287.1531625154253, 288.5999365909596, -1266.1596142896178, -1313.1879451865868, -1353.3305802944915, -198.29630895521407, -642.9509533228451, -1137.4236741127572, -1163.662087550377, -1022.7775944711121, -1237.0438853937117, -1204.29118121423, -744.376682083079, -790.3447102400833, -1098.9310340563422, 331.9115000815684, -1101.1557312953012, -1317.1059183248867, -978.1401788387017, -738.6254213340367, 245.42704470834678, -958.8467405726144, -916.8959365759088, -535.0003099468464, -1297.046880376408, -1274.7278177984874, -273.17761411982946, -974.7599046008844, -885.1301764255303, -1326.804974752922, -808.6069927418689, -452.36462036867783, -894.802319364046, -332.6815965528713, -1470.871758869058, -1352.0215025677912, -1510.6850688178738, 21.371936520892923, -552.1716566575006, -899.5625560820528, -143.31860973684277, -954.5576196367368, -1327.2032714415707, -1214.8095940580388, -1253.1895099691826, -1382.720793278798, -688.2619208053837, -504.9368078952946, -759.1583281968844, -424.8890817987594, -616.8911164476086, -84.52154842088947, 34.04373534629382, -1087.8748549978543, -1125.7589712968736, -144.84090198858382, -691.5106262831459, 345.4624419609055, -171.86550491250682, -1231.4538959006518], "policy_predator_policy_reward": [1199.1438288685736, 680.4875803791326, 1203.9467547999084, 171.9223329386447, 1060.8120723375546, 710.5974293308085, 1342.630801440125, 869.2908219704996, 1169.4177868634313, 1147.6911538909044, 1213.8384614994293, 1527.5537325430962, 1273.1444286745368, 796.2522365442692, 676.1832920689312, 934.3109822451191, 1378.5871101196456, 9.44654096629541, 479.3361670636524, 1143.109109108275, 1285.977343560526, 1202.4298769326301, 956.578903778945, 1368.6405057791173, 683.9233051153111, 717.3168332932541, 872.11374078989, 40.857195564553756, 112.22585497290486, 684.1821207803243, 1388.628407370493, 569.2614273313746, 764.1866276463512, 1032.498114184576, 107.26418196906096, 1397.910249123283, 1376.721790120936, 1209.3557887572413, 1127.5831904545523, 1227.3851153438518, 1077.8951228586366, 1361.755658733542, 627.2396111938465, 892.6319083129694, 597.8269288691582, 1068.6196137345053, 969.4502186639544, 731.7029330664019, 989.628088365436, 309.627904950374, 1205.694738024149, 1291.854660962053, 130.69180631268173, 863.5452085299304, 861.4343653624393, 862.4784821054704, 682.2819813264697, 1418.9244270394743, 816.5235480910754, 1270.4829085965903, 996.430187466374, 672.9720534287709, 697.433933294217, 1072.2503621693197, 1242.7162476965468, 1389.7048264136045, 506.5308297633486, 1285.4607091522735, 893.2363657915955, 1216.1906965117319, 1140.6886769183923, 1204.5105829259637, 1271.9182312042085, 1055.85896468568, 751.744159076227, 1383.4704881641555, 1049.1176291242882, 1101.0177063627452, 1158.8296233992821, 1004.1865336205516, 21.055418901153047, 1221.5201858461614, 986.0399620018961, 1172.1062551209336, 1094.644106715677, 1374.6980998398435, 436.5532236560276, 836.5067662281615, 1250.7748321525078, 501.9098963338989, 40.09093965318317, 1446.5284111041258, 732.6930960759164, 1242.8148909982842, 829.6278789247983, 764.6822422440928, 1055.0657282485201, 1093.1315261600525, 1237.8094971408966, 521.0040914487395, 677.8887581361352, 776.1731123140088, 181.09629271693868, 952.9416346187232, 715.6142433990947, 1349.6294403375082, 383.5525920519423, 1540.9546697386836, 1454.051191825557, 1414.6098698338453, 1348.8679096400888, 670.2201834474131, 1192.043386205642, 1287.6913795631815, 691.0078249880419, 840.2398240786896, 819.5002906501098, 746.9341226405883, 1081.9085712308463, 791.076005443932, 11.189168892562327, 775.4391328232654, 1407.2223145851856, 1349.032123713822, 1331.212109838436, 1337.334020030239, 599.1222138315507, 911.002305020528, 950.8423097285761, 198.21801629465395, 556.7408292595293, 1314.0982367170782, 1176.8275190373763, 246.48546223573302, 928.7626976471691, 88.06323886115271, 1162.7481705818936, 164.22364225881162, 1085.5657153542973, 1424.3388651244597, 208.8501465491767, 1267.9296728836616, 1268.1021973056347, 1313.2879451865867, 1318.3277048050584, 441.4691129373666, 868.3993097114313, 1102.0716152804564, 1154.7662199637884, 1166.4744234688992, 1250.310985902754, 1206.0737106038637, 318.3589689214088, 1308.7211358318777, 1142.931034056342, 0.0, 1342.5135464308544, 1227.5697193432466, 894.4142135870139, 1236.726601371451, 899.7566550384236, 273.00582287199563, 1343.4561013382545, 828.8308814940696, 1297.1130326814853, 1274.7278177984874, 566.1582020613916, 1013.7929922366117, 1194.0038806981797, 1257.3068409280588, 879.9109737029198, 695.8927945359316, 601.6380471241465, 1260.3979303244698, 1390.3591840910483, 1438.3723727391712, 1509.9671891978544, 99.87426788336069, 1002.1752531489107, 680.6775103020071, 1015.6425577132802, 277.62905899354115, 1409.2011018099017, 1162.1128228773011, 1209.4927224752807, 1455.2837857929974, 1313.2011261459627, 85.78149024827357, 1058.368400672756, 350.2609965053605, 732.6779731398425, 376.79458664018995, 1099.6263179186105, 44.083734892234865, 1025.8967263101076, 614.3875748752123, 710.5106262831449, 23.04536515860846, 1121.472706909196, 700.5027062418447]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.573026671998075, "mean_inference_ms": 3.333089957559851, "mean_action_processing_ms": 1.22880390561343, "mean_env_wait_ms": 9.762791599124087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004390239715576172, "StateBufferConnector_ms": 0.0049675703048706055, "ViewRequirementAgentConnector_ms": 0.09112036228179932}, "num_episodes": 11, "episode_return_max": 720.3907363095723, "episode_return_min": -2.316814613494996, "episode_return_mean": 216.41958372626326, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.35118480969254, "num_env_steps_trained_throughput_per_sec": 81.35118480969254, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 48679.391, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48679.341, "sample_time_ms": 2116.993, "learn_time_ms": 46546.014, "learn_throughput": 85.936, "synch_weights_time_ms": 14.039}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "fed12_00000", "date": "2024-08-21_18-34-45", "timestamp": 1724245485, "time_this_iter_s": 49.20719814300537, "time_total_s": 1810.404337644577, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4ca940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1810.404337644577, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 27.128571428571426, "ram_util_percent": 82.41714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.0431351570856, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.249619778375777, "policy_loss": -0.02280854076595494, "vf_loss": 7.269146578904813, "vf_explained_var": 0.52073080533396, "kl": 0.016408645977862377, "entropy": 0.9771933179683786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.452017875449368, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.4634351071857274, "policy_loss": -0.012837470758203713, "vf_loss": 7.474154284643748, "vf_explained_var": 0.43303800565855843, "kl": 0.010591515177299105, "entropy": 0.6578652153254817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 720.3907363095723, "episode_reward_min": -2.316814613494996, "episode_reward_mean": 220.33105431894256, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1540.9546697386836, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 345.4624419609055, "predator_policy": 1540.9546697386836}, "policy_reward_mean": {"prey_policy": -789.9772841317541, "predator_policy": 900.1428112912257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [179.57123965867635, 22.977253667810132, 241.15044369857205, 354.5335086472801, 62.300000000000416, 154.20418909423228, 87.37899904690958, 103.68214255781122, 6.700000000000003, 166.7008748071209, 53.05265209807261, 347.800283269513, 250.24977161022122, 296.33263804617775, 433.95390492589036, 16.266736975861505, 229.4494237977554, 238.15991862286214, 23.18386021584314, 92.7105629907254, 346.93167861382045, 217.06904753985626, 47.96772952010954, 320.6142807626224, 150.89945574479336, 4.658450324358563, 464.909895449422, 148.61506514266057, 591.5453260817993, 276.6097147788547, 280.01697717118356, 393.77106415273914, 217.27745373376965, 237.68418886645895, 71.65764306441969, 152.715006079375, 552.9599501190694, 144.33162512095382, 308.8531371507339, 454.205893491686, 174.93458719446303, 397.7650033756623, 13.413747185023611, 46.00261173438991, 1.4259867437927856, 143.922475969465, 337.322040592702, 329.6999371708161, 201.63025846285274, 484.872711867643, 55.100000000000485, -2.316814613494996, 12.45342692281461, 178.58114451050525, 332.36200092060716, 117.76150873367317, 140.28032177819753, 116.34547495569004, 166.99029603547785, 3.5122076252615475, 478.2265935083731, 2.0425830160168914, 208.16992849272108, 190.09629755628464, 134.80096141120092, 15.04962989867605, 92.35871243012144, 375.9115000815684, 151.82161615391325, 414.375214785727, 459.34278204615134, 720.3907363095723, 0.06615230507734893, 332.01367557728935, 239.37557044778526, 314.83215512830503, 634.5520615316982, 5.838295393369962, 120.52832478423302, 231.1185507113621, 195.39538733324204, 29.30105918759164, 28.866205020296047, 205.78388769355382, 224.58198718247013, 408.0598949115361, 89.87893315928358, 369.68442789986676, 387.5078071195132, 418.65601233789283, 190.15275598040995, 255.95227510360425, 386.4000000000018, 560.4375106051199, 284.90210909568134, 274.5610617744131, 38.20000000000027, 11.06934464418177, 358.5537192462882, 198.53879822430048], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1114.6031480035326, -1194.2328328309459, -938.6016501111347, -1363.6405057791173, -746.2084585827375, -413.8812361272515, -857.2137407898866, 298.77631308272464, -68.62585497290651, -665.4821207803201, -1383.7465017282084, -419.9391438794263, -731.8543034403814, -977.4514393436334, -1422.4519621991299, 20.959673664598792, -1371.721790120936, -1207.6557887572415, -939.6415175370955, -1248.6259134541874, -1036.8424707605643, -1349.755658733542, -547.8556561385408, -624.2155800987586, -851.7838747825748, -564.4128962108615, -543.2243663568697, -861.5961473273092, -268.2116115868974, -597.0904768030215, -1188.956614192685, -1292.326047817655, -213.22710665763734, -551.5604843872189, -587.107432393183, -898.6454964518647, -659.1981211106227, -1418.8244270394741, -956.7707665368721, -1037.5251271600678, -1110.7000211478664, -211.77054113345773, -711.7998590162406, -840.815388907439, -1191.7986872883005, -1392.6546573017415, -9.482825697744108, -1461.8944324552524, -742.3369100468024, -1216.1906965117319, -1146.209605064565, -1194.3312044554361, -631.2879933951397, -1231.579307045328, -603.1290939335661, -1383.4704881641555, -374.6356061842516, -1183.9544032209858, -525.4170842320024, -1360.989358008976, -835.64013048555, -126.91849709058289, -935.1518676565486, -829.2232853135419, -1169.0716369054358, -1082.9931159163157, -100.30029209104822, -935.0755089266835, -1197.8250003418214, -483.20208508016043, -1130.9882161560986, -202.9161285218359, 36.898029599226795, -1459.4460665543595, -584.3344346350439, -865.6440614128858, -1258.1034916328172, -581.2406256250197, -1261.002723898413, -43.60497119953699, -691.4708585569211, -587.656424698759, -510.13577524484595, -226.13714871515324, -702.8142433990918, -1349.0156931524846, -337.54998031754775, -1540.9546697386836, -1454.0556631500945, -1413.1794117655154, -1348.8679096400888, -526.2977074779474, -944.1196885561834, -1198.2930366199414, -218.6585491601147, -982.8891627358004, -674.9345113700855, -689.8696434577558, -352.9335047092639, -1035.1783600978733, 28.01083110743778, -759.5391328232622, -1413.8672939427556, -1344.7039589697472, -1330.529563117413, -1325.5631398284472, 1.74770535182862, -1333.2910796933977, 54.402224414891535, -871.1005495175158, -568.5502582839383, -1184.5272989589919, -1195.8818022627577, -87.15085723215385, -846.8709015796682, -53.60955997296274, -1157.652154439427, -2.329362365799342, -1085.1230685572466, -1421.269304296249, -1287.1531625154253, 288.5999365909596, -1266.1596142896178, -1313.1879451865868, -1353.3305802944915, -198.29630895521407, -642.9509533228451, -1137.4236741127572, -1163.662087550377, -1022.7775944711121, -1237.0438853937117, -1204.29118121423, -744.376682083079, -790.3447102400833, -1098.9310340563422, 331.9115000815684, -1101.1557312953012, -1317.1059183248867, -978.1401788387017, -738.6254213340367, 245.42704470834678, -958.8467405726144, -916.8959365759088, -535.0003099468464, -1297.046880376408, -1274.7278177984874, -273.17761411982946, -974.7599046008844, -885.1301764255303, -1326.804974752922, -808.6069927418689, -452.36462036867783, -894.802319364046, -332.6815965528713, -1470.871758869058, -1352.0215025677912, -1510.6850688178738, 21.371936520892923, -552.1716566575006, -899.5625560820528, -143.31860973684277, -954.5576196367368, -1327.2032714415707, -1214.8095940580388, -1253.1895099691826, -1382.720793278798, -688.2619208053837, -504.9368078952946, -759.1583281968844, -424.8890817987594, -616.8911164476086, -84.52154842088947, 34.04373534629382, -1087.8748549978543, -1125.7589712968736, -144.84090198858382, -691.5106262831459, 345.4624419609055, -171.86550491250682, -1231.4538959006518, -1383.966065269417, -848.7090996249308, -1288.565134989197, -165.4135304474502, 286.34521934510417, 28.506557200974505, 319.508087368387, -1093.2489778250715, -653.3519154909844, -200.23745511475497, -43.8177969185022, -326.83522523292976, -5.1224226671805315, -1520.977360387765, -1067.22017158199, -941.4171456444274, -1030.0612868589396, 13.131466140268357, -364.43204776061765, -809.8960432406478], "policy_predator_policy_reward": [1285.977343560526, 1202.4298769326301, 956.578903778945, 1368.6405057791173, 683.9233051153111, 717.3168332932541, 872.11374078989, 40.857195564553756, 112.22585497290486, 684.1821207803243, 1388.628407370493, 569.2614273313746, 764.1866276463512, 1032.498114184576, 107.26418196906096, 1397.910249123283, 1376.721790120936, 1209.3557887572413, 1127.5831904545523, 1227.3851153438518, 1077.8951228586366, 1361.755658733542, 627.2396111938465, 892.6319083129694, 597.8269288691582, 1068.6196137345053, 969.4502186639544, 731.7029330664019, 989.628088365436, 309.627904950374, 1205.694738024149, 1291.854660962053, 130.69180631268173, 863.5452085299304, 861.4343653624393, 862.4784821054704, 682.2819813264697, 1418.9244270394743, 816.5235480910754, 1270.4829085965903, 996.430187466374, 672.9720534287709, 697.433933294217, 1072.2503621693197, 1242.7162476965468, 1389.7048264136045, 506.5308297633486, 1285.4607091522735, 893.2363657915955, 1216.1906965117319, 1140.6886769183923, 1204.5105829259637, 1271.9182312042085, 1055.85896468568, 751.744159076227, 1383.4704881641555, 1049.1176291242882, 1101.0177063627452, 1158.8296233992821, 1004.1865336205516, 21.055418901153047, 1221.5201858461614, 986.0399620018961, 1172.1062551209336, 1094.644106715677, 1374.6980998398435, 436.5532236560276, 836.5067662281615, 1250.7748321525078, 501.9098963338989, 40.09093965318317, 1446.5284111041258, 732.6930960759164, 1242.8148909982842, 829.6278789247983, 764.6822422440928, 1055.0657282485201, 1093.1315261600525, 1237.8094971408966, 521.0040914487395, 677.8887581361352, 776.1731123140088, 181.09629271693868, 952.9416346187232, 715.6142433990947, 1349.6294403375082, 383.5525920519423, 1540.9546697386836, 1454.051191825557, 1414.6098698338453, 1348.8679096400888, 670.2201834474131, 1192.043386205642, 1287.6913795631815, 691.0078249880419, 840.2398240786896, 819.5002906501098, 746.9341226405883, 1081.9085712308463, 791.076005443932, 11.189168892562327, 775.4391328232654, 1407.2223145851856, 1349.032123713822, 1331.212109838436, 1337.334020030239, 599.1222138315507, 911.002305020528, 950.8423097285761, 198.21801629465395, 556.7408292595293, 1314.0982367170782, 1176.8275190373763, 246.48546223573302, 928.7626976471691, 88.06323886115271, 1162.7481705818936, 164.22364225881162, 1085.5657153542973, 1424.3388651244597, 208.8501465491767, 1267.9296728836616, 1268.1021973056347, 1313.2879451865867, 1318.3277048050584, 441.4691129373666, 868.3993097114313, 1102.0716152804564, 1154.7662199637884, 1166.4744234688992, 1250.310985902754, 1206.0737106038637, 318.3589689214088, 1308.7211358318777, 1142.931034056342, 0.0, 1342.5135464308544, 1227.5697193432466, 894.4142135870139, 1236.726601371451, 899.7566550384236, 273.00582287199563, 1343.4561013382545, 828.8308814940696, 1297.1130326814853, 1274.7278177984874, 566.1582020613916, 1013.7929922366117, 1194.0038806981797, 1257.3068409280588, 879.9109737029198, 695.8927945359316, 601.6380471241465, 1260.3979303244698, 1390.3591840910483, 1438.3723727391712, 1509.9671891978544, 99.87426788336069, 1002.1752531489107, 680.6775103020071, 1015.6425577132802, 277.62905899354115, 1409.2011018099017, 1162.1128228773011, 1209.4927224752807, 1455.2837857929974, 1313.2011261459627, 85.78149024827357, 1058.368400672756, 350.2609965053605, 732.6779731398425, 376.79458664018995, 1099.6263179186105, 44.083734892234865, 1025.8967263101076, 614.3875748752123, 710.5106262831449, 23.04536515860846, 1121.472706909196, 700.5027062418447, 1269.4584159799954, 1153.3695048947638, 1045.7997318236407, 664.1312087166119, 61.15478065489587, 10.393442799025616, 1048.6661415421777, 285.51225951962664, 601.2435483525375, 537.2479313488785, 25.94472690005811, 619.2693570257851, 43.32242266718088, 1520.977360387765, 1068.082728209546, 951.6239336610537, 1068.2300639034547, 307.2534760615064, 458.3749760791329, 914.4919131464368]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.565307810988849, "mean_inference_ms": 3.3273585433039288, "mean_action_processing_ms": 1.229484657494323, "mean_env_wait_ms": 9.758838843155349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004411458969116211, "StateBufferConnector_ms": 0.005153656005859375, "ViewRequirementAgentConnector_ms": 0.0919954776763916}, "num_episodes": 10, "episode_return_max": 720.3907363095723, "episode_return_min": -2.316814613494996, "episode_return_mean": 220.33105431894256, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.04380642740519, "num_env_steps_trained_throughput_per_sec": 82.04380642740519, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 48715.329, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48715.279, "sample_time_ms": 2108.011, "learn_time_ms": 46590.591, "learn_throughput": 85.854, "synch_weights_time_ms": 13.945}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "fed12_00000", "date": "2024-08-21_18-35-34", "timestamp": 1724245534, "time_this_iter_s": 48.791189193725586, "time_total_s": 1859.1955268383026, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f491430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1859.1955268383026, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 25.765217391304347, "ram_util_percent": 82.66811594202899}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.700051930373307, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.598695073304353, "policy_loss": -0.02346303582329441, "vf_loss": 7.618543645818398, "vf_explained_var": 0.42408432187857453, "kl": 0.018072337642183932, "entropy": 0.9532464183827557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.442881719082122, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.820430451852304, "policy_loss": -0.015138395343138466, "vf_loss": 7.833037111494276, "vf_explained_var": 0.41035098130740816, "kl": 0.012658766075653374, "entropy": 0.6095662334450969, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 720.3907363095723, "episode_reward_min": -2.316814613494996, "episode_reward_mean": 231.6223964693944, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1540.9546697386836, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 345.4624419609055, "predator_policy": 1540.9546697386836}, "policy_reward_mean": {"prey_policy": -779.8423819855759, "predator_policy": 895.6535802202733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [433.95390492589036, 16.266736975861505, 229.4494237977554, 238.15991862286214, 23.18386021584314, 92.7105629907254, 346.93167861382045, 217.06904753985626, 47.96772952010954, 320.6142807626224, 150.89945574479336, 4.658450324358563, 464.909895449422, 148.61506514266057, 591.5453260817993, 276.6097147788547, 280.01697717118356, 393.77106415273914, 217.27745373376965, 237.68418886645895, 71.65764306441969, 152.715006079375, 552.9599501190694, 144.33162512095382, 308.8531371507339, 454.205893491686, 174.93458719446303, 397.7650033756623, 13.413747185023611, 46.00261173438991, 1.4259867437927856, 143.922475969465, 337.322040592702, 329.6999371708161, 201.63025846285274, 484.872711867643, 55.100000000000485, -2.316814613494996, 12.45342692281461, 178.58114451050525, 332.36200092060716, 117.76150873367317, 140.28032177819753, 116.34547495569004, 166.99029603547785, 3.5122076252615475, 478.2265935083731, 2.0425830160168914, 208.16992849272108, 190.09629755628464, 134.80096141120092, 15.04962989867605, 92.35871243012144, 375.9115000815684, 151.82161615391325, 414.375214785727, 459.34278204615134, 720.3907363095723, 0.06615230507734893, 332.01367557728935, 239.37557044778526, 314.83215512830503, 634.5520615316982, 5.838295393369962, 120.52832478423302, 231.1185507113621, 195.39538733324204, 29.30105918759164, 28.866205020296047, 205.78388769355382, 224.58198718247013, 408.0598949115361, 89.87893315928358, 369.68442789986676, 387.5078071195132, 418.65601233789283, 190.15275598040995, 255.95227510360425, 386.4000000000018, 560.4375106051199, 284.90210909568134, 274.5610617744131, 38.20000000000027, 11.06934464418177, 358.5537192462882, 198.53879822430048, 198.28036693243325, 340.94876469634187, 550.2431739932705, 4.200000000000004, 34.551299638198856, 510.65450084730986, 47.281570281766925, 236.62916978135198, 9.0, 578.9589113207572, 114.83340791427057, 577.1561502237258, 249.58154957858545, 3.4493460395660285], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-268.2116115868974, -597.0904768030215, -1188.956614192685, -1292.326047817655, -213.22710665763734, -551.5604843872189, -587.107432393183, -898.6454964518647, -659.1981211106227, -1418.8244270394741, -956.7707665368721, -1037.5251271600678, -1110.7000211478664, -211.77054113345773, -711.7998590162406, -840.815388907439, -1191.7986872883005, -1392.6546573017415, -9.482825697744108, -1461.8944324552524, -742.3369100468024, -1216.1906965117319, -1146.209605064565, -1194.3312044554361, -631.2879933951397, -1231.579307045328, -603.1290939335661, -1383.4704881641555, -374.6356061842516, -1183.9544032209858, -525.4170842320024, -1360.989358008976, -835.64013048555, -126.91849709058289, -935.1518676565486, -829.2232853135419, -1169.0716369054358, -1082.9931159163157, -100.30029209104822, -935.0755089266835, -1197.8250003418214, -483.20208508016043, -1130.9882161560986, -202.9161285218359, 36.898029599226795, -1459.4460665543595, -584.3344346350439, -865.6440614128858, -1258.1034916328172, -581.2406256250197, -1261.002723898413, -43.60497119953699, -691.4708585569211, -587.656424698759, -510.13577524484595, -226.13714871515324, -702.8142433990918, -1349.0156931524846, -337.54998031754775, -1540.9546697386836, -1454.0556631500945, -1413.1794117655154, -1348.8679096400888, -526.2977074779474, -944.1196885561834, -1198.2930366199414, -218.6585491601147, -982.8891627358004, -674.9345113700855, -689.8696434577558, -352.9335047092639, -1035.1783600978733, 28.01083110743778, -759.5391328232622, -1413.8672939427556, -1344.7039589697472, -1330.529563117413, -1325.5631398284472, 1.74770535182862, -1333.2910796933977, 54.402224414891535, -871.1005495175158, -568.5502582839383, -1184.5272989589919, -1195.8818022627577, -87.15085723215385, -846.8709015796682, -53.60955997296274, -1157.652154439427, -2.329362365799342, -1085.1230685572466, -1421.269304296249, -1287.1531625154253, 288.5999365909596, -1266.1596142896178, -1313.1879451865868, -1353.3305802944915, -198.29630895521407, -642.9509533228451, -1137.4236741127572, -1163.662087550377, -1022.7775944711121, -1237.0438853937117, -1204.29118121423, -744.376682083079, -790.3447102400833, -1098.9310340563422, 331.9115000815684, -1101.1557312953012, -1317.1059183248867, -978.1401788387017, -738.6254213340367, 245.42704470834678, -958.8467405726144, -916.8959365759088, -535.0003099468464, -1297.046880376408, -1274.7278177984874, -273.17761411982946, -974.7599046008844, -885.1301764255303, -1326.804974752922, -808.6069927418689, -452.36462036867783, -894.802319364046, -332.6815965528713, -1470.871758869058, -1352.0215025677912, -1510.6850688178738, 21.371936520892923, -552.1716566575006, -899.5625560820528, -143.31860973684277, -954.5576196367368, -1327.2032714415707, -1214.8095940580388, -1253.1895099691826, -1382.720793278798, -688.2619208053837, -504.9368078952946, -759.1583281968844, -424.8890817987594, -616.8911164476086, -84.52154842088947, 34.04373534629382, -1087.8748549978543, -1125.7589712968736, -144.84090198858382, -691.5106262831459, 345.4624419609055, -171.86550491250682, -1231.4538959006518, -1383.966065269417, -848.7090996249308, -1288.565134989197, -165.4135304474502, 286.34521934510417, 28.506557200974505, 319.508087368387, -1093.2489778250715, -653.3519154909844, -200.23745511475497, -43.8177969185022, -326.83522523292976, -5.1224226671805315, -1520.977360387765, -1067.22017158199, -941.4171456444274, -1030.0612868589396, 13.131466140268357, -364.43204776061765, -809.8960432406478, -639.9791427994594, -848.0544351685601, -1093.5582392138292, 331.8487646963418, 137.40143856656042, -1065.7215885319351, -1273.5915400143065, -1165.7006184354573, -1511.0402987650068, -254.7875424848077, -263.3185577669505, 147.51358639793733, 5.248408761413177, -1331.929225985676, -77.15804404117254, -1033.1971690228359, -1194.4112457873698, -1376.0943182391384, -93.8767310070881, -1422.6760010939074, -1493.9424645527658, -1181.5397080135645, 11.21248689293932, -1113.3364821332766, -1134.262062750903, -2.295858863813687, -864.9854466068415, -1296.316106900659], "policy_predator_policy_reward": [989.628088365436, 309.627904950374, 1205.694738024149, 1291.854660962053, 130.69180631268173, 863.5452085299304, 861.4343653624393, 862.4784821054704, 682.2819813264697, 1418.9244270394743, 816.5235480910754, 1270.4829085965903, 996.430187466374, 672.9720534287709, 697.433933294217, 1072.2503621693197, 1242.7162476965468, 1389.7048264136045, 506.5308297633486, 1285.4607091522735, 893.2363657915955, 1216.1906965117319, 1140.6886769183923, 1204.5105829259637, 1271.9182312042085, 1055.85896468568, 751.744159076227, 1383.4704881641555, 1049.1176291242882, 1101.0177063627452, 1158.8296233992821, 1004.1865336205516, 21.055418901153047, 1221.5201858461614, 986.0399620018961, 1172.1062551209336, 1094.644106715677, 1374.6980998398435, 436.5532236560276, 836.5067662281615, 1250.7748321525078, 501.9098963338989, 40.09093965318317, 1446.5284111041258, 732.6930960759164, 1242.8148909982842, 829.6278789247983, 764.6822422440928, 1055.0657282485201, 1093.1315261600525, 1237.8094971408966, 521.0040914487395, 677.8887581361352, 776.1731123140088, 181.09629271693868, 952.9416346187232, 715.6142433990947, 1349.6294403375082, 383.5525920519423, 1540.9546697386836, 1454.051191825557, 1414.6098698338453, 1348.8679096400888, 670.2201834474131, 1192.043386205642, 1287.6913795631815, 691.0078249880419, 840.2398240786896, 819.5002906501098, 746.9341226405883, 1081.9085712308463, 791.076005443932, 11.189168892562327, 775.4391328232654, 1407.2223145851856, 1349.032123713822, 1331.212109838436, 1337.334020030239, 599.1222138315507, 911.002305020528, 950.8423097285761, 198.21801629465395, 556.7408292595293, 1314.0982367170782, 1176.8275190373763, 246.48546223573302, 928.7626976471691, 88.06323886115271, 1162.7481705818936, 164.22364225881162, 1085.5657153542973, 1424.3388651244597, 208.8501465491767, 1267.9296728836616, 1268.1021973056347, 1313.2879451865867, 1318.3277048050584, 441.4691129373666, 868.3993097114313, 1102.0716152804564, 1154.7662199637884, 1166.4744234688992, 1250.310985902754, 1206.0737106038637, 318.3589689214088, 1308.7211358318777, 1142.931034056342, 0.0, 1342.5135464308544, 1227.5697193432466, 894.4142135870139, 1236.726601371451, 899.7566550384236, 273.00582287199563, 1343.4561013382545, 828.8308814940696, 1297.1130326814853, 1274.7278177984874, 566.1582020613916, 1013.7929922366117, 1194.0038806981797, 1257.3068409280588, 879.9109737029198, 695.8927945359316, 601.6380471241465, 1260.3979303244698, 1390.3591840910483, 1438.3723727391712, 1509.9671891978544, 99.87426788336069, 1002.1752531489107, 680.6775103020071, 1015.6425577132802, 277.62905899354115, 1409.2011018099017, 1162.1128228773011, 1209.4927224752807, 1455.2837857929974, 1313.2011261459627, 85.78149024827357, 1058.368400672756, 350.2609965053605, 732.6779731398425, 376.79458664018995, 1099.6263179186105, 44.083734892234865, 1025.8967263101076, 614.3875748752123, 710.5106262831449, 23.04536515860846, 1121.472706909196, 700.5027062418447, 1269.4584159799954, 1153.3695048947638, 1045.7997318236407, 664.1312087166119, 61.15478065489587, 10.393442799025616, 1048.6661415421777, 285.51225951962664, 601.2435483525375, 537.2479313488785, 25.94472690005811, 619.2693570257851, 43.32242266718088, 1520.977360387765, 1068.082728209546, 951.6239336610537, 1068.2300639034547, 307.2534760615064, 458.3749760791329, 914.4919131464368, 849.4337246352381, 836.880220265215, 1102.6582392138287, 0.0, 562.0374138339863, 916.5259101246555, 1274.3915400143062, 1169.1006184354542, 1511.0402987650068, 289.3388421230127, 482.11444396587814, 144.34502825044498, 42.033161520353715, 1331.929225985676, 861.655841173891, 485.3285416714696, 1203.4112457873696, 1376.0943182391384, 1019.5775127630803, 1075.934130658668, 1476.0956571152503, 1314.2199233653444, 700.4036634960697, 978.8764819679949, 732.5752000349037, 653.5642711584011, 874.1677216104887, 1290.5831779365794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5587276492749504, "mean_inference_ms": 3.3176742850095855, "mean_action_processing_ms": 1.2254393742567817, "mean_env_wait_ms": 9.762355453106956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003957271575927734, "StateBufferConnector_ms": 0.005068659782409668, "ViewRequirementAgentConnector_ms": 0.09121441841125488}, "num_episodes": 14, "episode_return_max": 720.3907363095723, "episode_return_min": -2.316814613494996, "episode_return_mean": 231.6223964693944, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.16720390807049, "num_env_steps_trained_throughput_per_sec": 81.16720390807049, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 48790.213, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48790.162, "sample_time_ms": 2107.346, "learn_time_ms": 46666.188, "learn_throughput": 85.715, "synch_weights_time_ms": 13.94}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "fed12_00000", "date": "2024-08-21_18-36-23", "timestamp": 1724245583, "time_this_iter_s": 49.32713079452515, "time_total_s": 1908.5226576328278, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31d553820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1908.5226576328278, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 29.768115942028984, "ram_util_percent": 82.56521739130436}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.271541460922785, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.758244015426232, "policy_loss": -0.020789001503634073, "vf_loss": 7.77553832013771, "vf_explained_var": 0.4003291049016216, "kl": 0.017473531793802975, "entropy": 0.9249417168122751, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.020701884844947, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.793766514964835, "policy_loss": -0.01580572660849799, "vf_loss": 7.807136973880586, "vf_explained_var": 0.3417098965909746, "kl": 0.012176395676014994, "entropy": 0.583065418181596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 720.3907363095723, "episode_reward_min": -2.316814613494996, "episode_reward_mean": 236.38874508138213, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1540.9546697386836, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 345.4624419609055, "predator_policy": 1540.9546697386836}, "policy_reward_mean": {"prey_policy": -760.5725094006132, "predator_policy": 878.7668819413044}, "custom_metrics": {}, "hist_stats": {"episode_reward": [464.909895449422, 148.61506514266057, 591.5453260817993, 276.6097147788547, 280.01697717118356, 393.77106415273914, 217.27745373376965, 237.68418886645895, 71.65764306441969, 152.715006079375, 552.9599501190694, 144.33162512095382, 308.8531371507339, 454.205893491686, 174.93458719446303, 397.7650033756623, 13.413747185023611, 46.00261173438991, 1.4259867437927856, 143.922475969465, 337.322040592702, 329.6999371708161, 201.63025846285274, 484.872711867643, 55.100000000000485, -2.316814613494996, 12.45342692281461, 178.58114451050525, 332.36200092060716, 117.76150873367317, 140.28032177819753, 116.34547495569004, 166.99029603547785, 3.5122076252615475, 478.2265935083731, 2.0425830160168914, 208.16992849272108, 190.09629755628464, 134.80096141120092, 15.04962989867605, 92.35871243012144, 375.9115000815684, 151.82161615391325, 414.375214785727, 459.34278204615134, 720.3907363095723, 0.06615230507734893, 332.01367557728935, 239.37557044778526, 314.83215512830503, 634.5520615316982, 5.838295393369962, 120.52832478423302, 231.1185507113621, 195.39538733324204, 29.30105918759164, 28.866205020296047, 205.78388769355382, 224.58198718247013, 408.0598949115361, 89.87893315928358, 369.68442789986676, 387.5078071195132, 418.65601233789283, 190.15275598040995, 255.95227510360425, 386.4000000000018, 560.4375106051199, 284.90210909568134, 274.5610617744131, 38.20000000000027, 11.06934464418177, 358.5537192462882, 198.53879822430048, 198.28036693243325, 340.94876469634187, 550.2431739932705, 4.200000000000004, 34.551299638198856, 510.65450084730986, 47.281570281766925, 236.62916978135198, 9.0, 578.9589113207572, 114.83340791427057, 577.1561502237258, 249.58154957858545, 3.4493460395660285, 423.2910786569503, 367.39754681251225, 19.51177843453281, 75.33137216493104, 126.36259722767707, 510.0890541565877, 138.06845999252636, 34.9000000000002, 475.5192980684171, 176.0989421950513, 251.29928819035143, 0.6304953337315753], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-631.2879933951397, -1231.579307045328, -603.1290939335661, -1383.4704881641555, -374.6356061842516, -1183.9544032209858, -525.4170842320024, -1360.989358008976, -835.64013048555, -126.91849709058289, -935.1518676565486, -829.2232853135419, -1169.0716369054358, -1082.9931159163157, -100.30029209104822, -935.0755089266835, -1197.8250003418214, -483.20208508016043, -1130.9882161560986, -202.9161285218359, 36.898029599226795, -1459.4460665543595, -584.3344346350439, -865.6440614128858, -1258.1034916328172, -581.2406256250197, -1261.002723898413, -43.60497119953699, -691.4708585569211, -587.656424698759, -510.13577524484595, -226.13714871515324, -702.8142433990918, -1349.0156931524846, -337.54998031754775, -1540.9546697386836, -1454.0556631500945, -1413.1794117655154, -1348.8679096400888, -526.2977074779474, -944.1196885561834, -1198.2930366199414, -218.6585491601147, -982.8891627358004, -674.9345113700855, -689.8696434577558, -352.9335047092639, -1035.1783600978733, 28.01083110743778, -759.5391328232622, -1413.8672939427556, -1344.7039589697472, -1330.529563117413, -1325.5631398284472, 1.74770535182862, -1333.2910796933977, 54.402224414891535, -871.1005495175158, -568.5502582839383, -1184.5272989589919, -1195.8818022627577, -87.15085723215385, -846.8709015796682, -53.60955997296274, -1157.652154439427, -2.329362365799342, -1085.1230685572466, -1421.269304296249, -1287.1531625154253, 288.5999365909596, -1266.1596142896178, -1313.1879451865868, -1353.3305802944915, -198.29630895521407, -642.9509533228451, -1137.4236741127572, -1163.662087550377, -1022.7775944711121, -1237.0438853937117, -1204.29118121423, -744.376682083079, -790.3447102400833, -1098.9310340563422, 331.9115000815684, -1101.1557312953012, -1317.1059183248867, -978.1401788387017, -738.6254213340367, 245.42704470834678, -958.8467405726144, -916.8959365759088, -535.0003099468464, -1297.046880376408, -1274.7278177984874, -273.17761411982946, -974.7599046008844, -885.1301764255303, -1326.804974752922, -808.6069927418689, -452.36462036867783, -894.802319364046, -332.6815965528713, -1470.871758869058, -1352.0215025677912, -1510.6850688178738, 21.371936520892923, -552.1716566575006, -899.5625560820528, -143.31860973684277, -954.5576196367368, -1327.2032714415707, -1214.8095940580388, -1253.1895099691826, -1382.720793278798, -688.2619208053837, -504.9368078952946, -759.1583281968844, -424.8890817987594, -616.8911164476086, -84.52154842088947, 34.04373534629382, -1087.8748549978543, -1125.7589712968736, -144.84090198858382, -691.5106262831459, 345.4624419609055, -171.86550491250682, -1231.4538959006518, -1383.966065269417, -848.7090996249308, -1288.565134989197, -165.4135304474502, 286.34521934510417, 28.506557200974505, 319.508087368387, -1093.2489778250715, -653.3519154909844, -200.23745511475497, -43.8177969185022, -326.83522523292976, -5.1224226671805315, -1520.977360387765, -1067.22017158199, -941.4171456444274, -1030.0612868589396, 13.131466140268357, -364.43204776061765, -809.8960432406478, -639.9791427994594, -848.0544351685601, -1093.5582392138292, 331.8487646963418, 137.40143856656042, -1065.7215885319351, -1273.5915400143065, -1165.7006184354573, -1511.0402987650068, -254.7875424848077, -263.3185577669505, 147.51358639793733, 5.248408761413177, -1331.929225985676, -77.15804404117254, -1033.1971690228359, -1194.4112457873698, -1376.0943182391384, -93.8767310070881, -1422.6760010939074, -1493.9424645527658, -1181.5397080135645, 11.21248689293932, -1113.3364821332766, -1134.262062750903, -2.295858863813687, -864.9854466068415, -1296.316106900659, -4.842941071505315, -946.7148059469612, 195.8723005214654, -458.0992911537832, -1215.1137975563386, -1353.2422871661463, -1196.5136519868513, -1377.7522729552268, -1195.3983794836008, -272.13675030196316, -505.08116501062716, -103.8519972520325, -1015.944809212901, -296.1009352486585, -39.346639166975585, -1417.1275512282982, -1401.3725377604549, 34.42657060604326, -900.2850619459601, 15.684169113656637, -306.3207349681157, -739.465710026769, -1415.7966280383512, -1130.929116930857], "policy_predator_policy_reward": [1271.9182312042085, 1055.85896468568, 751.744159076227, 1383.4704881641555, 1049.1176291242882, 1101.0177063627452, 1158.8296233992821, 1004.1865336205516, 21.055418901153047, 1221.5201858461614, 986.0399620018961, 1172.1062551209336, 1094.644106715677, 1374.6980998398435, 436.5532236560276, 836.5067662281615, 1250.7748321525078, 501.9098963338989, 40.09093965318317, 1446.5284111041258, 732.6930960759164, 1242.8148909982842, 829.6278789247983, 764.6822422440928, 1055.0657282485201, 1093.1315261600525, 1237.8094971408966, 521.0040914487395, 677.8887581361352, 776.1731123140088, 181.09629271693868, 952.9416346187232, 715.6142433990947, 1349.6294403375082, 383.5525920519423, 1540.9546697386836, 1454.051191825557, 1414.6098698338453, 1348.8679096400888, 670.2201834474131, 1192.043386205642, 1287.6913795631815, 691.0078249880419, 840.2398240786896, 819.5002906501098, 746.9341226405883, 1081.9085712308463, 791.076005443932, 11.189168892562327, 775.4391328232654, 1407.2223145851856, 1349.032123713822, 1331.212109838436, 1337.334020030239, 599.1222138315507, 911.002305020528, 950.8423097285761, 198.21801629465395, 556.7408292595293, 1314.0982367170782, 1176.8275190373763, 246.48546223573302, 928.7626976471691, 88.06323886115271, 1162.7481705818936, 164.22364225881162, 1085.5657153542973, 1424.3388651244597, 208.8501465491767, 1267.9296728836616, 1268.1021973056347, 1313.2879451865867, 1318.3277048050584, 441.4691129373666, 868.3993097114313, 1102.0716152804564, 1154.7662199637884, 1166.4744234688992, 1250.310985902754, 1206.0737106038637, 318.3589689214088, 1308.7211358318777, 1142.931034056342, 0.0, 1342.5135464308544, 1227.5697193432466, 894.4142135870139, 1236.726601371451, 899.7566550384236, 273.00582287199563, 1343.4561013382545, 828.8308814940696, 1297.1130326814853, 1274.7278177984874, 566.1582020613916, 1013.7929922366117, 1194.0038806981797, 1257.3068409280588, 879.9109737029198, 695.8927945359316, 601.6380471241465, 1260.3979303244698, 1390.3591840910483, 1438.3723727391712, 1509.9671891978544, 99.87426788336069, 1002.1752531489107, 680.6775103020071, 1015.6425577132802, 277.62905899354115, 1409.2011018099017, 1162.1128228773011, 1209.4927224752807, 1455.2837857929974, 1313.2011261459627, 85.78149024827357, 1058.368400672756, 350.2609965053605, 732.6779731398425, 376.79458664018995, 1099.6263179186105, 44.083734892234865, 1025.8967263101076, 614.3875748752123, 710.5106262831449, 23.04536515860846, 1121.472706909196, 700.5027062418447, 1269.4584159799954, 1153.3695048947638, 1045.7997318236407, 664.1312087166119, 61.15478065489587, 10.393442799025616, 1048.6661415421777, 285.51225951962664, 601.2435483525375, 537.2479313488785, 25.94472690005811, 619.2693570257851, 43.32242266718088, 1520.977360387765, 1068.082728209546, 951.6239336610537, 1068.2300639034547, 307.2534760615064, 458.3749760791329, 914.4919131464368, 849.4337246352381, 836.880220265215, 1102.6582392138287, 0.0, 562.0374138339863, 916.5259101246555, 1274.3915400143062, 1169.1006184354542, 1511.0402987650068, 289.3388421230127, 482.11444396587814, 144.34502825044498, 42.033161520353715, 1331.929225985676, 861.655841173891, 485.3285416714696, 1203.4112457873696, 1376.0943182391384, 1019.5775127630803, 1075.934130658668, 1476.0956571152503, 1314.2199233653444, 700.4036634960697, 978.8764819679949, 732.5752000349037, 653.5642711584011, 874.1677216104887, 1290.5831779365794, 540.6721876692042, 834.1766380062099, 623.7823245523011, 5.842212892533185, 1232.8758553077446, 1354.9920078492707, 1327.880013771003, 1321.717283336007, 857.3790713666461, 736.518655646604, 457.9746023322094, 661.0476140870385, 771.9854957418277, 678.1287087122636, 74.24663916697541, 1417.1275512282982, 566.7902892908094, 1275.6749759320148, 900.9850619459603, 159.7147730813959, 0.0, 1297.0857331852376, 1414.1201737656052, 1133.2360665373346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5514224390767417, "mean_inference_ms": 3.314705017193359, "mean_action_processing_ms": 1.2272047021704817, "mean_env_wait_ms": 9.773137370449408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00490570068359375, "StateBufferConnector_ms": 0.0057059526443481445, "ViewRequirementAgentConnector_ms": 0.10278761386871338}, "num_episodes": 12, "episode_return_max": 720.3907363095723, "episode_return_min": -2.316814613494996, "episode_return_mean": 236.38874508138213, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.63668887675381, "num_env_steps_trained_throughput_per_sec": 82.63668887675381, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 48778.052, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48778.0, "sample_time_ms": 2106.208, "learn_time_ms": 46654.706, "learn_throughput": 85.736, "synch_weights_time_ms": 14.02}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "fed12_00000", "date": "2024-08-21_18-37-12", "timestamp": 1724245632, "time_this_iter_s": 48.449355125427246, "time_total_s": 1956.972012758255, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4b5c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1956.972012758255, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 25.43188405797102, "ram_util_percent": 81.83768115942028}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.43548507236299, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.863057774084585, "policy_loss": -0.024391501374473726, "vf_loss": 7.884319430305844, "vf_explained_var": 0.4618518285650425, "kl": 0.015649188049482527, "entropy": 0.8635525676308485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.62632561695008, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.655275447028024, "policy_loss": -0.013614112772195349, "vf_loss": 7.666536297369255, "vf_explained_var": 0.389485544250125, "kl": 0.011766296438626433, "entropy": 0.565134416496943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 870.8017691184915, "episode_reward_min": -2.316814613494996, "episode_reward_mean": 230.0713400834378, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1540.9546697386836, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 345.4624419609055, "predator_policy": 1540.9546697386836}, "policy_reward_mean": {"prey_policy": -763.645311990469, "predator_policy": 878.6809820321882}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.65764306441969, 152.715006079375, 552.9599501190694, 144.33162512095382, 308.8531371507339, 454.205893491686, 174.93458719446303, 397.7650033756623, 13.413747185023611, 46.00261173438991, 1.4259867437927856, 143.922475969465, 337.322040592702, 329.6999371708161, 201.63025846285274, 484.872711867643, 55.100000000000485, -2.316814613494996, 12.45342692281461, 178.58114451050525, 332.36200092060716, 117.76150873367317, 140.28032177819753, 116.34547495569004, 166.99029603547785, 3.5122076252615475, 478.2265935083731, 2.0425830160168914, 208.16992849272108, 190.09629755628464, 134.80096141120092, 15.04962989867605, 92.35871243012144, 375.9115000815684, 151.82161615391325, 414.375214785727, 459.34278204615134, 720.3907363095723, 0.06615230507734893, 332.01367557728935, 239.37557044778526, 314.83215512830503, 634.5520615316982, 5.838295393369962, 120.52832478423302, 231.1185507113621, 195.39538733324204, 29.30105918759164, 28.866205020296047, 205.78388769355382, 224.58198718247013, 408.0598949115361, 89.87893315928358, 369.68442789986676, 387.5078071195132, 418.65601233789283, 190.15275598040995, 255.95227510360425, 386.4000000000018, 560.4375106051199, 284.90210909568134, 274.5610617744131, 38.20000000000027, 11.06934464418177, 358.5537192462882, 198.53879822430048, 198.28036693243325, 340.94876469634187, 550.2431739932705, 4.200000000000004, 34.551299638198856, 510.65450084730986, 47.281570281766925, 236.62916978135198, 9.0, 578.9589113207572, 114.83340791427057, 577.1561502237258, 249.58154957858545, 3.4493460395660285, 423.2910786569503, 367.39754681251225, 19.51177843453281, 75.33137216493104, 126.36259722767707, 510.0890541565877, 138.06845999252636, 34.9000000000002, 475.5192980684171, 176.0989421950513, 251.29928819035143, 0.6304953337315753, 4.942809513202335, 1.8000000000000005, 870.8017691184915, 7.899999999999983, 46.54868620393843, 569.1347534662589, 141.29160853377272, 336.2695587467911], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1197.8250003418214, -483.20208508016043, -1130.9882161560986, -202.9161285218359, 36.898029599226795, -1459.4460665543595, -584.3344346350439, -865.6440614128858, -1258.1034916328172, -581.2406256250197, -1261.002723898413, -43.60497119953699, -691.4708585569211, -587.656424698759, -510.13577524484595, -226.13714871515324, -702.8142433990918, -1349.0156931524846, -337.54998031754775, -1540.9546697386836, -1454.0556631500945, -1413.1794117655154, -1348.8679096400888, -526.2977074779474, -944.1196885561834, -1198.2930366199414, -218.6585491601147, -982.8891627358004, -674.9345113700855, -689.8696434577558, -352.9335047092639, -1035.1783600978733, 28.01083110743778, -759.5391328232622, -1413.8672939427556, -1344.7039589697472, -1330.529563117413, -1325.5631398284472, 1.74770535182862, -1333.2910796933977, 54.402224414891535, -871.1005495175158, -568.5502582839383, -1184.5272989589919, -1195.8818022627577, -87.15085723215385, -846.8709015796682, -53.60955997296274, -1157.652154439427, -2.329362365799342, -1085.1230685572466, -1421.269304296249, -1287.1531625154253, 288.5999365909596, -1266.1596142896178, -1313.1879451865868, -1353.3305802944915, -198.29630895521407, -642.9509533228451, -1137.4236741127572, -1163.662087550377, -1022.7775944711121, -1237.0438853937117, -1204.29118121423, -744.376682083079, -790.3447102400833, -1098.9310340563422, 331.9115000815684, -1101.1557312953012, -1317.1059183248867, -978.1401788387017, -738.6254213340367, 245.42704470834678, -958.8467405726144, -916.8959365759088, -535.0003099468464, -1297.046880376408, -1274.7278177984874, -273.17761411982946, -974.7599046008844, -885.1301764255303, -1326.804974752922, -808.6069927418689, -452.36462036867783, -894.802319364046, -332.6815965528713, -1470.871758869058, -1352.0215025677912, -1510.6850688178738, 21.371936520892923, -552.1716566575006, -899.5625560820528, -143.31860973684277, -954.5576196367368, -1327.2032714415707, -1214.8095940580388, -1253.1895099691826, -1382.720793278798, -688.2619208053837, -504.9368078952946, -759.1583281968844, -424.8890817987594, -616.8911164476086, -84.52154842088947, 34.04373534629382, -1087.8748549978543, -1125.7589712968736, -144.84090198858382, -691.5106262831459, 345.4624419609055, -171.86550491250682, -1231.4538959006518, -1383.966065269417, -848.7090996249308, -1288.565134989197, -165.4135304474502, 286.34521934510417, 28.506557200974505, 319.508087368387, -1093.2489778250715, -653.3519154909844, -200.23745511475497, -43.8177969185022, -326.83522523292976, -5.1224226671805315, -1520.977360387765, -1067.22017158199, -941.4171456444274, -1030.0612868589396, 13.131466140268357, -364.43204776061765, -809.8960432406478, -639.9791427994594, -848.0544351685601, -1093.5582392138292, 331.8487646963418, 137.40143856656042, -1065.7215885319351, -1273.5915400143065, -1165.7006184354573, -1511.0402987650068, -254.7875424848077, -263.3185577669505, 147.51358639793733, 5.248408761413177, -1331.929225985676, -77.15804404117254, -1033.1971690228359, -1194.4112457873698, -1376.0943182391384, -93.8767310070881, -1422.6760010939074, -1493.9424645527658, -1181.5397080135645, 11.21248689293932, -1113.3364821332766, -1134.262062750903, -2.295858863813687, -864.9854466068415, -1296.316106900659, -4.842941071505315, -946.7148059469612, 195.8723005214654, -458.0992911537832, -1215.1137975563386, -1353.2422871661463, -1196.5136519868513, -1377.7522729552268, -1195.3983794836008, -272.13675030196316, -505.08116501062716, -103.8519972520325, -1015.944809212901, -296.1009352486585, -39.346639166975585, -1417.1275512282982, -1401.3725377604549, 34.42657060604326, -900.2850619459601, 15.684169113656637, -306.3207349681157, -739.465710026769, -1415.7966280383512, -1130.929116930857, -1364.0648136324817, -1150.2921557324748, -1424.7079057355234, -1188.5978959781671, -1462.2295241124934, 257.87960527371763, -1123.8018094229367, -1147.010516099697, -632.2601027251561, -1028.4915065621651, 224.5526527493652, -1074.7618068168283, -542.0396863503903, -1134.7725915883334, -219.16855693757446, -913.631572870168], "policy_predator_policy_reward": [1250.7748321525078, 501.9098963338989, 40.09093965318317, 1446.5284111041258, 732.6930960759164, 1242.8148909982842, 829.6278789247983, 764.6822422440928, 1055.0657282485201, 1093.1315261600525, 1237.8094971408966, 521.0040914487395, 677.8887581361352, 776.1731123140088, 181.09629271693868, 952.9416346187232, 715.6142433990947, 1349.6294403375082, 383.5525920519423, 1540.9546697386836, 1454.051191825557, 1414.6098698338453, 1348.8679096400888, 670.2201834474131, 1192.043386205642, 1287.6913795631815, 691.0078249880419, 840.2398240786896, 819.5002906501098, 746.9341226405883, 1081.9085712308463, 791.076005443932, 11.189168892562327, 775.4391328232654, 1407.2223145851856, 1349.032123713822, 1331.212109838436, 1337.334020030239, 599.1222138315507, 911.002305020528, 950.8423097285761, 198.21801629465395, 556.7408292595293, 1314.0982367170782, 1176.8275190373763, 246.48546223573302, 928.7626976471691, 88.06323886115271, 1162.7481705818936, 164.22364225881162, 1085.5657153542973, 1424.3388651244597, 208.8501465491767, 1267.9296728836616, 1268.1021973056347, 1313.2879451865867, 1318.3277048050584, 441.4691129373666, 868.3993097114313, 1102.0716152804564, 1154.7662199637884, 1166.4744234688992, 1250.310985902754, 1206.0737106038637, 318.3589689214088, 1308.7211358318777, 1142.931034056342, 0.0, 1342.5135464308544, 1227.5697193432466, 894.4142135870139, 1236.726601371451, 899.7566550384236, 273.00582287199563, 1343.4561013382545, 828.8308814940696, 1297.1130326814853, 1274.7278177984874, 566.1582020613916, 1013.7929922366117, 1194.0038806981797, 1257.3068409280588, 879.9109737029198, 695.8927945359316, 601.6380471241465, 1260.3979303244698, 1390.3591840910483, 1438.3723727391712, 1509.9671891978544, 99.87426788336069, 1002.1752531489107, 680.6775103020071, 1015.6425577132802, 277.62905899354115, 1409.2011018099017, 1162.1128228773011, 1209.4927224752807, 1455.2837857929974, 1313.2011261459627, 85.78149024827357, 1058.368400672756, 350.2609965053605, 732.6779731398425, 376.79458664018995, 1099.6263179186105, 44.083734892234865, 1025.8967263101076, 614.3875748752123, 710.5106262831449, 23.04536515860846, 1121.472706909196, 700.5027062418447, 1269.4584159799954, 1153.3695048947638, 1045.7997318236407, 664.1312087166119, 61.15478065489587, 10.393442799025616, 1048.6661415421777, 285.51225951962664, 601.2435483525375, 537.2479313488785, 25.94472690005811, 619.2693570257851, 43.32242266718088, 1520.977360387765, 1068.082728209546, 951.6239336610537, 1068.2300639034547, 307.2534760615064, 458.3749760791329, 914.4919131464368, 849.4337246352381, 836.880220265215, 1102.6582392138287, 0.0, 562.0374138339863, 916.5259101246555, 1274.3915400143062, 1169.1006184354542, 1511.0402987650068, 289.3388421230127, 482.11444396587814, 144.34502825044498, 42.033161520353715, 1331.929225985676, 861.655841173891, 485.3285416714696, 1203.4112457873696, 1376.0943182391384, 1019.5775127630803, 1075.934130658668, 1476.0956571152503, 1314.2199233653444, 700.4036634960697, 978.8764819679949, 732.5752000349037, 653.5642711584011, 874.1677216104887, 1290.5831779365794, 540.6721876692042, 834.1766380062099, 623.7823245523011, 5.842212892533185, 1232.8758553077446, 1354.9920078492707, 1327.880013771003, 1321.717283336007, 857.3790713666461, 736.518655646604, 457.9746023322094, 661.0476140870385, 771.9854957418277, 678.1287087122636, 74.24663916697541, 1417.1275512282982, 566.7902892908094, 1275.6749759320148, 900.9850619459603, 159.7147730813959, 0.0, 1297.0857331852376, 1414.1201737656052, 1133.2360665373346, 1368.3648136324816, 1150.9349652456772, 1424.9079057355234, 1190.197895978167, 1186.5955099526955, 888.5561780045666, 1129.9018094229366, 1148.8105160996977, 660.808788929098, 1046.4915065621624, 519.3877039694124, 899.956203564311, 486.807512292165, 1331.2963741803246, 445.99624170147706, 1023.0734468530574]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5507430350901346, "mean_inference_ms": 3.311426359053935, "mean_action_processing_ms": 1.2202857348033573, "mean_env_wait_ms": 9.768818927179138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004960179328918457, "StateBufferConnector_ms": 0.005953788757324219, "ViewRequirementAgentConnector_ms": 0.1045370101928711}, "num_episodes": 8, "episode_return_max": 870.8017691184915, "episode_return_min": -2.316814613494996, "episode_return_mean": 230.0713400834378, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.97665555568362, "num_env_steps_trained_throughput_per_sec": 81.97665555568362, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 48786.798, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48786.748, "sample_time_ms": 2098.282, "learn_time_ms": 46671.516, "learn_throughput": 85.705, "synch_weights_time_ms": 13.794}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "fed12_00000", "date": "2024-08-21_18-38-01", "timestamp": 1724245681, "time_this_iter_s": 48.84536600112915, "time_total_s": 2005.8173787593842, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4cdf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2005.8173787593842, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 25.56376811594203, "ram_util_percent": 82.6985507246377}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.761817908160902, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.229634667704345, "policy_loss": -0.016477862483619776, "vf_loss": 7.24347539629255, "vf_explained_var": 0.5156317493272207, "kl": 0.0131857184951918, "entropy": 0.8660427371976237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.21353143932958, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.102146568247881, "policy_loss": -0.014753231841937772, "vf_loss": 7.1147408525779765, "vf_explained_var": 0.48634001249989506, "kl": 0.010794744626791388, "entropy": 0.6049247998724538, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 870.8017691184915, "episode_reward_min": -2.316814613494996, "episode_reward_mean": 221.5567300127812, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1658.680244736944, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 345.4624419609055, "predator_policy": 1660.7802447369438}, "policy_reward_mean": {"prey_policy": -783.2722138811894, "predator_policy": 894.05057888758}, "custom_metrics": {}, "hist_stats": {"episode_reward": [397.7650033756623, 13.413747185023611, 46.00261173438991, 1.4259867437927856, 143.922475969465, 337.322040592702, 329.6999371708161, 201.63025846285274, 484.872711867643, 55.100000000000485, -2.316814613494996, 12.45342692281461, 178.58114451050525, 332.36200092060716, 117.76150873367317, 140.28032177819753, 116.34547495569004, 166.99029603547785, 3.5122076252615475, 478.2265935083731, 2.0425830160168914, 208.16992849272108, 190.09629755628464, 134.80096141120092, 15.04962989867605, 92.35871243012144, 375.9115000815684, 151.82161615391325, 414.375214785727, 459.34278204615134, 720.3907363095723, 0.06615230507734893, 332.01367557728935, 239.37557044778526, 314.83215512830503, 634.5520615316982, 5.838295393369962, 120.52832478423302, 231.1185507113621, 195.39538733324204, 29.30105918759164, 28.866205020296047, 205.78388769355382, 224.58198718247013, 408.0598949115361, 89.87893315928358, 369.68442789986676, 387.5078071195132, 418.65601233789283, 190.15275598040995, 255.95227510360425, 386.4000000000018, 560.4375106051199, 284.90210909568134, 274.5610617744131, 38.20000000000027, 11.06934464418177, 358.5537192462882, 198.53879822430048, 198.28036693243325, 340.94876469634187, 550.2431739932705, 4.200000000000004, 34.551299638198856, 510.65450084730986, 47.281570281766925, 236.62916978135198, 9.0, 578.9589113207572, 114.83340791427057, 577.1561502237258, 249.58154957858545, 3.4493460395660285, 423.2910786569503, 367.39754681251225, 19.51177843453281, 75.33137216493104, 126.36259722767707, 510.0890541565877, 138.06845999252636, 34.9000000000002, 475.5192980684171, 176.0989421950513, 251.29928819035143, 0.6304953337315753, 4.942809513202335, 1.8000000000000005, 870.8017691184915, 7.899999999999983, 46.54868620393843, 569.1347534662589, 141.29160853377272, 336.2695587467911, 29.458769943347278, 233.9771350799411, 400.4333219365718, 0.19999999999998863, 9.99999999999997, 31.1, 303.0276081951836], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-510.13577524484595, -226.13714871515324, -702.8142433990918, -1349.0156931524846, -337.54998031754775, -1540.9546697386836, -1454.0556631500945, -1413.1794117655154, -1348.8679096400888, -526.2977074779474, -944.1196885561834, -1198.2930366199414, -218.6585491601147, -982.8891627358004, -674.9345113700855, -689.8696434577558, -352.9335047092639, -1035.1783600978733, 28.01083110743778, -759.5391328232622, -1413.8672939427556, -1344.7039589697472, -1330.529563117413, -1325.5631398284472, 1.74770535182862, -1333.2910796933977, 54.402224414891535, -871.1005495175158, -568.5502582839383, -1184.5272989589919, -1195.8818022627577, -87.15085723215385, -846.8709015796682, -53.60955997296274, -1157.652154439427, -2.329362365799342, -1085.1230685572466, -1421.269304296249, -1287.1531625154253, 288.5999365909596, -1266.1596142896178, -1313.1879451865868, -1353.3305802944915, -198.29630895521407, -642.9509533228451, -1137.4236741127572, -1163.662087550377, -1022.7775944711121, -1237.0438853937117, -1204.29118121423, -744.376682083079, -790.3447102400833, -1098.9310340563422, 331.9115000815684, -1101.1557312953012, -1317.1059183248867, -978.1401788387017, -738.6254213340367, 245.42704470834678, -958.8467405726144, -916.8959365759088, -535.0003099468464, -1297.046880376408, -1274.7278177984874, -273.17761411982946, -974.7599046008844, -885.1301764255303, -1326.804974752922, -808.6069927418689, -452.36462036867783, -894.802319364046, -332.6815965528713, -1470.871758869058, -1352.0215025677912, -1510.6850688178738, 21.371936520892923, -552.1716566575006, -899.5625560820528, -143.31860973684277, -954.5576196367368, -1327.2032714415707, -1214.8095940580388, -1253.1895099691826, -1382.720793278798, -688.2619208053837, -504.9368078952946, -759.1583281968844, -424.8890817987594, -616.8911164476086, -84.52154842088947, 34.04373534629382, -1087.8748549978543, -1125.7589712968736, -144.84090198858382, -691.5106262831459, 345.4624419609055, -171.86550491250682, -1231.4538959006518, -1383.966065269417, -848.7090996249308, -1288.565134989197, -165.4135304474502, 286.34521934510417, 28.506557200974505, 319.508087368387, -1093.2489778250715, -653.3519154909844, -200.23745511475497, -43.8177969185022, -326.83522523292976, -5.1224226671805315, -1520.977360387765, -1067.22017158199, -941.4171456444274, -1030.0612868589396, 13.131466140268357, -364.43204776061765, -809.8960432406478, -639.9791427994594, -848.0544351685601, -1093.5582392138292, 331.8487646963418, 137.40143856656042, -1065.7215885319351, -1273.5915400143065, -1165.7006184354573, -1511.0402987650068, -254.7875424848077, -263.3185577669505, 147.51358639793733, 5.248408761413177, -1331.929225985676, -77.15804404117254, -1033.1971690228359, -1194.4112457873698, -1376.0943182391384, -93.8767310070881, -1422.6760010939074, -1493.9424645527658, -1181.5397080135645, 11.21248689293932, -1113.3364821332766, -1134.262062750903, -2.295858863813687, -864.9854466068415, -1296.316106900659, -4.842941071505315, -946.7148059469612, 195.8723005214654, -458.0992911537832, -1215.1137975563386, -1353.2422871661463, -1196.5136519868513, -1377.7522729552268, -1195.3983794836008, -272.13675030196316, -505.08116501062716, -103.8519972520325, -1015.944809212901, -296.1009352486585, -39.346639166975585, -1417.1275512282982, -1401.3725377604549, 34.42657060604326, -900.2850619459601, 15.684169113656637, -306.3207349681157, -739.465710026769, -1415.7966280383512, -1130.929116930857, -1364.0648136324817, -1150.2921557324748, -1424.7079057355234, -1188.5978959781671, -1462.2295241124934, 257.87960527371763, -1123.8018094229367, -1147.010516099697, -632.2601027251561, -1028.4915065621651, 224.5526527493652, -1074.7618068168283, -542.0396863503903, -1134.7725915883334, -219.16855693757446, -913.631572870168, -1566.1911780831833, -726.0692283847415, -1018.3971846036566, -306.2446446502066, -931.9275797808347, -596.9412837368867, -1516.4082301611083, -1194.0337944629848, -1658.680244736944, -1071.4335389138578, -1173.8604838516192, -1311.7912998370634, -815.6361164083626, -348.3026292470406], "policy_predator_policy_reward": [181.09629271693868, 952.9416346187232, 715.6142433990947, 1349.6294403375082, 383.5525920519423, 1540.9546697386836, 1454.051191825557, 1414.6098698338453, 1348.8679096400888, 670.2201834474131, 1192.043386205642, 1287.6913795631815, 691.0078249880419, 840.2398240786896, 819.5002906501098, 746.9341226405883, 1081.9085712308463, 791.076005443932, 11.189168892562327, 775.4391328232654, 1407.2223145851856, 1349.032123713822, 1331.212109838436, 1337.334020030239, 599.1222138315507, 911.002305020528, 950.8423097285761, 198.21801629465395, 556.7408292595293, 1314.0982367170782, 1176.8275190373763, 246.48546223573302, 928.7626976471691, 88.06323886115271, 1162.7481705818936, 164.22364225881162, 1085.5657153542973, 1424.3388651244597, 208.8501465491767, 1267.9296728836616, 1268.1021973056347, 1313.2879451865867, 1318.3277048050584, 441.4691129373666, 868.3993097114313, 1102.0716152804564, 1154.7662199637884, 1166.4744234688992, 1250.310985902754, 1206.0737106038637, 318.3589689214088, 1308.7211358318777, 1142.931034056342, 0.0, 1342.5135464308544, 1227.5697193432466, 894.4142135870139, 1236.726601371451, 899.7566550384236, 273.00582287199563, 1343.4561013382545, 828.8308814940696, 1297.1130326814853, 1274.7278177984874, 566.1582020613916, 1013.7929922366117, 1194.0038806981797, 1257.3068409280588, 879.9109737029198, 695.8927945359316, 601.6380471241465, 1260.3979303244698, 1390.3591840910483, 1438.3723727391712, 1509.9671891978544, 99.87426788336069, 1002.1752531489107, 680.6775103020071, 1015.6425577132802, 277.62905899354115, 1409.2011018099017, 1162.1128228773011, 1209.4927224752807, 1455.2837857929974, 1313.2011261459627, 85.78149024827357, 1058.368400672756, 350.2609965053605, 732.6779731398425, 376.79458664018995, 1099.6263179186105, 44.083734892234865, 1025.8967263101076, 614.3875748752123, 710.5106262831449, 23.04536515860846, 1121.472706909196, 700.5027062418447, 1269.4584159799954, 1153.3695048947638, 1045.7997318236407, 664.1312087166119, 61.15478065489587, 10.393442799025616, 1048.6661415421777, 285.51225951962664, 601.2435483525375, 537.2479313488785, 25.94472690005811, 619.2693570257851, 43.32242266718088, 1520.977360387765, 1068.082728209546, 951.6239336610537, 1068.2300639034547, 307.2534760615064, 458.3749760791329, 914.4919131464368, 849.4337246352381, 836.880220265215, 1102.6582392138287, 0.0, 562.0374138339863, 916.5259101246555, 1274.3915400143062, 1169.1006184354542, 1511.0402987650068, 289.3388421230127, 482.11444396587814, 144.34502825044498, 42.033161520353715, 1331.929225985676, 861.655841173891, 485.3285416714696, 1203.4112457873696, 1376.0943182391384, 1019.5775127630803, 1075.934130658668, 1476.0956571152503, 1314.2199233653444, 700.4036634960697, 978.8764819679949, 732.5752000349037, 653.5642711584011, 874.1677216104887, 1290.5831779365794, 540.6721876692042, 834.1766380062099, 623.7823245523011, 5.842212892533185, 1232.8758553077446, 1354.9920078492707, 1327.880013771003, 1321.717283336007, 857.3790713666461, 736.518655646604, 457.9746023322094, 661.0476140870385, 771.9854957418277, 678.1287087122636, 74.24663916697541, 1417.1275512282982, 566.7902892908094, 1275.6749759320148, 900.9850619459603, 159.7147730813959, 0.0, 1297.0857331852376, 1414.1201737656052, 1133.2360665373346, 1368.3648136324816, 1150.9349652456772, 1424.9079057355234, 1190.197895978167, 1186.5955099526955, 888.5561780045666, 1129.9018094229366, 1148.8105160996977, 660.808788929098, 1046.4915065621624, 519.3877039694124, 899.956203564311, 486.807512292165, 1331.2963741803246, 445.99624170147706, 1023.0734468530574, 1566.1911780831833, 755.52799832809, 662.0697743627429, 896.5491899710623, 1167.762023092896, 761.5401623613984, 1516.4082301611083, 1194.2337944629849, 1660.7802447369438, 1079.3335389138506, 1204.960483851618, 1311.7912998370634, 304.27874408169487, 1162.6876097688962]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.54330913450852, "mean_inference_ms": 3.2997394195959435, "mean_action_processing_ms": 1.2284601298169167, "mean_env_wait_ms": 9.775849462819567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023438692092895508, "StateBufferConnector_ms": 0.005998849868774414, "ViewRequirementAgentConnector_ms": 0.11385762691497803}, "num_episodes": 7, "episode_return_max": 870.8017691184915, "episode_return_min": -2.316814613494996, "episode_return_mean": 221.5567300127812, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.42498423225489, "num_env_steps_trained_throughput_per_sec": 82.42498423225489, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 48846.364, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48846.31, "sample_time_ms": 2112.139, "learn_time_ms": 46716.898, "learn_throughput": 85.622, "synch_weights_time_ms": 14.004}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "fed12_00000", "date": "2024-08-21_18-38-49", "timestamp": 1724245729, "time_this_iter_s": 48.58047103881836, "time_total_s": 2054.3978497982025, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4cbca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2054.3978497982025, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 26.59264705882353, "ram_util_percent": 82.92205882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.106997356276032, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.132335576556978, "policy_loss": -0.021317261559568423, "vf_loss": 7.1505833353315085, "vf_explained_var": 0.5140989166088206, "kl": 0.015347535865351794, "entropy": 0.803959794681539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.51332503998721, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.118248346621398, "policy_loss": -0.016613534270297912, "vf_loss": 7.132283886147555, "vf_explained_var": 0.44259308592352287, "kl": 0.012890016529758377, "entropy": 0.6120240837808639, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 870.8017691184915, "episode_reward_min": -2.316814613494996, "episode_reward_mean": 224.9837286932355, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1658.680244736944, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 345.4624419609055, "predator_policy": 1660.7802447369438}, "policy_reward_mean": {"prey_policy": -765.0052564067396, "predator_policy": 877.4971207533573}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.6999371708161, 201.63025846285274, 484.872711867643, 55.100000000000485, -2.316814613494996, 12.45342692281461, 178.58114451050525, 332.36200092060716, 117.76150873367317, 140.28032177819753, 116.34547495569004, 166.99029603547785, 3.5122076252615475, 478.2265935083731, 2.0425830160168914, 208.16992849272108, 190.09629755628464, 134.80096141120092, 15.04962989867605, 92.35871243012144, 375.9115000815684, 151.82161615391325, 414.375214785727, 459.34278204615134, 720.3907363095723, 0.06615230507734893, 332.01367557728935, 239.37557044778526, 314.83215512830503, 634.5520615316982, 5.838295393369962, 120.52832478423302, 231.1185507113621, 195.39538733324204, 29.30105918759164, 28.866205020296047, 205.78388769355382, 224.58198718247013, 408.0598949115361, 89.87893315928358, 369.68442789986676, 387.5078071195132, 418.65601233789283, 190.15275598040995, 255.95227510360425, 386.4000000000018, 560.4375106051199, 284.90210909568134, 274.5610617744131, 38.20000000000027, 11.06934464418177, 358.5537192462882, 198.53879822430048, 198.28036693243325, 340.94876469634187, 550.2431739932705, 4.200000000000004, 34.551299638198856, 510.65450084730986, 47.281570281766925, 236.62916978135198, 9.0, 578.9589113207572, 114.83340791427057, 577.1561502237258, 249.58154957858545, 3.4493460395660285, 423.2910786569503, 367.39754681251225, 19.51177843453281, 75.33137216493104, 126.36259722767707, 510.0890541565877, 138.06845999252636, 34.9000000000002, 475.5192980684171, 176.0989421950513, 251.29928819035143, 0.6304953337315753, 4.942809513202335, 1.8000000000000005, 870.8017691184915, 7.899999999999983, 46.54868620393843, 569.1347534662589, 141.29160853377272, 336.2695587467911, 29.458769943347278, 233.9771350799411, 400.4333219365718, 0.19999999999998863, 9.99999999999997, 31.1, 303.0276081951836, 221.19999999999837, 424.40649721814214, 233.30148632673496, 53.08893456076086, 78.8999999999997, 271.65481554082834], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-218.6585491601147, -982.8891627358004, -674.9345113700855, -689.8696434577558, -352.9335047092639, -1035.1783600978733, 28.01083110743778, -759.5391328232622, -1413.8672939427556, -1344.7039589697472, -1330.529563117413, -1325.5631398284472, 1.74770535182862, -1333.2910796933977, 54.402224414891535, -871.1005495175158, -568.5502582839383, -1184.5272989589919, -1195.8818022627577, -87.15085723215385, -846.8709015796682, -53.60955997296274, -1157.652154439427, -2.329362365799342, -1085.1230685572466, -1421.269304296249, -1287.1531625154253, 288.5999365909596, -1266.1596142896178, -1313.1879451865868, -1353.3305802944915, -198.29630895521407, -642.9509533228451, -1137.4236741127572, -1163.662087550377, -1022.7775944711121, -1237.0438853937117, -1204.29118121423, -744.376682083079, -790.3447102400833, -1098.9310340563422, 331.9115000815684, -1101.1557312953012, -1317.1059183248867, -978.1401788387017, -738.6254213340367, 245.42704470834678, -958.8467405726144, -916.8959365759088, -535.0003099468464, -1297.046880376408, -1274.7278177984874, -273.17761411982946, -974.7599046008844, -885.1301764255303, -1326.804974752922, -808.6069927418689, -452.36462036867783, -894.802319364046, -332.6815965528713, -1470.871758869058, -1352.0215025677912, -1510.6850688178738, 21.371936520892923, -552.1716566575006, -899.5625560820528, -143.31860973684277, -954.5576196367368, -1327.2032714415707, -1214.8095940580388, -1253.1895099691826, -1382.720793278798, -688.2619208053837, -504.9368078952946, -759.1583281968844, -424.8890817987594, -616.8911164476086, -84.52154842088947, 34.04373534629382, -1087.8748549978543, -1125.7589712968736, -144.84090198858382, -691.5106262831459, 345.4624419609055, -171.86550491250682, -1231.4538959006518, -1383.966065269417, -848.7090996249308, -1288.565134989197, -165.4135304474502, 286.34521934510417, 28.506557200974505, 319.508087368387, -1093.2489778250715, -653.3519154909844, -200.23745511475497, -43.8177969185022, -326.83522523292976, -5.1224226671805315, -1520.977360387765, -1067.22017158199, -941.4171456444274, -1030.0612868589396, 13.131466140268357, -364.43204776061765, -809.8960432406478, -639.9791427994594, -848.0544351685601, -1093.5582392138292, 331.8487646963418, 137.40143856656042, -1065.7215885319351, -1273.5915400143065, -1165.7006184354573, -1511.0402987650068, -254.7875424848077, -263.3185577669505, 147.51358639793733, 5.248408761413177, -1331.929225985676, -77.15804404117254, -1033.1971690228359, -1194.4112457873698, -1376.0943182391384, -93.8767310070881, -1422.6760010939074, -1493.9424645527658, -1181.5397080135645, 11.21248689293932, -1113.3364821332766, -1134.262062750903, -2.295858863813687, -864.9854466068415, -1296.316106900659, -4.842941071505315, -946.7148059469612, 195.8723005214654, -458.0992911537832, -1215.1137975563386, -1353.2422871661463, -1196.5136519868513, -1377.7522729552268, -1195.3983794836008, -272.13675030196316, -505.08116501062716, -103.8519972520325, -1015.944809212901, -296.1009352486585, -39.346639166975585, -1417.1275512282982, -1401.3725377604549, 34.42657060604326, -900.2850619459601, 15.684169113656637, -306.3207349681157, -739.465710026769, -1415.7966280383512, -1130.929116930857, -1364.0648136324817, -1150.2921557324748, -1424.7079057355234, -1188.5978959781671, -1462.2295241124934, 257.87960527371763, -1123.8018094229367, -1147.010516099697, -632.2601027251561, -1028.4915065621651, 224.5526527493652, -1074.7618068168283, -542.0396863503903, -1134.7725915883334, -219.16855693757446, -913.631572870168, -1566.1911780831833, -726.0692283847415, -1018.3971846036566, -306.2446446502066, -931.9275797808347, -596.9412837368867, -1516.4082301611083, -1194.0337944629848, -1658.680244736944, -1071.4335389138578, -1173.8604838516192, -1311.7912998370634, -815.6361164083626, -348.3026292470406, 37.119301025066875, -303.0611322062031, 308.1824504835846, -937.1076936982564, -1077.1533010419607, -886.6060209616119, -893.8898921519392, -984.9408911410802, -640.218680399498, -1120.378257260038, -628.357818576919, -771.6174969587746], "policy_predator_policy_reward": [691.0078249880419, 840.2398240786896, 819.5002906501098, 746.9341226405883, 1081.9085712308463, 791.076005443932, 11.189168892562327, 775.4391328232654, 1407.2223145851856, 1349.032123713822, 1331.212109838436, 1337.334020030239, 599.1222138315507, 911.002305020528, 950.8423097285761, 198.21801629465395, 556.7408292595293, 1314.0982367170782, 1176.8275190373763, 246.48546223573302, 928.7626976471691, 88.06323886115271, 1162.7481705818936, 164.22364225881162, 1085.5657153542973, 1424.3388651244597, 208.8501465491767, 1267.9296728836616, 1268.1021973056347, 1313.2879451865867, 1318.3277048050584, 441.4691129373666, 868.3993097114313, 1102.0716152804564, 1154.7662199637884, 1166.4744234688992, 1250.310985902754, 1206.0737106038637, 318.3589689214088, 1308.7211358318777, 1142.931034056342, 0.0, 1342.5135464308544, 1227.5697193432466, 894.4142135870139, 1236.726601371451, 899.7566550384236, 273.00582287199563, 1343.4561013382545, 828.8308814940696, 1297.1130326814853, 1274.7278177984874, 566.1582020613916, 1013.7929922366117, 1194.0038806981797, 1257.3068409280588, 879.9109737029198, 695.8927945359316, 601.6380471241465, 1260.3979303244698, 1390.3591840910483, 1438.3723727391712, 1509.9671891978544, 99.87426788336069, 1002.1752531489107, 680.6775103020071, 1015.6425577132802, 277.62905899354115, 1409.2011018099017, 1162.1128228773011, 1209.4927224752807, 1455.2837857929974, 1313.2011261459627, 85.78149024827357, 1058.368400672756, 350.2609965053605, 732.6779731398425, 376.79458664018995, 1099.6263179186105, 44.083734892234865, 1025.8967263101076, 614.3875748752123, 710.5106262831449, 23.04536515860846, 1121.472706909196, 700.5027062418447, 1269.4584159799954, 1153.3695048947638, 1045.7997318236407, 664.1312087166119, 61.15478065489587, 10.393442799025616, 1048.6661415421777, 285.51225951962664, 601.2435483525375, 537.2479313488785, 25.94472690005811, 619.2693570257851, 43.32242266718088, 1520.977360387765, 1068.082728209546, 951.6239336610537, 1068.2300639034547, 307.2534760615064, 458.3749760791329, 914.4919131464368, 849.4337246352381, 836.880220265215, 1102.6582392138287, 0.0, 562.0374138339863, 916.5259101246555, 1274.3915400143062, 1169.1006184354542, 1511.0402987650068, 289.3388421230127, 482.11444396587814, 144.34502825044498, 42.033161520353715, 1331.929225985676, 861.655841173891, 485.3285416714696, 1203.4112457873696, 1376.0943182391384, 1019.5775127630803, 1075.934130658668, 1476.0956571152503, 1314.2199233653444, 700.4036634960697, 978.8764819679949, 732.5752000349037, 653.5642711584011, 874.1677216104887, 1290.5831779365794, 540.6721876692042, 834.1766380062099, 623.7823245523011, 5.842212892533185, 1232.8758553077446, 1354.9920078492707, 1327.880013771003, 1321.717283336007, 857.3790713666461, 736.518655646604, 457.9746023322094, 661.0476140870385, 771.9854957418277, 678.1287087122636, 74.24663916697541, 1417.1275512282982, 566.7902892908094, 1275.6749759320148, 900.9850619459603, 159.7147730813959, 0.0, 1297.0857331852376, 1414.1201737656052, 1133.2360665373346, 1368.3648136324816, 1150.9349652456772, 1424.9079057355234, 1190.197895978167, 1186.5955099526955, 888.5561780045666, 1129.9018094229366, 1148.8105160996977, 660.808788929098, 1046.4915065621624, 519.3877039694124, 899.956203564311, 486.807512292165, 1331.2963741803246, 445.99624170147706, 1023.0734468530574, 1566.1911780831833, 755.52799832809, 662.0697743627429, 896.5491899710623, 1167.762023092896, 761.5401623613984, 1516.4082301611083, 1194.2337944629849, 1660.7802447369438, 1079.3335389138506, 1204.960483851618, 1311.7912998370634, 304.27874408169487, 1162.6876097688962, 333.9674380275525, 153.17439315358234, 523.1964281218419, 530.1353123109743, 1166.198764796046, 1030.8620435342666, 834.2155254514071, 1097.7041924023727, 651.7186803994996, 1187.7782572600372, 600.5458864172383, 1071.0842446592849]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.541505302675236, "mean_inference_ms": 3.297990112277447, "mean_action_processing_ms": 1.2281711525836934, "mean_env_wait_ms": 9.782535270575487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0235060453414917, "StateBufferConnector_ms": 0.006068587303161621, "ViewRequirementAgentConnector_ms": 0.11619400978088379}, "num_episodes": 6, "episode_return_max": 870.8017691184915, "episode_return_min": -2.316814613494996, "episode_return_mean": 224.9837286932355, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.54312045277966, "num_env_steps_trained_throughput_per_sec": 83.54312045277966, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 48779.306, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48779.252, "sample_time_ms": 2132.825, "learn_time_ms": 46628.92, "learn_throughput": 85.784, "synch_weights_time_ms": 14.245}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "fed12_00000", "date": "2024-08-21_18-39-37", "timestamp": 1724245777, "time_this_iter_s": 47.91593909263611, "time_total_s": 2102.3137888908386, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f5984c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2102.3137888908386, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 24.057352941176475, "ram_util_percent": 82.29852941176469}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.305396130539123, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.776658307686054, "policy_loss": -0.021582730343348528, "vf_loss": 6.79547149567377, "vf_explained_var": 0.5203910532136443, "kl": 0.013847760729018659, "entropy": 0.865197383190589, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.52917277699425, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.419724069070564, "policy_loss": -0.01473536761539185, "vf_loss": 6.432277606025575, "vf_explained_var": 0.4939466414943574, "kl": 0.010909192767068152, "entropy": 0.5976662647156489, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 870.8017691184915, "episode_reward_min": 0.06615230507734893, "episode_reward_mean": 217.29209391926298, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1658.680244736944, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 345.4624419609055, "predator_policy": 1660.7802447369438}, "policy_reward_mean": {"prey_policy": -762.7054165655424, "predator_policy": 871.3514635251739}, "custom_metrics": {}, "hist_stats": {"episode_reward": [117.76150873367317, 140.28032177819753, 116.34547495569004, 166.99029603547785, 3.5122076252615475, 478.2265935083731, 2.0425830160168914, 208.16992849272108, 190.09629755628464, 134.80096141120092, 15.04962989867605, 92.35871243012144, 375.9115000815684, 151.82161615391325, 414.375214785727, 459.34278204615134, 720.3907363095723, 0.06615230507734893, 332.01367557728935, 239.37557044778526, 314.83215512830503, 634.5520615316982, 5.838295393369962, 120.52832478423302, 231.1185507113621, 195.39538733324204, 29.30105918759164, 28.866205020296047, 205.78388769355382, 224.58198718247013, 408.0598949115361, 89.87893315928358, 369.68442789986676, 387.5078071195132, 418.65601233789283, 190.15275598040995, 255.95227510360425, 386.4000000000018, 560.4375106051199, 284.90210909568134, 274.5610617744131, 38.20000000000027, 11.06934464418177, 358.5537192462882, 198.53879822430048, 198.28036693243325, 340.94876469634187, 550.2431739932705, 4.200000000000004, 34.551299638198856, 510.65450084730986, 47.281570281766925, 236.62916978135198, 9.0, 578.9589113207572, 114.83340791427057, 577.1561502237258, 249.58154957858545, 3.4493460395660285, 423.2910786569503, 367.39754681251225, 19.51177843453281, 75.33137216493104, 126.36259722767707, 510.0890541565877, 138.06845999252636, 34.9000000000002, 475.5192980684171, 176.0989421950513, 251.29928819035143, 0.6304953337315753, 4.942809513202335, 1.8000000000000005, 870.8017691184915, 7.899999999999983, 46.54868620393843, 569.1347534662589, 141.29160853377272, 336.2695587467911, 29.458769943347278, 233.9771350799411, 400.4333219365718, 0.19999999999998863, 9.99999999999997, 31.1, 303.0276081951836, 221.19999999999837, 424.40649721814214, 233.30148632673496, 53.08893456076086, 78.8999999999997, 271.65481554082834, 160.5451194869011, 38.93433829019746, 118.10411620956026, 291.5422604614666, 34.10457439019842, 0.3999999999999959, 72.91446275718565, 106.67431624898408], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-568.5502582839383, -1184.5272989589919, -1195.8818022627577, -87.15085723215385, -846.8709015796682, -53.60955997296274, -1157.652154439427, -2.329362365799342, -1085.1230685572466, -1421.269304296249, -1287.1531625154253, 288.5999365909596, -1266.1596142896178, -1313.1879451865868, -1353.3305802944915, -198.29630895521407, -642.9509533228451, -1137.4236741127572, -1163.662087550377, -1022.7775944711121, -1237.0438853937117, -1204.29118121423, -744.376682083079, -790.3447102400833, -1098.9310340563422, 331.9115000815684, -1101.1557312953012, -1317.1059183248867, -978.1401788387017, -738.6254213340367, 245.42704470834678, -958.8467405726144, -916.8959365759088, -535.0003099468464, -1297.046880376408, -1274.7278177984874, -273.17761411982946, -974.7599046008844, -885.1301764255303, -1326.804974752922, -808.6069927418689, -452.36462036867783, -894.802319364046, -332.6815965528713, -1470.871758869058, -1352.0215025677912, -1510.6850688178738, 21.371936520892923, -552.1716566575006, -899.5625560820528, -143.31860973684277, -954.5576196367368, -1327.2032714415707, -1214.8095940580388, -1253.1895099691826, -1382.720793278798, -688.2619208053837, -504.9368078952946, -759.1583281968844, -424.8890817987594, -616.8911164476086, -84.52154842088947, 34.04373534629382, -1087.8748549978543, -1125.7589712968736, -144.84090198858382, -691.5106262831459, 345.4624419609055, -171.86550491250682, -1231.4538959006518, -1383.966065269417, -848.7090996249308, -1288.565134989197, -165.4135304474502, 286.34521934510417, 28.506557200974505, 319.508087368387, -1093.2489778250715, -653.3519154909844, -200.23745511475497, -43.8177969185022, -326.83522523292976, -5.1224226671805315, -1520.977360387765, -1067.22017158199, -941.4171456444274, -1030.0612868589396, 13.131466140268357, -364.43204776061765, -809.8960432406478, -639.9791427994594, -848.0544351685601, -1093.5582392138292, 331.8487646963418, 137.40143856656042, -1065.7215885319351, -1273.5915400143065, -1165.7006184354573, -1511.0402987650068, -254.7875424848077, -263.3185577669505, 147.51358639793733, 5.248408761413177, -1331.929225985676, -77.15804404117254, -1033.1971690228359, -1194.4112457873698, -1376.0943182391384, -93.8767310070881, -1422.6760010939074, -1493.9424645527658, -1181.5397080135645, 11.21248689293932, -1113.3364821332766, -1134.262062750903, -2.295858863813687, -864.9854466068415, -1296.316106900659, -4.842941071505315, -946.7148059469612, 195.8723005214654, -458.0992911537832, -1215.1137975563386, -1353.2422871661463, -1196.5136519868513, -1377.7522729552268, -1195.3983794836008, -272.13675030196316, -505.08116501062716, -103.8519972520325, -1015.944809212901, -296.1009352486585, -39.346639166975585, -1417.1275512282982, -1401.3725377604549, 34.42657060604326, -900.2850619459601, 15.684169113656637, -306.3207349681157, -739.465710026769, -1415.7966280383512, -1130.929116930857, -1364.0648136324817, -1150.2921557324748, -1424.7079057355234, -1188.5978959781671, -1462.2295241124934, 257.87960527371763, -1123.8018094229367, -1147.010516099697, -632.2601027251561, -1028.4915065621651, 224.5526527493652, -1074.7618068168283, -542.0396863503903, -1134.7725915883334, -219.16855693757446, -913.631572870168, -1566.1911780831833, -726.0692283847415, -1018.3971846036566, -306.2446446502066, -931.9275797808347, -596.9412837368867, -1516.4082301611083, -1194.0337944629848, -1658.680244736944, -1071.4335389138578, -1173.8604838516192, -1311.7912998370634, -815.6361164083626, -348.3026292470406, 37.119301025066875, -303.0611322062031, 308.1824504835846, -937.1076936982564, -1077.1533010419607, -886.6060209616119, -893.8898921519392, -984.9408911410802, -640.218680399498, -1120.378257260038, -628.357818576919, -771.6174969587746, -1314.408239790442, -504.40183842844283, -757.9179257417096, 17.69058039972803, -434.3767846148213, -1250.4549993119979, -700.9312836581192, -1304.052272603099, -1135.2847358642348, -792.1602740023965, -1212.2861545343453, -1287.0771179739775, 3.5340405442910767, -583.2173705597156, -82.67067210827584, -450.9146720622541], "policy_predator_policy_reward": [556.7408292595293, 1314.0982367170782, 1176.8275190373763, 246.48546223573302, 928.7626976471691, 88.06323886115271, 1162.7481705818936, 164.22364225881162, 1085.5657153542973, 1424.3388651244597, 208.8501465491767, 1267.9296728836616, 1268.1021973056347, 1313.2879451865867, 1318.3277048050584, 441.4691129373666, 868.3993097114313, 1102.0716152804564, 1154.7662199637884, 1166.4744234688992, 1250.310985902754, 1206.0737106038637, 318.3589689214088, 1308.7211358318777, 1142.931034056342, 0.0, 1342.5135464308544, 1227.5697193432466, 894.4142135870139, 1236.726601371451, 899.7566550384236, 273.00582287199563, 1343.4561013382545, 828.8308814940696, 1297.1130326814853, 1274.7278177984874, 566.1582020613916, 1013.7929922366117, 1194.0038806981797, 1257.3068409280588, 879.9109737029198, 695.8927945359316, 601.6380471241465, 1260.3979303244698, 1390.3591840910483, 1438.3723727391712, 1509.9671891978544, 99.87426788336069, 1002.1752531489107, 680.6775103020071, 1015.6425577132802, 277.62905899354115, 1409.2011018099017, 1162.1128228773011, 1209.4927224752807, 1455.2837857929974, 1313.2011261459627, 85.78149024827357, 1058.368400672756, 350.2609965053605, 732.6779731398425, 376.79458664018995, 1099.6263179186105, 44.083734892234865, 1025.8967263101076, 614.3875748752123, 710.5106262831449, 23.04536515860846, 1121.472706909196, 700.5027062418447, 1269.4584159799954, 1153.3695048947638, 1045.7997318236407, 664.1312087166119, 61.15478065489587, 10.393442799025616, 1048.6661415421777, 285.51225951962664, 601.2435483525375, 537.2479313488785, 25.94472690005811, 619.2693570257851, 43.32242266718088, 1520.977360387765, 1068.082728209546, 951.6239336610537, 1068.2300639034547, 307.2534760615064, 458.3749760791329, 914.4919131464368, 849.4337246352381, 836.880220265215, 1102.6582392138287, 0.0, 562.0374138339863, 916.5259101246555, 1274.3915400143062, 1169.1006184354542, 1511.0402987650068, 289.3388421230127, 482.11444396587814, 144.34502825044498, 42.033161520353715, 1331.929225985676, 861.655841173891, 485.3285416714696, 1203.4112457873696, 1376.0943182391384, 1019.5775127630803, 1075.934130658668, 1476.0956571152503, 1314.2199233653444, 700.4036634960697, 978.8764819679949, 732.5752000349037, 653.5642711584011, 874.1677216104887, 1290.5831779365794, 540.6721876692042, 834.1766380062099, 623.7823245523011, 5.842212892533185, 1232.8758553077446, 1354.9920078492707, 1327.880013771003, 1321.717283336007, 857.3790713666461, 736.518655646604, 457.9746023322094, 661.0476140870385, 771.9854957418277, 678.1287087122636, 74.24663916697541, 1417.1275512282982, 566.7902892908094, 1275.6749759320148, 900.9850619459603, 159.7147730813959, 0.0, 1297.0857331852376, 1414.1201737656052, 1133.2360665373346, 1368.3648136324816, 1150.9349652456772, 1424.9079057355234, 1190.197895978167, 1186.5955099526955, 888.5561780045666, 1129.9018094229366, 1148.8105160996977, 660.808788929098, 1046.4915065621624, 519.3877039694124, 899.956203564311, 486.807512292165, 1331.2963741803246, 445.99624170147706, 1023.0734468530574, 1566.1911780831833, 755.52799832809, 662.0697743627429, 896.5491899710623, 1167.762023092896, 761.5401623613984, 1516.4082301611083, 1194.2337944629849, 1660.7802447369438, 1079.3335389138506, 1204.960483851618, 1311.7912998370634, 304.27874408169487, 1162.6876097688962, 333.9674380275525, 153.17439315358234, 523.1964281218419, 530.1353123109743, 1166.198764796046, 1030.8620435342666, 834.2155254514071, 1097.7041924023727, 651.7186803994996, 1187.7782572600372, 600.5458864172383, 1071.0842446592849, 724.6160080437796, 1254.7391896620059, 763.2179257417095, 15.943757890469112, 652.9556409688612, 1149.9802591675248, 947.1340552718852, 1349.391761450797, 1079.649410353235, 881.9001739036015, 1212.2861545343453, 1287.4771179739776, 52.56731957268012, 600.0304731999317, 179.85707534911796, 460.40258507039744]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5328473492122527, "mean_inference_ms": 3.2898245258725547, "mean_action_processing_ms": 1.2335069564571106, "mean_env_wait_ms": 9.792436810019385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023562073707580566, "StateBufferConnector_ms": 0.006060957908630371, "ViewRequirementAgentConnector_ms": 0.11639249324798584}, "num_episodes": 8, "episode_return_max": 870.8017691184915, "episode_return_min": 0.06615230507734893, "episode_return_mean": 217.29209391926298, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.00766672331882, "num_env_steps_trained_throughput_per_sec": 83.00766672331882, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 48720.326, "restore_workers_time_ms": 0.016, "training_step_time_ms": 48720.27, "sample_time_ms": 2138.373, "learn_time_ms": 46565.076, "learn_throughput": 85.901, "synch_weights_time_ms": 13.758}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "fed12_00000", "date": "2024-08-21_18-40-26", "timestamp": 1724245826, "time_this_iter_s": 48.19972515106201, "time_total_s": 2150.5135140419006, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4ce5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2150.5135140419006, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 25.05441176470588, "ram_util_percent": 82.18823529411762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.670108901255976, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.409281213447531, "policy_loss": -0.021834110756892535, "vf_loss": 6.428145286519691, "vf_explained_var": 0.5869769340154355, "kl": 0.014850165524948684, "entropy": 0.8824722378026871, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.356309187601482, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.860412173800999, "policy_loss": -0.01299459292274954, "vf_loss": 5.871258713959386, "vf_explained_var": 0.5130360834182255, "kl": 0.01074026765082544, "entropy": 0.6796541588331656, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 870.8017691184915, "episode_reward_min": 0.06615230507734893, "episode_reward_mean": 216.91888110040597, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1658.680244736944, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 345.4624419609055, "predator_policy": 1660.7802447369438}, "policy_reward_mean": {"prey_policy": -755.0910124938492, "predator_policy": 863.5504530440522}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.35871243012144, 375.9115000815684, 151.82161615391325, 414.375214785727, 459.34278204615134, 720.3907363095723, 0.06615230507734893, 332.01367557728935, 239.37557044778526, 314.83215512830503, 634.5520615316982, 5.838295393369962, 120.52832478423302, 231.1185507113621, 195.39538733324204, 29.30105918759164, 28.866205020296047, 205.78388769355382, 224.58198718247013, 408.0598949115361, 89.87893315928358, 369.68442789986676, 387.5078071195132, 418.65601233789283, 190.15275598040995, 255.95227510360425, 386.4000000000018, 560.4375106051199, 284.90210909568134, 274.5610617744131, 38.20000000000027, 11.06934464418177, 358.5537192462882, 198.53879822430048, 198.28036693243325, 340.94876469634187, 550.2431739932705, 4.200000000000004, 34.551299638198856, 510.65450084730986, 47.281570281766925, 236.62916978135198, 9.0, 578.9589113207572, 114.83340791427057, 577.1561502237258, 249.58154957858545, 3.4493460395660285, 423.2910786569503, 367.39754681251225, 19.51177843453281, 75.33137216493104, 126.36259722767707, 510.0890541565877, 138.06845999252636, 34.9000000000002, 475.5192980684171, 176.0989421950513, 251.29928819035143, 0.6304953337315753, 4.942809513202335, 1.8000000000000005, 870.8017691184915, 7.899999999999983, 46.54868620393843, 569.1347534662589, 141.29160853377272, 336.2695587467911, 29.458769943347278, 233.9771350799411, 400.4333219365718, 0.19999999999998863, 9.99999999999997, 31.1, 303.0276081951836, 221.19999999999837, 424.40649721814214, 233.30148632673496, 53.08893456076086, 78.8999999999997, 271.65481554082834, 160.5451194869011, 38.93433829019746, 118.10411620956026, 291.5422604614666, 34.10457439019842, 0.3999999999999959, 72.91446275718565, 106.67431624898408, 267.7414355259328, 25.400000000000148, 449.78240951278434, 131.58412669666998, 17.901761607665748, 247.74428563367744, 92.8697797915813, 58.228103496477544, 24.28803699831049, 184.90000000000006, 35.51458186276672], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-744.376682083079, -790.3447102400833, -1098.9310340563422, 331.9115000815684, -1101.1557312953012, -1317.1059183248867, -978.1401788387017, -738.6254213340367, 245.42704470834678, -958.8467405726144, -916.8959365759088, -535.0003099468464, -1297.046880376408, -1274.7278177984874, -273.17761411982946, -974.7599046008844, -885.1301764255303, -1326.804974752922, -808.6069927418689, -452.36462036867783, -894.802319364046, -332.6815965528713, -1470.871758869058, -1352.0215025677912, -1510.6850688178738, 21.371936520892923, -552.1716566575006, -899.5625560820528, -143.31860973684277, -954.5576196367368, -1327.2032714415707, -1214.8095940580388, -1253.1895099691826, -1382.720793278798, -688.2619208053837, -504.9368078952946, -759.1583281968844, -424.8890817987594, -616.8911164476086, -84.52154842088947, 34.04373534629382, -1087.8748549978543, -1125.7589712968736, -144.84090198858382, -691.5106262831459, 345.4624419609055, -171.86550491250682, -1231.4538959006518, -1383.966065269417, -848.7090996249308, -1288.565134989197, -165.4135304474502, 286.34521934510417, 28.506557200974505, 319.508087368387, -1093.2489778250715, -653.3519154909844, -200.23745511475497, -43.8177969185022, -326.83522523292976, -5.1224226671805315, -1520.977360387765, -1067.22017158199, -941.4171456444274, -1030.0612868589396, 13.131466140268357, -364.43204776061765, -809.8960432406478, -639.9791427994594, -848.0544351685601, -1093.5582392138292, 331.8487646963418, 137.40143856656042, -1065.7215885319351, -1273.5915400143065, -1165.7006184354573, -1511.0402987650068, -254.7875424848077, -263.3185577669505, 147.51358639793733, 5.248408761413177, -1331.929225985676, -77.15804404117254, -1033.1971690228359, -1194.4112457873698, -1376.0943182391384, -93.8767310070881, -1422.6760010939074, -1493.9424645527658, -1181.5397080135645, 11.21248689293932, -1113.3364821332766, -1134.262062750903, -2.295858863813687, -864.9854466068415, -1296.316106900659, -4.842941071505315, -946.7148059469612, 195.8723005214654, -458.0992911537832, -1215.1137975563386, -1353.2422871661463, -1196.5136519868513, -1377.7522729552268, -1195.3983794836008, -272.13675030196316, -505.08116501062716, -103.8519972520325, -1015.944809212901, -296.1009352486585, -39.346639166975585, -1417.1275512282982, -1401.3725377604549, 34.42657060604326, -900.2850619459601, 15.684169113656637, -306.3207349681157, -739.465710026769, -1415.7966280383512, -1130.929116930857, -1364.0648136324817, -1150.2921557324748, -1424.7079057355234, -1188.5978959781671, -1462.2295241124934, 257.87960527371763, -1123.8018094229367, -1147.010516099697, -632.2601027251561, -1028.4915065621651, 224.5526527493652, -1074.7618068168283, -542.0396863503903, -1134.7725915883334, -219.16855693757446, -913.631572870168, -1566.1911780831833, -726.0692283847415, -1018.3971846036566, -306.2446446502066, -931.9275797808347, -596.9412837368867, -1516.4082301611083, -1194.0337944629848, -1658.680244736944, -1071.4335389138578, -1173.8604838516192, -1311.7912998370634, -815.6361164083626, -348.3026292470406, 37.119301025066875, -303.0611322062031, 308.1824504835846, -937.1076936982564, -1077.1533010419607, -886.6060209616119, -893.8898921519392, -984.9408911410802, -640.218680399498, -1120.378257260038, -628.357818576919, -771.6174969587746, -1314.408239790442, -504.40183842844283, -757.9179257417096, 17.69058039972803, -434.3767846148213, -1250.4549993119979, -700.9312836581192, -1304.052272603099, -1135.2847358642348, -792.1602740023965, -1212.2861545343453, -1287.0771179739775, 3.5340405442910767, -583.2173705597156, -82.67067210827584, -450.9146720622541, -1201.6762022326284, -765.1916053757643, -1531.9921366963033, -195.25174097963608, -83.2581043489381, -1178.8996892321513, -15.689465088975787, -637.5334987399945, -1214.504382947065, -946.0633710743152, -1210.3363159023663, -317.6380146038007, -624.0456023036172, -715.1018169936086, -185.94309156928733, -1023.0693430164742, -947.4809367629523, -1111.5340692189213, -411.2829576108177, -1036.6627492191515, -1199.025000928508, -1065.5807094807092], "policy_predator_policy_reward": [318.3589689214088, 1308.7211358318777, 1142.931034056342, 0.0, 1342.5135464308544, 1227.5697193432466, 894.4142135870139, 1236.726601371451, 899.7566550384236, 273.00582287199563, 1343.4561013382545, 828.8308814940696, 1297.1130326814853, 1274.7278177984874, 566.1582020613916, 1013.7929922366117, 1194.0038806981797, 1257.3068409280588, 879.9109737029198, 695.8927945359316, 601.6380471241465, 1260.3979303244698, 1390.3591840910483, 1438.3723727391712, 1509.9671891978544, 99.87426788336069, 1002.1752531489107, 680.6775103020071, 1015.6425577132802, 277.62905899354115, 1409.2011018099017, 1162.1128228773011, 1209.4927224752807, 1455.2837857929974, 1313.2011261459627, 85.78149024827357, 1058.368400672756, 350.2609965053605, 732.6779731398425, 376.79458664018995, 1099.6263179186105, 44.083734892234865, 1025.8967263101076, 614.3875748752123, 710.5106262831449, 23.04536515860846, 1121.472706909196, 700.5027062418447, 1269.4584159799954, 1153.3695048947638, 1045.7997318236407, 664.1312087166119, 61.15478065489587, 10.393442799025616, 1048.6661415421777, 285.51225951962664, 601.2435483525375, 537.2479313488785, 25.94472690005811, 619.2693570257851, 43.32242266718088, 1520.977360387765, 1068.082728209546, 951.6239336610537, 1068.2300639034547, 307.2534760615064, 458.3749760791329, 914.4919131464368, 849.4337246352381, 836.880220265215, 1102.6582392138287, 0.0, 562.0374138339863, 916.5259101246555, 1274.3915400143062, 1169.1006184354542, 1511.0402987650068, 289.3388421230127, 482.11444396587814, 144.34502825044498, 42.033161520353715, 1331.929225985676, 861.655841173891, 485.3285416714696, 1203.4112457873696, 1376.0943182391384, 1019.5775127630803, 1075.934130658668, 1476.0956571152503, 1314.2199233653444, 700.4036634960697, 978.8764819679949, 732.5752000349037, 653.5642711584011, 874.1677216104887, 1290.5831779365794, 540.6721876692042, 834.1766380062099, 623.7823245523011, 5.842212892533185, 1232.8758553077446, 1354.9920078492707, 1327.880013771003, 1321.717283336007, 857.3790713666461, 736.518655646604, 457.9746023322094, 661.0476140870385, 771.9854957418277, 678.1287087122636, 74.24663916697541, 1417.1275512282982, 566.7902892908094, 1275.6749759320148, 900.9850619459603, 159.7147730813959, 0.0, 1297.0857331852376, 1414.1201737656052, 1133.2360665373346, 1368.3648136324816, 1150.9349652456772, 1424.9079057355234, 1190.197895978167, 1186.5955099526955, 888.5561780045666, 1129.9018094229366, 1148.8105160996977, 660.808788929098, 1046.4915065621624, 519.3877039694124, 899.956203564311, 486.807512292165, 1331.2963741803246, 445.99624170147706, 1023.0734468530574, 1566.1911780831833, 755.52799832809, 662.0697743627429, 896.5491899710623, 1167.762023092896, 761.5401623613984, 1516.4082301611083, 1194.2337944629849, 1660.7802447369438, 1079.3335389138506, 1204.960483851618, 1311.7912998370634, 304.27874408169487, 1162.6876097688962, 333.9674380275525, 153.17439315358234, 523.1964281218419, 530.1353123109743, 1166.198764796046, 1030.8620435342666, 834.2155254514071, 1097.7041924023727, 651.7186803994996, 1187.7782572600372, 600.5458864172383, 1071.0842446592849, 724.6160080437796, 1254.7391896620059, 763.2179257417095, 15.943757890469112, 652.9556409688612, 1149.9802591675248, 947.1340552718852, 1349.391761450797, 1079.649410353235, 881.9001739036015, 1212.2861545343453, 1287.4771179739776, 52.56731957268012, 600.0304731999317, 179.85707534911796, 460.40258507039744, 1163.4956779941083, 1071.1135651402185, 1531.9921366963033, 220.6517409796356, 572.7512770196282, 1139.1889260742391, 772.6833651565724, 12.123725369070263, 1274.006213872986, 904.4633017560586, 1187.3026745759264, 588.4159415639223, 969.7856895185018, 462.2315095703089, 418.8743377853793, 848.366200296857, 763.7897911524165, 1319.5132518277655, 573.5829576108185, 1059.2627492191514, 1140.4995260892335, 1159.6207661827464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5356606100510235, "mean_inference_ms": 3.28965706480131, "mean_action_processing_ms": 1.2259182868846272, "mean_env_wait_ms": 9.79010403873353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02347588539123535, "StateBufferConnector_ms": 0.00602567195892334, "ViewRequirementAgentConnector_ms": 0.11883544921875}, "num_episodes": 11, "episode_return_max": 870.8017691184915, "episode_return_min": 0.06615230507734893, "episode_return_mean": 216.91888110040597, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.79997737872742, "num_env_steps_trained_throughput_per_sec": 82.79997737872742, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 48676.645, "restore_workers_time_ms": 0.016, "training_step_time_ms": 48676.561, "sample_time_ms": 2136.765, "learn_time_ms": 46522.56, "learn_throughput": 85.98, "synch_weights_time_ms": 14.051}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "fed12_00000", "date": "2024-08-21_18-41-14", "timestamp": 1724245874, "time_this_iter_s": 48.35413694381714, "time_total_s": 2198.867650985718, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f3170d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2198.867650985718, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 24.772058823529417, "ram_util_percent": 82.26617647058822}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.402371803351812, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.441403528496071, "policy_loss": -0.02548733347098013, "vf_loss": 6.4634472153174185, "vf_explained_var": 0.5836350537481763, "kl": 0.01721824314124961, "entropy": 0.9029892683029175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.849524639397071, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.493701175154833, "policy_loss": -0.013202927145545208, "vf_loss": 6.504501238827983, "vf_explained_var": 0.4817794187674447, "kl": 0.01201435472611732, "entropy": 0.645157910970153, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 1007.2290167894506, "episode_reward_min": 0.19999999999998863, "episode_reward_mean": 214.6874829668109, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1658.680244736944, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 345.4624419609055, "predator_policy": 1660.7802447369438}, "policy_reward_mean": {"prey_policy": -700.2535279351846, "predator_policy": 807.5972694185901}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.866205020296047, 205.78388769355382, 224.58198718247013, 408.0598949115361, 89.87893315928358, 369.68442789986676, 387.5078071195132, 418.65601233789283, 190.15275598040995, 255.95227510360425, 386.4000000000018, 560.4375106051199, 284.90210909568134, 274.5610617744131, 38.20000000000027, 11.06934464418177, 358.5537192462882, 198.53879822430048, 198.28036693243325, 340.94876469634187, 550.2431739932705, 4.200000000000004, 34.551299638198856, 510.65450084730986, 47.281570281766925, 236.62916978135198, 9.0, 578.9589113207572, 114.83340791427057, 577.1561502237258, 249.58154957858545, 3.4493460395660285, 423.2910786569503, 367.39754681251225, 19.51177843453281, 75.33137216493104, 126.36259722767707, 510.0890541565877, 138.06845999252636, 34.9000000000002, 475.5192980684171, 176.0989421950513, 251.29928819035143, 0.6304953337315753, 4.942809513202335, 1.8000000000000005, 870.8017691184915, 7.899999999999983, 46.54868620393843, 569.1347534662589, 141.29160853377272, 336.2695587467911, 29.458769943347278, 233.9771350799411, 400.4333219365718, 0.19999999999998863, 9.99999999999997, 31.1, 303.0276081951836, 221.19999999999837, 424.40649721814214, 233.30148632673496, 53.08893456076086, 78.8999999999997, 271.65481554082834, 160.5451194869011, 38.93433829019746, 118.10411620956026, 291.5422604614666, 34.10457439019842, 0.3999999999999959, 72.91446275718565, 106.67431624898408, 267.7414355259328, 25.400000000000148, 449.78240951278434, 131.58412669666998, 17.901761607665748, 247.74428563367744, 92.8697797915813, 58.228103496477544, 24.28803699831049, 184.90000000000006, 35.51458186276672, 2.300000000000013, 333.2533463710207, 176.58461985232051, 301.9223791098314, 267.8999999999994, 401.551940800595, 511.6392503765653, 10.048476038482693, 99.48716063268546, 1007.2290167894506, 135.09359353923298, 72.75843523174174, 257.39999999999725, 26.768271899214426, 175.96312457953053, 314.18236562683614], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1253.1895099691826, -1382.720793278798, -688.2619208053837, -504.9368078952946, -759.1583281968844, -424.8890817987594, -616.8911164476086, -84.52154842088947, 34.04373534629382, -1087.8748549978543, -1125.7589712968736, -144.84090198858382, -691.5106262831459, 345.4624419609055, -171.86550491250682, -1231.4538959006518, -1383.966065269417, -848.7090996249308, -1288.565134989197, -165.4135304474502, 286.34521934510417, 28.506557200974505, 319.508087368387, -1093.2489778250715, -653.3519154909844, -200.23745511475497, -43.8177969185022, -326.83522523292976, -5.1224226671805315, -1520.977360387765, -1067.22017158199, -941.4171456444274, -1030.0612868589396, 13.131466140268357, -364.43204776061765, -809.8960432406478, -639.9791427994594, -848.0544351685601, -1093.5582392138292, 331.8487646963418, 137.40143856656042, -1065.7215885319351, -1273.5915400143065, -1165.7006184354573, -1511.0402987650068, -254.7875424848077, -263.3185577669505, 147.51358639793733, 5.248408761413177, -1331.929225985676, -77.15804404117254, -1033.1971690228359, -1194.4112457873698, -1376.0943182391384, -93.8767310070881, -1422.6760010939074, -1493.9424645527658, -1181.5397080135645, 11.21248689293932, -1113.3364821332766, -1134.262062750903, -2.295858863813687, -864.9854466068415, -1296.316106900659, -4.842941071505315, -946.7148059469612, 195.8723005214654, -458.0992911537832, -1215.1137975563386, -1353.2422871661463, -1196.5136519868513, -1377.7522729552268, -1195.3983794836008, -272.13675030196316, -505.08116501062716, -103.8519972520325, -1015.944809212901, -296.1009352486585, -39.346639166975585, -1417.1275512282982, -1401.3725377604549, 34.42657060604326, -900.2850619459601, 15.684169113656637, -306.3207349681157, -739.465710026769, -1415.7966280383512, -1130.929116930857, -1364.0648136324817, -1150.2921557324748, -1424.7079057355234, -1188.5978959781671, -1462.2295241124934, 257.87960527371763, -1123.8018094229367, -1147.010516099697, -632.2601027251561, -1028.4915065621651, 224.5526527493652, -1074.7618068168283, -542.0396863503903, -1134.7725915883334, -219.16855693757446, -913.631572870168, -1566.1911780831833, -726.0692283847415, -1018.3971846036566, -306.2446446502066, -931.9275797808347, -596.9412837368867, -1516.4082301611083, -1194.0337944629848, -1658.680244736944, -1071.4335389138578, -1173.8604838516192, -1311.7912998370634, -815.6361164083626, -348.3026292470406, 37.119301025066875, -303.0611322062031, 308.1824504835846, -937.1076936982564, -1077.1533010419607, -886.6060209616119, -893.8898921519392, -984.9408911410802, -640.218680399498, -1120.378257260038, -628.357818576919, -771.6174969587746, -1314.408239790442, -504.40183842844283, -757.9179257417096, 17.69058039972803, -434.3767846148213, -1250.4549993119979, -700.9312836581192, -1304.052272603099, -1135.2847358642348, -792.1602740023965, -1212.2861545343453, -1287.0771179739775, 3.5340405442910767, -583.2173705597156, -82.67067210827584, -450.9146720622541, -1201.6762022326284, -765.1916053757643, -1531.9921366963033, -195.25174097963608, -83.2581043489381, -1178.8996892321513, -15.689465088975787, -637.5334987399945, -1214.504382947065, -946.0633710743152, -1210.3363159023663, -317.6380146038007, -624.0456023036172, -715.1018169936086, -185.94309156928733, -1023.0693430164742, -947.4809367629523, -1111.5340692189213, -411.2829576108177, -1036.6627492191515, -1199.025000928508, -1065.5807094807092, -1437.1832942176234, -1191.111222787449, -160.9939993194212, -765.9582968390304, -460.66329807400075, -1079.8416200925328, -61.58722756372512, -402.1332758459119, -65.29554844553638, -546.6910820458232, -112.14698799124616, -561.9351566475075, -523.9748003215647, -131.8561737291367, -1055.5220963744177, -1249.1886943632876, -337.84461106437277, 24.74859909200553, 320.04160377569724, -1271.2727955049293, -528.46439501323, -714.9950701665633, 3.3669613280096287, -106.6685824097909, 30.735580107043464, 196.63629866566225, -498.8963519766779, -582.5976433807028, -402.8783839322321, -786.1565650091836, -139.9978371262155, -958.1938379193601], "policy_predator_policy_reward": [1209.4927224752807, 1455.2837857929974, 1313.2011261459627, 85.78149024827357, 1058.368400672756, 350.2609965053605, 732.6779731398425, 376.79458664018995, 1099.6263179186105, 44.083734892234865, 1025.8967263101076, 614.3875748752123, 710.5106262831449, 23.04536515860846, 1121.472706909196, 700.5027062418447, 1269.4584159799954, 1153.3695048947638, 1045.7997318236407, 664.1312087166119, 61.15478065489587, 10.393442799025616, 1048.6661415421777, 285.51225951962664, 601.2435483525375, 537.2479313488785, 25.94472690005811, 619.2693570257851, 43.32242266718088, 1520.977360387765, 1068.082728209546, 951.6239336610537, 1068.2300639034547, 307.2534760615064, 458.3749760791329, 914.4919131464368, 849.4337246352381, 836.880220265215, 1102.6582392138287, 0.0, 562.0374138339863, 916.5259101246555, 1274.3915400143062, 1169.1006184354542, 1511.0402987650068, 289.3388421230127, 482.11444396587814, 144.34502825044498, 42.033161520353715, 1331.929225985676, 861.655841173891, 485.3285416714696, 1203.4112457873696, 1376.0943182391384, 1019.5775127630803, 1075.934130658668, 1476.0956571152503, 1314.2199233653444, 700.4036634960697, 978.8764819679949, 732.5752000349037, 653.5642711584011, 874.1677216104887, 1290.5831779365794, 540.6721876692042, 834.1766380062099, 623.7823245523011, 5.842212892533185, 1232.8758553077446, 1354.9920078492707, 1327.880013771003, 1321.717283336007, 857.3790713666461, 736.518655646604, 457.9746023322094, 661.0476140870385, 771.9854957418277, 678.1287087122636, 74.24663916697541, 1417.1275512282982, 566.7902892908094, 1275.6749759320148, 900.9850619459603, 159.7147730813959, 0.0, 1297.0857331852376, 1414.1201737656052, 1133.2360665373346, 1368.3648136324816, 1150.9349652456772, 1424.9079057355234, 1190.197895978167, 1186.5955099526955, 888.5561780045666, 1129.9018094229366, 1148.8105160996977, 660.808788929098, 1046.4915065621624, 519.3877039694124, 899.956203564311, 486.807512292165, 1331.2963741803246, 445.99624170147706, 1023.0734468530574, 1566.1911780831833, 755.52799832809, 662.0697743627429, 896.5491899710623, 1167.762023092896, 761.5401623613984, 1516.4082301611083, 1194.2337944629849, 1660.7802447369438, 1079.3335389138506, 1204.960483851618, 1311.7912998370634, 304.27874408169487, 1162.6876097688962, 333.9674380275525, 153.17439315358234, 523.1964281218419, 530.1353123109743, 1166.198764796046, 1030.8620435342666, 834.2155254514071, 1097.7041924023727, 651.7186803994996, 1187.7782572600372, 600.5458864172383, 1071.0842446592849, 724.6160080437796, 1254.7391896620059, 763.2179257417095, 15.943757890469112, 652.9556409688612, 1149.9802591675248, 947.1340552718852, 1349.391761450797, 1079.649410353235, 881.9001739036015, 1212.2861545343453, 1287.4771179739776, 52.56731957268012, 600.0304731999317, 179.85707534911796, 460.40258507039744, 1163.4956779941083, 1071.1135651402185, 1531.9921366963033, 220.6517409796356, 572.7512770196282, 1139.1889260742391, 772.6833651565724, 12.123725369070263, 1274.006213872986, 904.4633017560586, 1187.3026745759264, 588.4159415639223, 969.7856895185018, 462.2315095703089, 418.8743377853793, 848.366200296857, 763.7897911524165, 1319.5132518277655, 573.5829576108185, 1059.2627492191514, 1140.4995260892335, 1159.6207661827464, 1439.1832942176234, 1191.4112227874487, 954.0325699555588, 306.1730725739099, 796.863859423072, 920.2256785957741, 737.7056136453003, 27.937268874170897, 318.1955484455366, 561.6910820458266, 319.14290306125514, 756.4911823780948, 513.5439829002023, 653.9262415270639, 1086.5002428899606, 1228.2590238862226, 361.2446110643781, 51.338561540681596, 1002.2403775200102, 956.2198309986692, 1240.3901325980837, 138.16292612094836, 37.2914739037322, 138.76858240978908, 30.028121227293557, 0.0, 515.8991715435602, 592.3630957130425, 285.1400764086179, 1079.857997112331, 461.1356829703768, 951.2383577020339]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5296259053026633, "mean_inference_ms": 3.2835883789154248, "mean_action_processing_ms": 1.2243643342413748, "mean_env_wait_ms": 9.81044971416361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02340841293334961, "StateBufferConnector_ms": 0.005151271820068359, "ViewRequirementAgentConnector_ms": 0.13268530368804932}, "num_episodes": 16, "episode_return_max": 1007.2290167894506, "episode_return_min": 0.19999999999998863, "episode_return_mean": 214.6874829668109, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.88940622979072, "num_env_steps_trained_throughput_per_sec": 81.88940622979072, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 48615.641, "restore_workers_time_ms": 0.016, "training_step_time_ms": 48615.558, "sample_time_ms": 2124.319, "learn_time_ms": 46474.143, "learn_throughput": 86.069, "synch_weights_time_ms": 13.861}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "fed12_00000", "date": "2024-08-21_18-42-03", "timestamp": 1724245923, "time_this_iter_s": 48.89453315734863, "time_total_s": 2247.7621841430664, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4cdca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2247.7621841430664, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 25.1, "ram_util_percent": 82.45797101449276}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.388485962373238, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.362847046372751, "policy_loss": -0.021339581421916446, "vf_loss": 7.381421821331852, "vf_explained_var": 0.576980325532338, "kl": 0.01382409030677524, "entropy": 0.839505694183723, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.19046756861702, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.275907544484214, "policy_loss": -0.01399773241947134, "vf_loss": 7.287162575898347, "vf_explained_var": 0.420700009821584, "kl": 0.013713453699361592, "entropy": 0.5408156464970301, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 1007.2290167894506, "episode_reward_min": 0.19999999999998863, "episode_reward_mean": 205.87047021445724, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1658.680244736944, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 331.8487646963418, "predator_policy": 1660.7802447369438}, "policy_reward_mean": {"prey_policy": -705.5568962946464, "predator_policy": 808.4921314018752}, "custom_metrics": {}, "hist_stats": {"episode_reward": [284.90210909568134, 274.5610617744131, 38.20000000000027, 11.06934464418177, 358.5537192462882, 198.53879822430048, 198.28036693243325, 340.94876469634187, 550.2431739932705, 4.200000000000004, 34.551299638198856, 510.65450084730986, 47.281570281766925, 236.62916978135198, 9.0, 578.9589113207572, 114.83340791427057, 577.1561502237258, 249.58154957858545, 3.4493460395660285, 423.2910786569503, 367.39754681251225, 19.51177843453281, 75.33137216493104, 126.36259722767707, 510.0890541565877, 138.06845999252636, 34.9000000000002, 475.5192980684171, 176.0989421950513, 251.29928819035143, 0.6304953337315753, 4.942809513202335, 1.8000000000000005, 870.8017691184915, 7.899999999999983, 46.54868620393843, 569.1347534662589, 141.29160853377272, 336.2695587467911, 29.458769943347278, 233.9771350799411, 400.4333219365718, 0.19999999999998863, 9.99999999999997, 31.1, 303.0276081951836, 221.19999999999837, 424.40649721814214, 233.30148632673496, 53.08893456076086, 78.8999999999997, 271.65481554082834, 160.5451194869011, 38.93433829019746, 118.10411620956026, 291.5422604614666, 34.10457439019842, 0.3999999999999959, 72.91446275718565, 106.67431624898408, 267.7414355259328, 25.400000000000148, 449.78240951278434, 131.58412669666998, 17.901761607665748, 247.74428563367744, 92.8697797915813, 58.228103496477544, 24.28803699831049, 184.90000000000006, 35.51458186276672, 2.300000000000013, 333.2533463710207, 176.58461985232051, 301.9223791098314, 267.8999999999994, 401.551940800595, 511.6392503765653, 10.048476038482693, 99.48716063268546, 1007.2290167894506, 135.09359353923298, 72.75843523174174, 257.39999999999725, 26.768271899214426, 175.96312457953053, 314.18236562683614, 154.07628006207477, 70.58741838905371, 99.68413965285046, 655.0952599470447, 0.3000000000000034, 7.999999999999998, 292.9357143661158, 642.7018163238038, 171.75322302884635, 224.10538215534336, 153.1193783452191, 171.90180950783287], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-653.3519154909844, -200.23745511475497, -43.8177969185022, -326.83522523292976, -5.1224226671805315, -1520.977360387765, -1067.22017158199, -941.4171456444274, -1030.0612868589396, 13.131466140268357, -364.43204776061765, -809.8960432406478, -639.9791427994594, -848.0544351685601, -1093.5582392138292, 331.8487646963418, 137.40143856656042, -1065.7215885319351, -1273.5915400143065, -1165.7006184354573, -1511.0402987650068, -254.7875424848077, -263.3185577669505, 147.51358639793733, 5.248408761413177, -1331.929225985676, -77.15804404117254, -1033.1971690228359, -1194.4112457873698, -1376.0943182391384, -93.8767310070881, -1422.6760010939074, -1493.9424645527658, -1181.5397080135645, 11.21248689293932, -1113.3364821332766, -1134.262062750903, -2.295858863813687, -864.9854466068415, -1296.316106900659, -4.842941071505315, -946.7148059469612, 195.8723005214654, -458.0992911537832, -1215.1137975563386, -1353.2422871661463, -1196.5136519868513, -1377.7522729552268, -1195.3983794836008, -272.13675030196316, -505.08116501062716, -103.8519972520325, -1015.944809212901, -296.1009352486585, -39.346639166975585, -1417.1275512282982, -1401.3725377604549, 34.42657060604326, -900.2850619459601, 15.684169113656637, -306.3207349681157, -739.465710026769, -1415.7966280383512, -1130.929116930857, -1364.0648136324817, -1150.2921557324748, -1424.7079057355234, -1188.5978959781671, -1462.2295241124934, 257.87960527371763, -1123.8018094229367, -1147.010516099697, -632.2601027251561, -1028.4915065621651, 224.5526527493652, -1074.7618068168283, -542.0396863503903, -1134.7725915883334, -219.16855693757446, -913.631572870168, -1566.1911780831833, -726.0692283847415, -1018.3971846036566, -306.2446446502066, -931.9275797808347, -596.9412837368867, -1516.4082301611083, -1194.0337944629848, -1658.680244736944, -1071.4335389138578, -1173.8604838516192, -1311.7912998370634, -815.6361164083626, -348.3026292470406, 37.119301025066875, -303.0611322062031, 308.1824504835846, -937.1076936982564, -1077.1533010419607, -886.6060209616119, -893.8898921519392, -984.9408911410802, -640.218680399498, -1120.378257260038, -628.357818576919, -771.6174969587746, -1314.408239790442, -504.40183842844283, -757.9179257417096, 17.69058039972803, -434.3767846148213, -1250.4549993119979, -700.9312836581192, -1304.052272603099, -1135.2847358642348, -792.1602740023965, -1212.2861545343453, -1287.0771179739775, 3.5340405442910767, -583.2173705597156, -82.67067210827584, -450.9146720622541, -1201.6762022326284, -765.1916053757643, -1531.9921366963033, -195.25174097963608, -83.2581043489381, -1178.8996892321513, -15.689465088975787, -637.5334987399945, -1214.504382947065, -946.0633710743152, -1210.3363159023663, -317.6380146038007, -624.0456023036172, -715.1018169936086, -185.94309156928733, -1023.0693430164742, -947.4809367629523, -1111.5340692189213, -411.2829576108177, -1036.6627492191515, -1199.025000928508, -1065.5807094807092, -1437.1832942176234, -1191.111222787449, -160.9939993194212, -765.9582968390304, -460.66329807400075, -1079.8416200925328, -61.58722756372512, -402.1332758459119, -65.29554844553638, -546.6910820458232, -112.14698799124616, -561.9351566475075, -523.9748003215647, -131.8561737291367, -1055.5220963744177, -1249.1886943632876, -337.84461106437277, 24.74859909200553, 320.04160377569724, -1271.2727955049293, -528.46439501323, -714.9950701665633, 3.3669613280096287, -106.6685824097909, 30.735580107043464, 196.63629866566225, -498.8963519766779, -582.5976433807028, -402.8783839322321, -786.1565650091836, -139.9978371262155, -958.1938379193601, -739.280526287948, -569.5242501848021, -884.3569922190529, -470.57354815653525, -931.4891289023927, -951.3972319032306, -485.27366990968164, 56.219715325322085, -1096.230093397972, -925.6113976468797, -917.4695421662832, -1180.7992650661834, -176.97976084730692, -265.82934507704, -689.322296097086, -384.02591589544846, -1186.5267876981386, -281.2627653023912, 32.849503734868584, -703.6097192055431, -581.3357147576162, -283.0353585914642, -1482.7326097520297, 103.0123989856584], "policy_predator_policy_reward": [601.2435483525375, 537.2479313488785, 25.94472690005811, 619.2693570257851, 43.32242266718088, 1520.977360387765, 1068.082728209546, 951.6239336610537, 1068.2300639034547, 307.2534760615064, 458.3749760791329, 914.4919131464368, 849.4337246352381, 836.880220265215, 1102.6582392138287, 0.0, 562.0374138339863, 916.5259101246555, 1274.3915400143062, 1169.1006184354542, 1511.0402987650068, 289.3388421230127, 482.11444396587814, 144.34502825044498, 42.033161520353715, 1331.929225985676, 861.655841173891, 485.3285416714696, 1203.4112457873696, 1376.0943182391384, 1019.5775127630803, 1075.934130658668, 1476.0956571152503, 1314.2199233653444, 700.4036634960697, 978.8764819679949, 732.5752000349037, 653.5642711584011, 874.1677216104887, 1290.5831779365794, 540.6721876692042, 834.1766380062099, 623.7823245523011, 5.842212892533185, 1232.8758553077446, 1354.9920078492707, 1327.880013771003, 1321.717283336007, 857.3790713666461, 736.518655646604, 457.9746023322094, 661.0476140870385, 771.9854957418277, 678.1287087122636, 74.24663916697541, 1417.1275512282982, 566.7902892908094, 1275.6749759320148, 900.9850619459603, 159.7147730813959, 0.0, 1297.0857331852376, 1414.1201737656052, 1133.2360665373346, 1368.3648136324816, 1150.9349652456772, 1424.9079057355234, 1190.197895978167, 1186.5955099526955, 888.5561780045666, 1129.9018094229366, 1148.8105160996977, 660.808788929098, 1046.4915065621624, 519.3877039694124, 899.956203564311, 486.807512292165, 1331.2963741803246, 445.99624170147706, 1023.0734468530574, 1566.1911780831833, 755.52799832809, 662.0697743627429, 896.5491899710623, 1167.762023092896, 761.5401623613984, 1516.4082301611083, 1194.2337944629849, 1660.7802447369438, 1079.3335389138506, 1204.960483851618, 1311.7912998370634, 304.27874408169487, 1162.6876097688962, 333.9674380275525, 153.17439315358234, 523.1964281218419, 530.1353123109743, 1166.198764796046, 1030.8620435342666, 834.2155254514071, 1097.7041924023727, 651.7186803994996, 1187.7782572600372, 600.5458864172383, 1071.0842446592849, 724.6160080437796, 1254.7391896620059, 763.2179257417095, 15.943757890469112, 652.9556409688612, 1149.9802591675248, 947.1340552718852, 1349.391761450797, 1079.649410353235, 881.9001739036015, 1212.2861545343453, 1287.4771179739776, 52.56731957268012, 600.0304731999317, 179.85707534911796, 460.40258507039744, 1163.4956779941083, 1071.1135651402185, 1531.9921366963033, 220.6517409796356, 572.7512770196282, 1139.1889260742391, 772.6833651565724, 12.123725369070263, 1274.006213872986, 904.4633017560586, 1187.3026745759264, 588.4159415639223, 969.7856895185018, 462.2315095703089, 418.8743377853793, 848.366200296857, 763.7897911524165, 1319.5132518277655, 573.5829576108185, 1059.2627492191514, 1140.4995260892335, 1159.6207661827464, 1439.1832942176234, 1191.4112227874487, 954.0325699555588, 306.1730725739099, 796.863859423072, 920.2256785957741, 737.7056136453003, 27.937268874170897, 318.1955484455366, 561.6910820458266, 319.14290306125514, 756.4911823780948, 513.5439829002023, 653.9262415270639, 1086.5002428899606, 1228.2590238862226, 361.2446110643781, 51.338561540681596, 1002.2403775200102, 956.2198309986692, 1240.3901325980837, 138.16292612094836, 37.2914739037322, 138.76858240978908, 30.028121227293557, 0.0, 515.8991715435602, 592.3630957130425, 285.1400764086179, 1079.857997112331, 461.1356829703768, 951.2383577020339, 844.1054885911609, 618.7755679436661, 706.6156141029745, 718.9023446616707, 1397.9171659365882, 584.653334521885, 647.5972419841927, 436.5519725472107, 1096.330093397972, 925.8113976468798, 1182.1992650661834, 924.0695421662833, 368.170671983033, 367.5741483074323, 1137.2529452363208, 578.7970830800134, 1186.5267876981386, 453.0159883312442, 209.60166884837437, 685.2639287776454, 0.0, 1017.4904516943086, 1482.9326097520295, 68.68941052217463]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.525099420395177, "mean_inference_ms": 3.28006676438257, "mean_action_processing_ms": 1.2176684825719473, "mean_env_wait_ms": 9.820641036678074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023186802864074707, "StateBufferConnector_ms": 0.0051097869873046875, "ViewRequirementAgentConnector_ms": 0.13183987140655518}, "num_episodes": 12, "episode_return_max": 1007.2290167894506, "episode_return_min": 0.19999999999998863, "episode_return_mean": 205.87047021445724, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.15596291706707, "num_env_steps_trained_throughput_per_sec": 82.15596291706707, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 48567.476, "restore_workers_time_ms": 0.016, "training_step_time_ms": 48567.394, "sample_time_ms": 2097.187, "learn_time_ms": 46453.366, "learn_throughput": 86.108, "synch_weights_time_ms": 13.845}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "fed12_00000", "date": "2024-08-21_18-42-52", "timestamp": 1724245972, "time_this_iter_s": 48.72718095779419, "time_total_s": 2296.4893651008606, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4ceee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2296.4893651008606, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 26.157971014492755, "ram_util_percent": 82.51739130434784}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.52249936287996, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.620282645704885, "policy_loss": -0.020938388404446263, "vf_loss": 7.638488388313818, "vf_explained_var": 0.5263734791960035, "kl": 0.013663316585823263, "entropy": 0.8105814446847905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.233004068760645, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.706828340146908, "policy_loss": -0.01771733426247482, "vf_loss": 7.7217101944817435, "vf_explained_var": 0.34850193296790755, "kl": 0.014177309622970858, "entropy": 0.4922858884094884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 1007.2290167894506, "episode_reward_min": 0.19999999999998863, "episode_reward_mean": 204.45779862370068, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1658.680244736944, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 378.0887703982779, "predator_policy": 1660.7802447369438}, "policy_reward_mean": {"prey_policy": -695.9487298442575, "predator_policy": 798.177629156108}, "custom_metrics": {}, "hist_stats": {"episode_reward": [236.62916978135198, 9.0, 578.9589113207572, 114.83340791427057, 577.1561502237258, 249.58154957858545, 3.4493460395660285, 423.2910786569503, 367.39754681251225, 19.51177843453281, 75.33137216493104, 126.36259722767707, 510.0890541565877, 138.06845999252636, 34.9000000000002, 475.5192980684171, 176.0989421950513, 251.29928819035143, 0.6304953337315753, 4.942809513202335, 1.8000000000000005, 870.8017691184915, 7.899999999999983, 46.54868620393843, 569.1347534662589, 141.29160853377272, 336.2695587467911, 29.458769943347278, 233.9771350799411, 400.4333219365718, 0.19999999999998863, 9.99999999999997, 31.1, 303.0276081951836, 221.19999999999837, 424.40649721814214, 233.30148632673496, 53.08893456076086, 78.8999999999997, 271.65481554082834, 160.5451194869011, 38.93433829019746, 118.10411620956026, 291.5422604614666, 34.10457439019842, 0.3999999999999959, 72.91446275718565, 106.67431624898408, 267.7414355259328, 25.400000000000148, 449.78240951278434, 131.58412669666998, 17.901761607665748, 247.74428563367744, 92.8697797915813, 58.228103496477544, 24.28803699831049, 184.90000000000006, 35.51458186276672, 2.300000000000013, 333.2533463710207, 176.58461985232051, 301.9223791098314, 267.8999999999994, 401.551940800595, 511.6392503765653, 10.048476038482693, 99.48716063268546, 1007.2290167894506, 135.09359353923298, 72.75843523174174, 257.39999999999725, 26.768271899214426, 175.96312457953053, 314.18236562683614, 154.07628006207477, 70.58741838905371, 99.68413965285046, 655.0952599470447, 0.3000000000000034, 7.999999999999998, 292.9357143661158, 642.7018163238038, 171.75322302884635, 224.10538215534336, 153.1193783452191, 171.90180950783287, 432.39823415384336, 187.80273678694047, 269.983350341652, 39.679247038151736, 379.72678763019775, 8.900000000000004, 119.16212502666968, 267.6903403665541, 252.49999999999912, 10.2, 278.647585032292, 206.49999999999739, 257.527143922233], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-77.15804404117254, -1033.1971690228359, -1194.4112457873698, -1376.0943182391384, -93.8767310070881, -1422.6760010939074, -1493.9424645527658, -1181.5397080135645, 11.21248689293932, -1113.3364821332766, -1134.262062750903, -2.295858863813687, -864.9854466068415, -1296.316106900659, -4.842941071505315, -946.7148059469612, 195.8723005214654, -458.0992911537832, -1215.1137975563386, -1353.2422871661463, -1196.5136519868513, -1377.7522729552268, -1195.3983794836008, -272.13675030196316, -505.08116501062716, -103.8519972520325, -1015.944809212901, -296.1009352486585, -39.346639166975585, -1417.1275512282982, -1401.3725377604549, 34.42657060604326, -900.2850619459601, 15.684169113656637, -306.3207349681157, -739.465710026769, -1415.7966280383512, -1130.929116930857, -1364.0648136324817, -1150.2921557324748, -1424.7079057355234, -1188.5978959781671, -1462.2295241124934, 257.87960527371763, -1123.8018094229367, -1147.010516099697, -632.2601027251561, -1028.4915065621651, 224.5526527493652, -1074.7618068168283, -542.0396863503903, -1134.7725915883334, -219.16855693757446, -913.631572870168, -1566.1911780831833, -726.0692283847415, -1018.3971846036566, -306.2446446502066, -931.9275797808347, -596.9412837368867, -1516.4082301611083, -1194.0337944629848, -1658.680244736944, -1071.4335389138578, -1173.8604838516192, -1311.7912998370634, -815.6361164083626, -348.3026292470406, 37.119301025066875, -303.0611322062031, 308.1824504835846, -937.1076936982564, -1077.1533010419607, -886.6060209616119, -893.8898921519392, -984.9408911410802, -640.218680399498, -1120.378257260038, -628.357818576919, -771.6174969587746, -1314.408239790442, -504.40183842844283, -757.9179257417096, 17.69058039972803, -434.3767846148213, -1250.4549993119979, -700.9312836581192, -1304.052272603099, -1135.2847358642348, -792.1602740023965, -1212.2861545343453, -1287.0771179739775, 3.5340405442910767, -583.2173705597156, -82.67067210827584, -450.9146720622541, -1201.6762022326284, -765.1916053757643, -1531.9921366963033, -195.25174097963608, -83.2581043489381, -1178.8996892321513, -15.689465088975787, -637.5334987399945, -1214.504382947065, -946.0633710743152, -1210.3363159023663, -317.6380146038007, -624.0456023036172, -715.1018169936086, -185.94309156928733, -1023.0693430164742, -947.4809367629523, -1111.5340692189213, -411.2829576108177, -1036.6627492191515, -1199.025000928508, -1065.5807094807092, -1437.1832942176234, -1191.111222787449, -160.9939993194212, -765.9582968390304, -460.66329807400075, -1079.8416200925328, -61.58722756372512, -402.1332758459119, -65.29554844553638, -546.6910820458232, -112.14698799124616, -561.9351566475075, -523.9748003215647, -131.8561737291367, -1055.5220963744177, -1249.1886943632876, -337.84461106437277, 24.74859909200553, 320.04160377569724, -1271.2727955049293, -528.46439501323, -714.9950701665633, 3.3669613280096287, -106.6685824097909, 30.735580107043464, 196.63629866566225, -498.8963519766779, -582.5976433807028, -402.8783839322321, -786.1565650091836, -139.9978371262155, -958.1938379193601, -739.280526287948, -569.5242501848021, -884.3569922190529, -470.57354815653525, -931.4891289023927, -951.3972319032306, -485.27366990968164, 56.219715325322085, -1096.230093397972, -925.6113976468797, -917.4695421662832, -1180.7992650661834, -176.97976084730692, -265.82934507704, -689.322296097086, -384.02591589544846, -1186.5267876981386, -281.2627653023912, 32.849503734868584, -703.6097192055431, -581.3357147576162, -283.0353585914642, -1482.7326097520297, 103.0123989856584, -1006.3966499527565, 378.0887703982779, -945.3752058467745, -586.3507532096833, 155.6732558228392, -1190.0345531726787, -1111.14262711764, -512.5032494941171, -991.4202134718181, -504.97702947195916, -1239.9762038365639, -1044.0164019318086, -678.154522498129, -1158.7672857490752, -947.6845754309486, 106.64542602872014, 25.472010083830366, -46.91325838537938, -1011.042831990281, -1090.498783133961, -38.42127163432363, 164.24433292281452, -7.215547698830942, -74.99837416914977, 39.154817033053064, -537.6623795180728], "policy_predator_policy_reward": [861.655841173891, 485.3285416714696, 1203.4112457873696, 1376.0943182391384, 1019.5775127630803, 1075.934130658668, 1476.0956571152503, 1314.2199233653444, 700.4036634960697, 978.8764819679949, 732.5752000349037, 653.5642711584011, 874.1677216104887, 1290.5831779365794, 540.6721876692042, 834.1766380062099, 623.7823245523011, 5.842212892533185, 1232.8758553077446, 1354.9920078492707, 1327.880013771003, 1321.717283336007, 857.3790713666461, 736.518655646604, 457.9746023322094, 661.0476140870385, 771.9854957418277, 678.1287087122636, 74.24663916697541, 1417.1275512282982, 566.7902892908094, 1275.6749759320148, 900.9850619459603, 159.7147730813959, 0.0, 1297.0857331852376, 1414.1201737656052, 1133.2360665373346, 1368.3648136324816, 1150.9349652456772, 1424.9079057355234, 1190.197895978167, 1186.5955099526955, 888.5561780045666, 1129.9018094229366, 1148.8105160996977, 660.808788929098, 1046.4915065621624, 519.3877039694124, 899.956203564311, 486.807512292165, 1331.2963741803246, 445.99624170147706, 1023.0734468530574, 1566.1911780831833, 755.52799832809, 662.0697743627429, 896.5491899710623, 1167.762023092896, 761.5401623613984, 1516.4082301611083, 1194.2337944629849, 1660.7802447369438, 1079.3335389138506, 1204.960483851618, 1311.7912998370634, 304.27874408169487, 1162.6876097688962, 333.9674380275525, 153.17439315358234, 523.1964281218419, 530.1353123109743, 1166.198764796046, 1030.8620435342666, 834.2155254514071, 1097.7041924023727, 651.7186803994996, 1187.7782572600372, 600.5458864172383, 1071.0842446592849, 724.6160080437796, 1254.7391896620059, 763.2179257417095, 15.943757890469112, 652.9556409688612, 1149.9802591675248, 947.1340552718852, 1349.391761450797, 1079.649410353235, 881.9001739036015, 1212.2861545343453, 1287.4771179739776, 52.56731957268012, 600.0304731999317, 179.85707534911796, 460.40258507039744, 1163.4956779941083, 1071.1135651402185, 1531.9921366963033, 220.6517409796356, 572.7512770196282, 1139.1889260742391, 772.6833651565724, 12.123725369070263, 1274.006213872986, 904.4633017560586, 1187.3026745759264, 588.4159415639223, 969.7856895185018, 462.2315095703089, 418.8743377853793, 848.366200296857, 763.7897911524165, 1319.5132518277655, 573.5829576108185, 1059.2627492191514, 1140.4995260892335, 1159.6207661827464, 1439.1832942176234, 1191.4112227874487, 954.0325699555588, 306.1730725739099, 796.863859423072, 920.2256785957741, 737.7056136453003, 27.937268874170897, 318.1955484455366, 561.6910820458266, 319.14290306125514, 756.4911823780948, 513.5439829002023, 653.9262415270639, 1086.5002428899606, 1228.2590238862226, 361.2446110643781, 51.338561540681596, 1002.2403775200102, 956.2198309986692, 1240.3901325980837, 138.16292612094836, 37.2914739037322, 138.76858240978908, 30.028121227293557, 0.0, 515.8991715435602, 592.3630957130425, 285.1400764086179, 1079.857997112331, 461.1356829703768, 951.2383577020339, 844.1054885911609, 618.7755679436661, 706.6156141029745, 718.9023446616707, 1397.9171659365882, 584.653334521885, 647.5972419841927, 436.5519725472107, 1096.330093397972, 925.8113976468798, 1182.1992650661834, 924.0695421662833, 368.170671983033, 367.5741483074323, 1137.2529452363208, 578.7970830800134, 1186.5267876981386, 453.0159883312442, 209.60166884837437, 685.2639287776454, 0.0, 1017.4904516943086, 1482.9326097520295, 68.68941052217463, 116.24128214407988, 944.4648315642431, 564.7301304322876, 1154.7985654111155, 957.1754848181231, 347.1691628733689, 1111.2426271176398, 552.0824965322704, 828.5514381997093, 1047.572592374266, 1239.9762038365639, 1052.9164019318093, 795.0154855816978, 1161.0684476921788, 980.7251553340827, 128.00433443470047, 16.652559129562963, 257.2886891719859, 1011.8428319902812, 1099.8987831339616, 77.67744254055349, 75.14708120324838, 9.571622830234071, 279.14229903774486, 375.6388490338122, 380.3958573734436]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.520390165541697, "mean_inference_ms": 3.2781097489589928, "mean_action_processing_ms": 1.2138996787566196, "mean_env_wait_ms": 9.846461921117758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02344369888305664, "StateBufferConnector_ms": 0.004980683326721191, "ViewRequirementAgentConnector_ms": 0.13265585899353027}, "num_episodes": 13, "episode_return_max": 1007.2290167894506, "episode_return_min": 0.19999999999998863, "episode_return_mean": 204.45779862370068, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.60960749724951, "num_env_steps_trained_throughput_per_sec": 82.60960749724951, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 48534.084, "restore_workers_time_ms": 0.016, "training_step_time_ms": 48534.002, "sample_time_ms": 2090.892, "learn_time_ms": 46426.685, "learn_throughput": 86.157, "synch_weights_time_ms": 13.83}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "fed12_00000", "date": "2024-08-21_18-43-40", "timestamp": 1724246020, "time_this_iter_s": 48.43402886390686, "time_total_s": 2344.9233939647675, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4cd0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2344.9233939647675, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 24.656521739130437, "ram_util_percent": 82.86956521739128}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.384363707789667, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.371453338199192, "policy_loss": -0.025075337679800455, "vf_loss": 7.393676941735404, "vf_explained_var": 0.5668575619263624, "kl": 0.01425861144049103, "entropy": 0.7203856167023774, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.4106517770303, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.0978469069041905, "policy_loss": -0.014461401714475224, "vf_loss": 7.110290827069964, "vf_explained_var": 0.4567349263915309, "kl": 0.010087452869660285, "entropy": 0.5139856220395477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 1007.2290167894506, "episode_reward_min": 0.19999999999998863, "episode_reward_mean": 200.4489559393128, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1658.680244736944, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 378.0887703982779, "predator_policy": 1660.7802447369438}, "policy_reward_mean": {"prey_policy": -681.4750343537847, "predator_policy": 781.6995123234415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [249.58154957858545, 3.4493460395660285, 423.2910786569503, 367.39754681251225, 19.51177843453281, 75.33137216493104, 126.36259722767707, 510.0890541565877, 138.06845999252636, 34.9000000000002, 475.5192980684171, 176.0989421950513, 251.29928819035143, 0.6304953337315753, 4.942809513202335, 1.8000000000000005, 870.8017691184915, 7.899999999999983, 46.54868620393843, 569.1347534662589, 141.29160853377272, 336.2695587467911, 29.458769943347278, 233.9771350799411, 400.4333219365718, 0.19999999999998863, 9.99999999999997, 31.1, 303.0276081951836, 221.19999999999837, 424.40649721814214, 233.30148632673496, 53.08893456076086, 78.8999999999997, 271.65481554082834, 160.5451194869011, 38.93433829019746, 118.10411620956026, 291.5422604614666, 34.10457439019842, 0.3999999999999959, 72.91446275718565, 106.67431624898408, 267.7414355259328, 25.400000000000148, 449.78240951278434, 131.58412669666998, 17.901761607665748, 247.74428563367744, 92.8697797915813, 58.228103496477544, 24.28803699831049, 184.90000000000006, 35.51458186276672, 2.300000000000013, 333.2533463710207, 176.58461985232051, 301.9223791098314, 267.8999999999994, 401.551940800595, 511.6392503765653, 10.048476038482693, 99.48716063268546, 1007.2290167894506, 135.09359353923298, 72.75843523174174, 257.39999999999725, 26.768271899214426, 175.96312457953053, 314.18236562683614, 154.07628006207477, 70.58741838905371, 99.68413965285046, 655.0952599470447, 0.3000000000000034, 7.999999999999998, 292.9357143661158, 642.7018163238038, 171.75322302884635, 224.10538215534336, 153.1193783452191, 171.90180950783287, 432.39823415384336, 187.80273678694047, 269.983350341652, 39.679247038151736, 379.72678763019775, 8.900000000000004, 119.16212502666968, 267.6903403665541, 252.49999999999912, 10.2, 278.647585032292, 206.49999999999739, 257.527143922233, 285.64456131207123, 442.5118103694647, 162.19107317230632, 45.05721248023007, 180.288713467237], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1134.262062750903, -2.295858863813687, -864.9854466068415, -1296.316106900659, -4.842941071505315, -946.7148059469612, 195.8723005214654, -458.0992911537832, -1215.1137975563386, -1353.2422871661463, -1196.5136519868513, -1377.7522729552268, -1195.3983794836008, -272.13675030196316, -505.08116501062716, -103.8519972520325, -1015.944809212901, -296.1009352486585, -39.346639166975585, -1417.1275512282982, -1401.3725377604549, 34.42657060604326, -900.2850619459601, 15.684169113656637, -306.3207349681157, -739.465710026769, -1415.7966280383512, -1130.929116930857, -1364.0648136324817, -1150.2921557324748, -1424.7079057355234, -1188.5978959781671, -1462.2295241124934, 257.87960527371763, -1123.8018094229367, -1147.010516099697, -632.2601027251561, -1028.4915065621651, 224.5526527493652, -1074.7618068168283, -542.0396863503903, -1134.7725915883334, -219.16855693757446, -913.631572870168, -1566.1911780831833, -726.0692283847415, -1018.3971846036566, -306.2446446502066, -931.9275797808347, -596.9412837368867, -1516.4082301611083, -1194.0337944629848, -1658.680244736944, -1071.4335389138578, -1173.8604838516192, -1311.7912998370634, -815.6361164083626, -348.3026292470406, 37.119301025066875, -303.0611322062031, 308.1824504835846, -937.1076936982564, -1077.1533010419607, -886.6060209616119, -893.8898921519392, -984.9408911410802, -640.218680399498, -1120.378257260038, -628.357818576919, -771.6174969587746, -1314.408239790442, -504.40183842844283, -757.9179257417096, 17.69058039972803, -434.3767846148213, -1250.4549993119979, -700.9312836581192, -1304.052272603099, -1135.2847358642348, -792.1602740023965, -1212.2861545343453, -1287.0771179739775, 3.5340405442910767, -583.2173705597156, -82.67067210827584, -450.9146720622541, -1201.6762022326284, -765.1916053757643, -1531.9921366963033, -195.25174097963608, -83.2581043489381, -1178.8996892321513, -15.689465088975787, -637.5334987399945, -1214.504382947065, -946.0633710743152, -1210.3363159023663, -317.6380146038007, -624.0456023036172, -715.1018169936086, -185.94309156928733, -1023.0693430164742, -947.4809367629523, -1111.5340692189213, -411.2829576108177, -1036.6627492191515, -1199.025000928508, -1065.5807094807092, -1437.1832942176234, -1191.111222787449, -160.9939993194212, -765.9582968390304, -460.66329807400075, -1079.8416200925328, -61.58722756372512, -402.1332758459119, -65.29554844553638, -546.6910820458232, -112.14698799124616, -561.9351566475075, -523.9748003215647, -131.8561737291367, -1055.5220963744177, -1249.1886943632876, -337.84461106437277, 24.74859909200553, 320.04160377569724, -1271.2727955049293, -528.46439501323, -714.9950701665633, 3.3669613280096287, -106.6685824097909, 30.735580107043464, 196.63629866566225, -498.8963519766779, -582.5976433807028, -402.8783839322321, -786.1565650091836, -139.9978371262155, -958.1938379193601, -739.280526287948, -569.5242501848021, -884.3569922190529, -470.57354815653525, -931.4891289023927, -951.3972319032306, -485.27366990968164, 56.219715325322085, -1096.230093397972, -925.6113976468797, -917.4695421662832, -1180.7992650661834, -176.97976084730692, -265.82934507704, -689.322296097086, -384.02591589544846, -1186.5267876981386, -281.2627653023912, 32.849503734868584, -703.6097192055431, -581.3357147576162, -283.0353585914642, -1482.7326097520297, 103.0123989856584, -1006.3966499527565, 378.0887703982779, -945.3752058467745, -586.3507532096833, 155.6732558228392, -1190.0345531726787, -1111.14262711764, -512.5032494941171, -991.4202134718181, -504.97702947195916, -1239.9762038365639, -1044.0164019318086, -678.154522498129, -1158.7672857490752, -947.6845754309486, 106.64542602872014, 25.472010083830366, -46.91325838537938, -1011.042831990281, -1090.498783133961, -38.42127163432363, 164.24433292281452, -7.215547698830942, -74.99837416914977, 39.154817033053064, -537.6623795180728, 35.92114877125673, -1209.7261273371803, -1430.1095369150307, -246.57332891280572, -474.17884569357136, -994.9836708984442, -68.22604244727233, -403.95869817070513, -365.9196956759513, -922.5257816239332], "policy_predator_policy_reward": [732.5752000349037, 653.5642711584011, 874.1677216104887, 1290.5831779365794, 540.6721876692042, 834.1766380062099, 623.7823245523011, 5.842212892533185, 1232.8758553077446, 1354.9920078492707, 1327.880013771003, 1321.717283336007, 857.3790713666461, 736.518655646604, 457.9746023322094, 661.0476140870385, 771.9854957418277, 678.1287087122636, 74.24663916697541, 1417.1275512282982, 566.7902892908094, 1275.6749759320148, 900.9850619459603, 159.7147730813959, 0.0, 1297.0857331852376, 1414.1201737656052, 1133.2360665373346, 1368.3648136324816, 1150.9349652456772, 1424.9079057355234, 1190.197895978167, 1186.5955099526955, 888.5561780045666, 1129.9018094229366, 1148.8105160996977, 660.808788929098, 1046.4915065621624, 519.3877039694124, 899.956203564311, 486.807512292165, 1331.2963741803246, 445.99624170147706, 1023.0734468530574, 1566.1911780831833, 755.52799832809, 662.0697743627429, 896.5491899710623, 1167.762023092896, 761.5401623613984, 1516.4082301611083, 1194.2337944629849, 1660.7802447369438, 1079.3335389138506, 1204.960483851618, 1311.7912998370634, 304.27874408169487, 1162.6876097688962, 333.9674380275525, 153.17439315358234, 523.1964281218419, 530.1353123109743, 1166.198764796046, 1030.8620435342666, 834.2155254514071, 1097.7041924023727, 651.7186803994996, 1187.7782572600372, 600.5458864172383, 1071.0842446592849, 724.6160080437796, 1254.7391896620059, 763.2179257417095, 15.943757890469112, 652.9556409688612, 1149.9802591675248, 947.1340552718852, 1349.391761450797, 1079.649410353235, 881.9001739036015, 1212.2861545343453, 1287.4771179739776, 52.56731957268012, 600.0304731999317, 179.85707534911796, 460.40258507039744, 1163.4956779941083, 1071.1135651402185, 1531.9921366963033, 220.6517409796356, 572.7512770196282, 1139.1889260742391, 772.6833651565724, 12.123725369070263, 1274.006213872986, 904.4633017560586, 1187.3026745759264, 588.4159415639223, 969.7856895185018, 462.2315095703089, 418.8743377853793, 848.366200296857, 763.7897911524165, 1319.5132518277655, 573.5829576108185, 1059.2627492191514, 1140.4995260892335, 1159.6207661827464, 1439.1832942176234, 1191.4112227874487, 954.0325699555588, 306.1730725739099, 796.863859423072, 920.2256785957741, 737.7056136453003, 27.937268874170897, 318.1955484455366, 561.6910820458266, 319.14290306125514, 756.4911823780948, 513.5439829002023, 653.9262415270639, 1086.5002428899606, 1228.2590238862226, 361.2446110643781, 51.338561540681596, 1002.2403775200102, 956.2198309986692, 1240.3901325980837, 138.16292612094836, 37.2914739037322, 138.76858240978908, 30.028121227293557, 0.0, 515.8991715435602, 592.3630957130425, 285.1400764086179, 1079.857997112331, 461.1356829703768, 951.2383577020339, 844.1054885911609, 618.7755679436661, 706.6156141029745, 718.9023446616707, 1397.9171659365882, 584.653334521885, 647.5972419841927, 436.5519725472107, 1096.330093397972, 925.8113976468798, 1182.1992650661834, 924.0695421662833, 368.170671983033, 367.5741483074323, 1137.2529452363208, 578.7970830800134, 1186.5267876981386, 453.0159883312442, 209.60166884837437, 685.2639287776454, 0.0, 1017.4904516943086, 1482.9326097520295, 68.68941052217463, 116.24128214407988, 944.4648315642431, 564.7301304322876, 1154.7985654111155, 957.1754848181231, 347.1691628733689, 1111.2426271176398, 552.0824965322704, 828.5514381997093, 1047.572592374266, 1239.9762038365639, 1052.9164019318093, 795.0154855816978, 1161.0684476921788, 980.7251553340827, 128.00433443470047, 16.652559129562963, 257.2886891719859, 1011.8428319902812, 1099.8987831339616, 77.67744254055349, 75.14708120324838, 9.571622830234071, 279.14229903774486, 375.6388490338122, 380.3958573734436, 822.1959564117315, 637.2535834662638, 1403.0207426330903, 716.1739335642134, 982.6248525399463, 648.7287372243759, 49.88666401284814, 467.35528908536236, 1040.264683949197, 428.46950681792384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5196571552353504, "mean_inference_ms": 3.274576634842351, "mean_action_processing_ms": 1.2118012188361613, "mean_env_wait_ms": 9.848029342394979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023404479026794434, "StateBufferConnector_ms": 0.004970908164978027, "ViewRequirementAgentConnector_ms": 0.13182532787322998}, "num_episodes": 5, "episode_return_max": 1007.2290167894506, "episode_return_min": 0.19999999999998863, "episode_return_mean": 200.4489559393128, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.50989797319403, "num_env_steps_trained_throughput_per_sec": 83.50989797319403, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 48395.837, "restore_workers_time_ms": 0.016, "training_step_time_ms": 48395.753, "sample_time_ms": 2088.017, "learn_time_ms": 46291.492, "learn_throughput": 86.409, "synch_weights_time_ms": 13.665}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "fed12_00000", "date": "2024-08-21_18-44-28", "timestamp": 1724246068, "time_this_iter_s": 47.95947813987732, "time_total_s": 2392.882872104645, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31d553280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2392.882872104645, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 25.914925373134327, "ram_util_percent": 82.33134328358209}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.862389471417382, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.4474397616411645, "policy_loss": -0.02101856935054813, "vf_loss": 7.465763564841457, "vf_explained_var": 0.5207809417020707, "kl": 0.01347390342893069, "entropy": 0.7798791035142525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.24465739670254, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.1833975110735215, "policy_loss": -0.015612104284655913, "vf_loss": 7.196639321594642, "vf_explained_var": 0.44474947137176674, "kl": 0.011851416793824347, "entropy": 0.5298770539817356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 1007.2290167894506, "episode_reward_min": 0.19999999999998863, "episode_reward_mean": 209.2241754177498, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1658.680244736944, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 378.0887703982779, "predator_policy": 1660.7802447369438}, "policy_reward_mean": {"prey_policy": -659.4019875505885, "predator_policy": 764.0140752594638}, "custom_metrics": {}, "hist_stats": {"episode_reward": [510.0890541565877, 138.06845999252636, 34.9000000000002, 475.5192980684171, 176.0989421950513, 251.29928819035143, 0.6304953337315753, 4.942809513202335, 1.8000000000000005, 870.8017691184915, 7.899999999999983, 46.54868620393843, 569.1347534662589, 141.29160853377272, 336.2695587467911, 29.458769943347278, 233.9771350799411, 400.4333219365718, 0.19999999999998863, 9.99999999999997, 31.1, 303.0276081951836, 221.19999999999837, 424.40649721814214, 233.30148632673496, 53.08893456076086, 78.8999999999997, 271.65481554082834, 160.5451194869011, 38.93433829019746, 118.10411620956026, 291.5422604614666, 34.10457439019842, 0.3999999999999959, 72.91446275718565, 106.67431624898408, 267.7414355259328, 25.400000000000148, 449.78240951278434, 131.58412669666998, 17.901761607665748, 247.74428563367744, 92.8697797915813, 58.228103496477544, 24.28803699831049, 184.90000000000006, 35.51458186276672, 2.300000000000013, 333.2533463710207, 176.58461985232051, 301.9223791098314, 267.8999999999994, 401.551940800595, 511.6392503765653, 10.048476038482693, 99.48716063268546, 1007.2290167894506, 135.09359353923298, 72.75843523174174, 257.39999999999725, 26.768271899214426, 175.96312457953053, 314.18236562683614, 154.07628006207477, 70.58741838905371, 99.68413965285046, 655.0952599470447, 0.3000000000000034, 7.999999999999998, 292.9357143661158, 642.7018163238038, 171.75322302884635, 224.10538215534336, 153.1193783452191, 171.90180950783287, 432.39823415384336, 187.80273678694047, 269.983350341652, 39.679247038151736, 379.72678763019775, 8.900000000000004, 119.16212502666968, 267.6903403665541, 252.49999999999912, 10.2, 278.647585032292, 206.49999999999739, 257.527143922233, 285.64456131207123, 442.5118103694647, 162.19107317230632, 45.05721248023007, 180.288713467237, 177.14454451292087, 205.57868380321875, 149.80777668114763, 811.0886215321378, 1.7363459941291306, 77.19999999999989, 719.891244234906], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-505.08116501062716, -103.8519972520325, -1015.944809212901, -296.1009352486585, -39.346639166975585, -1417.1275512282982, -1401.3725377604549, 34.42657060604326, -900.2850619459601, 15.684169113656637, -306.3207349681157, -739.465710026769, -1415.7966280383512, -1130.929116930857, -1364.0648136324817, -1150.2921557324748, -1424.7079057355234, -1188.5978959781671, -1462.2295241124934, 257.87960527371763, -1123.8018094229367, -1147.010516099697, -632.2601027251561, -1028.4915065621651, 224.5526527493652, -1074.7618068168283, -542.0396863503903, -1134.7725915883334, -219.16855693757446, -913.631572870168, -1566.1911780831833, -726.0692283847415, -1018.3971846036566, -306.2446446502066, -931.9275797808347, -596.9412837368867, -1516.4082301611083, -1194.0337944629848, -1658.680244736944, -1071.4335389138578, -1173.8604838516192, -1311.7912998370634, -815.6361164083626, -348.3026292470406, 37.119301025066875, -303.0611322062031, 308.1824504835846, -937.1076936982564, -1077.1533010419607, -886.6060209616119, -893.8898921519392, -984.9408911410802, -640.218680399498, -1120.378257260038, -628.357818576919, -771.6174969587746, -1314.408239790442, -504.40183842844283, -757.9179257417096, 17.69058039972803, -434.3767846148213, -1250.4549993119979, -700.9312836581192, -1304.052272603099, -1135.2847358642348, -792.1602740023965, -1212.2861545343453, -1287.0771179739775, 3.5340405442910767, -583.2173705597156, -82.67067210827584, -450.9146720622541, -1201.6762022326284, -765.1916053757643, -1531.9921366963033, -195.25174097963608, -83.2581043489381, -1178.8996892321513, -15.689465088975787, -637.5334987399945, -1214.504382947065, -946.0633710743152, -1210.3363159023663, -317.6380146038007, -624.0456023036172, -715.1018169936086, -185.94309156928733, -1023.0693430164742, -947.4809367629523, -1111.5340692189213, -411.2829576108177, -1036.6627492191515, -1199.025000928508, -1065.5807094807092, -1437.1832942176234, -1191.111222787449, -160.9939993194212, -765.9582968390304, -460.66329807400075, -1079.8416200925328, -61.58722756372512, -402.1332758459119, -65.29554844553638, -546.6910820458232, -112.14698799124616, -561.9351566475075, -523.9748003215647, -131.8561737291367, -1055.5220963744177, -1249.1886943632876, -337.84461106437277, 24.74859909200553, 320.04160377569724, -1271.2727955049293, -528.46439501323, -714.9950701665633, 3.3669613280096287, -106.6685824097909, 30.735580107043464, 196.63629866566225, -498.8963519766779, -582.5976433807028, -402.8783839322321, -786.1565650091836, -139.9978371262155, -958.1938379193601, -739.280526287948, -569.5242501848021, -884.3569922190529, -470.57354815653525, -931.4891289023927, -951.3972319032306, -485.27366990968164, 56.219715325322085, -1096.230093397972, -925.6113976468797, -917.4695421662832, -1180.7992650661834, -176.97976084730692, -265.82934507704, -689.322296097086, -384.02591589544846, -1186.5267876981386, -281.2627653023912, 32.849503734868584, -703.6097192055431, -581.3357147576162, -283.0353585914642, -1482.7326097520297, 103.0123989856584, -1006.3966499527565, 378.0887703982779, -945.3752058467745, -586.3507532096833, 155.6732558228392, -1190.0345531726787, -1111.14262711764, -512.5032494941171, -991.4202134718181, -504.97702947195916, -1239.9762038365639, -1044.0164019318086, -678.154522498129, -1158.7672857490752, -947.6845754309486, 106.64542602872014, 25.472010083830366, -46.91325838537938, -1011.042831990281, -1090.498783133961, -38.42127163432363, 164.24433292281452, -7.215547698830942, -74.99837416914977, 39.154817033053064, -537.6623795180728, 35.92114877125673, -1209.7261273371803, -1430.1095369150307, -246.57332891280572, -474.17884569357136, -994.9836708984442, -68.22604244727233, -403.95869817070513, -365.9196956759513, -922.5257816239332, -639.2972435739069, -393.6976971519453, -306.4016332588706, -152.56251095633058, -804.4347906314368, -827.2249736605336, 250.99173869954618, -949.4038176552892, -1035.483817602088, -1090.016743528568, 13.1728162004267, 25.958929245070156, -913.9098807728278, 115.11763306287581], "policy_predator_policy_reward": [457.9746023322094, 661.0476140870385, 771.9854957418277, 678.1287087122636, 74.24663916697541, 1417.1275512282982, 566.7902892908094, 1275.6749759320148, 900.9850619459603, 159.7147730813959, 0.0, 1297.0857331852376, 1414.1201737656052, 1133.2360665373346, 1368.3648136324816, 1150.9349652456772, 1424.9079057355234, 1190.197895978167, 1186.5955099526955, 888.5561780045666, 1129.9018094229366, 1148.8105160996977, 660.808788929098, 1046.4915065621624, 519.3877039694124, 899.956203564311, 486.807512292165, 1331.2963741803246, 445.99624170147706, 1023.0734468530574, 1566.1911780831833, 755.52799832809, 662.0697743627429, 896.5491899710623, 1167.762023092896, 761.5401623613984, 1516.4082301611083, 1194.2337944629849, 1660.7802447369438, 1079.3335389138506, 1204.960483851618, 1311.7912998370634, 304.27874408169487, 1162.6876097688962, 333.9674380275525, 153.17439315358234, 523.1964281218419, 530.1353123109743, 1166.198764796046, 1030.8620435342666, 834.2155254514071, 1097.7041924023727, 651.7186803994996, 1187.7782572600372, 600.5458864172383, 1071.0842446592849, 724.6160080437796, 1254.7391896620059, 763.2179257417095, 15.943757890469112, 652.9556409688612, 1149.9802591675248, 947.1340552718852, 1349.391761450797, 1079.649410353235, 881.9001739036015, 1212.2861545343453, 1287.4771179739776, 52.56731957268012, 600.0304731999317, 179.85707534911796, 460.40258507039744, 1163.4956779941083, 1071.1135651402185, 1531.9921366963033, 220.6517409796356, 572.7512770196282, 1139.1889260742391, 772.6833651565724, 12.123725369070263, 1274.006213872986, 904.4633017560586, 1187.3026745759264, 588.4159415639223, 969.7856895185018, 462.2315095703089, 418.8743377853793, 848.366200296857, 763.7897911524165, 1319.5132518277655, 573.5829576108185, 1059.2627492191514, 1140.4995260892335, 1159.6207661827464, 1439.1832942176234, 1191.4112227874487, 954.0325699555588, 306.1730725739099, 796.863859423072, 920.2256785957741, 737.7056136453003, 27.937268874170897, 318.1955484455366, 561.6910820458266, 319.14290306125514, 756.4911823780948, 513.5439829002023, 653.9262415270639, 1086.5002428899606, 1228.2590238862226, 361.2446110643781, 51.338561540681596, 1002.2403775200102, 956.2198309986692, 1240.3901325980837, 138.16292612094836, 37.2914739037322, 138.76858240978908, 30.028121227293557, 0.0, 515.8991715435602, 592.3630957130425, 285.1400764086179, 1079.857997112331, 461.1356829703768, 951.2383577020339, 844.1054885911609, 618.7755679436661, 706.6156141029745, 718.9023446616707, 1397.9171659365882, 584.653334521885, 647.5972419841927, 436.5519725472107, 1096.330093397972, 925.8113976468798, 1182.1992650661834, 924.0695421662833, 368.170671983033, 367.5741483074323, 1137.2529452363208, 578.7970830800134, 1186.5267876981386, 453.0159883312442, 209.60166884837437, 685.2639287776454, 0.0, 1017.4904516943086, 1482.9326097520295, 68.68941052217463, 116.24128214407988, 944.4648315642431, 564.7301304322876, 1154.7985654111155, 957.1754848181231, 347.1691628733689, 1111.2426271176398, 552.0824965322704, 828.5514381997093, 1047.572592374266, 1239.9762038365639, 1052.9164019318093, 795.0154855816978, 1161.0684476921788, 980.7251553340827, 128.00433443470047, 16.652559129562963, 257.2886891719859, 1011.8428319902812, 1099.8987831339616, 77.67744254055349, 75.14708120324838, 9.571622830234071, 279.14229903774486, 375.6388490338122, 380.3958573734436, 822.1959564117315, 637.2535834662638, 1403.0207426330903, 716.1739335642134, 982.6248525399463, 648.7287372243759, 49.88666401284814, 467.35528908536236, 1040.264683949197, 428.46950681792384, 611.2131655602307, 598.9263196785496, 52.372795125149274, 612.1700328932733, 489.8634360351063, 1291.6041049380124, 659.6114014598571, 849.8892990280215, 1036.7201635962174, 1090.516743528568, 25.227183799573346, 12.841070754929918, 575.8805448268023, 942.8029471180555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5200711806227765, "mean_inference_ms": 3.2804059704592974, "mean_action_processing_ms": 1.2031452842533386, "mean_env_wait_ms": 9.85690271456416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02344965934753418, "StateBufferConnector_ms": 0.005065798759460449, "ViewRequirementAgentConnector_ms": 0.12618231773376465}, "num_episodes": 7, "episode_return_max": 1007.2290167894506, "episode_return_min": 0.19999999999998863, "episode_return_mean": 209.2241754177498, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.41361449291828, "num_env_steps_trained_throughput_per_sec": 82.41361449291828, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 48408.939, "restore_workers_time_ms": 0.016, "training_step_time_ms": 48408.856, "sample_time_ms": 2094.241, "learn_time_ms": 46298.889, "learn_throughput": 86.395, "synch_weights_time_ms": 13.448}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "fed12_00000", "date": "2024-08-21_18-45-17", "timestamp": 1724246117, "time_this_iter_s": 48.58853006362915, "time_total_s": 2441.471402168274, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4c2550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2441.471402168274, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 25.8231884057971, "ram_util_percent": 82.03913043478262}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.33251293765174, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.370314905883143, "policy_loss": -0.016548632955420074, "vf_loss": 7.384356779522366, "vf_explained_var": 0.582980218261638, "kl": 0.012533741174315018, "entropy": 0.707921722767845, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.036798708274883, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.0656990212738195, "policy_loss": -0.011365852597361756, "vf_loss": 7.0750098125013725, "vf_explained_var": 0.4024635542322088, "kl": 0.010275338642624398, "entropy": 0.5182431937683196, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 1007.2290167894506, "episode_reward_min": 0.19999999999998863, "episode_reward_mean": 210.2326065050226, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1658.680244736944, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 378.0887703982779, "predator_policy": 1660.7802447369438}, "policy_reward_mean": {"prey_policy": -647.4052559777616, "predator_policy": 752.5215592302734}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.8000000000000005, 870.8017691184915, 7.899999999999983, 46.54868620393843, 569.1347534662589, 141.29160853377272, 336.2695587467911, 29.458769943347278, 233.9771350799411, 400.4333219365718, 0.19999999999998863, 9.99999999999997, 31.1, 303.0276081951836, 221.19999999999837, 424.40649721814214, 233.30148632673496, 53.08893456076086, 78.8999999999997, 271.65481554082834, 160.5451194869011, 38.93433829019746, 118.10411620956026, 291.5422604614666, 34.10457439019842, 0.3999999999999959, 72.91446275718565, 106.67431624898408, 267.7414355259328, 25.400000000000148, 449.78240951278434, 131.58412669666998, 17.901761607665748, 247.74428563367744, 92.8697797915813, 58.228103496477544, 24.28803699831049, 184.90000000000006, 35.51458186276672, 2.300000000000013, 333.2533463710207, 176.58461985232051, 301.9223791098314, 267.8999999999994, 401.551940800595, 511.6392503765653, 10.048476038482693, 99.48716063268546, 1007.2290167894506, 135.09359353923298, 72.75843523174174, 257.39999999999725, 26.768271899214426, 175.96312457953053, 314.18236562683614, 154.07628006207477, 70.58741838905371, 99.68413965285046, 655.0952599470447, 0.3000000000000034, 7.999999999999998, 292.9357143661158, 642.7018163238038, 171.75322302884635, 224.10538215534336, 153.1193783452191, 171.90180950783287, 432.39823415384336, 187.80273678694047, 269.983350341652, 39.679247038151736, 379.72678763019775, 8.900000000000004, 119.16212502666968, 267.6903403665541, 252.49999999999912, 10.2, 278.647585032292, 206.49999999999739, 257.527143922233, 285.64456131207123, 442.5118103694647, 162.19107317230632, 45.05721248023007, 180.288713467237, 177.14454451292087, 205.57868380321875, 149.80777668114763, 811.0886215321378, 1.7363459941291306, 77.19999999999989, 719.891244234906, 347.4294589092781, 396.584455253612, 455.92280875604547, 207.92258074743927, 21.814832198519603, 43.80000000000033, 212.71732031225343, 6.199999999999992], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1424.7079057355234, -1188.5978959781671, -1462.2295241124934, 257.87960527371763, -1123.8018094229367, -1147.010516099697, -632.2601027251561, -1028.4915065621651, 224.5526527493652, -1074.7618068168283, -542.0396863503903, -1134.7725915883334, -219.16855693757446, -913.631572870168, -1566.1911780831833, -726.0692283847415, -1018.3971846036566, -306.2446446502066, -931.9275797808347, -596.9412837368867, -1516.4082301611083, -1194.0337944629848, -1658.680244736944, -1071.4335389138578, -1173.8604838516192, -1311.7912998370634, -815.6361164083626, -348.3026292470406, 37.119301025066875, -303.0611322062031, 308.1824504835846, -937.1076936982564, -1077.1533010419607, -886.6060209616119, -893.8898921519392, -984.9408911410802, -640.218680399498, -1120.378257260038, -628.357818576919, -771.6174969587746, -1314.408239790442, -504.40183842844283, -757.9179257417096, 17.69058039972803, -434.3767846148213, -1250.4549993119979, -700.9312836581192, -1304.052272603099, -1135.2847358642348, -792.1602740023965, -1212.2861545343453, -1287.0771179739775, 3.5340405442910767, -583.2173705597156, -82.67067210827584, -450.9146720622541, -1201.6762022326284, -765.1916053757643, -1531.9921366963033, -195.25174097963608, -83.2581043489381, -1178.8996892321513, -15.689465088975787, -637.5334987399945, -1214.504382947065, -946.0633710743152, -1210.3363159023663, -317.6380146038007, -624.0456023036172, -715.1018169936086, -185.94309156928733, -1023.0693430164742, -947.4809367629523, -1111.5340692189213, -411.2829576108177, -1036.6627492191515, -1199.025000928508, -1065.5807094807092, -1437.1832942176234, -1191.111222787449, -160.9939993194212, -765.9582968390304, -460.66329807400075, -1079.8416200925328, -61.58722756372512, -402.1332758459119, -65.29554844553638, -546.6910820458232, -112.14698799124616, -561.9351566475075, -523.9748003215647, -131.8561737291367, -1055.5220963744177, -1249.1886943632876, -337.84461106437277, 24.74859909200553, 320.04160377569724, -1271.2727955049293, -528.46439501323, -714.9950701665633, 3.3669613280096287, -106.6685824097909, 30.735580107043464, 196.63629866566225, -498.8963519766779, -582.5976433807028, -402.8783839322321, -786.1565650091836, -139.9978371262155, -958.1938379193601, -739.280526287948, -569.5242501848021, -884.3569922190529, -470.57354815653525, -931.4891289023927, -951.3972319032306, -485.27366990968164, 56.219715325322085, -1096.230093397972, -925.6113976468797, -917.4695421662832, -1180.7992650661834, -176.97976084730692, -265.82934507704, -689.322296097086, -384.02591589544846, -1186.5267876981386, -281.2627653023912, 32.849503734868584, -703.6097192055431, -581.3357147576162, -283.0353585914642, -1482.7326097520297, 103.0123989856584, -1006.3966499527565, 378.0887703982779, -945.3752058467745, -586.3507532096833, 155.6732558228392, -1190.0345531726787, -1111.14262711764, -512.5032494941171, -991.4202134718181, -504.97702947195916, -1239.9762038365639, -1044.0164019318086, -678.154522498129, -1158.7672857490752, -947.6845754309486, 106.64542602872014, 25.472010083830366, -46.91325838537938, -1011.042831990281, -1090.498783133961, -38.42127163432363, 164.24433292281452, -7.215547698830942, -74.99837416914977, 39.154817033053064, -537.6623795180728, 35.92114877125673, -1209.7261273371803, -1430.1095369150307, -246.57332891280572, -474.17884569357136, -994.9836708984442, -68.22604244727233, -403.95869817070513, -365.9196956759513, -922.5257816239332, -639.2972435739069, -393.6976971519453, -306.4016332588706, -152.56251095633058, -804.4347906314368, -827.2249736605336, 250.99173869954618, -949.4038176552892, -1035.483817602088, -1090.016743528568, 13.1728162004267, 25.958929245070156, -913.9098807728278, 115.11763306287581, -986.5622951983391, -341.1798823289587, 243.50434362617378, -590.1158040208508, -910.5223485254966, -83.42037261171444, -567.2568116171894, 23.66410306845487, -1176.948827469389, -847.8351194502504, -931.5581715855562, 27.993211180877385, -822.24739149603, -304.0183110549114, -1095.254987310202, -974.7641370765169], "policy_predator_policy_reward": [1424.9079057355234, 1190.197895978167, 1186.5955099526955, 888.5561780045666, 1129.9018094229366, 1148.8105160996977, 660.808788929098, 1046.4915065621624, 519.3877039694124, 899.956203564311, 486.807512292165, 1331.2963741803246, 445.99624170147706, 1023.0734468530574, 1566.1911780831833, 755.52799832809, 662.0697743627429, 896.5491899710623, 1167.762023092896, 761.5401623613984, 1516.4082301611083, 1194.2337944629849, 1660.7802447369438, 1079.3335389138506, 1204.960483851618, 1311.7912998370634, 304.27874408169487, 1162.6876097688962, 333.9674380275525, 153.17439315358234, 523.1964281218419, 530.1353123109743, 1166.198764796046, 1030.8620435342666, 834.2155254514071, 1097.7041924023727, 651.7186803994996, 1187.7782572600372, 600.5458864172383, 1071.0842446592849, 724.6160080437796, 1254.7391896620059, 763.2179257417095, 15.943757890469112, 652.9556409688612, 1149.9802591675248, 947.1340552718852, 1349.391761450797, 1079.649410353235, 881.9001739036015, 1212.2861545343453, 1287.4771179739776, 52.56731957268012, 600.0304731999317, 179.85707534911796, 460.40258507039744, 1163.4956779941083, 1071.1135651402185, 1531.9921366963033, 220.6517409796356, 572.7512770196282, 1139.1889260742391, 772.6833651565724, 12.123725369070263, 1274.006213872986, 904.4633017560586, 1187.3026745759264, 588.4159415639223, 969.7856895185018, 462.2315095703089, 418.8743377853793, 848.366200296857, 763.7897911524165, 1319.5132518277655, 573.5829576108185, 1059.2627492191514, 1140.4995260892335, 1159.6207661827464, 1439.1832942176234, 1191.4112227874487, 954.0325699555588, 306.1730725739099, 796.863859423072, 920.2256785957741, 737.7056136453003, 27.937268874170897, 318.1955484455366, 561.6910820458266, 319.14290306125514, 756.4911823780948, 513.5439829002023, 653.9262415270639, 1086.5002428899606, 1228.2590238862226, 361.2446110643781, 51.338561540681596, 1002.2403775200102, 956.2198309986692, 1240.3901325980837, 138.16292612094836, 37.2914739037322, 138.76858240978908, 30.028121227293557, 0.0, 515.8991715435602, 592.3630957130425, 285.1400764086179, 1079.857997112331, 461.1356829703768, 951.2383577020339, 844.1054885911609, 618.7755679436661, 706.6156141029745, 718.9023446616707, 1397.9171659365882, 584.653334521885, 647.5972419841927, 436.5519725472107, 1096.330093397972, 925.8113976468798, 1182.1992650661834, 924.0695421662833, 368.170671983033, 367.5741483074323, 1137.2529452363208, 578.7970830800134, 1186.5267876981386, 453.0159883312442, 209.60166884837437, 685.2639287776454, 0.0, 1017.4904516943086, 1482.9326097520295, 68.68941052217463, 116.24128214407988, 944.4648315642431, 564.7301304322876, 1154.7985654111155, 957.1754848181231, 347.1691628733689, 1111.2426271176398, 552.0824965322704, 828.5514381997093, 1047.572592374266, 1239.9762038365639, 1052.9164019318093, 795.0154855816978, 1161.0684476921788, 980.7251553340827, 128.00433443470047, 16.652559129562963, 257.2886891719859, 1011.8428319902812, 1099.8987831339616, 77.67744254055349, 75.14708120324838, 9.571622830234071, 279.14229903774486, 375.6388490338122, 380.3958573734436, 822.1959564117315, 637.2535834662638, 1403.0207426330903, 716.1739335642134, 982.6248525399463, 648.7287372243759, 49.88666401284814, 467.35528908536236, 1040.264683949197, 428.46950681792384, 611.2131655602307, 598.9263196785496, 52.372795125149274, 612.1700328932733, 489.8634360351063, 1291.6041049380124, 659.6114014598571, 849.8892990280215, 1036.7201635962174, 1090.516743528568, 25.227183799573346, 12.841070754929918, 575.8805448268023, 942.8029471180555, 1006.457641898501, 668.7139945380762, 111.02358291276495, 632.1723327355253, 835.7995505111759, 614.0659793820803, 325.22163060751274, 426.2936586886619, 1176.948827469389, 869.64995164877, 936.2581715855564, 11.106788819122722, 49.32097149255869, 1289.6620513706362, 1095.254987310202, 980.9641370765183]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.514004786290755, "mean_inference_ms": 3.2683587408008954, "mean_action_processing_ms": 1.1970150267004278, "mean_env_wait_ms": 9.853636399926854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022594690322875977, "StateBufferConnector_ms": 0.004441976547241211, "ViewRequirementAgentConnector_ms": 0.1235651969909668}, "num_episodes": 8, "episode_return_max": 1007.2290167894506, "episode_return_min": 0.19999999999998863, "episode_return_mean": 210.2326065050226, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.97518464609402, "num_env_steps_trained_throughput_per_sec": 82.97518464609402, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 48350.219, "restore_workers_time_ms": 0.016, "training_step_time_ms": 48350.136, "sample_time_ms": 2092.022, "learn_time_ms": 46241.819, "learn_throughput": 86.502, "synch_weights_time_ms": 13.554}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "fed12_00000", "date": "2024-08-21_18-46-05", "timestamp": 1724246165, "time_this_iter_s": 48.25243377685547, "time_total_s": 2489.7238359451294, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4b5ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2489.7238359451294, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 25.14852941176471, "ram_util_percent": 82.51617647058825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.05394103918126, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.17855336628263, "policy_loss": -0.022100986871084877, "vf_loss": 7.1980863195247755, "vf_explained_var": 0.5507689343873786, "kl": 0.012840121458703406, "entropy": 0.7597496874117977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.67035029502142, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.844184579798784, "policy_loss": -0.013802073680593696, "vf_loss": 6.855927938885159, "vf_explained_var": 0.4218900182575145, "kl": 0.010293641564234225, "entropy": 0.5717526289048018, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 1007.2290167894506, "episode_reward_min": 0.19999999999998863, "episode_reward_mean": 209.72696571102398, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1658.680244736944, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 378.0887703982779, "predator_policy": 1660.7802447369438}, "policy_reward_mean": {"prey_policy": -638.7944153657633, "predator_policy": 743.6578982212756}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.19999999999998863, 9.99999999999997, 31.1, 303.0276081951836, 221.19999999999837, 424.40649721814214, 233.30148632673496, 53.08893456076086, 78.8999999999997, 271.65481554082834, 160.5451194869011, 38.93433829019746, 118.10411620956026, 291.5422604614666, 34.10457439019842, 0.3999999999999959, 72.91446275718565, 106.67431624898408, 267.7414355259328, 25.400000000000148, 449.78240951278434, 131.58412669666998, 17.901761607665748, 247.74428563367744, 92.8697797915813, 58.228103496477544, 24.28803699831049, 184.90000000000006, 35.51458186276672, 2.300000000000013, 333.2533463710207, 176.58461985232051, 301.9223791098314, 267.8999999999994, 401.551940800595, 511.6392503765653, 10.048476038482693, 99.48716063268546, 1007.2290167894506, 135.09359353923298, 72.75843523174174, 257.39999999999725, 26.768271899214426, 175.96312457953053, 314.18236562683614, 154.07628006207477, 70.58741838905371, 99.68413965285046, 655.0952599470447, 0.3000000000000034, 7.999999999999998, 292.9357143661158, 642.7018163238038, 171.75322302884635, 224.10538215534336, 153.1193783452191, 171.90180950783287, 432.39823415384336, 187.80273678694047, 269.983350341652, 39.679247038151736, 379.72678763019775, 8.900000000000004, 119.16212502666968, 267.6903403665541, 252.49999999999912, 10.2, 278.647585032292, 206.49999999999739, 257.527143922233, 285.64456131207123, 442.5118103694647, 162.19107317230632, 45.05721248023007, 180.288713467237, 177.14454451292087, 205.57868380321875, 149.80777668114763, 811.0886215321378, 1.7363459941291306, 77.19999999999989, 719.891244234906, 347.4294589092781, 396.584455253612, 455.92280875604547, 207.92258074743927, 21.814832198519603, 43.80000000000033, 212.71732031225343, 6.199999999999992, 437.8650400132392, 210.644283758349, 9.999999999999984, 272.49324923979674, 1.4999999999999976, 433.2472490287871, 343.31621989563325, 529.4061066866436, 136.7457209158783, 211.83365409092764], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1516.4082301611083, -1194.0337944629848, -1658.680244736944, -1071.4335389138578, -1173.8604838516192, -1311.7912998370634, -815.6361164083626, -348.3026292470406, 37.119301025066875, -303.0611322062031, 308.1824504835846, -937.1076936982564, -1077.1533010419607, -886.6060209616119, -893.8898921519392, -984.9408911410802, -640.218680399498, -1120.378257260038, -628.357818576919, -771.6174969587746, -1314.408239790442, -504.40183842844283, -757.9179257417096, 17.69058039972803, -434.3767846148213, -1250.4549993119979, -700.9312836581192, -1304.052272603099, -1135.2847358642348, -792.1602740023965, -1212.2861545343453, -1287.0771179739775, 3.5340405442910767, -583.2173705597156, -82.67067210827584, -450.9146720622541, -1201.6762022326284, -765.1916053757643, -1531.9921366963033, -195.25174097963608, -83.2581043489381, -1178.8996892321513, -15.689465088975787, -637.5334987399945, -1214.504382947065, -946.0633710743152, -1210.3363159023663, -317.6380146038007, -624.0456023036172, -715.1018169936086, -185.94309156928733, -1023.0693430164742, -947.4809367629523, -1111.5340692189213, -411.2829576108177, -1036.6627492191515, -1199.025000928508, -1065.5807094807092, -1437.1832942176234, -1191.111222787449, -160.9939993194212, -765.9582968390304, -460.66329807400075, -1079.8416200925328, -61.58722756372512, -402.1332758459119, -65.29554844553638, -546.6910820458232, -112.14698799124616, -561.9351566475075, -523.9748003215647, -131.8561737291367, -1055.5220963744177, -1249.1886943632876, -337.84461106437277, 24.74859909200553, 320.04160377569724, -1271.2727955049293, -528.46439501323, -714.9950701665633, 3.3669613280096287, -106.6685824097909, 30.735580107043464, 196.63629866566225, -498.8963519766779, -582.5976433807028, -402.8783839322321, -786.1565650091836, -139.9978371262155, -958.1938379193601, -739.280526287948, -569.5242501848021, -884.3569922190529, -470.57354815653525, -931.4891289023927, -951.3972319032306, -485.27366990968164, 56.219715325322085, -1096.230093397972, -925.6113976468797, -917.4695421662832, -1180.7992650661834, -176.97976084730692, -265.82934507704, -689.322296097086, -384.02591589544846, -1186.5267876981386, -281.2627653023912, 32.849503734868584, -703.6097192055431, -581.3357147576162, -283.0353585914642, -1482.7326097520297, 103.0123989856584, -1006.3966499527565, 378.0887703982779, -945.3752058467745, -586.3507532096833, 155.6732558228392, -1190.0345531726787, -1111.14262711764, -512.5032494941171, -991.4202134718181, -504.97702947195916, -1239.9762038365639, -1044.0164019318086, -678.154522498129, -1158.7672857490752, -947.6845754309486, 106.64542602872014, 25.472010083830366, -46.91325838537938, -1011.042831990281, -1090.498783133961, -38.42127163432363, 164.24433292281452, -7.215547698830942, -74.99837416914977, 39.154817033053064, -537.6623795180728, 35.92114877125673, -1209.7261273371803, -1430.1095369150307, -246.57332891280572, -474.17884569357136, -994.9836708984442, -68.22604244727233, -403.95869817070513, -365.9196956759513, -922.5257816239332, -639.2972435739069, -393.6976971519453, -306.4016332588706, -152.56251095633058, -804.4347906314368, -827.2249736605336, 250.99173869954618, -949.4038176552892, -1035.483817602088, -1090.016743528568, 13.1728162004267, 25.958929245070156, -913.9098807728278, 115.11763306287581, -986.5622951983391, -341.1798823289587, 243.50434362617378, -590.1158040208508, -910.5223485254966, -83.42037261171444, -567.2568116171894, 23.66410306845487, -1176.948827469389, -847.8351194502504, -931.5581715855562, 27.993211180877385, -822.24739149603, -304.0183110549114, -1095.254987310202, -974.7641370765169, -1398.1996085648163, -376.0103730625501, -221.02599602772716, -1102.4306793679987, -676.2726456610966, -1420.105092135019, 52.97992742372671, -1125.875199967215, -1134.5777339556846, -1244.5343378990342, 359.87460403183593, -860.8236612010754, -1171.9762191152754, -427.12941024076935, -868.328874429702, -413.7597080247395, -617.9695016286457, -817.1367945498349, -881.133268599557, -488.20962104098624], "policy_predator_policy_reward": [1516.4082301611083, 1194.2337944629849, 1660.7802447369438, 1079.3335389138506, 1204.960483851618, 1311.7912998370634, 304.27874408169487, 1162.6876097688962, 333.9674380275525, 153.17439315358234, 523.1964281218419, 530.1353123109743, 1166.198764796046, 1030.8620435342666, 834.2155254514071, 1097.7041924023727, 651.7186803994996, 1187.7782572600372, 600.5458864172383, 1071.0842446592849, 724.6160080437796, 1254.7391896620059, 763.2179257417095, 15.943757890469112, 652.9556409688612, 1149.9802591675248, 947.1340552718852, 1349.391761450797, 1079.649410353235, 881.9001739036015, 1212.2861545343453, 1287.4771179739776, 52.56731957268012, 600.0304731999317, 179.85707534911796, 460.40258507039744, 1163.4956779941083, 1071.1135651402185, 1531.9921366963033, 220.6517409796356, 572.7512770196282, 1139.1889260742391, 772.6833651565724, 12.123725369070263, 1274.006213872986, 904.4633017560586, 1187.3026745759264, 588.4159415639223, 969.7856895185018, 462.2315095703089, 418.8743377853793, 848.366200296857, 763.7897911524165, 1319.5132518277655, 573.5829576108185, 1059.2627492191514, 1140.4995260892335, 1159.6207661827464, 1439.1832942176234, 1191.4112227874487, 954.0325699555588, 306.1730725739099, 796.863859423072, 920.2256785957741, 737.7056136453003, 27.937268874170897, 318.1955484455366, 561.6910820458266, 319.14290306125514, 756.4911823780948, 513.5439829002023, 653.9262415270639, 1086.5002428899606, 1228.2590238862226, 361.2446110643781, 51.338561540681596, 1002.2403775200102, 956.2198309986692, 1240.3901325980837, 138.16292612094836, 37.2914739037322, 138.76858240978908, 30.028121227293557, 0.0, 515.8991715435602, 592.3630957130425, 285.1400764086179, 1079.857997112331, 461.1356829703768, 951.2383577020339, 844.1054885911609, 618.7755679436661, 706.6156141029745, 718.9023446616707, 1397.9171659365882, 584.653334521885, 647.5972419841927, 436.5519725472107, 1096.330093397972, 925.8113976468798, 1182.1992650661834, 924.0695421662833, 368.170671983033, 367.5741483074323, 1137.2529452363208, 578.7970830800134, 1186.5267876981386, 453.0159883312442, 209.60166884837437, 685.2639287776454, 0.0, 1017.4904516943086, 1482.9326097520295, 68.68941052217463, 116.24128214407988, 944.4648315642431, 564.7301304322876, 1154.7985654111155, 957.1754848181231, 347.1691628733689, 1111.2426271176398, 552.0824965322704, 828.5514381997093, 1047.572592374266, 1239.9762038365639, 1052.9164019318093, 795.0154855816978, 1161.0684476921788, 980.7251553340827, 128.00433443470047, 16.652559129562963, 257.2886891719859, 1011.8428319902812, 1099.8987831339616, 77.67744254055349, 75.14708120324838, 9.571622830234071, 279.14229903774486, 375.6388490338122, 380.3958573734436, 822.1959564117315, 637.2535834662638, 1403.0207426330903, 716.1739335642134, 982.6248525399463, 648.7287372243759, 49.88666401284814, 467.35528908536236, 1040.264683949197, 428.46950681792384, 611.2131655602307, 598.9263196785496, 52.372795125149274, 612.1700328932733, 489.8634360351063, 1291.6041049380124, 659.6114014598571, 849.8892990280215, 1036.7201635962174, 1090.516743528568, 25.227183799573346, 12.841070754929918, 575.8805448268023, 942.8029471180555, 1006.457641898501, 668.7139945380762, 111.02358291276495, 632.1723327355253, 835.7995505111759, 614.0659793820803, 325.22163060751274, 426.2936586886619, 1176.948827469389, 869.64995164877, 936.2581715855564, 11.106788819122722, 49.32097149255869, 1289.6620513706362, 1095.254987310202, 980.9641370765183, 1325.8762145260264, 886.1988071145801, 431.57027978607766, 1102.5306793679986, 686.0726456610987, 1420.3050921350189, 265.56887578793015, 1079.8196459953533, 1135.177733955684, 1245.4343378990343, 811.4211447223626, 122.77516147566351, 1084.6602351850709, 857.7616140666074, 880.4536722396807, 931.0410169014029, 693.1847745606728, 878.6672425336882, 965.9870509879812, 615.1894927434912]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.504919284866889, "mean_inference_ms": 3.2653094780189, "mean_action_processing_ms": 1.1995793694928962, "mean_env_wait_ms": 9.8665315513558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011521100997924805, "StateBufferConnector_ms": 0.004167914390563965, "ViewRequirementAgentConnector_ms": 0.1177670955657959}, "num_episodes": 10, "episode_return_max": 1007.2290167894506, "episode_return_min": 0.19999999999998863, "episode_return_mean": 209.72696571102398, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.90329300796533, "num_env_steps_trained_throughput_per_sec": 81.90329300796533, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 48381.13, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48381.051, "sample_time_ms": 2125.23, "learn_time_ms": 46239.716, "learn_throughput": 86.506, "synch_weights_time_ms": 13.401}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "fed12_00000", "date": "2024-08-21_18-46-54", "timestamp": 1724246214, "time_this_iter_s": 48.88395404815674, "time_total_s": 2538.607789993286, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4ce700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2538.607789993286, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 25.513043478260876, "ram_util_percent": 82.22753623188407}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.710184847867048, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.023915200258689, "policy_loss": -0.023647835244000864, "vf_loss": 7.04436701542486, "vf_explained_var": 0.5055398123289542, "kl": 0.015980046157473848, "entropy": 0.7212241777982661, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.952600432136071, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.6621517267176715, "policy_loss": -0.012949339428512507, "vf_loss": 6.673206225400248, "vf_explained_var": 0.3672016246608956, "kl": 0.009474271833748807, "entropy": 0.5591989407463679, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 1007.2290167894506, "episode_reward_min": 0.3000000000000034, "episode_reward_mean": 219.0093262766315, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1531.9921366963033, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 378.0887703982779, "predator_policy": 1531.9921366963033}, "policy_reward_mean": {"prey_policy": -607.7249536537878, "predator_policy": 717.2296167921039}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.10411620956026, 291.5422604614666, 34.10457439019842, 0.3999999999999959, 72.91446275718565, 106.67431624898408, 267.7414355259328, 25.400000000000148, 449.78240951278434, 131.58412669666998, 17.901761607665748, 247.74428563367744, 92.8697797915813, 58.228103496477544, 24.28803699831049, 184.90000000000006, 35.51458186276672, 2.300000000000013, 333.2533463710207, 176.58461985232051, 301.9223791098314, 267.8999999999994, 401.551940800595, 511.6392503765653, 10.048476038482693, 99.48716063268546, 1007.2290167894506, 135.09359353923298, 72.75843523174174, 257.39999999999725, 26.768271899214426, 175.96312457953053, 314.18236562683614, 154.07628006207477, 70.58741838905371, 99.68413965285046, 655.0952599470447, 0.3000000000000034, 7.999999999999998, 292.9357143661158, 642.7018163238038, 171.75322302884635, 224.10538215534336, 153.1193783452191, 171.90180950783287, 432.39823415384336, 187.80273678694047, 269.983350341652, 39.679247038151736, 379.72678763019775, 8.900000000000004, 119.16212502666968, 267.6903403665541, 252.49999999999912, 10.2, 278.647585032292, 206.49999999999739, 257.527143922233, 285.64456131207123, 442.5118103694647, 162.19107317230632, 45.05721248023007, 180.288713467237, 177.14454451292087, 205.57868380321875, 149.80777668114763, 811.0886215321378, 1.7363459941291306, 77.19999999999989, 719.891244234906, 347.4294589092781, 396.584455253612, 455.92280875604547, 207.92258074743927, 21.814832198519603, 43.80000000000033, 212.71732031225343, 6.199999999999992, 437.8650400132392, 210.644283758349, 9.999999999999984, 272.49324923979674, 1.4999999999999976, 433.2472490287871, 343.31621989563325, 529.4061066866436, 136.7457209158783, 211.83365409092764, 346.9933890616673, 148.60637300283904, 95.89999999999988, 350.9191728525175, 149.2782591054371, 213.2858983098854, 458.34380194178016, 253.485913681386, 128.15438202511, 174.7626169015549, 44.927146715203044, 389.9379025821158], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-434.3767846148213, -1250.4549993119979, -700.9312836581192, -1304.052272603099, -1135.2847358642348, -792.1602740023965, -1212.2861545343453, -1287.0771179739775, 3.5340405442910767, -583.2173705597156, -82.67067210827584, -450.9146720622541, -1201.6762022326284, -765.1916053757643, -1531.9921366963033, -195.25174097963608, -83.2581043489381, -1178.8996892321513, -15.689465088975787, -637.5334987399945, -1214.504382947065, -946.0633710743152, -1210.3363159023663, -317.6380146038007, -624.0456023036172, -715.1018169936086, -185.94309156928733, -1023.0693430164742, -947.4809367629523, -1111.5340692189213, -411.2829576108177, -1036.6627492191515, -1199.025000928508, -1065.5807094807092, -1437.1832942176234, -1191.111222787449, -160.9939993194212, -765.9582968390304, -460.66329807400075, -1079.8416200925328, -61.58722756372512, -402.1332758459119, -65.29554844553638, -546.6910820458232, -112.14698799124616, -561.9351566475075, -523.9748003215647, -131.8561737291367, -1055.5220963744177, -1249.1886943632876, -337.84461106437277, 24.74859909200553, 320.04160377569724, -1271.2727955049293, -528.46439501323, -714.9950701665633, 3.3669613280096287, -106.6685824097909, 30.735580107043464, 196.63629866566225, -498.8963519766779, -582.5976433807028, -402.8783839322321, -786.1565650091836, -139.9978371262155, -958.1938379193601, -739.280526287948, -569.5242501848021, -884.3569922190529, -470.57354815653525, -931.4891289023927, -951.3972319032306, -485.27366990968164, 56.219715325322085, -1096.230093397972, -925.6113976468797, -917.4695421662832, -1180.7992650661834, -176.97976084730692, -265.82934507704, -689.322296097086, -384.02591589544846, -1186.5267876981386, -281.2627653023912, 32.849503734868584, -703.6097192055431, -581.3357147576162, -283.0353585914642, -1482.7326097520297, 103.0123989856584, -1006.3966499527565, 378.0887703982779, -945.3752058467745, -586.3507532096833, 155.6732558228392, -1190.0345531726787, -1111.14262711764, -512.5032494941171, -991.4202134718181, -504.97702947195916, -1239.9762038365639, -1044.0164019318086, -678.154522498129, -1158.7672857490752, -947.6845754309486, 106.64542602872014, 25.472010083830366, -46.91325838537938, -1011.042831990281, -1090.498783133961, -38.42127163432363, 164.24433292281452, -7.215547698830942, -74.99837416914977, 39.154817033053064, -537.6623795180728, 35.92114877125673, -1209.7261273371803, -1430.1095369150307, -246.57332891280572, -474.17884569357136, -994.9836708984442, -68.22604244727233, -403.95869817070513, -365.9196956759513, -922.5257816239332, -639.2972435739069, -393.6976971519453, -306.4016332588706, -152.56251095633058, -804.4347906314368, -827.2249736605336, 250.99173869954618, -949.4038176552892, -1035.483817602088, -1090.016743528568, 13.1728162004267, 25.958929245070156, -913.9098807728278, 115.11763306287581, -986.5622951983391, -341.1798823289587, 243.50434362617378, -590.1158040208508, -910.5223485254966, -83.42037261171444, -567.2568116171894, 23.66410306845487, -1176.948827469389, -847.8351194502504, -931.5581715855562, 27.993211180877385, -822.24739149603, -304.0183110549114, -1095.254987310202, -974.7641370765169, -1398.1996085648163, -376.0103730625501, -221.02599602772716, -1102.4306793679987, -676.2726456610966, -1420.105092135019, 52.97992742372671, -1125.875199967215, -1134.5777339556846, -1244.5343378990342, 359.87460403183593, -860.8236612010754, -1171.9762191152754, -427.12941024076935, -868.328874429702, -413.7597080247395, -617.9695016286457, -817.1367945498349, -881.133268599557, -488.20962104098624, -253.2249502012282, -462.15075786937575, -487.2129609049243, -356.1928827352496, -344.8888926405681, -897.8077123788814, -126.65011668263624, -1073.2031751481743, -935.481728584402, -601.8757350961113, -226.67001763475847, -848.7633361593614, 93.2588535243851, -1323.5900758294722, -826.7893275445903, 51.52775017587073, -791.5819193745588, -690.0034177598054, -954.7042065312488, -263.7307012178721, -1149.0542650906748, 38.87256818609785, -788.650486819926, -114.75335735492223], "policy_predator_policy_reward": [652.9556409688612, 1149.9802591675248, 947.1340552718852, 1349.391761450797, 1079.649410353235, 881.9001739036015, 1212.2861545343453, 1287.4771179739776, 52.56731957268012, 600.0304731999317, 179.85707534911796, 460.40258507039744, 1163.4956779941083, 1071.1135651402185, 1531.9921366963033, 220.6517409796356, 572.7512770196282, 1139.1889260742391, 772.6833651565724, 12.123725369070263, 1274.006213872986, 904.4633017560586, 1187.3026745759264, 588.4159415639223, 969.7856895185018, 462.2315095703089, 418.8743377853793, 848.366200296857, 763.7897911524165, 1319.5132518277655, 573.5829576108185, 1059.2627492191514, 1140.4995260892335, 1159.6207661827464, 1439.1832942176234, 1191.4112227874487, 954.0325699555588, 306.1730725739099, 796.863859423072, 920.2256785957741, 737.7056136453003, 27.937268874170897, 318.1955484455366, 561.6910820458266, 319.14290306125514, 756.4911823780948, 513.5439829002023, 653.9262415270639, 1086.5002428899606, 1228.2590238862226, 361.2446110643781, 51.338561540681596, 1002.2403775200102, 956.2198309986692, 1240.3901325980837, 138.16292612094836, 37.2914739037322, 138.76858240978908, 30.028121227293557, 0.0, 515.8991715435602, 592.3630957130425, 285.1400764086179, 1079.857997112331, 461.1356829703768, 951.2383577020339, 844.1054885911609, 618.7755679436661, 706.6156141029745, 718.9023446616707, 1397.9171659365882, 584.653334521885, 647.5972419841927, 436.5519725472107, 1096.330093397972, 925.8113976468798, 1182.1992650661834, 924.0695421662833, 368.170671983033, 367.5741483074323, 1137.2529452363208, 578.7970830800134, 1186.5267876981386, 453.0159883312442, 209.60166884837437, 685.2639287776454, 0.0, 1017.4904516943086, 1482.9326097520295, 68.68941052217463, 116.24128214407988, 944.4648315642431, 564.7301304322876, 1154.7985654111155, 957.1754848181231, 347.1691628733689, 1111.2426271176398, 552.0824965322704, 828.5514381997093, 1047.572592374266, 1239.9762038365639, 1052.9164019318093, 795.0154855816978, 1161.0684476921788, 980.7251553340827, 128.00433443470047, 16.652559129562963, 257.2886891719859, 1011.8428319902812, 1099.8987831339616, 77.67744254055349, 75.14708120324838, 9.571622830234071, 279.14229903774486, 375.6388490338122, 380.3958573734436, 822.1959564117315, 637.2535834662638, 1403.0207426330903, 716.1739335642134, 982.6248525399463, 648.7287372243759, 49.88666401284814, 467.35528908536236, 1040.264683949197, 428.46950681792384, 611.2131655602307, 598.9263196785496, 52.372795125149274, 612.1700328932733, 489.8634360351063, 1291.6041049380124, 659.6114014598571, 849.8892990280215, 1036.7201635962174, 1090.516743528568, 25.227183799573346, 12.841070754929918, 575.8805448268023, 942.8029471180555, 1006.457641898501, 668.7139945380762, 111.02358291276495, 632.1723327355253, 835.7995505111759, 614.0659793820803, 325.22163060751274, 426.2936586886619, 1176.948827469389, 869.64995164877, 936.2581715855564, 11.106788819122722, 49.32097149255869, 1289.6620513706362, 1095.254987310202, 980.9641370765183, 1325.8762145260264, 886.1988071145801, 431.57027978607766, 1102.5306793679986, 686.0726456610987, 1420.3050921350189, 265.56887578793015, 1079.8196459953533, 1135.177733955684, 1245.4343378990343, 811.4211447223626, 122.77516147566351, 1084.6602351850709, 857.7616140666074, 880.4536722396807, 931.0410169014029, 693.1847745606728, 878.6672425336882, 965.9870509879812, 615.1894927434912, 424.494286688261, 637.8748104440111, 198.0209439141972, 793.9912727288176, 439.68889264056764, 898.9077123788817, 1046.8041934599103, 503.9682712234172, 935.481728584402, 751.1539942015496, 768.3553370908937, 520.3639150131091, 382.679944299979, 1305.9950799468863, 667.7569074796581, 360.9905835704488, 852.6260154120652, 757.1137037474091, 889.4700611170132, 503.72746353366983, 2.954578529105152, 1152.1542650906747, 1153.0587261380483, 140.2830206189164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4996637107983877, "mean_inference_ms": 3.258472261999094, "mean_action_processing_ms": 1.193935110475584, "mean_env_wait_ms": 9.877738035312216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023146629333496094, "StateBufferConnector_ms": 0.004248142242431641, "ViewRequirementAgentConnector_ms": 0.12193286418914795}, "num_episodes": 12, "episode_return_max": 1007.2290167894506, "episode_return_min": 0.3000000000000034, "episode_return_mean": 219.0093262766315, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.51019951197313, "num_env_steps_trained_throughput_per_sec": 81.51019951197313, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 48500.544, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48500.466, "sample_time_ms": 2161.782, "learn_time_ms": 46322.215, "learn_throughput": 86.352, "synch_weights_time_ms": 13.723}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "fed12_00000", "date": "2024-08-21_18-47-43", "timestamp": 1724246263, "time_this_iter_s": 49.138449907302856, "time_total_s": 2587.746239900589, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4c4e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2587.746239900589, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 25.95571428571429, "ram_util_percent": 82.64000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.798032251867667, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.089393731021376, "policy_loss": -0.020144851183858774, "vf_loss": 7.106726804864469, "vf_explained_var": 0.5285582312515804, "kl": 0.014058914354622917, "entropy": 0.7219028393112162, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.119230176784374, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.917575419895233, "policy_loss": -0.016955955150887055, "vf_loss": 6.932211110705421, "vf_explained_var": 0.401142167824286, "kl": 0.011601449249967657, "entropy": 0.5635596657083148, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 1007.2290167894506, "episode_reward_min": 0.3000000000000034, "episode_reward_mean": 234.9133464158228, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1482.7326097520297, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 378.0887703982779, "predator_policy": 1482.9326097520295}, "policy_reward_mean": {"prey_policy": -580.9225254983211, "predator_policy": 698.3791987062328}, "custom_metrics": {}, "hist_stats": {"episode_reward": [247.74428563367744, 92.8697797915813, 58.228103496477544, 24.28803699831049, 184.90000000000006, 35.51458186276672, 2.300000000000013, 333.2533463710207, 176.58461985232051, 301.9223791098314, 267.8999999999994, 401.551940800595, 511.6392503765653, 10.048476038482693, 99.48716063268546, 1007.2290167894506, 135.09359353923298, 72.75843523174174, 257.39999999999725, 26.768271899214426, 175.96312457953053, 314.18236562683614, 154.07628006207477, 70.58741838905371, 99.68413965285046, 655.0952599470447, 0.3000000000000034, 7.999999999999998, 292.9357143661158, 642.7018163238038, 171.75322302884635, 224.10538215534336, 153.1193783452191, 171.90180950783287, 432.39823415384336, 187.80273678694047, 269.983350341652, 39.679247038151736, 379.72678763019775, 8.900000000000004, 119.16212502666968, 267.6903403665541, 252.49999999999912, 10.2, 278.647585032292, 206.49999999999739, 257.527143922233, 285.64456131207123, 442.5118103694647, 162.19107317230632, 45.05721248023007, 180.288713467237, 177.14454451292087, 205.57868380321875, 149.80777668114763, 811.0886215321378, 1.7363459941291306, 77.19999999999989, 719.891244234906, 347.4294589092781, 396.584455253612, 455.92280875604547, 207.92258074743927, 21.814832198519603, 43.80000000000033, 212.71732031225343, 6.199999999999992, 437.8650400132392, 210.644283758349, 9.999999999999984, 272.49324923979674, 1.4999999999999976, 433.2472490287871, 343.31621989563325, 529.4061066866436, 136.7457209158783, 211.83365409092764, 346.9933890616673, 148.60637300283904, 95.89999999999988, 350.9191728525175, 149.2782591054371, 213.2858983098854, 458.34380194178016, 253.485913681386, 128.15438202511, 174.7626169015549, 44.927146715203044, 389.9379025821158, 206.83084477678113, 279.76420740658864, 122.62477347116008, 234.32796256065794, 235.4690003262302, 477.29462732428937, 149.60000000000008, 347.7108203479908, 121.27767956386512, 226.77399942686338, 704.8775621251511], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1210.3363159023663, -317.6380146038007, -624.0456023036172, -715.1018169936086, -185.94309156928733, -1023.0693430164742, -947.4809367629523, -1111.5340692189213, -411.2829576108177, -1036.6627492191515, -1199.025000928508, -1065.5807094807092, -1437.1832942176234, -1191.111222787449, -160.9939993194212, -765.9582968390304, -460.66329807400075, -1079.8416200925328, -61.58722756372512, -402.1332758459119, -65.29554844553638, -546.6910820458232, -112.14698799124616, -561.9351566475075, -523.9748003215647, -131.8561737291367, -1055.5220963744177, -1249.1886943632876, -337.84461106437277, 24.74859909200553, 320.04160377569724, -1271.2727955049293, -528.46439501323, -714.9950701665633, 3.3669613280096287, -106.6685824097909, 30.735580107043464, 196.63629866566225, -498.8963519766779, -582.5976433807028, -402.8783839322321, -786.1565650091836, -139.9978371262155, -958.1938379193601, -739.280526287948, -569.5242501848021, -884.3569922190529, -470.57354815653525, -931.4891289023927, -951.3972319032306, -485.27366990968164, 56.219715325322085, -1096.230093397972, -925.6113976468797, -917.4695421662832, -1180.7992650661834, -176.97976084730692, -265.82934507704, -689.322296097086, -384.02591589544846, -1186.5267876981386, -281.2627653023912, 32.849503734868584, -703.6097192055431, -581.3357147576162, -283.0353585914642, -1482.7326097520297, 103.0123989856584, -1006.3966499527565, 378.0887703982779, -945.3752058467745, -586.3507532096833, 155.6732558228392, -1190.0345531726787, -1111.14262711764, -512.5032494941171, -991.4202134718181, -504.97702947195916, -1239.9762038365639, -1044.0164019318086, -678.154522498129, -1158.7672857490752, -947.6845754309486, 106.64542602872014, 25.472010083830366, -46.91325838537938, -1011.042831990281, -1090.498783133961, -38.42127163432363, 164.24433292281452, -7.215547698830942, -74.99837416914977, 39.154817033053064, -537.6623795180728, 35.92114877125673, -1209.7261273371803, -1430.1095369150307, -246.57332891280572, -474.17884569357136, -994.9836708984442, -68.22604244727233, -403.95869817070513, -365.9196956759513, -922.5257816239332, -639.2972435739069, -393.6976971519453, -306.4016332588706, -152.56251095633058, -804.4347906314368, -827.2249736605336, 250.99173869954618, -949.4038176552892, -1035.483817602088, -1090.016743528568, 13.1728162004267, 25.958929245070156, -913.9098807728278, 115.11763306287581, -986.5622951983391, -341.1798823289587, 243.50434362617378, -590.1158040208508, -910.5223485254966, -83.42037261171444, -567.2568116171894, 23.66410306845487, -1176.948827469389, -847.8351194502504, -931.5581715855562, 27.993211180877385, -822.24739149603, -304.0183110549114, -1095.254987310202, -974.7641370765169, -1398.1996085648163, -376.0103730625501, -221.02599602772716, -1102.4306793679987, -676.2726456610966, -1420.105092135019, 52.97992742372671, -1125.875199967215, -1134.5777339556846, -1244.5343378990342, 359.87460403183593, -860.8236612010754, -1171.9762191152754, -427.12941024076935, -868.328874429702, -413.7597080247395, -617.9695016286457, -817.1367945498349, -881.133268599557, -488.20962104098624, -253.2249502012282, -462.15075786937575, -487.2129609049243, -356.1928827352496, -344.8888926405681, -897.8077123788814, -126.65011668263624, -1073.2031751481743, -935.481728584402, -601.8757350961113, -226.67001763475847, -848.7633361593614, 93.2588535243851, -1323.5900758294722, -826.7893275445903, 51.52775017587073, -791.5819193745588, -690.0034177598054, -954.7042065312488, -263.7307012178721, -1149.0542650906748, 38.87256818609785, -788.650486819926, -114.75335735492223, -1207.1851098631478, -706.3422805765049, -926.1941458038798, -108.42977669069128, -415.3546689829987, -812.5232748279826, -75.10099960506655, -781.4988021048885, -981.3002274571983, -269.8515572081925, 287.44846529530747, -200.71670811165578, -1267.2800825112822, -296.32186181406644, -248.6720874254442, -1016.862943208231, -925.6643324119982, -34.058184440420405, -934.7061200563862, -20.809688670433474, -794.9854633776118, 96.94298748138436], "policy_predator_policy_reward": [1187.3026745759264, 588.4159415639223, 969.7856895185018, 462.2315095703089, 418.8743377853793, 848.366200296857, 763.7897911524165, 1319.5132518277655, 573.5829576108185, 1059.2627492191514, 1140.4995260892335, 1159.6207661827464, 1439.1832942176234, 1191.4112227874487, 954.0325699555588, 306.1730725739099, 796.863859423072, 920.2256785957741, 737.7056136453003, 27.937268874170897, 318.1955484455366, 561.6910820458266, 319.14290306125514, 756.4911823780948, 513.5439829002023, 653.9262415270639, 1086.5002428899606, 1228.2590238862226, 361.2446110643781, 51.338561540681596, 1002.2403775200102, 956.2198309986692, 1240.3901325980837, 138.16292612094836, 37.2914739037322, 138.76858240978908, 30.028121227293557, 0.0, 515.8991715435602, 592.3630957130425, 285.1400764086179, 1079.857997112331, 461.1356829703768, 951.2383577020339, 844.1054885911609, 618.7755679436661, 706.6156141029745, 718.9023446616707, 1397.9171659365882, 584.653334521885, 647.5972419841927, 436.5519725472107, 1096.330093397972, 925.8113976468798, 1182.1992650661834, 924.0695421662833, 368.170671983033, 367.5741483074323, 1137.2529452363208, 578.7970830800134, 1186.5267876981386, 453.0159883312442, 209.60166884837437, 685.2639287776454, 0.0, 1017.4904516943086, 1482.9326097520295, 68.68941052217463, 116.24128214407988, 944.4648315642431, 564.7301304322876, 1154.7985654111155, 957.1754848181231, 347.1691628733689, 1111.2426271176398, 552.0824965322704, 828.5514381997093, 1047.572592374266, 1239.9762038365639, 1052.9164019318093, 795.0154855816978, 1161.0684476921788, 980.7251553340827, 128.00433443470047, 16.652559129562963, 257.2886891719859, 1011.8428319902812, 1099.8987831339616, 77.67744254055349, 75.14708120324838, 9.571622830234071, 279.14229903774486, 375.6388490338122, 380.3958573734436, 822.1959564117315, 637.2535834662638, 1403.0207426330903, 716.1739335642134, 982.6248525399463, 648.7287372243759, 49.88666401284814, 467.35528908536236, 1040.264683949197, 428.46950681792384, 611.2131655602307, 598.9263196785496, 52.372795125149274, 612.1700328932733, 489.8634360351063, 1291.6041049380124, 659.6114014598571, 849.8892990280215, 1036.7201635962174, 1090.516743528568, 25.227183799573346, 12.841070754929918, 575.8805448268023, 942.8029471180555, 1006.457641898501, 668.7139945380762, 111.02358291276495, 632.1723327355253, 835.7995505111759, 614.0659793820803, 325.22163060751274, 426.2936586886619, 1176.948827469389, 869.64995164877, 936.2581715855564, 11.106788819122722, 49.32097149255869, 1289.6620513706362, 1095.254987310202, 980.9641370765183, 1325.8762145260264, 886.1988071145801, 431.57027978607766, 1102.5306793679986, 686.0726456610987, 1420.3050921350189, 265.56887578793015, 1079.8196459953533, 1135.177733955684, 1245.4343378990343, 811.4211447223626, 122.77516147566351, 1084.6602351850709, 857.7616140666074, 880.4536722396807, 931.0410169014029, 693.1847745606728, 878.6672425336882, 965.9870509879812, 615.1894927434912, 424.494286688261, 637.8748104440111, 198.0209439141972, 793.9912727288176, 439.68889264056764, 898.9077123788817, 1046.8041934599103, 503.9682712234172, 935.481728584402, 751.1539942015496, 768.3553370908937, 520.3639150131091, 382.679944299979, 1305.9950799468863, 667.7569074796581, 360.9905835704488, 852.6260154120652, 757.1137037474091, 889.4700611170132, 503.72746353366983, 2.954578529105152, 1152.1542650906747, 1153.0587261380483, 140.2830206189164, 1176.6334822060012, 943.7247530104333, 916.7137166927863, 397.6744132083694, 540.4080855377359, 810.0946317444062, 321.68925274094494, 769.2385115296677, 597.3314501520379, 889.2893348395859, 45.446162028981405, 345.11670811165595, 1267.2800825112822, 445.92186181406794, 699.740342651038, 913.5055083306294, 922.041380403216, 158.95881601306962, 219.79786591278815, 962.4919422408947, 722.8058645981189, 680.1141734232589]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4969036566173743, "mean_inference_ms": 3.2665886739658414, "mean_action_processing_ms": 1.1963465670765914, "mean_env_wait_ms": 9.892696596259952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023274898529052734, "StateBufferConnector_ms": 0.00427854061126709, "ViewRequirementAgentConnector_ms": 0.1351398229598999}, "num_episodes": 11, "episode_return_max": 1007.2290167894506, "episode_return_min": 0.3000000000000034, "episode_return_mean": 234.9133464158228, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.28615335846035, "num_env_steps_trained_throughput_per_sec": 81.28615335846035, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 48602.599, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48602.52, "sample_time_ms": 2207.155, "learn_time_ms": 46377.879, "learn_throughput": 86.248, "synch_weights_time_ms": 14.241}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "fed12_00000", "date": "2024-08-21_18-48-32", "timestamp": 1724246312, "time_this_iter_s": 49.250524044036865, "time_total_s": 2636.996763944626, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f317160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2636.996763944626, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 28.14927536231884, "ram_util_percent": 82.60289855072465}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.736927764630192, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.313408663159325, "policy_loss": -0.018441718613615547, "vf_loss": 7.329653977338599, "vf_explained_var": 0.5387705638610497, "kl": 0.010981971757466753, "entropy": 0.6336868616323622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.952116767943851, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.60701134520233, "policy_loss": -0.01701557137683113, "vf_loss": 6.621663801758378, "vf_explained_var": 0.42648164570016206, "kl": 0.011815593228921806, "entropy": 0.5564725528160731, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 811.0886215321378, "episode_reward_min": 0.3000000000000034, "episode_reward_mean": 248.55773897333992, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1482.7326097520297, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 378.0887703982779, "predator_policy": 1482.9326097520295}, "policy_reward_mean": {"prey_policy": -542.6235057417811, "predator_policy": 666.9023752284515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [135.09359353923298, 72.75843523174174, 257.39999999999725, 26.768271899214426, 175.96312457953053, 314.18236562683614, 154.07628006207477, 70.58741838905371, 99.68413965285046, 655.0952599470447, 0.3000000000000034, 7.999999999999998, 292.9357143661158, 642.7018163238038, 171.75322302884635, 224.10538215534336, 153.1193783452191, 171.90180950783287, 432.39823415384336, 187.80273678694047, 269.983350341652, 39.679247038151736, 379.72678763019775, 8.900000000000004, 119.16212502666968, 267.6903403665541, 252.49999999999912, 10.2, 278.647585032292, 206.49999999999739, 257.527143922233, 285.64456131207123, 442.5118103694647, 162.19107317230632, 45.05721248023007, 180.288713467237, 177.14454451292087, 205.57868380321875, 149.80777668114763, 811.0886215321378, 1.7363459941291306, 77.19999999999989, 719.891244234906, 347.4294589092781, 396.584455253612, 455.92280875604547, 207.92258074743927, 21.814832198519603, 43.80000000000033, 212.71732031225343, 6.199999999999992, 437.8650400132392, 210.644283758349, 9.999999999999984, 272.49324923979674, 1.4999999999999976, 433.2472490287871, 343.31621989563325, 529.4061066866436, 136.7457209158783, 211.83365409092764, 346.9933890616673, 148.60637300283904, 95.89999999999988, 350.9191728525175, 149.2782591054371, 213.2858983098854, 458.34380194178016, 253.485913681386, 128.15438202511, 174.7626169015549, 44.927146715203044, 389.9379025821158, 206.83084477678113, 279.76420740658864, 122.62477347116008, 234.32796256065794, 235.4690003262302, 477.29462732428937, 149.60000000000008, 347.7108203479908, 121.27767956386512, 226.77399942686338, 704.8775621251511, 377.3012268494266, 283.514896951908, 300.3435637685385, 228.73842140799044, 651.7548058731606, 721.5428036386983, 308.51623651061976, 140.57448522978152, 256.7650053604331, 432.6419275028986, 599.3220424816591, 228.40466009762062, 321.3999999999997, 53.903446005014985, 13.699999999999987, 201.47671182772316], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-528.46439501323, -714.9950701665633, 3.3669613280096287, -106.6685824097909, 30.735580107043464, 196.63629866566225, -498.8963519766779, -582.5976433807028, -402.8783839322321, -786.1565650091836, -139.9978371262155, -958.1938379193601, -739.280526287948, -569.5242501848021, -884.3569922190529, -470.57354815653525, -931.4891289023927, -951.3972319032306, -485.27366990968164, 56.219715325322085, -1096.230093397972, -925.6113976468797, -917.4695421662832, -1180.7992650661834, -176.97976084730692, -265.82934507704, -689.322296097086, -384.02591589544846, -1186.5267876981386, -281.2627653023912, 32.849503734868584, -703.6097192055431, -581.3357147576162, -283.0353585914642, -1482.7326097520297, 103.0123989856584, -1006.3966499527565, 378.0887703982779, -945.3752058467745, -586.3507532096833, 155.6732558228392, -1190.0345531726787, -1111.14262711764, -512.5032494941171, -991.4202134718181, -504.97702947195916, -1239.9762038365639, -1044.0164019318086, -678.154522498129, -1158.7672857490752, -947.6845754309486, 106.64542602872014, 25.472010083830366, -46.91325838537938, -1011.042831990281, -1090.498783133961, -38.42127163432363, 164.24433292281452, -7.215547698830942, -74.99837416914977, 39.154817033053064, -537.6623795180728, 35.92114877125673, -1209.7261273371803, -1430.1095369150307, -246.57332891280572, -474.17884569357136, -994.9836708984442, -68.22604244727233, -403.95869817070513, -365.9196956759513, -922.5257816239332, -639.2972435739069, -393.6976971519453, -306.4016332588706, -152.56251095633058, -804.4347906314368, -827.2249736605336, 250.99173869954618, -949.4038176552892, -1035.483817602088, -1090.016743528568, 13.1728162004267, 25.958929245070156, -913.9098807728278, 115.11763306287581, -986.5622951983391, -341.1798823289587, 243.50434362617378, -590.1158040208508, -910.5223485254966, -83.42037261171444, -567.2568116171894, 23.66410306845487, -1176.948827469389, -847.8351194502504, -931.5581715855562, 27.993211180877385, -822.24739149603, -304.0183110549114, -1095.254987310202, -974.7641370765169, -1398.1996085648163, -376.0103730625501, -221.02599602772716, -1102.4306793679987, -676.2726456610966, -1420.105092135019, 52.97992742372671, -1125.875199967215, -1134.5777339556846, -1244.5343378990342, 359.87460403183593, -860.8236612010754, -1171.9762191152754, -427.12941024076935, -868.328874429702, -413.7597080247395, -617.9695016286457, -817.1367945498349, -881.133268599557, -488.20962104098624, -253.2249502012282, -462.15075786937575, -487.2129609049243, -356.1928827352496, -344.8888926405681, -897.8077123788814, -126.65011668263624, -1073.2031751481743, -935.481728584402, -601.8757350961113, -226.67001763475847, -848.7633361593614, 93.2588535243851, -1323.5900758294722, -826.7893275445903, 51.52775017587073, -791.5819193745588, -690.0034177598054, -954.7042065312488, -263.7307012178721, -1149.0542650906748, 38.87256818609785, -788.650486819926, -114.75335735492223, -1207.1851098631478, -706.3422805765049, -926.1941458038798, -108.42977669069128, -415.3546689829987, -812.5232748279826, -75.10099960506655, -781.4988021048885, -981.3002274571983, -269.8515572081925, 287.44846529530747, -200.71670811165578, -1267.2800825112822, -296.32186181406644, -248.6720874254442, -1016.862943208231, -925.6643324119982, -34.058184440420405, -934.7061200563862, -20.809688670433474, -794.9854633776118, 96.94298748138436, -0.16650875055056247, -483.4569385501792, 83.50510970507307, -1050.4360838951627, -620.6698784194086, 18.153240359431557, -564.704723226022, -1062.7340819977303, -540.2403763216333, 360.4663521593099, -463.8489734905718, -214.2482756411048, -783.0032234457492, -223.21587348191937, -565.0065905314513, 34.33593649181358, 27.98462289950596, -441.5709602193864, -936.6884619868433, 69.01968596641504, 37.508385326518486, -1265.0731828789328, -1001.8633458425749, -256.2587792923807, 28.860902252580285, 258.26631781378416, -916.7244233340798, -287.4794274043576, -1042.9821873772037, -821.7577110147506, -303.28400841372445, -330.9931721207346], "policy_predator_policy_reward": [1240.3901325980837, 138.16292612094836, 37.2914739037322, 138.76858240978908, 30.028121227293557, 0.0, 515.8991715435602, 592.3630957130425, 285.1400764086179, 1079.857997112331, 461.1356829703768, 951.2383577020339, 844.1054885911609, 618.7755679436661, 706.6156141029745, 718.9023446616707, 1397.9171659365882, 584.653334521885, 647.5972419841927, 436.5519725472107, 1096.330093397972, 925.8113976468798, 1182.1992650661834, 924.0695421662833, 368.170671983033, 367.5741483074323, 1137.2529452363208, 578.7970830800134, 1186.5267876981386, 453.0159883312442, 209.60166884837437, 685.2639287776454, 0.0, 1017.4904516943086, 1482.9326097520295, 68.68941052217463, 116.24128214407988, 944.4648315642431, 564.7301304322876, 1154.7985654111155, 957.1754848181231, 347.1691628733689, 1111.2426271176398, 552.0824965322704, 828.5514381997093, 1047.572592374266, 1239.9762038365639, 1052.9164019318093, 795.0154855816978, 1161.0684476921788, 980.7251553340827, 128.00433443470047, 16.652559129562963, 257.2886891719859, 1011.8428319902812, 1099.8987831339616, 77.67744254055349, 75.14708120324838, 9.571622830234071, 279.14229903774486, 375.6388490338122, 380.3958573734436, 822.1959564117315, 637.2535834662638, 1403.0207426330903, 716.1739335642134, 982.6248525399463, 648.7287372243759, 49.88666401284814, 467.35528908536236, 1040.264683949197, 428.46950681792384, 611.2131655602307, 598.9263196785496, 52.372795125149274, 612.1700328932733, 489.8634360351063, 1291.6041049380124, 659.6114014598571, 849.8892990280215, 1036.7201635962174, 1090.516743528568, 25.227183799573346, 12.841070754929918, 575.8805448268023, 942.8029471180555, 1006.457641898501, 668.7139945380762, 111.02358291276495, 632.1723327355253, 835.7995505111759, 614.0659793820803, 325.22163060751274, 426.2936586886619, 1176.948827469389, 869.64995164877, 936.2581715855564, 11.106788819122722, 49.32097149255869, 1289.6620513706362, 1095.254987310202, 980.9641370765183, 1325.8762145260264, 886.1988071145801, 431.57027978607766, 1102.5306793679986, 686.0726456610987, 1420.3050921350189, 265.56887578793015, 1079.8196459953533, 1135.177733955684, 1245.4343378990343, 811.4211447223626, 122.77516147566351, 1084.6602351850709, 857.7616140666074, 880.4536722396807, 931.0410169014029, 693.1847745606728, 878.6672425336882, 965.9870509879812, 615.1894927434912, 424.494286688261, 637.8748104440111, 198.0209439141972, 793.9912727288176, 439.68889264056764, 898.9077123788817, 1046.8041934599103, 503.9682712234172, 935.481728584402, 751.1539942015496, 768.3553370908937, 520.3639150131091, 382.679944299979, 1305.9950799468863, 667.7569074796581, 360.9905835704488, 852.6260154120652, 757.1137037474091, 889.4700611170132, 503.72746353366983, 2.954578529105152, 1152.1542650906747, 1153.0587261380483, 140.2830206189164, 1176.6334822060012, 943.7247530104333, 916.7137166927863, 397.6744132083694, 540.4080855377359, 810.0946317444062, 321.68925274094494, 769.2385115296677, 597.3314501520379, 889.2893348395859, 45.446162028981405, 345.11670811165595, 1267.2800825112822, 445.92186181406794, 699.740342651038, 913.5055083306294, 922.041380403216, 158.95881601306962, 219.79786591278815, 962.4919422408947, 722.8058645981189, 680.1141734232589, 289.0556909681161, 571.8689831820413, 215.83104423466207, 1034.6148269073367, 465.27100923575694, 437.5891925927598, 1062.8293092218296, 793.3479174099174, 341.98763314007675, 489.5411968954068, 853.7233347363219, 545.916718034053, 638.350836273914, 676.3844971643784, 659.2200865351417, 12.025052734279395, 276.0946225649444, 394.25672011537785, 433.15189954738656, 867.1588039759409, 654.2973405225268, 1172.58949951154, 737.2689093796483, 749.2578758529302, 10.339097747419835, 23.933682186215773, 916.7244233340798, 341.382873409372, 1045.4821873772041, 832.957711014753, 711.0274874609585, 124.72640490123777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.495147666841796, "mean_inference_ms": 3.265499465889493, "mean_action_processing_ms": 1.19582918842832, "mean_env_wait_ms": 9.906151213224536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023176074028015137, "StateBufferConnector_ms": 0.00429379940032959, "ViewRequirementAgentConnector_ms": 0.12156105041503906}, "num_episodes": 16, "episode_return_max": 811.0886215321378, "episode_return_min": 0.3000000000000034, "episode_return_mean": 248.55773897333992, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.45061196000489, "num_env_steps_trained_throughput_per_sec": 82.45061196000489, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 48623.068, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48623.016, "sample_time_ms": 2195.024, "learn_time_ms": 46410.586, "learn_throughput": 86.187, "synch_weights_time_ms": 14.389}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "fed12_00000", "date": "2024-08-21_18-49-21", "timestamp": 1724246361, "time_this_iter_s": 48.55206298828125, "time_total_s": 2685.548826932907, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f33f5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2685.548826932907, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 25.546376811594204, "ram_util_percent": 79.23913043478262}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.45133057138907, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.244064153943743, "policy_loss": -0.020219228611445973, "vf_loss": 7.2617376579809445, "vf_explained_var": 0.46436520477451343, "kl": 0.01272867952631146, "entropy": 0.6096494944164993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.218452143290687, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.14386742051947, "policy_loss": -0.016977753861753084, "vf_loss": 7.158420525909101, "vf_explained_var": 0.2434176430815742, "kl": 0.012123233349451786, "entropy": 0.5052103075558546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 811.0886215321378, "episode_reward_min": 0.3000000000000034, "episode_reward_mean": 252.0224554253659, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1482.7326097520297, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 378.0887703982779, "predator_policy": 1482.9326097520295}, "policy_reward_mean": {"prey_policy": -541.7441776593099, "predator_policy": 667.7554053719932}, "custom_metrics": {}, "hist_stats": {"episode_reward": [99.68413965285046, 655.0952599470447, 0.3000000000000034, 7.999999999999998, 292.9357143661158, 642.7018163238038, 171.75322302884635, 224.10538215534336, 153.1193783452191, 171.90180950783287, 432.39823415384336, 187.80273678694047, 269.983350341652, 39.679247038151736, 379.72678763019775, 8.900000000000004, 119.16212502666968, 267.6903403665541, 252.49999999999912, 10.2, 278.647585032292, 206.49999999999739, 257.527143922233, 285.64456131207123, 442.5118103694647, 162.19107317230632, 45.05721248023007, 180.288713467237, 177.14454451292087, 205.57868380321875, 149.80777668114763, 811.0886215321378, 1.7363459941291306, 77.19999999999989, 719.891244234906, 347.4294589092781, 396.584455253612, 455.92280875604547, 207.92258074743927, 21.814832198519603, 43.80000000000033, 212.71732031225343, 6.199999999999992, 437.8650400132392, 210.644283758349, 9.999999999999984, 272.49324923979674, 1.4999999999999976, 433.2472490287871, 343.31621989563325, 529.4061066866436, 136.7457209158783, 211.83365409092764, 346.9933890616673, 148.60637300283904, 95.89999999999988, 350.9191728525175, 149.2782591054371, 213.2858983098854, 458.34380194178016, 253.485913681386, 128.15438202511, 174.7626169015549, 44.927146715203044, 389.9379025821158, 206.83084477678113, 279.76420740658864, 122.62477347116008, 234.32796256065794, 235.4690003262302, 477.29462732428937, 149.60000000000008, 347.7108203479908, 121.27767956386512, 226.77399942686338, 704.8775621251511, 377.3012268494266, 283.514896951908, 300.3435637685385, 228.73842140799044, 651.7548058731606, 721.5428036386983, 308.51623651061976, 140.57448522978152, 256.7650053604331, 432.6419275028986, 599.3220424816591, 228.40466009762062, 321.3999999999997, 53.903446005014985, 13.699999999999987, 201.47671182772316, 83.7660990348499, 123.70000000000009, 314.90265133046336, 273.68259905750966, 174.88408806180223, 190.1344437548424, 259.7293351302916, 132.5019181605285], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-931.4891289023927, -951.3972319032306, -485.27366990968164, 56.219715325322085, -1096.230093397972, -925.6113976468797, -917.4695421662832, -1180.7992650661834, -176.97976084730692, -265.82934507704, -689.322296097086, -384.02591589544846, -1186.5267876981386, -281.2627653023912, 32.849503734868584, -703.6097192055431, -581.3357147576162, -283.0353585914642, -1482.7326097520297, 103.0123989856584, -1006.3966499527565, 378.0887703982779, -945.3752058467745, -586.3507532096833, 155.6732558228392, -1190.0345531726787, -1111.14262711764, -512.5032494941171, -991.4202134718181, -504.97702947195916, -1239.9762038365639, -1044.0164019318086, -678.154522498129, -1158.7672857490752, -947.6845754309486, 106.64542602872014, 25.472010083830366, -46.91325838537938, -1011.042831990281, -1090.498783133961, -38.42127163432363, 164.24433292281452, -7.215547698830942, -74.99837416914977, 39.154817033053064, -537.6623795180728, 35.92114877125673, -1209.7261273371803, -1430.1095369150307, -246.57332891280572, -474.17884569357136, -994.9836708984442, -68.22604244727233, -403.95869817070513, -365.9196956759513, -922.5257816239332, -639.2972435739069, -393.6976971519453, -306.4016332588706, -152.56251095633058, -804.4347906314368, -827.2249736605336, 250.99173869954618, -949.4038176552892, -1035.483817602088, -1090.016743528568, 13.1728162004267, 25.958929245070156, -913.9098807728278, 115.11763306287581, -986.5622951983391, -341.1798823289587, 243.50434362617378, -590.1158040208508, -910.5223485254966, -83.42037261171444, -567.2568116171894, 23.66410306845487, -1176.948827469389, -847.8351194502504, -931.5581715855562, 27.993211180877385, -822.24739149603, -304.0183110549114, -1095.254987310202, -974.7641370765169, -1398.1996085648163, -376.0103730625501, -221.02599602772716, -1102.4306793679987, -676.2726456610966, -1420.105092135019, 52.97992742372671, -1125.875199967215, -1134.5777339556846, -1244.5343378990342, 359.87460403183593, -860.8236612010754, -1171.9762191152754, -427.12941024076935, -868.328874429702, -413.7597080247395, -617.9695016286457, -817.1367945498349, -881.133268599557, -488.20962104098624, -253.2249502012282, -462.15075786937575, -487.2129609049243, -356.1928827352496, -344.8888926405681, -897.8077123788814, -126.65011668263624, -1073.2031751481743, -935.481728584402, -601.8757350961113, -226.67001763475847, -848.7633361593614, 93.2588535243851, -1323.5900758294722, -826.7893275445903, 51.52775017587073, -791.5819193745588, -690.0034177598054, -954.7042065312488, -263.7307012178721, -1149.0542650906748, 38.87256818609785, -788.650486819926, -114.75335735492223, -1207.1851098631478, -706.3422805765049, -926.1941458038798, -108.42977669069128, -415.3546689829987, -812.5232748279826, -75.10099960506655, -781.4988021048885, -981.3002274571983, -269.8515572081925, 287.44846529530747, -200.71670811165578, -1267.2800825112822, -296.32186181406644, -248.6720874254442, -1016.862943208231, -925.6643324119982, -34.058184440420405, -934.7061200563862, -20.809688670433474, -794.9854633776118, 96.94298748138436, -0.16650875055056247, -483.4569385501792, 83.50510970507307, -1050.4360838951627, -620.6698784194086, 18.153240359431557, -564.704723226022, -1062.7340819977303, -540.2403763216333, 360.4663521593099, -463.8489734905718, -214.2482756411048, -783.0032234457492, -223.21587348191937, -565.0065905314513, 34.33593649181358, 27.98462289950596, -441.5709602193864, -936.6884619868433, 69.01968596641504, 37.508385326518486, -1265.0731828789328, -1001.8633458425749, -256.2587792923807, 28.860902252580285, 258.26631781378416, -916.7244233340798, -287.4794274043576, -1042.9821873772037, -821.7577110147506, -303.28400841372445, -330.9931721207346, -680.0396626269858, -716.089090238515, -246.5580175746373, 38.08256147629059, -47.25447106886412, -709.4101718099421, 151.63440845971596, -578.7434909955183, -397.3504273116207, -59.416761499891834, -166.09120042215824, -989.366684653521, -720.7856354283856, -422.92865862449605, -1146.0572807840826, -285.60494408473795], "policy_predator_policy_reward": [1397.9171659365882, 584.653334521885, 647.5972419841927, 436.5519725472107, 1096.330093397972, 925.8113976468798, 1182.1992650661834, 924.0695421662833, 368.170671983033, 367.5741483074323, 1137.2529452363208, 578.7970830800134, 1186.5267876981386, 453.0159883312442, 209.60166884837437, 685.2639287776454, 0.0, 1017.4904516943086, 1482.9326097520295, 68.68941052217463, 116.24128214407988, 944.4648315642431, 564.7301304322876, 1154.7985654111155, 957.1754848181231, 347.1691628733689, 1111.2426271176398, 552.0824965322704, 828.5514381997093, 1047.572592374266, 1239.9762038365639, 1052.9164019318093, 795.0154855816978, 1161.0684476921788, 980.7251553340827, 128.00433443470047, 16.652559129562963, 257.2886891719859, 1011.8428319902812, 1099.8987831339616, 77.67744254055349, 75.14708120324838, 9.571622830234071, 279.14229903774486, 375.6388490338122, 380.3958573734436, 822.1959564117315, 637.2535834662638, 1403.0207426330903, 716.1739335642134, 982.6248525399463, 648.7287372243759, 49.88666401284814, 467.35528908536236, 1040.264683949197, 428.46950681792384, 611.2131655602307, 598.9263196785496, 52.372795125149274, 612.1700328932733, 489.8634360351063, 1291.6041049380124, 659.6114014598571, 849.8892990280215, 1036.7201635962174, 1090.516743528568, 25.227183799573346, 12.841070754929918, 575.8805448268023, 942.8029471180555, 1006.457641898501, 668.7139945380762, 111.02358291276495, 632.1723327355253, 835.7995505111759, 614.0659793820803, 325.22163060751274, 426.2936586886619, 1176.948827469389, 869.64995164877, 936.2581715855564, 11.106788819122722, 49.32097149255869, 1289.6620513706362, 1095.254987310202, 980.9641370765183, 1325.8762145260264, 886.1988071145801, 431.57027978607766, 1102.5306793679986, 686.0726456610987, 1420.3050921350189, 265.56887578793015, 1079.8196459953533, 1135.177733955684, 1245.4343378990343, 811.4211447223626, 122.77516147566351, 1084.6602351850709, 857.7616140666074, 880.4536722396807, 931.0410169014029, 693.1847745606728, 878.6672425336882, 965.9870509879812, 615.1894927434912, 424.494286688261, 637.8748104440111, 198.0209439141972, 793.9912727288176, 439.68889264056764, 898.9077123788817, 1046.8041934599103, 503.9682712234172, 935.481728584402, 751.1539942015496, 768.3553370908937, 520.3639150131091, 382.679944299979, 1305.9950799468863, 667.7569074796581, 360.9905835704488, 852.6260154120652, 757.1137037474091, 889.4700611170132, 503.72746353366983, 2.954578529105152, 1152.1542650906747, 1153.0587261380483, 140.2830206189164, 1176.6334822060012, 943.7247530104333, 916.7137166927863, 397.6744132083694, 540.4080855377359, 810.0946317444062, 321.68925274094494, 769.2385115296677, 597.3314501520379, 889.2893348395859, 45.446162028981405, 345.11670811165595, 1267.2800825112822, 445.92186181406794, 699.740342651038, 913.5055083306294, 922.041380403216, 158.95881601306962, 219.79786591278815, 962.4919422408947, 722.8058645981189, 680.1141734232589, 289.0556909681161, 571.8689831820413, 215.83104423466207, 1034.6148269073367, 465.27100923575694, 437.5891925927598, 1062.8293092218296, 793.3479174099174, 341.98763314007675, 489.5411968954068, 853.7233347363219, 545.916718034053, 638.350836273914, 676.3844971643784, 659.2200865351417, 12.025052734279395, 276.0946225649444, 394.25672011537785, 433.15189954738656, 867.1588039759409, 654.2973405225268, 1172.58949951154, 737.2689093796483, 749.2578758529302, 10.339097747419835, 23.933682186215773, 916.7244233340798, 341.382873409372, 1045.4821873772041, 832.957711014753, 711.0274874609585, 124.72640490123777, 799.464964117907, 680.4298877824457, 330.45801757464056, 1.7174385237096828, 59.39667342044429, 1012.1706207888221, 104.04819059779315, 596.7434909955224, 439.3988402273332, 192.25243664598278, 982.8833810799995, 362.7089477505235, 941.3639174439197, 462.0797117392551, 1146.0572807840826, 418.10686224526745]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4904546245352104, "mean_inference_ms": 3.256823621353208, "mean_action_processing_ms": 1.2026409357631942, "mean_env_wait_ms": 9.916853168728892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0231935977935791, "StateBufferConnector_ms": 0.004215836524963379, "ViewRequirementAgentConnector_ms": 0.12505316734313965}, "num_episodes": 8, "episode_return_max": 811.0886215321378, "episode_return_min": 0.3000000000000034, "episode_return_mean": 252.0224554253659, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.35034316877243, "num_env_steps_trained_throughput_per_sec": 83.35034316877243, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 48537.452, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48537.4, "sample_time_ms": 2176.26, "learn_time_ms": 46343.91, "learn_throughput": 86.311, "synch_weights_time_ms": 14.381}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "fed12_00000", "date": "2024-08-21_18-50-09", "timestamp": 1724246409, "time_this_iter_s": 48.035167932510376, "time_total_s": 2733.5839948654175, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f491430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2733.5839948654175, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 24.025000000000006, "ram_util_percent": 78.76176470588233}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.43802629564174, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.356960839316958, "policy_loss": -0.018676889923071024, "vf_loss": 7.37291679685078, "vf_explained_var": 0.5505200876129999, "kl": 0.013604683032081951, "entropy": 0.6607940616115692, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.512283209455076, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.164378305465456, "policy_loss": -0.016779715462129505, "vf_loss": 7.1786979819101004, "vf_explained_var": 0.328607839976669, "kl": 0.012300337574607323, "entropy": 0.5135246805570743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 811.0886215321378, "episode_reward_min": 1.4000000000000057, "episode_reward_mean": 252.9960173350517, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1482.7326097520297, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 378.0887703982779, "predator_policy": 1482.9326097520295}, "policy_reward_mean": {"prey_policy": -531.8701113863968, "predator_policy": 658.3681200539232}, "custom_metrics": {}, "hist_stats": {"episode_reward": [642.7018163238038, 171.75322302884635, 224.10538215534336, 153.1193783452191, 171.90180950783287, 432.39823415384336, 187.80273678694047, 269.983350341652, 39.679247038151736, 379.72678763019775, 8.900000000000004, 119.16212502666968, 267.6903403665541, 252.49999999999912, 10.2, 278.647585032292, 206.49999999999739, 257.527143922233, 285.64456131207123, 442.5118103694647, 162.19107317230632, 45.05721248023007, 180.288713467237, 177.14454451292087, 205.57868380321875, 149.80777668114763, 811.0886215321378, 1.7363459941291306, 77.19999999999989, 719.891244234906, 347.4294589092781, 396.584455253612, 455.92280875604547, 207.92258074743927, 21.814832198519603, 43.80000000000033, 212.71732031225343, 6.199999999999992, 437.8650400132392, 210.644283758349, 9.999999999999984, 272.49324923979674, 1.4999999999999976, 433.2472490287871, 343.31621989563325, 529.4061066866436, 136.7457209158783, 211.83365409092764, 346.9933890616673, 148.60637300283904, 95.89999999999988, 350.9191728525175, 149.2782591054371, 213.2858983098854, 458.34380194178016, 253.485913681386, 128.15438202511, 174.7626169015549, 44.927146715203044, 389.9379025821158, 206.83084477678113, 279.76420740658864, 122.62477347116008, 234.32796256065794, 235.4690003262302, 477.29462732428937, 149.60000000000008, 347.7108203479908, 121.27767956386512, 226.77399942686338, 704.8775621251511, 377.3012268494266, 283.514896951908, 300.3435637685385, 228.73842140799044, 651.7548058731606, 721.5428036386983, 308.51623651061976, 140.57448522978152, 256.7650053604331, 432.6419275028986, 599.3220424816591, 228.40466009762062, 321.3999999999997, 53.903446005014985, 13.699999999999987, 201.47671182772316, 83.7660990348499, 123.70000000000009, 314.90265133046336, 273.68259905750966, 174.88408806180223, 190.1344437548424, 259.7293351302916, 132.5019181605285, 419.7496752164659, 1.4000000000000057, 221.97976988892216, 76.36190707465308, 433.87995275454034], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-689.322296097086, -384.02591589544846, -1186.5267876981386, -281.2627653023912, 32.849503734868584, -703.6097192055431, -581.3357147576162, -283.0353585914642, -1482.7326097520297, 103.0123989856584, -1006.3966499527565, 378.0887703982779, -945.3752058467745, -586.3507532096833, 155.6732558228392, -1190.0345531726787, -1111.14262711764, -512.5032494941171, -991.4202134718181, -504.97702947195916, -1239.9762038365639, -1044.0164019318086, -678.154522498129, -1158.7672857490752, -947.6845754309486, 106.64542602872014, 25.472010083830366, -46.91325838537938, -1011.042831990281, -1090.498783133961, -38.42127163432363, 164.24433292281452, -7.215547698830942, -74.99837416914977, 39.154817033053064, -537.6623795180728, 35.92114877125673, -1209.7261273371803, -1430.1095369150307, -246.57332891280572, -474.17884569357136, -994.9836708984442, -68.22604244727233, -403.95869817070513, -365.9196956759513, -922.5257816239332, -639.2972435739069, -393.6976971519453, -306.4016332588706, -152.56251095633058, -804.4347906314368, -827.2249736605336, 250.99173869954618, -949.4038176552892, -1035.483817602088, -1090.016743528568, 13.1728162004267, 25.958929245070156, -913.9098807728278, 115.11763306287581, -986.5622951983391, -341.1798823289587, 243.50434362617378, -590.1158040208508, -910.5223485254966, -83.42037261171444, -567.2568116171894, 23.66410306845487, -1176.948827469389, -847.8351194502504, -931.5581715855562, 27.993211180877385, -822.24739149603, -304.0183110549114, -1095.254987310202, -974.7641370765169, -1398.1996085648163, -376.0103730625501, -221.02599602772716, -1102.4306793679987, -676.2726456610966, -1420.105092135019, 52.97992742372671, -1125.875199967215, -1134.5777339556846, -1244.5343378990342, 359.87460403183593, -860.8236612010754, -1171.9762191152754, -427.12941024076935, -868.328874429702, -413.7597080247395, -617.9695016286457, -817.1367945498349, -881.133268599557, -488.20962104098624, -253.2249502012282, -462.15075786937575, -487.2129609049243, -356.1928827352496, -344.8888926405681, -897.8077123788814, -126.65011668263624, -1073.2031751481743, -935.481728584402, -601.8757350961113, -226.67001763475847, -848.7633361593614, 93.2588535243851, -1323.5900758294722, -826.7893275445903, 51.52775017587073, -791.5819193745588, -690.0034177598054, -954.7042065312488, -263.7307012178721, -1149.0542650906748, 38.87256818609785, -788.650486819926, -114.75335735492223, -1207.1851098631478, -706.3422805765049, -926.1941458038798, -108.42977669069128, -415.3546689829987, -812.5232748279826, -75.10099960506655, -781.4988021048885, -981.3002274571983, -269.8515572081925, 287.44846529530747, -200.71670811165578, -1267.2800825112822, -296.32186181406644, -248.6720874254442, -1016.862943208231, -925.6643324119982, -34.058184440420405, -934.7061200563862, -20.809688670433474, -794.9854633776118, 96.94298748138436, -0.16650875055056247, -483.4569385501792, 83.50510970507307, -1050.4360838951627, -620.6698784194086, 18.153240359431557, -564.704723226022, -1062.7340819977303, -540.2403763216333, 360.4663521593099, -463.8489734905718, -214.2482756411048, -783.0032234457492, -223.21587348191937, -565.0065905314513, 34.33593649181358, 27.98462289950596, -441.5709602193864, -936.6884619868433, 69.01968596641504, 37.508385326518486, -1265.0731828789328, -1001.8633458425749, -256.2587792923807, 28.860902252580285, 258.26631781378416, -916.7244233340798, -287.4794274043576, -1042.9821873772037, -821.7577110147506, -303.28400841372445, -330.9931721207346, -680.0396626269858, -716.089090238515, -246.5580175746373, 38.08256147629059, -47.25447106886412, -709.4101718099421, 151.63440845971596, -578.7434909955183, -397.3504273116207, -59.416761499891834, -166.09120042215824, -989.366684653521, -720.7856354283856, -422.92865862449605, -1146.0572807840826, -285.60494408473795, -159.68397752559534, -214.04859671047092, -1307.5355154323624, -891.4312061338173, 25.03904151361334, -527.0782982780423, -735.9036169573473, -829.7185360871349, 273.6700878251817, -533.3558472230585], "policy_predator_policy_reward": [1137.2529452363208, 578.7970830800134, 1186.5267876981386, 453.0159883312442, 209.60166884837437, 685.2639287776454, 0.0, 1017.4904516943086, 1482.9326097520295, 68.68941052217463, 116.24128214407988, 944.4648315642431, 564.7301304322876, 1154.7985654111155, 957.1754848181231, 347.1691628733689, 1111.2426271176398, 552.0824965322704, 828.5514381997093, 1047.572592374266, 1239.9762038365639, 1052.9164019318093, 795.0154855816978, 1161.0684476921788, 980.7251553340827, 128.00433443470047, 16.652559129562963, 257.2886891719859, 1011.8428319902812, 1099.8987831339616, 77.67744254055349, 75.14708120324838, 9.571622830234071, 279.14229903774486, 375.6388490338122, 380.3958573734436, 822.1959564117315, 637.2535834662638, 1403.0207426330903, 716.1739335642134, 982.6248525399463, 648.7287372243759, 49.88666401284814, 467.35528908536236, 1040.264683949197, 428.46950681792384, 611.2131655602307, 598.9263196785496, 52.372795125149274, 612.1700328932733, 489.8634360351063, 1291.6041049380124, 659.6114014598571, 849.8892990280215, 1036.7201635962174, 1090.516743528568, 25.227183799573346, 12.841070754929918, 575.8805448268023, 942.8029471180555, 1006.457641898501, 668.7139945380762, 111.02358291276495, 632.1723327355253, 835.7995505111759, 614.0659793820803, 325.22163060751274, 426.2936586886619, 1176.948827469389, 869.64995164877, 936.2581715855564, 11.106788819122722, 49.32097149255869, 1289.6620513706362, 1095.254987310202, 980.9641370765183, 1325.8762145260264, 886.1988071145801, 431.57027978607766, 1102.5306793679986, 686.0726456610987, 1420.3050921350189, 265.56887578793015, 1079.8196459953533, 1135.177733955684, 1245.4343378990343, 811.4211447223626, 122.77516147566351, 1084.6602351850709, 857.7616140666074, 880.4536722396807, 931.0410169014029, 693.1847745606728, 878.6672425336882, 965.9870509879812, 615.1894927434912, 424.494286688261, 637.8748104440111, 198.0209439141972, 793.9912727288176, 439.68889264056764, 898.9077123788817, 1046.8041934599103, 503.9682712234172, 935.481728584402, 751.1539942015496, 768.3553370908937, 520.3639150131091, 382.679944299979, 1305.9950799468863, 667.7569074796581, 360.9905835704488, 852.6260154120652, 757.1137037474091, 889.4700611170132, 503.72746353366983, 2.954578529105152, 1152.1542650906747, 1153.0587261380483, 140.2830206189164, 1176.6334822060012, 943.7247530104333, 916.7137166927863, 397.6744132083694, 540.4080855377359, 810.0946317444062, 321.68925274094494, 769.2385115296677, 597.3314501520379, 889.2893348395859, 45.446162028981405, 345.11670811165595, 1267.2800825112822, 445.92186181406794, 699.740342651038, 913.5055083306294, 922.041380403216, 158.95881601306962, 219.79786591278815, 962.4919422408947, 722.8058645981189, 680.1141734232589, 289.0556909681161, 571.8689831820413, 215.83104423466207, 1034.6148269073367, 465.27100923575694, 437.5891925927598, 1062.8293092218296, 793.3479174099174, 341.98763314007675, 489.5411968954068, 853.7233347363219, 545.916718034053, 638.350836273914, 676.3844971643784, 659.2200865351417, 12.025052734279395, 276.0946225649444, 394.25672011537785, 433.15189954738656, 867.1588039759409, 654.2973405225268, 1172.58949951154, 737.2689093796483, 749.2578758529302, 10.339097747419835, 23.933682186215773, 916.7244233340798, 341.382873409372, 1045.4821873772041, 832.957711014753, 711.0274874609585, 124.72640490123777, 799.464964117907, 680.4298877824457, 330.45801757464056, 1.7174385237096828, 59.39667342044429, 1012.1706207888221, 104.04819059779315, 596.7434909955224, 439.3988402273332, 192.25243664598278, 982.8833810799995, 362.7089477505235, 941.3639174439197, 462.0797117392551, 1146.0572807840826, 418.10686224526745, 538.305619545803, 255.17662990672957, 1307.5355154323624, 892.8312061338177, 198.3565577769065, 525.662468876444, 894.4606609592734, 747.5233991598624, 230.31234576284774, 463.25336638956986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4915700432227283, "mean_inference_ms": 3.2627138748898257, "mean_action_processing_ms": 1.1994350864604149, "mean_env_wait_ms": 9.919773596499708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023195624351501465, "StateBufferConnector_ms": 0.004123330116271973, "ViewRequirementAgentConnector_ms": 0.12346982955932617}, "num_episodes": 5, "episode_return_max": 811.0886215321378, "episode_return_min": 1.4000000000000057, "episode_return_mean": 252.9960173350517, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.86996781785221, "num_env_steps_trained_throughput_per_sec": 82.86996781785221, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 48495.503, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48495.45, "sample_time_ms": 2152.452, "learn_time_ms": 46325.64, "learn_throughput": 86.345, "synch_weights_time_ms": 14.5}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "fed12_00000", "date": "2024-08-21_18-50-57", "timestamp": 1724246457, "time_this_iter_s": 48.302311182022095, "time_total_s": 2781.8863060474396, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4bde50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2781.8863060474396, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 25.435294117647064, "ram_util_percent": 79.28382352941176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.133054120578464, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.9865859011493665, "policy_loss": -0.020758244615398033, "vf_loss": 7.004946788908943, "vf_explained_var": 0.590345297162495, "kl": 0.01198674952746837, "entropy": 0.6800528574557532, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.687107422112156, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.724635866962413, "policy_loss": -0.014593097388685222, "vf_loss": 6.737263341681667, "vf_explained_var": 0.365275907201111, "kl": 0.009828183793329767, "entropy": 0.4946355594529046, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 811.0886215321378, "episode_reward_min": -4.8869091520249555, "episode_reward_mean": 248.73206924388094, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1430.1095369150307, "predator_policy": 1.7174385237096828}, "policy_reward_max": {"prey_policy": 360.4663521593099, "predator_policy": 1420.3050921350189}, "policy_reward_mean": {"prey_policy": -527.4686368748446, "predator_policy": 651.8346714967856}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.72678763019775, 8.900000000000004, 119.16212502666968, 267.6903403665541, 252.49999999999912, 10.2, 278.647585032292, 206.49999999999739, 257.527143922233, 285.64456131207123, 442.5118103694647, 162.19107317230632, 45.05721248023007, 180.288713467237, 177.14454451292087, 205.57868380321875, 149.80777668114763, 811.0886215321378, 1.7363459941291306, 77.19999999999989, 719.891244234906, 347.4294589092781, 396.584455253612, 455.92280875604547, 207.92258074743927, 21.814832198519603, 43.80000000000033, 212.71732031225343, 6.199999999999992, 437.8650400132392, 210.644283758349, 9.999999999999984, 272.49324923979674, 1.4999999999999976, 433.2472490287871, 343.31621989563325, 529.4061066866436, 136.7457209158783, 211.83365409092764, 346.9933890616673, 148.60637300283904, 95.89999999999988, 350.9191728525175, 149.2782591054371, 213.2858983098854, 458.34380194178016, 253.485913681386, 128.15438202511, 174.7626169015549, 44.927146715203044, 389.9379025821158, 206.83084477678113, 279.76420740658864, 122.62477347116008, 234.32796256065794, 235.4690003262302, 477.29462732428937, 149.60000000000008, 347.7108203479908, 121.27767956386512, 226.77399942686338, 704.8775621251511, 377.3012268494266, 283.514896951908, 300.3435637685385, 228.73842140799044, 651.7548058731606, 721.5428036386983, 308.51623651061976, 140.57448522978152, 256.7650053604331, 432.6419275028986, 599.3220424816591, 228.40466009762062, 321.3999999999997, 53.903446005014985, 13.699999999999987, 201.47671182772316, 83.7660990348499, 123.70000000000009, 314.90265133046336, 273.68259905750966, 174.88408806180223, 190.1344437548424, 259.7293351302916, 132.5019181605285, 419.7496752164659, 1.4000000000000057, 221.97976988892216, 76.36190707465308, 433.87995275454034, -4.8869091520249555, 171.64341923520874, 316.64804114505387, 149.40768802450754, 364.744201695121, 171.68205001546107, 188.8464288168513, 367.46544878438215, 141.49999999999983], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-991.4202134718181, -504.97702947195916, -1239.9762038365639, -1044.0164019318086, -678.154522498129, -1158.7672857490752, -947.6845754309486, 106.64542602872014, 25.472010083830366, -46.91325838537938, -1011.042831990281, -1090.498783133961, -38.42127163432363, 164.24433292281452, -7.215547698830942, -74.99837416914977, 39.154817033053064, -537.6623795180728, 35.92114877125673, -1209.7261273371803, -1430.1095369150307, -246.57332891280572, -474.17884569357136, -994.9836708984442, -68.22604244727233, -403.95869817070513, -365.9196956759513, -922.5257816239332, -639.2972435739069, -393.6976971519453, -306.4016332588706, -152.56251095633058, -804.4347906314368, -827.2249736605336, 250.99173869954618, -949.4038176552892, -1035.483817602088, -1090.016743528568, 13.1728162004267, 25.958929245070156, -913.9098807728278, 115.11763306287581, -986.5622951983391, -341.1798823289587, 243.50434362617378, -590.1158040208508, -910.5223485254966, -83.42037261171444, -567.2568116171894, 23.66410306845487, -1176.948827469389, -847.8351194502504, -931.5581715855562, 27.993211180877385, -822.24739149603, -304.0183110549114, -1095.254987310202, -974.7641370765169, -1398.1996085648163, -376.0103730625501, -221.02599602772716, -1102.4306793679987, -676.2726456610966, -1420.105092135019, 52.97992742372671, -1125.875199967215, -1134.5777339556846, -1244.5343378990342, 359.87460403183593, -860.8236612010754, -1171.9762191152754, -427.12941024076935, -868.328874429702, -413.7597080247395, -617.9695016286457, -817.1367945498349, -881.133268599557, -488.20962104098624, -253.2249502012282, -462.15075786937575, -487.2129609049243, -356.1928827352496, -344.8888926405681, -897.8077123788814, -126.65011668263624, -1073.2031751481743, -935.481728584402, -601.8757350961113, -226.67001763475847, -848.7633361593614, 93.2588535243851, -1323.5900758294722, -826.7893275445903, 51.52775017587073, -791.5819193745588, -690.0034177598054, -954.7042065312488, -263.7307012178721, -1149.0542650906748, 38.87256818609785, -788.650486819926, -114.75335735492223, -1207.1851098631478, -706.3422805765049, -926.1941458038798, -108.42977669069128, -415.3546689829987, -812.5232748279826, -75.10099960506655, -781.4988021048885, -981.3002274571983, -269.8515572081925, 287.44846529530747, -200.71670811165578, -1267.2800825112822, -296.32186181406644, -248.6720874254442, -1016.862943208231, -925.6643324119982, -34.058184440420405, -934.7061200563862, -20.809688670433474, -794.9854633776118, 96.94298748138436, -0.16650875055056247, -483.4569385501792, 83.50510970507307, -1050.4360838951627, -620.6698784194086, 18.153240359431557, -564.704723226022, -1062.7340819977303, -540.2403763216333, 360.4663521593099, -463.8489734905718, -214.2482756411048, -783.0032234457492, -223.21587348191937, -565.0065905314513, 34.33593649181358, 27.98462289950596, -441.5709602193864, -936.6884619868433, 69.01968596641504, 37.508385326518486, -1265.0731828789328, -1001.8633458425749, -256.2587792923807, 28.860902252580285, 258.26631781378416, -916.7244233340798, -287.4794274043576, -1042.9821873772037, -821.7577110147506, -303.28400841372445, -330.9931721207346, -680.0396626269858, -716.089090238515, -246.5580175746373, 38.08256147629059, -47.25447106886412, -709.4101718099421, 151.63440845971596, -578.7434909955183, -397.3504273116207, -59.416761499891834, -166.09120042215824, -989.366684653521, -720.7856354283856, -422.92865862449605, -1146.0572807840826, -285.60494408473795, -159.68397752559534, -214.04859671047092, -1307.5355154323624, -891.4312061338173, 25.03904151361334, -527.0782982780423, -735.9036169573473, -829.7185360871349, 273.6700878251817, -533.3558472230585, -552.8796478332274, -659.2706337442802, -985.1209881744226, -585.2947117321295, -333.7670571936527, -422.4531454885925, -850.0701813786262, -586.4785605032881, 226.4388323870457, -961.7244117273665, -614.8007686843013, -503.0496012793558, -22.877323024152506, -263.121018797112, -210.737229028697, -969.9344375064217, -484.3279007605312, -614.2665903721622], "policy_predator_policy_reward": [828.5514381997093, 1047.572592374266, 1239.9762038365639, 1052.9164019318093, 795.0154855816978, 1161.0684476921788, 980.7251553340827, 128.00433443470047, 16.652559129562963, 257.2886891719859, 1011.8428319902812, 1099.8987831339616, 77.67744254055349, 75.14708120324838, 9.571622830234071, 279.14229903774486, 375.6388490338122, 380.3958573734436, 822.1959564117315, 637.2535834662638, 1403.0207426330903, 716.1739335642134, 982.6248525399463, 648.7287372243759, 49.88666401284814, 467.35528908536236, 1040.264683949197, 428.46950681792384, 611.2131655602307, 598.9263196785496, 52.372795125149274, 612.1700328932733, 489.8634360351063, 1291.6041049380124, 659.6114014598571, 849.8892990280215, 1036.7201635962174, 1090.516743528568, 25.227183799573346, 12.841070754929918, 575.8805448268023, 942.8029471180555, 1006.457641898501, 668.7139945380762, 111.02358291276495, 632.1723327355253, 835.7995505111759, 614.0659793820803, 325.22163060751274, 426.2936586886619, 1176.948827469389, 869.64995164877, 936.2581715855564, 11.106788819122722, 49.32097149255869, 1289.6620513706362, 1095.254987310202, 980.9641370765183, 1325.8762145260264, 886.1988071145801, 431.57027978607766, 1102.5306793679986, 686.0726456610987, 1420.3050921350189, 265.56887578793015, 1079.8196459953533, 1135.177733955684, 1245.4343378990343, 811.4211447223626, 122.77516147566351, 1084.6602351850709, 857.7616140666074, 880.4536722396807, 931.0410169014029, 693.1847745606728, 878.6672425336882, 965.9870509879812, 615.1894927434912, 424.494286688261, 637.8748104440111, 198.0209439141972, 793.9912727288176, 439.68889264056764, 898.9077123788817, 1046.8041934599103, 503.9682712234172, 935.481728584402, 751.1539942015496, 768.3553370908937, 520.3639150131091, 382.679944299979, 1305.9950799468863, 667.7569074796581, 360.9905835704488, 852.6260154120652, 757.1137037474091, 889.4700611170132, 503.72746353366983, 2.954578529105152, 1152.1542650906747, 1153.0587261380483, 140.2830206189164, 1176.6334822060012, 943.7247530104333, 916.7137166927863, 397.6744132083694, 540.4080855377359, 810.0946317444062, 321.68925274094494, 769.2385115296677, 597.3314501520379, 889.2893348395859, 45.446162028981405, 345.11670811165595, 1267.2800825112822, 445.92186181406794, 699.740342651038, 913.5055083306294, 922.041380403216, 158.95881601306962, 219.79786591278815, 962.4919422408947, 722.8058645981189, 680.1141734232589, 289.0556909681161, 571.8689831820413, 215.83104423466207, 1034.6148269073367, 465.27100923575694, 437.5891925927598, 1062.8293092218296, 793.3479174099174, 341.98763314007675, 489.5411968954068, 853.7233347363219, 545.916718034053, 638.350836273914, 676.3844971643784, 659.2200865351417, 12.025052734279395, 276.0946225649444, 394.25672011537785, 433.15189954738656, 867.1588039759409, 654.2973405225268, 1172.58949951154, 737.2689093796483, 749.2578758529302, 10.339097747419835, 23.933682186215773, 916.7244233340798, 341.382873409372, 1045.4821873772041, 832.957711014753, 711.0274874609585, 124.72640490123777, 799.464964117907, 680.4298877824457, 330.45801757464056, 1.7174385237096828, 59.39667342044429, 1012.1706207888221, 104.04819059779315, 596.7434909955224, 439.3988402273332, 192.25243664598278, 982.8833810799995, 362.7089477505235, 941.3639174439197, 462.0797117392551, 1146.0572807840826, 418.10686224526745, 538.305619545803, 255.17662990672957, 1307.5355154323624, 892.8312061338177, 198.3565577769065, 525.662468876444, 894.4606609592734, 747.5233991598624, 230.31234576284774, 463.25336638956986, 262.55382262820325, 944.7095497972846, 1010.6495155463255, 731.4096035954365, 438.6432737280493, 634.2249700992515, 902.570181378627, 683.3862485277972, 180.3027155803013, 919.7270654551378, 342.7377240261406, 946.7946959529817, 56.10235151940259, 418.7424191187175, 726.2527841395894, 821.8843311799145, 530.9279007605325, 709.1665903721643]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4888399099435463, "mean_inference_ms": 3.258756781624408, "mean_action_processing_ms": 1.2009595325750835, "mean_env_wait_ms": 9.924349832319784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0228654146194458, "StateBufferConnector_ms": 0.0041512250900268555, "ViewRequirementAgentConnector_ms": 0.1258300542831421}, "num_episodes": 9, "episode_return_max": 811.0886215321378, "episode_return_min": -4.8869091520249555, "episode_return_mean": 248.73206924388094, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.4392457340488, "num_env_steps_trained_throughput_per_sec": 83.4392457340488, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 48447.358, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48447.305, "sample_time_ms": 2155.527, "learn_time_ms": 46274.414, "learn_throughput": 86.441, "synch_weights_time_ms": 14.543}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "fed12_00000", "date": "2024-08-21_18-51-45", "timestamp": 1724246505, "time_this_iter_s": 47.953527212142944, "time_total_s": 2829.8398332595825, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4cee50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2829.8398332595825, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 24.238805970149254, "ram_util_percent": 80.40298507462688}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.08554314078477, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.147638540671616, "policy_loss": -0.021411582698217697, "vf_loss": 7.166591621075988, "vf_explained_var": 0.5307667371772584, "kl": 0.012292401781601328, "entropy": 0.6820487917100311, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.85311945292054, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.368493377847016, "policy_loss": -0.016150126203022423, "vf_loss": 6.382509388747039, "vf_explained_var": 0.3033969371091752, "kl": 0.010670519342754411, "entropy": 0.5467986937553163, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 811.0886215321378, "episode_reward_min": -4.8869091520249555, "episode_reward_mean": 262.1645724367683, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1420.105092135019, "predator_policy": 1.7174385237096828}, "policy_reward_max": {"prey_policy": 360.4663521593099, "predator_policy": 1420.3050921350189}, "policy_reward_mean": {"prey_policy": -502.8016605045526, "predator_policy": 633.8839467229373}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.05721248023007, 180.288713467237, 177.14454451292087, 205.57868380321875, 149.80777668114763, 811.0886215321378, 1.7363459941291306, 77.19999999999989, 719.891244234906, 347.4294589092781, 396.584455253612, 455.92280875604547, 207.92258074743927, 21.814832198519603, 43.80000000000033, 212.71732031225343, 6.199999999999992, 437.8650400132392, 210.644283758349, 9.999999999999984, 272.49324923979674, 1.4999999999999976, 433.2472490287871, 343.31621989563325, 529.4061066866436, 136.7457209158783, 211.83365409092764, 346.9933890616673, 148.60637300283904, 95.89999999999988, 350.9191728525175, 149.2782591054371, 213.2858983098854, 458.34380194178016, 253.485913681386, 128.15438202511, 174.7626169015549, 44.927146715203044, 389.9379025821158, 206.83084477678113, 279.76420740658864, 122.62477347116008, 234.32796256065794, 235.4690003262302, 477.29462732428937, 149.60000000000008, 347.7108203479908, 121.27767956386512, 226.77399942686338, 704.8775621251511, 377.3012268494266, 283.514896951908, 300.3435637685385, 228.73842140799044, 651.7548058731606, 721.5428036386983, 308.51623651061976, 140.57448522978152, 256.7650053604331, 432.6419275028986, 599.3220424816591, 228.40466009762062, 321.3999999999997, 53.903446005014985, 13.699999999999987, 201.47671182772316, 83.7660990348499, 123.70000000000009, 314.90265133046336, 273.68259905750966, 174.88408806180223, 190.1344437548424, 259.7293351302916, 132.5019181605285, 419.7496752164659, 1.4000000000000057, 221.97976988892216, 76.36190707465308, 433.87995275454034, -4.8869091520249555, 171.64341923520874, 316.64804114505387, 149.40768802450754, 364.744201695121, 171.68205001546107, 188.8464288168513, 367.46544878438215, 141.49999999999983, 533.5999999999992, 370.76779550518813, 149.69999999999905, 259.6284242825506, 349.87970023581187, 574.2593914419094, 358.73938410598913, 356.26296889375175, 605.8178092712501, 54.900000000000524, 72.69198185937972, 328.2042905246941], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-68.22604244727233, -403.95869817070513, -365.9196956759513, -922.5257816239332, -639.2972435739069, -393.6976971519453, -306.4016332588706, -152.56251095633058, -804.4347906314368, -827.2249736605336, 250.99173869954618, -949.4038176552892, -1035.483817602088, -1090.016743528568, 13.1728162004267, 25.958929245070156, -913.9098807728278, 115.11763306287581, -986.5622951983391, -341.1798823289587, 243.50434362617378, -590.1158040208508, -910.5223485254966, -83.42037261171444, -567.2568116171894, 23.66410306845487, -1176.948827469389, -847.8351194502504, -931.5581715855562, 27.993211180877385, -822.24739149603, -304.0183110549114, -1095.254987310202, -974.7641370765169, -1398.1996085648163, -376.0103730625501, -221.02599602772716, -1102.4306793679987, -676.2726456610966, -1420.105092135019, 52.97992742372671, -1125.875199967215, -1134.5777339556846, -1244.5343378990342, 359.87460403183593, -860.8236612010754, -1171.9762191152754, -427.12941024076935, -868.328874429702, -413.7597080247395, -617.9695016286457, -817.1367945498349, -881.133268599557, -488.20962104098624, -253.2249502012282, -462.15075786937575, -487.2129609049243, -356.1928827352496, -344.8888926405681, -897.8077123788814, -126.65011668263624, -1073.2031751481743, -935.481728584402, -601.8757350961113, -226.67001763475847, -848.7633361593614, 93.2588535243851, -1323.5900758294722, -826.7893275445903, 51.52775017587073, -791.5819193745588, -690.0034177598054, -954.7042065312488, -263.7307012178721, -1149.0542650906748, 38.87256818609785, -788.650486819926, -114.75335735492223, -1207.1851098631478, -706.3422805765049, -926.1941458038798, -108.42977669069128, -415.3546689829987, -812.5232748279826, -75.10099960506655, -781.4988021048885, -981.3002274571983, -269.8515572081925, 287.44846529530747, -200.71670811165578, -1267.2800825112822, -296.32186181406644, -248.6720874254442, -1016.862943208231, -925.6643324119982, -34.058184440420405, -934.7061200563862, -20.809688670433474, -794.9854633776118, 96.94298748138436, -0.16650875055056247, -483.4569385501792, 83.50510970507307, -1050.4360838951627, -620.6698784194086, 18.153240359431557, -564.704723226022, -1062.7340819977303, -540.2403763216333, 360.4663521593099, -463.8489734905718, -214.2482756411048, -783.0032234457492, -223.21587348191937, -565.0065905314513, 34.33593649181358, 27.98462289950596, -441.5709602193864, -936.6884619868433, 69.01968596641504, 37.508385326518486, -1265.0731828789328, -1001.8633458425749, -256.2587792923807, 28.860902252580285, 258.26631781378416, -916.7244233340798, -287.4794274043576, -1042.9821873772037, -821.7577110147506, -303.28400841372445, -330.9931721207346, -680.0396626269858, -716.089090238515, -246.5580175746373, 38.08256147629059, -47.25447106886412, -709.4101718099421, 151.63440845971596, -578.7434909955183, -397.3504273116207, -59.416761499891834, -166.09120042215824, -989.366684653521, -720.7856354283856, -422.92865862449605, -1146.0572807840826, -285.60494408473795, -159.68397752559534, -214.04859671047092, -1307.5355154323624, -891.4312061338173, 25.03904151361334, -527.0782982780423, -735.9036169573473, -829.7185360871349, 273.6700878251817, -533.3558472230585, -552.8796478332274, -659.2706337442802, -985.1209881744226, -585.2947117321295, -333.7670571936527, -422.4531454885925, -850.0701813786262, -586.4785605032881, 226.4388323870457, -961.7244117273665, -614.8007686843013, -503.0496012793558, -22.877323024152506, -263.121018797112, -210.737229028697, -969.9344375064217, -484.3279007605312, -614.2665903721622, 118.35457189325348, -5.061207822133074, -51.5840737101715, -501.49999771767045, -477.7414530330403, -166.6814543175095, -641.0591392259827, 108.59751098772198, -941.3952084152711, 3.9471219950235663, -421.31959963354694, -775.3875315587575, -240.19546208874544, -8.62502420392892, -642.9835243262512, -31.44566936975889, -11.365196360248666, -1232.1079267234581, -213.6370621446413, -193.0942667938029, -353.05703386890787, -1045.0402624608785, -511.4865041319148, -188.6187867486509], "policy_predator_policy_reward": [49.88666401284814, 467.35528908536236, 1040.264683949197, 428.46950681792384, 611.2131655602307, 598.9263196785496, 52.372795125149274, 612.1700328932733, 489.8634360351063, 1291.6041049380124, 659.6114014598571, 849.8892990280215, 1036.7201635962174, 1090.516743528568, 25.227183799573346, 12.841070754929918, 575.8805448268023, 942.8029471180555, 1006.457641898501, 668.7139945380762, 111.02358291276495, 632.1723327355253, 835.7995505111759, 614.0659793820803, 325.22163060751274, 426.2936586886619, 1176.948827469389, 869.64995164877, 936.2581715855564, 11.106788819122722, 49.32097149255869, 1289.6620513706362, 1095.254987310202, 980.9641370765183, 1325.8762145260264, 886.1988071145801, 431.57027978607766, 1102.5306793679986, 686.0726456610987, 1420.3050921350189, 265.56887578793015, 1079.8196459953533, 1135.177733955684, 1245.4343378990343, 811.4211447223626, 122.77516147566351, 1084.6602351850709, 857.7616140666074, 880.4536722396807, 931.0410169014029, 693.1847745606728, 878.6672425336882, 965.9870509879812, 615.1894927434912, 424.494286688261, 637.8748104440111, 198.0209439141972, 793.9912727288176, 439.68889264056764, 898.9077123788817, 1046.8041934599103, 503.9682712234172, 935.481728584402, 751.1539942015496, 768.3553370908937, 520.3639150131091, 382.679944299979, 1305.9950799468863, 667.7569074796581, 360.9905835704488, 852.6260154120652, 757.1137037474091, 889.4700611170132, 503.72746353366983, 2.954578529105152, 1152.1542650906747, 1153.0587261380483, 140.2830206189164, 1176.6334822060012, 943.7247530104333, 916.7137166927863, 397.6744132083694, 540.4080855377359, 810.0946317444062, 321.68925274094494, 769.2385115296677, 597.3314501520379, 889.2893348395859, 45.446162028981405, 345.11670811165595, 1267.2800825112822, 445.92186181406794, 699.740342651038, 913.5055083306294, 922.041380403216, 158.95881601306962, 219.79786591278815, 962.4919422408947, 722.8058645981189, 680.1141734232589, 289.0556909681161, 571.8689831820413, 215.83104423466207, 1034.6148269073367, 465.27100923575694, 437.5891925927598, 1062.8293092218296, 793.3479174099174, 341.98763314007675, 489.5411968954068, 853.7233347363219, 545.916718034053, 638.350836273914, 676.3844971643784, 659.2200865351417, 12.025052734279395, 276.0946225649444, 394.25672011537785, 433.15189954738656, 867.1588039759409, 654.2973405225268, 1172.58949951154, 737.2689093796483, 749.2578758529302, 10.339097747419835, 23.933682186215773, 916.7244233340798, 341.382873409372, 1045.4821873772041, 832.957711014753, 711.0274874609585, 124.72640490123777, 799.464964117907, 680.4298877824457, 330.45801757464056, 1.7174385237096828, 59.39667342044429, 1012.1706207888221, 104.04819059779315, 596.7434909955224, 439.3988402273332, 192.25243664598278, 982.8833810799995, 362.7089477505235, 941.3639174439197, 462.0797117392551, 1146.0572807840826, 418.10686224526745, 538.305619545803, 255.17662990672957, 1307.5355154323624, 892.8312061338177, 198.3565577769065, 525.662468876444, 894.4606609592734, 747.5233991598624, 230.31234576284774, 463.25336638956986, 262.55382262820325, 944.7095497972846, 1010.6495155463255, 731.4096035954365, 438.6432737280493, 634.2249700992515, 902.570181378627, 683.3862485277972, 180.3027155803013, 919.7270654551378, 342.7377240261406, 946.7946959529817, 56.10235151940259, 418.7424191187175, 726.2527841395894, 821.8843311799145, 530.9279007605325, 709.1665903721643, 166.74542810674657, 253.56120782213276, 309.70955190441947, 614.1423150286087, 675.7689250798012, 118.35398227075395, 646.6807043192821, 145.40934820152975, 859.3810565019961, 427.9467301540631, 1010.6423704014193, 760.3241522327982, 344.90101688847705, 262.65885351018636, 625.327522729267, 405.36463986049387, 933.5623339444844, 915.7285984104689, 240.23706214463996, 221.39426679380128, 425.642224918798, 1045.1470532703686, 521.806629445842, 506.5029519594212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.483794772785503, "mean_inference_ms": 3.253138297691657, "mean_action_processing_ms": 1.2013169043419984, "mean_env_wait_ms": 9.93013090538816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022845983505249023, "StateBufferConnector_ms": 0.004244804382324219, "ViewRequirementAgentConnector_ms": 0.13498187065124512}, "num_episodes": 12, "episode_return_max": 811.0886215321378, "episode_return_min": -4.8869091520249555, "episode_return_mean": 262.1645724367683, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.07135687664153, "num_env_steps_trained_throughput_per_sec": 84.07135687664153, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 48415.369, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48415.318, "sample_time_ms": 2159.768, "learn_time_ms": 46238.241, "learn_throughput": 86.508, "synch_weights_time_ms": 14.563}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "fed12_00000", "date": "2024-08-21_18-52-33", "timestamp": 1724246553, "time_this_iter_s": 47.584503173828125, "time_total_s": 2877.4243364334106, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f723af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2877.4243364334106, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 24.81323529411765, "ram_util_percent": 79.80882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.848533422354038, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.925735980493051, "policy_loss": -0.021122858138809167, "vf_loss": 6.944234501117121, "vf_explained_var": 0.631998159519579, "kl": 0.013121679390992515, "entropy": 0.7071566625877663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.273151350778246, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.386760743206771, "policy_loss": -0.01687504555143061, "vf_loss": 6.401179038406049, "vf_explained_var": 0.4334131380868336, "kl": 0.012283779368563383, "entropy": 0.5097978829864471, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 764.5162422602721, "episode_reward_min": -4.8869091520249555, "episode_reward_mean": 265.67742186429905, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1420.105092135019, "predator_policy": 1.7174385237096828}, "policy_reward_max": {"prey_policy": 360.4663521593099, "predator_policy": 1420.3050921350189}, "policy_reward_mean": {"prey_policy": -498.86174226572723, "predator_policy": 631.7004531978774}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.4294589092781, 396.584455253612, 455.92280875604547, 207.92258074743927, 21.814832198519603, 43.80000000000033, 212.71732031225343, 6.199999999999992, 437.8650400132392, 210.644283758349, 9.999999999999984, 272.49324923979674, 1.4999999999999976, 433.2472490287871, 343.31621989563325, 529.4061066866436, 136.7457209158783, 211.83365409092764, 346.9933890616673, 148.60637300283904, 95.89999999999988, 350.9191728525175, 149.2782591054371, 213.2858983098854, 458.34380194178016, 253.485913681386, 128.15438202511, 174.7626169015549, 44.927146715203044, 389.9379025821158, 206.83084477678113, 279.76420740658864, 122.62477347116008, 234.32796256065794, 235.4690003262302, 477.29462732428937, 149.60000000000008, 347.7108203479908, 121.27767956386512, 226.77399942686338, 704.8775621251511, 377.3012268494266, 283.514896951908, 300.3435637685385, 228.73842140799044, 651.7548058731606, 721.5428036386983, 308.51623651061976, 140.57448522978152, 256.7650053604331, 432.6419275028986, 599.3220424816591, 228.40466009762062, 321.3999999999997, 53.903446005014985, 13.699999999999987, 201.47671182772316, 83.7660990348499, 123.70000000000009, 314.90265133046336, 273.68259905750966, 174.88408806180223, 190.1344437548424, 259.7293351302916, 132.5019181605285, 419.7496752164659, 1.4000000000000057, 221.97976988892216, 76.36190707465308, 433.87995275454034, -4.8869091520249555, 171.64341923520874, 316.64804114505387, 149.40768802450754, 364.744201695121, 171.68205001546107, 188.8464288168513, 367.46544878438215, 141.49999999999983, 533.5999999999992, 370.76779550518813, 149.69999999999905, 259.6284242825506, 349.87970023581187, 574.2593914419094, 358.73938410598913, 356.26296889375175, 605.8178092712501, 54.900000000000524, 72.69198185937972, 328.2042905246941, 200.20934253947772, 764.5162422602721, 119.13819738367297, 139.0353331757735, 356.5898064220895, 465.2244909192483, 113.09999999999832, 325.99693699981106, 235.26773575865602], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-986.5622951983391, -341.1798823289587, 243.50434362617378, -590.1158040208508, -910.5223485254966, -83.42037261171444, -567.2568116171894, 23.66410306845487, -1176.948827469389, -847.8351194502504, -931.5581715855562, 27.993211180877385, -822.24739149603, -304.0183110549114, -1095.254987310202, -974.7641370765169, -1398.1996085648163, -376.0103730625501, -221.02599602772716, -1102.4306793679987, -676.2726456610966, -1420.105092135019, 52.97992742372671, -1125.875199967215, -1134.5777339556846, -1244.5343378990342, 359.87460403183593, -860.8236612010754, -1171.9762191152754, -427.12941024076935, -868.328874429702, -413.7597080247395, -617.9695016286457, -817.1367945498349, -881.133268599557, -488.20962104098624, -253.2249502012282, -462.15075786937575, -487.2129609049243, -356.1928827352496, -344.8888926405681, -897.8077123788814, -126.65011668263624, -1073.2031751481743, -935.481728584402, -601.8757350961113, -226.67001763475847, -848.7633361593614, 93.2588535243851, -1323.5900758294722, -826.7893275445903, 51.52775017587073, -791.5819193745588, -690.0034177598054, -954.7042065312488, -263.7307012178721, -1149.0542650906748, 38.87256818609785, -788.650486819926, -114.75335735492223, -1207.1851098631478, -706.3422805765049, -926.1941458038798, -108.42977669069128, -415.3546689829987, -812.5232748279826, -75.10099960506655, -781.4988021048885, -981.3002274571983, -269.8515572081925, 287.44846529530747, -200.71670811165578, -1267.2800825112822, -296.32186181406644, -248.6720874254442, -1016.862943208231, -925.6643324119982, -34.058184440420405, -934.7061200563862, -20.809688670433474, -794.9854633776118, 96.94298748138436, -0.16650875055056247, -483.4569385501792, 83.50510970507307, -1050.4360838951627, -620.6698784194086, 18.153240359431557, -564.704723226022, -1062.7340819977303, -540.2403763216333, 360.4663521593099, -463.8489734905718, -214.2482756411048, -783.0032234457492, -223.21587348191937, -565.0065905314513, 34.33593649181358, 27.98462289950596, -441.5709602193864, -936.6884619868433, 69.01968596641504, 37.508385326518486, -1265.0731828789328, -1001.8633458425749, -256.2587792923807, 28.860902252580285, 258.26631781378416, -916.7244233340798, -287.4794274043576, -1042.9821873772037, -821.7577110147506, -303.28400841372445, -330.9931721207346, -680.0396626269858, -716.089090238515, -246.5580175746373, 38.08256147629059, -47.25447106886412, -709.4101718099421, 151.63440845971596, -578.7434909955183, -397.3504273116207, -59.416761499891834, -166.09120042215824, -989.366684653521, -720.7856354283856, -422.92865862449605, -1146.0572807840826, -285.60494408473795, -159.68397752559534, -214.04859671047092, -1307.5355154323624, -891.4312061338173, 25.03904151361334, -527.0782982780423, -735.9036169573473, -829.7185360871349, 273.6700878251817, -533.3558472230585, -552.8796478332274, -659.2706337442802, -985.1209881744226, -585.2947117321295, -333.7670571936527, -422.4531454885925, -850.0701813786262, -586.4785605032881, 226.4388323870457, -961.7244117273665, -614.8007686843013, -503.0496012793558, -22.877323024152506, -263.121018797112, -210.737229028697, -969.9344375064217, -484.3279007605312, -614.2665903721622, 118.35457189325348, -5.061207822133074, -51.5840737101715, -501.49999771767045, -477.7414530330403, -166.6814543175095, -641.0591392259827, 108.59751098772198, -941.3952084152711, 3.9471219950235663, -421.31959963354694, -775.3875315587575, -240.19546208874544, -8.62502420392892, -642.9835243262512, -31.44566936975889, -11.365196360248666, -1232.1079267234581, -213.6370621446413, -193.0942667938029, -353.05703386890787, -1045.0402624608785, -511.4865041319148, -188.6187867486509, -485.15763462711413, -152.5998181421995, 257.1411721188225, -652.7041871378774, -440.0905615735552, -288.20106141443904, -862.1627265089296, -447.4933607955173, -21.54832141604144, -896.730992429183, -154.04757502848065, -680.1302119363764, -285.503273875231, -403.34710571849143, -362.33804222350005, -527.0156218543946, -641.3760505908333, -636.5331885833233], "policy_predator_policy_reward": [1006.457641898501, 668.7139945380762, 111.02358291276495, 632.1723327355253, 835.7995505111759, 614.0659793820803, 325.22163060751274, 426.2936586886619, 1176.948827469389, 869.64995164877, 936.2581715855564, 11.106788819122722, 49.32097149255869, 1289.6620513706362, 1095.254987310202, 980.9641370765183, 1325.8762145260264, 886.1988071145801, 431.57027978607766, 1102.5306793679986, 686.0726456610987, 1420.3050921350189, 265.56887578793015, 1079.8196459953533, 1135.177733955684, 1245.4343378990343, 811.4211447223626, 122.77516147566351, 1084.6602351850709, 857.7616140666074, 880.4536722396807, 931.0410169014029, 693.1847745606728, 878.6672425336882, 965.9870509879812, 615.1894927434912, 424.494286688261, 637.8748104440111, 198.0209439141972, 793.9912727288176, 439.68889264056764, 898.9077123788817, 1046.8041934599103, 503.9682712234172, 935.481728584402, 751.1539942015496, 768.3553370908937, 520.3639150131091, 382.679944299979, 1305.9950799468863, 667.7569074796581, 360.9905835704488, 852.6260154120652, 757.1137037474091, 889.4700611170132, 503.72746353366983, 2.954578529105152, 1152.1542650906747, 1153.0587261380483, 140.2830206189164, 1176.6334822060012, 943.7247530104333, 916.7137166927863, 397.6744132083694, 540.4080855377359, 810.0946317444062, 321.68925274094494, 769.2385115296677, 597.3314501520379, 889.2893348395859, 45.446162028981405, 345.11670811165595, 1267.2800825112822, 445.92186181406794, 699.740342651038, 913.5055083306294, 922.041380403216, 158.95881601306962, 219.79786591278815, 962.4919422408947, 722.8058645981189, 680.1141734232589, 289.0556909681161, 571.8689831820413, 215.83104423466207, 1034.6148269073367, 465.27100923575694, 437.5891925927598, 1062.8293092218296, 793.3479174099174, 341.98763314007675, 489.5411968954068, 853.7233347363219, 545.916718034053, 638.350836273914, 676.3844971643784, 659.2200865351417, 12.025052734279395, 276.0946225649444, 394.25672011537785, 433.15189954738656, 867.1588039759409, 654.2973405225268, 1172.58949951154, 737.2689093796483, 749.2578758529302, 10.339097747419835, 23.933682186215773, 916.7244233340798, 341.382873409372, 1045.4821873772041, 832.957711014753, 711.0274874609585, 124.72640490123777, 799.464964117907, 680.4298877824457, 330.45801757464056, 1.7174385237096828, 59.39667342044429, 1012.1706207888221, 104.04819059779315, 596.7434909955224, 439.3988402273332, 192.25243664598278, 982.8833810799995, 362.7089477505235, 941.3639174439197, 462.0797117392551, 1146.0572807840826, 418.10686224526745, 538.305619545803, 255.17662990672957, 1307.5355154323624, 892.8312061338177, 198.3565577769065, 525.662468876444, 894.4606609592734, 747.5233991598624, 230.31234576284774, 463.25336638956986, 262.55382262820325, 944.7095497972846, 1010.6495155463255, 731.4096035954365, 438.6432737280493, 634.2249700992515, 902.570181378627, 683.3862485277972, 180.3027155803013, 919.7270654551378, 342.7377240261406, 946.7946959529817, 56.10235151940259, 418.7424191187175, 726.2527841395894, 821.8843311799145, 530.9279007605325, 709.1665903721643, 166.74542810674657, 253.56120782213276, 309.70955190441947, 614.1423150286087, 675.7689250798012, 118.35398227075395, 646.6807043192821, 145.40934820152975, 859.3810565019961, 427.9467301540631, 1010.6423704014193, 760.3241522327982, 344.90101688847705, 262.65885351018636, 625.327522729267, 405.36463986049387, 933.5623339444844, 915.7285984104689, 240.23706214463996, 221.39426679380128, 425.642224918798, 1045.1470532703686, 521.806629445842, 506.5029519594212, 311.52327194897464, 526.4435233598175, 518.428094713089, 641.6511625662387, 488.55752710739904, 358.87229326427604, 830.1024613704368, 618.5889591097872, 719.7796341917896, 555.0894860755197, 740.8849415388718, 558.5173363452388, 350.9497400629833, 451.00063953074545, 738.3466327051805, 477.0039683725295, 983.9141067396157, 529.2628681932034]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.480967018243878, "mean_inference_ms": 3.249702729467726, "mean_action_processing_ms": 1.2004894203543683, "mean_env_wait_ms": 9.931914776041902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022795915603637695, "StateBufferConnector_ms": 0.004152536392211914, "ViewRequirementAgentConnector_ms": 0.13402605056762695}, "num_episodes": 9, "episode_return_max": 764.5162422602721, "episode_return_min": -4.8869091520249555, "episode_return_mean": 265.67742186429905, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.7235575730699, "num_env_steps_trained_throughput_per_sec": 82.7235575730699, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 48397.184, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48397.133, "sample_time_ms": 2152.172, "learn_time_ms": 46227.657, "learn_throughput": 86.528, "synch_weights_time_ms": 14.642}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "fed12_00000", "date": "2024-08-21_18-53-21", "timestamp": 1724246601, "time_this_iter_s": 48.3967809677124, "time_total_s": 2925.821117401123, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4bd160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2925.821117401123, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 25.17941176470588, "ram_util_percent": 80.6514705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.67312394134582, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.7142146246773855, "policy_loss": -0.021921922540459684, "vf_loss": 6.733369684976244, "vf_explained_var": 0.6365875895376558, "kl": 0.013834300122800328, "entropy": 0.704917922284868, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.063355506538713, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.6319990551660934, "policy_loss": -0.017869184565084874, "vf_loss": 6.647483148776665, "vf_explained_var": 0.4115969164976998, "kl": 0.011925420555084077, "entropy": 0.5101983122724705, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 895.4654614804358, "episode_reward_min": -4.8869091520249555, "episode_reward_mean": 277.73751598635977, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1420.105092135019, "predator_policy": 1.7174385237096828}, "policy_reward_max": {"prey_policy": 360.4663521593099, "predator_policy": 1420.3050921350189}, "policy_reward_mean": {"prey_policy": -486.273435756546, "predator_policy": 625.1421937497266}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.999999999999984, 272.49324923979674, 1.4999999999999976, 433.2472490287871, 343.31621989563325, 529.4061066866436, 136.7457209158783, 211.83365409092764, 346.9933890616673, 148.60637300283904, 95.89999999999988, 350.9191728525175, 149.2782591054371, 213.2858983098854, 458.34380194178016, 253.485913681386, 128.15438202511, 174.7626169015549, 44.927146715203044, 389.9379025821158, 206.83084477678113, 279.76420740658864, 122.62477347116008, 234.32796256065794, 235.4690003262302, 477.29462732428937, 149.60000000000008, 347.7108203479908, 121.27767956386512, 226.77399942686338, 704.8775621251511, 377.3012268494266, 283.514896951908, 300.3435637685385, 228.73842140799044, 651.7548058731606, 721.5428036386983, 308.51623651061976, 140.57448522978152, 256.7650053604331, 432.6419275028986, 599.3220424816591, 228.40466009762062, 321.3999999999997, 53.903446005014985, 13.699999999999987, 201.47671182772316, 83.7660990348499, 123.70000000000009, 314.90265133046336, 273.68259905750966, 174.88408806180223, 190.1344437548424, 259.7293351302916, 132.5019181605285, 419.7496752164659, 1.4000000000000057, 221.97976988892216, 76.36190707465308, 433.87995275454034, -4.8869091520249555, 171.64341923520874, 316.64804114505387, 149.40768802450754, 364.744201695121, 171.68205001546107, 188.8464288168513, 367.46544878438215, 141.49999999999983, 533.5999999999992, 370.76779550518813, 149.69999999999905, 259.6284242825506, 349.87970023581187, 574.2593914419094, 358.73938410598913, 356.26296889375175, 605.8178092712501, 54.900000000000524, 72.69198185937972, 328.2042905246941, 200.20934253947772, 764.5162422602721, 119.13819738367297, 139.0353331757735, 356.5898064220895, 465.2244909192483, 113.09999999999832, 325.99693699981106, 235.26773575865602, 545.8581787190421, 95.7142582948116, 137.70387273425536, 895.4654614804358, 36.462554695479376, 343.185749208044, 508.5707271129136, 404.295670784343, 551.69742315992, 27.956295965565772], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-676.2726456610966, -1420.105092135019, 52.97992742372671, -1125.875199967215, -1134.5777339556846, -1244.5343378990342, 359.87460403183593, -860.8236612010754, -1171.9762191152754, -427.12941024076935, -868.328874429702, -413.7597080247395, -617.9695016286457, -817.1367945498349, -881.133268599557, -488.20962104098624, -253.2249502012282, -462.15075786937575, -487.2129609049243, -356.1928827352496, -344.8888926405681, -897.8077123788814, -126.65011668263624, -1073.2031751481743, -935.481728584402, -601.8757350961113, -226.67001763475847, -848.7633361593614, 93.2588535243851, -1323.5900758294722, -826.7893275445903, 51.52775017587073, -791.5819193745588, -690.0034177598054, -954.7042065312488, -263.7307012178721, -1149.0542650906748, 38.87256818609785, -788.650486819926, -114.75335735492223, -1207.1851098631478, -706.3422805765049, -926.1941458038798, -108.42977669069128, -415.3546689829987, -812.5232748279826, -75.10099960506655, -781.4988021048885, -981.3002274571983, -269.8515572081925, 287.44846529530747, -200.71670811165578, -1267.2800825112822, -296.32186181406644, -248.6720874254442, -1016.862943208231, -925.6643324119982, -34.058184440420405, -934.7061200563862, -20.809688670433474, -794.9854633776118, 96.94298748138436, -0.16650875055056247, -483.4569385501792, 83.50510970507307, -1050.4360838951627, -620.6698784194086, 18.153240359431557, -564.704723226022, -1062.7340819977303, -540.2403763216333, 360.4663521593099, -463.8489734905718, -214.2482756411048, -783.0032234457492, -223.21587348191937, -565.0065905314513, 34.33593649181358, 27.98462289950596, -441.5709602193864, -936.6884619868433, 69.01968596641504, 37.508385326518486, -1265.0731828789328, -1001.8633458425749, -256.2587792923807, 28.860902252580285, 258.26631781378416, -916.7244233340798, -287.4794274043576, -1042.9821873772037, -821.7577110147506, -303.28400841372445, -330.9931721207346, -680.0396626269858, -716.089090238515, -246.5580175746373, 38.08256147629059, -47.25447106886412, -709.4101718099421, 151.63440845971596, -578.7434909955183, -397.3504273116207, -59.416761499891834, -166.09120042215824, -989.366684653521, -720.7856354283856, -422.92865862449605, -1146.0572807840826, -285.60494408473795, -159.68397752559534, -214.04859671047092, -1307.5355154323624, -891.4312061338173, 25.03904151361334, -527.0782982780423, -735.9036169573473, -829.7185360871349, 273.6700878251817, -533.3558472230585, -552.8796478332274, -659.2706337442802, -985.1209881744226, -585.2947117321295, -333.7670571936527, -422.4531454885925, -850.0701813786262, -586.4785605032881, 226.4388323870457, -961.7244117273665, -614.8007686843013, -503.0496012793558, -22.877323024152506, -263.121018797112, -210.737229028697, -969.9344375064217, -484.3279007605312, -614.2665903721622, 118.35457189325348, -5.061207822133074, -51.5840737101715, -501.49999771767045, -477.7414530330403, -166.6814543175095, -641.0591392259827, 108.59751098772198, -941.3952084152711, 3.9471219950235663, -421.31959963354694, -775.3875315587575, -240.19546208874544, -8.62502420392892, -642.9835243262512, -31.44566936975889, -11.365196360248666, -1232.1079267234581, -213.6370621446413, -193.0942667938029, -353.05703386890787, -1045.0402624608785, -511.4865041319148, -188.6187867486509, -485.15763462711413, -152.5998181421995, 257.1411721188225, -652.7041871378774, -440.0905615735552, -288.20106141443904, -862.1627265089296, -447.4933607955173, -21.54832141604144, -896.730992429183, -154.04757502848065, -680.1302119363764, -285.503273875231, -403.34710571849143, -362.33804222350005, -527.0156218543946, -641.3760505908333, -636.5331885833233, -754.4186371404458, -207.95839342109326, 27.941715887210208, -686.4733329524321, -967.8614129420855, -417.2647153680299, -1104.854648423156, 295.27716025068446, -979.3922168853923, -155.76722023076258, -90.30848215650589, -631.4385776481996, 136.28147119455508, -907.256902089862, -511.31563771709887, -473.9608826375601, -1325.2679983734067, 169.8949849901998, -734.0926707361281, -598.2917606572479], "policy_predator_policy_reward": [686.0726456610987, 1420.3050921350189, 265.56887578793015, 1079.8196459953533, 1135.177733955684, 1245.4343378990343, 811.4211447223626, 122.77516147566351, 1084.6602351850709, 857.7616140666074, 880.4536722396807, 931.0410169014029, 693.1847745606728, 878.6672425336882, 965.9870509879812, 615.1894927434912, 424.494286688261, 637.8748104440111, 198.0209439141972, 793.9912727288176, 439.68889264056764, 898.9077123788817, 1046.8041934599103, 503.9682712234172, 935.481728584402, 751.1539942015496, 768.3553370908937, 520.3639150131091, 382.679944299979, 1305.9950799468863, 667.7569074796581, 360.9905835704488, 852.6260154120652, 757.1137037474091, 889.4700611170132, 503.72746353366983, 2.954578529105152, 1152.1542650906747, 1153.0587261380483, 140.2830206189164, 1176.6334822060012, 943.7247530104333, 916.7137166927863, 397.6744132083694, 540.4080855377359, 810.0946317444062, 321.68925274094494, 769.2385115296677, 597.3314501520379, 889.2893348395859, 45.446162028981405, 345.11670811165595, 1267.2800825112822, 445.92186181406794, 699.740342651038, 913.5055083306294, 922.041380403216, 158.95881601306962, 219.79786591278815, 962.4919422408947, 722.8058645981189, 680.1141734232589, 289.0556909681161, 571.8689831820413, 215.83104423466207, 1034.6148269073367, 465.27100923575694, 437.5891925927598, 1062.8293092218296, 793.3479174099174, 341.98763314007675, 489.5411968954068, 853.7233347363219, 545.916718034053, 638.350836273914, 676.3844971643784, 659.2200865351417, 12.025052734279395, 276.0946225649444, 394.25672011537785, 433.15189954738656, 867.1588039759409, 654.2973405225268, 1172.58949951154, 737.2689093796483, 749.2578758529302, 10.339097747419835, 23.933682186215773, 916.7244233340798, 341.382873409372, 1045.4821873772041, 832.957711014753, 711.0274874609585, 124.72640490123777, 799.464964117907, 680.4298877824457, 330.45801757464056, 1.7174385237096828, 59.39667342044429, 1012.1706207888221, 104.04819059779315, 596.7434909955224, 439.3988402273332, 192.25243664598278, 982.8833810799995, 362.7089477505235, 941.3639174439197, 462.0797117392551, 1146.0572807840826, 418.10686224526745, 538.305619545803, 255.17662990672957, 1307.5355154323624, 892.8312061338177, 198.3565577769065, 525.662468876444, 894.4606609592734, 747.5233991598624, 230.31234576284774, 463.25336638956986, 262.55382262820325, 944.7095497972846, 1010.6495155463255, 731.4096035954365, 438.6432737280493, 634.2249700992515, 902.570181378627, 683.3862485277972, 180.3027155803013, 919.7270654551378, 342.7377240261406, 946.7946959529817, 56.10235151940259, 418.7424191187175, 726.2527841395894, 821.8843311799145, 530.9279007605325, 709.1665903721643, 166.74542810674657, 253.56120782213276, 309.70955190441947, 614.1423150286087, 675.7689250798012, 118.35398227075395, 646.6807043192821, 145.40934820152975, 859.3810565019961, 427.9467301540631, 1010.6423704014193, 760.3241522327982, 344.90101688847705, 262.65885351018636, 625.327522729267, 405.36463986049387, 933.5623339444844, 915.7285984104689, 240.23706214463996, 221.39426679380128, 425.642224918798, 1045.1470532703686, 521.806629445842, 506.5029519594212, 311.52327194897464, 526.4435233598175, 518.428094713089, 641.6511625662387, 488.55752710739904, 358.87229326427604, 830.1024613704368, 618.5889591097872, 719.7796341917896, 555.0894860755197, 740.8849415388718, 558.5173363452388, 350.9497400629833, 451.00063953074545, 738.3466327051805, 477.0039683725295, 983.9141067396157, 529.2628681932034, 549.8115170877608, 958.42369219282, 188.92412459720853, 565.3217507628254, 824.8642375996102, 697.9657634447623, 772.147206049513, 932.8957436033965, 985.3547715808727, 186.26722023076087, 561.4403447664414, 503.4924642463074, 418.4372368963372, 861.1089211118833, 895.1368404125773, 494.43535072642527, 1121.12923820557, 585.9411983375611, 726.6656260470836, 633.6751013118599]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.47875560208928, "mean_inference_ms": 3.253749795194457, "mean_action_processing_ms": 1.2016904003605329, "mean_env_wait_ms": 9.958323675859354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02273082733154297, "StateBufferConnector_ms": 0.004148125648498535, "ViewRequirementAgentConnector_ms": 0.13155853748321533}, "num_episodes": 10, "episode_return_max": 895.4654614804358, "episode_return_min": -4.8869091520249555, "episode_return_mean": 277.73751598635977, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.05603501257154, "num_env_steps_trained_throughput_per_sec": 83.05603501257154, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 48392.492, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48392.441, "sample_time_ms": 2150.504, "learn_time_ms": 46225.182, "learn_throughput": 86.533, "synch_weights_time_ms": 14.666}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "fed12_00000", "date": "2024-08-21_18-54-10", "timestamp": 1724246650, "time_this_iter_s": 48.17959499359131, "time_total_s": 2974.0007123947144, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f723ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2974.0007123947144, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 24.695588235294117, "ram_util_percent": 80.95147058823528}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.094983270937803, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.752259854160289, "policy_loss": -0.020415227807363465, "vf_loss": 6.770229193520924, "vf_explained_var": 0.6645730933815083, "kl": 0.012229462269269837, "entropy": 0.6963248749574026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.888577247170543, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.3937644042666, "policy_loss": -0.01862211904325892, "vf_loss": 6.40986197940887, "vf_explained_var": 0.36613174550747746, "kl": 0.012622754434714951, "entropy": 0.5023760901872443, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 895.4654614804358, "episode_reward_min": -4.8869091520249555, "episode_reward_mean": 287.11759797784924, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1325.2679983734067, "predator_policy": 1.7174385237096828}, "policy_reward_max": {"prey_policy": 360.4663521593099, "predator_policy": 1307.5355154323624}, "policy_reward_mean": {"prey_policy": -449.09241615470376, "predator_policy": 592.651215143629}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.9191728525175, 149.2782591054371, 213.2858983098854, 458.34380194178016, 253.485913681386, 128.15438202511, 174.7626169015549, 44.927146715203044, 389.9379025821158, 206.83084477678113, 279.76420740658864, 122.62477347116008, 234.32796256065794, 235.4690003262302, 477.29462732428937, 149.60000000000008, 347.7108203479908, 121.27767956386512, 226.77399942686338, 704.8775621251511, 377.3012268494266, 283.514896951908, 300.3435637685385, 228.73842140799044, 651.7548058731606, 721.5428036386983, 308.51623651061976, 140.57448522978152, 256.7650053604331, 432.6419275028986, 599.3220424816591, 228.40466009762062, 321.3999999999997, 53.903446005014985, 13.699999999999987, 201.47671182772316, 83.7660990348499, 123.70000000000009, 314.90265133046336, 273.68259905750966, 174.88408806180223, 190.1344437548424, 259.7293351302916, 132.5019181605285, 419.7496752164659, 1.4000000000000057, 221.97976988892216, 76.36190707465308, 433.87995275454034, -4.8869091520249555, 171.64341923520874, 316.64804114505387, 149.40768802450754, 364.744201695121, 171.68205001546107, 188.8464288168513, 367.46544878438215, 141.49999999999983, 533.5999999999992, 370.76779550518813, 149.69999999999905, 259.6284242825506, 349.87970023581187, 574.2593914419094, 358.73938410598913, 356.26296889375175, 605.8178092712501, 54.900000000000524, 72.69198185937972, 328.2042905246941, 200.20934253947772, 764.5162422602721, 119.13819738367297, 139.0353331757735, 356.5898064220895, 465.2244909192483, 113.09999999999832, 325.99693699981106, 235.26773575865602, 545.8581787190421, 95.7142582948116, 137.70387273425536, 895.4654614804358, 36.462554695479376, 343.185749208044, 508.5707271129136, 404.295670784343, 551.69742315992, 27.956295965565772, 154.1863184189161, 163.5999999999983, 320.2348762929094, 342.89999999999975, 489.72647284829344, 268.36565214867596, 304.69820643323715, 273.90692914085776, 248.64798881221415, 571.5563744256494, 330.22734255036545], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-126.65011668263624, -1073.2031751481743, -935.481728584402, -601.8757350961113, -226.67001763475847, -848.7633361593614, 93.2588535243851, -1323.5900758294722, -826.7893275445903, 51.52775017587073, -791.5819193745588, -690.0034177598054, -954.7042065312488, -263.7307012178721, -1149.0542650906748, 38.87256818609785, -788.650486819926, -114.75335735492223, -1207.1851098631478, -706.3422805765049, -926.1941458038798, -108.42977669069128, -415.3546689829987, -812.5232748279826, -75.10099960506655, -781.4988021048885, -981.3002274571983, -269.8515572081925, 287.44846529530747, -200.71670811165578, -1267.2800825112822, -296.32186181406644, -248.6720874254442, -1016.862943208231, -925.6643324119982, -34.058184440420405, -934.7061200563862, -20.809688670433474, -794.9854633776118, 96.94298748138436, -0.16650875055056247, -483.4569385501792, 83.50510970507307, -1050.4360838951627, -620.6698784194086, 18.153240359431557, -564.704723226022, -1062.7340819977303, -540.2403763216333, 360.4663521593099, -463.8489734905718, -214.2482756411048, -783.0032234457492, -223.21587348191937, -565.0065905314513, 34.33593649181358, 27.98462289950596, -441.5709602193864, -936.6884619868433, 69.01968596641504, 37.508385326518486, -1265.0731828789328, -1001.8633458425749, -256.2587792923807, 28.860902252580285, 258.26631781378416, -916.7244233340798, -287.4794274043576, -1042.9821873772037, -821.7577110147506, -303.28400841372445, -330.9931721207346, -680.0396626269858, -716.089090238515, -246.5580175746373, 38.08256147629059, -47.25447106886412, -709.4101718099421, 151.63440845971596, -578.7434909955183, -397.3504273116207, -59.416761499891834, -166.09120042215824, -989.366684653521, -720.7856354283856, -422.92865862449605, -1146.0572807840826, -285.60494408473795, -159.68397752559534, -214.04859671047092, -1307.5355154323624, -891.4312061338173, 25.03904151361334, -527.0782982780423, -735.9036169573473, -829.7185360871349, 273.6700878251817, -533.3558472230585, -552.8796478332274, -659.2706337442802, -985.1209881744226, -585.2947117321295, -333.7670571936527, -422.4531454885925, -850.0701813786262, -586.4785605032881, 226.4388323870457, -961.7244117273665, -614.8007686843013, -503.0496012793558, -22.877323024152506, -263.121018797112, -210.737229028697, -969.9344375064217, -484.3279007605312, -614.2665903721622, 118.35457189325348, -5.061207822133074, -51.5840737101715, -501.49999771767045, -477.7414530330403, -166.6814543175095, -641.0591392259827, 108.59751098772198, -941.3952084152711, 3.9471219950235663, -421.31959963354694, -775.3875315587575, -240.19546208874544, -8.62502420392892, -642.9835243262512, -31.44566936975889, -11.365196360248666, -1232.1079267234581, -213.6370621446413, -193.0942667938029, -353.05703386890787, -1045.0402624608785, -511.4865041319148, -188.6187867486509, -485.15763462711413, -152.5998181421995, 257.1411721188225, -652.7041871378774, -440.0905615735552, -288.20106141443904, -862.1627265089296, -447.4933607955173, -21.54832141604144, -896.730992429183, -154.04757502848065, -680.1302119363764, -285.503273875231, -403.34710571849143, -362.33804222350005, -527.0156218543946, -641.3760505908333, -636.5331885833233, -754.4186371404458, -207.95839342109326, 27.941715887210208, -686.4733329524321, -967.8614129420855, -417.2647153680299, -1104.854648423156, 295.27716025068446, -979.3922168853923, -155.76722023076258, -90.30848215650589, -631.4385776481996, 136.28147119455508, -907.256902089862, -511.31563771709887, -473.9608826375601, -1325.2679983734067, 169.8949849901998, -734.0926707361281, -598.2917606572479, -610.3019377932865, -334.7907290630897, -296.7601590524009, -213.05040865981863, 38.18261387897191, -99.4701492825618, 153.65161697019923, -353.33957457517226, 128.5572928793153, -531.9866834846621, -402.94629291018424, -340.62822452090444, -939.7283493954218, -358.0839895575191, -95.55056725450561, -1126.6954898595593, -187.39096912130591, -320.38895595917694, -841.720306389685, 175.31738079286308, 39.15852093749544, -582.2864119344199], "policy_predator_policy_reward": [1046.8041934599103, 503.9682712234172, 935.481728584402, 751.1539942015496, 768.3553370908937, 520.3639150131091, 382.679944299979, 1305.9950799468863, 667.7569074796581, 360.9905835704488, 852.6260154120652, 757.1137037474091, 889.4700611170132, 503.72746353366983, 2.954578529105152, 1152.1542650906747, 1153.0587261380483, 140.2830206189164, 1176.6334822060012, 943.7247530104333, 916.7137166927863, 397.6744132083694, 540.4080855377359, 810.0946317444062, 321.68925274094494, 769.2385115296677, 597.3314501520379, 889.2893348395859, 45.446162028981405, 345.11670811165595, 1267.2800825112822, 445.92186181406794, 699.740342651038, 913.5055083306294, 922.041380403216, 158.95881601306962, 219.79786591278815, 962.4919422408947, 722.8058645981189, 680.1141734232589, 289.0556909681161, 571.8689831820413, 215.83104423466207, 1034.6148269073367, 465.27100923575694, 437.5891925927598, 1062.8293092218296, 793.3479174099174, 341.98763314007675, 489.5411968954068, 853.7233347363219, 545.916718034053, 638.350836273914, 676.3844971643784, 659.2200865351417, 12.025052734279395, 276.0946225649444, 394.25672011537785, 433.15189954738656, 867.1588039759409, 654.2973405225268, 1172.58949951154, 737.2689093796483, 749.2578758529302, 10.339097747419835, 23.933682186215773, 916.7244233340798, 341.382873409372, 1045.4821873772041, 832.957711014753, 711.0274874609585, 124.72640490123777, 799.464964117907, 680.4298877824457, 330.45801757464056, 1.7174385237096828, 59.39667342044429, 1012.1706207888221, 104.04819059779315, 596.7434909955224, 439.3988402273332, 192.25243664598278, 982.8833810799995, 362.7089477505235, 941.3639174439197, 462.0797117392551, 1146.0572807840826, 418.10686224526745, 538.305619545803, 255.17662990672957, 1307.5355154323624, 892.8312061338177, 198.3565577769065, 525.662468876444, 894.4606609592734, 747.5233991598624, 230.31234576284774, 463.25336638956986, 262.55382262820325, 944.7095497972846, 1010.6495155463255, 731.4096035954365, 438.6432737280493, 634.2249700992515, 902.570181378627, 683.3862485277972, 180.3027155803013, 919.7270654551378, 342.7377240261406, 946.7946959529817, 56.10235151940259, 418.7424191187175, 726.2527841395894, 821.8843311799145, 530.9279007605325, 709.1665903721643, 166.74542810674657, 253.56120782213276, 309.70955190441947, 614.1423150286087, 675.7689250798012, 118.35398227075395, 646.6807043192821, 145.40934820152975, 859.3810565019961, 427.9467301540631, 1010.6423704014193, 760.3241522327982, 344.90101688847705, 262.65885351018636, 625.327522729267, 405.36463986049387, 933.5623339444844, 915.7285984104689, 240.23706214463996, 221.39426679380128, 425.642224918798, 1045.1470532703686, 521.806629445842, 506.5029519594212, 311.52327194897464, 526.4435233598175, 518.428094713089, 641.6511625662387, 488.55752710739904, 358.87229326427604, 830.1024613704368, 618.5889591097872, 719.7796341917896, 555.0894860755197, 740.8849415388718, 558.5173363452388, 350.9497400629833, 451.00063953074545, 738.3466327051805, 477.0039683725295, 983.9141067396157, 529.2628681932034, 549.8115170877608, 958.42369219282, 188.92412459720853, 565.3217507628254, 824.8642375996102, 697.9657634447623, 772.147206049513, 932.8957436033965, 985.3547715808727, 186.26722023076087, 561.4403447664414, 503.4924642463074, 418.4372368963372, 861.1089211118833, 895.1368404125773, 494.43535072642527, 1121.12923820557, 585.9411983375611, 726.6656260470836, 633.6751013118599, 822.8687897614091, 276.4101955138838, 345.4838893361992, 327.9266783760258, 135.86036632820384, 245.66204536829707, 99.84838302980037, 442.73957457517236, 215.7902435713943, 677.3656198822439, 551.8771767938435, 460.06299278592246, 807.6484876021259, 794.8620577840517, 377.07803993674395, 1119.0749463181792, 305.9262798083381, 450.5016340843587, 496.7126820889999, 741.2466179334722, 194.16882161286992, 679.1864119344206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.482723205695335, "mean_inference_ms": 3.249856526913147, "mean_action_processing_ms": 1.198297173340212, "mean_env_wait_ms": 9.955171568862124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022668004035949707, "StateBufferConnector_ms": 0.004207611083984375, "ViewRequirementAgentConnector_ms": 0.13122785091400146}, "num_episodes": 11, "episode_return_max": 895.4654614804358, "episode_return_min": -4.8869091520249555, "episode_return_mean": 287.11759797784924, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.14115767534152, "num_env_steps_trained_throughput_per_sec": 83.14115767534152, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 48319.778, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48319.727, "sample_time_ms": 2126.983, "learn_time_ms": 46176.179, "learn_throughput": 86.625, "synch_weights_time_ms": 14.585}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "fed12_00000", "date": "2024-08-21_18-54-58", "timestamp": 1724246698, "time_this_iter_s": 48.134178161621094, "time_total_s": 3022.1348905563354, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4ac670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3022.1348905563354, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 25.745588235294115, "ram_util_percent": 80.22647058823527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.28565071650914, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.4887560786393585, "policy_loss": -0.018956476984491384, "vf_loss": 6.505097876654731, "vf_explained_var": 0.6513765508220309, "kl": 0.01307335160438602, "entropy": 0.6812925205344246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 970.9600000000065}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.871276121164756, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.569670426404035, "policy_loss": -0.014201123555432316, "vf_loss": 6.581704848910135, "vf_explained_var": 0.4005112390669565, "kl": 0.010833515461889051, "entropy": 0.4588058547368125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 970.9600000000065}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 1037.0891728079964, "episode_reward_min": -4.8869091520249555, "episode_reward_mean": 311.16618404724716, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1325.2679983734067, "predator_policy": 1.7174385237096828}, "policy_reward_max": {"prey_policy": 360.4663521593099, "predator_policy": 1307.5355154323624}, "policy_reward_mean": {"prey_policy": -415.20770280703687, "predator_policy": 570.7907948306612}, "custom_metrics": {}, "hist_stats": {"episode_reward": [234.32796256065794, 235.4690003262302, 477.29462732428937, 149.60000000000008, 347.7108203479908, 121.27767956386512, 226.77399942686338, 704.8775621251511, 377.3012268494266, 283.514896951908, 300.3435637685385, 228.73842140799044, 651.7548058731606, 721.5428036386983, 308.51623651061976, 140.57448522978152, 256.7650053604331, 432.6419275028986, 599.3220424816591, 228.40466009762062, 321.3999999999997, 53.903446005014985, 13.699999999999987, 201.47671182772316, 83.7660990348499, 123.70000000000009, 314.90265133046336, 273.68259905750966, 174.88408806180223, 190.1344437548424, 259.7293351302916, 132.5019181605285, 419.7496752164659, 1.4000000000000057, 221.97976988892216, 76.36190707465308, 433.87995275454034, -4.8869091520249555, 171.64341923520874, 316.64804114505387, 149.40768802450754, 364.744201695121, 171.68205001546107, 188.8464288168513, 367.46544878438215, 141.49999999999983, 533.5999999999992, 370.76779550518813, 149.69999999999905, 259.6284242825506, 349.87970023581187, 574.2593914419094, 358.73938410598913, 356.26296889375175, 605.8178092712501, 54.900000000000524, 72.69198185937972, 328.2042905246941, 200.20934253947772, 764.5162422602721, 119.13819738367297, 139.0353331757735, 356.5898064220895, 465.2244909192483, 113.09999999999832, 325.99693699981106, 235.26773575865602, 545.8581787190421, 95.7142582948116, 137.70387273425536, 895.4654614804358, 36.462554695479376, 343.185749208044, 508.5707271129136, 404.295670784343, 551.69742315992, 27.956295965565772, 154.1863184189161, 163.5999999999983, 320.2348762929094, 342.89999999999975, 489.72647284829344, 268.36565214867596, 304.69820643323715, 273.90692914085776, 248.64798881221415, 571.5563744256494, 330.22734255036545, 524.7928255262698, 576.3765660413966, 473.0946659648886, 1037.0891728079964, 408.37608781817005, 309.16399881421916, 345.66959704065584, 97.49076240534404, 140.8999999999987, 537.33713126379, 638.0176427435296, 88.86507628305328], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-75.10099960506655, -781.4988021048885, -981.3002274571983, -269.8515572081925, 287.44846529530747, -200.71670811165578, -1267.2800825112822, -296.32186181406644, -248.6720874254442, -1016.862943208231, -925.6643324119982, -34.058184440420405, -934.7061200563862, -20.809688670433474, -794.9854633776118, 96.94298748138436, -0.16650875055056247, -483.4569385501792, 83.50510970507307, -1050.4360838951627, -620.6698784194086, 18.153240359431557, -564.704723226022, -1062.7340819977303, -540.2403763216333, 360.4663521593099, -463.8489734905718, -214.2482756411048, -783.0032234457492, -223.21587348191937, -565.0065905314513, 34.33593649181358, 27.98462289950596, -441.5709602193864, -936.6884619868433, 69.01968596641504, 37.508385326518486, -1265.0731828789328, -1001.8633458425749, -256.2587792923807, 28.860902252580285, 258.26631781378416, -916.7244233340798, -287.4794274043576, -1042.9821873772037, -821.7577110147506, -303.28400841372445, -330.9931721207346, -680.0396626269858, -716.089090238515, -246.5580175746373, 38.08256147629059, -47.25447106886412, -709.4101718099421, 151.63440845971596, -578.7434909955183, -397.3504273116207, -59.416761499891834, -166.09120042215824, -989.366684653521, -720.7856354283856, -422.92865862449605, -1146.0572807840826, -285.60494408473795, -159.68397752559534, -214.04859671047092, -1307.5355154323624, -891.4312061338173, 25.03904151361334, -527.0782982780423, -735.9036169573473, -829.7185360871349, 273.6700878251817, -533.3558472230585, -552.8796478332274, -659.2706337442802, -985.1209881744226, -585.2947117321295, -333.7670571936527, -422.4531454885925, -850.0701813786262, -586.4785605032881, 226.4388323870457, -961.7244117273665, -614.8007686843013, -503.0496012793558, -22.877323024152506, -263.121018797112, -210.737229028697, -969.9344375064217, -484.3279007605312, -614.2665903721622, 118.35457189325348, -5.061207822133074, -51.5840737101715, -501.49999771767045, -477.7414530330403, -166.6814543175095, -641.0591392259827, 108.59751098772198, -941.3952084152711, 3.9471219950235663, -421.31959963354694, -775.3875315587575, -240.19546208874544, -8.62502420392892, -642.9835243262512, -31.44566936975889, -11.365196360248666, -1232.1079267234581, -213.6370621446413, -193.0942667938029, -353.05703386890787, -1045.0402624608785, -511.4865041319148, -188.6187867486509, -485.15763462711413, -152.5998181421995, 257.1411721188225, -652.7041871378774, -440.0905615735552, -288.20106141443904, -862.1627265089296, -447.4933607955173, -21.54832141604144, -896.730992429183, -154.04757502848065, -680.1302119363764, -285.503273875231, -403.34710571849143, -362.33804222350005, -527.0156218543946, -641.3760505908333, -636.5331885833233, -754.4186371404458, -207.95839342109326, 27.941715887210208, -686.4733329524321, -967.8614129420855, -417.2647153680299, -1104.854648423156, 295.27716025068446, -979.3922168853923, -155.76722023076258, -90.30848215650589, -631.4385776481996, 136.28147119455508, -907.256902089862, -511.31563771709887, -473.9608826375601, -1325.2679983734067, 169.8949849901998, -734.0926707361281, -598.2917606572479, -610.3019377932865, -334.7907290630897, -296.7601590524009, -213.05040865981863, 38.18261387897191, -99.4701492825618, 153.65161697019923, -353.33957457517226, 128.5572928793153, -531.9866834846621, -402.94629291018424, -340.62822452090444, -939.7283493954218, -358.0839895575191, -95.55056725450561, -1126.6954898595593, -187.39096912130591, -320.38895595917694, -841.720306389685, 175.31738079286308, 39.15852093749544, -582.2864119344199, -83.24566175848216, 59.15252146579515, 113.94345459448897, -808.288265657002, -623.0276481786606, -43.90602907928994, 336.78307564773803, -1002.7949372459424, 303.3928816018755, -719.5471644463468, -633.5891315906583, -472.0733656771164, -725.3339414568088, 241.91936447892166, -352.86552652558197, -612.4172314667244, -435.8826875869785, -215.3991912952584, -556.0620645329129, 181.59636785096546, 306.2896048420431, -763.2057425549826, -667.4123141377521, -758.9556494453157], "policy_predator_policy_reward": [321.68925274094494, 769.2385115296677, 597.3314501520379, 889.2893348395859, 45.446162028981405, 345.11670811165595, 1267.2800825112822, 445.92186181406794, 699.740342651038, 913.5055083306294, 922.041380403216, 158.95881601306962, 219.79786591278815, 962.4919422408947, 722.8058645981189, 680.1141734232589, 289.0556909681161, 571.8689831820413, 215.83104423466207, 1034.6148269073367, 465.27100923575694, 437.5891925927598, 1062.8293092218296, 793.3479174099174, 341.98763314007675, 489.5411968954068, 853.7233347363219, 545.916718034053, 638.350836273914, 676.3844971643784, 659.2200865351417, 12.025052734279395, 276.0946225649444, 394.25672011537785, 433.15189954738656, 867.1588039759409, 654.2973405225268, 1172.58949951154, 737.2689093796483, 749.2578758529302, 10.339097747419835, 23.933682186215773, 916.7244233340798, 341.382873409372, 1045.4821873772041, 832.957711014753, 711.0274874609585, 124.72640490123777, 799.464964117907, 680.4298877824457, 330.45801757464056, 1.7174385237096828, 59.39667342044429, 1012.1706207888221, 104.04819059779315, 596.7434909955224, 439.3988402273332, 192.25243664598278, 982.8833810799995, 362.7089477505235, 941.3639174439197, 462.0797117392551, 1146.0572807840826, 418.10686224526745, 538.305619545803, 255.17662990672957, 1307.5355154323624, 892.8312061338177, 198.3565577769065, 525.662468876444, 894.4606609592734, 747.5233991598624, 230.31234576284774, 463.25336638956986, 262.55382262820325, 944.7095497972846, 1010.6495155463255, 731.4096035954365, 438.6432737280493, 634.2249700992515, 902.570181378627, 683.3862485277972, 180.3027155803013, 919.7270654551378, 342.7377240261406, 946.7946959529817, 56.10235151940259, 418.7424191187175, 726.2527841395894, 821.8843311799145, 530.9279007605325, 709.1665903721643, 166.74542810674657, 253.56120782213276, 309.70955190441947, 614.1423150286087, 675.7689250798012, 118.35398227075395, 646.6807043192821, 145.40934820152975, 859.3810565019961, 427.9467301540631, 1010.6423704014193, 760.3241522327982, 344.90101688847705, 262.65885351018636, 625.327522729267, 405.36463986049387, 933.5623339444844, 915.7285984104689, 240.23706214463996, 221.39426679380128, 425.642224918798, 1045.1470532703686, 521.806629445842, 506.5029519594212, 311.52327194897464, 526.4435233598175, 518.428094713089, 641.6511625662387, 488.55752710739904, 358.87229326427604, 830.1024613704368, 618.5889591097872, 719.7796341917896, 555.0894860755197, 740.8849415388718, 558.5173363452388, 350.9497400629833, 451.00063953074545, 738.3466327051805, 477.0039683725295, 983.9141067396157, 529.2628681932034, 549.8115170877608, 958.42369219282, 188.92412459720853, 565.3217507628254, 824.8642375996102, 697.9657634447623, 772.147206049513, 932.8957436033965, 985.3547715808727, 186.26722023076087, 561.4403447664414, 503.4924642463074, 418.4372368963372, 861.1089211118833, 895.1368404125773, 494.43535072642527, 1121.12923820557, 585.9411983375611, 726.6656260470836, 633.6751013118599, 822.8687897614091, 276.4101955138838, 345.4838893361992, 327.9266783760258, 135.86036632820384, 245.66204536829707, 99.84838302980037, 442.73957457517236, 215.7902435713943, 677.3656198822439, 551.8771767938435, 460.06299278592246, 807.6484876021259, 794.8620577840517, 377.07803993674395, 1119.0749463181792, 305.9262798083381, 450.5016340843587, 496.7126820889999, 741.2466179334722, 194.16882161286992, 679.1864119344206, 345.69678045494095, 203.18918536401537, 559.4675591417001, 711.2538179622127, 628.7570520932344, 511.2712911296057, 909.0017645892297, 794.099269816972, 160.8083708140773, 663.721999848565, 825.628530876768, 589.1979652052299, 754.4503182424683, 74.63385577607504, 813.9955113959388, 248.77800900171354, 541.9826875869808, 250.19919129525687, 662.5030869483228, 249.29974099741517, 549.2962195238231, 545.637560932645, 687.509794155476, 827.7232457106459]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4750009172257537, "mean_inference_ms": 3.248704312871018, "mean_action_processing_ms": 1.2023443142255923, "mean_env_wait_ms": 9.967708913862266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003928184509277344, "StateBufferConnector_ms": 0.004890799522399902, "ViewRequirementAgentConnector_ms": 0.12786591053009033}, "num_episodes": 12, "episode_return_max": 1037.0891728079964, "episode_return_min": -4.8869091520249555, "episode_return_mean": 311.16618404724716, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.2451932140251, "num_env_steps_trained_throughput_per_sec": 81.2451932140251, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 48335.785, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48335.732, "sample_time_ms": 2089.609, "learn_time_ms": 46230.033, "learn_throughput": 86.524, "synch_weights_time_ms": 14.085}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "fed12_00000", "date": "2024-08-21_18-55-47", "timestamp": 1724246747, "time_this_iter_s": 49.27451419830322, "time_total_s": 3071.4094047546387, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4caf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3071.4094047546387, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 28.442857142857143, "ram_util_percent": 81.3757142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.495180830879818, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.639641020033094, "policy_loss": -0.01963537029784035, "vf_loss": 6.656918802210893, "vf_explained_var": 0.6667247425311457, "kl": 0.011787911001026196, "entropy": 0.6392968293693331, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.924623822030567, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.585955425545022, "policy_loss": -0.01731612293650864, "vf_loss": 6.601004842980198, "vf_explained_var": 0.38051713897437645, "kl": 0.011333609816295503, "entropy": 0.4301779566776185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 1037.0891728079964, "episode_reward_min": -4.8869091520249555, "episode_reward_mean": 302.84942885682574, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1325.2679983734067, "predator_policy": 1.7174385237096828}, "policy_reward_max": {"prey_policy": 379.5865922494585, "predator_policy": 1307.5355154323624}, "policy_reward_mean": {"prey_policy": -405.07037960551264, "predator_policy": 556.4950940339263}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.3435637685385, 228.73842140799044, 651.7548058731606, 721.5428036386983, 308.51623651061976, 140.57448522978152, 256.7650053604331, 432.6419275028986, 599.3220424816591, 228.40466009762062, 321.3999999999997, 53.903446005014985, 13.699999999999987, 201.47671182772316, 83.7660990348499, 123.70000000000009, 314.90265133046336, 273.68259905750966, 174.88408806180223, 190.1344437548424, 259.7293351302916, 132.5019181605285, 419.7496752164659, 1.4000000000000057, 221.97976988892216, 76.36190707465308, 433.87995275454034, -4.8869091520249555, 171.64341923520874, 316.64804114505387, 149.40768802450754, 364.744201695121, 171.68205001546107, 188.8464288168513, 367.46544878438215, 141.49999999999983, 533.5999999999992, 370.76779550518813, 149.69999999999905, 259.6284242825506, 349.87970023581187, 574.2593914419094, 358.73938410598913, 356.26296889375175, 605.8178092712501, 54.900000000000524, 72.69198185937972, 328.2042905246941, 200.20934253947772, 764.5162422602721, 119.13819738367297, 139.0353331757735, 356.5898064220895, 465.2244909192483, 113.09999999999832, 325.99693699981106, 235.26773575865602, 545.8581787190421, 95.7142582948116, 137.70387273425536, 895.4654614804358, 36.462554695479376, 343.185749208044, 508.5707271129136, 404.295670784343, 551.69742315992, 27.956295965565772, 154.1863184189161, 163.5999999999983, 320.2348762929094, 342.89999999999975, 489.72647284829344, 268.36565214867596, 304.69820643323715, 273.90692914085776, 248.64798881221415, 571.5563744256494, 330.22734255036545, 524.7928255262698, 576.3765660413966, 473.0946659648886, 1037.0891728079964, 408.37608781817005, 309.16399881421916, 345.66959704065584, 97.49076240534404, 140.8999999999987, 537.33713126379, 638.0176427435296, 88.86507628305328, 123.74935274302095, 28.199999999999996, 362.22407526317033, 224.22241840080451, 169.86236055394116, 127.30464875794468, 187.90051881510013, 432.0066820496863, 317.25956873535176, 353.7426311152281], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-620.6698784194086, 18.153240359431557, -564.704723226022, -1062.7340819977303, -540.2403763216333, 360.4663521593099, -463.8489734905718, -214.2482756411048, -783.0032234457492, -223.21587348191937, -565.0065905314513, 34.33593649181358, 27.98462289950596, -441.5709602193864, -936.6884619868433, 69.01968596641504, 37.508385326518486, -1265.0731828789328, -1001.8633458425749, -256.2587792923807, 28.860902252580285, 258.26631781378416, -916.7244233340798, -287.4794274043576, -1042.9821873772037, -821.7577110147506, -303.28400841372445, -330.9931721207346, -680.0396626269858, -716.089090238515, -246.5580175746373, 38.08256147629059, -47.25447106886412, -709.4101718099421, 151.63440845971596, -578.7434909955183, -397.3504273116207, -59.416761499891834, -166.09120042215824, -989.366684653521, -720.7856354283856, -422.92865862449605, -1146.0572807840826, -285.60494408473795, -159.68397752559534, -214.04859671047092, -1307.5355154323624, -891.4312061338173, 25.03904151361334, -527.0782982780423, -735.9036169573473, -829.7185360871349, 273.6700878251817, -533.3558472230585, -552.8796478332274, -659.2706337442802, -985.1209881744226, -585.2947117321295, -333.7670571936527, -422.4531454885925, -850.0701813786262, -586.4785605032881, 226.4388323870457, -961.7244117273665, -614.8007686843013, -503.0496012793558, -22.877323024152506, -263.121018797112, -210.737229028697, -969.9344375064217, -484.3279007605312, -614.2665903721622, 118.35457189325348, -5.061207822133074, -51.5840737101715, -501.49999771767045, -477.7414530330403, -166.6814543175095, -641.0591392259827, 108.59751098772198, -941.3952084152711, 3.9471219950235663, -421.31959963354694, -775.3875315587575, -240.19546208874544, -8.62502420392892, -642.9835243262512, -31.44566936975889, -11.365196360248666, -1232.1079267234581, -213.6370621446413, -193.0942667938029, -353.05703386890787, -1045.0402624608785, -511.4865041319148, -188.6187867486509, -485.15763462711413, -152.5998181421995, 257.1411721188225, -652.7041871378774, -440.0905615735552, -288.20106141443904, -862.1627265089296, -447.4933607955173, -21.54832141604144, -896.730992429183, -154.04757502848065, -680.1302119363764, -285.503273875231, -403.34710571849143, -362.33804222350005, -527.0156218543946, -641.3760505908333, -636.5331885833233, -754.4186371404458, -207.95839342109326, 27.941715887210208, -686.4733329524321, -967.8614129420855, -417.2647153680299, -1104.854648423156, 295.27716025068446, -979.3922168853923, -155.76722023076258, -90.30848215650589, -631.4385776481996, 136.28147119455508, -907.256902089862, -511.31563771709887, -473.9608826375601, -1325.2679983734067, 169.8949849901998, -734.0926707361281, -598.2917606572479, -610.3019377932865, -334.7907290630897, -296.7601590524009, -213.05040865981863, 38.18261387897191, -99.4701492825618, 153.65161697019923, -353.33957457517226, 128.5572928793153, -531.9866834846621, -402.94629291018424, -340.62822452090444, -939.7283493954218, -358.0839895575191, -95.55056725450561, -1126.6954898595593, -187.39096912130591, -320.38895595917694, -841.720306389685, 175.31738079286308, 39.15852093749544, -582.2864119344199, -83.24566175848216, 59.15252146579515, 113.94345459448897, -808.288265657002, -623.0276481786606, -43.90602907928994, 336.78307564773803, -1002.7949372459424, 303.3928816018755, -719.5471644463468, -633.5891315906583, -472.0733656771164, -725.3339414568088, 241.91936447892166, -352.86552652558197, -612.4172314667244, -435.8826875869785, -215.3991912952584, -556.0620645329129, 181.59636785096546, 306.2896048420431, -763.2057425549826, -667.4123141377521, -758.9556494453157, -15.564519547359852, -434.8282690389832, -941.6042654690393, -561.0699660412165, -174.52989208914056, -672.1425900683105, -361.66342308323055, -135.18274800099914, -384.0597186195523, -475.26975574843107, -634.5378355052297, -539.1754247407173, -511.3228785232241, -249.50213514332344, 379.5865922494585, -534.6161791666436, -153.86656739254875, -37.80032260889199, -106.99129945144283, -342.38618882333714], "policy_predator_policy_reward": [465.27100923575694, 437.5891925927598, 1062.8293092218296, 793.3479174099174, 341.98763314007675, 489.5411968954068, 853.7233347363219, 545.916718034053, 638.350836273914, 676.3844971643784, 659.2200865351417, 12.025052734279395, 276.0946225649444, 394.25672011537785, 433.15189954738656, 867.1588039759409, 654.2973405225268, 1172.58949951154, 737.2689093796483, 749.2578758529302, 10.339097747419835, 23.933682186215773, 916.7244233340798, 341.382873409372, 1045.4821873772041, 832.957711014753, 711.0274874609585, 124.72640490123777, 799.464964117907, 680.4298877824457, 330.45801757464056, 1.7174385237096828, 59.39667342044429, 1012.1706207888221, 104.04819059779315, 596.7434909955224, 439.3988402273332, 192.25243664598278, 982.8833810799995, 362.7089477505235, 941.3639174439197, 462.0797117392551, 1146.0572807840826, 418.10686224526745, 538.305619545803, 255.17662990672957, 1307.5355154323624, 892.8312061338177, 198.3565577769065, 525.662468876444, 894.4606609592734, 747.5233991598624, 230.31234576284774, 463.25336638956986, 262.55382262820325, 944.7095497972846, 1010.6495155463255, 731.4096035954365, 438.6432737280493, 634.2249700992515, 902.570181378627, 683.3862485277972, 180.3027155803013, 919.7270654551378, 342.7377240261406, 946.7946959529817, 56.10235151940259, 418.7424191187175, 726.2527841395894, 821.8843311799145, 530.9279007605325, 709.1665903721643, 166.74542810674657, 253.56120782213276, 309.70955190441947, 614.1423150286087, 675.7689250798012, 118.35398227075395, 646.6807043192821, 145.40934820152975, 859.3810565019961, 427.9467301540631, 1010.6423704014193, 760.3241522327982, 344.90101688847705, 262.65885351018636, 625.327522729267, 405.36463986049387, 933.5623339444844, 915.7285984104689, 240.23706214463996, 221.39426679380128, 425.642224918798, 1045.1470532703686, 521.806629445842, 506.5029519594212, 311.52327194897464, 526.4435233598175, 518.428094713089, 641.6511625662387, 488.55752710739904, 358.87229326427604, 830.1024613704368, 618.5889591097872, 719.7796341917896, 555.0894860755197, 740.8849415388718, 558.5173363452388, 350.9497400629833, 451.00063953074545, 738.3466327051805, 477.0039683725295, 983.9141067396157, 529.2628681932034, 549.8115170877608, 958.42369219282, 188.92412459720853, 565.3217507628254, 824.8642375996102, 697.9657634447623, 772.147206049513, 932.8957436033965, 985.3547715808727, 186.26722023076087, 561.4403447664414, 503.4924642463074, 418.4372368963372, 861.1089211118833, 895.1368404125773, 494.43535072642527, 1121.12923820557, 585.9411983375611, 726.6656260470836, 633.6751013118599, 822.8687897614091, 276.4101955138838, 345.4838893361992, 327.9266783760258, 135.86036632820384, 245.66204536829707, 99.84838302980037, 442.73957457517236, 215.7902435713943, 677.3656198822439, 551.8771767938435, 460.06299278592246, 807.6484876021259, 794.8620577840517, 377.07803993674395, 1119.0749463181792, 305.9262798083381, 450.5016340843587, 496.7126820889999, 741.2466179334722, 194.16882161286992, 679.1864119344206, 345.69678045494095, 203.18918536401537, 559.4675591417001, 711.2538179622127, 628.7570520932344, 511.2712911296057, 909.0017645892297, 794.099269816972, 160.8083708140773, 663.721999848565, 825.628530876768, 589.1979652052299, 754.4503182424683, 74.63385577607504, 813.9955113959388, 248.77800900171354, 541.9826875869808, 250.19919129525687, 662.5030869483228, 249.29974099741517, 549.2962195238231, 545.637560932645, 687.509794155476, 827.7232457106459, 43.7138722903832, 530.4282690389831, 957.8042654690396, 573.069966041219, 728.4434792544132, 480.45307816620794, 380.663011630453, 340.40557785458753, 510.45971861955377, 518.7321163023732, 600.0786871248915, 700.9392218790018, 764.3936617198694, 184.33187076178368, 23.72008980022777, 563.3161791666447, 38.50255318649423, 470.42390555029823, 335.193453260614, 467.9266661293968]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4740273611439494, "mean_inference_ms": 3.2424925568304435, "mean_action_processing_ms": 1.1943856820980445, "mean_env_wait_ms": 9.967776478417203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003771066665649414, "StateBufferConnector_ms": 0.004875898361206055, "ViewRequirementAgentConnector_ms": 0.11112833023071289}, "num_episodes": 10, "episode_return_max": 1037.0891728079964, "episode_return_min": -4.8869091520249555, "episode_return_mean": 302.84942885682574, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.84732828028869, "num_env_steps_trained_throughput_per_sec": 83.84732828028869, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 48185.473, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48185.422, "sample_time_ms": 2041.936, "learn_time_ms": 46128.199, "learn_throughput": 86.715, "synch_weights_time_ms": 13.702}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "fed12_00000", "date": "2024-08-21_18-56-35", "timestamp": 1724246795, "time_this_iter_s": 47.71749806404114, "time_total_s": 3119.12690281868, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4ce670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3119.12690281868, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 24.982089552238804, "ram_util_percent": 81.22388059701494}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.277371138113516, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.176100525528035, "policy_loss": -0.02121937152382637, "vf_loss": 6.195045193919429, "vf_explained_var": 0.6893300252616721, "kl": 0.011373451932717766, "entropy": 0.6369927417191248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.967705926314864, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.372184910597625, "policy_loss": -0.016588850151846017, "vf_loss": 6.386552018715591, "vf_explained_var": 0.4115062409292453, "kl": 0.011108669802723896, "entropy": 0.4577602684813202, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 1037.0891728079964, "episode_reward_min": -4.8869091520249555, "episode_reward_mean": 295.67264449747114, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1325.2679983734067, "predator_policy": 0.8415777706911136}, "policy_reward_max": {"prey_policy": 383.9569426439564, "predator_policy": 1307.5355154323624}, "policy_reward_mean": {"prey_policy": -392.30980020196, "predator_policy": 540.1461224506965}, "custom_metrics": {}, "hist_stats": {"episode_reward": [321.3999999999997, 53.903446005014985, 13.699999999999987, 201.47671182772316, 83.7660990348499, 123.70000000000009, 314.90265133046336, 273.68259905750966, 174.88408806180223, 190.1344437548424, 259.7293351302916, 132.5019181605285, 419.7496752164659, 1.4000000000000057, 221.97976988892216, 76.36190707465308, 433.87995275454034, -4.8869091520249555, 171.64341923520874, 316.64804114505387, 149.40768802450754, 364.744201695121, 171.68205001546107, 188.8464288168513, 367.46544878438215, 141.49999999999983, 533.5999999999992, 370.76779550518813, 149.69999999999905, 259.6284242825506, 349.87970023581187, 574.2593914419094, 358.73938410598913, 356.26296889375175, 605.8178092712501, 54.900000000000524, 72.69198185937972, 328.2042905246941, 200.20934253947772, 764.5162422602721, 119.13819738367297, 139.0353331757735, 356.5898064220895, 465.2244909192483, 113.09999999999832, 325.99693699981106, 235.26773575865602, 545.8581787190421, 95.7142582948116, 137.70387273425536, 895.4654614804358, 36.462554695479376, 343.185749208044, 508.5707271129136, 404.295670784343, 551.69742315992, 27.956295965565772, 154.1863184189161, 163.5999999999983, 320.2348762929094, 342.89999999999975, 489.72647284829344, 268.36565214867596, 304.69820643323715, 273.90692914085776, 248.64798881221415, 571.5563744256494, 330.22734255036545, 524.7928255262698, 576.3765660413966, 473.0946659648886, 1037.0891728079964, 408.37608781817005, 309.16399881421916, 345.66959704065584, 97.49076240534404, 140.8999999999987, 537.33713126379, 638.0176427435296, 88.86507628305328, 123.74935274302095, 28.199999999999996, 362.22407526317033, 224.22241840080451, 169.86236055394116, 127.30464875794468, 187.90051881510013, 432.0066820496863, 317.25956873535176, 353.7426311152281, 167.0350293448649, 3.500000000000001, 593.9005222838896, 301.21902990234327, 252.90964480934738, 444.35655350307155, 131.99240750360403, 360.59999999999997, 15.590472718244907, 879.8218558705768], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [28.860902252580285, 258.26631781378416, -916.7244233340798, -287.4794274043576, -1042.9821873772037, -821.7577110147506, -303.28400841372445, -330.9931721207346, -680.0396626269858, -716.089090238515, -246.5580175746373, 38.08256147629059, -47.25447106886412, -709.4101718099421, 151.63440845971596, -578.7434909955183, -397.3504273116207, -59.416761499891834, -166.09120042215824, -989.366684653521, -720.7856354283856, -422.92865862449605, -1146.0572807840826, -285.60494408473795, -159.68397752559534, -214.04859671047092, -1307.5355154323624, -891.4312061338173, 25.03904151361334, -527.0782982780423, -735.9036169573473, -829.7185360871349, 273.6700878251817, -533.3558472230585, -552.8796478332274, -659.2706337442802, -985.1209881744226, -585.2947117321295, -333.7670571936527, -422.4531454885925, -850.0701813786262, -586.4785605032881, 226.4388323870457, -961.7244117273665, -614.8007686843013, -503.0496012793558, -22.877323024152506, -263.121018797112, -210.737229028697, -969.9344375064217, -484.3279007605312, -614.2665903721622, 118.35457189325348, -5.061207822133074, -51.5840737101715, -501.49999771767045, -477.7414530330403, -166.6814543175095, -641.0591392259827, 108.59751098772198, -941.3952084152711, 3.9471219950235663, -421.31959963354694, -775.3875315587575, -240.19546208874544, -8.62502420392892, -642.9835243262512, -31.44566936975889, -11.365196360248666, -1232.1079267234581, -213.6370621446413, -193.0942667938029, -353.05703386890787, -1045.0402624608785, -511.4865041319148, -188.6187867486509, -485.15763462711413, -152.5998181421995, 257.1411721188225, -652.7041871378774, -440.0905615735552, -288.20106141443904, -862.1627265089296, -447.4933607955173, -21.54832141604144, -896.730992429183, -154.04757502848065, -680.1302119363764, -285.503273875231, -403.34710571849143, -362.33804222350005, -527.0156218543946, -641.3760505908333, -636.5331885833233, -754.4186371404458, -207.95839342109326, 27.941715887210208, -686.4733329524321, -967.8614129420855, -417.2647153680299, -1104.854648423156, 295.27716025068446, -979.3922168853923, -155.76722023076258, -90.30848215650589, -631.4385776481996, 136.28147119455508, -907.256902089862, -511.31563771709887, -473.9608826375601, -1325.2679983734067, 169.8949849901998, -734.0926707361281, -598.2917606572479, -610.3019377932865, -334.7907290630897, -296.7601590524009, -213.05040865981863, 38.18261387897191, -99.4701492825618, 153.65161697019923, -353.33957457517226, 128.5572928793153, -531.9866834846621, -402.94629291018424, -340.62822452090444, -939.7283493954218, -358.0839895575191, -95.55056725450561, -1126.6954898595593, -187.39096912130591, -320.38895595917694, -841.720306389685, 175.31738079286308, 39.15852093749544, -582.2864119344199, -83.24566175848216, 59.15252146579515, 113.94345459448897, -808.288265657002, -623.0276481786606, -43.90602907928994, 336.78307564773803, -1002.7949372459424, 303.3928816018755, -719.5471644463468, -633.5891315906583, -472.0733656771164, -725.3339414568088, 241.91936447892166, -352.86552652558197, -612.4172314667244, -435.8826875869785, -215.3991912952584, -556.0620645329129, 181.59636785096546, 306.2896048420431, -763.2057425549826, -667.4123141377521, -758.9556494453157, -15.564519547359852, -434.8282690389832, -941.6042654690393, -561.0699660412165, -174.52989208914056, -672.1425900683105, -361.66342308323055, -135.18274800099914, -384.0597186195523, -475.26975574843107, -634.5378355052297, -539.1754247407173, -511.3228785232241, -249.50213514332344, 379.5865922494585, -534.6161791666436, -153.86656739254875, -37.80032260889199, -106.99129945144283, -342.38618882333714, -151.00921321616232, 37.093451574175795, -873.0375517159218, -939.0906286100242, 319.36361289074034, -1063.622258766889, -593.4659492733867, -116.78495953485888, -1.8272024693713087, 111.36360107873087, -284.76840686060916, 383.9569426439564, -549.9582501136202, -609.2190975599984, -677.7660404466266, 167.5017742375119, -79.66336704596459, -119.66616479727172, 215.87600258234113, -1014.8189174589404], "policy_predator_policy_reward": [10.339097747419835, 23.933682186215773, 916.7244233340798, 341.382873409372, 1045.4821873772041, 832.957711014753, 711.0274874609585, 124.72640490123777, 799.464964117907, 680.4298877824457, 330.45801757464056, 1.7174385237096828, 59.39667342044429, 1012.1706207888221, 104.04819059779315, 596.7434909955224, 439.3988402273332, 192.25243664598278, 982.8833810799995, 362.7089477505235, 941.3639174439197, 462.0797117392551, 1146.0572807840826, 418.10686224526745, 538.305619545803, 255.17662990672957, 1307.5355154323624, 892.8312061338177, 198.3565577769065, 525.662468876444, 894.4606609592734, 747.5233991598624, 230.31234576284774, 463.25336638956986, 262.55382262820325, 944.7095497972846, 1010.6495155463255, 731.4096035954365, 438.6432737280493, 634.2249700992515, 902.570181378627, 683.3862485277972, 180.3027155803013, 919.7270654551378, 342.7377240261406, 946.7946959529817, 56.10235151940259, 418.7424191187175, 726.2527841395894, 821.8843311799145, 530.9279007605325, 709.1665903721643, 166.74542810674657, 253.56120782213276, 309.70955190441947, 614.1423150286087, 675.7689250798012, 118.35398227075395, 646.6807043192821, 145.40934820152975, 859.3810565019961, 427.9467301540631, 1010.6423704014193, 760.3241522327982, 344.90101688847705, 262.65885351018636, 625.327522729267, 405.36463986049387, 933.5623339444844, 915.7285984104689, 240.23706214463996, 221.39426679380128, 425.642224918798, 1045.1470532703686, 521.806629445842, 506.5029519594212, 311.52327194897464, 526.4435233598175, 518.428094713089, 641.6511625662387, 488.55752710739904, 358.87229326427604, 830.1024613704368, 618.5889591097872, 719.7796341917896, 555.0894860755197, 740.8849415388718, 558.5173363452388, 350.9497400629833, 451.00063953074545, 738.3466327051805, 477.0039683725295, 983.9141067396157, 529.2628681932034, 549.8115170877608, 958.42369219282, 188.92412459720853, 565.3217507628254, 824.8642375996102, 697.9657634447623, 772.147206049513, 932.8957436033965, 985.3547715808727, 186.26722023076087, 561.4403447664414, 503.4924642463074, 418.4372368963372, 861.1089211118833, 895.1368404125773, 494.43535072642527, 1121.12923820557, 585.9411983375611, 726.6656260470836, 633.6751013118599, 822.8687897614091, 276.4101955138838, 345.4838893361992, 327.9266783760258, 135.86036632820384, 245.66204536829707, 99.84838302980037, 442.73957457517236, 215.7902435713943, 677.3656198822439, 551.8771767938435, 460.06299278592246, 807.6484876021259, 794.8620577840517, 377.07803993674395, 1119.0749463181792, 305.9262798083381, 450.5016340843587, 496.7126820889999, 741.2466179334722, 194.16882161286992, 679.1864119344206, 345.69678045494095, 203.18918536401537, 559.4675591417001, 711.2538179622127, 628.7570520932344, 511.2712911296057, 909.0017645892297, 794.099269816972, 160.8083708140773, 663.721999848565, 825.628530876768, 589.1979652052299, 754.4503182424683, 74.63385577607504, 813.9955113959388, 248.77800900171354, 541.9826875869808, 250.19919129525687, 662.5030869483228, 249.29974099741517, 549.2962195238231, 545.637560932645, 687.509794155476, 827.7232457106459, 43.7138722903832, 530.4282690389831, 957.8042654690396, 573.069966041219, 728.4434792544132, 480.45307816620794, 380.663011630453, 340.40557785458753, 510.45971861955377, 518.7321163023732, 600.0786871248915, 700.9392218790018, 764.3936617198694, 184.33187076178368, 23.72008980022777, 563.3161791666447, 38.50255318649423, 470.42390555029823, 335.193453260614, 467.9266661293968, 280.1092132161619, 0.8415777706911136, 874.8375517159222, 940.7906286100246, 406.9575310668084, 931.2016370932287, 534.8634286433592, 476.6065100672307, 60.03632695195433, 83.33691924803502, 322.16840686061505, 22.999610859111844, 1061.6644887823295, 229.5052663948987, 256.09666408397743, 614.767602125137, 213.31817966727334, 1.6018248942074795, 882.1417186423421, 796.6230521048332]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4703719646938436, "mean_inference_ms": 3.2431001277774385, "mean_action_processing_ms": 1.195671634907177, "mean_env_wait_ms": 9.973236003601924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003802180290222168, "StateBufferConnector_ms": 0.004916191101074219, "ViewRequirementAgentConnector_ms": 0.11097109317779541}, "num_episodes": 10, "episode_return_max": 1037.0891728079964, "episode_return_min": -4.8869091520249555, "episode_return_mean": 295.67264449747114, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.91061546682585, "num_env_steps_trained_throughput_per_sec": 82.91061546682585, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 48158.557, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48158.506, "sample_time_ms": 2049.458, "learn_time_ms": 46094.15, "learn_throughput": 86.779, "synch_weights_time_ms": 13.383}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "fed12_00000", "date": "2024-08-21_18-57-23", "timestamp": 1724246843, "time_this_iter_s": 48.256718158721924, "time_total_s": 3167.3836209774017, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f733c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3167.3836209774017, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 25.06764705882353, "ram_util_percent": 81.43382352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.46142360962257, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.431076109598553, "policy_loss": -0.018711160619314465, "vf_loss": 6.447062832716281, "vf_explained_var": 0.6649038610319612, "kl": 0.013622212060727178, "entropy": 0.6231283735188227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.784235822208345, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.180190594738753, "policy_loss": -0.01823170738314431, "vf_loss": 6.1962179113317415, "vf_explained_var": 0.4225555368516811, "kl": 0.01102199068849798, "entropy": 0.4214563729744109, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 1146.3059610058763, "episode_reward_min": -4.8869091520249555, "episode_reward_mean": 331.1129199110817, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1384.4607208114335, "predator_policy": 0.8415777706911136}, "policy_reward_max": {"prey_policy": 383.9569426439564, "predator_policy": 1307.5355154323624}, "policy_reward_mean": {"prey_policy": -402.51502003041236, "predator_policy": 568.0714799859539}, "custom_metrics": {}, "hist_stats": {"episode_reward": [259.7293351302916, 132.5019181605285, 419.7496752164659, 1.4000000000000057, 221.97976988892216, 76.36190707465308, 433.87995275454034, -4.8869091520249555, 171.64341923520874, 316.64804114505387, 149.40768802450754, 364.744201695121, 171.68205001546107, 188.8464288168513, 367.46544878438215, 141.49999999999983, 533.5999999999992, 370.76779550518813, 149.69999999999905, 259.6284242825506, 349.87970023581187, 574.2593914419094, 358.73938410598913, 356.26296889375175, 605.8178092712501, 54.900000000000524, 72.69198185937972, 328.2042905246941, 200.20934253947772, 764.5162422602721, 119.13819738367297, 139.0353331757735, 356.5898064220895, 465.2244909192483, 113.09999999999832, 325.99693699981106, 235.26773575865602, 545.8581787190421, 95.7142582948116, 137.70387273425536, 895.4654614804358, 36.462554695479376, 343.185749208044, 508.5707271129136, 404.295670784343, 551.69742315992, 27.956295965565772, 154.1863184189161, 163.5999999999983, 320.2348762929094, 342.89999999999975, 489.72647284829344, 268.36565214867596, 304.69820643323715, 273.90692914085776, 248.64798881221415, 571.5563744256494, 330.22734255036545, 524.7928255262698, 576.3765660413966, 473.0946659648886, 1037.0891728079964, 408.37608781817005, 309.16399881421916, 345.66959704065584, 97.49076240534404, 140.8999999999987, 537.33713126379, 638.0176427435296, 88.86507628305328, 123.74935274302095, 28.199999999999996, 362.22407526317033, 224.22241840080451, 169.86236055394116, 127.30464875794468, 187.90051881510013, 432.0066820496863, 317.25956873535176, 353.7426311152281, 167.0350293448649, 3.500000000000001, 593.9005222838896, 301.21902990234327, 252.90964480934738, 444.35655350307155, 131.99240750360403, 360.59999999999997, 15.590472718244907, 879.8218558705768, 360.1131678972831, 368.20000000000005, 1146.3059610058763, 1130.7094817298118, 559.1687639015901, 584.6422369140741, 370.32608973973515, 362.5999999999998, 122.67743594337443, 290.83444330151735], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-720.7856354283856, -422.92865862449605, -1146.0572807840826, -285.60494408473795, -159.68397752559534, -214.04859671047092, -1307.5355154323624, -891.4312061338173, 25.03904151361334, -527.0782982780423, -735.9036169573473, -829.7185360871349, 273.6700878251817, -533.3558472230585, -552.8796478332274, -659.2706337442802, -985.1209881744226, -585.2947117321295, -333.7670571936527, -422.4531454885925, -850.0701813786262, -586.4785605032881, 226.4388323870457, -961.7244117273665, -614.8007686843013, -503.0496012793558, -22.877323024152506, -263.121018797112, -210.737229028697, -969.9344375064217, -484.3279007605312, -614.2665903721622, 118.35457189325348, -5.061207822133074, -51.5840737101715, -501.49999771767045, -477.7414530330403, -166.6814543175095, -641.0591392259827, 108.59751098772198, -941.3952084152711, 3.9471219950235663, -421.31959963354694, -775.3875315587575, -240.19546208874544, -8.62502420392892, -642.9835243262512, -31.44566936975889, -11.365196360248666, -1232.1079267234581, -213.6370621446413, -193.0942667938029, -353.05703386890787, -1045.0402624608785, -511.4865041319148, -188.6187867486509, -485.15763462711413, -152.5998181421995, 257.1411721188225, -652.7041871378774, -440.0905615735552, -288.20106141443904, -862.1627265089296, -447.4933607955173, -21.54832141604144, -896.730992429183, -154.04757502848065, -680.1302119363764, -285.503273875231, -403.34710571849143, -362.33804222350005, -527.0156218543946, -641.3760505908333, -636.5331885833233, -754.4186371404458, -207.95839342109326, 27.941715887210208, -686.4733329524321, -967.8614129420855, -417.2647153680299, -1104.854648423156, 295.27716025068446, -979.3922168853923, -155.76722023076258, -90.30848215650589, -631.4385776481996, 136.28147119455508, -907.256902089862, -511.31563771709887, -473.9608826375601, -1325.2679983734067, 169.8949849901998, -734.0926707361281, -598.2917606572479, -610.3019377932865, -334.7907290630897, -296.7601590524009, -213.05040865981863, 38.18261387897191, -99.4701492825618, 153.65161697019923, -353.33957457517226, 128.5572928793153, -531.9866834846621, -402.94629291018424, -340.62822452090444, -939.7283493954218, -358.0839895575191, -95.55056725450561, -1126.6954898595593, -187.39096912130591, -320.38895595917694, -841.720306389685, 175.31738079286308, 39.15852093749544, -582.2864119344199, -83.24566175848216, 59.15252146579515, 113.94345459448897, -808.288265657002, -623.0276481786606, -43.90602907928994, 336.78307564773803, -1002.7949372459424, 303.3928816018755, -719.5471644463468, -633.5891315906583, -472.0733656771164, -725.3339414568088, 241.91936447892166, -352.86552652558197, -612.4172314667244, -435.8826875869785, -215.3991912952584, -556.0620645329129, 181.59636785096546, 306.2896048420431, -763.2057425549826, -667.4123141377521, -758.9556494453157, -15.564519547359852, -434.8282690389832, -941.6042654690393, -561.0699660412165, -174.52989208914056, -672.1425900683105, -361.66342308323055, -135.18274800099914, -384.0597186195523, -475.26975574843107, -634.5378355052297, -539.1754247407173, -511.3228785232241, -249.50213514332344, 379.5865922494585, -534.6161791666436, -153.86656739254875, -37.80032260889199, -106.99129945144283, -342.38618882333714, -151.00921321616232, 37.093451574175795, -873.0375517159218, -939.0906286100242, 319.36361289074034, -1063.622258766889, -593.4659492733867, -116.78495953485888, -1.8272024693713087, 111.36360107873087, -284.76840686060916, 383.9569426439564, -549.9582501136202, -609.2190975599984, -677.7660404466266, 167.5017742375119, -79.66336704596459, -119.66616479727172, 215.87600258234113, -1014.8189174589404, -1018.2621234015404, -452.35627645542274, -28.372243983255203, -103.5503205444054, -1384.4607208114335, 246.01621723628568, -1179.283815045673, 347.8002588555509, -1314.578528941797, 252.71894081658004, -600.0693491505017, -458.63988946101216, -896.9059552243975, 263.14467377379657, -712.6248315525404, 319.6377072314882, -978.4129843577368, -640.8097219819803, -1179.1350827453575, -339.5966378112449], "policy_predator_policy_reward": [941.3639174439197, 462.0797117392551, 1146.0572807840826, 418.10686224526745, 538.305619545803, 255.17662990672957, 1307.5355154323624, 892.8312061338177, 198.3565577769065, 525.662468876444, 894.4606609592734, 747.5233991598624, 230.31234576284774, 463.25336638956986, 262.55382262820325, 944.7095497972846, 1010.6495155463255, 731.4096035954365, 438.6432737280493, 634.2249700992515, 902.570181378627, 683.3862485277972, 180.3027155803013, 919.7270654551378, 342.7377240261406, 946.7946959529817, 56.10235151940259, 418.7424191187175, 726.2527841395894, 821.8843311799145, 530.9279007605325, 709.1665903721643, 166.74542810674657, 253.56120782213276, 309.70955190441947, 614.1423150286087, 675.7689250798012, 118.35398227075395, 646.6807043192821, 145.40934820152975, 859.3810565019961, 427.9467301540631, 1010.6423704014193, 760.3241522327982, 344.90101688847705, 262.65885351018636, 625.327522729267, 405.36463986049387, 933.5623339444844, 915.7285984104689, 240.23706214463996, 221.39426679380128, 425.642224918798, 1045.1470532703686, 521.806629445842, 506.5029519594212, 311.52327194897464, 526.4435233598175, 518.428094713089, 641.6511625662387, 488.55752710739904, 358.87229326427604, 830.1024613704368, 618.5889591097872, 719.7796341917896, 555.0894860755197, 740.8849415388718, 558.5173363452388, 350.9497400629833, 451.00063953074545, 738.3466327051805, 477.0039683725295, 983.9141067396157, 529.2628681932034, 549.8115170877608, 958.42369219282, 188.92412459720853, 565.3217507628254, 824.8642375996102, 697.9657634447623, 772.147206049513, 932.8957436033965, 985.3547715808727, 186.26722023076087, 561.4403447664414, 503.4924642463074, 418.4372368963372, 861.1089211118833, 895.1368404125773, 494.43535072642527, 1121.12923820557, 585.9411983375611, 726.6656260470836, 633.6751013118599, 822.8687897614091, 276.4101955138838, 345.4838893361992, 327.9266783760258, 135.86036632820384, 245.66204536829707, 99.84838302980037, 442.73957457517236, 215.7902435713943, 677.3656198822439, 551.8771767938435, 460.06299278592246, 807.6484876021259, 794.8620577840517, 377.07803993674395, 1119.0749463181792, 305.9262798083381, 450.5016340843587, 496.7126820889999, 741.2466179334722, 194.16882161286992, 679.1864119344206, 345.69678045494095, 203.18918536401537, 559.4675591417001, 711.2538179622127, 628.7570520932344, 511.2712911296057, 909.0017645892297, 794.099269816972, 160.8083708140773, 663.721999848565, 825.628530876768, 589.1979652052299, 754.4503182424683, 74.63385577607504, 813.9955113959388, 248.77800900171354, 541.9826875869808, 250.19919129525687, 662.5030869483228, 249.29974099741517, 549.2962195238231, 545.637560932645, 687.509794155476, 827.7232457106459, 43.7138722903832, 530.4282690389831, 957.8042654690396, 573.069966041219, 728.4434792544132, 480.45307816620794, 380.663011630453, 340.40557785458753, 510.45971861955377, 518.7321163023732, 600.0786871248915, 700.9392218790018, 764.3936617198694, 184.33187076178368, 23.72008980022777, 563.3161791666447, 38.50255318649423, 470.42390555029823, 335.193453260614, 467.9266661293968, 280.1092132161619, 0.8415777706911136, 874.8375517159222, 940.7906286100246, 406.9575310668084, 931.2016370932287, 534.8634286433592, 476.6065100672307, 60.03632695195433, 83.33691924803502, 322.16840686061505, 22.999610859111844, 1061.6644887823295, 229.5052663948987, 256.09666408397743, 614.767602125137, 213.31817966727334, 1.6018248942074795, 882.1417186423421, 796.6230521048332, 900.2401243516932, 930.4914434025543, 231.97224398325494, 268.1503205444061, 1206.5202166747183, 1078.2302479063037, 1039.9786112718114, 922.2144266481206, 1113.841391637488, 507.1869603893148, 675.8271811802196, 967.5242943453677, 888.9248418850381, 115.16252930529797, 716.8248315525412, 38.762292768511784, 984.3930570651561, 757.5070852179443, 805.9288454940556, 1003.6373183640699]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.467770826467811, "mean_inference_ms": 3.24193234233476, "mean_action_processing_ms": 1.182737697892405, "mean_env_wait_ms": 9.966734456211903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037894248962402344, "StateBufferConnector_ms": 0.004935741424560547, "ViewRequirementAgentConnector_ms": 0.10435211658477783}, "num_episodes": 10, "episode_return_max": 1146.3059610058763, "episode_return_min": -4.8869091520249555, "episode_return_mean": 331.1129199110817, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.843503638785585, "num_env_steps_trained_throughput_per_sec": 29.843503638785585, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 56762.789, "restore_workers_time_ms": 0.014, "training_step_time_ms": 56762.738, "sample_time_ms": 2052.461, "learn_time_ms": 54693.3, "learn_throughput": 73.135, "synch_weights_time_ms": 15.192}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "fed12_00000", "date": "2024-08-21_18-59-37", "timestamp": 1724246977, "time_this_iter_s": 134.1095449924469, "time_total_s": 3301.4931659698486, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4b5ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3301.4931659698486, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 28.969014084507045, "ram_util_percent": 82.04647887323942}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.872496229504783, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.213057673166668, "policy_loss": -0.01693689433879973, "vf_loss": 6.227689939327341, "vf_explained_var": 0.6817242785736367, "kl": 0.011523056144594515, "entropy": 0.6772489738212061, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 996.9474999999948}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.860524607587745, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.434114234914224, "policy_loss": -0.013729371739152287, "vf_loss": 6.445708160047178, "vf_explained_var": 0.395388262833237, "kl": 0.010677254700013215, "entropy": 0.4519321513554407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 996.9474999999948}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 1146.3059610058763, "episode_reward_min": 3.500000000000001, "episode_reward_mean": 343.36756986828703, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1384.4607208114335, "predator_policy": 0.8415777706911136}, "policy_reward_max": {"prey_policy": 383.9569426439564, "predator_policy": 1206.5202166747183}, "policy_reward_mean": {"prey_policy": -387.02727988249507, "predator_policy": 558.7110648166391}, "custom_metrics": {}, "hist_stats": {"episode_reward": [316.64804114505387, 149.40768802450754, 364.744201695121, 171.68205001546107, 188.8464288168513, 367.46544878438215, 141.49999999999983, 533.5999999999992, 370.76779550518813, 149.69999999999905, 259.6284242825506, 349.87970023581187, 574.2593914419094, 358.73938410598913, 356.26296889375175, 605.8178092712501, 54.900000000000524, 72.69198185937972, 328.2042905246941, 200.20934253947772, 764.5162422602721, 119.13819738367297, 139.0353331757735, 356.5898064220895, 465.2244909192483, 113.09999999999832, 325.99693699981106, 235.26773575865602, 545.8581787190421, 95.7142582948116, 137.70387273425536, 895.4654614804358, 36.462554695479376, 343.185749208044, 508.5707271129136, 404.295670784343, 551.69742315992, 27.956295965565772, 154.1863184189161, 163.5999999999983, 320.2348762929094, 342.89999999999975, 489.72647284829344, 268.36565214867596, 304.69820643323715, 273.90692914085776, 248.64798881221415, 571.5563744256494, 330.22734255036545, 524.7928255262698, 576.3765660413966, 473.0946659648886, 1037.0891728079964, 408.37608781817005, 309.16399881421916, 345.66959704065584, 97.49076240534404, 140.8999999999987, 537.33713126379, 638.0176427435296, 88.86507628305328, 123.74935274302095, 28.199999999999996, 362.22407526317033, 224.22241840080451, 169.86236055394116, 127.30464875794468, 187.90051881510013, 432.0066820496863, 317.25956873535176, 353.7426311152281, 167.0350293448649, 3.500000000000001, 593.9005222838896, 301.21902990234327, 252.90964480934738, 444.35655350307155, 131.99240750360403, 360.59999999999997, 15.590472718244907, 879.8218558705768, 360.1131678972831, 368.20000000000005, 1146.3059610058763, 1130.7094817298118, 559.1687639015901, 584.6422369140741, 370.32608973973515, 362.5999999999998, 122.67743594337443, 290.83444330151735, 120.29078504444715, 301.27522397016423, 358.90000000000117, 422.9275756006995, 493.3800891301913, 228.00043602038963, 44.41380699723433, 676.5611956045944, 292.07495166138824], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-333.7670571936527, -422.4531454885925, -850.0701813786262, -586.4785605032881, 226.4388323870457, -961.7244117273665, -614.8007686843013, -503.0496012793558, -22.877323024152506, -263.121018797112, -210.737229028697, -969.9344375064217, -484.3279007605312, -614.2665903721622, 118.35457189325348, -5.061207822133074, -51.5840737101715, -501.49999771767045, -477.7414530330403, -166.6814543175095, -641.0591392259827, 108.59751098772198, -941.3952084152711, 3.9471219950235663, -421.31959963354694, -775.3875315587575, -240.19546208874544, -8.62502420392892, -642.9835243262512, -31.44566936975889, -11.365196360248666, -1232.1079267234581, -213.6370621446413, -193.0942667938029, -353.05703386890787, -1045.0402624608785, -511.4865041319148, -188.6187867486509, -485.15763462711413, -152.5998181421995, 257.1411721188225, -652.7041871378774, -440.0905615735552, -288.20106141443904, -862.1627265089296, -447.4933607955173, -21.54832141604144, -896.730992429183, -154.04757502848065, -680.1302119363764, -285.503273875231, -403.34710571849143, -362.33804222350005, -527.0156218543946, -641.3760505908333, -636.5331885833233, -754.4186371404458, -207.95839342109326, 27.941715887210208, -686.4733329524321, -967.8614129420855, -417.2647153680299, -1104.854648423156, 295.27716025068446, -979.3922168853923, -155.76722023076258, -90.30848215650589, -631.4385776481996, 136.28147119455508, -907.256902089862, -511.31563771709887, -473.9608826375601, -1325.2679983734067, 169.8949849901998, -734.0926707361281, -598.2917606572479, -610.3019377932865, -334.7907290630897, -296.7601590524009, -213.05040865981863, 38.18261387897191, -99.4701492825618, 153.65161697019923, -353.33957457517226, 128.5572928793153, -531.9866834846621, -402.94629291018424, -340.62822452090444, -939.7283493954218, -358.0839895575191, -95.55056725450561, -1126.6954898595593, -187.39096912130591, -320.38895595917694, -841.720306389685, 175.31738079286308, 39.15852093749544, -582.2864119344199, -83.24566175848216, 59.15252146579515, 113.94345459448897, -808.288265657002, -623.0276481786606, -43.90602907928994, 336.78307564773803, -1002.7949372459424, 303.3928816018755, -719.5471644463468, -633.5891315906583, -472.0733656771164, -725.3339414568088, 241.91936447892166, -352.86552652558197, -612.4172314667244, -435.8826875869785, -215.3991912952584, -556.0620645329129, 181.59636785096546, 306.2896048420431, -763.2057425549826, -667.4123141377521, -758.9556494453157, -15.564519547359852, -434.8282690389832, -941.6042654690393, -561.0699660412165, -174.52989208914056, -672.1425900683105, -361.66342308323055, -135.18274800099914, -384.0597186195523, -475.26975574843107, -634.5378355052297, -539.1754247407173, -511.3228785232241, -249.50213514332344, 379.5865922494585, -534.6161791666436, -153.86656739254875, -37.80032260889199, -106.99129945144283, -342.38618882333714, -151.00921321616232, 37.093451574175795, -873.0375517159218, -939.0906286100242, 319.36361289074034, -1063.622258766889, -593.4659492733867, -116.78495953485888, -1.8272024693713087, 111.36360107873087, -284.76840686060916, 383.9569426439564, -549.9582501136202, -609.2190975599984, -677.7660404466266, 167.5017742375119, -79.66336704596459, -119.66616479727172, 215.87600258234113, -1014.8189174589404, -1018.2621234015404, -452.35627645542274, -28.372243983255203, -103.5503205444054, -1384.4607208114335, 246.01621723628568, -1179.283815045673, 347.8002588555509, -1314.578528941797, 252.71894081658004, -600.0693491505017, -458.63988946101216, -896.9059552243975, 263.14467377379657, -712.6248315525404, 319.6377072314882, -978.4129843577368, -640.8097219819803, -1179.1350827453575, -339.5966378112449, -418.2846728649918, -691.8199148517775, -159.25864426664714, -600.0666120458678, 28.46768559198975, 252.41332648731859, -222.16420979997037, -615.7762925744075, -969.8844821610119, -125.16162445097743, -182.1486824559845, -43.52452679814177, -752.659240793018, -1010.5292949599582, 135.57042126185183, -456.35225868113673, -590.1285447429473, -739.1333677256528], "policy_predator_policy_reward": [438.6432737280493, 634.2249700992515, 902.570181378627, 683.3862485277972, 180.3027155803013, 919.7270654551378, 342.7377240261406, 946.7946959529817, 56.10235151940259, 418.7424191187175, 726.2527841395894, 821.8843311799145, 530.9279007605325, 709.1665903721643, 166.74542810674657, 253.56120782213276, 309.70955190441947, 614.1423150286087, 675.7689250798012, 118.35398227075395, 646.6807043192821, 145.40934820152975, 859.3810565019961, 427.9467301540631, 1010.6423704014193, 760.3241522327982, 344.90101688847705, 262.65885351018636, 625.327522729267, 405.36463986049387, 933.5623339444844, 915.7285984104689, 240.23706214463996, 221.39426679380128, 425.642224918798, 1045.1470532703686, 521.806629445842, 506.5029519594212, 311.52327194897464, 526.4435233598175, 518.428094713089, 641.6511625662387, 488.55752710739904, 358.87229326427604, 830.1024613704368, 618.5889591097872, 719.7796341917896, 555.0894860755197, 740.8849415388718, 558.5173363452388, 350.9497400629833, 451.00063953074545, 738.3466327051805, 477.0039683725295, 983.9141067396157, 529.2628681932034, 549.8115170877608, 958.42369219282, 188.92412459720853, 565.3217507628254, 824.8642375996102, 697.9657634447623, 772.147206049513, 932.8957436033965, 985.3547715808727, 186.26722023076087, 561.4403447664414, 503.4924642463074, 418.4372368963372, 861.1089211118833, 895.1368404125773, 494.43535072642527, 1121.12923820557, 585.9411983375611, 726.6656260470836, 633.6751013118599, 822.8687897614091, 276.4101955138838, 345.4838893361992, 327.9266783760258, 135.86036632820384, 245.66204536829707, 99.84838302980037, 442.73957457517236, 215.7902435713943, 677.3656198822439, 551.8771767938435, 460.06299278592246, 807.6484876021259, 794.8620577840517, 377.07803993674395, 1119.0749463181792, 305.9262798083381, 450.5016340843587, 496.7126820889999, 741.2466179334722, 194.16882161286992, 679.1864119344206, 345.69678045494095, 203.18918536401537, 559.4675591417001, 711.2538179622127, 628.7570520932344, 511.2712911296057, 909.0017645892297, 794.099269816972, 160.8083708140773, 663.721999848565, 825.628530876768, 589.1979652052299, 754.4503182424683, 74.63385577607504, 813.9955113959388, 248.77800900171354, 541.9826875869808, 250.19919129525687, 662.5030869483228, 249.29974099741517, 549.2962195238231, 545.637560932645, 687.509794155476, 827.7232457106459, 43.7138722903832, 530.4282690389831, 957.8042654690396, 573.069966041219, 728.4434792544132, 480.45307816620794, 380.663011630453, 340.40557785458753, 510.45971861955377, 518.7321163023732, 600.0786871248915, 700.9392218790018, 764.3936617198694, 184.33187076178368, 23.72008980022777, 563.3161791666447, 38.50255318649423, 470.42390555029823, 335.193453260614, 467.9266661293968, 280.1092132161619, 0.8415777706911136, 874.8375517159222, 940.7906286100246, 406.9575310668084, 931.2016370932287, 534.8634286433592, 476.6065100672307, 60.03632695195433, 83.33691924803502, 322.16840686061505, 22.999610859111844, 1061.6644887823295, 229.5052663948987, 256.09666408397743, 614.767602125137, 213.31817966727334, 1.6018248942074795, 882.1417186423421, 796.6230521048332, 900.2401243516932, 930.4914434025543, 231.97224398325494, 268.1503205444061, 1206.5202166747183, 1078.2302479063037, 1039.9786112718114, 922.2144266481206, 1113.841391637488, 507.1869603893148, 675.8271811802196, 967.5242943453677, 888.9248418850381, 115.16252930529797, 716.8248315525412, 38.762292768511784, 984.3930570651561, 757.5070852179443, 805.9288454940556, 1003.6373183640699, 428.7498192959285, 801.6455534652887, 490.2887494479426, 570.3117308347389, 10.332314408010369, 67.68667351268124, 666.389049603227, 594.4790283718538, 616.107066086745, 972.3191296554265, 373.94911847637604, 79.72452679814118, 796.0730477902529, 1011.5292949599582, 380.06815093526643, 617.2748820886117, 894.7442239083546, 726.5926402216344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4616212867873544, "mean_inference_ms": 3.2381419808271272, "mean_action_processing_ms": 1.184064226446008, "mean_env_wait_ms": 9.982606447050113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038237571716308594, "StateBufferConnector_ms": 0.005027055740356445, "ViewRequirementAgentConnector_ms": 0.1288602352142334}, "num_episodes": 9, "episode_return_max": 1146.3059610058763, "episode_return_min": 3.500000000000001, "episode_return_mean": 343.36756986828703, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.18851408451117, "num_env_steps_trained_throughput_per_sec": 81.18851408451117, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 56862.755, "restore_workers_time_ms": 0.014, "training_step_time_ms": 56862.704, "sample_time_ms": 2116.565, "learn_time_ms": 54728.887, "learn_throughput": 73.088, "synch_weights_time_ms": 15.43}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "fed12_00000", "date": "2024-08-21_19-00-27", "timestamp": 1724247027, "time_this_iter_s": 49.31683683395386, "time_total_s": 3350.8100028038025, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4cddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3350.8100028038025, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 28.46142857142857, "ram_util_percent": 83.29285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.696064308459167, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.087826551457561, "policy_loss": -0.022555231023826217, "vf_loss": 6.107635031806098, "vf_explained_var": 0.7147020000944693, "kl": 0.013733817764592392, "entropy": 0.6980262465893277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.740365909268617, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.138111463677946, "policy_loss": -0.017607864218507772, "vf_loss": 6.153309602838345, "vf_explained_var": 0.42147110968670515, "kl": 0.012048600523402451, "entropy": 0.4735765896303944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 1146.3059610058763, "episode_reward_min": 3.500000000000001, "episode_reward_mean": 349.3563340437067, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1384.4607208114335, "predator_policy": 0.8415777706911136}, "policy_reward_max": {"prey_policy": 383.9569426439564, "predator_policy": 1206.5202166747183}, "policy_reward_mean": {"prey_policy": -381.61785285458564, "predator_policy": 556.2960198764396}, "custom_metrics": {}, "hist_stats": {"episode_reward": [367.46544878438215, 141.49999999999983, 533.5999999999992, 370.76779550518813, 149.69999999999905, 259.6284242825506, 349.87970023581187, 574.2593914419094, 358.73938410598913, 356.26296889375175, 605.8178092712501, 54.900000000000524, 72.69198185937972, 328.2042905246941, 200.20934253947772, 764.5162422602721, 119.13819738367297, 139.0353331757735, 356.5898064220895, 465.2244909192483, 113.09999999999832, 325.99693699981106, 235.26773575865602, 545.8581787190421, 95.7142582948116, 137.70387273425536, 895.4654614804358, 36.462554695479376, 343.185749208044, 508.5707271129136, 404.295670784343, 551.69742315992, 27.956295965565772, 154.1863184189161, 163.5999999999983, 320.2348762929094, 342.89999999999975, 489.72647284829344, 268.36565214867596, 304.69820643323715, 273.90692914085776, 248.64798881221415, 571.5563744256494, 330.22734255036545, 524.7928255262698, 576.3765660413966, 473.0946659648886, 1037.0891728079964, 408.37608781817005, 309.16399881421916, 345.66959704065584, 97.49076240534404, 140.8999999999987, 537.33713126379, 638.0176427435296, 88.86507628305328, 123.74935274302095, 28.199999999999996, 362.22407526317033, 224.22241840080451, 169.86236055394116, 127.30464875794468, 187.90051881510013, 432.0066820496863, 317.25956873535176, 353.7426311152281, 167.0350293448649, 3.500000000000001, 593.9005222838896, 301.21902990234327, 252.90964480934738, 444.35655350307155, 131.99240750360403, 360.59999999999997, 15.590472718244907, 879.8218558705768, 360.1131678972831, 368.20000000000005, 1146.3059610058763, 1130.7094817298118, 559.1687639015901, 584.6422369140741, 370.32608973973515, 362.5999999999998, 122.67743594337443, 290.83444330151735, 120.29078504444715, 301.27522397016423, 358.90000000000117, 422.9275756006995, 493.3800891301913, 228.00043602038963, 44.41380699723433, 676.5611956045944, 292.07495166138824, 505.44885216877935, 219.78548364630151, 465.6587854889764, 449.06301133147986, 150.24869460343243], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-210.737229028697, -969.9344375064217, -484.3279007605312, -614.2665903721622, 118.35457189325348, -5.061207822133074, -51.5840737101715, -501.49999771767045, -477.7414530330403, -166.6814543175095, -641.0591392259827, 108.59751098772198, -941.3952084152711, 3.9471219950235663, -421.31959963354694, -775.3875315587575, -240.19546208874544, -8.62502420392892, -642.9835243262512, -31.44566936975889, -11.365196360248666, -1232.1079267234581, -213.6370621446413, -193.0942667938029, -353.05703386890787, -1045.0402624608785, -511.4865041319148, -188.6187867486509, -485.15763462711413, -152.5998181421995, 257.1411721188225, -652.7041871378774, -440.0905615735552, -288.20106141443904, -862.1627265089296, -447.4933607955173, -21.54832141604144, -896.730992429183, -154.04757502848065, -680.1302119363764, -285.503273875231, -403.34710571849143, -362.33804222350005, -527.0156218543946, -641.3760505908333, -636.5331885833233, -754.4186371404458, -207.95839342109326, 27.941715887210208, -686.4733329524321, -967.8614129420855, -417.2647153680299, -1104.854648423156, 295.27716025068446, -979.3922168853923, -155.76722023076258, -90.30848215650589, -631.4385776481996, 136.28147119455508, -907.256902089862, -511.31563771709887, -473.9608826375601, -1325.2679983734067, 169.8949849901998, -734.0926707361281, -598.2917606572479, -610.3019377932865, -334.7907290630897, -296.7601590524009, -213.05040865981863, 38.18261387897191, -99.4701492825618, 153.65161697019923, -353.33957457517226, 128.5572928793153, -531.9866834846621, -402.94629291018424, -340.62822452090444, -939.7283493954218, -358.0839895575191, -95.55056725450561, -1126.6954898595593, -187.39096912130591, -320.38895595917694, -841.720306389685, 175.31738079286308, 39.15852093749544, -582.2864119344199, -83.24566175848216, 59.15252146579515, 113.94345459448897, -808.288265657002, -623.0276481786606, -43.90602907928994, 336.78307564773803, -1002.7949372459424, 303.3928816018755, -719.5471644463468, -633.5891315906583, -472.0733656771164, -725.3339414568088, 241.91936447892166, -352.86552652558197, -612.4172314667244, -435.8826875869785, -215.3991912952584, -556.0620645329129, 181.59636785096546, 306.2896048420431, -763.2057425549826, -667.4123141377521, -758.9556494453157, -15.564519547359852, -434.8282690389832, -941.6042654690393, -561.0699660412165, -174.52989208914056, -672.1425900683105, -361.66342308323055, -135.18274800099914, -384.0597186195523, -475.26975574843107, -634.5378355052297, -539.1754247407173, -511.3228785232241, -249.50213514332344, 379.5865922494585, -534.6161791666436, -153.86656739254875, -37.80032260889199, -106.99129945144283, -342.38618882333714, -151.00921321616232, 37.093451574175795, -873.0375517159218, -939.0906286100242, 319.36361289074034, -1063.622258766889, -593.4659492733867, -116.78495953485888, -1.8272024693713087, 111.36360107873087, -284.76840686060916, 383.9569426439564, -549.9582501136202, -609.2190975599984, -677.7660404466266, 167.5017742375119, -79.66336704596459, -119.66616479727172, 215.87600258234113, -1014.8189174589404, -1018.2621234015404, -452.35627645542274, -28.372243983255203, -103.5503205444054, -1384.4607208114335, 246.01621723628568, -1179.283815045673, 347.8002588555509, -1314.578528941797, 252.71894081658004, -600.0693491505017, -458.63988946101216, -896.9059552243975, 263.14467377379657, -712.6248315525404, 319.6377072314882, -978.4129843577368, -640.8097219819803, -1179.1350827453575, -339.5966378112449, -418.2846728649918, -691.8199148517775, -159.25864426664714, -600.0666120458678, 28.46768559198975, 252.41332648731859, -222.16420979997037, -615.7762925744075, -969.8844821610119, -125.16162445097743, -182.1486824559845, -43.52452679814177, -752.659240793018, -1010.5292949599582, 135.57042126185183, -456.35225868113673, -590.1285447429473, -739.1333677256528, 50.52097828884882, 65.10773333930257, -89.14598159454373, -815.1802018420252, -629.0718499031801, -240.27426044440824, 328.3204833054597, -671.2215804723705, -978.3231957933485, -270.74995499126317], "policy_predator_policy_reward": [726.2527841395894, 821.8843311799145, 530.9279007605325, 709.1665903721643, 166.74542810674657, 253.56120782213276, 309.70955190441947, 614.1423150286087, 675.7689250798012, 118.35398227075395, 646.6807043192821, 145.40934820152975, 859.3810565019961, 427.9467301540631, 1010.6423704014193, 760.3241522327982, 344.90101688847705, 262.65885351018636, 625.327522729267, 405.36463986049387, 933.5623339444844, 915.7285984104689, 240.23706214463996, 221.39426679380128, 425.642224918798, 1045.1470532703686, 521.806629445842, 506.5029519594212, 311.52327194897464, 526.4435233598175, 518.428094713089, 641.6511625662387, 488.55752710739904, 358.87229326427604, 830.1024613704368, 618.5889591097872, 719.7796341917896, 555.0894860755197, 740.8849415388718, 558.5173363452388, 350.9497400629833, 451.00063953074545, 738.3466327051805, 477.0039683725295, 983.9141067396157, 529.2628681932034, 549.8115170877608, 958.42369219282, 188.92412459720853, 565.3217507628254, 824.8642375996102, 697.9657634447623, 772.147206049513, 932.8957436033965, 985.3547715808727, 186.26722023076087, 561.4403447664414, 503.4924642463074, 418.4372368963372, 861.1089211118833, 895.1368404125773, 494.43535072642527, 1121.12923820557, 585.9411983375611, 726.6656260470836, 633.6751013118599, 822.8687897614091, 276.4101955138838, 345.4838893361992, 327.9266783760258, 135.86036632820384, 245.66204536829707, 99.84838302980037, 442.73957457517236, 215.7902435713943, 677.3656198822439, 551.8771767938435, 460.06299278592246, 807.6484876021259, 794.8620577840517, 377.07803993674395, 1119.0749463181792, 305.9262798083381, 450.5016340843587, 496.7126820889999, 741.2466179334722, 194.16882161286992, 679.1864119344206, 345.69678045494095, 203.18918536401537, 559.4675591417001, 711.2538179622127, 628.7570520932344, 511.2712911296057, 909.0017645892297, 794.099269816972, 160.8083708140773, 663.721999848565, 825.628530876768, 589.1979652052299, 754.4503182424683, 74.63385577607504, 813.9955113959388, 248.77800900171354, 541.9826875869808, 250.19919129525687, 662.5030869483228, 249.29974099741517, 549.2962195238231, 545.637560932645, 687.509794155476, 827.7232457106459, 43.7138722903832, 530.4282690389831, 957.8042654690396, 573.069966041219, 728.4434792544132, 480.45307816620794, 380.663011630453, 340.40557785458753, 510.45971861955377, 518.7321163023732, 600.0786871248915, 700.9392218790018, 764.3936617198694, 184.33187076178368, 23.72008980022777, 563.3161791666447, 38.50255318649423, 470.42390555029823, 335.193453260614, 467.9266661293968, 280.1092132161619, 0.8415777706911136, 874.8375517159222, 940.7906286100246, 406.9575310668084, 931.2016370932287, 534.8634286433592, 476.6065100672307, 60.03632695195433, 83.33691924803502, 322.16840686061505, 22.999610859111844, 1061.6644887823295, 229.5052663948987, 256.09666408397743, 614.767602125137, 213.31817966727334, 1.6018248942074795, 882.1417186423421, 796.6230521048332, 900.2401243516932, 930.4914434025543, 231.97224398325494, 268.1503205444061, 1206.5202166747183, 1078.2302479063037, 1039.9786112718114, 922.2144266481206, 1113.841391637488, 507.1869603893148, 675.8271811802196, 967.5242943453677, 888.9248418850381, 115.16252930529797, 716.8248315525412, 38.762292768511784, 984.3930570651561, 757.5070852179443, 805.9288454940556, 1003.6373183640699, 428.7498192959285, 801.6455534652887, 490.2887494479426, 570.3117308347389, 10.332314408010369, 67.68667351268124, 666.389049603227, 594.4790283718538, 616.107066086745, 972.3191296554265, 373.94911847637604, 79.72452679814118, 796.0730477902529, 1011.5292949599582, 380.06815093526643, 617.2748820886117, 894.7442239083546, 726.5926402216344, 210.129223294175, 179.69091724645256, 299.5314652408457, 824.5802018420263, 746.5073286200992, 588.49756721646, 523.3422844313766, 268.62182406701487, 981.4231957933492, 417.89864959469725]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4655953240221478, "mean_inference_ms": 3.2423539824800303, "mean_action_processing_ms": 1.1824374562255522, "mean_env_wait_ms": 9.981252766656961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00384521484375, "StateBufferConnector_ms": 0.005019187927246094, "ViewRequirementAgentConnector_ms": 0.12897861003875732}, "num_episodes": 5, "episode_return_max": 1146.3059610058763, "episode_return_min": 3.500000000000001, "episode_return_mean": 349.3563340437067, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.4169257712331, "num_env_steps_trained_throughput_per_sec": 82.4169257712331, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 56922.22, "restore_workers_time_ms": 0.014, "training_step_time_ms": 56922.17, "sample_time_ms": 2118.663, "learn_time_ms": 54785.839, "learn_throughput": 73.012, "synch_weights_time_ms": 15.769}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "fed12_00000", "date": "2024-08-21_19-01-15", "timestamp": 1724247075, "time_this_iter_s": 48.564664125442505, "time_total_s": 3399.374666929245, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4cb9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3399.374666929245, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 26.234782608695657, "ram_util_percent": 82.86811594202898}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.08907988008368, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.513697668358132, "policy_loss": -0.023326659412924004, "vf_loss": 6.533151088442121, "vf_explained_var": 0.6930027986645068, "kl": 0.01936629219153137, "entropy": 0.7078842775216179, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 996.4750000000058}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.439242674307849, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.162356474033739, "policy_loss": -0.01615530930893131, "vf_loss": 6.176149493928939, "vf_explained_var": 0.415690370337673, "kl": 0.011811316579397985, "entropy": 0.4799237872873034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 996.4750000000058}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 1146.3059610058763, "episode_reward_min": 3.500000000000001, "episode_reward_mean": 351.1069583048338, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1384.4607208114335, "predator_policy": 0.8415777706911136}, "policy_reward_max": {"prey_policy": 392.79999999999995, "predator_policy": 1206.5202166747183}, "policy_reward_mean": {"prey_policy": -375.22574784704034, "predator_policy": 550.7792269994578}, "custom_metrics": {}, "hist_stats": {"episode_reward": [328.2042905246941, 200.20934253947772, 764.5162422602721, 119.13819738367297, 139.0353331757735, 356.5898064220895, 465.2244909192483, 113.09999999999832, 325.99693699981106, 235.26773575865602, 545.8581787190421, 95.7142582948116, 137.70387273425536, 895.4654614804358, 36.462554695479376, 343.185749208044, 508.5707271129136, 404.295670784343, 551.69742315992, 27.956295965565772, 154.1863184189161, 163.5999999999983, 320.2348762929094, 342.89999999999975, 489.72647284829344, 268.36565214867596, 304.69820643323715, 273.90692914085776, 248.64798881221415, 571.5563744256494, 330.22734255036545, 524.7928255262698, 576.3765660413966, 473.0946659648886, 1037.0891728079964, 408.37608781817005, 309.16399881421916, 345.66959704065584, 97.49076240534404, 140.8999999999987, 537.33713126379, 638.0176427435296, 88.86507628305328, 123.74935274302095, 28.199999999999996, 362.22407526317033, 224.22241840080451, 169.86236055394116, 127.30464875794468, 187.90051881510013, 432.0066820496863, 317.25956873535176, 353.7426311152281, 167.0350293448649, 3.500000000000001, 593.9005222838896, 301.21902990234327, 252.90964480934738, 444.35655350307155, 131.99240750360403, 360.59999999999997, 15.590472718244907, 879.8218558705768, 360.1131678972831, 368.20000000000005, 1146.3059610058763, 1130.7094817298118, 559.1687639015901, 584.6422369140741, 370.32608973973515, 362.5999999999998, 122.67743594337443, 290.83444330151735, 120.29078504444715, 301.27522397016423, 358.90000000000117, 422.9275756006995, 493.3800891301913, 228.00043602038963, 44.41380699723433, 676.5611956045944, 292.07495166138824, 505.44885216877935, 219.78548364630151, 465.6587854889764, 449.06301133147986, 150.24869460343243, 400.91958181290624, 171.86167186427858, 516.9118288836581, 147.09999999999997, 597.0940633161829, 956.6411084845145, 177.24171544485236, 255.3880359972231, 382.18095655514514, 39.925905594066705, 257.82093823654395, 88.88952430354584, 378.30000000000194], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-511.4865041319148, -188.6187867486509, -485.15763462711413, -152.5998181421995, 257.1411721188225, -652.7041871378774, -440.0905615735552, -288.20106141443904, -862.1627265089296, -447.4933607955173, -21.54832141604144, -896.730992429183, -154.04757502848065, -680.1302119363764, -285.503273875231, -403.34710571849143, -362.33804222350005, -527.0156218543946, -641.3760505908333, -636.5331885833233, -754.4186371404458, -207.95839342109326, 27.941715887210208, -686.4733329524321, -967.8614129420855, -417.2647153680299, -1104.854648423156, 295.27716025068446, -979.3922168853923, -155.76722023076258, -90.30848215650589, -631.4385776481996, 136.28147119455508, -907.256902089862, -511.31563771709887, -473.9608826375601, -1325.2679983734067, 169.8949849901998, -734.0926707361281, -598.2917606572479, -610.3019377932865, -334.7907290630897, -296.7601590524009, -213.05040865981863, 38.18261387897191, -99.4701492825618, 153.65161697019923, -353.33957457517226, 128.5572928793153, -531.9866834846621, -402.94629291018424, -340.62822452090444, -939.7283493954218, -358.0839895575191, -95.55056725450561, -1126.6954898595593, -187.39096912130591, -320.38895595917694, -841.720306389685, 175.31738079286308, 39.15852093749544, -582.2864119344199, -83.24566175848216, 59.15252146579515, 113.94345459448897, -808.288265657002, -623.0276481786606, -43.90602907928994, 336.78307564773803, -1002.7949372459424, 303.3928816018755, -719.5471644463468, -633.5891315906583, -472.0733656771164, -725.3339414568088, 241.91936447892166, -352.86552652558197, -612.4172314667244, -435.8826875869785, -215.3991912952584, -556.0620645329129, 181.59636785096546, 306.2896048420431, -763.2057425549826, -667.4123141377521, -758.9556494453157, -15.564519547359852, -434.8282690389832, -941.6042654690393, -561.0699660412165, -174.52989208914056, -672.1425900683105, -361.66342308323055, -135.18274800099914, -384.0597186195523, -475.26975574843107, -634.5378355052297, -539.1754247407173, -511.3228785232241, -249.50213514332344, 379.5865922494585, -534.6161791666436, -153.86656739254875, -37.80032260889199, -106.99129945144283, -342.38618882333714, -151.00921321616232, 37.093451574175795, -873.0375517159218, -939.0906286100242, 319.36361289074034, -1063.622258766889, -593.4659492733867, -116.78495953485888, -1.8272024693713087, 111.36360107873087, -284.76840686060916, 383.9569426439564, -549.9582501136202, -609.2190975599984, -677.7660404466266, 167.5017742375119, -79.66336704596459, -119.66616479727172, 215.87600258234113, -1014.8189174589404, -1018.2621234015404, -452.35627645542274, -28.372243983255203, -103.5503205444054, -1384.4607208114335, 246.01621723628568, -1179.283815045673, 347.8002588555509, -1314.578528941797, 252.71894081658004, -600.0693491505017, -458.63988946101216, -896.9059552243975, 263.14467377379657, -712.6248315525404, 319.6377072314882, -978.4129843577368, -640.8097219819803, -1179.1350827453575, -339.5966378112449, -418.2846728649918, -691.8199148517775, -159.25864426664714, -600.0666120458678, 28.46768559198975, 252.41332648731859, -222.16420979997037, -615.7762925744075, -969.8844821610119, -125.16162445097743, -182.1486824559845, -43.52452679814177, -752.659240793018, -1010.5292949599582, 135.57042126185183, -456.35225868113673, -590.1285447429473, -739.1333677256528, 50.52097828884882, 65.10773333930257, -89.14598159454373, -815.1802018420252, -629.0718499031801, -240.27426044440824, 328.3204833054597, -671.2215804723705, -978.3231957933485, -270.74995499126317, -747.4032924608102, 392.79999999999995, -588.3823326042539, -267.9984556645919, -300.79260951848755, -1067.394805866823, -693.882426450675, -186.71614311962497, 21.670353378065343, 263.1276904945091, 339.5462179164227, -884.7347469536035, -382.569419553019, -541.0667447392948, -609.6848683990146, -440.85025756635446, -115.4984470754681, -712.7999451471163, -171.69363456891136, -910.7670142382716, -85.01673109857512, -90.00327357739113, -931.3617280002403, -212.60589784148718, -138.80503132460296, 339.6564989221631], "policy_predator_policy_reward": [521.806629445842, 506.5029519594212, 311.52327194897464, 526.4435233598175, 518.428094713089, 641.6511625662387, 488.55752710739904, 358.87229326427604, 830.1024613704368, 618.5889591097872, 719.7796341917896, 555.0894860755197, 740.8849415388718, 558.5173363452388, 350.9497400629833, 451.00063953074545, 738.3466327051805, 477.0039683725295, 983.9141067396157, 529.2628681932034, 549.8115170877608, 958.42369219282, 188.92412459720853, 565.3217507628254, 824.8642375996102, 697.9657634447623, 772.147206049513, 932.8957436033965, 985.3547715808727, 186.26722023076087, 561.4403447664414, 503.4924642463074, 418.4372368963372, 861.1089211118833, 895.1368404125773, 494.43535072642527, 1121.12923820557, 585.9411983375611, 726.6656260470836, 633.6751013118599, 822.8687897614091, 276.4101955138838, 345.4838893361992, 327.9266783760258, 135.86036632820384, 245.66204536829707, 99.84838302980037, 442.73957457517236, 215.7902435713943, 677.3656198822439, 551.8771767938435, 460.06299278592246, 807.6484876021259, 794.8620577840517, 377.07803993674395, 1119.0749463181792, 305.9262798083381, 450.5016340843587, 496.7126820889999, 741.2466179334722, 194.16882161286992, 679.1864119344206, 345.69678045494095, 203.18918536401537, 559.4675591417001, 711.2538179622127, 628.7570520932344, 511.2712911296057, 909.0017645892297, 794.099269816972, 160.8083708140773, 663.721999848565, 825.628530876768, 589.1979652052299, 754.4503182424683, 74.63385577607504, 813.9955113959388, 248.77800900171354, 541.9826875869808, 250.19919129525687, 662.5030869483228, 249.29974099741517, 549.2962195238231, 545.637560932645, 687.509794155476, 827.7232457106459, 43.7138722903832, 530.4282690389831, 957.8042654690396, 573.069966041219, 728.4434792544132, 480.45307816620794, 380.663011630453, 340.40557785458753, 510.45971861955377, 518.7321163023732, 600.0786871248915, 700.9392218790018, 764.3936617198694, 184.33187076178368, 23.72008980022777, 563.3161791666447, 38.50255318649423, 470.42390555029823, 335.193453260614, 467.9266661293968, 280.1092132161619, 0.8415777706911136, 874.8375517159222, 940.7906286100246, 406.9575310668084, 931.2016370932287, 534.8634286433592, 476.6065100672307, 60.03632695195433, 83.33691924803502, 322.16840686061505, 22.999610859111844, 1061.6644887823295, 229.5052663948987, 256.09666408397743, 614.767602125137, 213.31817966727334, 1.6018248942074795, 882.1417186423421, 796.6230521048332, 900.2401243516932, 930.4914434025543, 231.97224398325494, 268.1503205444061, 1206.5202166747183, 1078.2302479063037, 1039.9786112718114, 922.2144266481206, 1113.841391637488, 507.1869603893148, 675.8271811802196, 967.5242943453677, 888.9248418850381, 115.16252930529797, 716.8248315525412, 38.762292768511784, 984.3930570651561, 757.5070852179443, 805.9288454940556, 1003.6373183640699, 428.7498192959285, 801.6455534652887, 490.2887494479426, 570.3117308347389, 10.332314408010369, 67.68667351268124, 666.389049603227, 594.4790283718538, 616.107066086745, 972.3191296554265, 373.94911847637604, 79.72452679814118, 796.0730477902529, 1011.5292949599582, 380.06815093526643, 617.2748820886117, 894.7442239083546, 726.5926402216344, 210.129223294175, 179.69091724645256, 299.5314652408457, 824.5802018420263, 746.5073286200992, 588.49756721646, 523.3422844313766, 268.62182406701487, 981.4231957933492, 417.89864959469725, 751.6032924608111, 3.919581812906474, 752.6715325375922, 275.5709275955384, 1051.1500692332395, 833.9491750357282, 697.3824264506748, 330.31614311962625, 250.82964662193444, 61.46637282167377, 746.7487856415, 755.0808518801965, 546.9694195530195, 553.9084601841506, 709.5454324821713, 596.3777294804219, 578.6306415766345, 631.8487072010951, 776.5206923037689, 345.8658620974787, 133.57418302170385, 299.2667598908059, 586.6633966673716, 646.1937534779036, 174.66840593979447, 2.7801264626438043]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.464818056433449, "mean_inference_ms": 3.2484062553447672, "mean_action_processing_ms": 1.1770954369132394, "mean_env_wait_ms": 9.977061307913498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003915071487426758, "StateBufferConnector_ms": 0.004891514778137207, "ViewRequirementAgentConnector_ms": 0.12544000148773193}, "num_episodes": 13, "episode_return_max": 1146.3059610058763, "episode_return_min": 3.500000000000001, "episode_return_mean": 351.1069583048338, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.64934617730759, "num_env_steps_trained_throughput_per_sec": 82.64934617730759, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 57004.08, "restore_workers_time_ms": 0.014, "training_step_time_ms": 57004.029, "sample_time_ms": 2118.867, "learn_time_ms": 54867.3, "learn_throughput": 72.903, "synch_weights_time_ms": 15.814}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "fed12_00000", "date": "2024-08-21_19-02-04", "timestamp": 1724247124, "time_this_iter_s": 48.44195079803467, "time_total_s": 3447.8166177272797, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4ce0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3447.8166177272797, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 26.55, "ram_util_percent": 83.00147058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.24344304755882, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.51291910353161, "policy_loss": -0.02197028734011664, "vf_loss": 6.531444201393733, "vf_explained_var": 0.6648743866297303, "kl": 0.01722599178966549, "entropy": 0.6884006942706133, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.250244854493115, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.279098712578022, "policy_loss": -0.013831300701990368, "vf_loss": 6.290950209753854, "vf_explained_var": 0.4322056229783114, "kl": 0.009898985824892643, "entropy": 0.44964605369580485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 1146.3059610058763, "episode_reward_min": 3.500000000000001, "episode_reward_mean": 352.16994662363453, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1384.4607208114335, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.79999999999995, "predator_policy": 1206.5202166747183}, "policy_reward_mean": {"prey_policy": -359.3949933385744, "predator_policy": 535.4799666503922}, "custom_metrics": {}, "hist_stats": {"episode_reward": [325.99693699981106, 235.26773575865602, 545.8581787190421, 95.7142582948116, 137.70387273425536, 895.4654614804358, 36.462554695479376, 343.185749208044, 508.5707271129136, 404.295670784343, 551.69742315992, 27.956295965565772, 154.1863184189161, 163.5999999999983, 320.2348762929094, 342.89999999999975, 489.72647284829344, 268.36565214867596, 304.69820643323715, 273.90692914085776, 248.64798881221415, 571.5563744256494, 330.22734255036545, 524.7928255262698, 576.3765660413966, 473.0946659648886, 1037.0891728079964, 408.37608781817005, 309.16399881421916, 345.66959704065584, 97.49076240534404, 140.8999999999987, 537.33713126379, 638.0176427435296, 88.86507628305328, 123.74935274302095, 28.199999999999996, 362.22407526317033, 224.22241840080451, 169.86236055394116, 127.30464875794468, 187.90051881510013, 432.0066820496863, 317.25956873535176, 353.7426311152281, 167.0350293448649, 3.500000000000001, 593.9005222838896, 301.21902990234327, 252.90964480934738, 444.35655350307155, 131.99240750360403, 360.59999999999997, 15.590472718244907, 879.8218558705768, 360.1131678972831, 368.20000000000005, 1146.3059610058763, 1130.7094817298118, 559.1687639015901, 584.6422369140741, 370.32608973973515, 362.5999999999998, 122.67743594337443, 290.83444330151735, 120.29078504444715, 301.27522397016423, 358.90000000000117, 422.9275756006995, 493.3800891301913, 228.00043602038963, 44.41380699723433, 676.5611956045944, 292.07495166138824, 505.44885216877935, 219.78548364630151, 465.6587854889764, 449.06301133147986, 150.24869460343243, 400.91958181290624, 171.86167186427858, 516.9118288836581, 147.09999999999997, 597.0940633161829, 956.6411084845145, 177.24171544485236, 255.3880359972231, 382.18095655514514, 39.925905594066705, 257.82093823654395, 88.88952430354584, 378.30000000000194, 204.52864570909844, 97.834150512266, 432.2471343192074, 415.2000000000025, 496.30660456471185, 380.4999999999998, 391.40000000000185, 174.29999999999967], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-362.33804222350005, -527.0156218543946, -641.3760505908333, -636.5331885833233, -754.4186371404458, -207.95839342109326, 27.941715887210208, -686.4733329524321, -967.8614129420855, -417.2647153680299, -1104.854648423156, 295.27716025068446, -979.3922168853923, -155.76722023076258, -90.30848215650589, -631.4385776481996, 136.28147119455508, -907.256902089862, -511.31563771709887, -473.9608826375601, -1325.2679983734067, 169.8949849901998, -734.0926707361281, -598.2917606572479, -610.3019377932865, -334.7907290630897, -296.7601590524009, -213.05040865981863, 38.18261387897191, -99.4701492825618, 153.65161697019923, -353.33957457517226, 128.5572928793153, -531.9866834846621, -402.94629291018424, -340.62822452090444, -939.7283493954218, -358.0839895575191, -95.55056725450561, -1126.6954898595593, -187.39096912130591, -320.38895595917694, -841.720306389685, 175.31738079286308, 39.15852093749544, -582.2864119344199, -83.24566175848216, 59.15252146579515, 113.94345459448897, -808.288265657002, -623.0276481786606, -43.90602907928994, 336.78307564773803, -1002.7949372459424, 303.3928816018755, -719.5471644463468, -633.5891315906583, -472.0733656771164, -725.3339414568088, 241.91936447892166, -352.86552652558197, -612.4172314667244, -435.8826875869785, -215.3991912952584, -556.0620645329129, 181.59636785096546, 306.2896048420431, -763.2057425549826, -667.4123141377521, -758.9556494453157, -15.564519547359852, -434.8282690389832, -941.6042654690393, -561.0699660412165, -174.52989208914056, -672.1425900683105, -361.66342308323055, -135.18274800099914, -384.0597186195523, -475.26975574843107, -634.5378355052297, -539.1754247407173, -511.3228785232241, -249.50213514332344, 379.5865922494585, -534.6161791666436, -153.86656739254875, -37.80032260889199, -106.99129945144283, -342.38618882333714, -151.00921321616232, 37.093451574175795, -873.0375517159218, -939.0906286100242, 319.36361289074034, -1063.622258766889, -593.4659492733867, -116.78495953485888, -1.8272024693713087, 111.36360107873087, -284.76840686060916, 383.9569426439564, -549.9582501136202, -609.2190975599984, -677.7660404466266, 167.5017742375119, -79.66336704596459, -119.66616479727172, 215.87600258234113, -1014.8189174589404, -1018.2621234015404, -452.35627645542274, -28.372243983255203, -103.5503205444054, -1384.4607208114335, 246.01621723628568, -1179.283815045673, 347.8002588555509, -1314.578528941797, 252.71894081658004, -600.0693491505017, -458.63988946101216, -896.9059552243975, 263.14467377379657, -712.6248315525404, 319.6377072314882, -978.4129843577368, -640.8097219819803, -1179.1350827453575, -339.5966378112449, -418.2846728649918, -691.8199148517775, -159.25864426664714, -600.0666120458678, 28.46768559198975, 252.41332648731859, -222.16420979997037, -615.7762925744075, -969.8844821610119, -125.16162445097743, -182.1486824559845, -43.52452679814177, -752.659240793018, -1010.5292949599582, 135.57042126185183, -456.35225868113673, -590.1285447429473, -739.1333677256528, 50.52097828884882, 65.10773333930257, -89.14598159454373, -815.1802018420252, -629.0718499031801, -240.27426044440824, 328.3204833054597, -671.2215804723705, -978.3231957933485, -270.74995499126317, -747.4032924608102, 392.79999999999995, -588.3823326042539, -267.9984556645919, -300.79260951848755, -1067.394805866823, -693.882426450675, -186.71614311962497, 21.670353378065343, 263.1276904945091, 339.5462179164227, -884.7347469536035, -382.569419553019, -541.0667447392948, -609.6848683990146, -440.85025756635446, -115.4984470754681, -712.7999451471163, -171.69363456891136, -910.7670142382716, -85.01673109857512, -90.00327357739113, -931.3617280002403, -212.60589784148718, -138.80503132460296, 339.6564989221631, -698.6954048220564, -97.08396099981715, -426.2413265781852, -352.4863098099044, -465.5619040696645, 308.4265251339474, 248.33618865267556, -134.64233284936913, -331.9816403867049, -948.3286438789439, 250.3125929285158, -409.9741504748157, -40.04469940480317, 357.7, -174.46725147789942, -131.7977296349842], "policy_predator_policy_reward": [738.3466327051805, 477.0039683725295, 983.9141067396157, 529.2628681932034, 549.8115170877608, 958.42369219282, 188.92412459720853, 565.3217507628254, 824.8642375996102, 697.9657634447623, 772.147206049513, 932.8957436033965, 985.3547715808727, 186.26722023076087, 561.4403447664414, 503.4924642463074, 418.4372368963372, 861.1089211118833, 895.1368404125773, 494.43535072642527, 1121.12923820557, 585.9411983375611, 726.6656260470836, 633.6751013118599, 822.8687897614091, 276.4101955138838, 345.4838893361992, 327.9266783760258, 135.86036632820384, 245.66204536829707, 99.84838302980037, 442.73957457517236, 215.7902435713943, 677.3656198822439, 551.8771767938435, 460.06299278592246, 807.6484876021259, 794.8620577840517, 377.07803993674395, 1119.0749463181792, 305.9262798083381, 450.5016340843587, 496.7126820889999, 741.2466179334722, 194.16882161286992, 679.1864119344206, 345.69678045494095, 203.18918536401537, 559.4675591417001, 711.2538179622127, 628.7570520932344, 511.2712911296057, 909.0017645892297, 794.099269816972, 160.8083708140773, 663.721999848565, 825.628530876768, 589.1979652052299, 754.4503182424683, 74.63385577607504, 813.9955113959388, 248.77800900171354, 541.9826875869808, 250.19919129525687, 662.5030869483228, 249.29974099741517, 549.2962195238231, 545.637560932645, 687.509794155476, 827.7232457106459, 43.7138722903832, 530.4282690389831, 957.8042654690396, 573.069966041219, 728.4434792544132, 480.45307816620794, 380.663011630453, 340.40557785458753, 510.45971861955377, 518.7321163023732, 600.0786871248915, 700.9392218790018, 764.3936617198694, 184.33187076178368, 23.72008980022777, 563.3161791666447, 38.50255318649423, 470.42390555029823, 335.193453260614, 467.9266661293968, 280.1092132161619, 0.8415777706911136, 874.8375517159222, 940.7906286100246, 406.9575310668084, 931.2016370932287, 534.8634286433592, 476.6065100672307, 60.03632695195433, 83.33691924803502, 322.16840686061505, 22.999610859111844, 1061.6644887823295, 229.5052663948987, 256.09666408397743, 614.767602125137, 213.31817966727334, 1.6018248942074795, 882.1417186423421, 796.6230521048332, 900.2401243516932, 930.4914434025543, 231.97224398325494, 268.1503205444061, 1206.5202166747183, 1078.2302479063037, 1039.9786112718114, 922.2144266481206, 1113.841391637488, 507.1869603893148, 675.8271811802196, 967.5242943453677, 888.9248418850381, 115.16252930529797, 716.8248315525412, 38.762292768511784, 984.3930570651561, 757.5070852179443, 805.9288454940556, 1003.6373183640699, 428.7498192959285, 801.6455534652887, 490.2887494479426, 570.3117308347389, 10.332314408010369, 67.68667351268124, 666.389049603227, 594.4790283718538, 616.107066086745, 972.3191296554265, 373.94911847637604, 79.72452679814118, 796.0730477902529, 1011.5292949599582, 380.06815093526643, 617.2748820886117, 894.7442239083546, 726.5926402216344, 210.129223294175, 179.69091724645256, 299.5314652408457, 824.5802018420263, 746.5073286200992, 588.49756721646, 523.3422844313766, 268.62182406701487, 981.4231957933492, 417.89864959469725, 751.6032924608111, 3.919581812906474, 752.6715325375922, 275.5709275955384, 1051.1500692332395, 833.9491750357282, 697.3824264506748, 330.31614311962625, 250.82964662193444, 61.46637282167377, 746.7487856415, 755.0808518801965, 546.9694195530195, 553.9084601841506, 709.5454324821713, 596.3777294804219, 578.6306415766345, 631.8487072010951, 776.5206923037689, 345.8658620974787, 133.57418302170385, 299.2667598908059, 586.6633966673716, 646.1937534779036, 174.66840593979447, 2.7801264626438043, 608.2587594650282, 392.04925206594436, 448.4080903586827, 428.15369654167625, 393.9107032714397, 195.47180998348455, 92.26381134732442, 209.2423328493681, 896.4247566827182, 880.1921321476441, 112.15305811099854, 428.00849943530375, 73.74469940480341, 0.0, 321.56725147790013, 158.99772963498265]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4636454696201873, "mean_inference_ms": 3.2463764336587535, "mean_action_processing_ms": 1.179311612118262, "mean_env_wait_ms": 9.987372329629641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003974556922912598, "StateBufferConnector_ms": 0.004884243011474609, "ViewRequirementAgentConnector_ms": 0.12440896034240723}, "num_episodes": 8, "episode_return_max": 1146.3059610058763, "episode_return_min": 3.500000000000001, "episode_return_mean": 352.16994662363453, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.11487166147228, "num_env_steps_trained_throughput_per_sec": 82.11487166147228, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 57039.923, "restore_workers_time_ms": 0.014, "training_step_time_ms": 57039.872, "sample_time_ms": 2125.308, "learn_time_ms": 54896.629, "learn_throughput": 72.864, "synch_weights_time_ms": 15.883}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "fed12_00000", "date": "2024-08-21_19-02-52", "timestamp": 1724247172, "time_this_iter_s": 48.72936201095581, "time_total_s": 3496.5459797382355, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f723550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3496.5459797382355, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 24.99855072463768, "ram_util_percent": 82.8231884057971}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.916009286471777, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.667628313246228, "policy_loss": -0.015211140136628673, "vf_loss": 6.680033421137976, "vf_explained_var": 0.6339212303754513, "kl": 0.014030162321906242, "entropy": 0.6020161009812481, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.830705940534198, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.7471187715177185, "policy_loss": -0.017111323363512322, "vf_loss": 6.761430973476834, "vf_explained_var": 0.33377229754256194, "kl": 0.013995634819991965, "entropy": 0.43389841081604125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 1146.3059610058763, "episode_reward_min": 3.500000000000001, "episode_reward_mean": 369.5494896810805, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1384.4607208114335, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.79999999999995, "predator_policy": 1206.5202166747183}, "policy_reward_mean": {"prey_policy": -336.89055810248783, "predator_policy": 521.6653029430283}, "custom_metrics": {}, "hist_stats": {"episode_reward": [320.2348762929094, 342.89999999999975, 489.72647284829344, 268.36565214867596, 304.69820643323715, 273.90692914085776, 248.64798881221415, 571.5563744256494, 330.22734255036545, 524.7928255262698, 576.3765660413966, 473.0946659648886, 1037.0891728079964, 408.37608781817005, 309.16399881421916, 345.66959704065584, 97.49076240534404, 140.8999999999987, 537.33713126379, 638.0176427435296, 88.86507628305328, 123.74935274302095, 28.199999999999996, 362.22407526317033, 224.22241840080451, 169.86236055394116, 127.30464875794468, 187.90051881510013, 432.0066820496863, 317.25956873535176, 353.7426311152281, 167.0350293448649, 3.500000000000001, 593.9005222838896, 301.21902990234327, 252.90964480934738, 444.35655350307155, 131.99240750360403, 360.59999999999997, 15.590472718244907, 879.8218558705768, 360.1131678972831, 368.20000000000005, 1146.3059610058763, 1130.7094817298118, 559.1687639015901, 584.6422369140741, 370.32608973973515, 362.5999999999998, 122.67743594337443, 290.83444330151735, 120.29078504444715, 301.27522397016423, 358.90000000000117, 422.9275756006995, 493.3800891301913, 228.00043602038963, 44.41380699723433, 676.5611956045944, 292.07495166138824, 505.44885216877935, 219.78548364630151, 465.6587854889764, 449.06301133147986, 150.24869460343243, 400.91958181290624, 171.86167186427858, 516.9118288836581, 147.09999999999997, 597.0940633161829, 956.6411084845145, 177.24171544485236, 255.3880359972231, 382.18095655514514, 39.925905594066705, 257.82093823654395, 88.88952430354584, 378.30000000000194, 204.52864570909844, 97.834150512266, 432.2471343192074, 415.2000000000025, 496.30660456471185, 380.4999999999998, 391.40000000000185, 174.29999999999967, 496.9492125805924, 543.2506835499503, 206.8108973084969, 711.0657613753516, 574.3431129991429, 373.74305179519075, 166.51908731678918, 653.2000000000003, 771.1526731136177, 697.0354294432549, 112.55484002812071, 51.89058896848671, 225.80884465909094, 579.5913059387078], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [38.18261387897191, -99.4701492825618, 153.65161697019923, -353.33957457517226, 128.5572928793153, -531.9866834846621, -402.94629291018424, -340.62822452090444, -939.7283493954218, -358.0839895575191, -95.55056725450561, -1126.6954898595593, -187.39096912130591, -320.38895595917694, -841.720306389685, 175.31738079286308, 39.15852093749544, -582.2864119344199, -83.24566175848216, 59.15252146579515, 113.94345459448897, -808.288265657002, -623.0276481786606, -43.90602907928994, 336.78307564773803, -1002.7949372459424, 303.3928816018755, -719.5471644463468, -633.5891315906583, -472.0733656771164, -725.3339414568088, 241.91936447892166, -352.86552652558197, -612.4172314667244, -435.8826875869785, -215.3991912952584, -556.0620645329129, 181.59636785096546, 306.2896048420431, -763.2057425549826, -667.4123141377521, -758.9556494453157, -15.564519547359852, -434.8282690389832, -941.6042654690393, -561.0699660412165, -174.52989208914056, -672.1425900683105, -361.66342308323055, -135.18274800099914, -384.0597186195523, -475.26975574843107, -634.5378355052297, -539.1754247407173, -511.3228785232241, -249.50213514332344, 379.5865922494585, -534.6161791666436, -153.86656739254875, -37.80032260889199, -106.99129945144283, -342.38618882333714, -151.00921321616232, 37.093451574175795, -873.0375517159218, -939.0906286100242, 319.36361289074034, -1063.622258766889, -593.4659492733867, -116.78495953485888, -1.8272024693713087, 111.36360107873087, -284.76840686060916, 383.9569426439564, -549.9582501136202, -609.2190975599984, -677.7660404466266, 167.5017742375119, -79.66336704596459, -119.66616479727172, 215.87600258234113, -1014.8189174589404, -1018.2621234015404, -452.35627645542274, -28.372243983255203, -103.5503205444054, -1384.4607208114335, 246.01621723628568, -1179.283815045673, 347.8002588555509, -1314.578528941797, 252.71894081658004, -600.0693491505017, -458.63988946101216, -896.9059552243975, 263.14467377379657, -712.6248315525404, 319.6377072314882, -978.4129843577368, -640.8097219819803, -1179.1350827453575, -339.5966378112449, -418.2846728649918, -691.8199148517775, -159.25864426664714, -600.0666120458678, 28.46768559198975, 252.41332648731859, -222.16420979997037, -615.7762925744075, -969.8844821610119, -125.16162445097743, -182.1486824559845, -43.52452679814177, -752.659240793018, -1010.5292949599582, 135.57042126185183, -456.35225868113673, -590.1285447429473, -739.1333677256528, 50.52097828884882, 65.10773333930257, -89.14598159454373, -815.1802018420252, -629.0718499031801, -240.27426044440824, 328.3204833054597, -671.2215804723705, -978.3231957933485, -270.74995499126317, -747.4032924608102, 392.79999999999995, -588.3823326042539, -267.9984556645919, -300.79260951848755, -1067.394805866823, -693.882426450675, -186.71614311962497, 21.670353378065343, 263.1276904945091, 339.5462179164227, -884.7347469536035, -382.569419553019, -541.0667447392948, -609.6848683990146, -440.85025756635446, -115.4984470754681, -712.7999451471163, -171.69363456891136, -910.7670142382716, -85.01673109857512, -90.00327357739113, -931.3617280002403, -212.60589784148718, -138.80503132460296, 339.6564989221631, -698.6954048220564, -97.08396099981715, -426.2413265781852, -352.4863098099044, -465.5619040696645, 308.4265251339474, 248.33618865267556, -134.64233284936913, -331.9816403867049, -948.3286438789439, 250.3125929285158, -409.9741504748157, -40.04469940480317, 357.7, -174.46725147789942, -131.7977296349842, -624.7173317274811, 202.13483636928498, 236.65311285377965, -54.38305177759605, -375.4780759155865, -924.2212974442552, -979.1484430796881, 278.84637124354396, -26.804365460158998, -751.4148821743281, -128.74450291529402, -833.203970618893, 97.49018264350332, -528.5487343614924, 354.5717207385407, 35.93700155897028, -880.7760962163012, 312.35459472837965, -527.3734790706548, -32.89504736773376, -574.1405836476835, -340.8291681885059, -736.020690825991, -172.45016944536604, -768.0113336649184, -47.41307272906446, -808.0886178514148, -441.1321533136728], "policy_predator_policy_reward": [135.86036632820384, 245.66204536829707, 99.84838302980037, 442.73957457517236, 215.7902435713943, 677.3656198822439, 551.8771767938435, 460.06299278592246, 807.6484876021259, 794.8620577840517, 377.07803993674395, 1119.0749463181792, 305.9262798083381, 450.5016340843587, 496.7126820889999, 741.2466179334722, 194.16882161286992, 679.1864119344206, 345.69678045494095, 203.18918536401537, 559.4675591417001, 711.2538179622127, 628.7570520932344, 511.2712911296057, 909.0017645892297, 794.099269816972, 160.8083708140773, 663.721999848565, 825.628530876768, 589.1979652052299, 754.4503182424683, 74.63385577607504, 813.9955113959388, 248.77800900171354, 541.9826875869808, 250.19919129525687, 662.5030869483228, 249.29974099741517, 549.2962195238231, 545.637560932645, 687.509794155476, 827.7232457106459, 43.7138722903832, 530.4282690389831, 957.8042654690396, 573.069966041219, 728.4434792544132, 480.45307816620794, 380.663011630453, 340.40557785458753, 510.45971861955377, 518.7321163023732, 600.0786871248915, 700.9392218790018, 764.3936617198694, 184.33187076178368, 23.72008980022777, 563.3161791666447, 38.50255318649423, 470.42390555029823, 335.193453260614, 467.9266661293968, 280.1092132161619, 0.8415777706911136, 874.8375517159222, 940.7906286100246, 406.9575310668084, 931.2016370932287, 534.8634286433592, 476.6065100672307, 60.03632695195433, 83.33691924803502, 322.16840686061505, 22.999610859111844, 1061.6644887823295, 229.5052663948987, 256.09666408397743, 614.767602125137, 213.31817966727334, 1.6018248942074795, 882.1417186423421, 796.6230521048332, 900.2401243516932, 930.4914434025543, 231.97224398325494, 268.1503205444061, 1206.5202166747183, 1078.2302479063037, 1039.9786112718114, 922.2144266481206, 1113.841391637488, 507.1869603893148, 675.8271811802196, 967.5242943453677, 888.9248418850381, 115.16252930529797, 716.8248315525412, 38.762292768511784, 984.3930570651561, 757.5070852179443, 805.9288454940556, 1003.6373183640699, 428.7498192959285, 801.6455534652887, 490.2887494479426, 570.3117308347389, 10.332314408010369, 67.68667351268124, 666.389049603227, 594.4790283718538, 616.107066086745, 972.3191296554265, 373.94911847637604, 79.72452679814118, 796.0730477902529, 1011.5292949599582, 380.06815093526643, 617.2748820886117, 894.7442239083546, 726.5926402216344, 210.129223294175, 179.69091724645256, 299.5314652408457, 824.5802018420263, 746.5073286200992, 588.49756721646, 523.3422844313766, 268.62182406701487, 981.4231957933492, 417.89864959469725, 751.6032924608111, 3.919581812906474, 752.6715325375922, 275.5709275955384, 1051.1500692332395, 833.9491750357282, 697.3824264506748, 330.31614311962625, 250.82964662193444, 61.46637282167377, 746.7487856415, 755.0808518801965, 546.9694195530195, 553.9084601841506, 709.5454324821713, 596.3777294804219, 578.6306415766345, 631.8487072010951, 776.5206923037689, 345.8658620974787, 133.57418302170385, 299.2667598908059, 586.6633966673716, 646.1937534779036, 174.66840593979447, 2.7801264626438043, 608.2587594650282, 392.04925206594436, 448.4080903586827, 428.15369654167625, 393.9107032714397, 195.47180998348455, 92.26381134732442, 209.2423328493681, 896.4247566827182, 880.1921321476441, 112.15305811099854, 428.00849943530375, 73.74469940480341, 0.0, 321.56725147790013, 158.99772963498265, 347.07527071326643, 572.4564372255224, 142.58476712118951, 218.3958553525772, 571.659151465722, 934.8511192026161, 934.3315829817282, 477.0362502297646, 675.7133575132818, 676.849003120345, 498.25263008633283, 837.4388952430423, 18.06598690275278, 579.5116521320268, 0.0, 262.6912777024892, 788.5692686828634, 551.0049059186738, 804.5493739074919, 452.7545819741513, 932.5160488808481, 95.0085429834686, 733.7478825370447, 226.6135667027974, 771.46054192557, 269.7727091275054, 849.6201305546346, 979.19194654916]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4648378540714613, "mean_inference_ms": 3.2445908598591178, "mean_action_processing_ms": 1.1698416449158002, "mean_env_wait_ms": 9.976347849053802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004018902778625488, "StateBufferConnector_ms": 0.004948019981384277, "ViewRequirementAgentConnector_ms": 0.12614738941192627}, "num_episodes": 14, "episode_return_max": 1146.3059610058763, "episode_return_min": 3.500000000000001, "episode_return_mean": 369.5494896810805, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.43541672367, "num_env_steps_trained_throughput_per_sec": 81.43541672367, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 57135.765, "restore_workers_time_ms": 0.015, "training_step_time_ms": 57135.713, "sample_time_ms": 2115.296, "learn_time_ms": 55002.413, "learn_throughput": 72.724, "synch_weights_time_ms": 15.703}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "fed12_00000", "date": "2024-08-21_19-03-42", "timestamp": 1724247222, "time_this_iter_s": 49.155152797698975, "time_total_s": 3545.7011325359344, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f73aee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3545.7011325359344, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 29.757971014492757, "ram_util_percent": 83.1840579710145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.39000028680872, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.908671685879823, "policy_loss": -0.017960029731075914, "vf_loss": 6.9239423247241465, "vf_explained_var": 0.5542634518688949, "kl": 0.013446964523828929, "entropy": 0.5802616519902749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 996.9475000000093}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.087645069758098, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.1299614929017565, "policy_loss": -0.015041990634472794, "vf_loss": 7.142482697269904, "vf_explained_var": 0.25739187077870446, "kl": 0.012603985133368975, "entropy": 0.4030607466029112, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 996.9475000000093}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 1146.3059610058763, "episode_reward_min": 3.500000000000001, "episode_reward_mean": 347.17357796725986, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1384.4607208114335, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.79999999999995, "predator_policy": 1206.5202166747183}, "policy_reward_mean": {"prey_policy": -351.8925237741524, "predator_policy": 525.4793127577826}, "custom_metrics": {}, "hist_stats": {"episode_reward": [309.16399881421916, 345.66959704065584, 97.49076240534404, 140.8999999999987, 537.33713126379, 638.0176427435296, 88.86507628305328, 123.74935274302095, 28.199999999999996, 362.22407526317033, 224.22241840080451, 169.86236055394116, 127.30464875794468, 187.90051881510013, 432.0066820496863, 317.25956873535176, 353.7426311152281, 167.0350293448649, 3.500000000000001, 593.9005222838896, 301.21902990234327, 252.90964480934738, 444.35655350307155, 131.99240750360403, 360.59999999999997, 15.590472718244907, 879.8218558705768, 360.1131678972831, 368.20000000000005, 1146.3059610058763, 1130.7094817298118, 559.1687639015901, 584.6422369140741, 370.32608973973515, 362.5999999999998, 122.67743594337443, 290.83444330151735, 120.29078504444715, 301.27522397016423, 358.90000000000117, 422.9275756006995, 493.3800891301913, 228.00043602038963, 44.41380699723433, 676.5611956045944, 292.07495166138824, 505.44885216877935, 219.78548364630151, 465.6587854889764, 449.06301133147986, 150.24869460343243, 400.91958181290624, 171.86167186427858, 516.9118288836581, 147.09999999999997, 597.0940633161829, 956.6411084845145, 177.24171544485236, 255.3880359972231, 382.18095655514514, 39.925905594066705, 257.82093823654395, 88.88952430354584, 378.30000000000194, 204.52864570909844, 97.834150512266, 432.2471343192074, 415.2000000000025, 496.30660456471185, 380.4999999999998, 391.40000000000185, 174.29999999999967, 496.9492125805924, 543.2506835499503, 206.8108973084969, 711.0657613753516, 574.3431129991429, 373.74305179519075, 166.51908731678918, 653.2000000000003, 771.1526731136177, 697.0354294432549, 112.55484002812071, 51.89058896848671, 225.80884465909094, 579.5913059387078, 549.8878845342377, 40.5823459768933, 438.3012712522346, 107.13624608130448, 78.11863480182612, 662.1666570814681, 319.6538580386293, 560.2676191008679, 294.43960630205765, 412.5283869895025, 86.15105622276687, 207.78837514324863, 37.113483112399216, 138.26656479142454], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-633.5891315906583, -472.0733656771164, -725.3339414568088, 241.91936447892166, -352.86552652558197, -612.4172314667244, -435.8826875869785, -215.3991912952584, -556.0620645329129, 181.59636785096546, 306.2896048420431, -763.2057425549826, -667.4123141377521, -758.9556494453157, -15.564519547359852, -434.8282690389832, -941.6042654690393, -561.0699660412165, -174.52989208914056, -672.1425900683105, -361.66342308323055, -135.18274800099914, -384.0597186195523, -475.26975574843107, -634.5378355052297, -539.1754247407173, -511.3228785232241, -249.50213514332344, 379.5865922494585, -534.6161791666436, -153.86656739254875, -37.80032260889199, -106.99129945144283, -342.38618882333714, -151.00921321616232, 37.093451574175795, -873.0375517159218, -939.0906286100242, 319.36361289074034, -1063.622258766889, -593.4659492733867, -116.78495953485888, -1.8272024693713087, 111.36360107873087, -284.76840686060916, 383.9569426439564, -549.9582501136202, -609.2190975599984, -677.7660404466266, 167.5017742375119, -79.66336704596459, -119.66616479727172, 215.87600258234113, -1014.8189174589404, -1018.2621234015404, -452.35627645542274, -28.372243983255203, -103.5503205444054, -1384.4607208114335, 246.01621723628568, -1179.283815045673, 347.8002588555509, -1314.578528941797, 252.71894081658004, -600.0693491505017, -458.63988946101216, -896.9059552243975, 263.14467377379657, -712.6248315525404, 319.6377072314882, -978.4129843577368, -640.8097219819803, -1179.1350827453575, -339.5966378112449, -418.2846728649918, -691.8199148517775, -159.25864426664714, -600.0666120458678, 28.46768559198975, 252.41332648731859, -222.16420979997037, -615.7762925744075, -969.8844821610119, -125.16162445097743, -182.1486824559845, -43.52452679814177, -752.659240793018, -1010.5292949599582, 135.57042126185183, -456.35225868113673, -590.1285447429473, -739.1333677256528, 50.52097828884882, 65.10773333930257, -89.14598159454373, -815.1802018420252, -629.0718499031801, -240.27426044440824, 328.3204833054597, -671.2215804723705, -978.3231957933485, -270.74995499126317, -747.4032924608102, 392.79999999999995, -588.3823326042539, -267.9984556645919, -300.79260951848755, -1067.394805866823, -693.882426450675, -186.71614311962497, 21.670353378065343, 263.1276904945091, 339.5462179164227, -884.7347469536035, -382.569419553019, -541.0667447392948, -609.6848683990146, -440.85025756635446, -115.4984470754681, -712.7999451471163, -171.69363456891136, -910.7670142382716, -85.01673109857512, -90.00327357739113, -931.3617280002403, -212.60589784148718, -138.80503132460296, 339.6564989221631, -698.6954048220564, -97.08396099981715, -426.2413265781852, -352.4863098099044, -465.5619040696645, 308.4265251339474, 248.33618865267556, -134.64233284936913, -331.9816403867049, -948.3286438789439, 250.3125929285158, -409.9741504748157, -40.04469940480317, 357.7, -174.46725147789942, -131.7977296349842, -624.7173317274811, 202.13483636928498, 236.65311285377965, -54.38305177759605, -375.4780759155865, -924.2212974442552, -979.1484430796881, 278.84637124354396, -26.804365460158998, -751.4148821743281, -128.74450291529402, -833.203970618893, 97.49018264350332, -528.5487343614924, 354.5717207385407, 35.93700155897028, -880.7760962163012, 312.35459472837965, -527.3734790706548, -32.89504736773376, -574.1405836476835, -340.8291681885059, -736.020690825991, -172.45016944536604, -768.0113336649184, -47.41307272906446, -808.0886178514148, -441.1321533136728, 247.15139776921623, -923.203815142385, -441.6031575446546, -439.71155168984717, 35.69808446551906, -452.569523425257, -427.0237451025148, -34.796674941007225, -426.00519108163326, -472.2724813123435, -762.469481851704, 216.37317652042293, -635.5648749990901, -100.19926642873835, -365.05155571812145, -450.8623794163351, 201.8885924633365, -1097.5660070959152, -318.1590309862396, -75.89364106928048, -750.197655784472, -776.3181765427253, -1084.1363551117372, -587.7243432672993, -989.3885545217936, -0.7640017516061799, -50.76335444525571, -152.1458781635086], "policy_predator_policy_reward": [825.628530876768, 589.1979652052299, 754.4503182424683, 74.63385577607504, 813.9955113959388, 248.77800900171354, 541.9826875869808, 250.19919129525687, 662.5030869483228, 249.29974099741517, 549.2962195238231, 545.637560932645, 687.509794155476, 827.7232457106459, 43.7138722903832, 530.4282690389831, 957.8042654690396, 573.069966041219, 728.4434792544132, 480.45307816620794, 380.663011630453, 340.40557785458753, 510.45971861955377, 518.7321163023732, 600.0786871248915, 700.9392218790018, 764.3936617198694, 184.33187076178368, 23.72008980022777, 563.3161791666447, 38.50255318649423, 470.42390555029823, 335.193453260614, 467.9266661293968, 280.1092132161619, 0.8415777706911136, 874.8375517159222, 940.7906286100246, 406.9575310668084, 931.2016370932287, 534.8634286433592, 476.6065100672307, 60.03632695195433, 83.33691924803502, 322.16840686061505, 22.999610859111844, 1061.6644887823295, 229.5052663948987, 256.09666408397743, 614.767602125137, 213.31817966727334, 1.6018248942074795, 882.1417186423421, 796.6230521048332, 900.2401243516932, 930.4914434025543, 231.97224398325494, 268.1503205444061, 1206.5202166747183, 1078.2302479063037, 1039.9786112718114, 922.2144266481206, 1113.841391637488, 507.1869603893148, 675.8271811802196, 967.5242943453677, 888.9248418850381, 115.16252930529797, 716.8248315525412, 38.762292768511784, 984.3930570651561, 757.5070852179443, 805.9288454940556, 1003.6373183640699, 428.7498192959285, 801.6455534652887, 490.2887494479426, 570.3117308347389, 10.332314408010369, 67.68667351268124, 666.389049603227, 594.4790283718538, 616.107066086745, 972.3191296554265, 373.94911847637604, 79.72452679814118, 796.0730477902529, 1011.5292949599582, 380.06815093526643, 617.2748820886117, 894.7442239083546, 726.5926402216344, 210.129223294175, 179.69091724645256, 299.5314652408457, 824.5802018420263, 746.5073286200992, 588.49756721646, 523.3422844313766, 268.62182406701487, 981.4231957933492, 417.89864959469725, 751.6032924608111, 3.919581812906474, 752.6715325375922, 275.5709275955384, 1051.1500692332395, 833.9491750357282, 697.3824264506748, 330.31614311962625, 250.82964662193444, 61.46637282167377, 746.7487856415, 755.0808518801965, 546.9694195530195, 553.9084601841506, 709.5454324821713, 596.3777294804219, 578.6306415766345, 631.8487072010951, 776.5206923037689, 345.8658620974787, 133.57418302170385, 299.2667598908059, 586.6633966673716, 646.1937534779036, 174.66840593979447, 2.7801264626438043, 608.2587594650282, 392.04925206594436, 448.4080903586827, 428.15369654167625, 393.9107032714397, 195.47180998348455, 92.26381134732442, 209.2423328493681, 896.4247566827182, 880.1921321476441, 112.15305811099854, 428.00849943530375, 73.74469940480341, 0.0, 321.56725147790013, 158.99772963498265, 347.07527071326643, 572.4564372255224, 142.58476712118951, 218.3958553525772, 571.659151465722, 934.8511192026161, 934.3315829817282, 477.0362502297646, 675.7133575132818, 676.849003120345, 498.25263008633283, 837.4388952430423, 18.06598690275278, 579.5116521320268, 0.0, 262.6912777024892, 788.5692686828634, 551.0049059186738, 804.5493739074919, 452.7545819741513, 932.5160488808481, 95.0085429834686, 733.7478825370447, 226.6135667027974, 771.46054192557, 269.7727091275054, 849.6201305546346, 979.19194654916, 613.0133959147234, 612.9269059926812, 267.4748821127545, 654.4221730986457, 483.3699046047295, 371.80280560724253, 384.5556753909087, 184.40099073392167, 492.72382588346096, 483.6724813123445, 567.1144335680724, 641.1485288446731, 445.05835489384486, 610.3596445726072, 898.5889127039138, 477.59264153141083, 92.05101383872095, 1098.0660070959148, 77.97925326543266, 728.6018057795868, 929.4660520174687, 683.2008365324975, 1206.1364204272986, 673.5126530949866, 989.5885545217936, 37.67748486400538, 336.92658156684956, 4.2492158333402275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.465984606721068, "mean_inference_ms": 3.2508127201959014, "mean_action_processing_ms": 1.169629960485628, "mean_env_wait_ms": 9.986894601748737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039414167404174805, "StateBufferConnector_ms": 0.005232095718383789, "ViewRequirementAgentConnector_ms": 0.12382960319519043}, "num_episodes": 14, "episode_return_max": 1146.3059610058763, "episode_return_min": 3.500000000000001, "episode_return_mean": 347.17357796725986, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.24913214877088, "num_env_steps_trained_throughput_per_sec": 83.24913214877088, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 57129.525, "restore_workers_time_ms": 0.015, "training_step_time_ms": 57129.473, "sample_time_ms": 2077.211, "learn_time_ms": 55034.17, "learn_throughput": 72.682, "synch_weights_time_ms": 15.812}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "fed12_00000", "date": "2024-08-21_19-04-30", "timestamp": 1724247270, "time_this_iter_s": 48.079193115234375, "time_total_s": 3593.780325651169, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f723ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3593.780325651169, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 25.017647058823535, "ram_util_percent": 81.8926470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.029887789267082, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.835530709968042, "policy_loss": -0.017150672118268196, "vf_loss": 6.849932120842908, "vf_explained_var": 0.5584461346189812, "kl": 0.013746319518784288, "entropy": 0.5703597310989622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999885}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.062401321325353, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.170587582310672, "policy_loss": -0.017698310715855942, "vf_loss": 7.186048082069115, "vf_explained_var": 0.10116825904795733, "kl": 0.011189024902389893, "entropy": 0.37990512472611887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999885}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 1146.3059610058763, "episode_reward_min": 3.500000000000001, "episode_reward_mean": 348.22365064245355, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1384.4607208114335, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.79999999999995, "predator_policy": 1206.5202166747183}, "policy_reward_mean": {"prey_policy": -349.10552720893696, "predator_policy": 523.217352530164}, "custom_metrics": {}, "hist_stats": {"episode_reward": [362.22407526317033, 224.22241840080451, 169.86236055394116, 127.30464875794468, 187.90051881510013, 432.0066820496863, 317.25956873535176, 353.7426311152281, 167.0350293448649, 3.500000000000001, 593.9005222838896, 301.21902990234327, 252.90964480934738, 444.35655350307155, 131.99240750360403, 360.59999999999997, 15.590472718244907, 879.8218558705768, 360.1131678972831, 368.20000000000005, 1146.3059610058763, 1130.7094817298118, 559.1687639015901, 584.6422369140741, 370.32608973973515, 362.5999999999998, 122.67743594337443, 290.83444330151735, 120.29078504444715, 301.27522397016423, 358.90000000000117, 422.9275756006995, 493.3800891301913, 228.00043602038963, 44.41380699723433, 676.5611956045944, 292.07495166138824, 505.44885216877935, 219.78548364630151, 465.6587854889764, 449.06301133147986, 150.24869460343243, 400.91958181290624, 171.86167186427858, 516.9118288836581, 147.09999999999997, 597.0940633161829, 956.6411084845145, 177.24171544485236, 255.3880359972231, 382.18095655514514, 39.925905594066705, 257.82093823654395, 88.88952430354584, 378.30000000000194, 204.52864570909844, 97.834150512266, 432.2471343192074, 415.2000000000025, 496.30660456471185, 380.4999999999998, 391.40000000000185, 174.29999999999967, 496.9492125805924, 543.2506835499503, 206.8108973084969, 711.0657613753516, 574.3431129991429, 373.74305179519075, 166.51908731678918, 653.2000000000003, 771.1526731136177, 697.0354294432549, 112.55484002812071, 51.89058896848671, 225.80884465909094, 579.5913059387078, 549.8878845342377, 40.5823459768933, 438.3012712522346, 107.13624608130448, 78.11863480182612, 662.1666570814681, 319.6538580386293, 560.2676191008679, 294.43960630205765, 412.5283869895025, 86.15105622276687, 207.78837514324863, 37.113483112399216, 138.26656479142454, 717.0777554480205, 22.94815380244429, 369.924640755024, 210.20286963614268, 80.46130223464137, 399.90000900812896, 29.524517213857944, 331.47769723823797, 252.883883476483], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-174.52989208914056, -672.1425900683105, -361.66342308323055, -135.18274800099914, -384.0597186195523, -475.26975574843107, -634.5378355052297, -539.1754247407173, -511.3228785232241, -249.50213514332344, 379.5865922494585, -534.6161791666436, -153.86656739254875, -37.80032260889199, -106.99129945144283, -342.38618882333714, -151.00921321616232, 37.093451574175795, -873.0375517159218, -939.0906286100242, 319.36361289074034, -1063.622258766889, -593.4659492733867, -116.78495953485888, -1.8272024693713087, 111.36360107873087, -284.76840686060916, 383.9569426439564, -549.9582501136202, -609.2190975599984, -677.7660404466266, 167.5017742375119, -79.66336704596459, -119.66616479727172, 215.87600258234113, -1014.8189174589404, -1018.2621234015404, -452.35627645542274, -28.372243983255203, -103.5503205444054, -1384.4607208114335, 246.01621723628568, -1179.283815045673, 347.8002588555509, -1314.578528941797, 252.71894081658004, -600.0693491505017, -458.63988946101216, -896.9059552243975, 263.14467377379657, -712.6248315525404, 319.6377072314882, -978.4129843577368, -640.8097219819803, -1179.1350827453575, -339.5966378112449, -418.2846728649918, -691.8199148517775, -159.25864426664714, -600.0666120458678, 28.46768559198975, 252.41332648731859, -222.16420979997037, -615.7762925744075, -969.8844821610119, -125.16162445097743, -182.1486824559845, -43.52452679814177, -752.659240793018, -1010.5292949599582, 135.57042126185183, -456.35225868113673, -590.1285447429473, -739.1333677256528, 50.52097828884882, 65.10773333930257, -89.14598159454373, -815.1802018420252, -629.0718499031801, -240.27426044440824, 328.3204833054597, -671.2215804723705, -978.3231957933485, -270.74995499126317, -747.4032924608102, 392.79999999999995, -588.3823326042539, -267.9984556645919, -300.79260951848755, -1067.394805866823, -693.882426450675, -186.71614311962497, 21.670353378065343, 263.1276904945091, 339.5462179164227, -884.7347469536035, -382.569419553019, -541.0667447392948, -609.6848683990146, -440.85025756635446, -115.4984470754681, -712.7999451471163, -171.69363456891136, -910.7670142382716, -85.01673109857512, -90.00327357739113, -931.3617280002403, -212.60589784148718, -138.80503132460296, 339.6564989221631, -698.6954048220564, -97.08396099981715, -426.2413265781852, -352.4863098099044, -465.5619040696645, 308.4265251339474, 248.33618865267556, -134.64233284936913, -331.9816403867049, -948.3286438789439, 250.3125929285158, -409.9741504748157, -40.04469940480317, 357.7, -174.46725147789942, -131.7977296349842, -624.7173317274811, 202.13483636928498, 236.65311285377965, -54.38305177759605, -375.4780759155865, -924.2212974442552, -979.1484430796881, 278.84637124354396, -26.804365460158998, -751.4148821743281, -128.74450291529402, -833.203970618893, 97.49018264350332, -528.5487343614924, 354.5717207385407, 35.93700155897028, -880.7760962163012, 312.35459472837965, -527.3734790706548, -32.89504736773376, -574.1405836476835, -340.8291681885059, -736.020690825991, -172.45016944536604, -768.0113336649184, -47.41307272906446, -808.0886178514148, -441.1321533136728, 247.15139776921623, -923.203815142385, -441.6031575446546, -439.71155168984717, 35.69808446551906, -452.569523425257, -427.0237451025148, -34.796674941007225, -426.00519108163326, -472.2724813123435, -762.469481851704, 216.37317652042293, -635.5648749990901, -100.19926642873835, -365.05155571812145, -450.8623794163351, 201.8885924633365, -1097.5660070959152, -318.1590309862396, -75.89364106928048, -750.197655784472, -776.3181765427253, -1084.1363551117372, -587.7243432672993, -989.3885545217936, -0.7640017516061799, -50.76335444525571, -152.1458781635086, 370.2751503827641, -502.93206312136624, -798.5836165496536, -753.4688823984911, -503.30747013680116, 211.4646133175401, -762.4519562385227, -106.4450038202848, -589.3010120912007, -1077.4390564124249, 362.69151349785096, -432.1725379168466, -562.7734754491411, -880.5777596929825, 197.3236098093338, -331.16019527092726, -863.464188176719, 163.2631141161981], "policy_predator_policy_reward": [728.4434792544132, 480.45307816620794, 380.663011630453, 340.40557785458753, 510.45971861955377, 518.7321163023732, 600.0786871248915, 700.9392218790018, 764.3936617198694, 184.33187076178368, 23.72008980022777, 563.3161791666447, 38.50255318649423, 470.42390555029823, 335.193453260614, 467.9266661293968, 280.1092132161619, 0.8415777706911136, 874.8375517159222, 940.7906286100246, 406.9575310668084, 931.2016370932287, 534.8634286433592, 476.6065100672307, 60.03632695195433, 83.33691924803502, 322.16840686061505, 22.999610859111844, 1061.6644887823295, 229.5052663948987, 256.09666408397743, 614.767602125137, 213.31817966727334, 1.6018248942074795, 882.1417186423421, 796.6230521048332, 900.2401243516932, 930.4914434025543, 231.97224398325494, 268.1503205444061, 1206.5202166747183, 1078.2302479063037, 1039.9786112718114, 922.2144266481206, 1113.841391637488, 507.1869603893148, 675.8271811802196, 967.5242943453677, 888.9248418850381, 115.16252930529797, 716.8248315525412, 38.762292768511784, 984.3930570651561, 757.5070852179443, 805.9288454940556, 1003.6373183640699, 428.7498192959285, 801.6455534652887, 490.2887494479426, 570.3117308347389, 10.332314408010369, 67.68667351268124, 666.389049603227, 594.4790283718538, 616.107066086745, 972.3191296554265, 373.94911847637604, 79.72452679814118, 796.0730477902529, 1011.5292949599582, 380.06815093526643, 617.2748820886117, 894.7442239083546, 726.5926402216344, 210.129223294175, 179.69091724645256, 299.5314652408457, 824.5802018420263, 746.5073286200992, 588.49756721646, 523.3422844313766, 268.62182406701487, 981.4231957933492, 417.89864959469725, 751.6032924608111, 3.919581812906474, 752.6715325375922, 275.5709275955384, 1051.1500692332395, 833.9491750357282, 697.3824264506748, 330.31614311962625, 250.82964662193444, 61.46637282167377, 746.7487856415, 755.0808518801965, 546.9694195530195, 553.9084601841506, 709.5454324821713, 596.3777294804219, 578.6306415766345, 631.8487072010951, 776.5206923037689, 345.8658620974787, 133.57418302170385, 299.2667598908059, 586.6633966673716, 646.1937534779036, 174.66840593979447, 2.7801264626438043, 608.2587594650282, 392.04925206594436, 448.4080903586827, 428.15369654167625, 393.9107032714397, 195.47180998348455, 92.26381134732442, 209.2423328493681, 896.4247566827182, 880.1921321476441, 112.15305811099854, 428.00849943530375, 73.74469940480341, 0.0, 321.56725147790013, 158.99772963498265, 347.07527071326643, 572.4564372255224, 142.58476712118951, 218.3958553525772, 571.659151465722, 934.8511192026161, 934.3315829817282, 477.0362502297646, 675.7133575132818, 676.849003120345, 498.25263008633283, 837.4388952430423, 18.06598690275278, 579.5116521320268, 0.0, 262.6912777024892, 788.5692686828634, 551.0049059186738, 804.5493739074919, 452.7545819741513, 932.5160488808481, 95.0085429834686, 733.7478825370447, 226.6135667027974, 771.46054192557, 269.7727091275054, 849.6201305546346, 979.19194654916, 613.0133959147234, 612.9269059926812, 267.4748821127545, 654.4221730986457, 483.3699046047295, 371.80280560724253, 384.5556753909087, 184.40099073392167, 492.72382588346096, 483.6724813123445, 567.1144335680724, 641.1485288446731, 445.05835489384486, 610.3596445726072, 898.5889127039138, 477.59264153141083, 92.05101383872095, 1098.0660070959148, 77.97925326543266, 728.6018057795868, 929.4660520174687, 683.2008365324975, 1206.1364204272986, 673.5126530949866, 989.5885545217936, 37.67748486400538, 336.92658156684956, 4.2492158333402275, 404.1796846798964, 445.5549835067265, 805.6016975494177, 769.398955201173, 585.0618723746111, 76.70562519967422, 763.5548258746655, 315.5450038202853, 724.4318745340404, 1022.7694962042304, 0.7451009094175773, 468.6359325177072, 569.6734754491415, 903.2022769068406, 339.5961576935731, 125.71812500625725, 867.0641881767198, 86.02076936028492]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4634898404836867, "mean_inference_ms": 3.2480809062432274, "mean_action_processing_ms": 1.1634172331378023, "mean_env_wait_ms": 9.978569186314298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039376020431518555, "StateBufferConnector_ms": 0.004380345344543457, "ViewRequirementAgentConnector_ms": 0.12584936618804932}, "num_episodes": 9, "episode_return_max": 1146.3059610058763, "episode_return_min": 3.500000000000001, "episode_return_mean": 348.22365064245355, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.86821510035631, "num_env_steps_trained_throughput_per_sec": 82.86821510035631, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 57033.098, "restore_workers_time_ms": 0.015, "training_step_time_ms": 57033.049, "sample_time_ms": 2067.627, "learn_time_ms": 54947.022, "learn_throughput": 72.797, "synch_weights_time_ms": 15.974}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "fed12_00000", "date": "2024-08-21_19-05-18", "timestamp": 1724247318, "time_this_iter_s": 48.31009316444397, "time_total_s": 3642.090418815613, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4b5ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3642.090418815613, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 25.557971014492754, "ram_util_percent": 82.39565217391305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.22014129817801, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.30925442730939, "policy_loss": -0.01716923369932427, "vf_loss": 6.3239095213552, "vf_explained_var": 0.6349941384540033, "kl": 0.012570618921102434, "entropy": 0.5824521330456255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.148287242556375, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.522315338679722, "policy_loss": -0.0175225500024796, "vf_loss": 6.537652835644112, "vf_explained_var": 0.22279797120699807, "kl": 0.010925343679264187, "entropy": 0.37393016427282305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 1146.3059610058763, "episode_reward_min": 3.500000000000001, "episode_reward_mean": 346.17094044906696, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1384.4607208114335, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.79999999999995, "predator_policy": 1275.3509331095322}, "policy_reward_mean": {"prey_policy": -358.3814884588661, "predator_policy": 531.4669586833998}, "custom_metrics": {}, "hist_stats": {"episode_reward": [353.7426311152281, 167.0350293448649, 3.500000000000001, 593.9005222838896, 301.21902990234327, 252.90964480934738, 444.35655350307155, 131.99240750360403, 360.59999999999997, 15.590472718244907, 879.8218558705768, 360.1131678972831, 368.20000000000005, 1146.3059610058763, 1130.7094817298118, 559.1687639015901, 584.6422369140741, 370.32608973973515, 362.5999999999998, 122.67743594337443, 290.83444330151735, 120.29078504444715, 301.27522397016423, 358.90000000000117, 422.9275756006995, 493.3800891301913, 228.00043602038963, 44.41380699723433, 676.5611956045944, 292.07495166138824, 505.44885216877935, 219.78548364630151, 465.6587854889764, 449.06301133147986, 150.24869460343243, 400.91958181290624, 171.86167186427858, 516.9118288836581, 147.09999999999997, 597.0940633161829, 956.6411084845145, 177.24171544485236, 255.3880359972231, 382.18095655514514, 39.925905594066705, 257.82093823654395, 88.88952430354584, 378.30000000000194, 204.52864570909844, 97.834150512266, 432.2471343192074, 415.2000000000025, 496.30660456471185, 380.4999999999998, 391.40000000000185, 174.29999999999967, 496.9492125805924, 543.2506835499503, 206.8108973084969, 711.0657613753516, 574.3431129991429, 373.74305179519075, 166.51908731678918, 653.2000000000003, 771.1526731136177, 697.0354294432549, 112.55484002812071, 51.89058896848671, 225.80884465909094, 579.5913059387078, 549.8878845342377, 40.5823459768933, 438.3012712522346, 107.13624608130448, 78.11863480182612, 662.1666570814681, 319.6538580386293, 560.2676191008679, 294.43960630205765, 412.5283869895025, 86.15105622276687, 207.78837514324863, 37.113483112399216, 138.26656479142454, 717.0777554480205, 22.94815380244429, 369.924640755024, 210.20286963614268, 80.46130223464137, 399.90000900812896, 29.524517213857944, 331.47769723823797, 252.883883476483, 52.694590608341045, 249.8260935914348, 120.55094313921076, 94.04314501783715, 679.3486594820802, 25.899105825622648, 393.14671557282304], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-106.99129945144283, -342.38618882333714, -151.00921321616232, 37.093451574175795, -873.0375517159218, -939.0906286100242, 319.36361289074034, -1063.622258766889, -593.4659492733867, -116.78495953485888, -1.8272024693713087, 111.36360107873087, -284.76840686060916, 383.9569426439564, -549.9582501136202, -609.2190975599984, -677.7660404466266, 167.5017742375119, -79.66336704596459, -119.66616479727172, 215.87600258234113, -1014.8189174589404, -1018.2621234015404, -452.35627645542274, -28.372243983255203, -103.5503205444054, -1384.4607208114335, 246.01621723628568, -1179.283815045673, 347.8002588555509, -1314.578528941797, 252.71894081658004, -600.0693491505017, -458.63988946101216, -896.9059552243975, 263.14467377379657, -712.6248315525404, 319.6377072314882, -978.4129843577368, -640.8097219819803, -1179.1350827453575, -339.5966378112449, -418.2846728649918, -691.8199148517775, -159.25864426664714, -600.0666120458678, 28.46768559198975, 252.41332648731859, -222.16420979997037, -615.7762925744075, -969.8844821610119, -125.16162445097743, -182.1486824559845, -43.52452679814177, -752.659240793018, -1010.5292949599582, 135.57042126185183, -456.35225868113673, -590.1285447429473, -739.1333677256528, 50.52097828884882, 65.10773333930257, -89.14598159454373, -815.1802018420252, -629.0718499031801, -240.27426044440824, 328.3204833054597, -671.2215804723705, -978.3231957933485, -270.74995499126317, -747.4032924608102, 392.79999999999995, -588.3823326042539, -267.9984556645919, -300.79260951848755, -1067.394805866823, -693.882426450675, -186.71614311962497, 21.670353378065343, 263.1276904945091, 339.5462179164227, -884.7347469536035, -382.569419553019, -541.0667447392948, -609.6848683990146, -440.85025756635446, -115.4984470754681, -712.7999451471163, -171.69363456891136, -910.7670142382716, -85.01673109857512, -90.00327357739113, -931.3617280002403, -212.60589784148718, -138.80503132460296, 339.6564989221631, -698.6954048220564, -97.08396099981715, -426.2413265781852, -352.4863098099044, -465.5619040696645, 308.4265251339474, 248.33618865267556, -134.64233284936913, -331.9816403867049, -948.3286438789439, 250.3125929285158, -409.9741504748157, -40.04469940480317, 357.7, -174.46725147789942, -131.7977296349842, -624.7173317274811, 202.13483636928498, 236.65311285377965, -54.38305177759605, -375.4780759155865, -924.2212974442552, -979.1484430796881, 278.84637124354396, -26.804365460158998, -751.4148821743281, -128.74450291529402, -833.203970618893, 97.49018264350332, -528.5487343614924, 354.5717207385407, 35.93700155897028, -880.7760962163012, 312.35459472837965, -527.3734790706548, -32.89504736773376, -574.1405836476835, -340.8291681885059, -736.020690825991, -172.45016944536604, -768.0113336649184, -47.41307272906446, -808.0886178514148, -441.1321533136728, 247.15139776921623, -923.203815142385, -441.6031575446546, -439.71155168984717, 35.69808446551906, -452.569523425257, -427.0237451025148, -34.796674941007225, -426.00519108163326, -472.2724813123435, -762.469481851704, 216.37317652042293, -635.5648749990901, -100.19926642873835, -365.05155571812145, -450.8623794163351, 201.8885924633365, -1097.5660070959152, -318.1590309862396, -75.89364106928048, -750.197655784472, -776.3181765427253, -1084.1363551117372, -587.7243432672993, -989.3885545217936, -0.7640017516061799, -50.76335444525571, -152.1458781635086, 370.2751503827641, -502.93206312136624, -798.5836165496536, -753.4688823984911, -503.30747013680116, 211.4646133175401, -762.4519562385227, -106.4450038202848, -589.3010120912007, -1077.4390564124249, 362.69151349785096, -432.1725379168466, -562.7734754491411, -880.5777596929825, 197.3236098093338, -331.16019527092726, -863.464188176719, 163.2631141161981, -658.9504395644058, -382.149374872737, -864.3322700289336, -332.6630291725881, -241.65418080018472, -531.2430734493161, -140.2922093745795, -275.5235026871247, 169.53167257736635, -787.6234592363854, -967.7666049171121, -1107.26246672398, 255.39008155158564, -474.7362717282072], "policy_predator_policy_reward": [335.193453260614, 467.9266661293968, 280.1092132161619, 0.8415777706911136, 874.8375517159222, 940.7906286100246, 406.9575310668084, 931.2016370932287, 534.8634286433592, 476.6065100672307, 60.03632695195433, 83.33691924803502, 322.16840686061505, 22.999610859111844, 1061.6644887823295, 229.5052663948987, 256.09666408397743, 614.767602125137, 213.31817966727334, 1.6018248942074795, 882.1417186423421, 796.6230521048332, 900.2401243516932, 930.4914434025543, 231.97224398325494, 268.1503205444061, 1206.5202166747183, 1078.2302479063037, 1039.9786112718114, 922.2144266481206, 1113.841391637488, 507.1869603893148, 675.8271811802196, 967.5242943453677, 888.9248418850381, 115.16252930529797, 716.8248315525412, 38.762292768511784, 984.3930570651561, 757.5070852179443, 805.9288454940556, 1003.6373183640699, 428.7498192959285, 801.6455534652887, 490.2887494479426, 570.3117308347389, 10.332314408010369, 67.68667351268124, 666.389049603227, 594.4790283718538, 616.107066086745, 972.3191296554265, 373.94911847637604, 79.72452679814118, 796.0730477902529, 1011.5292949599582, 380.06815093526643, 617.2748820886117, 894.7442239083546, 726.5926402216344, 210.129223294175, 179.69091724645256, 299.5314652408457, 824.5802018420263, 746.5073286200992, 588.49756721646, 523.3422844313766, 268.62182406701487, 981.4231957933492, 417.89864959469725, 751.6032924608111, 3.919581812906474, 752.6715325375922, 275.5709275955384, 1051.1500692332395, 833.9491750357282, 697.3824264506748, 330.31614311962625, 250.82964662193444, 61.46637282167377, 746.7487856415, 755.0808518801965, 546.9694195530195, 553.9084601841506, 709.5454324821713, 596.3777294804219, 578.6306415766345, 631.8487072010951, 776.5206923037689, 345.8658620974787, 133.57418302170385, 299.2667598908059, 586.6633966673716, 646.1937534779036, 174.66840593979447, 2.7801264626438043, 608.2587594650282, 392.04925206594436, 448.4080903586827, 428.15369654167625, 393.9107032714397, 195.47180998348455, 92.26381134732442, 209.2423328493681, 896.4247566827182, 880.1921321476441, 112.15305811099854, 428.00849943530375, 73.74469940480341, 0.0, 321.56725147790013, 158.99772963498265, 347.07527071326643, 572.4564372255224, 142.58476712118951, 218.3958553525772, 571.659151465722, 934.8511192026161, 934.3315829817282, 477.0362502297646, 675.7133575132818, 676.849003120345, 498.25263008633283, 837.4388952430423, 18.06598690275278, 579.5116521320268, 0.0, 262.6912777024892, 788.5692686828634, 551.0049059186738, 804.5493739074919, 452.7545819741513, 932.5160488808481, 95.0085429834686, 733.7478825370447, 226.6135667027974, 771.46054192557, 269.7727091275054, 849.6201305546346, 979.19194654916, 613.0133959147234, 612.9269059926812, 267.4748821127545, 654.4221730986457, 483.3699046047295, 371.80280560724253, 384.5556753909087, 184.40099073392167, 492.72382588346096, 483.6724813123445, 567.1144335680724, 641.1485288446731, 445.05835489384486, 610.3596445726072, 898.5889127039138, 477.59264153141083, 92.05101383872095, 1098.0660070959148, 77.97925326543266, 728.6018057795868, 929.4660520174687, 683.2008365324975, 1206.1364204272986, 673.5126530949866, 989.5885545217936, 37.67748486400538, 336.92658156684956, 4.2492158333402275, 404.1796846798964, 445.5549835067265, 805.6016975494177, 769.398955201173, 585.0618723746111, 76.70562519967422, 763.5548258746655, 315.5450038202853, 724.4318745340404, 1022.7694962042304, 0.7451009094175773, 468.6359325177072, 569.6734754491415, 903.2022769068406, 339.5961576935731, 125.71812500625725, 867.0641881767198, 86.02076936028492, 734.7997066284665, 358.9946984170191, 812.3440315982722, 634.477361194688, 402.49579403249, 490.9524033562259, 76.81851938021151, 433.04033769933704, 659.3697983264416, 638.0706478146567, 1275.3509331095322, 825.5772443571786, 417.53367025608765, 194.95923549335777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4619842057958197, "mean_inference_ms": 3.2489696825848817, "mean_action_processing_ms": 1.165785618190949, "mean_env_wait_ms": 9.985677139881702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003947257995605469, "StateBufferConnector_ms": 0.009950876235961914, "ViewRequirementAgentConnector_ms": 0.13505184650421143}, "num_episodes": 7, "episode_return_max": 1146.3059610058763, "episode_return_min": 3.500000000000001, "episode_return_mean": 346.17094044906696, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.6288897761003, "num_env_steps_trained_throughput_per_sec": 81.6288897761003, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 57162.748, "restore_workers_time_ms": 0.015, "training_step_time_ms": 57162.699, "sample_time_ms": 2080.187, "learn_time_ms": 55063.806, "learn_throughput": 72.643, "synch_weights_time_ms": 15.98}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "fed12_00000", "date": "2024-08-21_19-06-07", "timestamp": 1724247367, "time_this_iter_s": 49.04879832267761, "time_total_s": 3691.1392171382904, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f3a3b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3691.1392171382904, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 26.384057971014492, "ram_util_percent": 82.87246376811594}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.6995921268665, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.14793325631076, "policy_loss": -0.020199310125058725, "vf_loss": 6.165632261044134, "vf_explained_var": 0.6526098875457017, "kl": 0.012501479093867437, "entropy": 0.5779168917388512, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.216605477862888, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.342607316012105, "policy_loss": -0.017819507742330196, "vf_loss": 6.358020474923351, "vf_explained_var": 0.36239679875197234, "kl": 0.01203178606764783, "entropy": 0.39221148492482605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 1146.3059610058763, "episode_reward_min": 3.6373398753782133, "episode_reward_mean": 344.2172504530611, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1391.758937372592, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.79999999999995, "predator_policy": 1328.8177568472042}, "policy_reward_mean": {"prey_policy": -370.62375581396833, "predator_policy": 542.7323810404991}, "custom_metrics": {}, "hist_stats": {"episode_reward": [131.99240750360403, 360.59999999999997, 15.590472718244907, 879.8218558705768, 360.1131678972831, 368.20000000000005, 1146.3059610058763, 1130.7094817298118, 559.1687639015901, 584.6422369140741, 370.32608973973515, 362.5999999999998, 122.67743594337443, 290.83444330151735, 120.29078504444715, 301.27522397016423, 358.90000000000117, 422.9275756006995, 493.3800891301913, 228.00043602038963, 44.41380699723433, 676.5611956045944, 292.07495166138824, 505.44885216877935, 219.78548364630151, 465.6587854889764, 449.06301133147986, 150.24869460343243, 400.91958181290624, 171.86167186427858, 516.9118288836581, 147.09999999999997, 597.0940633161829, 956.6411084845145, 177.24171544485236, 255.3880359972231, 382.18095655514514, 39.925905594066705, 257.82093823654395, 88.88952430354584, 378.30000000000194, 204.52864570909844, 97.834150512266, 432.2471343192074, 415.2000000000025, 496.30660456471185, 380.4999999999998, 391.40000000000185, 174.29999999999967, 496.9492125805924, 543.2506835499503, 206.8108973084969, 711.0657613753516, 574.3431129991429, 373.74305179519075, 166.51908731678918, 653.2000000000003, 771.1526731136177, 697.0354294432549, 112.55484002812071, 51.89058896848671, 225.80884465909094, 579.5913059387078, 549.8878845342377, 40.5823459768933, 438.3012712522346, 107.13624608130448, 78.11863480182612, 662.1666570814681, 319.6538580386293, 560.2676191008679, 294.43960630205765, 412.5283869895025, 86.15105622276687, 207.78837514324863, 37.113483112399216, 138.26656479142454, 717.0777554480205, 22.94815380244429, 369.924640755024, 210.20286963614268, 80.46130223464137, 399.90000900812896, 29.524517213857944, 331.47769723823797, 252.883883476483, 52.694590608341045, 249.8260935914348, 120.55094313921076, 94.04314501783715, 679.3486594820802, 25.899105825622648, 393.14671557282304, 3.6373398753782133, 322.38497308958716, 304.80599857434885, 170.4612970872278, 349.65658094792843, 95.52694962998305, 674.8212721537075], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-549.9582501136202, -609.2190975599984, -677.7660404466266, 167.5017742375119, -79.66336704596459, -119.66616479727172, 215.87600258234113, -1014.8189174589404, -1018.2621234015404, -452.35627645542274, -28.372243983255203, -103.5503205444054, -1384.4607208114335, 246.01621723628568, -1179.283815045673, 347.8002588555509, -1314.578528941797, 252.71894081658004, -600.0693491505017, -458.63988946101216, -896.9059552243975, 263.14467377379657, -712.6248315525404, 319.6377072314882, -978.4129843577368, -640.8097219819803, -1179.1350827453575, -339.5966378112449, -418.2846728649918, -691.8199148517775, -159.25864426664714, -600.0666120458678, 28.46768559198975, 252.41332648731859, -222.16420979997037, -615.7762925744075, -969.8844821610119, -125.16162445097743, -182.1486824559845, -43.52452679814177, -752.659240793018, -1010.5292949599582, 135.57042126185183, -456.35225868113673, -590.1285447429473, -739.1333677256528, 50.52097828884882, 65.10773333930257, -89.14598159454373, -815.1802018420252, -629.0718499031801, -240.27426044440824, 328.3204833054597, -671.2215804723705, -978.3231957933485, -270.74995499126317, -747.4032924608102, 392.79999999999995, -588.3823326042539, -267.9984556645919, -300.79260951848755, -1067.394805866823, -693.882426450675, -186.71614311962497, 21.670353378065343, 263.1276904945091, 339.5462179164227, -884.7347469536035, -382.569419553019, -541.0667447392948, -609.6848683990146, -440.85025756635446, -115.4984470754681, -712.7999451471163, -171.69363456891136, -910.7670142382716, -85.01673109857512, -90.00327357739113, -931.3617280002403, -212.60589784148718, -138.80503132460296, 339.6564989221631, -698.6954048220564, -97.08396099981715, -426.2413265781852, -352.4863098099044, -465.5619040696645, 308.4265251339474, 248.33618865267556, -134.64233284936913, -331.9816403867049, -948.3286438789439, 250.3125929285158, -409.9741504748157, -40.04469940480317, 357.7, -174.46725147789942, -131.7977296349842, -624.7173317274811, 202.13483636928498, 236.65311285377965, -54.38305177759605, -375.4780759155865, -924.2212974442552, -979.1484430796881, 278.84637124354396, -26.804365460158998, -751.4148821743281, -128.74450291529402, -833.203970618893, 97.49018264350332, -528.5487343614924, 354.5717207385407, 35.93700155897028, -880.7760962163012, 312.35459472837965, -527.3734790706548, -32.89504736773376, -574.1405836476835, -340.8291681885059, -736.020690825991, -172.45016944536604, -768.0113336649184, -47.41307272906446, -808.0886178514148, -441.1321533136728, 247.15139776921623, -923.203815142385, -441.6031575446546, -439.71155168984717, 35.69808446551906, -452.569523425257, -427.0237451025148, -34.796674941007225, -426.00519108163326, -472.2724813123435, -762.469481851704, 216.37317652042293, -635.5648749990901, -100.19926642873835, -365.05155571812145, -450.8623794163351, 201.8885924633365, -1097.5660070959152, -318.1590309862396, -75.89364106928048, -750.197655784472, -776.3181765427253, -1084.1363551117372, -587.7243432672993, -989.3885545217936, -0.7640017516061799, -50.76335444525571, -152.1458781635086, 370.2751503827641, -502.93206312136624, -798.5836165496536, -753.4688823984911, -503.30747013680116, 211.4646133175401, -762.4519562385227, -106.4450038202848, -589.3010120912007, -1077.4390564124249, 362.69151349785096, -432.1725379168466, -562.7734754491411, -880.5777596929825, 197.3236098093338, -331.16019527092726, -863.464188176719, 163.2631141161981, -658.9504395644058, -382.149374872737, -864.3322700289336, -332.6630291725881, -241.65418080018472, -531.2430734493161, -140.2922093745795, -275.5235026871247, 169.53167257736635, -787.6234592363854, -967.7666049171121, -1107.26246672398, 255.39008155158564, -474.7362717282072, -748.9112015870638, -303.5436549716184, -734.4382388827347, -115.16198161966648, 150.23273492555953, -703.1402263436804, -90.07996356044438, -475.3658561505349, 110.78294355544396, -777.5101034906811, -520.4040572993242, -1391.758937372592, 312.04066466594196, -782.4016434234516], "policy_predator_policy_reward": [1061.6644887823295, 229.5052663948987, 256.09666408397743, 614.767602125137, 213.31817966727334, 1.6018248942074795, 882.1417186423421, 796.6230521048332, 900.2401243516932, 930.4914434025543, 231.97224398325494, 268.1503205444061, 1206.5202166747183, 1078.2302479063037, 1039.9786112718114, 922.2144266481206, 1113.841391637488, 507.1869603893148, 675.8271811802196, 967.5242943453677, 888.9248418850381, 115.16252930529797, 716.8248315525412, 38.762292768511784, 984.3930570651561, 757.5070852179443, 805.9288454940556, 1003.6373183640699, 428.7498192959285, 801.6455534652887, 490.2887494479426, 570.3117308347389, 10.332314408010369, 67.68667351268124, 666.389049603227, 594.4790283718538, 616.107066086745, 972.3191296554265, 373.94911847637604, 79.72452679814118, 796.0730477902529, 1011.5292949599582, 380.06815093526643, 617.2748820886117, 894.7442239083546, 726.5926402216344, 210.129223294175, 179.69091724645256, 299.5314652408457, 824.5802018420263, 746.5073286200992, 588.49756721646, 523.3422844313766, 268.62182406701487, 981.4231957933492, 417.89864959469725, 751.6032924608111, 3.919581812906474, 752.6715325375922, 275.5709275955384, 1051.1500692332395, 833.9491750357282, 697.3824264506748, 330.31614311962625, 250.82964662193444, 61.46637282167377, 746.7487856415, 755.0808518801965, 546.9694195530195, 553.9084601841506, 709.5454324821713, 596.3777294804219, 578.6306415766345, 631.8487072010951, 776.5206923037689, 345.8658620974787, 133.57418302170385, 299.2667598908059, 586.6633966673716, 646.1937534779036, 174.66840593979447, 2.7801264626438043, 608.2587594650282, 392.04925206594436, 448.4080903586827, 428.15369654167625, 393.9107032714397, 195.47180998348455, 92.26381134732442, 209.2423328493681, 896.4247566827182, 880.1921321476441, 112.15305811099854, 428.00849943530375, 73.74469940480341, 0.0, 321.56725147790013, 158.99772963498265, 347.07527071326643, 572.4564372255224, 142.58476712118951, 218.3958553525772, 571.659151465722, 934.8511192026161, 934.3315829817282, 477.0362502297646, 675.7133575132818, 676.849003120345, 498.25263008633283, 837.4388952430423, 18.06598690275278, 579.5116521320268, 0.0, 262.6912777024892, 788.5692686828634, 551.0049059186738, 804.5493739074919, 452.7545819741513, 932.5160488808481, 95.0085429834686, 733.7478825370447, 226.6135667027974, 771.46054192557, 269.7727091275054, 849.6201305546346, 979.19194654916, 613.0133959147234, 612.9269059926812, 267.4748821127545, 654.4221730986457, 483.3699046047295, 371.80280560724253, 384.5556753909087, 184.40099073392167, 492.72382588346096, 483.6724813123445, 567.1144335680724, 641.1485288446731, 445.05835489384486, 610.3596445726072, 898.5889127039138, 477.59264153141083, 92.05101383872095, 1098.0660070959148, 77.97925326543266, 728.6018057795868, 929.4660520174687, 683.2008365324975, 1206.1364204272986, 673.5126530949866, 989.5885545217936, 37.67748486400538, 336.92658156684956, 4.2492158333402275, 404.1796846798964, 445.5549835067265, 805.6016975494177, 769.398955201173, 585.0618723746111, 76.70562519967422, 763.5548258746655, 315.5450038202853, 724.4318745340404, 1022.7694962042304, 0.7451009094175773, 468.6359325177072, 569.6734754491415, 903.2022769068406, 339.5961576935731, 125.71812500625725, 867.0641881767198, 86.02076936028492, 734.7997066284665, 358.9946984170191, 812.3440315982722, 634.477361194688, 402.49579403249, 490.9524033562259, 76.81851938021151, 433.04033769933704, 659.3697983264416, 638.0706478146567, 1275.3509331095322, 825.5772443571786, 417.53367025608765, 194.95923549335777, 754.2736243553618, 301.8185720787061, 455.57557931264694, 716.4096142793383, 180.09653912723562, 677.6169508652351, 407.78941400231554, 328.11770279589166, 258.74216380187926, 757.6415770812862, 678.8721874546945, 1328.8177568472042, 616.8597985095965, 528.3224524016214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.461776339040287, "mean_inference_ms": 3.250419644604234, "mean_action_processing_ms": 1.163484433669911, "mean_env_wait_ms": 9.978490499194926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005404233932495117, "StateBufferConnector_ms": 0.010009288787841797, "ViewRequirementAgentConnector_ms": 0.14396405220031738}, "num_episodes": 7, "episode_return_max": 1146.3059610058763, "episode_return_min": 3.6373398753782133, "episode_return_mean": 344.2172504530611, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.8539612319031, "num_env_steps_trained_throughput_per_sec": 79.8539612319031, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 57347.419, "restore_workers_time_ms": 0.015, "training_step_time_ms": 57347.37, "sample_time_ms": 2085.038, "learn_time_ms": 55243.409, "learn_throughput": 72.407, "synch_weights_time_ms": 16.054}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "fed12_00000", "date": "2024-08-21_19-06-57", "timestamp": 1724247417, "time_this_iter_s": 50.14892101287842, "time_total_s": 3741.288138151169, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f733550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3741.288138151169, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 29.765714285714285, "ram_util_percent": 82.65857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.109800603906944, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.299625462072867, "policy_loss": -0.0209241430988417, "vf_loss": 6.317758599790946, "vf_explained_var": 0.6127214563902093, "kl": 0.013955038966285804, "entropy": 0.5592172531696854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.727376156130795, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.397381322346036, "policy_loss": -0.020024926615287625, "vf_loss": 6.414938051486142, "vf_explained_var": 0.2859673078728731, "kl": 0.012340989176716123, "entropy": 0.38513250478676386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 1130.7094817298118, "episode_reward_min": 3.6373398753782133, "episode_reward_mean": 338.4994370554668, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1391.758937372592, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.79999999999995, "predator_policy": 1328.8177568472042}, "policy_reward_mean": {"prey_policy": -367.22284326453735, "predator_policy": 536.4725617922711}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1130.7094817298118, 559.1687639015901, 584.6422369140741, 370.32608973973515, 362.5999999999998, 122.67743594337443, 290.83444330151735, 120.29078504444715, 301.27522397016423, 358.90000000000117, 422.9275756006995, 493.3800891301913, 228.00043602038963, 44.41380699723433, 676.5611956045944, 292.07495166138824, 505.44885216877935, 219.78548364630151, 465.6587854889764, 449.06301133147986, 150.24869460343243, 400.91958181290624, 171.86167186427858, 516.9118288836581, 147.09999999999997, 597.0940633161829, 956.6411084845145, 177.24171544485236, 255.3880359972231, 382.18095655514514, 39.925905594066705, 257.82093823654395, 88.88952430354584, 378.30000000000194, 204.52864570909844, 97.834150512266, 432.2471343192074, 415.2000000000025, 496.30660456471185, 380.4999999999998, 391.40000000000185, 174.29999999999967, 496.9492125805924, 543.2506835499503, 206.8108973084969, 711.0657613753516, 574.3431129991429, 373.74305179519075, 166.51908731678918, 653.2000000000003, 771.1526731136177, 697.0354294432549, 112.55484002812071, 51.89058896848671, 225.80884465909094, 579.5913059387078, 549.8878845342377, 40.5823459768933, 438.3012712522346, 107.13624608130448, 78.11863480182612, 662.1666570814681, 319.6538580386293, 560.2676191008679, 294.43960630205765, 412.5283869895025, 86.15105622276687, 207.78837514324863, 37.113483112399216, 138.26656479142454, 717.0777554480205, 22.94815380244429, 369.924640755024, 210.20286963614268, 80.46130223464137, 399.90000900812896, 29.524517213857944, 331.47769723823797, 252.883883476483, 52.694590608341045, 249.8260935914348, 120.55094313921076, 94.04314501783715, 679.3486594820802, 25.899105825622648, 393.14671557282304, 3.6373398753782133, 322.38497308958716, 304.80599857434885, 170.4612970872278, 349.65658094792843, 95.52694962998305, 674.8212721537075, 69.86695553356583, 70.99181860253313, 498.6850353397697, 449.1502534136426, 724.4713818462694, 109.69999999999985, 767.9770805003715], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1179.283815045673, 347.8002588555509, -1314.578528941797, 252.71894081658004, -600.0693491505017, -458.63988946101216, -896.9059552243975, 263.14467377379657, -712.6248315525404, 319.6377072314882, -978.4129843577368, -640.8097219819803, -1179.1350827453575, -339.5966378112449, -418.2846728649918, -691.8199148517775, -159.25864426664714, -600.0666120458678, 28.46768559198975, 252.41332648731859, -222.16420979997037, -615.7762925744075, -969.8844821610119, -125.16162445097743, -182.1486824559845, -43.52452679814177, -752.659240793018, -1010.5292949599582, 135.57042126185183, -456.35225868113673, -590.1285447429473, -739.1333677256528, 50.52097828884882, 65.10773333930257, -89.14598159454373, -815.1802018420252, -629.0718499031801, -240.27426044440824, 328.3204833054597, -671.2215804723705, -978.3231957933485, -270.74995499126317, -747.4032924608102, 392.79999999999995, -588.3823326042539, -267.9984556645919, -300.79260951848755, -1067.394805866823, -693.882426450675, -186.71614311962497, 21.670353378065343, 263.1276904945091, 339.5462179164227, -884.7347469536035, -382.569419553019, -541.0667447392948, -609.6848683990146, -440.85025756635446, -115.4984470754681, -712.7999451471163, -171.69363456891136, -910.7670142382716, -85.01673109857512, -90.00327357739113, -931.3617280002403, -212.60589784148718, -138.80503132460296, 339.6564989221631, -698.6954048220564, -97.08396099981715, -426.2413265781852, -352.4863098099044, -465.5619040696645, 308.4265251339474, 248.33618865267556, -134.64233284936913, -331.9816403867049, -948.3286438789439, 250.3125929285158, -409.9741504748157, -40.04469940480317, 357.7, -174.46725147789942, -131.7977296349842, -624.7173317274811, 202.13483636928498, 236.65311285377965, -54.38305177759605, -375.4780759155865, -924.2212974442552, -979.1484430796881, 278.84637124354396, -26.804365460158998, -751.4148821743281, -128.74450291529402, -833.203970618893, 97.49018264350332, -528.5487343614924, 354.5717207385407, 35.93700155897028, -880.7760962163012, 312.35459472837965, -527.3734790706548, -32.89504736773376, -574.1405836476835, -340.8291681885059, -736.020690825991, -172.45016944536604, -768.0113336649184, -47.41307272906446, -808.0886178514148, -441.1321533136728, 247.15139776921623, -923.203815142385, -441.6031575446546, -439.71155168984717, 35.69808446551906, -452.569523425257, -427.0237451025148, -34.796674941007225, -426.00519108163326, -472.2724813123435, -762.469481851704, 216.37317652042293, -635.5648749990901, -100.19926642873835, -365.05155571812145, -450.8623794163351, 201.8885924633365, -1097.5660070959152, -318.1590309862396, -75.89364106928048, -750.197655784472, -776.3181765427253, -1084.1363551117372, -587.7243432672993, -989.3885545217936, -0.7640017516061799, -50.76335444525571, -152.1458781635086, 370.2751503827641, -502.93206312136624, -798.5836165496536, -753.4688823984911, -503.30747013680116, 211.4646133175401, -762.4519562385227, -106.4450038202848, -589.3010120912007, -1077.4390564124249, 362.69151349785096, -432.1725379168466, -562.7734754491411, -880.5777596929825, 197.3236098093338, -331.16019527092726, -863.464188176719, 163.2631141161981, -658.9504395644058, -382.149374872737, -864.3322700289336, -332.6630291725881, -241.65418080018472, -531.2430734493161, -140.2922093745795, -275.5235026871247, 169.53167257736635, -787.6234592363854, -967.7666049171121, -1107.26246672398, 255.39008155158564, -474.7362717282072, -748.9112015870638, -303.5436549716184, -734.4382388827347, -115.16198161966648, 150.23273492555953, -703.1402263436804, -90.07996356044438, -475.3658561505349, 110.78294355544396, -777.5101034906811, -520.4040572993242, -1391.758937372592, 312.04066466594196, -782.4016434234516, -231.899140038776, -311.16437520505895, -315.04887851297667, -615.3303993962646, 20.86417583769097, -562.6585690249484, -112.66993740184196, -248.18877278143003, -970.9511171375616, -16.93035570143479, -398.4515414616941, -344.8492677043123, -906.2116033769445, 284.9727632293883], "policy_predator_policy_reward": [1039.9786112718114, 922.2144266481206, 1113.841391637488, 507.1869603893148, 675.8271811802196, 967.5242943453677, 888.9248418850381, 115.16252930529797, 716.8248315525412, 38.762292768511784, 984.3930570651561, 757.5070852179443, 805.9288454940556, 1003.6373183640699, 428.7498192959285, 801.6455534652887, 490.2887494479426, 570.3117308347389, 10.332314408010369, 67.68667351268124, 666.389049603227, 594.4790283718538, 616.107066086745, 972.3191296554265, 373.94911847637604, 79.72452679814118, 796.0730477902529, 1011.5292949599582, 380.06815093526643, 617.2748820886117, 894.7442239083546, 726.5926402216344, 210.129223294175, 179.69091724645256, 299.5314652408457, 824.5802018420263, 746.5073286200992, 588.49756721646, 523.3422844313766, 268.62182406701487, 981.4231957933492, 417.89864959469725, 751.6032924608111, 3.919581812906474, 752.6715325375922, 275.5709275955384, 1051.1500692332395, 833.9491750357282, 697.3824264506748, 330.31614311962625, 250.82964662193444, 61.46637282167377, 746.7487856415, 755.0808518801965, 546.9694195530195, 553.9084601841506, 709.5454324821713, 596.3777294804219, 578.6306415766345, 631.8487072010951, 776.5206923037689, 345.8658620974787, 133.57418302170385, 299.2667598908059, 586.6633966673716, 646.1937534779036, 174.66840593979447, 2.7801264626438043, 608.2587594650282, 392.04925206594436, 448.4080903586827, 428.15369654167625, 393.9107032714397, 195.47180998348455, 92.26381134732442, 209.2423328493681, 896.4247566827182, 880.1921321476441, 112.15305811099854, 428.00849943530375, 73.74469940480341, 0.0, 321.56725147790013, 158.99772963498265, 347.07527071326643, 572.4564372255224, 142.58476712118951, 218.3958553525772, 571.659151465722, 934.8511192026161, 934.3315829817282, 477.0362502297646, 675.7133575132818, 676.849003120345, 498.25263008633283, 837.4388952430423, 18.06598690275278, 579.5116521320268, 0.0, 262.6912777024892, 788.5692686828634, 551.0049059186738, 804.5493739074919, 452.7545819741513, 932.5160488808481, 95.0085429834686, 733.7478825370447, 226.6135667027974, 771.46054192557, 269.7727091275054, 849.6201305546346, 979.19194654916, 613.0133959147234, 612.9269059926812, 267.4748821127545, 654.4221730986457, 483.3699046047295, 371.80280560724253, 384.5556753909087, 184.40099073392167, 492.72382588346096, 483.6724813123445, 567.1144335680724, 641.1485288446731, 445.05835489384486, 610.3596445726072, 898.5889127039138, 477.59264153141083, 92.05101383872095, 1098.0660070959148, 77.97925326543266, 728.6018057795868, 929.4660520174687, 683.2008365324975, 1206.1364204272986, 673.5126530949866, 989.5885545217936, 37.67748486400538, 336.92658156684956, 4.2492158333402275, 404.1796846798964, 445.5549835067265, 805.6016975494177, 769.398955201173, 585.0618723746111, 76.70562519967422, 763.5548258746655, 315.5450038202853, 724.4318745340404, 1022.7694962042304, 0.7451009094175773, 468.6359325177072, 569.6734754491415, 903.2022769068406, 339.5961576935731, 125.71812500625725, 867.0641881767198, 86.02076936028492, 734.7997066284665, 358.9946984170191, 812.3440315982722, 634.477361194688, 402.49579403249, 490.9524033562259, 76.81851938021151, 433.04033769933704, 659.3697983264416, 638.0706478146567, 1275.3509331095322, 825.5772443571786, 417.53367025608765, 194.95923549335777, 754.2736243553618, 301.8185720787061, 455.57557931264694, 716.4096142793383, 180.09653912723562, 677.6169508652351, 407.78941400231554, 328.11770279589166, 258.74216380187926, 757.6415770812862, 678.8721874546945, 1328.8177568472042, 616.8597985095965, 528.3224524016214, 289.91217905758367, 323.01829171982064, 602.1271373004868, 399.2439592112916, 493.0699211118052, 547.409507415218, 551.7700480453913, 258.2389155515224, 849.6338556231699, 862.7189990620961, 507.47940021151675, 345.521408954493, 680.7622345253371, 708.4536861225898]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.462032521743061, "mean_inference_ms": 3.246686778986665, "mean_action_processing_ms": 1.160208661065615, "mean_env_wait_ms": 9.980913364567247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005477547645568848, "StateBufferConnector_ms": 0.009969353675842285, "ViewRequirementAgentConnector_ms": 0.1567438840866089}, "num_episodes": 7, "episode_return_max": 1130.7094817298118, "episode_return_min": 3.6373398753782133, "episode_return_mean": 338.4994370554668, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.176349929079698, "num_env_steps_trained_throughput_per_sec": 4.176349929079698, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 139721.582, "restore_workers_time_ms": 0.015, "training_step_time_ms": 139721.533, "sample_time_ms": 2142.565, "learn_time_ms": 137561.69, "learn_throughput": 29.078, "synch_weights_time_ms": 14.381}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "fed12_00000", "date": "2024-08-21_19-22-55", "timestamp": 1724248375, "time_this_iter_s": 957.8376679420471, "time_total_s": 4699.125806093216, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f3a3940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4699.125806093216, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 37.586301369863016, "ram_util_percent": 82.58219178082192}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.90375966723003, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.243692761123496, "policy_loss": -0.024637088906414136, "vf_loss": 6.265115314059788, "vf_explained_var": 0.6117342563533278, "kl": 0.016072646835720333, "entropy": 0.5958595964486006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.75820173258504, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.484448667304226, "policy_loss": -0.016776570477448995, "vf_loss": 6.498747283188754, "vf_explained_var": 0.2691262637181257, "kl": 0.012389712633377818, "entropy": 0.40162954786151805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 956.6411084845145, "episode_reward_min": 3.6373398753782133, "episode_reward_mean": 337.72226413493104, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1391.758937372592, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1328.8177568472042}, "policy_reward_mean": {"prey_policy": -346.7181198342625, "predator_policy": 515.5792519017282}, "custom_metrics": {}, "hist_stats": {"episode_reward": [676.5611956045944, 292.07495166138824, 505.44885216877935, 219.78548364630151, 465.6587854889764, 449.06301133147986, 150.24869460343243, 400.91958181290624, 171.86167186427858, 516.9118288836581, 147.09999999999997, 597.0940633161829, 956.6411084845145, 177.24171544485236, 255.3880359972231, 382.18095655514514, 39.925905594066705, 257.82093823654395, 88.88952430354584, 378.30000000000194, 204.52864570909844, 97.834150512266, 432.2471343192074, 415.2000000000025, 496.30660456471185, 380.4999999999998, 391.40000000000185, 174.29999999999967, 496.9492125805924, 543.2506835499503, 206.8108973084969, 711.0657613753516, 574.3431129991429, 373.74305179519075, 166.51908731678918, 653.2000000000003, 771.1526731136177, 697.0354294432549, 112.55484002812071, 51.89058896848671, 225.80884465909094, 579.5913059387078, 549.8878845342377, 40.5823459768933, 438.3012712522346, 107.13624608130448, 78.11863480182612, 662.1666570814681, 319.6538580386293, 560.2676191008679, 294.43960630205765, 412.5283869895025, 86.15105622276687, 207.78837514324863, 37.113483112399216, 138.26656479142454, 717.0777554480205, 22.94815380244429, 369.924640755024, 210.20286963614268, 80.46130223464137, 399.90000900812896, 29.524517213857944, 331.47769723823797, 252.883883476483, 52.694590608341045, 249.8260935914348, 120.55094313921076, 94.04314501783715, 679.3486594820802, 25.899105825622648, 393.14671557282304, 3.6373398753782133, 322.38497308958716, 304.80599857434885, 170.4612970872278, 349.65658094792843, 95.52694962998305, 674.8212721537075, 69.86695553356583, 70.99181860253313, 498.6850353397697, 449.1502534136426, 724.4713818462694, 109.69999999999985, 767.9770805003715, 362.60000000000014, 573.8293312692516, 57.28626708810155, 468.88878381379675, 500.0447366267715, 665.2202773994717, 52.12585425112409, 623.9802200419183, 68.07617199496292, 641.8771404899326, 286.8947601431727, 406.34672634255855, 433.00000000000296, 172.25880677859007], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [135.57042126185183, -456.35225868113673, -590.1285447429473, -739.1333677256528, 50.52097828884882, 65.10773333930257, -89.14598159454373, -815.1802018420252, -629.0718499031801, -240.27426044440824, 328.3204833054597, -671.2215804723705, -978.3231957933485, -270.74995499126317, -747.4032924608102, 392.79999999999995, -588.3823326042539, -267.9984556645919, -300.79260951848755, -1067.394805866823, -693.882426450675, -186.71614311962497, 21.670353378065343, 263.1276904945091, 339.5462179164227, -884.7347469536035, -382.569419553019, -541.0667447392948, -609.6848683990146, -440.85025756635446, -115.4984470754681, -712.7999451471163, -171.69363456891136, -910.7670142382716, -85.01673109857512, -90.00327357739113, -931.3617280002403, -212.60589784148718, -138.80503132460296, 339.6564989221631, -698.6954048220564, -97.08396099981715, -426.2413265781852, -352.4863098099044, -465.5619040696645, 308.4265251339474, 248.33618865267556, -134.64233284936913, -331.9816403867049, -948.3286438789439, 250.3125929285158, -409.9741504748157, -40.04469940480317, 357.7, -174.46725147789942, -131.7977296349842, -624.7173317274811, 202.13483636928498, 236.65311285377965, -54.38305177759605, -375.4780759155865, -924.2212974442552, -979.1484430796881, 278.84637124354396, -26.804365460158998, -751.4148821743281, -128.74450291529402, -833.203970618893, 97.49018264350332, -528.5487343614924, 354.5717207385407, 35.93700155897028, -880.7760962163012, 312.35459472837965, -527.3734790706548, -32.89504736773376, -574.1405836476835, -340.8291681885059, -736.020690825991, -172.45016944536604, -768.0113336649184, -47.41307272906446, -808.0886178514148, -441.1321533136728, 247.15139776921623, -923.203815142385, -441.6031575446546, -439.71155168984717, 35.69808446551906, -452.569523425257, -427.0237451025148, -34.796674941007225, -426.00519108163326, -472.2724813123435, -762.469481851704, 216.37317652042293, -635.5648749990901, -100.19926642873835, -365.05155571812145, -450.8623794163351, 201.8885924633365, -1097.5660070959152, -318.1590309862396, -75.89364106928048, -750.197655784472, -776.3181765427253, -1084.1363551117372, -587.7243432672993, -989.3885545217936, -0.7640017516061799, -50.76335444525571, -152.1458781635086, 370.2751503827641, -502.93206312136624, -798.5836165496536, -753.4688823984911, -503.30747013680116, 211.4646133175401, -762.4519562385227, -106.4450038202848, -589.3010120912007, -1077.4390564124249, 362.69151349785096, -432.1725379168466, -562.7734754491411, -880.5777596929825, 197.3236098093338, -331.16019527092726, -863.464188176719, 163.2631141161981, -658.9504395644058, -382.149374872737, -864.3322700289336, -332.6630291725881, -241.65418080018472, -531.2430734493161, -140.2922093745795, -275.5235026871247, 169.53167257736635, -787.6234592363854, -967.7666049171121, -1107.26246672398, 255.39008155158564, -474.7362717282072, -748.9112015870638, -303.5436549716184, -734.4382388827347, -115.16198161966648, 150.23273492555953, -703.1402263436804, -90.07996356044438, -475.3658561505349, 110.78294355544396, -777.5101034906811, -520.4040572993242, -1391.758937372592, 312.04066466594196, -782.4016434234516, -231.899140038776, -311.16437520505895, -315.04887851297667, -615.3303993962646, 20.86417583769097, -562.6585690249484, -112.66993740184196, -248.18877278143003, -970.9511171375616, -16.93035570143479, -398.4515414616941, -344.8492677043123, -906.2116033769445, 284.9727632293883, 311.7924347048818, -597.3023308894536, -1116.2781268433273, 32.551513261773295, -251.63831920376987, -749.4252802722526, -622.9159070213689, 174.01337980573544, -689.3070262075485, 311.88202390492324, -820.136317394573, 321.37372657075696, -481.6207158499032, -1148.7570011859057, -558.1180209684189, 388.1924593191502, -209.21146532290803, -374.88603780148827, -755.5914401733315, 86.54150837551256, 184.9164586242, -615.0916221972899, -104.17744650560861, -696.7820553622977, 400.0, -80.91039100302478, -807.8485839951675, -57.473131852576515], "policy_predator_policy_reward": [380.06815093526643, 617.2748820886117, 894.7442239083546, 726.5926402216344, 210.129223294175, 179.69091724645256, 299.5314652408457, 824.5802018420263, 746.5073286200992, 588.49756721646, 523.3422844313766, 268.62182406701487, 981.4231957933492, 417.89864959469725, 751.6032924608111, 3.919581812906474, 752.6715325375922, 275.5709275955384, 1051.1500692332395, 833.9491750357282, 697.3824264506748, 330.31614311962625, 250.82964662193444, 61.46637282167377, 746.7487856415, 755.0808518801965, 546.9694195530195, 553.9084601841506, 709.5454324821713, 596.3777294804219, 578.6306415766345, 631.8487072010951, 776.5206923037689, 345.8658620974787, 133.57418302170385, 299.2667598908059, 586.6633966673716, 646.1937534779036, 174.66840593979447, 2.7801264626438043, 608.2587594650282, 392.04925206594436, 448.4080903586827, 428.15369654167625, 393.9107032714397, 195.47180998348455, 92.26381134732442, 209.2423328493681, 896.4247566827182, 880.1921321476441, 112.15305811099854, 428.00849943530375, 73.74469940480341, 0.0, 321.56725147790013, 158.99772963498265, 347.07527071326643, 572.4564372255224, 142.58476712118951, 218.3958553525772, 571.659151465722, 934.8511192026161, 934.3315829817282, 477.0362502297646, 675.7133575132818, 676.849003120345, 498.25263008633283, 837.4388952430423, 18.06598690275278, 579.5116521320268, 0.0, 262.6912777024892, 788.5692686828634, 551.0049059186738, 804.5493739074919, 452.7545819741513, 932.5160488808481, 95.0085429834686, 733.7478825370447, 226.6135667027974, 771.46054192557, 269.7727091275054, 849.6201305546346, 979.19194654916, 613.0133959147234, 612.9269059926812, 267.4748821127545, 654.4221730986457, 483.3699046047295, 371.80280560724253, 384.5556753909087, 184.40099073392167, 492.72382588346096, 483.6724813123445, 567.1144335680724, 641.1485288446731, 445.05835489384486, 610.3596445726072, 898.5889127039138, 477.59264153141083, 92.05101383872095, 1098.0660070959148, 77.97925326543266, 728.6018057795868, 929.4660520174687, 683.2008365324975, 1206.1364204272986, 673.5126530949866, 989.5885545217936, 37.67748486400538, 336.92658156684956, 4.2492158333402275, 404.1796846798964, 445.5549835067265, 805.6016975494177, 769.398955201173, 585.0618723746111, 76.70562519967422, 763.5548258746655, 315.5450038202853, 724.4318745340404, 1022.7694962042304, 0.7451009094175773, 468.6359325177072, 569.6734754491415, 903.2022769068406, 339.5961576935731, 125.71812500625725, 867.0641881767198, 86.02076936028492, 734.7997066284665, 358.9946984170191, 812.3440315982722, 634.477361194688, 402.49579403249, 490.9524033562259, 76.81851938021151, 433.04033769933704, 659.3697983264416, 638.0706478146567, 1275.3509331095322, 825.5772443571786, 417.53367025608765, 194.95923549335777, 754.2736243553618, 301.8185720787061, 455.57557931264694, 716.4096142793383, 180.09653912723562, 677.6169508652351, 407.78941400231554, 328.11770279589166, 258.74216380187926, 757.6415770812862, 678.8721874546945, 1328.8177568472042, 616.8597985095965, 528.3224524016214, 289.91217905758367, 323.01829171982064, 602.1271373004868, 399.2439592112916, 493.0699211118052, 547.409507415218, 551.7700480453913, 258.2389155515224, 849.6338556231699, 862.7189990620961, 507.47940021151675, 345.521408954493, 680.7622345253371, 708.4536861225898, 42.70756529511818, 605.4023308894557, 920.1735787525125, 737.3823660982854, 296.9245862918733, 761.4252802722532, 449.30846555040785, 468.48284547901875, 321.9706874150861, 555.4990515143113, 787.4852489275708, 376.49761929571747, 570.8548616570035, 1111.648709629931, 248.02567244770597, 545.8801092434807, 298.3989317324192, 353.7747433869431, 640.9787152336855, 669.9483570540561, 85.17830151897297, 631.8916221972937, 695.1460689269527, 512.1601592835111, 0.0, 113.91039100302316, 754.8418567107523, 282.73866591558266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.462339493599231, "mean_inference_ms": 3.249253756228934, "mean_action_processing_ms": 1.1572145784964751, "mean_env_wait_ms": 9.97656781294591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005462288856506348, "StateBufferConnector_ms": 0.00988459587097168, "ViewRequirementAgentConnector_ms": 0.1343303918838501}, "num_episodes": 14, "episode_return_max": 956.6411084845145, "episode_return_min": 3.6373398753782133, "episode_return_mean": 337.72226413493104, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.50091283434165, "num_env_steps_trained_throughput_per_sec": 83.50091283434165, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 139585.144, "restore_workers_time_ms": 0.015, "training_step_time_ms": 139585.095, "sample_time_ms": 2079.242, "learn_time_ms": 137488.848, "learn_throughput": 29.093, "synch_weights_time_ms": 14.12}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "fed12_00000", "date": "2024-08-21_19-23-43", "timestamp": 1724248423, "time_this_iter_s": 47.95274806022644, "time_total_s": 4747.078554153442, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f725670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4747.078554153442, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 24.50735294117647, "ram_util_percent": 82.68676470588237}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.15860967711797, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.611626155792721, "policy_loss": -0.02106562776961635, "vf_loss": 6.630301967499748, "vf_explained_var": 0.6260854198819115, "kl": 0.011949089042369335, "entropy": 0.5200730539030499, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.341194067619465, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.559454810934723, "policy_loss": -0.01612022286170118, "vf_loss": 6.573497717721121, "vf_explained_var": 0.3186718821525574, "kl": 0.010386517061174369, "entropy": 0.3802315505251052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 956.6411084845145, "episode_reward_min": 3.6373398753782133, "episode_reward_mean": 329.9548979007177, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1391.758937372592, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1328.8177568472042}, "policy_reward_mean": {"prey_policy": -348.09854604039066, "predator_policy": 513.0759949907498}, "custom_metrics": {}, "hist_stats": {"episode_reward": [171.86167186427858, 516.9118288836581, 147.09999999999997, 597.0940633161829, 956.6411084845145, 177.24171544485236, 255.3880359972231, 382.18095655514514, 39.925905594066705, 257.82093823654395, 88.88952430354584, 378.30000000000194, 204.52864570909844, 97.834150512266, 432.2471343192074, 415.2000000000025, 496.30660456471185, 380.4999999999998, 391.40000000000185, 174.29999999999967, 496.9492125805924, 543.2506835499503, 206.8108973084969, 711.0657613753516, 574.3431129991429, 373.74305179519075, 166.51908731678918, 653.2000000000003, 771.1526731136177, 697.0354294432549, 112.55484002812071, 51.89058896848671, 225.80884465909094, 579.5913059387078, 549.8878845342377, 40.5823459768933, 438.3012712522346, 107.13624608130448, 78.11863480182612, 662.1666570814681, 319.6538580386293, 560.2676191008679, 294.43960630205765, 412.5283869895025, 86.15105622276687, 207.78837514324863, 37.113483112399216, 138.26656479142454, 717.0777554480205, 22.94815380244429, 369.924640755024, 210.20286963614268, 80.46130223464137, 399.90000900812896, 29.524517213857944, 331.47769723823797, 252.883883476483, 52.694590608341045, 249.8260935914348, 120.55094313921076, 94.04314501783715, 679.3486594820802, 25.899105825622648, 393.14671557282304, 3.6373398753782133, 322.38497308958716, 304.80599857434885, 170.4612970872278, 349.65658094792843, 95.52694962998305, 674.8212721537075, 69.86695553356583, 70.99181860253313, 498.6850353397697, 449.1502534136426, 724.4713818462694, 109.69999999999985, 767.9770805003715, 362.60000000000014, 573.8293312692516, 57.28626708810155, 468.88878381379675, 500.0447366267715, 665.2202773994717, 52.12585425112409, 623.9802200419183, 68.07617199496292, 641.8771404899326, 286.8947601431727, 406.34672634255855, 433.00000000000296, 172.25880677859007, 284.9999999999998, 59.814978172616186, 253.95167493411836, 68.60000000000036, 394.39331380611634, 680.1058030490618, 459.3801672116445, 181.7779957229655], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-588.3823326042539, -267.9984556645919, -300.79260951848755, -1067.394805866823, -693.882426450675, -186.71614311962497, 21.670353378065343, 263.1276904945091, 339.5462179164227, -884.7347469536035, -382.569419553019, -541.0667447392948, -609.6848683990146, -440.85025756635446, -115.4984470754681, -712.7999451471163, -171.69363456891136, -910.7670142382716, -85.01673109857512, -90.00327357739113, -931.3617280002403, -212.60589784148718, -138.80503132460296, 339.6564989221631, -698.6954048220564, -97.08396099981715, -426.2413265781852, -352.4863098099044, -465.5619040696645, 308.4265251339474, 248.33618865267556, -134.64233284936913, -331.9816403867049, -948.3286438789439, 250.3125929285158, -409.9741504748157, -40.04469940480317, 357.7, -174.46725147789942, -131.7977296349842, -624.7173317274811, 202.13483636928498, 236.65311285377965, -54.38305177759605, -375.4780759155865, -924.2212974442552, -979.1484430796881, 278.84637124354396, -26.804365460158998, -751.4148821743281, -128.74450291529402, -833.203970618893, 97.49018264350332, -528.5487343614924, 354.5717207385407, 35.93700155897028, -880.7760962163012, 312.35459472837965, -527.3734790706548, -32.89504736773376, -574.1405836476835, -340.8291681885059, -736.020690825991, -172.45016944536604, -768.0113336649184, -47.41307272906446, -808.0886178514148, -441.1321533136728, 247.15139776921623, -923.203815142385, -441.6031575446546, -439.71155168984717, 35.69808446551906, -452.569523425257, -427.0237451025148, -34.796674941007225, -426.00519108163326, -472.2724813123435, -762.469481851704, 216.37317652042293, -635.5648749990901, -100.19926642873835, -365.05155571812145, -450.8623794163351, 201.8885924633365, -1097.5660070959152, -318.1590309862396, -75.89364106928048, -750.197655784472, -776.3181765427253, -1084.1363551117372, -587.7243432672993, -989.3885545217936, -0.7640017516061799, -50.76335444525571, -152.1458781635086, 370.2751503827641, -502.93206312136624, -798.5836165496536, -753.4688823984911, -503.30747013680116, 211.4646133175401, -762.4519562385227, -106.4450038202848, -589.3010120912007, -1077.4390564124249, 362.69151349785096, -432.1725379168466, -562.7734754491411, -880.5777596929825, 197.3236098093338, -331.16019527092726, -863.464188176719, 163.2631141161981, -658.9504395644058, -382.149374872737, -864.3322700289336, -332.6630291725881, -241.65418080018472, -531.2430734493161, -140.2922093745795, -275.5235026871247, 169.53167257736635, -787.6234592363854, -967.7666049171121, -1107.26246672398, 255.39008155158564, -474.7362717282072, -748.9112015870638, -303.5436549716184, -734.4382388827347, -115.16198161966648, 150.23273492555953, -703.1402263436804, -90.07996356044438, -475.3658561505349, 110.78294355544396, -777.5101034906811, -520.4040572993242, -1391.758937372592, 312.04066466594196, -782.4016434234516, -231.899140038776, -311.16437520505895, -315.04887851297667, -615.3303993962646, 20.86417583769097, -562.6585690249484, -112.66993740184196, -248.18877278143003, -970.9511171375616, -16.93035570143479, -398.4515414616941, -344.8492677043123, -906.2116033769445, 284.9727632293883, 311.7924347048818, -597.3023308894536, -1116.2781268433273, 32.551513261773295, -251.63831920376987, -749.4252802722526, -622.9159070213689, 174.01337980573544, -689.3070262075485, 311.88202390492324, -820.136317394573, 321.37372657075696, -481.6207158499032, -1148.7570011859057, -558.1180209684189, 388.1924593191502, -209.21146532290803, -374.88603780148827, -755.5914401733315, 86.54150837551256, 184.9164586242, -615.0916221972899, -104.17744650560861, -696.7820553622977, 400.0, -80.91039100302478, -807.8485839951675, -57.473131852576515, 234.8956043418109, -566.6532152706402, -678.5491565967635, -1043.482411070695, -564.3801426769174, -213.57822972177277, 34.87024856842824, -142.9426143022007, 269.6939592770925, -862.4896926615431, -481.65062942760073, 350.6210503853795, -866.1468818464062, -184.07680531910387, -687.5574051324633, -129.32379222846762], "policy_predator_policy_reward": [752.6715325375922, 275.5709275955384, 1051.1500692332395, 833.9491750357282, 697.3824264506748, 330.31614311962625, 250.82964662193444, 61.46637282167377, 746.7487856415, 755.0808518801965, 546.9694195530195, 553.9084601841506, 709.5454324821713, 596.3777294804219, 578.6306415766345, 631.8487072010951, 776.5206923037689, 345.8658620974787, 133.57418302170385, 299.2667598908059, 586.6633966673716, 646.1937534779036, 174.66840593979447, 2.7801264626438043, 608.2587594650282, 392.04925206594436, 448.4080903586827, 428.15369654167625, 393.9107032714397, 195.47180998348455, 92.26381134732442, 209.2423328493681, 896.4247566827182, 880.1921321476441, 112.15305811099854, 428.00849943530375, 73.74469940480341, 0.0, 321.56725147790013, 158.99772963498265, 347.07527071326643, 572.4564372255224, 142.58476712118951, 218.3958553525772, 571.659151465722, 934.8511192026161, 934.3315829817282, 477.0362502297646, 675.7133575132818, 676.849003120345, 498.25263008633283, 837.4388952430423, 18.06598690275278, 579.5116521320268, 0.0, 262.6912777024892, 788.5692686828634, 551.0049059186738, 804.5493739074919, 452.7545819741513, 932.5160488808481, 95.0085429834686, 733.7478825370447, 226.6135667027974, 771.46054192557, 269.7727091275054, 849.6201305546346, 979.19194654916, 613.0133959147234, 612.9269059926812, 267.4748821127545, 654.4221730986457, 483.3699046047295, 371.80280560724253, 384.5556753909087, 184.40099073392167, 492.72382588346096, 483.6724813123445, 567.1144335680724, 641.1485288446731, 445.05835489384486, 610.3596445726072, 898.5889127039138, 477.59264153141083, 92.05101383872095, 1098.0660070959148, 77.97925326543266, 728.6018057795868, 929.4660520174687, 683.2008365324975, 1206.1364204272986, 673.5126530949866, 989.5885545217936, 37.67748486400538, 336.92658156684956, 4.2492158333402275, 404.1796846798964, 445.5549835067265, 805.6016975494177, 769.398955201173, 585.0618723746111, 76.70562519967422, 763.5548258746655, 315.5450038202853, 724.4318745340404, 1022.7694962042304, 0.7451009094175773, 468.6359325177072, 569.6734754491415, 903.2022769068406, 339.5961576935731, 125.71812500625725, 867.0641881767198, 86.02076936028492, 734.7997066284665, 358.9946984170191, 812.3440315982722, 634.477361194688, 402.49579403249, 490.9524033562259, 76.81851938021151, 433.04033769933704, 659.3697983264416, 638.0706478146567, 1275.3509331095322, 825.5772443571786, 417.53367025608765, 194.95923549335777, 754.2736243553618, 301.8185720787061, 455.57557931264694, 716.4096142793383, 180.09653912723562, 677.6169508652351, 407.78941400231554, 328.11770279589166, 258.74216380187926, 757.6415770812862, 678.8721874546945, 1328.8177568472042, 616.8597985095965, 528.3224524016214, 289.91217905758367, 323.01829171982064, 602.1271373004868, 399.2439592112916, 493.0699211118052, 547.409507415218, 551.7700480453913, 258.2389155515224, 849.6338556231699, 862.7189990620961, 507.47940021151675, 345.521408954493, 680.7622345253371, 708.4536861225898, 42.70756529511818, 605.4023308894557, 920.1735787525125, 737.3823660982854, 296.9245862918733, 761.4252802722532, 449.30846555040785, 468.48284547901875, 321.9706874150861, 555.4990515143113, 787.4852489275708, 376.49761929571747, 570.8548616570035, 1111.648709629931, 248.02567244770597, 545.8801092434807, 298.3989317324192, 353.7747433869431, 640.9787152336855, 669.9483570540561, 85.17830151897297, 631.8916221972937, 695.1460689269527, 512.1601592835111, 0.0, 113.91039100302316, 754.8418567107523, 282.73866591558266, 47.30439565818899, 569.4532152706406, 718.3705219923654, 1063.4760238477097, 511.3484759780566, 520.5615713547558, 4.62975143157199, 172.04261430219904, 120.14462304429274, 867.0444241462741, 347.88546430903085, 463.2499177822523, 711.6449638737055, 797.9588905034514, 692.3574051324644, 306.30178795143416]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4561462715327904, "mean_inference_ms": 3.242422514685275, "mean_action_processing_ms": 1.1559479545286988, "mean_env_wait_ms": 9.98348824660378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005438804626464844, "StateBufferConnector_ms": 0.009876251220703125, "ViewRequirementAgentConnector_ms": 0.13854634761810303}, "num_episodes": 8, "episode_return_max": 956.6411084845145, "episode_return_min": 3.6373398753782133, "episode_return_mean": 329.9548979007177, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.9526751023652573, "num_env_steps_trained_throughput_per_sec": 3.9526751023652573, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 235929.06, "restore_workers_time_ms": 0.015, "training_step_time_ms": 235929.011, "sample_time_ms": 2067.156, "learn_time_ms": 233845.296, "learn_throughput": 17.105, "synch_weights_time_ms": 13.673}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "fed12_00000", "date": "2024-08-21_19-40-35", "timestamp": 1724249435, "time_this_iter_s": 1012.0314788818359, "time_total_s": 5759.110033035278, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f73a040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5759.110033035278, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 34.374647887323945, "ram_util_percent": 82.27887323943659}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.934854502652687, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.908917609976713, "policy_loss": -0.018128012292944487, "vf_loss": 6.9243684193444635, "vf_explained_var": 0.5562786406625515, "kl": 0.013386072416755336, "entropy": 0.529980623595929, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.600160954742835, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.732557863911624, "policy_loss": -0.019475539846015633, "vf_loss": 6.749677048536835, "vf_explained_var": 0.3383524187027462, "kl": 0.011781640140778291, "entropy": 0.36814832983824314, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 771.1526731136177, "episode_reward_min": -35.55205377212548, "episode_reward_mean": 303.0664765478, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1391.758937372592, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1328.8177568472042}, "policy_reward_mean": {"prey_policy": -368.52548666262317, "predator_policy": 520.0587249365234}, "custom_metrics": {}, "hist_stats": {"episode_reward": [496.30660456471185, 380.4999999999998, 391.40000000000185, 174.29999999999967, 496.9492125805924, 543.2506835499503, 206.8108973084969, 711.0657613753516, 574.3431129991429, 373.74305179519075, 166.51908731678918, 653.2000000000003, 771.1526731136177, 697.0354294432549, 112.55484002812071, 51.89058896848671, 225.80884465909094, 579.5913059387078, 549.8878845342377, 40.5823459768933, 438.3012712522346, 107.13624608130448, 78.11863480182612, 662.1666570814681, 319.6538580386293, 560.2676191008679, 294.43960630205765, 412.5283869895025, 86.15105622276687, 207.78837514324863, 37.113483112399216, 138.26656479142454, 717.0777554480205, 22.94815380244429, 369.924640755024, 210.20286963614268, 80.46130223464137, 399.90000900812896, 29.524517213857944, 331.47769723823797, 252.883883476483, 52.694590608341045, 249.8260935914348, 120.55094313921076, 94.04314501783715, 679.3486594820802, 25.899105825622648, 393.14671557282304, 3.6373398753782133, 322.38497308958716, 304.80599857434885, 170.4612970872278, 349.65658094792843, 95.52694962998305, 674.8212721537075, 69.86695553356583, 70.99181860253313, 498.6850353397697, 449.1502534136426, 724.4713818462694, 109.69999999999985, 767.9770805003715, 362.60000000000014, 573.8293312692516, 57.28626708810155, 468.88878381379675, 500.0447366267715, 665.2202773994717, 52.12585425112409, 623.9802200419183, 68.07617199496292, 641.8771404899326, 286.8947601431727, 406.34672634255855, 433.00000000000296, 172.25880677859007, 284.9999999999998, 59.814978172616186, 253.95167493411836, 68.60000000000036, 394.39331380611634, 680.1058030490618, 459.3801672116445, 181.7779957229655, 127.61355116666367, 102.28528897807773, 311.9785499609226, 257.6785876042025, 29.937809858841995, 109.90158993099925, 433.05572114622447, 164.90497029817521, 2.361054164778526, 90.82935792587995, 205.186748301643, 215.788429665748, 148.18411288443787, -35.55205377212548, 61.52270387059286, 204.64712194374292], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-331.9816403867049, -948.3286438789439, 250.3125929285158, -409.9741504748157, -40.04469940480317, 357.7, -174.46725147789942, -131.7977296349842, -624.7173317274811, 202.13483636928498, 236.65311285377965, -54.38305177759605, -375.4780759155865, -924.2212974442552, -979.1484430796881, 278.84637124354396, -26.804365460158998, -751.4148821743281, -128.74450291529402, -833.203970618893, 97.49018264350332, -528.5487343614924, 354.5717207385407, 35.93700155897028, -880.7760962163012, 312.35459472837965, -527.3734790706548, -32.89504736773376, -574.1405836476835, -340.8291681885059, -736.020690825991, -172.45016944536604, -768.0113336649184, -47.41307272906446, -808.0886178514148, -441.1321533136728, 247.15139776921623, -923.203815142385, -441.6031575446546, -439.71155168984717, 35.69808446551906, -452.569523425257, -427.0237451025148, -34.796674941007225, -426.00519108163326, -472.2724813123435, -762.469481851704, 216.37317652042293, -635.5648749990901, -100.19926642873835, -365.05155571812145, -450.8623794163351, 201.8885924633365, -1097.5660070959152, -318.1590309862396, -75.89364106928048, -750.197655784472, -776.3181765427253, -1084.1363551117372, -587.7243432672993, -989.3885545217936, -0.7640017516061799, -50.76335444525571, -152.1458781635086, 370.2751503827641, -502.93206312136624, -798.5836165496536, -753.4688823984911, -503.30747013680116, 211.4646133175401, -762.4519562385227, -106.4450038202848, -589.3010120912007, -1077.4390564124249, 362.69151349785096, -432.1725379168466, -562.7734754491411, -880.5777596929825, 197.3236098093338, -331.16019527092726, -863.464188176719, 163.2631141161981, -658.9504395644058, -382.149374872737, -864.3322700289336, -332.6630291725881, -241.65418080018472, -531.2430734493161, -140.2922093745795, -275.5235026871247, 169.53167257736635, -787.6234592363854, -967.7666049171121, -1107.26246672398, 255.39008155158564, -474.7362717282072, -748.9112015870638, -303.5436549716184, -734.4382388827347, -115.16198161966648, 150.23273492555953, -703.1402263436804, -90.07996356044438, -475.3658561505349, 110.78294355544396, -777.5101034906811, -520.4040572993242, -1391.758937372592, 312.04066466594196, -782.4016434234516, -231.899140038776, -311.16437520505895, -315.04887851297667, -615.3303993962646, 20.86417583769097, -562.6585690249484, -112.66993740184196, -248.18877278143003, -970.9511171375616, -16.93035570143479, -398.4515414616941, -344.8492677043123, -906.2116033769445, 284.9727632293883, 311.7924347048818, -597.3023308894536, -1116.2781268433273, 32.551513261773295, -251.63831920376987, -749.4252802722526, -622.9159070213689, 174.01337980573544, -689.3070262075485, 311.88202390492324, -820.136317394573, 321.37372657075696, -481.6207158499032, -1148.7570011859057, -558.1180209684189, 388.1924593191502, -209.21146532290803, -374.88603780148827, -755.5914401733315, 86.54150837551256, 184.9164586242, -615.0916221972899, -104.17744650560861, -696.7820553622977, 400.0, -80.91039100302478, -807.8485839951675, -57.473131852576515, 234.8956043418109, -566.6532152706402, -678.5491565967635, -1043.482411070695, -564.3801426769174, -213.57822972177277, 34.87024856842824, -142.9426143022007, 269.6939592770925, -862.4896926615431, -481.65062942760073, 350.6210503853795, -866.1468818464062, -184.07680531910387, -687.5574051324633, -129.32379222846762, -523.591410315141, -435.21237438561974, -724.273026463031, -524.6683887061391, 7.925037001177799, -682.6049106290907, -873.8736043504266, -87.46528259858792, -391.99760785721645, -503.78268642477525, -527.8905009363198, -183.53728093709495, -249.43492785072976, -716.4385820516026, -562.2601724673342, -134.24674503263418, -697.4165436490131, -509.7623956114873, -165.32217878534155, -631.4979216979679, 6.376937871615951, -737.5214633877733, -563.9063651252252, -379.8727878701413, -935.6915042467822, -774.5695548769612, -36.80104597512646, -630.126593445896, 26.800722698235706, -352.8743586952785, -17.218064229476227, -559.2048213543262], "policy_predator_policy_reward": [896.4247566827182, 880.1921321476441, 112.15305811099854, 428.00849943530375, 73.74469940480341, 0.0, 321.56725147790013, 158.99772963498265, 347.07527071326643, 572.4564372255224, 142.58476712118951, 218.3958553525772, 571.659151465722, 934.8511192026161, 934.3315829817282, 477.0362502297646, 675.7133575132818, 676.849003120345, 498.25263008633283, 837.4388952430423, 18.06598690275278, 579.5116521320268, 0.0, 262.6912777024892, 788.5692686828634, 551.0049059186738, 804.5493739074919, 452.7545819741513, 932.5160488808481, 95.0085429834686, 733.7478825370447, 226.6135667027974, 771.46054192557, 269.7727091275054, 849.6201305546346, 979.19194654916, 613.0133959147234, 612.9269059926812, 267.4748821127545, 654.4221730986457, 483.3699046047295, 371.80280560724253, 384.5556753909087, 184.40099073392167, 492.72382588346096, 483.6724813123445, 567.1144335680724, 641.1485288446731, 445.05835489384486, 610.3596445726072, 898.5889127039138, 477.59264153141083, 92.05101383872095, 1098.0660070959148, 77.97925326543266, 728.6018057795868, 929.4660520174687, 683.2008365324975, 1206.1364204272986, 673.5126530949866, 989.5885545217936, 37.67748486400538, 336.92658156684956, 4.2492158333402275, 404.1796846798964, 445.5549835067265, 805.6016975494177, 769.398955201173, 585.0618723746111, 76.70562519967422, 763.5548258746655, 315.5450038202853, 724.4318745340404, 1022.7694962042304, 0.7451009094175773, 468.6359325177072, 569.6734754491415, 903.2022769068406, 339.5961576935731, 125.71812500625725, 867.0641881767198, 86.02076936028492, 734.7997066284665, 358.9946984170191, 812.3440315982722, 634.477361194688, 402.49579403249, 490.9524033562259, 76.81851938021151, 433.04033769933704, 659.3697983264416, 638.0706478146567, 1275.3509331095322, 825.5772443571786, 417.53367025608765, 194.95923549335777, 754.2736243553618, 301.8185720787061, 455.57557931264694, 716.4096142793383, 180.09653912723562, 677.6169508652351, 407.78941400231554, 328.11770279589166, 258.74216380187926, 757.6415770812862, 678.8721874546945, 1328.8177568472042, 616.8597985095965, 528.3224524016214, 289.91217905758367, 323.01829171982064, 602.1271373004868, 399.2439592112916, 493.0699211118052, 547.409507415218, 551.7700480453913, 258.2389155515224, 849.6338556231699, 862.7189990620961, 507.47940021151675, 345.521408954493, 680.7622345253371, 708.4536861225898, 42.70756529511818, 605.4023308894557, 920.1735787525125, 737.3823660982854, 296.9245862918733, 761.4252802722532, 449.30846555040785, 468.48284547901875, 321.9706874150861, 555.4990515143113, 787.4852489275708, 376.49761929571747, 570.8548616570035, 1111.648709629931, 248.02567244770597, 545.8801092434807, 298.3989317324192, 353.7747433869431, 640.9787152336855, 669.9483570540561, 85.17830151897297, 631.8916221972937, 695.1460689269527, 512.1601592835111, 0.0, 113.91039100302316, 754.8418567107523, 282.73866591558266, 47.30439565818899, 569.4532152706406, 718.3705219923654, 1063.4760238477097, 511.3484759780566, 520.5615713547558, 4.62975143157199, 172.04261430219904, 120.14462304429274, 867.0444241462741, 347.88546430903085, 463.2499177822523, 711.6449638737055, 797.9588905034514, 692.3574051324644, 306.30178795143416, 589.7313229294544, 496.68601293797747, 713.7592553376656, 637.4674488095843, 292.73977575918104, 693.9186478296554, 742.1265469542003, 476.8909275990167, 395.935818181075, 529.7822859597627, 184.5866573429816, 636.7427144614321, 725.0187466418859, 673.910484406672, 117.94252806548236, 743.4693597326615, 698.4165436490133, 511.1234497762658, 265.1985841048327, 622.4508743043584, 632.79921696179, 303.53205685601205, 396.33007515466244, 763.2375075064613, 948.4829553016864, 909.9622167064964, 0.7811797500389153, 630.5944058988581, 376.07841641210723, 11.517923455532564, 209.13901652646572, 571.9309910010795]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4557816591909702, "mean_inference_ms": 3.2465584754771966, "mean_action_processing_ms": 1.1492804293431729, "mean_env_wait_ms": 9.987102960579932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053910017013549805, "StateBufferConnector_ms": 0.009969592094421387, "ViewRequirementAgentConnector_ms": 0.14521360397338867}, "num_episodes": 16, "episode_return_max": 771.1526731136177, "episode_return_min": -35.55205377212548, "episode_return_mean": 303.0664765478, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.03367675095741, "num_env_steps_trained_throughput_per_sec": 81.03367675095741, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 236025.555, "restore_workers_time_ms": 0.015, "training_step_time_ms": 236025.506, "sample_time_ms": 2069.702, "learn_time_ms": 233938.718, "learn_throughput": 17.098, "synch_weights_time_ms": 14.08}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "fed12_00000", "date": "2024-08-21_19-41-25", "timestamp": 1724249485, "time_this_iter_s": 49.431129932403564, "time_total_s": 5808.541162967682, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4cb9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5808.541162967682, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 43.64927536231884, "ram_util_percent": 83.03478260869565}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.70310112042402, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.705008232530463, "policy_loss": -0.01901476767724725, "vf_loss": 6.721679473301721, "vf_explained_var": 0.6302349363685285, "kl": 0.011717587491009561, "entropy": 0.5578212592021498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.800047359643159, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.570750668944505, "policy_loss": -0.016560553758104564, "vf_loss": 6.585265905138046, "vf_explained_var": 0.3409719908048236, "kl": 0.010226565749857516, "entropy": 0.35258394030351486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 782.9990198823649, "episode_reward_min": -35.55205377212548, "episode_reward_mean": 285.5154357939522, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1391.758937372592, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1328.8177568472042}, "policy_reward_mean": {"prey_policy": -384.4056873369227, "predator_policy": 527.1634052338992}, "custom_metrics": {}, "hist_stats": {"episode_reward": [771.1526731136177, 697.0354294432549, 112.55484002812071, 51.89058896848671, 225.80884465909094, 579.5913059387078, 549.8878845342377, 40.5823459768933, 438.3012712522346, 107.13624608130448, 78.11863480182612, 662.1666570814681, 319.6538580386293, 560.2676191008679, 294.43960630205765, 412.5283869895025, 86.15105622276687, 207.78837514324863, 37.113483112399216, 138.26656479142454, 717.0777554480205, 22.94815380244429, 369.924640755024, 210.20286963614268, 80.46130223464137, 399.90000900812896, 29.524517213857944, 331.47769723823797, 252.883883476483, 52.694590608341045, 249.8260935914348, 120.55094313921076, 94.04314501783715, 679.3486594820802, 25.899105825622648, 393.14671557282304, 3.6373398753782133, 322.38497308958716, 304.80599857434885, 170.4612970872278, 349.65658094792843, 95.52694962998305, 674.8212721537075, 69.86695553356583, 70.99181860253313, 498.6850353397697, 449.1502534136426, 724.4713818462694, 109.69999999999985, 767.9770805003715, 362.60000000000014, 573.8293312692516, 57.28626708810155, 468.88878381379675, 500.0447366267715, 665.2202773994717, 52.12585425112409, 623.9802200419183, 68.07617199496292, 641.8771404899326, 286.8947601431727, 406.34672634255855, 433.00000000000296, 172.25880677859007, 284.9999999999998, 59.814978172616186, 253.95167493411836, 68.60000000000036, 394.39331380611634, 680.1058030490618, 459.3801672116445, 181.7779957229655, 127.61355116666367, 102.28528897807773, 311.9785499609226, 257.6785876042025, 29.937809858841995, 109.90158993099925, 433.05572114622447, 164.90497029817521, 2.361054164778526, 90.82935792587995, 205.186748301643, 215.788429665748, 148.18411288443787, -35.55205377212548, 61.52270387059286, 204.64712194374292, 27.584721571133983, 37.45999275445168, 264.69999999999925, 113.1011482114137, 231.78439776956364, 423.28767674125424, 271.79343145941016, 782.9990198823649, 202.88395359839373, 251.7276085135001, 100.19539177912914, 705.7669938248371], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-880.7760962163012, 312.35459472837965, -527.3734790706548, -32.89504736773376, -574.1405836476835, -340.8291681885059, -736.020690825991, -172.45016944536604, -768.0113336649184, -47.41307272906446, -808.0886178514148, -441.1321533136728, 247.15139776921623, -923.203815142385, -441.6031575446546, -439.71155168984717, 35.69808446551906, -452.569523425257, -427.0237451025148, -34.796674941007225, -426.00519108163326, -472.2724813123435, -762.469481851704, 216.37317652042293, -635.5648749990901, -100.19926642873835, -365.05155571812145, -450.8623794163351, 201.8885924633365, -1097.5660070959152, -318.1590309862396, -75.89364106928048, -750.197655784472, -776.3181765427253, -1084.1363551117372, -587.7243432672993, -989.3885545217936, -0.7640017516061799, -50.76335444525571, -152.1458781635086, 370.2751503827641, -502.93206312136624, -798.5836165496536, -753.4688823984911, -503.30747013680116, 211.4646133175401, -762.4519562385227, -106.4450038202848, -589.3010120912007, -1077.4390564124249, 362.69151349785096, -432.1725379168466, -562.7734754491411, -880.5777596929825, 197.3236098093338, -331.16019527092726, -863.464188176719, 163.2631141161981, -658.9504395644058, -382.149374872737, -864.3322700289336, -332.6630291725881, -241.65418080018472, -531.2430734493161, -140.2922093745795, -275.5235026871247, 169.53167257736635, -787.6234592363854, -967.7666049171121, -1107.26246672398, 255.39008155158564, -474.7362717282072, -748.9112015870638, -303.5436549716184, -734.4382388827347, -115.16198161966648, 150.23273492555953, -703.1402263436804, -90.07996356044438, -475.3658561505349, 110.78294355544396, -777.5101034906811, -520.4040572993242, -1391.758937372592, 312.04066466594196, -782.4016434234516, -231.899140038776, -311.16437520505895, -315.04887851297667, -615.3303993962646, 20.86417583769097, -562.6585690249484, -112.66993740184196, -248.18877278143003, -970.9511171375616, -16.93035570143479, -398.4515414616941, -344.8492677043123, -906.2116033769445, 284.9727632293883, 311.7924347048818, -597.3023308894536, -1116.2781268433273, 32.551513261773295, -251.63831920376987, -749.4252802722526, -622.9159070213689, 174.01337980573544, -689.3070262075485, 311.88202390492324, -820.136317394573, 321.37372657075696, -481.6207158499032, -1148.7570011859057, -558.1180209684189, 388.1924593191502, -209.21146532290803, -374.88603780148827, -755.5914401733315, 86.54150837551256, 184.9164586242, -615.0916221972899, -104.17744650560861, -696.7820553622977, 400.0, -80.91039100302478, -807.8485839951675, -57.473131852576515, 234.8956043418109, -566.6532152706402, -678.5491565967635, -1043.482411070695, -564.3801426769174, -213.57822972177277, 34.87024856842824, -142.9426143022007, 269.6939592770925, -862.4896926615431, -481.65062942760073, 350.6210503853795, -866.1468818464062, -184.07680531910387, -687.5574051324633, -129.32379222846762, -523.591410315141, -435.21237438561974, -724.273026463031, -524.6683887061391, 7.925037001177799, -682.6049106290907, -873.8736043504266, -87.46528259858792, -391.99760785721645, -503.78268642477525, -527.8905009363198, -183.53728093709495, -249.43492785072976, -716.4385820516026, -562.2601724673342, -134.24674503263418, -697.4165436490131, -509.7623956114873, -165.32217878534155, -631.4979216979679, 6.376937871615951, -737.5214633877733, -563.9063651252252, -379.8727878701413, -935.6915042467822, -774.5695548769612, -36.80104597512646, -630.126593445896, 26.800722698235706, -352.8743586952785, -17.218064229476227, -559.2048213543262, -731.790372904888, -377.66242717426894, -310.34725755215317, -714.1371638480542, -113.29158247130681, -218.03934512985472, -649.5340921570506, -783.565563712353, -539.3174274804157, -48.069789564913265, 32.25928501206607, -710.0681884291771, -284.4760591553971, -700.7272638381127, 362.89973485215774, -96.32380173451358, -735.4176123888963, -389.8757701430879, -83.67191873005144, -632.2368487849027, 27.890692444768096, -640.5063685905161, -613.723543867179, 324.07959809138833], "policy_predator_policy_reward": [788.5692686828634, 551.0049059186738, 804.5493739074919, 452.7545819741513, 932.5160488808481, 95.0085429834686, 733.7478825370447, 226.6135667027974, 771.46054192557, 269.7727091275054, 849.6201305546346, 979.19194654916, 613.0133959147234, 612.9269059926812, 267.4748821127545, 654.4221730986457, 483.3699046047295, 371.80280560724253, 384.5556753909087, 184.40099073392167, 492.72382588346096, 483.6724813123445, 567.1144335680724, 641.1485288446731, 445.05835489384486, 610.3596445726072, 898.5889127039138, 477.59264153141083, 92.05101383872095, 1098.0660070959148, 77.97925326543266, 728.6018057795868, 929.4660520174687, 683.2008365324975, 1206.1364204272986, 673.5126530949866, 989.5885545217936, 37.67748486400538, 336.92658156684956, 4.2492158333402275, 404.1796846798964, 445.5549835067265, 805.6016975494177, 769.398955201173, 585.0618723746111, 76.70562519967422, 763.5548258746655, 315.5450038202853, 724.4318745340404, 1022.7694962042304, 0.7451009094175773, 468.6359325177072, 569.6734754491415, 903.2022769068406, 339.5961576935731, 125.71812500625725, 867.0641881767198, 86.02076936028492, 734.7997066284665, 358.9946984170191, 812.3440315982722, 634.477361194688, 402.49579403249, 490.9524033562259, 76.81851938021151, 433.04033769933704, 659.3697983264416, 638.0706478146567, 1275.3509331095322, 825.5772443571786, 417.53367025608765, 194.95923549335777, 754.2736243553618, 301.8185720787061, 455.57557931264694, 716.4096142793383, 180.09653912723562, 677.6169508652351, 407.78941400231554, 328.11770279589166, 258.74216380187926, 757.6415770812862, 678.8721874546945, 1328.8177568472042, 616.8597985095965, 528.3224524016214, 289.91217905758367, 323.01829171982064, 602.1271373004868, 399.2439592112916, 493.0699211118052, 547.409507415218, 551.7700480453913, 258.2389155515224, 849.6338556231699, 862.7189990620961, 507.47940021151675, 345.521408954493, 680.7622345253371, 708.4536861225898, 42.70756529511818, 605.4023308894557, 920.1735787525125, 737.3823660982854, 296.9245862918733, 761.4252802722532, 449.30846555040785, 468.48284547901875, 321.9706874150861, 555.4990515143113, 787.4852489275708, 376.49761929571747, 570.8548616570035, 1111.648709629931, 248.02567244770597, 545.8801092434807, 298.3989317324192, 353.7747433869431, 640.9787152336855, 669.9483570540561, 85.17830151897297, 631.8916221972937, 695.1460689269527, 512.1601592835111, 0.0, 113.91039100302316, 754.8418567107523, 282.73866591558266, 47.30439565818899, 569.4532152706406, 718.3705219923654, 1063.4760238477097, 511.3484759780566, 520.5615713547558, 4.62975143157199, 172.04261430219904, 120.14462304429274, 867.0444241462741, 347.88546430903085, 463.2499177822523, 711.6449638737055, 797.9588905034514, 692.3574051324644, 306.30178795143416, 589.7313229294544, 496.68601293797747, 713.7592553376656, 637.4674488095843, 292.73977575918104, 693.9186478296554, 742.1265469542003, 476.8909275990167, 395.935818181075, 529.7822859597627, 184.5866573429816, 636.7427144614321, 725.0187466418859, 673.910484406672, 117.94252806548236, 743.4693597326615, 698.4165436490133, 511.1234497762658, 265.1985841048327, 622.4508743043584, 632.79921696179, 303.53205685601205, 396.33007515466244, 763.2375075064613, 948.4829553016864, 909.9622167064964, 0.7811797500389153, 630.5944058988581, 376.07841641210723, 11.517923455532564, 209.13901652646572, 571.9309910010795, 574.6800722544268, 562.3574493958663, 350.8737336086714, 711.0706805459926, 323.7915824713069, 272.23934512985363, 761.4922269692954, 784.7085771115247, 281.08322257817065, 538.0883922367226, 750.2431305030442, 350.85344965532164, 411.0172254937286, 845.9795289591939, 331.97502142567566, 184.4480653390455, 700.1431510679923, 628.0341850623844, 617.4698167581251, 350.1665592703267, 350.5584646902033, 362.2526032346785, 457.77830322357624, 537.632636377051]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.450922635850231, "mean_inference_ms": 3.251104166901509, "mean_action_processing_ms": 1.1498286878216715, "mean_env_wait_ms": 9.98790450082928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005448460578918457, "StateBufferConnector_ms": 0.009931325912475586, "ViewRequirementAgentConnector_ms": 0.1493741273880005}, "num_episodes": 12, "episode_return_max": 782.9990198823649, "episode_return_min": -35.55205377212548, "episode_return_mean": 285.5154357939522, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.62700250506576, "num_env_steps_trained_throughput_per_sec": 81.62700250506576, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 236054.67, "restore_workers_time_ms": 0.015, "training_step_time_ms": 236054.621, "sample_time_ms": 2093.762, "learn_time_ms": 233943.704, "learn_throughput": 17.098, "synch_weights_time_ms": 14.19}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "fed12_00000", "date": "2024-08-21_19-42-14", "timestamp": 1724249534, "time_this_iter_s": 49.04557728767395, "time_total_s": 5857.586740255356, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f713f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5857.586740255356, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 31.77857142857142, "ram_util_percent": 82.06}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.807383954714215, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.448475926515287, "policy_loss": -0.01781404699782826, "vf_loss": 6.46382619035307, "vf_explained_var": 0.5661034941988647, "kl": 0.012318951009634744, "entropy": 0.5634671772125537, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.03368499808841, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.947367476155518, "policy_loss": -0.014972073216084883, "vf_loss": 5.960439253610278, "vf_explained_var": 0.25142059890681473, "kl": 0.009501493804368669, "entropy": 0.36344596050561423, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 782.9990198823649, "episode_reward_min": -35.55205377212548, "episode_reward_mean": 273.9997914496312, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1391.758937372592, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1328.8177568472042}, "policy_reward_mean": {"prey_policy": -385.33546329857217, "predator_policy": 522.3353590233882}, "custom_metrics": {}, "hist_stats": {"episode_reward": [549.8878845342377, 40.5823459768933, 438.3012712522346, 107.13624608130448, 78.11863480182612, 662.1666570814681, 319.6538580386293, 560.2676191008679, 294.43960630205765, 412.5283869895025, 86.15105622276687, 207.78837514324863, 37.113483112399216, 138.26656479142454, 717.0777554480205, 22.94815380244429, 369.924640755024, 210.20286963614268, 80.46130223464137, 399.90000900812896, 29.524517213857944, 331.47769723823797, 252.883883476483, 52.694590608341045, 249.8260935914348, 120.55094313921076, 94.04314501783715, 679.3486594820802, 25.899105825622648, 393.14671557282304, 3.6373398753782133, 322.38497308958716, 304.80599857434885, 170.4612970872278, 349.65658094792843, 95.52694962998305, 674.8212721537075, 69.86695553356583, 70.99181860253313, 498.6850353397697, 449.1502534136426, 724.4713818462694, 109.69999999999985, 767.9770805003715, 362.60000000000014, 573.8293312692516, 57.28626708810155, 468.88878381379675, 500.0447366267715, 665.2202773994717, 52.12585425112409, 623.9802200419183, 68.07617199496292, 641.8771404899326, 286.8947601431727, 406.34672634255855, 433.00000000000296, 172.25880677859007, 284.9999999999998, 59.814978172616186, 253.95167493411836, 68.60000000000036, 394.39331380611634, 680.1058030490618, 459.3801672116445, 181.7779957229655, 127.61355116666367, 102.28528897807773, 311.9785499609226, 257.6785876042025, 29.937809858841995, 109.90158993099925, 433.05572114622447, 164.90497029817521, 2.361054164778526, 90.82935792587995, 205.186748301643, 215.788429665748, 148.18411288443787, -35.55205377212548, 61.52270387059286, 204.64712194374292, 27.584721571133983, 37.45999275445168, 264.69999999999925, 113.1011482114137, 231.78439776956364, 423.28767674125424, 271.79343145941016, 782.9990198823649, 202.88395359839373, 251.7276085135001, 100.19539177912914, 705.7669938248371, 87.48584125749879, 521.31645034095, 157.2058138969564, 220.64245674834234, 267.5134426534544, 32.30524282198265], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [247.15139776921623, -923.203815142385, -441.6031575446546, -439.71155168984717, 35.69808446551906, -452.569523425257, -427.0237451025148, -34.796674941007225, -426.00519108163326, -472.2724813123435, -762.469481851704, 216.37317652042293, -635.5648749990901, -100.19926642873835, -365.05155571812145, -450.8623794163351, 201.8885924633365, -1097.5660070959152, -318.1590309862396, -75.89364106928048, -750.197655784472, -776.3181765427253, -1084.1363551117372, -587.7243432672993, -989.3885545217936, -0.7640017516061799, -50.76335444525571, -152.1458781635086, 370.2751503827641, -502.93206312136624, -798.5836165496536, -753.4688823984911, -503.30747013680116, 211.4646133175401, -762.4519562385227, -106.4450038202848, -589.3010120912007, -1077.4390564124249, 362.69151349785096, -432.1725379168466, -562.7734754491411, -880.5777596929825, 197.3236098093338, -331.16019527092726, -863.464188176719, 163.2631141161981, -658.9504395644058, -382.149374872737, -864.3322700289336, -332.6630291725881, -241.65418080018472, -531.2430734493161, -140.2922093745795, -275.5235026871247, 169.53167257736635, -787.6234592363854, -967.7666049171121, -1107.26246672398, 255.39008155158564, -474.7362717282072, -748.9112015870638, -303.5436549716184, -734.4382388827347, -115.16198161966648, 150.23273492555953, -703.1402263436804, -90.07996356044438, -475.3658561505349, 110.78294355544396, -777.5101034906811, -520.4040572993242, -1391.758937372592, 312.04066466594196, -782.4016434234516, -231.899140038776, -311.16437520505895, -315.04887851297667, -615.3303993962646, 20.86417583769097, -562.6585690249484, -112.66993740184196, -248.18877278143003, -970.9511171375616, -16.93035570143479, -398.4515414616941, -344.8492677043123, -906.2116033769445, 284.9727632293883, 311.7924347048818, -597.3023308894536, -1116.2781268433273, 32.551513261773295, -251.63831920376987, -749.4252802722526, -622.9159070213689, 174.01337980573544, -689.3070262075485, 311.88202390492324, -820.136317394573, 321.37372657075696, -481.6207158499032, -1148.7570011859057, -558.1180209684189, 388.1924593191502, -209.21146532290803, -374.88603780148827, -755.5914401733315, 86.54150837551256, 184.9164586242, -615.0916221972899, -104.17744650560861, -696.7820553622977, 400.0, -80.91039100302478, -807.8485839951675, -57.473131852576515, 234.8956043418109, -566.6532152706402, -678.5491565967635, -1043.482411070695, -564.3801426769174, -213.57822972177277, 34.87024856842824, -142.9426143022007, 269.6939592770925, -862.4896926615431, -481.65062942760073, 350.6210503853795, -866.1468818464062, -184.07680531910387, -687.5574051324633, -129.32379222846762, -523.591410315141, -435.21237438561974, -724.273026463031, -524.6683887061391, 7.925037001177799, -682.6049106290907, -873.8736043504266, -87.46528259858792, -391.99760785721645, -503.78268642477525, -527.8905009363198, -183.53728093709495, -249.43492785072976, -716.4385820516026, -562.2601724673342, -134.24674503263418, -697.4165436490131, -509.7623956114873, -165.32217878534155, -631.4979216979679, 6.376937871615951, -737.5214633877733, -563.9063651252252, -379.8727878701413, -935.6915042467822, -774.5695548769612, -36.80104597512646, -630.126593445896, 26.800722698235706, -352.8743586952785, -17.218064229476227, -559.2048213543262, -731.790372904888, -377.66242717426894, -310.34725755215317, -714.1371638480542, -113.29158247130681, -218.03934512985472, -649.5340921570506, -783.565563712353, -539.3174274804157, -48.069789564913265, 32.25928501206607, -710.0681884291771, -284.4760591553971, -700.7272638381127, 362.89973485215774, -96.32380173451358, -735.4176123888963, -389.8757701430879, -83.67191873005144, -632.2368487849027, 27.890692444768096, -640.5063685905161, -613.723543867179, 324.07959809138833, -685.9172805594621, -642.0174544291466, -801.6815596794803, 394.2540420328006, -646.9712851727953, -367.81817863039123, 29.993757732131428, -998.6660771897706, -894.9126907893808, 81.22814960347296, -97.68202448073252, -572.5404083600464], "policy_predator_policy_reward": [613.0133959147234, 612.9269059926812, 267.4748821127545, 654.4221730986457, 483.3699046047295, 371.80280560724253, 384.5556753909087, 184.40099073392167, 492.72382588346096, 483.6724813123445, 567.1144335680724, 641.1485288446731, 445.05835489384486, 610.3596445726072, 898.5889127039138, 477.59264153141083, 92.05101383872095, 1098.0660070959148, 77.97925326543266, 728.6018057795868, 929.4660520174687, 683.2008365324975, 1206.1364204272986, 673.5126530949866, 989.5885545217936, 37.67748486400538, 336.92658156684956, 4.2492158333402275, 404.1796846798964, 445.5549835067265, 805.6016975494177, 769.398955201173, 585.0618723746111, 76.70562519967422, 763.5548258746655, 315.5450038202853, 724.4318745340404, 1022.7694962042304, 0.7451009094175773, 468.6359325177072, 569.6734754491415, 903.2022769068406, 339.5961576935731, 125.71812500625725, 867.0641881767198, 86.02076936028492, 734.7997066284665, 358.9946984170191, 812.3440315982722, 634.477361194688, 402.49579403249, 490.9524033562259, 76.81851938021151, 433.04033769933704, 659.3697983264416, 638.0706478146567, 1275.3509331095322, 825.5772443571786, 417.53367025608765, 194.95923549335777, 754.2736243553618, 301.8185720787061, 455.57557931264694, 716.4096142793383, 180.09653912723562, 677.6169508652351, 407.78941400231554, 328.11770279589166, 258.74216380187926, 757.6415770812862, 678.8721874546945, 1328.8177568472042, 616.8597985095965, 528.3224524016214, 289.91217905758367, 323.01829171982064, 602.1271373004868, 399.2439592112916, 493.0699211118052, 547.409507415218, 551.7700480453913, 258.2389155515224, 849.6338556231699, 862.7189990620961, 507.47940021151675, 345.521408954493, 680.7622345253371, 708.4536861225898, 42.70756529511818, 605.4023308894557, 920.1735787525125, 737.3823660982854, 296.9245862918733, 761.4252802722532, 449.30846555040785, 468.48284547901875, 321.9706874150861, 555.4990515143113, 787.4852489275708, 376.49761929571747, 570.8548616570035, 1111.648709629931, 248.02567244770597, 545.8801092434807, 298.3989317324192, 353.7747433869431, 640.9787152336855, 669.9483570540561, 85.17830151897297, 631.8916221972937, 695.1460689269527, 512.1601592835111, 0.0, 113.91039100302316, 754.8418567107523, 282.73866591558266, 47.30439565818899, 569.4532152706406, 718.3705219923654, 1063.4760238477097, 511.3484759780566, 520.5615713547558, 4.62975143157199, 172.04261430219904, 120.14462304429274, 867.0444241462741, 347.88546430903085, 463.2499177822523, 711.6449638737055, 797.9588905034514, 692.3574051324644, 306.30178795143416, 589.7313229294544, 496.68601293797747, 713.7592553376656, 637.4674488095843, 292.73977575918104, 693.9186478296554, 742.1265469542003, 476.8909275990167, 395.935818181075, 529.7822859597627, 184.5866573429816, 636.7427144614321, 725.0187466418859, 673.910484406672, 117.94252806548236, 743.4693597326615, 698.4165436490133, 511.1234497762658, 265.1985841048327, 622.4508743043584, 632.79921696179, 303.53205685601205, 396.33007515466244, 763.2375075064613, 948.4829553016864, 909.9622167064964, 0.7811797500389153, 630.5944058988581, 376.07841641210723, 11.517923455532564, 209.13901652646572, 571.9309910010795, 574.6800722544268, 562.3574493958663, 350.8737336086714, 711.0706805459926, 323.7915824713069, 272.23934512985363, 761.4922269692954, 784.7085771115247, 281.08322257817065, 538.0883922367226, 750.2431305030442, 350.85344965532164, 411.0172254937286, 845.9795289591939, 331.97502142567566, 184.4480653390455, 700.1431510679923, 628.0341850623844, 617.4698167581251, 350.1665592703267, 350.5584646902033, 362.2526032346785, 457.77830322357624, 537.632636377051, 691.3509096665478, 724.0696665795596, 793.2292079563666, 135.5147600312622, 646.5256250525266, 525.4696526476163, 393.14330330349463, 796.1714729024867, 898.9126907893817, 182.28529304998136, 701.3479180016747, 1.179757661087348]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4503060604802296, "mean_inference_ms": 3.2461953670687524, "mean_action_processing_ms": 1.147009379489405, "mean_env_wait_ms": 9.995780411644816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005418539047241211, "StateBufferConnector_ms": 0.010335564613342285, "ViewRequirementAgentConnector_ms": 0.1507505178451538}, "num_episodes": 6, "episode_return_max": 782.9990198823649, "episode_return_min": -35.55205377212548, "episode_return_mean": 273.9997914496312, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.95809006501028, "num_env_steps_trained_throughput_per_sec": 82.95809006501028, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 235964.514, "restore_workers_time_ms": 0.014, "training_step_time_ms": 235964.462, "sample_time_ms": 2108.219, "learn_time_ms": 233839.241, "learn_throughput": 17.106, "synch_weights_time_ms": 14.233}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "fed12_00000", "date": "2024-08-21_19-43-02", "timestamp": 1724249582, "time_this_iter_s": 48.27259016036987, "time_total_s": 5905.859330415726, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4cd700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5905.859330415726, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 24.98382352941177, "ram_util_percent": 81.45882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.54520380913265, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.787540906825393, "policy_loss": -0.019138175273121942, "vf_loss": 6.804416093372163, "vf_explained_var": 0.5591323929173606, "kl": 0.011315039161435038, "entropy": 0.5303405732862533, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999885}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.739921837382846, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.375462465689926, "policy_loss": -0.018909905346667286, "vf_loss": 6.392658956214865, "vf_explained_var": 0.22116487269048338, "kl": 0.008567016194796278, "entropy": 0.34791189781414766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999885}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 782.9990198823649, "episode_reward_min": -35.55205377212548, "episode_reward_mean": 257.73870070993144, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1391.758937372592, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1328.8177568472042}, "policy_reward_mean": {"prey_policy": -387.008126774545, "predator_policy": 515.8774771295111}, "custom_metrics": {}, "hist_stats": {"episode_reward": [412.5283869895025, 86.15105622276687, 207.78837514324863, 37.113483112399216, 138.26656479142454, 717.0777554480205, 22.94815380244429, 369.924640755024, 210.20286963614268, 80.46130223464137, 399.90000900812896, 29.524517213857944, 331.47769723823797, 252.883883476483, 52.694590608341045, 249.8260935914348, 120.55094313921076, 94.04314501783715, 679.3486594820802, 25.899105825622648, 393.14671557282304, 3.6373398753782133, 322.38497308958716, 304.80599857434885, 170.4612970872278, 349.65658094792843, 95.52694962998305, 674.8212721537075, 69.86695553356583, 70.99181860253313, 498.6850353397697, 449.1502534136426, 724.4713818462694, 109.69999999999985, 767.9770805003715, 362.60000000000014, 573.8293312692516, 57.28626708810155, 468.88878381379675, 500.0447366267715, 665.2202773994717, 52.12585425112409, 623.9802200419183, 68.07617199496292, 641.8771404899326, 286.8947601431727, 406.34672634255855, 433.00000000000296, 172.25880677859007, 284.9999999999998, 59.814978172616186, 253.95167493411836, 68.60000000000036, 394.39331380611634, 680.1058030490618, 459.3801672116445, 181.7779957229655, 127.61355116666367, 102.28528897807773, 311.9785499609226, 257.6785876042025, 29.937809858841995, 109.90158993099925, 433.05572114622447, 164.90497029817521, 2.361054164778526, 90.82935792587995, 205.186748301643, 215.788429665748, 148.18411288443787, -35.55205377212548, 61.52270387059286, 204.64712194374292, 27.584721571133983, 37.45999275445168, 264.69999999999925, 113.1011482114137, 231.78439776956364, 423.28767674125424, 271.79343145941016, 782.9990198823649, 202.88395359839373, 251.7276085135001, 100.19539177912914, 705.7669938248371, 87.48584125749879, 521.31645034095, 157.2058138969564, 220.64245674834234, 267.5134426534544, 32.30524282198265, 29.9856897872684, 12.434619719605855, 395.30000000000234, 61.17667022390421, 341.69999999999993, 38.13404303150196, 256.8248658273824, 219.7891606098758, 69.10000000000036], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-318.1590309862396, -75.89364106928048, -750.197655784472, -776.3181765427253, -1084.1363551117372, -587.7243432672993, -989.3885545217936, -0.7640017516061799, -50.76335444525571, -152.1458781635086, 370.2751503827641, -502.93206312136624, -798.5836165496536, -753.4688823984911, -503.30747013680116, 211.4646133175401, -762.4519562385227, -106.4450038202848, -589.3010120912007, -1077.4390564124249, 362.69151349785096, -432.1725379168466, -562.7734754491411, -880.5777596929825, 197.3236098093338, -331.16019527092726, -863.464188176719, 163.2631141161981, -658.9504395644058, -382.149374872737, -864.3322700289336, -332.6630291725881, -241.65418080018472, -531.2430734493161, -140.2922093745795, -275.5235026871247, 169.53167257736635, -787.6234592363854, -967.7666049171121, -1107.26246672398, 255.39008155158564, -474.7362717282072, -748.9112015870638, -303.5436549716184, -734.4382388827347, -115.16198161966648, 150.23273492555953, -703.1402263436804, -90.07996356044438, -475.3658561505349, 110.78294355544396, -777.5101034906811, -520.4040572993242, -1391.758937372592, 312.04066466594196, -782.4016434234516, -231.899140038776, -311.16437520505895, -315.04887851297667, -615.3303993962646, 20.86417583769097, -562.6585690249484, -112.66993740184196, -248.18877278143003, -970.9511171375616, -16.93035570143479, -398.4515414616941, -344.8492677043123, -906.2116033769445, 284.9727632293883, 311.7924347048818, -597.3023308894536, -1116.2781268433273, 32.551513261773295, -251.63831920376987, -749.4252802722526, -622.9159070213689, 174.01337980573544, -689.3070262075485, 311.88202390492324, -820.136317394573, 321.37372657075696, -481.6207158499032, -1148.7570011859057, -558.1180209684189, 388.1924593191502, -209.21146532290803, -374.88603780148827, -755.5914401733315, 86.54150837551256, 184.9164586242, -615.0916221972899, -104.17744650560861, -696.7820553622977, 400.0, -80.91039100302478, -807.8485839951675, -57.473131852576515, 234.8956043418109, -566.6532152706402, -678.5491565967635, -1043.482411070695, -564.3801426769174, -213.57822972177277, 34.87024856842824, -142.9426143022007, 269.6939592770925, -862.4896926615431, -481.65062942760073, 350.6210503853795, -866.1468818464062, -184.07680531910387, -687.5574051324633, -129.32379222846762, -523.591410315141, -435.21237438561974, -724.273026463031, -524.6683887061391, 7.925037001177799, -682.6049106290907, -873.8736043504266, -87.46528259858792, -391.99760785721645, -503.78268642477525, -527.8905009363198, -183.53728093709495, -249.43492785072976, -716.4385820516026, -562.2601724673342, -134.24674503263418, -697.4165436490131, -509.7623956114873, -165.32217878534155, -631.4979216979679, 6.376937871615951, -737.5214633877733, -563.9063651252252, -379.8727878701413, -935.6915042467822, -774.5695548769612, -36.80104597512646, -630.126593445896, 26.800722698235706, -352.8743586952785, -17.218064229476227, -559.2048213543262, -731.790372904888, -377.66242717426894, -310.34725755215317, -714.1371638480542, -113.29158247130681, -218.03934512985472, -649.5340921570506, -783.565563712353, -539.3174274804157, -48.069789564913265, 32.25928501206607, -710.0681884291771, -284.4760591553971, -700.7272638381127, 362.89973485215774, -96.32380173451358, -735.4176123888963, -389.8757701430879, -83.67191873005144, -632.2368487849027, 27.890692444768096, -640.5063685905161, -613.723543867179, 324.07959809138833, -685.9172805594621, -642.0174544291466, -801.6815596794803, 394.2540420328006, -646.9712851727953, -367.81817863039123, 29.993757732131428, -998.6660771897706, -894.9126907893808, 81.22814960347296, -97.68202448073252, -572.5404083600464, -604.3907935820237, -441.1993458100244, -836.0638693414613, -804.8682187453647, -218.03560035915814, 365.15118830756205, -206.79052693829343, -399.26179423564037, -809.7878042582416, 284.24653023501946, -642.7235473611207, -820.1616903954135, -539.9336750300192, 15.503162782940109, -339.2823620485728, -497.06470173055993, -53.850887416961626, -113.80721379829481], "policy_predator_policy_reward": [77.97925326543266, 728.6018057795868, 929.4660520174687, 683.2008365324975, 1206.1364204272986, 673.5126530949866, 989.5885545217936, 37.67748486400538, 336.92658156684956, 4.2492158333402275, 404.1796846798964, 445.5549835067265, 805.6016975494177, 769.398955201173, 585.0618723746111, 76.70562519967422, 763.5548258746655, 315.5450038202853, 724.4318745340404, 1022.7694962042304, 0.7451009094175773, 468.6359325177072, 569.6734754491415, 903.2022769068406, 339.5961576935731, 125.71812500625725, 867.0641881767198, 86.02076936028492, 734.7997066284665, 358.9946984170191, 812.3440315982722, 634.477361194688, 402.49579403249, 490.9524033562259, 76.81851938021151, 433.04033769933704, 659.3697983264416, 638.0706478146567, 1275.3509331095322, 825.5772443571786, 417.53367025608765, 194.95923549335777, 754.2736243553618, 301.8185720787061, 455.57557931264694, 716.4096142793383, 180.09653912723562, 677.6169508652351, 407.78941400231554, 328.11770279589166, 258.74216380187926, 757.6415770812862, 678.8721874546945, 1328.8177568472042, 616.8597985095965, 528.3224524016214, 289.91217905758367, 323.01829171982064, 602.1271373004868, 399.2439592112916, 493.0699211118052, 547.409507415218, 551.7700480453913, 258.2389155515224, 849.6338556231699, 862.7189990620961, 507.47940021151675, 345.521408954493, 680.7622345253371, 708.4536861225898, 42.70756529511818, 605.4023308894557, 920.1735787525125, 737.3823660982854, 296.9245862918733, 761.4252802722532, 449.30846555040785, 468.48284547901875, 321.9706874150861, 555.4990515143113, 787.4852489275708, 376.49761929571747, 570.8548616570035, 1111.648709629931, 248.02567244770597, 545.8801092434807, 298.3989317324192, 353.7747433869431, 640.9787152336855, 669.9483570540561, 85.17830151897297, 631.8916221972937, 695.1460689269527, 512.1601592835111, 0.0, 113.91039100302316, 754.8418567107523, 282.73866591558266, 47.30439565818899, 569.4532152706406, 718.3705219923654, 1063.4760238477097, 511.3484759780566, 520.5615713547558, 4.62975143157199, 172.04261430219904, 120.14462304429274, 867.0444241462741, 347.88546430903085, 463.2499177822523, 711.6449638737055, 797.9588905034514, 692.3574051324644, 306.30178795143416, 589.7313229294544, 496.68601293797747, 713.7592553376656, 637.4674488095843, 292.73977575918104, 693.9186478296554, 742.1265469542003, 476.8909275990167, 395.935818181075, 529.7822859597627, 184.5866573429816, 636.7427144614321, 725.0187466418859, 673.910484406672, 117.94252806548236, 743.4693597326615, 698.4165436490133, 511.1234497762658, 265.1985841048327, 622.4508743043584, 632.79921696179, 303.53205685601205, 396.33007515466244, 763.2375075064613, 948.4829553016864, 909.9622167064964, 0.7811797500389153, 630.5944058988581, 376.07841641210723, 11.517923455532564, 209.13901652646572, 571.9309910010795, 574.6800722544268, 562.3574493958663, 350.8737336086714, 711.0706805459926, 323.7915824713069, 272.23934512985363, 761.4922269692954, 784.7085771115247, 281.08322257817065, 538.0883922367226, 750.2431305030442, 350.85344965532164, 411.0172254937286, 845.9795289591939, 331.97502142567566, 184.4480653390455, 700.1431510679923, 628.0341850623844, 617.4698167581251, 350.1665592703267, 350.5584646902033, 362.2526032346785, 457.77830322357624, 537.632636377051, 691.3509096665478, 724.0696665795596, 793.2292079563666, 135.5147600312622, 646.5256250525266, 525.4696526476163, 393.14330330349463, 796.1714729024867, 898.9126907893817, 182.28529304998136, 701.3479180016747, 1.179757661087348, 607.7401110689611, 467.8357181103599, 848.8326825972956, 804.5340252091362, 241.83560035915679, 6.348811692437952, 381.0499523231239, 286.17903907471594, 810.9878042582418, 56.25346976498059, 650.7068411891091, 850.3124395989288, 77.9685383944223, 703.2868396800369, 465.6567288082739, 590.4794955807375, 93.75088741696058, 143.00721379829315]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.452269129297753, "mean_inference_ms": 3.250200005346222, "mean_action_processing_ms": 1.149934784753497, "mean_env_wait_ms": 9.98254513382933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005296826362609863, "StateBufferConnector_ms": 0.010162353515625, "ViewRequirementAgentConnector_ms": 0.14758086204528809}, "num_episodes": 9, "episode_return_max": 782.9990198823649, "episode_return_min": -35.55205377212548, "episode_return_mean": 257.73870070993144, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 8.660882984510131, "num_env_steps_trained_throughput_per_sec": 8.660882984510131, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 277344.327, "restore_workers_time_ms": 0.014, "training_step_time_ms": 277344.275, "sample_time_ms": 2236.428, "learn_time_ms": 275090.95, "learn_throughput": 14.541, "synch_weights_time_ms": 14.002}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "fed12_00000", "date": "2024-08-21_19-50-44", "timestamp": 1724250044, "time_this_iter_s": 461.88888907432556, "time_total_s": 6367.748219490051, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f73a1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6367.748219490051, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 26.57536231884058, "ram_util_percent": 83.16956521739131}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.93139975815223, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.964720174244472, "policy_loss": -0.02275897027935744, "vf_loss": 6.98385614718079, "vf_explained_var": 0.558886971202477, "kl": 0.018115005126129343, "entropy": 0.5514407543278245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.033514466361392, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.738316194090263, "policy_loss": -0.01790776279183331, "vf_loss": 6.753832648040126, "vf_explained_var": 0.18216402625280714, "kl": 0.01195658744551813, "entropy": 0.31941513319810233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 782.9990198823649, "episode_reward_min": -35.55205377212548, "episode_reward_mean": 252.13536664381525, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1391.758937372592, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1328.8177568472042}, "policy_reward_mean": {"prey_policy": -387.91907982411294, "predator_policy": 513.9867631460211}, "custom_metrics": {}, "hist_stats": {"episode_reward": [369.924640755024, 210.20286963614268, 80.46130223464137, 399.90000900812896, 29.524517213857944, 331.47769723823797, 252.883883476483, 52.694590608341045, 249.8260935914348, 120.55094313921076, 94.04314501783715, 679.3486594820802, 25.899105825622648, 393.14671557282304, 3.6373398753782133, 322.38497308958716, 304.80599857434885, 170.4612970872278, 349.65658094792843, 95.52694962998305, 674.8212721537075, 69.86695553356583, 70.99181860253313, 498.6850353397697, 449.1502534136426, 724.4713818462694, 109.69999999999985, 767.9770805003715, 362.60000000000014, 573.8293312692516, 57.28626708810155, 468.88878381379675, 500.0447366267715, 665.2202773994717, 52.12585425112409, 623.9802200419183, 68.07617199496292, 641.8771404899326, 286.8947601431727, 406.34672634255855, 433.00000000000296, 172.25880677859007, 284.9999999999998, 59.814978172616186, 253.95167493411836, 68.60000000000036, 394.39331380611634, 680.1058030490618, 459.3801672116445, 181.7779957229655, 127.61355116666367, 102.28528897807773, 311.9785499609226, 257.6785876042025, 29.937809858841995, 109.90158993099925, 433.05572114622447, 164.90497029817521, 2.361054164778526, 90.82935792587995, 205.186748301643, 215.788429665748, 148.18411288443787, -35.55205377212548, 61.52270387059286, 204.64712194374292, 27.584721571133983, 37.45999275445168, 264.69999999999925, 113.1011482114137, 231.78439776956364, 423.28767674125424, 271.79343145941016, 782.9990198823649, 202.88395359839373, 251.7276085135001, 100.19539177912914, 705.7669938248371, 87.48584125749879, 521.31645034095, 157.2058138969564, 220.64245674834234, 267.5134426534544, 32.30524282198265, 29.9856897872684, 12.434619719605855, 395.30000000000234, 61.17667022390421, 341.69999999999993, 38.13404303150196, 256.8248658273824, 219.7891606098758, 69.10000000000036, -15.643771028288882, 318.07240362586134, 376.5164591639607, 30.9345653953949, -6.391658613491844, 262.09999999999917, 95.95237035475296], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-503.30747013680116, 211.4646133175401, -762.4519562385227, -106.4450038202848, -589.3010120912007, -1077.4390564124249, 362.69151349785096, -432.1725379168466, -562.7734754491411, -880.5777596929825, 197.3236098093338, -331.16019527092726, -863.464188176719, 163.2631141161981, -658.9504395644058, -382.149374872737, -864.3322700289336, -332.6630291725881, -241.65418080018472, -531.2430734493161, -140.2922093745795, -275.5235026871247, 169.53167257736635, -787.6234592363854, -967.7666049171121, -1107.26246672398, 255.39008155158564, -474.7362717282072, -748.9112015870638, -303.5436549716184, -734.4382388827347, -115.16198161966648, 150.23273492555953, -703.1402263436804, -90.07996356044438, -475.3658561505349, 110.78294355544396, -777.5101034906811, -520.4040572993242, -1391.758937372592, 312.04066466594196, -782.4016434234516, -231.899140038776, -311.16437520505895, -315.04887851297667, -615.3303993962646, 20.86417583769097, -562.6585690249484, -112.66993740184196, -248.18877278143003, -970.9511171375616, -16.93035570143479, -398.4515414616941, -344.8492677043123, -906.2116033769445, 284.9727632293883, 311.7924347048818, -597.3023308894536, -1116.2781268433273, 32.551513261773295, -251.63831920376987, -749.4252802722526, -622.9159070213689, 174.01337980573544, -689.3070262075485, 311.88202390492324, -820.136317394573, 321.37372657075696, -481.6207158499032, -1148.7570011859057, -558.1180209684189, 388.1924593191502, -209.21146532290803, -374.88603780148827, -755.5914401733315, 86.54150837551256, 184.9164586242, -615.0916221972899, -104.17744650560861, -696.7820553622977, 400.0, -80.91039100302478, -807.8485839951675, -57.473131852576515, 234.8956043418109, -566.6532152706402, -678.5491565967635, -1043.482411070695, -564.3801426769174, -213.57822972177277, 34.87024856842824, -142.9426143022007, 269.6939592770925, -862.4896926615431, -481.65062942760073, 350.6210503853795, -866.1468818464062, -184.07680531910387, -687.5574051324633, -129.32379222846762, -523.591410315141, -435.21237438561974, -724.273026463031, -524.6683887061391, 7.925037001177799, -682.6049106290907, -873.8736043504266, -87.46528259858792, -391.99760785721645, -503.78268642477525, -527.8905009363198, -183.53728093709495, -249.43492785072976, -716.4385820516026, -562.2601724673342, -134.24674503263418, -697.4165436490131, -509.7623956114873, -165.32217878534155, -631.4979216979679, 6.376937871615951, -737.5214633877733, -563.9063651252252, -379.8727878701413, -935.6915042467822, -774.5695548769612, -36.80104597512646, -630.126593445896, 26.800722698235706, -352.8743586952785, -17.218064229476227, -559.2048213543262, -731.790372904888, -377.66242717426894, -310.34725755215317, -714.1371638480542, -113.29158247130681, -218.03934512985472, -649.5340921570506, -783.565563712353, -539.3174274804157, -48.069789564913265, 32.25928501206607, -710.0681884291771, -284.4760591553971, -700.7272638381127, 362.89973485215774, -96.32380173451358, -735.4176123888963, -389.8757701430879, -83.67191873005144, -632.2368487849027, 27.890692444768096, -640.5063685905161, -613.723543867179, 324.07959809138833, -685.9172805594621, -642.0174544291466, -801.6815596794803, 394.2540420328006, -646.9712851727953, -367.81817863039123, 29.993757732131428, -998.6660771897706, -894.9126907893808, 81.22814960347296, -97.68202448073252, -572.5404083600464, -604.3907935820237, -441.1993458100244, -836.0638693414613, -804.8682187453647, -218.03560035915814, 365.15118830756205, -206.79052693829343, -399.26179423564037, -809.7878042582416, 284.24653023501946, -642.7235473611207, -820.1616903954135, -539.9336750300192, 15.503162782940109, -339.2823620485728, -497.06470173055993, -53.850887416961626, -113.80721379829481, -284.58129363216227, -395.1564803252438, -157.42917878331434, -937.381353433489, -212.23716164269672, 3.0616165833899345, -408.78714668287995, -701.2678990384774, -1261.295851344196, -785.6626182856797, -54.18766424881261, -115.866817013254, -835.2504703554081, -506.34869504203493], "policy_predator_policy_reward": [585.0618723746111, 76.70562519967422, 763.5548258746655, 315.5450038202853, 724.4318745340404, 1022.7694962042304, 0.7451009094175773, 468.6359325177072, 569.6734754491415, 903.2022769068406, 339.5961576935731, 125.71812500625725, 867.0641881767198, 86.02076936028492, 734.7997066284665, 358.9946984170191, 812.3440315982722, 634.477361194688, 402.49579403249, 490.9524033562259, 76.81851938021151, 433.04033769933704, 659.3697983264416, 638.0706478146567, 1275.3509331095322, 825.5772443571786, 417.53367025608765, 194.95923549335777, 754.2736243553618, 301.8185720787061, 455.57557931264694, 716.4096142793383, 180.09653912723562, 677.6169508652351, 407.78941400231554, 328.11770279589166, 258.74216380187926, 757.6415770812862, 678.8721874546945, 1328.8177568472042, 616.8597985095965, 528.3224524016214, 289.91217905758367, 323.01829171982064, 602.1271373004868, 399.2439592112916, 493.0699211118052, 547.409507415218, 551.7700480453913, 258.2389155515224, 849.6338556231699, 862.7189990620961, 507.47940021151675, 345.521408954493, 680.7622345253371, 708.4536861225898, 42.70756529511818, 605.4023308894557, 920.1735787525125, 737.3823660982854, 296.9245862918733, 761.4252802722532, 449.30846555040785, 468.48284547901875, 321.9706874150861, 555.4990515143113, 787.4852489275708, 376.49761929571747, 570.8548616570035, 1111.648709629931, 248.02567244770597, 545.8801092434807, 298.3989317324192, 353.7747433869431, 640.9787152336855, 669.9483570540561, 85.17830151897297, 631.8916221972937, 695.1460689269527, 512.1601592835111, 0.0, 113.91039100302316, 754.8418567107523, 282.73866591558266, 47.30439565818899, 569.4532152706406, 718.3705219923654, 1063.4760238477097, 511.3484759780566, 520.5615713547558, 4.62975143157199, 172.04261430219904, 120.14462304429274, 867.0444241462741, 347.88546430903085, 463.2499177822523, 711.6449638737055, 797.9588905034514, 692.3574051324644, 306.30178795143416, 589.7313229294544, 496.68601293797747, 713.7592553376656, 637.4674488095843, 292.73977575918104, 693.9186478296554, 742.1265469542003, 476.8909275990167, 395.935818181075, 529.7822859597627, 184.5866573429816, 636.7427144614321, 725.0187466418859, 673.910484406672, 117.94252806548236, 743.4693597326615, 698.4165436490133, 511.1234497762658, 265.1985841048327, 622.4508743043584, 632.79921696179, 303.53205685601205, 396.33007515466244, 763.2375075064613, 948.4829553016864, 909.9622167064964, 0.7811797500389153, 630.5944058988581, 376.07841641210723, 11.517923455532564, 209.13901652646572, 571.9309910010795, 574.6800722544268, 562.3574493958663, 350.8737336086714, 711.0706805459926, 323.7915824713069, 272.23934512985363, 761.4922269692954, 784.7085771115247, 281.08322257817065, 538.0883922367226, 750.2431305030442, 350.85344965532164, 411.0172254937286, 845.9795289591939, 331.97502142567566, 184.4480653390455, 700.1431510679923, 628.0341850623844, 617.4698167581251, 350.1665592703267, 350.5584646902033, 362.2526032346785, 457.77830322357624, 537.632636377051, 691.3509096665478, 724.0696665795596, 793.2292079563666, 135.5147600312622, 646.5256250525266, 525.4696526476163, 393.14330330349463, 796.1714729024867, 898.9126907893817, 182.28529304998136, 701.3479180016747, 1.179757661087348, 607.7401110689611, 467.8357181103599, 848.8326825972956, 804.5340252091362, 241.83560035915679, 6.348811692437952, 381.0499523231239, 286.17903907471594, 810.9878042582418, 56.25346976498059, 650.7068411891091, 850.3124395989288, 77.9685383944223, 703.2868396800369, 465.6567288082739, 590.4794955807375, 93.75088741696058, 143.00721379829315, 531.2691157262686, 132.82488720285224, 663.0172831014137, 749.8656527412478, 244.25484258057097, 341.43716164269836, 319.6871243337509, 821.3024867830077, 1224.2364633277377, 816.330347688647, 285.0876642488128, 147.06681701325223, 690.9554221101538, 746.5961136420432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.450325879545462, "mean_inference_ms": 3.253512907760239, "mean_action_processing_ms": 1.1488494133670182, "mean_env_wait_ms": 9.977821677027642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052640438079833984, "StateBufferConnector_ms": 0.010674595832824707, "ViewRequirementAgentConnector_ms": 0.14843499660491943}, "num_episodes": 7, "episode_return_max": 782.9990198823649, "episode_return_min": -35.55205377212548, "episode_return_mean": 252.13536664381525, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 6.170950509976755, "num_env_steps_trained_throughput_per_sec": 6.170950509976755, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 337337.222, "restore_workers_time_ms": 0.014, "training_step_time_ms": 337337.169, "sample_time_ms": 2320.1, "learn_time_ms": 334999.617, "learn_throughput": 11.94, "synch_weights_time_ms": 14.295}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "fed12_00000", "date": "2024-08-21_20-01-32", "timestamp": 1724250692, "time_this_iter_s": 648.2634081840515, "time_total_s": 7016.011627674103, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f3d2c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7016.011627674103, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 30.187142857142856, "ram_util_percent": 82.55857142857141}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.205916721480232, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.668752001706885, "policy_loss": -0.016184038165882823, "vf_loss": 6.682492407289131, "vf_explained_var": 0.6016618550139129, "kl": 0.012218098315932645, "entropy": 0.5043783115173773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.041628853480022, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.803892589246154, "policy_loss": -0.018455856208253414, "vf_loss": 6.819740643324676, "vf_explained_var": 0.055004913087875126, "kl": 0.013038976280703628, "entropy": 0.3067690414884103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 782.9990198823649, "episode_reward_min": -35.55205377212548, "episode_reward_mean": 253.11649602974126, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1391.758937372592, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1328.8177568472042}, "policy_reward_mean": {"prey_policy": -383.59457896111957, "predator_policy": 510.1528269759905}, "custom_metrics": {}, "hist_stats": {"episode_reward": [679.3486594820802, 25.899105825622648, 393.14671557282304, 3.6373398753782133, 322.38497308958716, 304.80599857434885, 170.4612970872278, 349.65658094792843, 95.52694962998305, 674.8212721537075, 69.86695553356583, 70.99181860253313, 498.6850353397697, 449.1502534136426, 724.4713818462694, 109.69999999999985, 767.9770805003715, 362.60000000000014, 573.8293312692516, 57.28626708810155, 468.88878381379675, 500.0447366267715, 665.2202773994717, 52.12585425112409, 623.9802200419183, 68.07617199496292, 641.8771404899326, 286.8947601431727, 406.34672634255855, 433.00000000000296, 172.25880677859007, 284.9999999999998, 59.814978172616186, 253.95167493411836, 68.60000000000036, 394.39331380611634, 680.1058030490618, 459.3801672116445, 181.7779957229655, 127.61355116666367, 102.28528897807773, 311.9785499609226, 257.6785876042025, 29.937809858841995, 109.90158993099925, 433.05572114622447, 164.90497029817521, 2.361054164778526, 90.82935792587995, 205.186748301643, 215.788429665748, 148.18411288443787, -35.55205377212548, 61.52270387059286, 204.64712194374292, 27.584721571133983, 37.45999275445168, 264.69999999999925, 113.1011482114137, 231.78439776956364, 423.28767674125424, 271.79343145941016, 782.9990198823649, 202.88395359839373, 251.7276085135001, 100.19539177912914, 705.7669938248371, 87.48584125749879, 521.31645034095, 157.2058138969564, 220.64245674834234, 267.5134426534544, 32.30524282198265, 29.9856897872684, 12.434619719605855, 395.30000000000234, 61.17667022390421, 341.69999999999993, 38.13404303150196, 256.8248658273824, 219.7891606098758, 69.10000000000036, -15.643771028288882, 318.07240362586134, 376.5164591639607, 30.9345653953949, -6.391658613491844, 262.09999999999917, 95.95237035475296, 129.7722735235924, 20.599999999999977, 409.0158423462857, 208.25714865393456, 313.6185854677484, 303.0497843767215, 34.49654529072756, 499.9314119846566, 15.049086854745374, 265.61195201352155, 90.20000000000005], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [169.53167257736635, -787.6234592363854, -967.7666049171121, -1107.26246672398, 255.39008155158564, -474.7362717282072, -748.9112015870638, -303.5436549716184, -734.4382388827347, -115.16198161966648, 150.23273492555953, -703.1402263436804, -90.07996356044438, -475.3658561505349, 110.78294355544396, -777.5101034906811, -520.4040572993242, -1391.758937372592, 312.04066466594196, -782.4016434234516, -231.899140038776, -311.16437520505895, -315.04887851297667, -615.3303993962646, 20.86417583769097, -562.6585690249484, -112.66993740184196, -248.18877278143003, -970.9511171375616, -16.93035570143479, -398.4515414616941, -344.8492677043123, -906.2116033769445, 284.9727632293883, 311.7924347048818, -597.3023308894536, -1116.2781268433273, 32.551513261773295, -251.63831920376987, -749.4252802722526, -622.9159070213689, 174.01337980573544, -689.3070262075485, 311.88202390492324, -820.136317394573, 321.37372657075696, -481.6207158499032, -1148.7570011859057, -558.1180209684189, 388.1924593191502, -209.21146532290803, -374.88603780148827, -755.5914401733315, 86.54150837551256, 184.9164586242, -615.0916221972899, -104.17744650560861, -696.7820553622977, 400.0, -80.91039100302478, -807.8485839951675, -57.473131852576515, 234.8956043418109, -566.6532152706402, -678.5491565967635, -1043.482411070695, -564.3801426769174, -213.57822972177277, 34.87024856842824, -142.9426143022007, 269.6939592770925, -862.4896926615431, -481.65062942760073, 350.6210503853795, -866.1468818464062, -184.07680531910387, -687.5574051324633, -129.32379222846762, -523.591410315141, -435.21237438561974, -724.273026463031, -524.6683887061391, 7.925037001177799, -682.6049106290907, -873.8736043504266, -87.46528259858792, -391.99760785721645, -503.78268642477525, -527.8905009363198, -183.53728093709495, -249.43492785072976, -716.4385820516026, -562.2601724673342, -134.24674503263418, -697.4165436490131, -509.7623956114873, -165.32217878534155, -631.4979216979679, 6.376937871615951, -737.5214633877733, -563.9063651252252, -379.8727878701413, -935.6915042467822, -774.5695548769612, -36.80104597512646, -630.126593445896, 26.800722698235706, -352.8743586952785, -17.218064229476227, -559.2048213543262, -731.790372904888, -377.66242717426894, -310.34725755215317, -714.1371638480542, -113.29158247130681, -218.03934512985472, -649.5340921570506, -783.565563712353, -539.3174274804157, -48.069789564913265, 32.25928501206607, -710.0681884291771, -284.4760591553971, -700.7272638381127, 362.89973485215774, -96.32380173451358, -735.4176123888963, -389.8757701430879, -83.67191873005144, -632.2368487849027, 27.890692444768096, -640.5063685905161, -613.723543867179, 324.07959809138833, -685.9172805594621, -642.0174544291466, -801.6815596794803, 394.2540420328006, -646.9712851727953, -367.81817863039123, 29.993757732131428, -998.6660771897706, -894.9126907893808, 81.22814960347296, -97.68202448073252, -572.5404083600464, -604.3907935820237, -441.1993458100244, -836.0638693414613, -804.8682187453647, -218.03560035915814, 365.15118830756205, -206.79052693829343, -399.26179423564037, -809.7878042582416, 284.24653023501946, -642.7235473611207, -820.1616903954135, -539.9336750300192, 15.503162782940109, -339.2823620485728, -497.06470173055993, -53.850887416961626, -113.80721379829481, -284.58129363216227, -395.1564803252438, -157.42917878331434, -937.381353433489, -212.23716164269672, 3.0616165833899345, -408.78714668287995, -701.2678990384774, -1261.295851344196, -785.6626182856797, -54.18766424881261, -115.866817013254, -835.2504703554081, -506.34869504203493, -210.82841865110603, -462.699722823465, -651.2314327489709, -503.84517478378586, 344.2, -262.0401635287094, -350.33907271918383, -620.0925344241884, -386.44782894722965, -1.1957490128757535, -708.4206941939976, -436.062663492694, -773.1306700647533, -247.64588226640552, -51.864235594250125, -310.17481520437155, -86.72793921778799, -744.6346070688787, 217.07919361712908, -322.177690211394, -488.1564198943329, -679.8211905848469], "policy_predator_policy_reward": [659.3697983264416, 638.0706478146567, 1275.3509331095322, 825.5772443571786, 417.53367025608765, 194.95923549335777, 754.2736243553618, 301.8185720787061, 455.57557931264694, 716.4096142793383, 180.09653912723562, 677.6169508652351, 407.78941400231554, 328.11770279589166, 258.74216380187926, 757.6415770812862, 678.8721874546945, 1328.8177568472042, 616.8597985095965, 528.3224524016214, 289.91217905758367, 323.01829171982064, 602.1271373004868, 399.2439592112916, 493.0699211118052, 547.409507415218, 551.7700480453913, 258.2389155515224, 849.6338556231699, 862.7189990620961, 507.47940021151675, 345.521408954493, 680.7622345253371, 708.4536861225898, 42.70756529511818, 605.4023308894557, 920.1735787525125, 737.3823660982854, 296.9245862918733, 761.4252802722532, 449.30846555040785, 468.48284547901875, 321.9706874150861, 555.4990515143113, 787.4852489275708, 376.49761929571747, 570.8548616570035, 1111.648709629931, 248.02567244770597, 545.8801092434807, 298.3989317324192, 353.7747433869431, 640.9787152336855, 669.9483570540561, 85.17830151897297, 631.8916221972937, 695.1460689269527, 512.1601592835111, 0.0, 113.91039100302316, 754.8418567107523, 282.73866591558266, 47.30439565818899, 569.4532152706406, 718.3705219923654, 1063.4760238477097, 511.3484759780566, 520.5615713547558, 4.62975143157199, 172.04261430219904, 120.14462304429274, 867.0444241462741, 347.88546430903085, 463.2499177822523, 711.6449638737055, 797.9588905034514, 692.3574051324644, 306.30178795143416, 589.7313229294544, 496.68601293797747, 713.7592553376656, 637.4674488095843, 292.73977575918104, 693.9186478296554, 742.1265469542003, 476.8909275990167, 395.935818181075, 529.7822859597627, 184.5866573429816, 636.7427144614321, 725.0187466418859, 673.910484406672, 117.94252806548236, 743.4693597326615, 698.4165436490133, 511.1234497762658, 265.1985841048327, 622.4508743043584, 632.79921696179, 303.53205685601205, 396.33007515466244, 763.2375075064613, 948.4829553016864, 909.9622167064964, 0.7811797500389153, 630.5944058988581, 376.07841641210723, 11.517923455532564, 209.13901652646572, 571.9309910010795, 574.6800722544268, 562.3574493958663, 350.8737336086714, 711.0706805459926, 323.7915824713069, 272.23934512985363, 761.4922269692954, 784.7085771115247, 281.08322257817065, 538.0883922367226, 750.2431305030442, 350.85344965532164, 411.0172254937286, 845.9795289591939, 331.97502142567566, 184.4480653390455, 700.1431510679923, 628.0341850623844, 617.4698167581251, 350.1665592703267, 350.5584646902033, 362.2526032346785, 457.77830322357624, 537.632636377051, 691.3509096665478, 724.0696665795596, 793.2292079563666, 135.5147600312622, 646.5256250525266, 525.4696526476163, 393.14330330349463, 796.1714729024867, 898.9126907893817, 182.28529304998136, 701.3479180016747, 1.179757661087348, 607.7401110689611, 467.8357181103599, 848.8326825972956, 804.5340252091362, 241.83560035915679, 6.348811692437952, 381.0499523231239, 286.17903907471594, 810.9878042582418, 56.25346976498059, 650.7068411891091, 850.3124395989288, 77.9685383944223, 703.2868396800369, 465.6567288082739, 590.4794955807375, 93.75088741696058, 143.00721379829315, 531.2691157262686, 132.82488720285224, 663.0172831014137, 749.8656527412478, 244.25484258057097, 341.43716164269836, 319.6871243337509, 821.3024867830077, 1224.2364633277377, 816.330347688647, 285.0876642488128, 147.06681701325223, 690.9554221101538, 746.5961136420432, 147.27423415814908, 656.0261808400185, 661.9314327489714, 513.7451747837866, 130.3597034522237, 196.49630242277308, 460.93339691815305, 717.7553588791588, 381.95122922082015, 319.31093420703445, 606.7125307210702, 840.8206113423435, 747.0381757330259, 308.23492188886314, 396.86160473913264, 465.10885804414403, 77.78124130040163, 768.6303918410096, 31.005897574924788, 339.7045510328622, 451.8548155580264, 806.3227949211545]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.453417412226923, "mean_inference_ms": 3.2671625907892694, "mean_action_processing_ms": 1.153562977354718, "mean_env_wait_ms": 9.976830997265886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005262017250061035, "StateBufferConnector_ms": 0.00544285774230957, "ViewRequirementAgentConnector_ms": 0.1434258222579956}, "num_episodes": 11, "episode_return_max": 782.9990198823649, "episode_return_min": -35.55205377212548, "episode_return_mean": 253.11649602974126, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.78474320629377, "num_env_steps_trained_throughput_per_sec": 80.78474320629377, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 337388.426, "restore_workers_time_ms": 0.014, "training_step_time_ms": 337388.371, "sample_time_ms": 2375.898, "learn_time_ms": 334995.171, "learn_throughput": 11.94, "synch_weights_time_ms": 14.302}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "fed12_00000", "date": "2024-08-21_20-02-22", "timestamp": 1724250742, "time_this_iter_s": 49.564244985580444, "time_total_s": 7065.575872659683, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4cd160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7065.575872659683, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 29.911428571428573, "ram_util_percent": 83.14142857142859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.16240785929261, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.915870629668866, "policy_loss": -0.01927819823151425, "vf_loss": 6.932240900917659, "vf_explained_var": 0.49399232467015586, "kl": 0.014539705487165265, "entropy": 0.5251677903706434, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.756924451848187, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.649756508529501, "policy_loss": -0.016650520294914564, "vf_loss": 6.6640399014508285, "vf_explained_var": 0.18106739978310923, "kl": 0.011835602253660678, "entropy": 0.32765079907797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 782.9990198823649, "episode_reward_min": -35.55205377212548, "episode_reward_mean": 243.3663260387967, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1261.295851344196, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1224.2364633277377}, "policy_reward_mean": {"prey_policy": -373.8216013928218, "predator_policy": 495.5047644122206}, "custom_metrics": {}, "hist_stats": {"episode_reward": [449.1502534136426, 724.4713818462694, 109.69999999999985, 767.9770805003715, 362.60000000000014, 573.8293312692516, 57.28626708810155, 468.88878381379675, 500.0447366267715, 665.2202773994717, 52.12585425112409, 623.9802200419183, 68.07617199496292, 641.8771404899326, 286.8947601431727, 406.34672634255855, 433.00000000000296, 172.25880677859007, 284.9999999999998, 59.814978172616186, 253.95167493411836, 68.60000000000036, 394.39331380611634, 680.1058030490618, 459.3801672116445, 181.7779957229655, 127.61355116666367, 102.28528897807773, 311.9785499609226, 257.6785876042025, 29.937809858841995, 109.90158993099925, 433.05572114622447, 164.90497029817521, 2.361054164778526, 90.82935792587995, 205.186748301643, 215.788429665748, 148.18411288443787, -35.55205377212548, 61.52270387059286, 204.64712194374292, 27.584721571133983, 37.45999275445168, 264.69999999999925, 113.1011482114137, 231.78439776956364, 423.28767674125424, 271.79343145941016, 782.9990198823649, 202.88395359839373, 251.7276085135001, 100.19539177912914, 705.7669938248371, 87.48584125749879, 521.31645034095, 157.2058138969564, 220.64245674834234, 267.5134426534544, 32.30524282198265, 29.9856897872684, 12.434619719605855, 395.30000000000234, 61.17667022390421, 341.69999999999993, 38.13404303150196, 256.8248658273824, 219.7891606098758, 69.10000000000036, -15.643771028288882, 318.07240362586134, 376.5164591639607, 30.9345653953949, -6.391658613491844, 262.09999999999917, 95.95237035475296, 129.7722735235924, 20.599999999999977, 409.0158423462857, 208.25714865393456, 313.6185854677484, 303.0497843767215, 34.49654529072756, 499.9314119846566, 15.049086854745374, 265.61195201352155, 90.20000000000005, 86.02326862381882, 46.60000000000031, 151.20442392885772, 337.4580298644354, 141.39999999999912, 349.72142963224576, -3.5990414098886996, 242.26348155589906, 300.34575254649644, 255.4656324201453, 32.082724397035314, 39.80000000000013, 705.4500010610608], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-112.66993740184196, -248.18877278143003, -970.9511171375616, -16.93035570143479, -398.4515414616941, -344.8492677043123, -906.2116033769445, 284.9727632293883, 311.7924347048818, -597.3023308894536, -1116.2781268433273, 32.551513261773295, -251.63831920376987, -749.4252802722526, -622.9159070213689, 174.01337980573544, -689.3070262075485, 311.88202390492324, -820.136317394573, 321.37372657075696, -481.6207158499032, -1148.7570011859057, -558.1180209684189, 388.1924593191502, -209.21146532290803, -374.88603780148827, -755.5914401733315, 86.54150837551256, 184.9164586242, -615.0916221972899, -104.17744650560861, -696.7820553622977, 400.0, -80.91039100302478, -807.8485839951675, -57.473131852576515, 234.8956043418109, -566.6532152706402, -678.5491565967635, -1043.482411070695, -564.3801426769174, -213.57822972177277, 34.87024856842824, -142.9426143022007, 269.6939592770925, -862.4896926615431, -481.65062942760073, 350.6210503853795, -866.1468818464062, -184.07680531910387, -687.5574051324633, -129.32379222846762, -523.591410315141, -435.21237438561974, -724.273026463031, -524.6683887061391, 7.925037001177799, -682.6049106290907, -873.8736043504266, -87.46528259858792, -391.99760785721645, -503.78268642477525, -527.8905009363198, -183.53728093709495, -249.43492785072976, -716.4385820516026, -562.2601724673342, -134.24674503263418, -697.4165436490131, -509.7623956114873, -165.32217878534155, -631.4979216979679, 6.376937871615951, -737.5214633877733, -563.9063651252252, -379.8727878701413, -935.6915042467822, -774.5695548769612, -36.80104597512646, -630.126593445896, 26.800722698235706, -352.8743586952785, -17.218064229476227, -559.2048213543262, -731.790372904888, -377.66242717426894, -310.34725755215317, -714.1371638480542, -113.29158247130681, -218.03934512985472, -649.5340921570506, -783.565563712353, -539.3174274804157, -48.069789564913265, 32.25928501206607, -710.0681884291771, -284.4760591553971, -700.7272638381127, 362.89973485215774, -96.32380173451358, -735.4176123888963, -389.8757701430879, -83.67191873005144, -632.2368487849027, 27.890692444768096, -640.5063685905161, -613.723543867179, 324.07959809138833, -685.9172805594621, -642.0174544291466, -801.6815596794803, 394.2540420328006, -646.9712851727953, -367.81817863039123, 29.993757732131428, -998.6660771897706, -894.9126907893808, 81.22814960347296, -97.68202448073252, -572.5404083600464, -604.3907935820237, -441.1993458100244, -836.0638693414613, -804.8682187453647, -218.03560035915814, 365.15118830756205, -206.79052693829343, -399.26179423564037, -809.7878042582416, 284.24653023501946, -642.7235473611207, -820.1616903954135, -539.9336750300192, 15.503162782940109, -339.2823620485728, -497.06470173055993, -53.850887416961626, -113.80721379829481, -284.58129363216227, -395.1564803252438, -157.42917878331434, -937.381353433489, -212.23716164269672, 3.0616165833899345, -408.78714668287995, -701.2678990384774, -1261.295851344196, -785.6626182856797, -54.18766424881261, -115.866817013254, -835.2504703554081, -506.34869504203493, -210.82841865110603, -462.699722823465, -651.2314327489709, -503.84517478378586, 344.2, -262.0401635287094, -350.33907271918383, -620.0925344241884, -386.44782894722965, -1.1957490128757535, -708.4206941939976, -436.062663492694, -773.1306700647533, -247.64588226640552, -51.864235594250125, -310.17481520437155, -86.72793921778799, -744.6346070688787, 217.07919361712908, -322.177690211394, -488.1564198943329, -679.8211905848469, -28.11192399333524, -411.75238554066027, 19.249948407695584, -903.1768441841563, -652.6350435980801, -286.18895774255344, 289.59323819726325, -738.8873144905344, -509.18371276496265, -130.89947195833957, -516.5885343532711, -58.73888564516639, -775.8712673576503, -533.3220753562854, -398.61061372952446, -820.6281862570005, -337.0558945456896, -322.5141746901679, -518.2537837855567, 125.87839595489265, -440.0201317125585, -542.5570903273701, -466.4279176451793, -323.0494505379237, -83.60218050234096, 320.58601544609417], "policy_predator_policy_reward": [551.7700480453913, 258.2389155515224, 849.6338556231699, 862.7189990620961, 507.47940021151675, 345.521408954493, 680.7622345253371, 708.4536861225898, 42.70756529511818, 605.4023308894557, 920.1735787525125, 737.3823660982854, 296.9245862918733, 761.4252802722532, 449.30846555040785, 468.48284547901875, 321.9706874150861, 555.4990515143113, 787.4852489275708, 376.49761929571747, 570.8548616570035, 1111.648709629931, 248.02567244770597, 545.8801092434807, 298.3989317324192, 353.7747433869431, 640.9787152336855, 669.9483570540561, 85.17830151897297, 631.8916221972937, 695.1460689269527, 512.1601592835111, 0.0, 113.91039100302316, 754.8418567107523, 282.73866591558266, 47.30439565818899, 569.4532152706406, 718.3705219923654, 1063.4760238477097, 511.3484759780566, 520.5615713547558, 4.62975143157199, 172.04261430219904, 120.14462304429274, 867.0444241462741, 347.88546430903085, 463.2499177822523, 711.6449638737055, 797.9588905034514, 692.3574051324644, 306.30178795143416, 589.7313229294544, 496.68601293797747, 713.7592553376656, 637.4674488095843, 292.73977575918104, 693.9186478296554, 742.1265469542003, 476.8909275990167, 395.935818181075, 529.7822859597627, 184.5866573429816, 636.7427144614321, 725.0187466418859, 673.910484406672, 117.94252806548236, 743.4693597326615, 698.4165436490133, 511.1234497762658, 265.1985841048327, 622.4508743043584, 632.79921696179, 303.53205685601205, 396.33007515466244, 763.2375075064613, 948.4829553016864, 909.9622167064964, 0.7811797500389153, 630.5944058988581, 376.07841641210723, 11.517923455532564, 209.13901652646572, 571.9309910010795, 574.6800722544268, 562.3574493958663, 350.8737336086714, 711.0706805459926, 323.7915824713069, 272.23934512985363, 761.4922269692954, 784.7085771115247, 281.08322257817065, 538.0883922367226, 750.2431305030442, 350.85344965532164, 411.0172254937286, 845.9795289591939, 331.97502142567566, 184.4480653390455, 700.1431510679923, 628.0341850623844, 617.4698167581251, 350.1665592703267, 350.5584646902033, 362.2526032346785, 457.77830322357624, 537.632636377051, 691.3509096665478, 724.0696665795596, 793.2292079563666, 135.5147600312622, 646.5256250525266, 525.4696526476163, 393.14330330349463, 796.1714729024867, 898.9126907893817, 182.28529304998136, 701.3479180016747, 1.179757661087348, 607.7401110689611, 467.8357181103599, 848.8326825972956, 804.5340252091362, 241.83560035915679, 6.348811692437952, 381.0499523231239, 286.17903907471594, 810.9878042582418, 56.25346976498059, 650.7068411891091, 850.3124395989288, 77.9685383944223, 703.2868396800369, 465.6567288082739, 590.4794955807375, 93.75088741696058, 143.00721379829315, 531.2691157262686, 132.82488720285224, 663.0172831014137, 749.8656527412478, 244.25484258057097, 341.43716164269836, 319.6871243337509, 821.3024867830077, 1224.2364633277377, 816.330347688647, 285.0876642488128, 147.06681701325223, 690.9554221101538, 746.5961136420432, 147.27423415814908, 656.0261808400185, 661.9314327489714, 513.7451747837866, 130.3597034522237, 196.49630242277308, 460.93339691815305, 717.7553588791588, 381.95122922082015, 319.31093420703445, 606.7125307210702, 840.8206113423435, 747.0381757330259, 308.23492188886314, 396.86160473913264, 465.10885804414403, 77.78124130040163, 768.6303918410096, 31.005897574924788, 339.7045510328622, 451.8548155580264, 806.3227949211545, 367.2521598325597, 158.63541832525559, 19.050051592304424, 911.4768441841576, 614.2916355178228, 475.7367897516685, 38.764791667172254, 747.9873144905342, 519.8837127649633, 261.5994719583392, 493.34037622718824, 431.7084734034971, 428.8795541967709, 876.7147471072818, 744.1770007290404, 717.3252808133872, 356.64619165766504, 603.2696301246934, 537.7488635320374, 110.09215671877426, 456.30285610959436, 558.3570903273711, 489.0279176451796, 340.24945053792715, 276.3378360879892, 192.12833002931825]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4607008518176854, "mean_inference_ms": 3.2726377890202283, "mean_action_processing_ms": 1.157892562193705, "mean_env_wait_ms": 9.976241659309098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003691554069519043, "StateBufferConnector_ms": 0.005107522010803223, "ViewRequirementAgentConnector_ms": 0.12059688568115234}, "num_episodes": 13, "episode_return_max": 782.9990198823649, "episode_return_min": -35.55205377212548, "episode_return_mean": 243.3663260387967, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.90830966849799, "num_env_steps_trained_throughput_per_sec": 81.90830966849799, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 337262.791, "restore_workers_time_ms": 0.014, "training_step_time_ms": 337262.736, "sample_time_ms": 2390.208, "learn_time_ms": 334854.759, "learn_throughput": 11.945, "synch_weights_time_ms": 14.465}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "fed12_00000", "date": "2024-08-21_20-03-11", "timestamp": 1724250791, "time_this_iter_s": 48.891704082489014, "time_total_s": 7114.467576742172, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f3d2ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7114.467576742172, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 26.175362318840577, "ram_util_percent": 82.99420289855071}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.22525003360062, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.888391585072513, "policy_loss": -0.020129345080115532, "vf_loss": 6.905360859664029, "vf_explained_var": 0.5258620883737292, "kl": 0.015800376285715078, "entropy": 0.5155605001424356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.858053473568468, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.804896671809847, "policy_loss": -0.01947446931929638, "vf_loss": 6.821818595462375, "vf_explained_var": 0.23812265724101395, "kl": 0.012762655343776618, "entropy": 0.34121703505516054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 782.9990198823649, "episode_reward_min": -35.55205377212548, "episode_reward_mean": 216.71377877060382, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1295.4635811089663, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1295.5635811089662}, "policy_reward_mean": {"prey_policy": -384.3510068866968, "predator_policy": 492.70789627199935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [68.07617199496292, 641.8771404899326, 286.8947601431727, 406.34672634255855, 433.00000000000296, 172.25880677859007, 284.9999999999998, 59.814978172616186, 253.95167493411836, 68.60000000000036, 394.39331380611634, 680.1058030490618, 459.3801672116445, 181.7779957229655, 127.61355116666367, 102.28528897807773, 311.9785499609226, 257.6785876042025, 29.937809858841995, 109.90158993099925, 433.05572114622447, 164.90497029817521, 2.361054164778526, 90.82935792587995, 205.186748301643, 215.788429665748, 148.18411288443787, -35.55205377212548, 61.52270387059286, 204.64712194374292, 27.584721571133983, 37.45999275445168, 264.69999999999925, 113.1011482114137, 231.78439776956364, 423.28767674125424, 271.79343145941016, 782.9990198823649, 202.88395359839373, 251.7276085135001, 100.19539177912914, 705.7669938248371, 87.48584125749879, 521.31645034095, 157.2058138969564, 220.64245674834234, 267.5134426534544, 32.30524282198265, 29.9856897872684, 12.434619719605855, 395.30000000000234, 61.17667022390421, 341.69999999999993, 38.13404303150196, 256.8248658273824, 219.7891606098758, 69.10000000000036, -15.643771028288882, 318.07240362586134, 376.5164591639607, 30.9345653953949, -6.391658613491844, 262.09999999999917, 95.95237035475296, 129.7722735235924, 20.599999999999977, 409.0158423462857, 208.25714865393456, 313.6185854677484, 303.0497843767215, 34.49654529072756, 499.9314119846566, 15.049086854745374, 265.61195201352155, 90.20000000000005, 86.02326862381882, 46.60000000000031, 151.20442392885772, 337.4580298644354, 141.39999999999912, 349.72142963224576, -3.5990414098886996, 242.26348155589906, 300.34575254649644, 255.4656324201453, 32.082724397035314, 39.80000000000013, 705.4500010610608, 515.2098778849494, 40.41099626081159, 174.29999999999956, 626.1002222570014, 333.2848410154144, 167.27966794874837, 52.39918464573651, 4.724246348735784, 376.22342672291165, 177.64104667090945, 196.16406799826063, 26.28188167795458], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-209.21146532290803, -374.88603780148827, -755.5914401733315, 86.54150837551256, 184.9164586242, -615.0916221972899, -104.17744650560861, -696.7820553622977, 400.0, -80.91039100302478, -807.8485839951675, -57.473131852576515, 234.8956043418109, -566.6532152706402, -678.5491565967635, -1043.482411070695, -564.3801426769174, -213.57822972177277, 34.87024856842824, -142.9426143022007, 269.6939592770925, -862.4896926615431, -481.65062942760073, 350.6210503853795, -866.1468818464062, -184.07680531910387, -687.5574051324633, -129.32379222846762, -523.591410315141, -435.21237438561974, -724.273026463031, -524.6683887061391, 7.925037001177799, -682.6049106290907, -873.8736043504266, -87.46528259858792, -391.99760785721645, -503.78268642477525, -527.8905009363198, -183.53728093709495, -249.43492785072976, -716.4385820516026, -562.2601724673342, -134.24674503263418, -697.4165436490131, -509.7623956114873, -165.32217878534155, -631.4979216979679, 6.376937871615951, -737.5214633877733, -563.9063651252252, -379.8727878701413, -935.6915042467822, -774.5695548769612, -36.80104597512646, -630.126593445896, 26.800722698235706, -352.8743586952785, -17.218064229476227, -559.2048213543262, -731.790372904888, -377.66242717426894, -310.34725755215317, -714.1371638480542, -113.29158247130681, -218.03934512985472, -649.5340921570506, -783.565563712353, -539.3174274804157, -48.069789564913265, 32.25928501206607, -710.0681884291771, -284.4760591553971, -700.7272638381127, 362.89973485215774, -96.32380173451358, -735.4176123888963, -389.8757701430879, -83.67191873005144, -632.2368487849027, 27.890692444768096, -640.5063685905161, -613.723543867179, 324.07959809138833, -685.9172805594621, -642.0174544291466, -801.6815596794803, 394.2540420328006, -646.9712851727953, -367.81817863039123, 29.993757732131428, -998.6660771897706, -894.9126907893808, 81.22814960347296, -97.68202448073252, -572.5404083600464, -604.3907935820237, -441.1993458100244, -836.0638693414613, -804.8682187453647, -218.03560035915814, 365.15118830756205, -206.79052693829343, -399.26179423564037, -809.7878042582416, 284.24653023501946, -642.7235473611207, -820.1616903954135, -539.9336750300192, 15.503162782940109, -339.2823620485728, -497.06470173055993, -53.850887416961626, -113.80721379829481, -284.58129363216227, -395.1564803252438, -157.42917878331434, -937.381353433489, -212.23716164269672, 3.0616165833899345, -408.78714668287995, -701.2678990384774, -1261.295851344196, -785.6626182856797, -54.18766424881261, -115.866817013254, -835.2504703554081, -506.34869504203493, -210.82841865110603, -462.699722823465, -651.2314327489709, -503.84517478378586, 344.2, -262.0401635287094, -350.33907271918383, -620.0925344241884, -386.44782894722965, -1.1957490128757535, -708.4206941939976, -436.062663492694, -773.1306700647533, -247.64588226640552, -51.864235594250125, -310.17481520437155, -86.72793921778799, -744.6346070688787, 217.07919361712908, -322.177690211394, -488.1564198943329, -679.8211905848469, -28.11192399333524, -411.75238554066027, 19.249948407695584, -903.1768441841563, -652.6350435980801, -286.18895774255344, 289.59323819726325, -738.8873144905344, -509.18371276496265, -130.89947195833957, -516.5885343532711, -58.73888564516639, -775.8712673576503, -533.3220753562854, -398.61061372952446, -820.6281862570005, -337.0558945456896, -322.5141746901679, -518.2537837855567, 125.87839595489265, -440.0201317125585, -542.5570903273701, -466.4279176451793, -323.0494505379237, -83.60218050234096, 320.58601544609417, 333.12504703368205, -783.7186226577766, -422.92794807107975, -649.4974755100195, -408.64777085328274, -46.42489768685937, 80.1844517166945, -932.113716845326, 314.42300229156035, -1295.4635811089663, -530.516986189, -308.64147764527485, -399.6787189742195, -882.6738010813294, -604.4465148084358, -723.4726248237536, -349.4014972544292, -386.90689836294865, -446.0935895869828, -534.2876719865509, 23.59730894403263, -609.5904410033581, -213.45833930215048, -538.2216756143625], "policy_predator_policy_reward": [298.3989317324192, 353.7747433869431, 640.9787152336855, 669.9483570540561, 85.17830151897297, 631.8916221972937, 695.1460689269527, 512.1601592835111, 0.0, 113.91039100302316, 754.8418567107523, 282.73866591558266, 47.30439565818899, 569.4532152706406, 718.3705219923654, 1063.4760238477097, 511.3484759780566, 520.5615713547558, 4.62975143157199, 172.04261430219904, 120.14462304429274, 867.0444241462741, 347.88546430903085, 463.2499177822523, 711.6449638737055, 797.9588905034514, 692.3574051324644, 306.30178795143416, 589.7313229294544, 496.68601293797747, 713.7592553376656, 637.4674488095843, 292.73977575918104, 693.9186478296554, 742.1265469542003, 476.8909275990167, 395.935818181075, 529.7822859597627, 184.5866573429816, 636.7427144614321, 725.0187466418859, 673.910484406672, 117.94252806548236, 743.4693597326615, 698.4165436490133, 511.1234497762658, 265.1985841048327, 622.4508743043584, 632.79921696179, 303.53205685601205, 396.33007515466244, 763.2375075064613, 948.4829553016864, 909.9622167064964, 0.7811797500389153, 630.5944058988581, 376.07841641210723, 11.517923455532564, 209.13901652646572, 571.9309910010795, 574.6800722544268, 562.3574493958663, 350.8737336086714, 711.0706805459926, 323.7915824713069, 272.23934512985363, 761.4922269692954, 784.7085771115247, 281.08322257817065, 538.0883922367226, 750.2431305030442, 350.85344965532164, 411.0172254937286, 845.9795289591939, 331.97502142567566, 184.4480653390455, 700.1431510679923, 628.0341850623844, 617.4698167581251, 350.1665592703267, 350.5584646902033, 362.2526032346785, 457.77830322357624, 537.632636377051, 691.3509096665478, 724.0696665795596, 793.2292079563666, 135.5147600312622, 646.5256250525266, 525.4696526476163, 393.14330330349463, 796.1714729024867, 898.9126907893817, 182.28529304998136, 701.3479180016747, 1.179757661087348, 607.7401110689611, 467.8357181103599, 848.8326825972956, 804.5340252091362, 241.83560035915679, 6.348811692437952, 381.0499523231239, 286.17903907471594, 810.9878042582418, 56.25346976498059, 650.7068411891091, 850.3124395989288, 77.9685383944223, 703.2868396800369, 465.6567288082739, 590.4794955807375, 93.75088741696058, 143.00721379829315, 531.2691157262686, 132.82488720285224, 663.0172831014137, 749.8656527412478, 244.25484258057097, 341.43716164269836, 319.6871243337509, 821.3024867830077, 1224.2364633277377, 816.330347688647, 285.0876642488128, 147.06681701325223, 690.9554221101538, 746.5961136420432, 147.27423415814908, 656.0261808400185, 661.9314327489714, 513.7451747837866, 130.3597034522237, 196.49630242277308, 460.93339691815305, 717.7553588791588, 381.95122922082015, 319.31093420703445, 606.7125307210702, 840.8206113423435, 747.0381757330259, 308.23492188886314, 396.86160473913264, 465.10885804414403, 77.78124130040163, 768.6303918410096, 31.005897574924788, 339.7045510328622, 451.8548155580264, 806.3227949211545, 367.2521598325597, 158.63541832525559, 19.050051592304424, 911.4768441841576, 614.2916355178228, 475.7367897516685, 38.764791667172254, 747.9873144905342, 519.8837127649633, 261.5994719583392, 493.34037622718824, 431.7084734034971, 428.8795541967709, 876.7147471072818, 744.1770007290404, 717.3252808133872, 356.64619165766504, 603.2696301246934, 537.7488635320374, 110.09215671877426, 456.30285610959436, 558.3570903273711, 489.0279176451796, 340.24945053792715, 276.3378360879892, 192.12833002931825, 510.7922197569258, 455.01123375211824, 635.8450322749142, 476.9913875670019, 548.6477708532834, 80.72489768685867, 758.2580813042866, 719.7714060813485, 18.761838723853998, 1295.5635811089662, 403.6420491276399, 602.7960826553946, 1042.3587822467182, 292.3929224545725, 606.7707611571716, 725.8726248237541, 516.8423000219688, 595.6895223183262, 466.6028154329243, 691.4194928115197, 403.5390036320207, 378.61819642556605, 17.45664878397534, 760.5052478104917]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4668898280183362, "mean_inference_ms": 3.282510668567156, "mean_action_processing_ms": 1.1606936437951243, "mean_env_wait_ms": 9.974109153433957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004717469215393066, "StateBufferConnector_ms": 0.005345344543457031, "ViewRequirementAgentConnector_ms": 0.11985230445861816}, "num_episodes": 12, "episode_return_max": 782.9990198823649, "episode_return_min": -35.55205377212548, "episode_return_mean": 216.71377877060382, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.180392134675796, "num_env_steps_trained_throughput_per_sec": 4.180392134675796, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 337170.179, "restore_workers_time_ms": 0.013, "training_step_time_ms": 337170.125, "sample_time_ms": 2343.255, "learn_time_ms": 334809.131, "learn_throughput": 11.947, "synch_weights_time_ms": 14.581}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "fed12_00000", "date": "2024-08-21_20-19-08", "timestamp": 1724251748, "time_this_iter_s": 956.9124753475189, "time_total_s": 8071.380052089691, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f5d2670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8071.380052089691, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 31.800000000000008, "ram_util_percent": 82.7619718309859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.947790468495988, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.9554475837283665, "policy_loss": -0.018167709537027846, "vf_loss": 6.971017473715323, "vf_explained_var": 0.49619255624120195, "kl": 0.0129891713600724, "entropy": 0.5379073918654175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.903420475109545, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.8939338610916545, "policy_loss": -0.021761854980559773, "vf_loss": 6.913151799055634, "vf_explained_var": 0.1722706831006146, "kl": 0.01271957080705318, "entropy": 0.35465507821115866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 782.9990198823649, "episode_reward_min": -35.55205377212548, "episode_reward_mean": 208.77875941958416, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1350.2791970866872, "predator_policy": 0.7811797500389153}, "policy_reward_max": {"prey_policy": 394.2540420328006, "predator_policy": 1353.0791970866871}, "policy_reward_mean": {"prey_policy": -393.9618252348237, "predator_policy": 498.35120494461654}, "custom_metrics": {}, "hist_stats": {"episode_reward": [68.60000000000036, 394.39331380611634, 680.1058030490618, 459.3801672116445, 181.7779957229655, 127.61355116666367, 102.28528897807773, 311.9785499609226, 257.6785876042025, 29.937809858841995, 109.90158993099925, 433.05572114622447, 164.90497029817521, 2.361054164778526, 90.82935792587995, 205.186748301643, 215.788429665748, 148.18411288443787, -35.55205377212548, 61.52270387059286, 204.64712194374292, 27.584721571133983, 37.45999275445168, 264.69999999999925, 113.1011482114137, 231.78439776956364, 423.28767674125424, 271.79343145941016, 782.9990198823649, 202.88395359839373, 251.7276085135001, 100.19539177912914, 705.7669938248371, 87.48584125749879, 521.31645034095, 157.2058138969564, 220.64245674834234, 267.5134426534544, 32.30524282198265, 29.9856897872684, 12.434619719605855, 395.30000000000234, 61.17667022390421, 341.69999999999993, 38.13404303150196, 256.8248658273824, 219.7891606098758, 69.10000000000036, -15.643771028288882, 318.07240362586134, 376.5164591639607, 30.9345653953949, -6.391658613491844, 262.09999999999917, 95.95237035475296, 129.7722735235924, 20.599999999999977, 409.0158423462857, 208.25714865393456, 313.6185854677484, 303.0497843767215, 34.49654529072756, 499.9314119846566, 15.049086854745374, 265.61195201352155, 90.20000000000005, 86.02326862381882, 46.60000000000031, 151.20442392885772, 337.4580298644354, 141.39999999999912, 349.72142963224576, -3.5990414098886996, 242.26348155589906, 300.34575254649644, 255.4656324201453, 32.082724397035314, 39.80000000000013, 705.4500010610608, 515.2098778849494, 40.41099626081159, 174.29999999999956, 626.1002222570014, 333.2848410154144, 167.27966794874837, 52.39918464573651, 4.724246348735784, 376.22342672291165, 177.64104667090945, 196.16406799826063, 26.28188167795458, 252.48736288020035, 193.05186434997788, -12.25426925407946, 492.19504751458544, 366.8813224377411, 133.62599069997543, 27.09999999999998, 277.5, 83.13100512558754], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [34.87024856842824, -142.9426143022007, 269.6939592770925, -862.4896926615431, -481.65062942760073, 350.6210503853795, -866.1468818464062, -184.07680531910387, -687.5574051324633, -129.32379222846762, -523.591410315141, -435.21237438561974, -724.273026463031, -524.6683887061391, 7.925037001177799, -682.6049106290907, -873.8736043504266, -87.46528259858792, -391.99760785721645, -503.78268642477525, -527.8905009363198, -183.53728093709495, -249.43492785072976, -716.4385820516026, -562.2601724673342, -134.24674503263418, -697.4165436490131, -509.7623956114873, -165.32217878534155, -631.4979216979679, 6.376937871615951, -737.5214633877733, -563.9063651252252, -379.8727878701413, -935.6915042467822, -774.5695548769612, -36.80104597512646, -630.126593445896, 26.800722698235706, -352.8743586952785, -17.218064229476227, -559.2048213543262, -731.790372904888, -377.66242717426894, -310.34725755215317, -714.1371638480542, -113.29158247130681, -218.03934512985472, -649.5340921570506, -783.565563712353, -539.3174274804157, -48.069789564913265, 32.25928501206607, -710.0681884291771, -284.4760591553971, -700.7272638381127, 362.89973485215774, -96.32380173451358, -735.4176123888963, -389.8757701430879, -83.67191873005144, -632.2368487849027, 27.890692444768096, -640.5063685905161, -613.723543867179, 324.07959809138833, -685.9172805594621, -642.0174544291466, -801.6815596794803, 394.2540420328006, -646.9712851727953, -367.81817863039123, 29.993757732131428, -998.6660771897706, -894.9126907893808, 81.22814960347296, -97.68202448073252, -572.5404083600464, -604.3907935820237, -441.1993458100244, -836.0638693414613, -804.8682187453647, -218.03560035915814, 365.15118830756205, -206.79052693829343, -399.26179423564037, -809.7878042582416, 284.24653023501946, -642.7235473611207, -820.1616903954135, -539.9336750300192, 15.503162782940109, -339.2823620485728, -497.06470173055993, -53.850887416961626, -113.80721379829481, -284.58129363216227, -395.1564803252438, -157.42917878331434, -937.381353433489, -212.23716164269672, 3.0616165833899345, -408.78714668287995, -701.2678990384774, -1261.295851344196, -785.6626182856797, -54.18766424881261, -115.866817013254, -835.2504703554081, -506.34869504203493, -210.82841865110603, -462.699722823465, -651.2314327489709, -503.84517478378586, 344.2, -262.0401635287094, -350.33907271918383, -620.0925344241884, -386.44782894722965, -1.1957490128757535, -708.4206941939976, -436.062663492694, -773.1306700647533, -247.64588226640552, -51.864235594250125, -310.17481520437155, -86.72793921778799, -744.6346070688787, 217.07919361712908, -322.177690211394, -488.1564198943329, -679.8211905848469, -28.11192399333524, -411.75238554066027, 19.249948407695584, -903.1768441841563, -652.6350435980801, -286.18895774255344, 289.59323819726325, -738.8873144905344, -509.18371276496265, -130.89947195833957, -516.5885343532711, -58.73888564516639, -775.8712673576503, -533.3220753562854, -398.61061372952446, -820.6281862570005, -337.0558945456896, -322.5141746901679, -518.2537837855567, 125.87839595489265, -440.0201317125585, -542.5570903273701, -466.4279176451793, -323.0494505379237, -83.60218050234096, 320.58601544609417, 333.12504703368205, -783.7186226577766, -422.92794807107975, -649.4974755100195, -408.64777085328274, -46.42489768685937, 80.1844517166945, -932.113716845326, 314.42300229156035, -1295.4635811089663, -530.516986189, -308.64147764527485, -399.6787189742195, -882.6738010813294, -604.4465148084358, -723.4726248237536, -349.4014972544292, -386.90689836294865, -446.0935895869828, -534.2876719865509, 23.59730894403263, -609.5904410033581, -213.45833930215048, -538.2216756143625, -649.4748821700646, -147.68909113259753, 145.43869556402498, -124.54446751509334, -723.6444581111111, -602.1383462611926, -751.1901747370628, 317.54732269544326, -499.41033575904964, 208.38954070888548, -343.80796554358034, -497.6569945184733, -682.0095861079958, -1350.2791970866872, 6.878796755625672, -1054.077055195423, -620.540553148239, -416.21667627176095], "policy_predator_policy_reward": [4.62975143157199, 172.04261430219904, 120.14462304429274, 867.0444241462741, 347.88546430903085, 463.2499177822523, 711.6449638737055, 797.9588905034514, 692.3574051324644, 306.30178795143416, 589.7313229294544, 496.68601293797747, 713.7592553376656, 637.4674488095843, 292.73977575918104, 693.9186478296554, 742.1265469542003, 476.8909275990167, 395.935818181075, 529.7822859597627, 184.5866573429816, 636.7427144614321, 725.0187466418859, 673.910484406672, 117.94252806548236, 743.4693597326615, 698.4165436490133, 511.1234497762658, 265.1985841048327, 622.4508743043584, 632.79921696179, 303.53205685601205, 396.33007515466244, 763.2375075064613, 948.4829553016864, 909.9622167064964, 0.7811797500389153, 630.5944058988581, 376.07841641210723, 11.517923455532564, 209.13901652646572, 571.9309910010795, 574.6800722544268, 562.3574493958663, 350.8737336086714, 711.0706805459926, 323.7915824713069, 272.23934512985363, 761.4922269692954, 784.7085771115247, 281.08322257817065, 538.0883922367226, 750.2431305030442, 350.85344965532164, 411.0172254937286, 845.9795289591939, 331.97502142567566, 184.4480653390455, 700.1431510679923, 628.0341850623844, 617.4698167581251, 350.1665592703267, 350.5584646902033, 362.2526032346785, 457.77830322357624, 537.632636377051, 691.3509096665478, 724.0696665795596, 793.2292079563666, 135.5147600312622, 646.5256250525266, 525.4696526476163, 393.14330330349463, 796.1714729024867, 898.9126907893817, 182.28529304998136, 701.3479180016747, 1.179757661087348, 607.7401110689611, 467.8357181103599, 848.8326825972956, 804.5340252091362, 241.83560035915679, 6.348811692437952, 381.0499523231239, 286.17903907471594, 810.9878042582418, 56.25346976498059, 650.7068411891091, 850.3124395989288, 77.9685383944223, 703.2868396800369, 465.6567288082739, 590.4794955807375, 93.75088741696058, 143.00721379829315, 531.2691157262686, 132.82488720285224, 663.0172831014137, 749.8656527412478, 244.25484258057097, 341.43716164269836, 319.6871243337509, 821.3024867830077, 1224.2364633277377, 816.330347688647, 285.0876642488128, 147.06681701325223, 690.9554221101538, 746.5961136420432, 147.27423415814908, 656.0261808400185, 661.9314327489714, 513.7451747837866, 130.3597034522237, 196.49630242277308, 460.93339691815305, 717.7553588791588, 381.95122922082015, 319.31093420703445, 606.7125307210702, 840.8206113423435, 747.0381757330259, 308.23492188886314, 396.86160473913264, 465.10885804414403, 77.78124130040163, 768.6303918410096, 31.005897574924788, 339.7045510328622, 451.8548155580264, 806.3227949211545, 367.2521598325597, 158.63541832525559, 19.050051592304424, 911.4768441841576, 614.2916355178228, 475.7367897516685, 38.764791667172254, 747.9873144905342, 519.8837127649633, 261.5994719583392, 493.34037622718824, 431.7084734034971, 428.8795541967709, 876.7147471072818, 744.1770007290404, 717.3252808133872, 356.64619165766504, 603.2696301246934, 537.7488635320374, 110.09215671877426, 456.30285610959436, 558.3570903273711, 489.0279176451796, 340.24945053792715, 276.3378360879892, 192.12833002931825, 510.7922197569258, 455.01123375211824, 635.8450322749142, 476.9913875670019, 548.6477708532834, 80.72489768685867, 758.2580813042866, 719.7714060813485, 18.761838723853998, 1295.5635811089662, 403.6420491276399, 602.7960826553946, 1042.3587822467182, 292.3929224545725, 606.7707611571716, 725.8726248237541, 516.8423000219688, 595.6895223183262, 466.6028154329243, 691.4194928115197, 403.5390036320207, 378.61819642556605, 17.45664878397534, 760.5052478104917, 510.57376155733857, 539.077574625524, 19.047750270053463, 153.10988603099273, 743.6012293167113, 569.9273058015124, 306.83272704820934, 619.0051725079987, 335.17766593678886, 322.7244515511171, 415.8994816293097, 559.1914691327205, 706.3095861079959, 1353.0791970866871, 270.52120324437556, 1054.177055195423, 631.3763005959786, 488.5119339496109]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4665614572554886, "mean_inference_ms": 3.2919054394599185, "mean_action_processing_ms": 1.1656388921393488, "mean_env_wait_ms": 9.967876426137794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048133134841918945, "StateBufferConnector_ms": 0.005376577377319336, "ViewRequirementAgentConnector_ms": 0.1208113431930542}, "num_episodes": 9, "episode_return_max": 782.9990198823649, "episode_return_min": -35.55205377212548, "episode_return_mean": 208.77875941958416, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.15823876260389, "num_env_steps_trained_throughput_per_sec": 83.15823876260389, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 337189.919, "restore_workers_time_ms": 0.013, "training_step_time_ms": 337189.864, "sample_time_ms": 2349.304, "learn_time_ms": 334822.454, "learn_throughput": 11.947, "synch_weights_time_ms": 14.493}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "fed12_00000", "date": "2024-08-21_20-19-56", "timestamp": 1724251796, "time_this_iter_s": 48.15995383262634, "time_total_s": 8119.5400059223175, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f7134c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8119.5400059223175, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 24.573529411764703, "ram_util_percent": 82.75735294117646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.957131421755232, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.116593872302424, "policy_loss": -0.01695288860204595, "vf_loss": 7.131270630902083, "vf_explained_var": 0.39725242815320455, "kl": 0.011380668388921078, "entropy": 0.50594291534058, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.963959774264582, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.709403236833199, "policy_loss": -0.02108172093697937, "vf_loss": 6.728197178764948, "vf_explained_var": 0.10811201349768058, "kl": 0.011439026113126485, "entropy": 0.3235647005694253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 782.9990198823649, "episode_reward_min": -35.55205377212548, "episode_reward_mean": 197.38203795508795, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1350.2791970866872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 394.2540420328006, "predator_policy": 1353.0791970866871}, "policy_reward_mean": {"prey_policy": -396.51593601394853, "predator_policy": 495.2069549914931}, "custom_metrics": {}, "hist_stats": {"episode_reward": [433.05572114622447, 164.90497029817521, 2.361054164778526, 90.82935792587995, 205.186748301643, 215.788429665748, 148.18411288443787, -35.55205377212548, 61.52270387059286, 204.64712194374292, 27.584721571133983, 37.45999275445168, 264.69999999999925, 113.1011482114137, 231.78439776956364, 423.28767674125424, 271.79343145941016, 782.9990198823649, 202.88395359839373, 251.7276085135001, 100.19539177912914, 705.7669938248371, 87.48584125749879, 521.31645034095, 157.2058138969564, 220.64245674834234, 267.5134426534544, 32.30524282198265, 29.9856897872684, 12.434619719605855, 395.30000000000234, 61.17667022390421, 341.69999999999993, 38.13404303150196, 256.8248658273824, 219.7891606098758, 69.10000000000036, -15.643771028288882, 318.07240362586134, 376.5164591639607, 30.9345653953949, -6.391658613491844, 262.09999999999917, 95.95237035475296, 129.7722735235924, 20.599999999999977, 409.0158423462857, 208.25714865393456, 313.6185854677484, 303.0497843767215, 34.49654529072756, 499.9314119846566, 15.049086854745374, 265.61195201352155, 90.20000000000005, 86.02326862381882, 46.60000000000031, 151.20442392885772, 337.4580298644354, 141.39999999999912, 349.72142963224576, -3.5990414098886996, 242.26348155589906, 300.34575254649644, 255.4656324201453, 32.082724397035314, 39.80000000000013, 705.4500010610608, 515.2098778849494, 40.41099626081159, 174.29999999999956, 626.1002222570014, 333.2848410154144, 167.27966794874837, 52.39918464573651, 4.724246348735784, 376.22342672291165, 177.64104667090945, 196.16406799826063, 26.28188167795458, 252.48736288020035, 193.05186434997788, -12.25426925407946, 492.19504751458544, 366.8813224377411, 133.62599069997543, 27.09999999999998, 277.5, 83.13100512558754, 4.1230030425394695, 15.00079410542924, 276.40000000000003, 10.699999999999985, 230.1999999999998, 211.9229828534196, 251.81671417407406, 168.69336349005442, 6.623653174349594, 6.199999999999992, 402.3000000000021], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-249.43492785072976, -716.4385820516026, -562.2601724673342, -134.24674503263418, -697.4165436490131, -509.7623956114873, -165.32217878534155, -631.4979216979679, 6.376937871615951, -737.5214633877733, -563.9063651252252, -379.8727878701413, -935.6915042467822, -774.5695548769612, -36.80104597512646, -630.126593445896, 26.800722698235706, -352.8743586952785, -17.218064229476227, -559.2048213543262, -731.790372904888, -377.66242717426894, -310.34725755215317, -714.1371638480542, -113.29158247130681, -218.03934512985472, -649.5340921570506, -783.565563712353, -539.3174274804157, -48.069789564913265, 32.25928501206607, -710.0681884291771, -284.4760591553971, -700.7272638381127, 362.89973485215774, -96.32380173451358, -735.4176123888963, -389.8757701430879, -83.67191873005144, -632.2368487849027, 27.890692444768096, -640.5063685905161, -613.723543867179, 324.07959809138833, -685.9172805594621, -642.0174544291466, -801.6815596794803, 394.2540420328006, -646.9712851727953, -367.81817863039123, 29.993757732131428, -998.6660771897706, -894.9126907893808, 81.22814960347296, -97.68202448073252, -572.5404083600464, -604.3907935820237, -441.1993458100244, -836.0638693414613, -804.8682187453647, -218.03560035915814, 365.15118830756205, -206.79052693829343, -399.26179423564037, -809.7878042582416, 284.24653023501946, -642.7235473611207, -820.1616903954135, -539.9336750300192, 15.503162782940109, -339.2823620485728, -497.06470173055993, -53.850887416961626, -113.80721379829481, -284.58129363216227, -395.1564803252438, -157.42917878331434, -937.381353433489, -212.23716164269672, 3.0616165833899345, -408.78714668287995, -701.2678990384774, -1261.295851344196, -785.6626182856797, -54.18766424881261, -115.866817013254, -835.2504703554081, -506.34869504203493, -210.82841865110603, -462.699722823465, -651.2314327489709, -503.84517478378586, 344.2, -262.0401635287094, -350.33907271918383, -620.0925344241884, -386.44782894722965, -1.1957490128757535, -708.4206941939976, -436.062663492694, -773.1306700647533, -247.64588226640552, -51.864235594250125, -310.17481520437155, -86.72793921778799, -744.6346070688787, 217.07919361712908, -322.177690211394, -488.1564198943329, -679.8211905848469, -28.11192399333524, -411.75238554066027, 19.249948407695584, -903.1768441841563, -652.6350435980801, -286.18895774255344, 289.59323819726325, -738.8873144905344, -509.18371276496265, -130.89947195833957, -516.5885343532711, -58.73888564516639, -775.8712673576503, -533.3220753562854, -398.61061372952446, -820.6281862570005, -337.0558945456896, -322.5141746901679, -518.2537837855567, 125.87839595489265, -440.0201317125585, -542.5570903273701, -466.4279176451793, -323.0494505379237, -83.60218050234096, 320.58601544609417, 333.12504703368205, -783.7186226577766, -422.92794807107975, -649.4974755100195, -408.64777085328274, -46.42489768685937, 80.1844517166945, -932.113716845326, 314.42300229156035, -1295.4635811089663, -530.516986189, -308.64147764527485, -399.6787189742195, -882.6738010813294, -604.4465148084358, -723.4726248237536, -349.4014972544292, -386.90689836294865, -446.0935895869828, -534.2876719865509, 23.59730894403263, -609.5904410033581, -213.45833930215048, -538.2216756143625, -649.4748821700646, -147.68909113259753, 145.43869556402498, -124.54446751509334, -723.6444581111111, -602.1383462611926, -751.1901747370628, 317.54732269544326, -499.41033575904964, 208.38954070888548, -343.80796554358034, -497.6569945184733, -682.0095861079958, -1350.2791970866872, 6.878796755625672, -1054.077055195423, -620.540553148239, -416.21667627176095, -446.5916156946586, -879.6347387678666, -500.6392197301709, -619.6265853985132, -503.29678052344354, 84.6982956695791, -727.0008264652803, -624.0644402093085, -521.6394426038304, 48.92893439590455, -171.82747218817764, -416.6524534844396, -372.5191651558304, -275.5891923631267, -611.3198857660992, -260.0922352499262, -398.28766554586196, -569.5586755640038, -614.3374599865897, -634.3460577661871, 343.15836924702927, 9.441558036704173], "policy_predator_policy_reward": [725.0187466418859, 673.910484406672, 117.94252806548236, 743.4693597326615, 698.4165436490133, 511.1234497762658, 265.1985841048327, 622.4508743043584, 632.79921696179, 303.53205685601205, 396.33007515466244, 763.2375075064613, 948.4829553016864, 909.9622167064964, 0.7811797500389153, 630.5944058988581, 376.07841641210723, 11.517923455532564, 209.13901652646572, 571.9309910010795, 574.6800722544268, 562.3574493958663, 350.8737336086714, 711.0706805459926, 323.7915824713069, 272.23934512985363, 761.4922269692954, 784.7085771115247, 281.08322257817065, 538.0883922367226, 750.2431305030442, 350.85344965532164, 411.0172254937286, 845.9795289591939, 331.97502142567566, 184.4480653390455, 700.1431510679923, 628.0341850623844, 617.4698167581251, 350.1665592703267, 350.5584646902033, 362.2526032346785, 457.77830322357624, 537.632636377051, 691.3509096665478, 724.0696665795596, 793.2292079563666, 135.5147600312622, 646.5256250525266, 525.4696526476163, 393.14330330349463, 796.1714729024867, 898.9126907893817, 182.28529304998136, 701.3479180016747, 1.179757661087348, 607.7401110689611, 467.8357181103599, 848.8326825972956, 804.5340252091362, 241.83560035915679, 6.348811692437952, 381.0499523231239, 286.17903907471594, 810.9878042582418, 56.25346976498059, 650.7068411891091, 850.3124395989288, 77.9685383944223, 703.2868396800369, 465.6567288082739, 590.4794955807375, 93.75088741696058, 143.00721379829315, 531.2691157262686, 132.82488720285224, 663.0172831014137, 749.8656527412478, 244.25484258057097, 341.43716164269836, 319.6871243337509, 821.3024867830077, 1224.2364633277377, 816.330347688647, 285.0876642488128, 147.06681701325223, 690.9554221101538, 746.5961136420432, 147.27423415814908, 656.0261808400185, 661.9314327489714, 513.7451747837866, 130.3597034522237, 196.49630242277308, 460.93339691815305, 717.7553588791588, 381.95122922082015, 319.31093420703445, 606.7125307210702, 840.8206113423435, 747.0381757330259, 308.23492188886314, 396.86160473913264, 465.10885804414403, 77.78124130040163, 768.6303918410096, 31.005897574924788, 339.7045510328622, 451.8548155580264, 806.3227949211545, 367.2521598325597, 158.63541832525559, 19.050051592304424, 911.4768441841576, 614.2916355178228, 475.7367897516685, 38.764791667172254, 747.9873144905342, 519.8837127649633, 261.5994719583392, 493.34037622718824, 431.7084734034971, 428.8795541967709, 876.7147471072818, 744.1770007290404, 717.3252808133872, 356.64619165766504, 603.2696301246934, 537.7488635320374, 110.09215671877426, 456.30285610959436, 558.3570903273711, 489.0279176451796, 340.24945053792715, 276.3378360879892, 192.12833002931825, 510.7922197569258, 455.01123375211824, 635.8450322749142, 476.9913875670019, 548.6477708532834, 80.72489768685867, 758.2580813042866, 719.7714060813485, 18.761838723853998, 1295.5635811089662, 403.6420491276399, 602.7960826553946, 1042.3587822467182, 292.3929224545725, 606.7707611571716, 725.8726248237541, 516.8423000219688, 595.6895223183262, 466.6028154329243, 691.4194928115197, 403.5390036320207, 378.61819642556605, 17.45664878397534, 760.5052478104917, 510.57376155733857, 539.077574625524, 19.047750270053463, 153.10988603099273, 743.6012293167113, 569.9273058015124, 306.83272704820934, 619.0051725079987, 335.17766593678886, 322.7244515511171, 415.8994816293097, 559.1914691327205, 706.3095861079959, 1353.0791970866871, 270.52120324437556, 1054.177055195423, 631.3763005959786, 488.5119339496109, 717.5398367153645, 612.8095207896993, 510.93921973017325, 624.3273795039426, 511.4967805234454, 183.50170433042084, 733.0008264652804, 628.7644402093096, 528.539442603832, 174.37106560409524, 319.728065279716, 480.6748432463215, 475.85822429691217, 424.06684739612626, 600.6734697914442, 439.4320147146421, 394.7688740564603, 579.7011202277608, 616.8374599865897, 638.0460577661879, 0.0, 49.700072716266654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.474510854512141, "mean_inference_ms": 3.301876590121185, "mean_action_processing_ms": 1.1702177883289708, "mean_env_wait_ms": 9.961481458932843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004638075828552246, "StateBufferConnector_ms": 0.005293369293212891, "ViewRequirementAgentConnector_ms": 0.1128530502319336}, "num_episodes": 11, "episode_return_max": 782.9990198823649, "episode_return_min": -35.55205377212548, "episode_return_mean": 197.38203795508795, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.30009258718113, "num_env_steps_trained_throughput_per_sec": 83.30009258718113, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 240794.547, "restore_workers_time_ms": 0.014, "training_step_time_ms": 240794.492, "sample_time_ms": 2371.068, "learn_time_ms": 238405.281, "learn_throughput": 16.778, "synch_weights_time_ms": 14.594}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "fed12_00000", "date": "2024-08-21_20-20-44", "timestamp": 1724251844, "time_this_iter_s": 48.048333168029785, "time_total_s": 8167.588339090347, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f73aa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8167.588339090347, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 24.230882352941176, "ram_util_percent": 82.90588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.633950125225006, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.289875011595469, "policy_loss": -0.01920649605303037, "vf_loss": 7.306610866576906, "vf_explained_var": 0.43448318719233153, "kl": 0.012353205658796012, "entropy": 0.49420551799592516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.661672430315976, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.95204428844351, "policy_loss": -0.024345638962196454, "vf_loss": 6.973661458555353, "vf_explained_var": 0.23046205475847556, "kl": 0.013642376298626895, "entropy": 0.2997590301449967, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 782.9990198823649, "episode_reward_min": -35.55205377212548, "episode_reward_mean": 198.01004819455903, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1350.2791970866872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 394.2540420328006, "predator_policy": 1353.0791970866871}, "policy_reward_mean": {"prey_policy": -393.6636683841813, "predator_policy": 492.66869248146145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [148.18411288443787, -35.55205377212548, 61.52270387059286, 204.64712194374292, 27.584721571133983, 37.45999275445168, 264.69999999999925, 113.1011482114137, 231.78439776956364, 423.28767674125424, 271.79343145941016, 782.9990198823649, 202.88395359839373, 251.7276085135001, 100.19539177912914, 705.7669938248371, 87.48584125749879, 521.31645034095, 157.2058138969564, 220.64245674834234, 267.5134426534544, 32.30524282198265, 29.9856897872684, 12.434619719605855, 395.30000000000234, 61.17667022390421, 341.69999999999993, 38.13404303150196, 256.8248658273824, 219.7891606098758, 69.10000000000036, -15.643771028288882, 318.07240362586134, 376.5164591639607, 30.9345653953949, -6.391658613491844, 262.09999999999917, 95.95237035475296, 129.7722735235924, 20.599999999999977, 409.0158423462857, 208.25714865393456, 313.6185854677484, 303.0497843767215, 34.49654529072756, 499.9314119846566, 15.049086854745374, 265.61195201352155, 90.20000000000005, 86.02326862381882, 46.60000000000031, 151.20442392885772, 337.4580298644354, 141.39999999999912, 349.72142963224576, -3.5990414098886996, 242.26348155589906, 300.34575254649644, 255.4656324201453, 32.082724397035314, 39.80000000000013, 705.4500010610608, 515.2098778849494, 40.41099626081159, 174.29999999999956, 626.1002222570014, 333.2848410154144, 167.27966794874837, 52.39918464573651, 4.724246348735784, 376.22342672291165, 177.64104667090945, 196.16406799826063, 26.28188167795458, 252.48736288020035, 193.05186434997788, -12.25426925407946, 492.19504751458544, 366.8813224377411, 133.62599069997543, 27.09999999999998, 277.5, 83.13100512558754, 4.1230030425394695, 15.00079410542924, 276.40000000000003, 10.699999999999985, 230.1999999999998, 211.9229828534196, 251.81671417407406, 168.69336349005442, 6.623653174349594, 6.199999999999992, 402.3000000000021, 334.01991740489314, 255.7, 176.0355074836529, 414.88215076493293, 16.969594554145743, -22.679864758063605], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-935.6915042467822, -774.5695548769612, -36.80104597512646, -630.126593445896, 26.800722698235706, -352.8743586952785, -17.218064229476227, -559.2048213543262, -731.790372904888, -377.66242717426894, -310.34725755215317, -714.1371638480542, -113.29158247130681, -218.03934512985472, -649.5340921570506, -783.565563712353, -539.3174274804157, -48.069789564913265, 32.25928501206607, -710.0681884291771, -284.4760591553971, -700.7272638381127, 362.89973485215774, -96.32380173451358, -735.4176123888963, -389.8757701430879, -83.67191873005144, -632.2368487849027, 27.890692444768096, -640.5063685905161, -613.723543867179, 324.07959809138833, -685.9172805594621, -642.0174544291466, -801.6815596794803, 394.2540420328006, -646.9712851727953, -367.81817863039123, 29.993757732131428, -998.6660771897706, -894.9126907893808, 81.22814960347296, -97.68202448073252, -572.5404083600464, -604.3907935820237, -441.1993458100244, -836.0638693414613, -804.8682187453647, -218.03560035915814, 365.15118830756205, -206.79052693829343, -399.26179423564037, -809.7878042582416, 284.24653023501946, -642.7235473611207, -820.1616903954135, -539.9336750300192, 15.503162782940109, -339.2823620485728, -497.06470173055993, -53.850887416961626, -113.80721379829481, -284.58129363216227, -395.1564803252438, -157.42917878331434, -937.381353433489, -212.23716164269672, 3.0616165833899345, -408.78714668287995, -701.2678990384774, -1261.295851344196, -785.6626182856797, -54.18766424881261, -115.866817013254, -835.2504703554081, -506.34869504203493, -210.82841865110603, -462.699722823465, -651.2314327489709, -503.84517478378586, 344.2, -262.0401635287094, -350.33907271918383, -620.0925344241884, -386.44782894722965, -1.1957490128757535, -708.4206941939976, -436.062663492694, -773.1306700647533, -247.64588226640552, -51.864235594250125, -310.17481520437155, -86.72793921778799, -744.6346070688787, 217.07919361712908, -322.177690211394, -488.1564198943329, -679.8211905848469, -28.11192399333524, -411.75238554066027, 19.249948407695584, -903.1768441841563, -652.6350435980801, -286.18895774255344, 289.59323819726325, -738.8873144905344, -509.18371276496265, -130.89947195833957, -516.5885343532711, -58.73888564516639, -775.8712673576503, -533.3220753562854, -398.61061372952446, -820.6281862570005, -337.0558945456896, -322.5141746901679, -518.2537837855567, 125.87839595489265, -440.0201317125585, -542.5570903273701, -466.4279176451793, -323.0494505379237, -83.60218050234096, 320.58601544609417, 333.12504703368205, -783.7186226577766, -422.92794807107975, -649.4974755100195, -408.64777085328274, -46.42489768685937, 80.1844517166945, -932.113716845326, 314.42300229156035, -1295.4635811089663, -530.516986189, -308.64147764527485, -399.6787189742195, -882.6738010813294, -604.4465148084358, -723.4726248237536, -349.4014972544292, -386.90689836294865, -446.0935895869828, -534.2876719865509, 23.59730894403263, -609.5904410033581, -213.45833930215048, -538.2216756143625, -649.4748821700646, -147.68909113259753, 145.43869556402498, -124.54446751509334, -723.6444581111111, -602.1383462611926, -751.1901747370628, 317.54732269544326, -499.41033575904964, 208.38954070888548, -343.80796554358034, -497.6569945184733, -682.0095861079958, -1350.2791970866872, 6.878796755625672, -1054.077055195423, -620.540553148239, -416.21667627176095, -446.5916156946586, -879.6347387678666, -500.6392197301709, -619.6265853985132, -503.29678052344354, 84.6982956695791, -727.0008264652803, -624.0644402093085, -521.6394426038304, 48.92893439590455, -171.82747218817764, -416.6524534844396, -372.5191651558304, -275.5891923631267, -611.3198857660992, -260.0922352499262, -398.28766554586196, -569.5586755640038, -614.3374599865897, -634.3460577661871, 343.15836924702927, 9.441558036704173, -695.227186002172, 18.941563846480204, -669.4113066742923, 117.84367122086968, -156.35607608666763, -896.3083871089044, -280.9510322343072, -349.5294138456273, -662.157319050785, -585.6739407465354, -163.44290948272007, -448.5772835395362], "policy_predator_policy_reward": [948.4829553016864, 909.9622167064964, 0.7811797500389153, 630.5944058988581, 376.07841641210723, 11.517923455532564, 209.13901652646572, 571.9309910010795, 574.6800722544268, 562.3574493958663, 350.8737336086714, 711.0706805459926, 323.7915824713069, 272.23934512985363, 761.4922269692954, 784.7085771115247, 281.08322257817065, 538.0883922367226, 750.2431305030442, 350.85344965532164, 411.0172254937286, 845.9795289591939, 331.97502142567566, 184.4480653390455, 700.1431510679923, 628.0341850623844, 617.4698167581251, 350.1665592703267, 350.5584646902033, 362.2526032346785, 457.77830322357624, 537.632636377051, 691.3509096665478, 724.0696665795596, 793.2292079563666, 135.5147600312622, 646.5256250525266, 525.4696526476163, 393.14330330349463, 796.1714729024867, 898.9126907893817, 182.28529304998136, 701.3479180016747, 1.179757661087348, 607.7401110689611, 467.8357181103599, 848.8326825972956, 804.5340252091362, 241.83560035915679, 6.348811692437952, 381.0499523231239, 286.17903907471594, 810.9878042582418, 56.25346976498059, 650.7068411891091, 850.3124395989288, 77.9685383944223, 703.2868396800369, 465.6567288082739, 590.4794955807375, 93.75088741696058, 143.00721379829315, 531.2691157262686, 132.82488720285224, 663.0172831014137, 749.8656527412478, 244.25484258057097, 341.43716164269836, 319.6871243337509, 821.3024867830077, 1224.2364633277377, 816.330347688647, 285.0876642488128, 147.06681701325223, 690.9554221101538, 746.5961136420432, 147.27423415814908, 656.0261808400185, 661.9314327489714, 513.7451747837866, 130.3597034522237, 196.49630242277308, 460.93339691815305, 717.7553588791588, 381.95122922082015, 319.31093420703445, 606.7125307210702, 840.8206113423435, 747.0381757330259, 308.23492188886314, 396.86160473913264, 465.10885804414403, 77.78124130040163, 768.6303918410096, 31.005897574924788, 339.7045510328622, 451.8548155580264, 806.3227949211545, 367.2521598325597, 158.63541832525559, 19.050051592304424, 911.4768441841576, 614.2916355178228, 475.7367897516685, 38.764791667172254, 747.9873144905342, 519.8837127649633, 261.5994719583392, 493.34037622718824, 431.7084734034971, 428.8795541967709, 876.7147471072818, 744.1770007290404, 717.3252808133872, 356.64619165766504, 603.2696301246934, 537.7488635320374, 110.09215671877426, 456.30285610959436, 558.3570903273711, 489.0279176451796, 340.24945053792715, 276.3378360879892, 192.12833002931825, 510.7922197569258, 455.01123375211824, 635.8450322749142, 476.9913875670019, 548.6477708532834, 80.72489768685867, 758.2580813042866, 719.7714060813485, 18.761838723853998, 1295.5635811089662, 403.6420491276399, 602.7960826553946, 1042.3587822467182, 292.3929224545725, 606.7707611571716, 725.8726248237541, 516.8423000219688, 595.6895223183262, 466.6028154329243, 691.4194928115197, 403.5390036320207, 378.61819642556605, 17.45664878397534, 760.5052478104917, 510.57376155733857, 539.077574625524, 19.047750270053463, 153.10988603099273, 743.6012293167113, 569.9273058015124, 306.83272704820934, 619.0051725079987, 335.17766593678886, 322.7244515511171, 415.8994816293097, 559.1914691327205, 706.3095861079959, 1353.0791970866871, 270.52120324437556, 1054.177055195423, 631.3763005959786, 488.5119339496109, 717.5398367153645, 612.8095207896993, 510.93921973017325, 624.3273795039426, 511.4967805234454, 183.50170433042084, 733.0008264652804, 628.7644402093096, 528.539442603832, 174.37106560409524, 319.728065279716, 480.6748432463215, 475.85822429691217, 424.06684739612626, 600.6734697914442, 439.4320147146421, 394.7688740564603, 579.7011202277608, 616.8374599865897, 638.0460577661879, 0.0, 49.700072716266654, 374.80680019875285, 635.498739361829, 673.6113066742923, 133.65632877912995, 619.1150044864848, 609.5849661927375, 484.77258500299786, 560.5900118418724, 688.4873731792036, 576.313481172264, 509.94997575604447, 79.39035250814644]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.477793435128354, "mean_inference_ms": 3.305509437299628, "mean_action_processing_ms": 1.1705565133517866, "mean_env_wait_ms": 9.955291866493644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004634857177734375, "StateBufferConnector_ms": 0.0052024126052856445, "ViewRequirementAgentConnector_ms": 0.10753190517425537}, "num_episodes": 6, "episode_return_max": 782.9990198823649, "episode_return_min": -35.55205377212548, "episode_return_mean": 198.01004819455903, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.461846713765338, "num_env_steps_trained_throughput_per_sec": 3.461846713765338, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 351403.594, "restore_workers_time_ms": 0.014, "training_step_time_ms": 351403.538, "sample_time_ms": 2360.563, "learn_time_ms": 349023.393, "learn_throughput": 11.461, "synch_weights_time_ms": 16.022}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "fed12_00000", "date": "2024-08-21_20-40-00", "timestamp": 1724253000, "time_this_iter_s": 1155.5203220844269, "time_total_s": 9323.108661174774, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4cb9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9323.108661174774, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 33.643055555555556, "ram_util_percent": 82.72638888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.417706292016167, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.870051856015725, "policy_loss": -0.017713489966582823, "vf_loss": 6.884823100276725, "vf_explained_var": 0.4842598018507478, "kl": 0.014711195644774725, "entropy": 0.4964803808895999, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.603608453336847, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.894462808477815, "policy_loss": -0.022871552932780807, "vf_loss": 6.914657791834029, "vf_explained_var": 0.08376526337452035, "kl": 0.013382811613366127, "entropy": 0.2954614295215203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 782.9990198823649, "episode_reward_min": -22.679864758063605, "episode_reward_mean": 197.3619011853022, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1350.2791970866872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 394.2540420328006, "predator_policy": 1353.0791970866871}, "policy_reward_mean": {"prey_policy": -392.6098748380384, "predator_policy": 491.2908254306902}, "custom_metrics": {}, "hist_stats": {"episode_reward": [271.79343145941016, 782.9990198823649, 202.88395359839373, 251.7276085135001, 100.19539177912914, 705.7669938248371, 87.48584125749879, 521.31645034095, 157.2058138969564, 220.64245674834234, 267.5134426534544, 32.30524282198265, 29.9856897872684, 12.434619719605855, 395.30000000000234, 61.17667022390421, 341.69999999999993, 38.13404303150196, 256.8248658273824, 219.7891606098758, 69.10000000000036, -15.643771028288882, 318.07240362586134, 376.5164591639607, 30.9345653953949, -6.391658613491844, 262.09999999999917, 95.95237035475296, 129.7722735235924, 20.599999999999977, 409.0158423462857, 208.25714865393456, 313.6185854677484, 303.0497843767215, 34.49654529072756, 499.9314119846566, 15.049086854745374, 265.61195201352155, 90.20000000000005, 86.02326862381882, 46.60000000000031, 151.20442392885772, 337.4580298644354, 141.39999999999912, 349.72142963224576, -3.5990414098886996, 242.26348155589906, 300.34575254649644, 255.4656324201453, 32.082724397035314, 39.80000000000013, 705.4500010610608, 515.2098778849494, 40.41099626081159, 174.29999999999956, 626.1002222570014, 333.2848410154144, 167.27966794874837, 52.39918464573651, 4.724246348735784, 376.22342672291165, 177.64104667090945, 196.16406799826063, 26.28188167795458, 252.48736288020035, 193.05186434997788, -12.25426925407946, 492.19504751458544, 366.8813224377411, 133.62599069997543, 27.09999999999998, 277.5, 83.13100512558754, 4.1230030425394695, 15.00079410542924, 276.40000000000003, 10.699999999999985, 230.1999999999998, 211.9229828534196, 251.81671417407406, 168.69336349005442, 6.623653174349594, 6.199999999999992, 402.3000000000021, 334.01991740489314, 255.7, 176.0355074836529, 414.88215076493293, 16.969594554145743, -22.679864758063605, 344.90000000000066, 115.49999999999997, 488.13686433905065, 15.199999999999907, 217.29077197870868, 37.06101956850324, 43.45988920668891, 91.45558756177488, 48.658965163763675, 10.242023230295509], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-284.4760591553971, -700.7272638381127, 362.89973485215774, -96.32380173451358, -735.4176123888963, -389.8757701430879, -83.67191873005144, -632.2368487849027, 27.890692444768096, -640.5063685905161, -613.723543867179, 324.07959809138833, -685.9172805594621, -642.0174544291466, -801.6815596794803, 394.2540420328006, -646.9712851727953, -367.81817863039123, 29.993757732131428, -998.6660771897706, -894.9126907893808, 81.22814960347296, -97.68202448073252, -572.5404083600464, -604.3907935820237, -441.1993458100244, -836.0638693414613, -804.8682187453647, -218.03560035915814, 365.15118830756205, -206.79052693829343, -399.26179423564037, -809.7878042582416, 284.24653023501946, -642.7235473611207, -820.1616903954135, -539.9336750300192, 15.503162782940109, -339.2823620485728, -497.06470173055993, -53.850887416961626, -113.80721379829481, -284.58129363216227, -395.1564803252438, -157.42917878331434, -937.381353433489, -212.23716164269672, 3.0616165833899345, -408.78714668287995, -701.2678990384774, -1261.295851344196, -785.6626182856797, -54.18766424881261, -115.866817013254, -835.2504703554081, -506.34869504203493, -210.82841865110603, -462.699722823465, -651.2314327489709, -503.84517478378586, 344.2, -262.0401635287094, -350.33907271918383, -620.0925344241884, -386.44782894722965, -1.1957490128757535, -708.4206941939976, -436.062663492694, -773.1306700647533, -247.64588226640552, -51.864235594250125, -310.17481520437155, -86.72793921778799, -744.6346070688787, 217.07919361712908, -322.177690211394, -488.1564198943329, -679.8211905848469, -28.11192399333524, -411.75238554066027, 19.249948407695584, -903.1768441841563, -652.6350435980801, -286.18895774255344, 289.59323819726325, -738.8873144905344, -509.18371276496265, -130.89947195833957, -516.5885343532711, -58.73888564516639, -775.8712673576503, -533.3220753562854, -398.61061372952446, -820.6281862570005, -337.0558945456896, -322.5141746901679, -518.2537837855567, 125.87839595489265, -440.0201317125585, -542.5570903273701, -466.4279176451793, -323.0494505379237, -83.60218050234096, 320.58601544609417, 333.12504703368205, -783.7186226577766, -422.92794807107975, -649.4974755100195, -408.64777085328274, -46.42489768685937, 80.1844517166945, -932.113716845326, 314.42300229156035, -1295.4635811089663, -530.516986189, -308.64147764527485, -399.6787189742195, -882.6738010813294, -604.4465148084358, -723.4726248237536, -349.4014972544292, -386.90689836294865, -446.0935895869828, -534.2876719865509, 23.59730894403263, -609.5904410033581, -213.45833930215048, -538.2216756143625, -649.4748821700646, -147.68909113259753, 145.43869556402498, -124.54446751509334, -723.6444581111111, -602.1383462611926, -751.1901747370628, 317.54732269544326, -499.41033575904964, 208.38954070888548, -343.80796554358034, -497.6569945184733, -682.0095861079958, -1350.2791970866872, 6.878796755625672, -1054.077055195423, -620.540553148239, -416.21667627176095, -446.5916156946586, -879.6347387678666, -500.6392197301709, -619.6265853985132, -503.29678052344354, 84.6982956695791, -727.0008264652803, -624.0644402093085, -521.6394426038304, 48.92893439590455, -171.82747218817764, -416.6524534844396, -372.5191651558304, -275.5891923631267, -611.3198857660992, -260.0922352499262, -398.28766554586196, -569.5586755640038, -614.3374599865897, -634.3460577661871, 343.15836924702927, 9.441558036704173, -695.227186002172, 18.941563846480204, -669.4113066742923, 117.84367122086968, -156.35607608666763, -896.3083871089044, -280.9510322343072, -349.5294138456273, -662.157319050785, -585.6739407465354, -163.44290948272007, -448.5772835395362, -509.86910047457474, 271.9446768929873, -150.82004033512123, -449.84803420449197, -47.76757197640154, -1070.8531676793891, -703.3896683386973, -940.8751968379437, -648.1811878247722, -201.96650840487513, -253.28799000810443, -367.89876919355885, -565.1271141969668, -714.4514985764948, 2.688704485110586, -372.8324633005295, -83.41483880172946, -426.2357017444911, -541.018104987284, -459.2868608020888], "policy_predator_policy_reward": [411.0172254937286, 845.9795289591939, 331.97502142567566, 184.4480653390455, 700.1431510679923, 628.0341850623844, 617.4698167581251, 350.1665592703267, 350.5584646902033, 362.2526032346785, 457.77830322357624, 537.632636377051, 691.3509096665478, 724.0696665795596, 793.2292079563666, 135.5147600312622, 646.5256250525266, 525.4696526476163, 393.14330330349463, 796.1714729024867, 898.9126907893817, 182.28529304998136, 701.3479180016747, 1.179757661087348, 607.7401110689611, 467.8357181103599, 848.8326825972956, 804.5340252091362, 241.83560035915679, 6.348811692437952, 381.0499523231239, 286.17903907471594, 810.9878042582418, 56.25346976498059, 650.7068411891091, 850.3124395989288, 77.9685383944223, 703.2868396800369, 465.6567288082739, 590.4794955807375, 93.75088741696058, 143.00721379829315, 531.2691157262686, 132.82488720285224, 663.0172831014137, 749.8656527412478, 244.25484258057097, 341.43716164269836, 319.6871243337509, 821.3024867830077, 1224.2364633277377, 816.330347688647, 285.0876642488128, 147.06681701325223, 690.9554221101538, 746.5961136420432, 147.27423415814908, 656.0261808400185, 661.9314327489714, 513.7451747837866, 130.3597034522237, 196.49630242277308, 460.93339691815305, 717.7553588791588, 381.95122922082015, 319.31093420703445, 606.7125307210702, 840.8206113423435, 747.0381757330259, 308.23492188886314, 396.86160473913264, 465.10885804414403, 77.78124130040163, 768.6303918410096, 31.005897574924788, 339.7045510328622, 451.8548155580264, 806.3227949211545, 367.2521598325597, 158.63541832525559, 19.050051592304424, 911.4768441841576, 614.2916355178228, 475.7367897516685, 38.764791667172254, 747.9873144905342, 519.8837127649633, 261.5994719583392, 493.34037622718824, 431.7084734034971, 428.8795541967709, 876.7147471072818, 744.1770007290404, 717.3252808133872, 356.64619165766504, 603.2696301246934, 537.7488635320374, 110.09215671877426, 456.30285610959436, 558.3570903273711, 489.0279176451796, 340.24945053792715, 276.3378360879892, 192.12833002931825, 510.7922197569258, 455.01123375211824, 635.8450322749142, 476.9913875670019, 548.6477708532834, 80.72489768685867, 758.2580813042866, 719.7714060813485, 18.761838723853998, 1295.5635811089662, 403.6420491276399, 602.7960826553946, 1042.3587822467182, 292.3929224545725, 606.7707611571716, 725.8726248237541, 516.8423000219688, 595.6895223183262, 466.6028154329243, 691.4194928115197, 403.5390036320207, 378.61819642556605, 17.45664878397534, 760.5052478104917, 510.57376155733857, 539.077574625524, 19.047750270053463, 153.10988603099273, 743.6012293167113, 569.9273058015124, 306.83272704820934, 619.0051725079987, 335.17766593678886, 322.7244515511171, 415.8994816293097, 559.1914691327205, 706.3095861079959, 1353.0791970866871, 270.52120324437556, 1054.177055195423, 631.3763005959786, 488.5119339496109, 717.5398367153645, 612.8095207896993, 510.93921973017325, 624.3273795039426, 511.4967805234454, 183.50170433042084, 733.0008264652804, 628.7644402093096, 528.539442603832, 174.37106560409524, 319.728065279716, 480.6748432463215, 475.85822429691217, 424.06684739612626, 600.6734697914442, 439.4320147146421, 394.7688740564603, 579.7011202277608, 616.8374599865897, 638.0460577661879, 0.0, 49.700072716266654, 374.80680019875285, 635.498739361829, 673.6113066742923, 133.65632877912995, 619.1150044864848, 609.5849661927375, 484.77258500299786, 560.5900118418724, 688.4873731792036, 576.313481172264, 509.94997575604447, 79.39035250814644, 517.7691004745755, 65.0553231070129, 258.9200403351205, 457.24803420449274, 634.1196777286547, 972.63792626618, 713.7896683386997, 945.6751968379439, 528.5848052445205, 538.8536629638362, 269.91723246845004, 388.33054630171875, 562.4371196744789, 760.601382305675, 15.066178077261755, 446.53316829993344, 554.117193649725, 4.192312060256737, 544.9888282262953, 465.5581607933731]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4802859167265767, "mean_inference_ms": 3.3118377615272885, "mean_action_processing_ms": 1.173199500316133, "mean_env_wait_ms": 9.95147507224618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004647493362426758, "StateBufferConnector_ms": 0.006074190139770508, "ViewRequirementAgentConnector_ms": 0.10691201686859131}, "num_episodes": 10, "episode_return_max": 782.9990198823649, "episode_return_min": -22.679864758063605, "episode_return_mean": 197.3619011853022, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.63329265754818, "num_env_steps_trained_throughput_per_sec": 80.63329265754818, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 351463.985, "restore_workers_time_ms": 0.014, "training_step_time_ms": 351463.928, "sample_time_ms": 2396.69, "learn_time_ms": 349047.569, "learn_throughput": 11.46, "synch_weights_time_ms": 15.896}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "fed12_00000", "date": "2024-08-21_20-40-49", "timestamp": 1724253049, "time_this_iter_s": 49.65884494781494, "time_total_s": 9372.76750612259, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f713af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9372.76750612259, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 30.614285714285714, "ram_util_percent": 83.33714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.879410700823264, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.801526884553294, "policy_loss": -0.020790788279378185, "vf_loss": 6.81953822973544, "vf_explained_var": 0.4721293997196924, "kl": 0.013897215007809261, "entropy": 0.5494860313714497, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.749130502201261, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.6435918987112705, "policy_loss": -0.02194303948341046, "vf_loss": 6.662995194631909, "vf_explained_var": 0.03832743899532096, "kl": 0.01269871828518315, "entropy": 0.30660989994094484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 705.4500010610608, "episode_reward_min": -22.679864758063605, "episode_reward_mean": 181.49968919001793, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1350.2791970866872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 365.15118830756205, "predator_policy": 1353.0791970866871}, "policy_reward_mean": {"prey_policy": -402.87148778165516, "predator_policy": 493.6213323766648}, "custom_metrics": {}, "hist_stats": {"episode_reward": [157.2058138969564, 220.64245674834234, 267.5134426534544, 32.30524282198265, 29.9856897872684, 12.434619719605855, 395.30000000000234, 61.17667022390421, 341.69999999999993, 38.13404303150196, 256.8248658273824, 219.7891606098758, 69.10000000000036, -15.643771028288882, 318.07240362586134, 376.5164591639607, 30.9345653953949, -6.391658613491844, 262.09999999999917, 95.95237035475296, 129.7722735235924, 20.599999999999977, 409.0158423462857, 208.25714865393456, 313.6185854677484, 303.0497843767215, 34.49654529072756, 499.9314119846566, 15.049086854745374, 265.61195201352155, 90.20000000000005, 86.02326862381882, 46.60000000000031, 151.20442392885772, 337.4580298644354, 141.39999999999912, 349.72142963224576, -3.5990414098886996, 242.26348155589906, 300.34575254649644, 255.4656324201453, 32.082724397035314, 39.80000000000013, 705.4500010610608, 515.2098778849494, 40.41099626081159, 174.29999999999956, 626.1002222570014, 333.2848410154144, 167.27966794874837, 52.39918464573651, 4.724246348735784, 376.22342672291165, 177.64104667090945, 196.16406799826063, 26.28188167795458, 252.48736288020035, 193.05186434997788, -12.25426925407946, 492.19504751458544, 366.8813224377411, 133.62599069997543, 27.09999999999998, 277.5, 83.13100512558754, 4.1230030425394695, 15.00079410542924, 276.40000000000003, 10.699999999999985, 230.1999999999998, 211.9229828534196, 251.81671417407406, 168.69336349005442, 6.623653174349594, 6.199999999999992, 402.3000000000021, 334.01991740489314, 255.7, 176.0355074836529, 414.88215076493293, 16.969594554145743, -22.679864758063605, 344.90000000000066, 115.49999999999997, 488.13686433905065, 15.199999999999907, 217.29077197870868, 37.06101956850324, 43.45988920668891, 91.45558756177488, 48.658965163763675, 10.242023230295509, 41.58796404537823, 19.000596697430247, 327.94008462484703, 327.59643487604274, 58.09963689542565, 56.90000000000009, 68.29999999999995, 438.5227739885259], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-646.9712851727953, -367.81817863039123, 29.993757732131428, -998.6660771897706, -894.9126907893808, 81.22814960347296, -97.68202448073252, -572.5404083600464, -604.3907935820237, -441.1993458100244, -836.0638693414613, -804.8682187453647, -218.03560035915814, 365.15118830756205, -206.79052693829343, -399.26179423564037, -809.7878042582416, 284.24653023501946, -642.7235473611207, -820.1616903954135, -539.9336750300192, 15.503162782940109, -339.2823620485728, -497.06470173055993, -53.850887416961626, -113.80721379829481, -284.58129363216227, -395.1564803252438, -157.42917878331434, -937.381353433489, -212.23716164269672, 3.0616165833899345, -408.78714668287995, -701.2678990384774, -1261.295851344196, -785.6626182856797, -54.18766424881261, -115.866817013254, -835.2504703554081, -506.34869504203493, -210.82841865110603, -462.699722823465, -651.2314327489709, -503.84517478378586, 344.2, -262.0401635287094, -350.33907271918383, -620.0925344241884, -386.44782894722965, -1.1957490128757535, -708.4206941939976, -436.062663492694, -773.1306700647533, -247.64588226640552, -51.864235594250125, -310.17481520437155, -86.72793921778799, -744.6346070688787, 217.07919361712908, -322.177690211394, -488.1564198943329, -679.8211905848469, -28.11192399333524, -411.75238554066027, 19.249948407695584, -903.1768441841563, -652.6350435980801, -286.18895774255344, 289.59323819726325, -738.8873144905344, -509.18371276496265, -130.89947195833957, -516.5885343532711, -58.73888564516639, -775.8712673576503, -533.3220753562854, -398.61061372952446, -820.6281862570005, -337.0558945456896, -322.5141746901679, -518.2537837855567, 125.87839595489265, -440.0201317125585, -542.5570903273701, -466.4279176451793, -323.0494505379237, -83.60218050234096, 320.58601544609417, 333.12504703368205, -783.7186226577766, -422.92794807107975, -649.4974755100195, -408.64777085328274, -46.42489768685937, 80.1844517166945, -932.113716845326, 314.42300229156035, -1295.4635811089663, -530.516986189, -308.64147764527485, -399.6787189742195, -882.6738010813294, -604.4465148084358, -723.4726248237536, -349.4014972544292, -386.90689836294865, -446.0935895869828, -534.2876719865509, 23.59730894403263, -609.5904410033581, -213.45833930215048, -538.2216756143625, -649.4748821700646, -147.68909113259753, 145.43869556402498, -124.54446751509334, -723.6444581111111, -602.1383462611926, -751.1901747370628, 317.54732269544326, -499.41033575904964, 208.38954070888548, -343.80796554358034, -497.6569945184733, -682.0095861079958, -1350.2791970866872, 6.878796755625672, -1054.077055195423, -620.540553148239, -416.21667627176095, -446.5916156946586, -879.6347387678666, -500.6392197301709, -619.6265853985132, -503.29678052344354, 84.6982956695791, -727.0008264652803, -624.0644402093085, -521.6394426038304, 48.92893439590455, -171.82747218817764, -416.6524534844396, -372.5191651558304, -275.5891923631267, -611.3198857660992, -260.0922352499262, -398.28766554586196, -569.5586755640038, -614.3374599865897, -634.3460577661871, 343.15836924702927, 9.441558036704173, -695.227186002172, 18.941563846480204, -669.4113066742923, 117.84367122086968, -156.35607608666763, -896.3083871089044, -280.9510322343072, -349.5294138456273, -662.157319050785, -585.6739407465354, -163.44290948272007, -448.5772835395362, -509.86910047457474, 271.9446768929873, -150.82004033512123, -449.84803420449197, -47.76757197640154, -1070.8531676793891, -703.3896683386973, -940.8751968379437, -648.1811878247722, -201.96650840487513, -253.28799000810443, -367.89876919355885, -565.1271141969668, -714.4514985764948, 2.688704485110586, -372.8324633005295, -83.41483880172946, -426.2357017444911, -541.018104987284, -459.2868608020888, -804.2320912934106, -146.78475477178696, -600.1930986070374, -439.91243509691174, -588.5301829358974, -466.51185602774444, -184.95629460867278, 56.98913616396709, -498.5044149837173, -377.2706933629257, -487.44064389364905, -814.9452843337463, -737.7516483459614, -436.89299075737335, -878.2813514287959, 155.44460108068972], "policy_predator_policy_reward": [646.5256250525266, 525.4696526476163, 393.14330330349463, 796.1714729024867, 898.9126907893817, 182.28529304998136, 701.3479180016747, 1.179757661087348, 607.7401110689611, 467.8357181103599, 848.8326825972956, 804.5340252091362, 241.83560035915679, 6.348811692437952, 381.0499523231239, 286.17903907471594, 810.9878042582418, 56.25346976498059, 650.7068411891091, 850.3124395989288, 77.9685383944223, 703.2868396800369, 465.6567288082739, 590.4794955807375, 93.75088741696058, 143.00721379829315, 531.2691157262686, 132.82488720285224, 663.0172831014137, 749.8656527412478, 244.25484258057097, 341.43716164269836, 319.6871243337509, 821.3024867830077, 1224.2364633277377, 816.330347688647, 285.0876642488128, 147.06681701325223, 690.9554221101538, 746.5961136420432, 147.27423415814908, 656.0261808400185, 661.9314327489714, 513.7451747837866, 130.3597034522237, 196.49630242277308, 460.93339691815305, 717.7553588791588, 381.95122922082015, 319.31093420703445, 606.7125307210702, 840.8206113423435, 747.0381757330259, 308.23492188886314, 396.86160473913264, 465.10885804414403, 77.78124130040163, 768.6303918410096, 31.005897574924788, 339.7045510328622, 451.8548155580264, 806.3227949211545, 367.2521598325597, 158.63541832525559, 19.050051592304424, 911.4768441841576, 614.2916355178228, 475.7367897516685, 38.764791667172254, 747.9873144905342, 519.8837127649633, 261.5994719583392, 493.34037622718824, 431.7084734034971, 428.8795541967709, 876.7147471072818, 744.1770007290404, 717.3252808133872, 356.64619165766504, 603.2696301246934, 537.7488635320374, 110.09215671877426, 456.30285610959436, 558.3570903273711, 489.0279176451796, 340.24945053792715, 276.3378360879892, 192.12833002931825, 510.7922197569258, 455.01123375211824, 635.8450322749142, 476.9913875670019, 548.6477708532834, 80.72489768685867, 758.2580813042866, 719.7714060813485, 18.761838723853998, 1295.5635811089662, 403.6420491276399, 602.7960826553946, 1042.3587822467182, 292.3929224545725, 606.7707611571716, 725.8726248237541, 516.8423000219688, 595.6895223183262, 466.6028154329243, 691.4194928115197, 403.5390036320207, 378.61819642556605, 17.45664878397534, 760.5052478104917, 510.57376155733857, 539.077574625524, 19.047750270053463, 153.10988603099273, 743.6012293167113, 569.9273058015124, 306.83272704820934, 619.0051725079987, 335.17766593678886, 322.7244515511171, 415.8994816293097, 559.1914691327205, 706.3095861079959, 1353.0791970866871, 270.52120324437556, 1054.177055195423, 631.3763005959786, 488.5119339496109, 717.5398367153645, 612.8095207896993, 510.93921973017325, 624.3273795039426, 511.4967805234454, 183.50170433042084, 733.0008264652804, 628.7644402093096, 528.539442603832, 174.37106560409524, 319.728065279716, 480.6748432463215, 475.85822429691217, 424.06684739612626, 600.6734697914442, 439.4320147146421, 394.7688740564603, 579.7011202277608, 616.8374599865897, 638.0460577661879, 0.0, 49.700072716266654, 374.80680019875285, 635.498739361829, 673.6113066742923, 133.65632877912995, 619.1150044864848, 609.5849661927375, 484.77258500299786, 560.5900118418724, 688.4873731792036, 576.313481172264, 509.94997575604447, 79.39035250814644, 517.7691004745755, 65.0553231070129, 258.9200403351205, 457.24803420449274, 634.1196777286547, 972.63792626618, 713.7896683386997, 945.6751968379439, 528.5848052445205, 538.8536629638362, 269.91723246845004, 388.33054630171875, 562.4371196744789, 760.601382305675, 15.066178077261755, 446.53316829993344, 554.117193649725, 4.192312060256737, 544.9888282262953, 465.5581607933731, 818.5087138594788, 174.09609625109817, 571.9640889234124, 487.14204147796784, 682.0892560709935, 700.8928675174973, 78.14614277446847, 377.41745054627563, 185.14490225868386, 748.7298429833864, 539.740643893651, 819.5452843337473, 743.1516483459626, 499.7929907573731, 390.551418605658, 770.8081057309755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.483351059351698, "mean_inference_ms": 3.3193153383818674, "mean_action_processing_ms": 1.1752655784077026, "mean_env_wait_ms": 9.953383237620697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01794302463531494, "StateBufferConnector_ms": 0.008876204490661621, "ViewRequirementAgentConnector_ms": 0.12031435966491699}, "num_episodes": 8, "episode_return_max": 705.4500010610608, "episode_return_min": -22.679864758063605, "episode_return_mean": 181.49968919001793, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 26.678237889979133, "num_env_steps_trained_throughput_per_sec": 26.678237889979133, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 361635.767, "restore_workers_time_ms": 0.014, "training_step_time_ms": 361635.713, "sample_time_ms": 2402.819, "learn_time_ms": 359212.541, "learn_throughput": 11.135, "synch_weights_time_ms": 16.059}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "fed12_00000", "date": "2024-08-21_20-43-19", "timestamp": 1724253199, "time_this_iter_s": 149.98227715492249, "time_total_s": 9522.749783277512, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4c49d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9522.749783277512, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 28.081159420289858, "ram_util_percent": 83.2101449275362}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.91326374364278, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.5785787110606195, "policy_loss": -0.0170682222714214, "vf_loss": 6.592967207721932, "vf_explained_var": 0.4177378802072434, "kl": 0.013398608364036712, "entropy": 0.5712588070246277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.781891778284912, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.270108264590067, "policy_loss": -0.022547781636332354, "vf_loss": 6.290449503489903, "vf_explained_var": 0.18944606153422563, "kl": 0.011032583450321995, "entropy": 0.3414477044706622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 705.4500010610608, "episode_reward_min": -22.679864758063605, "episode_reward_mean": 185.72823675627814, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1350.2791970866872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 344.2, "predator_policy": 1353.0791970866871}, "policy_reward_mean": {"prey_policy": -404.4429841930565, "predator_policy": 497.30710257119625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [318.07240362586134, 376.5164591639607, 30.9345653953949, -6.391658613491844, 262.09999999999917, 95.95237035475296, 129.7722735235924, 20.599999999999977, 409.0158423462857, 208.25714865393456, 313.6185854677484, 303.0497843767215, 34.49654529072756, 499.9314119846566, 15.049086854745374, 265.61195201352155, 90.20000000000005, 86.02326862381882, 46.60000000000031, 151.20442392885772, 337.4580298644354, 141.39999999999912, 349.72142963224576, -3.5990414098886996, 242.26348155589906, 300.34575254649644, 255.4656324201453, 32.082724397035314, 39.80000000000013, 705.4500010610608, 515.2098778849494, 40.41099626081159, 174.29999999999956, 626.1002222570014, 333.2848410154144, 167.27966794874837, 52.39918464573651, 4.724246348735784, 376.22342672291165, 177.64104667090945, 196.16406799826063, 26.28188167795458, 252.48736288020035, 193.05186434997788, -12.25426925407946, 492.19504751458544, 366.8813224377411, 133.62599069997543, 27.09999999999998, 277.5, 83.13100512558754, 4.1230030425394695, 15.00079410542924, 276.40000000000003, 10.699999999999985, 230.1999999999998, 211.9229828534196, 251.81671417407406, 168.69336349005442, 6.623653174349594, 6.199999999999992, 402.3000000000021, 334.01991740489314, 255.7, 176.0355074836529, 414.88215076493293, 16.969594554145743, -22.679864758063605, 344.90000000000066, 115.49999999999997, 488.13686433905065, 15.199999999999907, 217.29077197870868, 37.06101956850324, 43.45988920668891, 91.45558756177488, 48.658965163763675, 10.242023230295509, 41.58796404537823, 19.000596697430247, 327.94008462484703, 327.59643487604274, 58.09963689542565, 56.90000000000009, 68.29999999999995, 438.5227739885259, 235.9206478353401, 63.48949001460645, 132.25108652143706, 261.57927626195647, 359.30000000000155, 182.56566003680652, 488.7999999999998, -7.009665988185674, 27.00000000000012, 102.15281678757681, 422.90706622836075, 27.08529199185387, 10.33091564401349, 202.95040558424853], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-157.42917878331434, -937.381353433489, -212.23716164269672, 3.0616165833899345, -408.78714668287995, -701.2678990384774, -1261.295851344196, -785.6626182856797, -54.18766424881261, -115.866817013254, -835.2504703554081, -506.34869504203493, -210.82841865110603, -462.699722823465, -651.2314327489709, -503.84517478378586, 344.2, -262.0401635287094, -350.33907271918383, -620.0925344241884, -386.44782894722965, -1.1957490128757535, -708.4206941939976, -436.062663492694, -773.1306700647533, -247.64588226640552, -51.864235594250125, -310.17481520437155, -86.72793921778799, -744.6346070688787, 217.07919361712908, -322.177690211394, -488.1564198943329, -679.8211905848469, -28.11192399333524, -411.75238554066027, 19.249948407695584, -903.1768441841563, -652.6350435980801, -286.18895774255344, 289.59323819726325, -738.8873144905344, -509.18371276496265, -130.89947195833957, -516.5885343532711, -58.73888564516639, -775.8712673576503, -533.3220753562854, -398.61061372952446, -820.6281862570005, -337.0558945456896, -322.5141746901679, -518.2537837855567, 125.87839595489265, -440.0201317125585, -542.5570903273701, -466.4279176451793, -323.0494505379237, -83.60218050234096, 320.58601544609417, 333.12504703368205, -783.7186226577766, -422.92794807107975, -649.4974755100195, -408.64777085328274, -46.42489768685937, 80.1844517166945, -932.113716845326, 314.42300229156035, -1295.4635811089663, -530.516986189, -308.64147764527485, -399.6787189742195, -882.6738010813294, -604.4465148084358, -723.4726248237536, -349.4014972544292, -386.90689836294865, -446.0935895869828, -534.2876719865509, 23.59730894403263, -609.5904410033581, -213.45833930215048, -538.2216756143625, -649.4748821700646, -147.68909113259753, 145.43869556402498, -124.54446751509334, -723.6444581111111, -602.1383462611926, -751.1901747370628, 317.54732269544326, -499.41033575904964, 208.38954070888548, -343.80796554358034, -497.6569945184733, -682.0095861079958, -1350.2791970866872, 6.878796755625672, -1054.077055195423, -620.540553148239, -416.21667627176095, -446.5916156946586, -879.6347387678666, -500.6392197301709, -619.6265853985132, -503.29678052344354, 84.6982956695791, -727.0008264652803, -624.0644402093085, -521.6394426038304, 48.92893439590455, -171.82747218817764, -416.6524534844396, -372.5191651558304, -275.5891923631267, -611.3198857660992, -260.0922352499262, -398.28766554586196, -569.5586755640038, -614.3374599865897, -634.3460577661871, 343.15836924702927, 9.441558036704173, -695.227186002172, 18.941563846480204, -669.4113066742923, 117.84367122086968, -156.35607608666763, -896.3083871089044, -280.9510322343072, -349.5294138456273, -662.157319050785, -585.6739407465354, -163.44290948272007, -448.5772835395362, -509.86910047457474, 271.9446768929873, -150.82004033512123, -449.84803420449197, -47.76757197640154, -1070.8531676793891, -703.3896683386973, -940.8751968379437, -648.1811878247722, -201.96650840487513, -253.28799000810443, -367.89876919355885, -565.1271141969668, -714.4514985764948, 2.688704485110586, -372.8324633005295, -83.41483880172946, -426.2357017444911, -541.018104987284, -459.2868608020888, -804.2320912934106, -146.78475477178696, -600.1930986070374, -439.91243509691174, -588.5301829358974, -466.51185602774444, -184.95629460867278, 56.98913616396709, -498.5044149837173, -377.2706933629257, -487.44064389364905, -814.9452843337463, -737.7516483459614, -436.89299075737335, -878.2813514287959, 155.44460108068972, -287.75996708596585, -798.918274848243, -6.706523834973206, -643.7143409626783, -433.2371077151119, -420.26014569735685, -674.7995015969269, -585.3203265103815, -73.73129043606411, -31.779006357576918, -475.47222687063055, -480.2905171467121, 176.3738389534567, -65.74472670610734, -229.55288233995535, -737.7326092327569, -419.6884266010964, -541.3974215975901, -458.5428029268167, -345.7242574124854, -908.2901896141809, 285.54146741138464, -439.73112052566717, -529.7906415048815, -642.1973289885832, -557.0793321874679, -171.68368670844174, -626.4976142070063], "policy_predator_policy_reward": [663.0172831014137, 749.8656527412478, 244.25484258057097, 341.43716164269836, 319.6871243337509, 821.3024867830077, 1224.2364633277377, 816.330347688647, 285.0876642488128, 147.06681701325223, 690.9554221101538, 746.5961136420432, 147.27423415814908, 656.0261808400185, 661.9314327489714, 513.7451747837866, 130.3597034522237, 196.49630242277308, 460.93339691815305, 717.7553588791588, 381.95122922082015, 319.31093420703445, 606.7125307210702, 840.8206113423435, 747.0381757330259, 308.23492188886314, 396.86160473913264, 465.10885804414403, 77.78124130040163, 768.6303918410096, 31.005897574924788, 339.7045510328622, 451.8548155580264, 806.3227949211545, 367.2521598325597, 158.63541832525559, 19.050051592304424, 911.4768441841576, 614.2916355178228, 475.7367897516685, 38.764791667172254, 747.9873144905342, 519.8837127649633, 261.5994719583392, 493.34037622718824, 431.7084734034971, 428.8795541967709, 876.7147471072818, 744.1770007290404, 717.3252808133872, 356.64619165766504, 603.2696301246934, 537.7488635320374, 110.09215671877426, 456.30285610959436, 558.3570903273711, 489.0279176451796, 340.24945053792715, 276.3378360879892, 192.12833002931825, 510.7922197569258, 455.01123375211824, 635.8450322749142, 476.9913875670019, 548.6477708532834, 80.72489768685867, 758.2580813042866, 719.7714060813485, 18.761838723853998, 1295.5635811089662, 403.6420491276399, 602.7960826553946, 1042.3587822467182, 292.3929224545725, 606.7707611571716, 725.8726248237541, 516.8423000219688, 595.6895223183262, 466.6028154329243, 691.4194928115197, 403.5390036320207, 378.61819642556605, 17.45664878397534, 760.5052478104917, 510.57376155733857, 539.077574625524, 19.047750270053463, 153.10988603099273, 743.6012293167113, 569.9273058015124, 306.83272704820934, 619.0051725079987, 335.17766593678886, 322.7244515511171, 415.8994816293097, 559.1914691327205, 706.3095861079959, 1353.0791970866871, 270.52120324437556, 1054.177055195423, 631.3763005959786, 488.5119339496109, 717.5398367153645, 612.8095207896993, 510.93921973017325, 624.3273795039426, 511.4967805234454, 183.50170433042084, 733.0008264652804, 628.7644402093096, 528.539442603832, 174.37106560409524, 319.728065279716, 480.6748432463215, 475.85822429691217, 424.06684739612626, 600.6734697914442, 439.4320147146421, 394.7688740564603, 579.7011202277608, 616.8374599865897, 638.0460577661879, 0.0, 49.700072716266654, 374.80680019875285, 635.498739361829, 673.6113066742923, 133.65632877912995, 619.1150044864848, 609.5849661927375, 484.77258500299786, 560.5900118418724, 688.4873731792036, 576.313481172264, 509.94997575604447, 79.39035250814644, 517.7691004745755, 65.0553231070129, 258.9200403351205, 457.24803420449274, 634.1196777286547, 972.63792626618, 713.7896683386997, 945.6751968379439, 528.5848052445205, 538.8536629638362, 269.91723246845004, 388.33054630171875, 562.4371196744789, 760.601382305675, 15.066178077261755, 446.53316829993344, 554.117193649725, 4.192312060256737, 544.9888282262953, 465.5581607933731, 818.5087138594788, 174.09609625109817, 571.9640889234124, 487.14204147796784, 682.0892560709935, 700.8928675174973, 78.14614277446847, 377.41745054627563, 185.14490225868386, 748.7298429833864, 539.740643893651, 819.5452843337473, 743.1516483459626, 499.7929907573731, 390.551418605658, 770.8081057309755, 568.1999262433246, 754.3989635262283, 109.80551706182082, 604.1048377504378, 703.1380524343302, 282.6102874995816, 729.3480276230249, 792.3510767462399, 191.531290436063, 273.27900635757715, 502.563202971199, 635.7652010829509, 260.737442900329, 117.43344485232124, 244.43441611775958, 715.8414094667658, 430.588426601098, 557.4974215975909, 390.27091935028534, 516.1489577765977, 818.0949933331099, 227.56079509804783, 458.9467848556464, 537.6602691667568, 647.0505229597424, 562.5570538603235, 422.94131806721487, 578.1903884324804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.489389147020222, "mean_inference_ms": 3.3258294917882214, "mean_action_processing_ms": 1.1729159532714508, "mean_env_wait_ms": 9.960295138435143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017841100692749023, "StateBufferConnector_ms": 0.009093403816223145, "ViewRequirementAgentConnector_ms": 0.13292109966278076}, "num_episodes": 14, "episode_return_max": 705.4500010610608, "episode_return_min": -22.679864758063605, "episode_return_mean": 185.72823675627814, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 7.904274713076096, "num_env_steps_trained_throughput_per_sec": 7.904274713076096, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 366056.628, "restore_workers_time_ms": 0.014, "training_step_time_ms": 366056.572, "sample_time_ms": 2308.405, "learn_time_ms": 363727.641, "learn_throughput": 10.997, "synch_weights_time_ms": 16.223}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "fed12_00000", "date": "2024-08-21_20-51-46", "timestamp": 1724253706, "time_this_iter_s": 506.09428095817566, "time_total_s": 10028.844064235687, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f4ceca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10028.844064235687, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 28.201449275362318, "ram_util_percent": 83.24492753623188}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.129648769091045, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.647972291865677, "policy_loss": -0.016769580355298425, "vf_loss": 6.662437216945426, "vf_explained_var": 0.4584309838751636, "kl": 0.01152339813634556, "entropy": 0.5635075849200052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.490853490652862, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.065918745061077, "policy_loss": -0.022168889469417828, "vf_loss": 6.086256272704513, "vf_explained_var": 0.2069801229648489, "kl": 0.009156839329276294, "entropy": 0.3293555548582128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 705.4500010610608, "episode_reward_min": -22.679864758063605, "episode_reward_mean": 186.41462641607666, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1350.2791970866872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 352.4808858209359, "predator_policy": 1353.0791970866871}, "policy_reward_mean": {"prey_policy": -400.108020620525, "predator_policy": 493.3153338285639}, "custom_metrics": {}, "hist_stats": {"episode_reward": [313.6185854677484, 303.0497843767215, 34.49654529072756, 499.9314119846566, 15.049086854745374, 265.61195201352155, 90.20000000000005, 86.02326862381882, 46.60000000000031, 151.20442392885772, 337.4580298644354, 141.39999999999912, 349.72142963224576, -3.5990414098886996, 242.26348155589906, 300.34575254649644, 255.4656324201453, 32.082724397035314, 39.80000000000013, 705.4500010610608, 515.2098778849494, 40.41099626081159, 174.29999999999956, 626.1002222570014, 333.2848410154144, 167.27966794874837, 52.39918464573651, 4.724246348735784, 376.22342672291165, 177.64104667090945, 196.16406799826063, 26.28188167795458, 252.48736288020035, 193.05186434997788, -12.25426925407946, 492.19504751458544, 366.8813224377411, 133.62599069997543, 27.09999999999998, 277.5, 83.13100512558754, 4.1230030425394695, 15.00079410542924, 276.40000000000003, 10.699999999999985, 230.1999999999998, 211.9229828534196, 251.81671417407406, 168.69336349005442, 6.623653174349594, 6.199999999999992, 402.3000000000021, 334.01991740489314, 255.7, 176.0355074836529, 414.88215076493293, 16.969594554145743, -22.679864758063605, 344.90000000000066, 115.49999999999997, 488.13686433905065, 15.199999999999907, 217.29077197870868, 37.06101956850324, 43.45988920668891, 91.45558756177488, 48.658965163763675, 10.242023230295509, 41.58796404537823, 19.000596697430247, 327.94008462484703, 327.59643487604274, 58.09963689542565, 56.90000000000009, 68.29999999999995, 438.5227739885259, 235.9206478353401, 63.48949001460645, 132.25108652143706, 261.57927626195647, 359.30000000000155, 182.56566003680652, 488.7999999999998, -7.009665988185674, 27.00000000000012, 102.15281678757681, 422.90706622836075, 27.08529199185387, 10.33091564401349, 202.95040558424853, 358.1602875627319, 127.25378015219589, 576.6999999999998, 10.928609462578565, 320.1655808847436, 10.299999999999985, 107.48835366542818, 98.4434638158766, 32.19741759799957, 271.8308772885839], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-386.44782894722965, -1.1957490128757535, -708.4206941939976, -436.062663492694, -773.1306700647533, -247.64588226640552, -51.864235594250125, -310.17481520437155, -86.72793921778799, -744.6346070688787, 217.07919361712908, -322.177690211394, -488.1564198943329, -679.8211905848469, -28.11192399333524, -411.75238554066027, 19.249948407695584, -903.1768441841563, -652.6350435980801, -286.18895774255344, 289.59323819726325, -738.8873144905344, -509.18371276496265, -130.89947195833957, -516.5885343532711, -58.73888564516639, -775.8712673576503, -533.3220753562854, -398.61061372952446, -820.6281862570005, -337.0558945456896, -322.5141746901679, -518.2537837855567, 125.87839595489265, -440.0201317125585, -542.5570903273701, -466.4279176451793, -323.0494505379237, -83.60218050234096, 320.58601544609417, 333.12504703368205, -783.7186226577766, -422.92794807107975, -649.4974755100195, -408.64777085328274, -46.42489768685937, 80.1844517166945, -932.113716845326, 314.42300229156035, -1295.4635811089663, -530.516986189, -308.64147764527485, -399.6787189742195, -882.6738010813294, -604.4465148084358, -723.4726248237536, -349.4014972544292, -386.90689836294865, -446.0935895869828, -534.2876719865509, 23.59730894403263, -609.5904410033581, -213.45833930215048, -538.2216756143625, -649.4748821700646, -147.68909113259753, 145.43869556402498, -124.54446751509334, -723.6444581111111, -602.1383462611926, -751.1901747370628, 317.54732269544326, -499.41033575904964, 208.38954070888548, -343.80796554358034, -497.6569945184733, -682.0095861079958, -1350.2791970866872, 6.878796755625672, -1054.077055195423, -620.540553148239, -416.21667627176095, -446.5916156946586, -879.6347387678666, -500.6392197301709, -619.6265853985132, -503.29678052344354, 84.6982956695791, -727.0008264652803, -624.0644402093085, -521.6394426038304, 48.92893439590455, -171.82747218817764, -416.6524534844396, -372.5191651558304, -275.5891923631267, -611.3198857660992, -260.0922352499262, -398.28766554586196, -569.5586755640038, -614.3374599865897, -634.3460577661871, 343.15836924702927, 9.441558036704173, -695.227186002172, 18.941563846480204, -669.4113066742923, 117.84367122086968, -156.35607608666763, -896.3083871089044, -280.9510322343072, -349.5294138456273, -662.157319050785, -585.6739407465354, -163.44290948272007, -448.5772835395362, -509.86910047457474, 271.9446768929873, -150.82004033512123, -449.84803420449197, -47.76757197640154, -1070.8531676793891, -703.3896683386973, -940.8751968379437, -648.1811878247722, -201.96650840487513, -253.28799000810443, -367.89876919355885, -565.1271141969668, -714.4514985764948, 2.688704485110586, -372.8324633005295, -83.41483880172946, -426.2357017444911, -541.018104987284, -459.2868608020888, -804.2320912934106, -146.78475477178696, -600.1930986070374, -439.91243509691174, -588.5301829358974, -466.51185602774444, -184.95629460867278, 56.98913616396709, -498.5044149837173, -377.2706933629257, -487.44064389364905, -814.9452843337463, -737.7516483459614, -436.89299075737335, -878.2813514287959, 155.44460108068972, -287.75996708596585, -798.918274848243, -6.706523834973206, -643.7143409626783, -433.2371077151119, -420.26014569735685, -674.7995015969269, -585.3203265103815, -73.73129043606411, -31.779006357576918, -475.47222687063055, -480.2905171467121, 176.3738389534567, -65.74472670610734, -229.55288233995535, -737.7326092327569, -419.6884266010964, -541.3974215975901, -458.5428029268167, -345.7242574124854, -908.2901896141809, 285.54146741138464, -439.73112052566717, -529.7906415048815, -642.1973289885832, -557.0793321874679, -171.68368670844174, -626.4976142070063, -551.016357522361, 235.9494801367001, -475.67027400667325, -637.6126788022522, -42.30799247890036, 352.4808858209359, -502.1854136518765, -604.5770494226188, -571.3223460158559, -513.2267019926759, -485.19950275910674, -517.9570549300958, -358.76689345383, -687.063667164409, -24.93472330867354, -327.66139818622935, -556.0220566307424, -700.053992640908, -395.6345654330703, -459.75474201729844], "policy_predator_policy_reward": [381.95122922082015, 319.31093420703445, 606.7125307210702, 840.8206113423435, 747.0381757330259, 308.23492188886314, 396.86160473913264, 465.10885804414403, 77.78124130040163, 768.6303918410096, 31.005897574924788, 339.7045510328622, 451.8548155580264, 806.3227949211545, 367.2521598325597, 158.63541832525559, 19.050051592304424, 911.4768441841576, 614.2916355178228, 475.7367897516685, 38.764791667172254, 747.9873144905342, 519.8837127649633, 261.5994719583392, 493.34037622718824, 431.7084734034971, 428.8795541967709, 876.7147471072818, 744.1770007290404, 717.3252808133872, 356.64619165766504, 603.2696301246934, 537.7488635320374, 110.09215671877426, 456.30285610959436, 558.3570903273711, 489.0279176451796, 340.24945053792715, 276.3378360879892, 192.12833002931825, 510.7922197569258, 455.01123375211824, 635.8450322749142, 476.9913875670019, 548.6477708532834, 80.72489768685867, 758.2580813042866, 719.7714060813485, 18.761838723853998, 1295.5635811089662, 403.6420491276399, 602.7960826553946, 1042.3587822467182, 292.3929224545725, 606.7707611571716, 725.8726248237541, 516.8423000219688, 595.6895223183262, 466.6028154329243, 691.4194928115197, 403.5390036320207, 378.61819642556605, 17.45664878397534, 760.5052478104917, 510.57376155733857, 539.077574625524, 19.047750270053463, 153.10988603099273, 743.6012293167113, 569.9273058015124, 306.83272704820934, 619.0051725079987, 335.17766593678886, 322.7244515511171, 415.8994816293097, 559.1914691327205, 706.3095861079959, 1353.0791970866871, 270.52120324437556, 1054.177055195423, 631.3763005959786, 488.5119339496109, 717.5398367153645, 612.8095207896993, 510.93921973017325, 624.3273795039426, 511.4967805234454, 183.50170433042084, 733.0008264652804, 628.7644402093096, 528.539442603832, 174.37106560409524, 319.728065279716, 480.6748432463215, 475.85822429691217, 424.06684739612626, 600.6734697914442, 439.4320147146421, 394.7688740564603, 579.7011202277608, 616.8374599865897, 638.0460577661879, 0.0, 49.700072716266654, 374.80680019875285, 635.498739361829, 673.6113066742923, 133.65632877912995, 619.1150044864848, 609.5849661927375, 484.77258500299786, 560.5900118418724, 688.4873731792036, 576.313481172264, 509.94997575604447, 79.39035250814644, 517.7691004745755, 65.0553231070129, 258.9200403351205, 457.24803420449274, 634.1196777286547, 972.63792626618, 713.7896683386997, 945.6751968379439, 528.5848052445205, 538.8536629638362, 269.91723246845004, 388.33054630171875, 562.4371196744789, 760.601382305675, 15.066178077261755, 446.53316829993344, 554.117193649725, 4.192312060256737, 544.9888282262953, 465.5581607933731, 818.5087138594788, 174.09609625109817, 571.9640889234124, 487.14204147796784, 682.0892560709935, 700.8928675174973, 78.14614277446847, 377.41745054627563, 185.14490225868386, 748.7298429833864, 539.740643893651, 819.5452843337473, 743.1516483459626, 499.7929907573731, 390.551418605658, 770.8081057309755, 568.1999262433246, 754.3989635262283, 109.80551706182082, 604.1048377504378, 703.1380524343302, 282.6102874995816, 729.3480276230249, 792.3510767462399, 191.531290436063, 273.27900635757715, 502.563202971199, 635.7652010829509, 260.737442900329, 117.43344485232124, 244.43441611775958, 715.8414094667658, 430.588426601098, 557.4974215975909, 390.27091935028534, 516.1489577765977, 818.0949933331099, 227.56079509804783, 458.9467848556464, 537.6602691667568, 647.0505229597424, 562.5570538603235, 422.94131806721487, 578.1903884324804, 581.1809610271938, 92.04620392120003, 617.4092693600785, 623.1274636010427, 239.93392584982152, 26.593180808142797, 510.83095959543846, 606.8601129416373, 833.5206837201013, 571.193945173174, 488.8995027591076, 524.557054930097, 853.1412037918683, 300.1777104918024, 164.5169559353455, 286.52262937543975, 583.5194742287442, 704.753992640909, 398.17161618521175, 729.0485685537441]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4919446287904634, "mean_inference_ms": 3.325125526120641, "mean_action_processing_ms": 1.1707475181430478, "mean_env_wait_ms": 9.9616106926043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023908138275146484, "StateBufferConnector_ms": 0.008307099342346191, "ViewRequirementAgentConnector_ms": 0.12895381450653076}, "num_episodes": 10, "episode_return_max": 705.4500010610608, "episode_return_min": -22.679864758063605, "episode_return_mean": 186.41462641607666, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 2.0552559750954065, "num_env_steps_trained_throughput_per_sec": 2.0552559750954065, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 495859.751, "restore_workers_time_ms": 0.014, "training_step_time_ms": 495859.696, "sample_time_ms": 2236.216, "learn_time_ms": 493603.052, "learn_throughput": 8.104, "synch_weights_time_ms": 16.28}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "fed12_00000", "date": "2024-08-21_21-24-12", "timestamp": 1724255652, "time_this_iter_s": 1946.3282401561737, "time_total_s": 11975.172304391861, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f3de550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11975.172304391861, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 34.3225352112676, "ram_util_percent": 83.17605633802815}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.73889994823113, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.364406328352671, "policy_loss": -0.022865443136395207, "vf_loss": 6.384081339709973, "vf_explained_var": 0.5050169319702835, "kl": 0.015952190523474383, "entropy": 0.535374482078527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.548364451322605, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.422591590629053, "policy_loss": -0.021376593561384768, "vf_loss": 6.441500376393555, "vf_explained_var": 0.17970306034441347, "kl": 0.012339091264746256, "entropy": 0.30530096715089505, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 705.4500010610608, "episode_reward_min": -22.679864758063605, "episode_reward_mean": 187.90975986407352, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1350.2791970866872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 352.4808858209359, "predator_policy": 1353.0791970866871}, "policy_reward_mean": {"prey_policy": -392.8983712033678, "predator_policy": 486.8532511354053}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.60000000000031, 151.20442392885772, 337.4580298644354, 141.39999999999912, 349.72142963224576, -3.5990414098886996, 242.26348155589906, 300.34575254649644, 255.4656324201453, 32.082724397035314, 39.80000000000013, 705.4500010610608, 515.2098778849494, 40.41099626081159, 174.29999999999956, 626.1002222570014, 333.2848410154144, 167.27966794874837, 52.39918464573651, 4.724246348735784, 376.22342672291165, 177.64104667090945, 196.16406799826063, 26.28188167795458, 252.48736288020035, 193.05186434997788, -12.25426925407946, 492.19504751458544, 366.8813224377411, 133.62599069997543, 27.09999999999998, 277.5, 83.13100512558754, 4.1230030425394695, 15.00079410542924, 276.40000000000003, 10.699999999999985, 230.1999999999998, 211.9229828534196, 251.81671417407406, 168.69336349005442, 6.623653174349594, 6.199999999999992, 402.3000000000021, 334.01991740489314, 255.7, 176.0355074836529, 414.88215076493293, 16.969594554145743, -22.679864758063605, 344.90000000000066, 115.49999999999997, 488.13686433905065, 15.199999999999907, 217.29077197870868, 37.06101956850324, 43.45988920668891, 91.45558756177488, 48.658965163763675, 10.242023230295509, 41.58796404537823, 19.000596697430247, 327.94008462484703, 327.59643487604274, 58.09963689542565, 56.90000000000009, 68.29999999999995, 438.5227739885259, 235.9206478353401, 63.48949001460645, 132.25108652143706, 261.57927626195647, 359.30000000000155, 182.56566003680652, 488.7999999999998, -7.009665988185674, 27.00000000000012, 102.15281678757681, 422.90706622836075, 27.08529199185387, 10.33091564401349, 202.95040558424853, 358.1602875627319, 127.25378015219589, 576.6999999999998, 10.928609462578565, 320.1655808847436, 10.299999999999985, 107.48835366542818, 98.4434638158766, 32.19741759799957, 271.8308772885839, 201.35855403231727, 107.93895890252118, 329.75509020307857, 64.82763062652663, 421.75826346141923, 123.63408647971372, 154.79999999999993, 353.4213957060508], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [19.249948407695584, -903.1768441841563, -652.6350435980801, -286.18895774255344, 289.59323819726325, -738.8873144905344, -509.18371276496265, -130.89947195833957, -516.5885343532711, -58.73888564516639, -775.8712673576503, -533.3220753562854, -398.61061372952446, -820.6281862570005, -337.0558945456896, -322.5141746901679, -518.2537837855567, 125.87839595489265, -440.0201317125585, -542.5570903273701, -466.4279176451793, -323.0494505379237, -83.60218050234096, 320.58601544609417, 333.12504703368205, -783.7186226577766, -422.92794807107975, -649.4974755100195, -408.64777085328274, -46.42489768685937, 80.1844517166945, -932.113716845326, 314.42300229156035, -1295.4635811089663, -530.516986189, -308.64147764527485, -399.6787189742195, -882.6738010813294, -604.4465148084358, -723.4726248237536, -349.4014972544292, -386.90689836294865, -446.0935895869828, -534.2876719865509, 23.59730894403263, -609.5904410033581, -213.45833930215048, -538.2216756143625, -649.4748821700646, -147.68909113259753, 145.43869556402498, -124.54446751509334, -723.6444581111111, -602.1383462611926, -751.1901747370628, 317.54732269544326, -499.41033575904964, 208.38954070888548, -343.80796554358034, -497.6569945184733, -682.0095861079958, -1350.2791970866872, 6.878796755625672, -1054.077055195423, -620.540553148239, -416.21667627176095, -446.5916156946586, -879.6347387678666, -500.6392197301709, -619.6265853985132, -503.29678052344354, 84.6982956695791, -727.0008264652803, -624.0644402093085, -521.6394426038304, 48.92893439590455, -171.82747218817764, -416.6524534844396, -372.5191651558304, -275.5891923631267, -611.3198857660992, -260.0922352499262, -398.28766554586196, -569.5586755640038, -614.3374599865897, -634.3460577661871, 343.15836924702927, 9.441558036704173, -695.227186002172, 18.941563846480204, -669.4113066742923, 117.84367122086968, -156.35607608666763, -896.3083871089044, -280.9510322343072, -349.5294138456273, -662.157319050785, -585.6739407465354, -163.44290948272007, -448.5772835395362, -509.86910047457474, 271.9446768929873, -150.82004033512123, -449.84803420449197, -47.76757197640154, -1070.8531676793891, -703.3896683386973, -940.8751968379437, -648.1811878247722, -201.96650840487513, -253.28799000810443, -367.89876919355885, -565.1271141969668, -714.4514985764948, 2.688704485110586, -372.8324633005295, -83.41483880172946, -426.2357017444911, -541.018104987284, -459.2868608020888, -804.2320912934106, -146.78475477178696, -600.1930986070374, -439.91243509691174, -588.5301829358974, -466.51185602774444, -184.95629460867278, 56.98913616396709, -498.5044149837173, -377.2706933629257, -487.44064389364905, -814.9452843337463, -737.7516483459614, -436.89299075737335, -878.2813514287959, 155.44460108068972, -287.75996708596585, -798.918274848243, -6.706523834973206, -643.7143409626783, -433.2371077151119, -420.26014569735685, -674.7995015969269, -585.3203265103815, -73.73129043606411, -31.779006357576918, -475.47222687063055, -480.2905171467121, 176.3738389534567, -65.74472670610734, -229.55288233995535, -737.7326092327569, -419.6884266010964, -541.3974215975901, -458.5428029268167, -345.7242574124854, -908.2901896141809, 285.54146741138464, -439.73112052566717, -529.7906415048815, -642.1973289885832, -557.0793321874679, -171.68368670844174, -626.4976142070063, -551.016357522361, 235.9494801367001, -475.67027400667325, -637.6126788022522, -42.30799247890036, 352.4808858209359, -502.1854136518765, -604.5770494226188, -571.3223460158559, -513.2267019926759, -485.19950275910674, -517.9570549300958, -358.76689345383, -687.063667164409, -24.93472330867354, -327.66139818622935, -556.0220566307424, -700.053992640908, -395.6345654330703, -459.75474201729844, -179.317126379861, -511.43539556511314, -298.0434197520327, -521.1818920770097, -117.61394102748474, -54.74723923881692, 19.741464206390074, -392.2131150152856, -307.6723315922214, 24.96588742064958, -106.2955278578463, -650.9237719062232, -145.166091453682, -417.9623872583739, 88.23718143272491, -447.6879121750722], "policy_predator_policy_reward": [19.050051592304424, 911.4768441841576, 614.2916355178228, 475.7367897516685, 38.764791667172254, 747.9873144905342, 519.8837127649633, 261.5994719583392, 493.34037622718824, 431.7084734034971, 428.8795541967709, 876.7147471072818, 744.1770007290404, 717.3252808133872, 356.64619165766504, 603.2696301246934, 537.7488635320374, 110.09215671877426, 456.30285610959436, 558.3570903273711, 489.0279176451796, 340.24945053792715, 276.3378360879892, 192.12833002931825, 510.7922197569258, 455.01123375211824, 635.8450322749142, 476.9913875670019, 548.6477708532834, 80.72489768685867, 758.2580813042866, 719.7714060813485, 18.761838723853998, 1295.5635811089662, 403.6420491276399, 602.7960826553946, 1042.3587822467182, 292.3929224545725, 606.7707611571716, 725.8726248237541, 516.8423000219688, 595.6895223183262, 466.6028154329243, 691.4194928115197, 403.5390036320207, 378.61819642556605, 17.45664878397534, 760.5052478104917, 510.57376155733857, 539.077574625524, 19.047750270053463, 153.10988603099273, 743.6012293167113, 569.9273058015124, 306.83272704820934, 619.0051725079987, 335.17766593678886, 322.7244515511171, 415.8994816293097, 559.1914691327205, 706.3095861079959, 1353.0791970866871, 270.52120324437556, 1054.177055195423, 631.3763005959786, 488.5119339496109, 717.5398367153645, 612.8095207896993, 510.93921973017325, 624.3273795039426, 511.4967805234454, 183.50170433042084, 733.0008264652804, 628.7644402093096, 528.539442603832, 174.37106560409524, 319.728065279716, 480.6748432463215, 475.85822429691217, 424.06684739612626, 600.6734697914442, 439.4320147146421, 394.7688740564603, 579.7011202277608, 616.8374599865897, 638.0460577661879, 0.0, 49.700072716266654, 374.80680019875285, 635.498739361829, 673.6113066742923, 133.65632877912995, 619.1150044864848, 609.5849661927375, 484.77258500299786, 560.5900118418724, 688.4873731792036, 576.313481172264, 509.94997575604447, 79.39035250814644, 517.7691004745755, 65.0553231070129, 258.9200403351205, 457.24803420449274, 634.1196777286547, 972.63792626618, 713.7896683386997, 945.6751968379439, 528.5848052445205, 538.8536629638362, 269.91723246845004, 388.33054630171875, 562.4371196744789, 760.601382305675, 15.066178077261755, 446.53316829993344, 554.117193649725, 4.192312060256737, 544.9888282262953, 465.5581607933731, 818.5087138594788, 174.09609625109817, 571.9640889234124, 487.14204147796784, 682.0892560709935, 700.8928675174973, 78.14614277446847, 377.41745054627563, 185.14490225868386, 748.7298429833864, 539.740643893651, 819.5452843337473, 743.1516483459626, 499.7929907573731, 390.551418605658, 770.8081057309755, 568.1999262433246, 754.3989635262283, 109.80551706182082, 604.1048377504378, 703.1380524343302, 282.6102874995816, 729.3480276230249, 792.3510767462399, 191.531290436063, 273.27900635757715, 502.563202971199, 635.7652010829509, 260.737442900329, 117.43344485232124, 244.43441611775958, 715.8414094667658, 430.588426601098, 557.4974215975909, 390.27091935028534, 516.1489577765977, 818.0949933331099, 227.56079509804783, 458.9467848556464, 537.6602691667568, 647.0505229597424, 562.5570538603235, 422.94131806721487, 578.1903884324804, 581.1809610271938, 92.04620392120003, 617.4092693600785, 623.1274636010427, 239.93392584982152, 26.593180808142797, 510.83095959543846, 606.8601129416373, 833.5206837201013, 571.193945173174, 488.8995027591076, 524.557054930097, 853.1412037918683, 300.1777104918024, 164.5169559353455, 286.52262937543975, 583.5194742287442, 704.753992640909, 398.17161618521175, 729.0485685537441, 154.027945509357, 738.0831304679373, 550.2438668534609, 376.92040387810266, 242.9807512820164, 259.1355191873617, 129.42789631297808, 307.87138512244667, 480.0541040302693, 224.41060360272166, 803.6341948090134, 77.21919143477194, 285.66609145368216, 432.26238725837715, 470.0397541811003, 242.83237226729932]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.765067481300053, "mean_inference_ms": 4.177388549145656, "mean_action_processing_ms": 2.030878671483657, "mean_env_wait_ms": 9.973935157982107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05234372615814209, "StateBufferConnector_ms": 0.009186506271362305, "ViewRequirementAgentConnector_ms": 0.21388816833496094}, "num_episodes": 8, "episode_return_max": 705.4500010610608, "episode_return_min": -22.679864758063605, "episode_return_mean": 187.90975986407352, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.21079200828784858, "num_env_steps_trained_throughput_per_sec": 0.21079200828784858, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 2388513.469, "restore_workers_time_ms": 0.015, "training_step_time_ms": 2388513.407, "sample_time_ms": 92709.129, "learn_time_ms": 2295771.718, "learn_throughput": 1.742, "synch_weights_time_ms": 26.756}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "fed12_00000", "date": "2024-08-22_02-40-28", "timestamp": 1724274628, "time_this_iter_s": 18976.293949842453, "time_total_s": 30951.466254234314, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f73af70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30951.466254234314, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 46.634482758620685, "ram_util_percent": 83.67931034482758}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.071624395077823, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.994507911217906, "policy_loss": -0.019571828454358394, "vf_loss": 7.011150032124191, "vf_explained_var": 0.47048570807017975, "kl": 0.014648536646433135, "entropy": 0.5333932856087962, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.847152492608974, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.603776001047205, "policy_loss": -0.020039022051687377, "vf_loss": 6.621405803337299, "vf_explained_var": 0.1336647616807746, "kl": 0.012046073869772493, "entropy": 0.3277330342423979, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 626.1002222570014, "episode_reward_min": -22.679864758063605, "episode_reward_mean": 170.1466909317688, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1350.2791970866872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 352.4808858209359, "predator_policy": 1353.0791970866871}, "policy_reward_mean": {"prey_policy": -406.1043171121864, "predator_policy": 491.1776625780715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.41099626081159, 174.29999999999956, 626.1002222570014, 333.2848410154144, 167.27966794874837, 52.39918464573651, 4.724246348735784, 376.22342672291165, 177.64104667090945, 196.16406799826063, 26.28188167795458, 252.48736288020035, 193.05186434997788, -12.25426925407946, 492.19504751458544, 366.8813224377411, 133.62599069997543, 27.09999999999998, 277.5, 83.13100512558754, 4.1230030425394695, 15.00079410542924, 276.40000000000003, 10.699999999999985, 230.1999999999998, 211.9229828534196, 251.81671417407406, 168.69336349005442, 6.623653174349594, 6.199999999999992, 402.3000000000021, 334.01991740489314, 255.7, 176.0355074836529, 414.88215076493293, 16.969594554145743, -22.679864758063605, 344.90000000000066, 115.49999999999997, 488.13686433905065, 15.199999999999907, 217.29077197870868, 37.06101956850324, 43.45988920668891, 91.45558756177488, 48.658965163763675, 10.242023230295509, 41.58796404537823, 19.000596697430247, 327.94008462484703, 327.59643487604274, 58.09963689542565, 56.90000000000009, 68.29999999999995, 438.5227739885259, 235.9206478353401, 63.48949001460645, 132.25108652143706, 261.57927626195647, 359.30000000000155, 182.56566003680652, 488.7999999999998, -7.009665988185674, 27.00000000000012, 102.15281678757681, 422.90706622836075, 27.08529199185387, 10.33091564401349, 202.95040558424853, 358.1602875627319, 127.25378015219589, 576.6999999999998, 10.928609462578565, 320.1655808847436, 10.299999999999985, 107.48835366542818, 98.4434638158766, 32.19741759799957, 271.8308772885839, 201.35855403231727, 107.93895890252118, 329.75509020307857, 64.82763062652663, 421.75826346141923, 123.63408647971372, 154.79999999999993, 353.4213957060508, 9.599999999999994, 106.81454120848412, 29.39669914110094, 73.13099382914213, 45.75926876295792, 295.17211477257825, 113.50341543701279, 32.40000000000021, 38.47293429409479, 197.67589424661045, 211.28781881969275, 124.30576956675, 59.57596857233827], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-422.92794807107975, -649.4974755100195, -408.64777085328274, -46.42489768685937, 80.1844517166945, -932.113716845326, 314.42300229156035, -1295.4635811089663, -530.516986189, -308.64147764527485, -399.6787189742195, -882.6738010813294, -604.4465148084358, -723.4726248237536, -349.4014972544292, -386.90689836294865, -446.0935895869828, -534.2876719865509, 23.59730894403263, -609.5904410033581, -213.45833930215048, -538.2216756143625, -649.4748821700646, -147.68909113259753, 145.43869556402498, -124.54446751509334, -723.6444581111111, -602.1383462611926, -751.1901747370628, 317.54732269544326, -499.41033575904964, 208.38954070888548, -343.80796554358034, -497.6569945184733, -682.0095861079958, -1350.2791970866872, 6.878796755625672, -1054.077055195423, -620.540553148239, -416.21667627176095, -446.5916156946586, -879.6347387678666, -500.6392197301709, -619.6265853985132, -503.29678052344354, 84.6982956695791, -727.0008264652803, -624.0644402093085, -521.6394426038304, 48.92893439590455, -171.82747218817764, -416.6524534844396, -372.5191651558304, -275.5891923631267, -611.3198857660992, -260.0922352499262, -398.28766554586196, -569.5586755640038, -614.3374599865897, -634.3460577661871, 343.15836924702927, 9.441558036704173, -695.227186002172, 18.941563846480204, -669.4113066742923, 117.84367122086968, -156.35607608666763, -896.3083871089044, -280.9510322343072, -349.5294138456273, -662.157319050785, -585.6739407465354, -163.44290948272007, -448.5772835395362, -509.86910047457474, 271.9446768929873, -150.82004033512123, -449.84803420449197, -47.76757197640154, -1070.8531676793891, -703.3896683386973, -940.8751968379437, -648.1811878247722, -201.96650840487513, -253.28799000810443, -367.89876919355885, -565.1271141969668, -714.4514985764948, 2.688704485110586, -372.8324633005295, -83.41483880172946, -426.2357017444911, -541.018104987284, -459.2868608020888, -804.2320912934106, -146.78475477178696, -600.1930986070374, -439.91243509691174, -588.5301829358974, -466.51185602774444, -184.95629460867278, 56.98913616396709, -498.5044149837173, -377.2706933629257, -487.44064389364905, -814.9452843337463, -737.7516483459614, -436.89299075737335, -878.2813514287959, 155.44460108068972, -287.75996708596585, -798.918274848243, -6.706523834973206, -643.7143409626783, -433.2371077151119, -420.26014569735685, -674.7995015969269, -585.3203265103815, -73.73129043606411, -31.779006357576918, -475.47222687063055, -480.2905171467121, 176.3738389534567, -65.74472670610734, -229.55288233995535, -737.7326092327569, -419.6884266010964, -541.3974215975901, -458.5428029268167, -345.7242574124854, -908.2901896141809, 285.54146741138464, -439.73112052566717, -529.7906415048815, -642.1973289885832, -557.0793321874679, -171.68368670844174, -626.4976142070063, -551.016357522361, 235.9494801367001, -475.67027400667325, -637.6126788022522, -42.30799247890036, 352.4808858209359, -502.1854136518765, -604.5770494226188, -571.3223460158559, -513.2267019926759, -485.19950275910674, -517.9570549300958, -358.76689345383, -687.063667164409, -24.93472330867354, -327.66139818622935, -556.0220566307424, -700.053992640908, -395.6345654330703, -459.75474201729844, -179.317126379861, -511.43539556511314, -298.0434197520327, -521.1818920770097, -117.61394102748474, -54.74723923881692, 19.741464206390074, -392.2131150152856, -307.6723315922214, 24.96588742064958, -106.2955278578463, -650.9237719062232, -145.166091453682, -417.9623872583739, 88.23718143272491, -447.6879121750722, -758.8581064130175, -579.4825100350172, -548.9798919174982, -181.13811689122952, -627.9784008508407, -759.009544743175, -683.7188486017876, -149.23958380489432, -608.2397058874398, -175.83078977673247, -88.2888480719598, -649.4451835959326, -711.7610951852255, -356.84388024501476, -754.8178826478245, -220.37597365334483, -415.99398239555717, -332.7854383961283, -96.37524412340154, -772.912032261251, -644.1722539357257, -476.3970262156973, -181.19148078344722, -297.5306211609721, -152.69980955570472, -470.6204394173809], "policy_predator_policy_reward": [635.8450322749142, 476.9913875670019, 548.6477708532834, 80.72489768685867, 758.2580813042866, 719.7714060813485, 18.761838723853998, 1295.5635811089662, 403.6420491276399, 602.7960826553946, 1042.3587822467182, 292.3929224545725, 606.7707611571716, 725.8726248237541, 516.8423000219688, 595.6895223183262, 466.6028154329243, 691.4194928115197, 403.5390036320207, 378.61819642556605, 17.45664878397534, 760.5052478104917, 510.57376155733857, 539.077574625524, 19.047750270053463, 153.10988603099273, 743.6012293167113, 569.9273058015124, 306.83272704820934, 619.0051725079987, 335.17766593678886, 322.7244515511171, 415.8994816293097, 559.1914691327205, 706.3095861079959, 1353.0791970866871, 270.52120324437556, 1054.177055195423, 631.3763005959786, 488.5119339496109, 717.5398367153645, 612.8095207896993, 510.93921973017325, 624.3273795039426, 511.4967805234454, 183.50170433042084, 733.0008264652804, 628.7644402093096, 528.539442603832, 174.37106560409524, 319.728065279716, 480.6748432463215, 475.85822429691217, 424.06684739612626, 600.6734697914442, 439.4320147146421, 394.7688740564603, 579.7011202277608, 616.8374599865897, 638.0460577661879, 0.0, 49.700072716266654, 374.80680019875285, 635.498739361829, 673.6113066742923, 133.65632877912995, 619.1150044864848, 609.5849661927375, 484.77258500299786, 560.5900118418724, 688.4873731792036, 576.313481172264, 509.94997575604447, 79.39035250814644, 517.7691004745755, 65.0553231070129, 258.9200403351205, 457.24803420449274, 634.1196777286547, 972.63792626618, 713.7896683386997, 945.6751968379439, 528.5848052445205, 538.8536629638362, 269.91723246845004, 388.33054630171875, 562.4371196744789, 760.601382305675, 15.066178077261755, 446.53316829993344, 554.117193649725, 4.192312060256737, 544.9888282262953, 465.5581607933731, 818.5087138594788, 174.09609625109817, 571.9640889234124, 487.14204147796784, 682.0892560709935, 700.8928675174973, 78.14614277446847, 377.41745054627563, 185.14490225868386, 748.7298429833864, 539.740643893651, 819.5452843337473, 743.1516483459626, 499.7929907573731, 390.551418605658, 770.8081057309755, 568.1999262433246, 754.3989635262283, 109.80551706182082, 604.1048377504378, 703.1380524343302, 282.6102874995816, 729.3480276230249, 792.3510767462399, 191.531290436063, 273.27900635757715, 502.563202971199, 635.7652010829509, 260.737442900329, 117.43344485232124, 244.43441611775958, 715.8414094667658, 430.588426601098, 557.4974215975909, 390.27091935028534, 516.1489577765977, 818.0949933331099, 227.56079509804783, 458.9467848556464, 537.6602691667568, 647.0505229597424, 562.5570538603235, 422.94131806721487, 578.1903884324804, 581.1809610271938, 92.04620392120003, 617.4092693600785, 623.1274636010427, 239.93392584982152, 26.593180808142797, 510.83095959543846, 606.8601129416373, 833.5206837201013, 571.193945173174, 488.8995027591076, 524.557054930097, 853.1412037918683, 300.1777104918024, 164.5169559353455, 286.52262937543975, 583.5194742287442, 704.753992640909, 398.17161618521175, 729.0485685537441, 154.027945509357, 738.0831304679373, 550.2438668534609, 376.92040387810266, 242.9807512820164, 259.1355191873617, 129.42789631297808, 307.87138512244667, 480.0541040302693, 224.41060360272166, 803.6341948090134, 77.21919143477194, 285.66609145368216, 432.26238725837715, 470.0397541811003, 242.83237226729932, 764.558106413018, 583.382510035018, 489.8589961527378, 347.0735538644747, 661.675099991942, 754.7095447431752, 302.0212960721108, 604.0681301637135, 602.6681831595238, 227.16158126760484, 382.36833146659353, 650.5378149738756, 668.5723321591643, 513.5360587080919, 726.855035080595, 280.73882122057313, 432.36691668965165, 354.88543839613334, 292.3823033956973, 774.5808672355647, 634.6993028197978, 697.1577961513226, 209.41387053654262, 393.6140009746257, 434.4650137795251, 248.4312037658976]}, "sampler_perf": {"mean_raw_obs_processing_ms": 11.996632951076595, "mean_inference_ms": 5.872397721845073, "mean_action_processing_ms": 4.5446313051639295, "mean_env_wait_ms": 11.674616487164483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.053830862045288086, "StateBufferConnector_ms": 0.06875526905059814, "ViewRequirementAgentConnector_ms": 0.26517510414123535}, "num_episodes": 13, "episode_return_max": 626.1002222570014, "episode_return_min": -22.679864758063605, "episode_return_mean": 170.1466909317688, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 0.21964115806992873, "num_env_steps_trained_throughput_per_sec": 0.21964115806992873, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 4204782.261, "restore_workers_time_ms": 0.018, "training_step_time_ms": 4204782.194, "sample_time_ms": 92959.8, "learn_time_ms": 4111787.592, "learn_throughput": 0.973, "synch_weights_time_ms": 29.37}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "fed12_00000", "date": "2024-08-22_07-44-00", "timestamp": 1724292840, "time_this_iter_s": 18211.742760181427, "time_total_s": 49163.20901441574, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f33fa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 49163.20901441574, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 61.82727272727272, "ram_util_percent": 84.39292929292931}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.830580440652433, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.830168335526078, "policy_loss": -0.015615849570302223, "vf_loss": 6.843073470251901, "vf_explained_var": 0.42906004111602825, "kl": 0.013553547905511642, "entropy": 0.5854305619442904, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.219465166046504, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.61917891275315, "policy_loss": -0.02411271263857584, "vf_loss": 6.640474174388502, "vf_explained_var": 0.024671449263890585, "kl": 0.014087232137000355, "entropy": 0.3648231979006182, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 707.5833443176748, "episode_reward_min": -22.679864758063605, "episode_reward_mean": 173.14896722817488, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1350.2791970866872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 354.98685994337797, "predator_policy": 1353.0791970866871}, "policy_reward_mean": {"prey_policy": -392.5128028346406, "predator_policy": 479.0872864487285}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.28188167795458, 252.48736288020035, 193.05186434997788, -12.25426925407946, 492.19504751458544, 366.8813224377411, 133.62599069997543, 27.09999999999998, 277.5, 83.13100512558754, 4.1230030425394695, 15.00079410542924, 276.40000000000003, 10.699999999999985, 230.1999999999998, 211.9229828534196, 251.81671417407406, 168.69336349005442, 6.623653174349594, 6.199999999999992, 402.3000000000021, 334.01991740489314, 255.7, 176.0355074836529, 414.88215076493293, 16.969594554145743, -22.679864758063605, 344.90000000000066, 115.49999999999997, 488.13686433905065, 15.199999999999907, 217.29077197870868, 37.06101956850324, 43.45988920668891, 91.45558756177488, 48.658965163763675, 10.242023230295509, 41.58796404537823, 19.000596697430247, 327.94008462484703, 327.59643487604274, 58.09963689542565, 56.90000000000009, 68.29999999999995, 438.5227739885259, 235.9206478353401, 63.48949001460645, 132.25108652143706, 261.57927626195647, 359.30000000000155, 182.56566003680652, 488.7999999999998, -7.009665988185674, 27.00000000000012, 102.15281678757681, 422.90706622836075, 27.08529199185387, 10.33091564401349, 202.95040558424853, 358.1602875627319, 127.25378015219589, 576.6999999999998, 10.928609462578565, 320.1655808847436, 10.299999999999985, 107.48835366542818, 98.4434638158766, 32.19741759799957, 271.8308772885839, 201.35855403231727, 107.93895890252118, 329.75509020307857, 64.82763062652663, 421.75826346141923, 123.63408647971372, 154.79999999999993, 353.4213957060508, 9.599999999999994, 106.81454120848412, 29.39669914110094, 73.13099382914213, 45.75926876295792, 295.17211477257825, 113.50341543701279, 32.40000000000021, 38.47293429409479, 197.67589424661045, 211.28781881969275, 124.30576956675, 59.57596857233827, 156.6039474657114, 196.42232660642256, 576.8620364197458, 707.5833443176748, 88.64251008088385, 39.4000000000002, 30.200000000000134, 428.2000000000026, 63.94509059242745, 160.89607402626248], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-213.45833930215048, -538.2216756143625, -649.4748821700646, -147.68909113259753, 145.43869556402498, -124.54446751509334, -723.6444581111111, -602.1383462611926, -751.1901747370628, 317.54732269544326, -499.41033575904964, 208.38954070888548, -343.80796554358034, -497.6569945184733, -682.0095861079958, -1350.2791970866872, 6.878796755625672, -1054.077055195423, -620.540553148239, -416.21667627176095, -446.5916156946586, -879.6347387678666, -500.6392197301709, -619.6265853985132, -503.29678052344354, 84.6982956695791, -727.0008264652803, -624.0644402093085, -521.6394426038304, 48.92893439590455, -171.82747218817764, -416.6524534844396, -372.5191651558304, -275.5891923631267, -611.3198857660992, -260.0922352499262, -398.28766554586196, -569.5586755640038, -614.3374599865897, -634.3460577661871, 343.15836924702927, 9.441558036704173, -695.227186002172, 18.941563846480204, -669.4113066742923, 117.84367122086968, -156.35607608666763, -896.3083871089044, -280.9510322343072, -349.5294138456273, -662.157319050785, -585.6739407465354, -163.44290948272007, -448.5772835395362, -509.86910047457474, 271.9446768929873, -150.82004033512123, -449.84803420449197, -47.76757197640154, -1070.8531676793891, -703.3896683386973, -940.8751968379437, -648.1811878247722, -201.96650840487513, -253.28799000810443, -367.89876919355885, -565.1271141969668, -714.4514985764948, 2.688704485110586, -372.8324633005295, -83.41483880172946, -426.2357017444911, -541.018104987284, -459.2868608020888, -804.2320912934106, -146.78475477178696, -600.1930986070374, -439.91243509691174, -588.5301829358974, -466.51185602774444, -184.95629460867278, 56.98913616396709, -498.5044149837173, -377.2706933629257, -487.44064389364905, -814.9452843337463, -737.7516483459614, -436.89299075737335, -878.2813514287959, 155.44460108068972, -287.75996708596585, -798.918274848243, -6.706523834973206, -643.7143409626783, -433.2371077151119, -420.26014569735685, -674.7995015969269, -585.3203265103815, -73.73129043606411, -31.779006357576918, -475.47222687063055, -480.2905171467121, 176.3738389534567, -65.74472670610734, -229.55288233995535, -737.7326092327569, -419.6884266010964, -541.3974215975901, -458.5428029268167, -345.7242574124854, -908.2901896141809, 285.54146741138464, -439.73112052566717, -529.7906415048815, -642.1973289885832, -557.0793321874679, -171.68368670844174, -626.4976142070063, -551.016357522361, 235.9494801367001, -475.67027400667325, -637.6126788022522, -42.30799247890036, 352.4808858209359, -502.1854136518765, -604.5770494226188, -571.3223460158559, -513.2267019926759, -485.19950275910674, -517.9570549300958, -358.76689345383, -687.063667164409, -24.93472330867354, -327.66139818622935, -556.0220566307424, -700.053992640908, -395.6345654330703, -459.75474201729844, -179.317126379861, -511.43539556511314, -298.0434197520327, -521.1818920770097, -117.61394102748474, -54.74723923881692, 19.741464206390074, -392.2131150152856, -307.6723315922214, 24.96588742064958, -106.2955278578463, -650.9237719062232, -145.166091453682, -417.9623872583739, 88.23718143272491, -447.6879121750722, -758.8581064130175, -579.4825100350172, -548.9798919174982, -181.13811689122952, -627.9784008508407, -759.009544743175, -683.7188486017876, -149.23958380489432, -608.2397058874398, -175.83078977673247, -88.2888480719598, -649.4451835959326, -711.7610951852255, -356.84388024501476, -754.8178826478245, -220.37597365334483, -415.99398239555717, -332.7854383961283, -96.37524412340154, -772.912032261251, -644.1722539357257, -476.3970262156973, -181.19148078344722, -297.5306211609721, -152.69980955570472, -470.6204394173809, -337.90240670704395, -706.7198134876832, -126.9609797035634, -170.67106393429248, -708.7069907039399, 36.86018152366823, 248.76887830133245, 354.98685994337797, -413.26367290276073, -738.0458715588114, -326.0374379719703, -645.7313943705851, -367.92227250108, -682.9914072449, 61.87020717992297, 302.4517005224675, -462.69274563121087, -730.3043896047828, -177.91783675377022, -803.3475377247329], "policy_predator_policy_reward": [17.45664878397534, 760.5052478104917, 510.57376155733857, 539.077574625524, 19.047750270053463, 153.10988603099273, 743.6012293167113, 569.9273058015124, 306.83272704820934, 619.0051725079987, 335.17766593678886, 322.7244515511171, 415.8994816293097, 559.1914691327205, 706.3095861079959, 1353.0791970866871, 270.52120324437556, 1054.177055195423, 631.3763005959786, 488.5119339496109, 717.5398367153645, 612.8095207896993, 510.93921973017325, 624.3273795039426, 511.4967805234454, 183.50170433042084, 733.0008264652804, 628.7644402093096, 528.539442603832, 174.37106560409524, 319.728065279716, 480.6748432463215, 475.85822429691217, 424.06684739612626, 600.6734697914442, 439.4320147146421, 394.7688740564603, 579.7011202277608, 616.8374599865897, 638.0460577661879, 0.0, 49.700072716266654, 374.80680019875285, 635.498739361829, 673.6113066742923, 133.65632877912995, 619.1150044864848, 609.5849661927375, 484.77258500299786, 560.5900118418724, 688.4873731792036, 576.313481172264, 509.94997575604447, 79.39035250814644, 517.7691004745755, 65.0553231070129, 258.9200403351205, 457.24803420449274, 634.1196777286547, 972.63792626618, 713.7896683386997, 945.6751968379439, 528.5848052445205, 538.8536629638362, 269.91723246845004, 388.33054630171875, 562.4371196744789, 760.601382305675, 15.066178077261755, 446.53316829993344, 554.117193649725, 4.192312060256737, 544.9888282262953, 465.5581607933731, 818.5087138594788, 174.09609625109817, 571.9640889234124, 487.14204147796784, 682.0892560709935, 700.8928675174973, 78.14614277446847, 377.41745054627563, 185.14490225868386, 748.7298429833864, 539.740643893651, 819.5452843337473, 743.1516483459626, 499.7929907573731, 390.551418605658, 770.8081057309755, 568.1999262433246, 754.3989635262283, 109.80551706182082, 604.1048377504378, 703.1380524343302, 282.6102874995816, 729.3480276230249, 792.3510767462399, 191.531290436063, 273.27900635757715, 502.563202971199, 635.7652010829509, 260.737442900329, 117.43344485232124, 244.43441611775958, 715.8414094667658, 430.588426601098, 557.4974215975909, 390.27091935028534, 516.1489577765977, 818.0949933331099, 227.56079509804783, 458.9467848556464, 537.6602691667568, 647.0505229597424, 562.5570538603235, 422.94131806721487, 578.1903884324804, 581.1809610271938, 92.04620392120003, 617.4092693600785, 623.1274636010427, 239.93392584982152, 26.593180808142797, 510.83095959543846, 606.8601129416373, 833.5206837201013, 571.193945173174, 488.8995027591076, 524.557054930097, 853.1412037918683, 300.1777104918024, 164.5169559353455, 286.52262937543975, 583.5194742287442, 704.753992640909, 398.17161618521175, 729.0485685537441, 154.027945509357, 738.0831304679373, 550.2438668534609, 376.92040387810266, 242.9807512820164, 259.1355191873617, 129.42789631297808, 307.87138512244667, 480.0541040302693, 224.41060360272166, 803.6341948090134, 77.21919143477194, 285.66609145368216, 432.26238725837715, 470.0397541811003, 242.83237226729932, 764.558106413018, 583.382510035018, 489.8589961527378, 347.0735538644747, 661.675099991942, 754.7095447431752, 302.0212960721108, 604.0681301637135, 602.6681831595238, 227.16158126760484, 382.36833146659353, 650.5378149738756, 668.5723321591643, 513.5360587080919, 726.855035080595, 280.73882122057313, 432.36691668965165, 354.88543839613334, 292.3823033956973, 774.5808672355647, 634.6993028197978, 697.1577961513226, 209.41387053654262, 393.6140009746257, 434.4650137795251, 248.4312037658976, 617.2652589540304, 583.960908706412, 292.1609797035638, 201.89339054071422, 567.997192595962, 680.7116530040545, 79.43112169866754, 24.396484374296904, 424.49630006497796, 815.4557544774816, 537.1941743849835, 473.9746579575746, 392.9222725010811, 688.1914072449003, 22.129792820077494, 41.748299477532576, 476.87405342874195, 780.0681723996778, 401.79863482906603, 740.3628136756981]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.17834039790607, "mean_inference_ms": 5.89707380485098, "mean_action_processing_ms": 7.0356672214685405, "mean_env_wait_ms": 12.529419618528362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05345487594604492, "StateBufferConnector_ms": 0.07337415218353271, "ViewRequirementAgentConnector_ms": 0.2744870185852051}, "num_episodes": 10, "episode_return_max": 707.5833443176748, "episode_return_min": -22.679864758063605, "episode_return_mean": 173.14896722817488, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.98705219455347, "num_env_steps_trained_throughput_per_sec": 71.98705219455347, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 4114654.013, "restore_workers_time_ms": 0.018, "training_step_time_ms": 4114653.943, "sample_time_ms": 93174.329, "learn_time_ms": 4021444.482, "learn_throughput": 0.995, "synch_weights_time_ms": 29.483}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "fed12_00000", "date": "2024-08-22_07-44-56", "timestamp": 1724292896, "time_this_iter_s": 55.62992262840271, "time_total_s": 49218.838937044144, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16f713550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 49218.838937044144, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 58.217721518987354, "ram_util_percent": 83.61518987341772}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.09385862640603, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.2690606995234415, "policy_loss": -0.020771944324027687, "vf_loss": 6.287365321255235, "vf_explained_var": 0.461263382844824, "kl": 0.0123366246982995, "entropy": 0.5970234236704609, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.920304186445065, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.4010882175788675, "policy_loss": -0.018940694989000875, "vf_loss": 6.417663254308953, "vf_explained_var": 0.14106487149284, "kl": 0.011828247152475848, "entropy": 0.3357890771179603, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 707.5833443176748, "episode_reward_min": -22.679864758063605, "episode_reward_mean": 173.67900929037893, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1070.8531676793891, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 375.557575305272, "predator_policy": 972.63792626618}, "policy_reward_mean": {"prey_policy": -382.50081483799545, "predator_policy": 469.3403194831854}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.13100512558754, 4.1230030425394695, 15.00079410542924, 276.40000000000003, 10.699999999999985, 230.1999999999998, 211.9229828534196, 251.81671417407406, 168.69336349005442, 6.623653174349594, 6.199999999999992, 402.3000000000021, 334.01991740489314, 255.7, 176.0355074836529, 414.88215076493293, 16.969594554145743, -22.679864758063605, 344.90000000000066, 115.49999999999997, 488.13686433905065, 15.199999999999907, 217.29077197870868, 37.06101956850324, 43.45988920668891, 91.45558756177488, 48.658965163763675, 10.242023230295509, 41.58796404537823, 19.000596697430247, 327.94008462484703, 327.59643487604274, 58.09963689542565, 56.90000000000009, 68.29999999999995, 438.5227739885259, 235.9206478353401, 63.48949001460645, 132.25108652143706, 261.57927626195647, 359.30000000000155, 182.56566003680652, 488.7999999999998, -7.009665988185674, 27.00000000000012, 102.15281678757681, 422.90706622836075, 27.08529199185387, 10.33091564401349, 202.95040558424853, 358.1602875627319, 127.25378015219589, 576.6999999999998, 10.928609462578565, 320.1655808847436, 10.299999999999985, 107.48835366542818, 98.4434638158766, 32.19741759799957, 271.8308772885839, 201.35855403231727, 107.93895890252118, 329.75509020307857, 64.82763062652663, 421.75826346141923, 123.63408647971372, 154.79999999999993, 353.4213957060508, 9.599999999999994, 106.81454120848412, 29.39669914110094, 73.13099382914213, 45.75926876295792, 295.17211477257825, 113.50341543701279, 32.40000000000021, 38.47293429409479, 197.67589424661045, 211.28781881969275, 124.30576956675, 59.57596857233827, 156.6039474657114, 196.42232660642256, 576.8620364197458, 707.5833443176748, 88.64251008088385, 39.4000000000002, 30.200000000000134, 428.2000000000026, 63.94509059242745, 160.89607402626248, 472.4537914031132, 25.20000000000003, 52.649032946653094, 350.85763221223453, 26.50714699606742, 91.2759587250209, 410.8000000000027, 183.9247682113118, 196.20507603235828], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-620.540553148239, -416.21667627176095, -446.5916156946586, -879.6347387678666, -500.6392197301709, -619.6265853985132, -503.29678052344354, 84.6982956695791, -727.0008264652803, -624.0644402093085, -521.6394426038304, 48.92893439590455, -171.82747218817764, -416.6524534844396, -372.5191651558304, -275.5891923631267, -611.3198857660992, -260.0922352499262, -398.28766554586196, -569.5586755640038, -614.3374599865897, -634.3460577661871, 343.15836924702927, 9.441558036704173, -695.227186002172, 18.941563846480204, -669.4113066742923, 117.84367122086968, -156.35607608666763, -896.3083871089044, -280.9510322343072, -349.5294138456273, -662.157319050785, -585.6739407465354, -163.44290948272007, -448.5772835395362, -509.86910047457474, 271.9446768929873, -150.82004033512123, -449.84803420449197, -47.76757197640154, -1070.8531676793891, -703.3896683386973, -940.8751968379437, -648.1811878247722, -201.96650840487513, -253.28799000810443, -367.89876919355885, -565.1271141969668, -714.4514985764948, 2.688704485110586, -372.8324633005295, -83.41483880172946, -426.2357017444911, -541.018104987284, -459.2868608020888, -804.2320912934106, -146.78475477178696, -600.1930986070374, -439.91243509691174, -588.5301829358974, -466.51185602774444, -184.95629460867278, 56.98913616396709, -498.5044149837173, -377.2706933629257, -487.44064389364905, -814.9452843337463, -737.7516483459614, -436.89299075737335, -878.2813514287959, 155.44460108068972, -287.75996708596585, -798.918274848243, -6.706523834973206, -643.7143409626783, -433.2371077151119, -420.26014569735685, -674.7995015969269, -585.3203265103815, -73.73129043606411, -31.779006357576918, -475.47222687063055, -480.2905171467121, 176.3738389534567, -65.74472670610734, -229.55288233995535, -737.7326092327569, -419.6884266010964, -541.3974215975901, -458.5428029268167, -345.7242574124854, -908.2901896141809, 285.54146741138464, -439.73112052566717, -529.7906415048815, -642.1973289885832, -557.0793321874679, -171.68368670844174, -626.4976142070063, -551.016357522361, 235.9494801367001, -475.67027400667325, -637.6126788022522, -42.30799247890036, 352.4808858209359, -502.1854136518765, -604.5770494226188, -571.3223460158559, -513.2267019926759, -485.19950275910674, -517.9570549300958, -358.76689345383, -687.063667164409, -24.93472330867354, -327.66139818622935, -556.0220566307424, -700.053992640908, -395.6345654330703, -459.75474201729844, -179.317126379861, -511.43539556511314, -298.0434197520327, -521.1818920770097, -117.61394102748474, -54.74723923881692, 19.741464206390074, -392.2131150152856, -307.6723315922214, 24.96588742064958, -106.2955278578463, -650.9237719062232, -145.166091453682, -417.9623872583739, 88.23718143272491, -447.6879121750722, -758.8581064130175, -579.4825100350172, -548.9798919174982, -181.13811689122952, -627.9784008508407, -759.009544743175, -683.7188486017876, -149.23958380489432, -608.2397058874398, -175.83078977673247, -88.2888480719598, -649.4451835959326, -711.7610951852255, -356.84388024501476, -754.8178826478245, -220.37597365334483, -415.99398239555717, -332.7854383961283, -96.37524412340154, -772.912032261251, -644.1722539357257, -476.3970262156973, -181.19148078344722, -297.5306211609721, -152.69980955570472, -470.6204394173809, -337.90240670704395, -706.7198134876832, -126.9609797035634, -170.67106393429248, -708.7069907039399, 36.86018152366823, 248.76887830133245, 354.98685994337797, -413.26367290276073, -738.0458715588114, -326.0374379719703, -645.7313943705851, -367.92227250108, -682.9914072449, 61.87020717992297, 302.4517005224675, -462.69274563121087, -730.3043896047828, -177.91783675377022, -803.3475377247329, -123.21506384550656, -288.37735593790933, -511.663635442421, -935.4803828802013, -548.1739301297515, 9.021245472855101, 176.38384936728073, -683.376632990387, -526.3294386844163, -426.29518577578256, -99.93550983744892, -294.5879110905898, 375.557575305272, -225.42275659780105, -129.60289944041153, -334.2941251693545, -455.6683746791106, -475.4900816461463], "policy_predator_policy_reward": [631.3763005959786, 488.5119339496109, 717.5398367153645, 612.8095207896993, 510.93921973017325, 624.3273795039426, 511.4967805234454, 183.50170433042084, 733.0008264652804, 628.7644402093096, 528.539442603832, 174.37106560409524, 319.728065279716, 480.6748432463215, 475.85822429691217, 424.06684739612626, 600.6734697914442, 439.4320147146421, 394.7688740564603, 579.7011202277608, 616.8374599865897, 638.0460577661879, 0.0, 49.700072716266654, 374.80680019875285, 635.498739361829, 673.6113066742923, 133.65632877912995, 619.1150044864848, 609.5849661927375, 484.77258500299786, 560.5900118418724, 688.4873731792036, 576.313481172264, 509.94997575604447, 79.39035250814644, 517.7691004745755, 65.0553231070129, 258.9200403351205, 457.24803420449274, 634.1196777286547, 972.63792626618, 713.7896683386997, 945.6751968379439, 528.5848052445205, 538.8536629638362, 269.91723246845004, 388.33054630171875, 562.4371196744789, 760.601382305675, 15.066178077261755, 446.53316829993344, 554.117193649725, 4.192312060256737, 544.9888282262953, 465.5581607933731, 818.5087138594788, 174.09609625109817, 571.9640889234124, 487.14204147796784, 682.0892560709935, 700.8928675174973, 78.14614277446847, 377.41745054627563, 185.14490225868386, 748.7298429833864, 539.740643893651, 819.5452843337473, 743.1516483459626, 499.7929907573731, 390.551418605658, 770.8081057309755, 568.1999262433246, 754.3989635262283, 109.80551706182082, 604.1048377504378, 703.1380524343302, 282.6102874995816, 729.3480276230249, 792.3510767462399, 191.531290436063, 273.27900635757715, 502.563202971199, 635.7652010829509, 260.737442900329, 117.43344485232124, 244.43441611775958, 715.8414094667658, 430.588426601098, 557.4974215975909, 390.27091935028534, 516.1489577765977, 818.0949933331099, 227.56079509804783, 458.9467848556464, 537.6602691667568, 647.0505229597424, 562.5570538603235, 422.94131806721487, 578.1903884324804, 581.1809610271938, 92.04620392120003, 617.4092693600785, 623.1274636010427, 239.93392584982152, 26.593180808142797, 510.83095959543846, 606.8601129416373, 833.5206837201013, 571.193945173174, 488.8995027591076, 524.557054930097, 853.1412037918683, 300.1777104918024, 164.5169559353455, 286.52262937543975, 583.5194742287442, 704.753992640909, 398.17161618521175, 729.0485685537441, 154.027945509357, 738.0831304679373, 550.2438668534609, 376.92040387810266, 242.9807512820164, 259.1355191873617, 129.42789631297808, 307.87138512244667, 480.0541040302693, 224.41060360272166, 803.6341948090134, 77.21919143477194, 285.66609145368216, 432.26238725837715, 470.0397541811003, 242.83237226729932, 764.558106413018, 583.382510035018, 489.8589961527378, 347.0735538644747, 661.675099991942, 754.7095447431752, 302.0212960721108, 604.0681301637135, 602.6681831595238, 227.16158126760484, 382.36833146659353, 650.5378149738756, 668.5723321591643, 513.5360587080919, 726.855035080595, 280.73882122057313, 432.36691668965165, 354.88543839613334, 292.3823033956973, 774.5808672355647, 634.6993028197978, 697.1577961513226, 209.41387053654262, 393.6140009746257, 434.4650137795251, 248.4312037658976, 617.2652589540304, 583.960908706412, 292.1609797035638, 201.89339054071422, 567.997192595962, 680.7116530040545, 79.43112169866754, 24.396484374296904, 424.49630006497796, 815.4557544774816, 537.1941743849835, 473.9746579575746, 392.9222725010811, 688.1914072449003, 22.129792820077494, 41.748299477532576, 476.87405342874195, 780.0681723996778, 401.79863482906603, 740.3628136756981, 492.9242170479627, 391.12199413856763, 527.9636354424218, 944.3803828802015, 572.2616785940536, 19.54003900949486, 195.10234850645557, 662.7480673288852, 319.4844307242491, 659.6473407320182, 307.0712331941209, 178.72814645893476, 12.442424694727992, 248.22275659779973, 298.0024003569744, 349.8193924641055, 501.3991506144766, 625.9643817431407]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.003776468560677, "mean_inference_ms": 8.356089344727232, "mean_action_processing_ms": 8.679752596814955, "mean_env_wait_ms": 13.373264101121551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.057736873626708984, "StateBufferConnector_ms": 0.07351624965667725, "ViewRequirementAgentConnector_ms": 0.2783374786376953}, "num_episodes": 9, "episode_return_max": 707.5833443176748, "episode_return_min": -22.679864758063605, "episode_return_mean": 173.67900929037893, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.38337011303456, "num_env_steps_trained_throughput_per_sec": 72.38337011303456, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 4115370.037, "restore_workers_time_ms": 0.018, "training_step_time_ms": 4115369.968, "sample_time_ms": 93299.341, "learn_time_ms": 4022033.739, "learn_throughput": 0.995, "synch_weights_time_ms": 31.567}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "fed12_00000", "date": "2024-08-22_07-45-52", "timestamp": 1724292952, "time_this_iter_s": 55.444292068481445, "time_total_s": 49274.283229112625, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f3d2550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 49274.283229112625, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 57.470886075949366, "ram_util_percent": 83.33544303797467}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.208961474832403, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.544888982823286, "policy_loss": -0.01910926564534998, "vf_loss": 6.561390953215342, "vf_explained_var": 0.38716054807895073, "kl": 0.013036484237656826, "entropy": 0.6046336477868771, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.377424094159768, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.581791094118956, "policy_loss": -0.020901015720443516, "vf_loss": 6.599915094728823, "vf_explained_var": 0.10027595550294906, "kl": 0.013885058026401099, "entropy": 0.3405367198444548, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 707.5833443176748, "episode_reward_min": -22.679864758063605, "episode_reward_mean": 187.744728064711, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1070.8531676793891, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 375.557575305272, "predator_policy": 972.63792626618}, "policy_reward_mean": {"prey_policy": -372.7270312337078, "predator_policy": 466.5993952660638}, "custom_metrics": {}, "hist_stats": {"episode_reward": [402.3000000000021, 334.01991740489314, 255.7, 176.0355074836529, 414.88215076493293, 16.969594554145743, -22.679864758063605, 344.90000000000066, 115.49999999999997, 488.13686433905065, 15.199999999999907, 217.29077197870868, 37.06101956850324, 43.45988920668891, 91.45558756177488, 48.658965163763675, 10.242023230295509, 41.58796404537823, 19.000596697430247, 327.94008462484703, 327.59643487604274, 58.09963689542565, 56.90000000000009, 68.29999999999995, 438.5227739885259, 235.9206478353401, 63.48949001460645, 132.25108652143706, 261.57927626195647, 359.30000000000155, 182.56566003680652, 488.7999999999998, -7.009665988185674, 27.00000000000012, 102.15281678757681, 422.90706622836075, 27.08529199185387, 10.33091564401349, 202.95040558424853, 358.1602875627319, 127.25378015219589, 576.6999999999998, 10.928609462578565, 320.1655808847436, 10.299999999999985, 107.48835366542818, 98.4434638158766, 32.19741759799957, 271.8308772885839, 201.35855403231727, 107.93895890252118, 329.75509020307857, 64.82763062652663, 421.75826346141923, 123.63408647971372, 154.79999999999993, 353.4213957060508, 9.599999999999994, 106.81454120848412, 29.39669914110094, 73.13099382914213, 45.75926876295792, 295.17211477257825, 113.50341543701279, 32.40000000000021, 38.47293429409479, 197.67589424661045, 211.28781881969275, 124.30576956675, 59.57596857233827, 156.6039474657114, 196.42232660642256, 576.8620364197458, 707.5833443176748, 88.64251008088385, 39.4000000000002, 30.200000000000134, 428.2000000000026, 63.94509059242745, 160.89607402626248, 472.4537914031132, 25.20000000000003, 52.649032946653094, 350.85763221223453, 26.50714699606742, 91.2759587250209, 410.8000000000027, 183.9247682113118, 196.20507603235828, 316.6554323211028, 69.04873949202612, 157.18513399416258, 460.5187433752789, 171.5143050945205, 129.72551457284771, 207.8209444553933, 312.850172843447, 389.89312311874886, 82.61378444835898, 373.55749968277985], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [343.15836924702927, 9.441558036704173, -695.227186002172, 18.941563846480204, -669.4113066742923, 117.84367122086968, -156.35607608666763, -896.3083871089044, -280.9510322343072, -349.5294138456273, -662.157319050785, -585.6739407465354, -163.44290948272007, -448.5772835395362, -509.86910047457474, 271.9446768929873, -150.82004033512123, -449.84803420449197, -47.76757197640154, -1070.8531676793891, -703.3896683386973, -940.8751968379437, -648.1811878247722, -201.96650840487513, -253.28799000810443, -367.89876919355885, -565.1271141969668, -714.4514985764948, 2.688704485110586, -372.8324633005295, -83.41483880172946, -426.2357017444911, -541.018104987284, -459.2868608020888, -804.2320912934106, -146.78475477178696, -600.1930986070374, -439.91243509691174, -588.5301829358974, -466.51185602774444, -184.95629460867278, 56.98913616396709, -498.5044149837173, -377.2706933629257, -487.44064389364905, -814.9452843337463, -737.7516483459614, -436.89299075737335, -878.2813514287959, 155.44460108068972, -287.75996708596585, -798.918274848243, -6.706523834973206, -643.7143409626783, -433.2371077151119, -420.26014569735685, -674.7995015969269, -585.3203265103815, -73.73129043606411, -31.779006357576918, -475.47222687063055, -480.2905171467121, 176.3738389534567, -65.74472670610734, -229.55288233995535, -737.7326092327569, -419.6884266010964, -541.3974215975901, -458.5428029268167, -345.7242574124854, -908.2901896141809, 285.54146741138464, -439.73112052566717, -529.7906415048815, -642.1973289885832, -557.0793321874679, -171.68368670844174, -626.4976142070063, -551.016357522361, 235.9494801367001, -475.67027400667325, -637.6126788022522, -42.30799247890036, 352.4808858209359, -502.1854136518765, -604.5770494226188, -571.3223460158559, -513.2267019926759, -485.19950275910674, -517.9570549300958, -358.76689345383, -687.063667164409, -24.93472330867354, -327.66139818622935, -556.0220566307424, -700.053992640908, -395.6345654330703, -459.75474201729844, -179.317126379861, -511.43539556511314, -298.0434197520327, -521.1818920770097, -117.61394102748474, -54.74723923881692, 19.741464206390074, -392.2131150152856, -307.6723315922214, 24.96588742064958, -106.2955278578463, -650.9237719062232, -145.166091453682, -417.9623872583739, 88.23718143272491, -447.6879121750722, -758.8581064130175, -579.4825100350172, -548.9798919174982, -181.13811689122952, -627.9784008508407, -759.009544743175, -683.7188486017876, -149.23958380489432, -608.2397058874398, -175.83078977673247, -88.2888480719598, -649.4451835959326, -711.7610951852255, -356.84388024501476, -754.8178826478245, -220.37597365334483, -415.99398239555717, -332.7854383961283, -96.37524412340154, -772.912032261251, -644.1722539357257, -476.3970262156973, -181.19148078344722, -297.5306211609721, -152.69980955570472, -470.6204394173809, -337.90240670704395, -706.7198134876832, -126.9609797035634, -170.67106393429248, -708.7069907039399, 36.86018152366823, 248.76887830133245, 354.98685994337797, -413.26367290276073, -738.0458715588114, -326.0374379719703, -645.7313943705851, -367.92227250108, -682.9914072449, 61.87020717992297, 302.4517005224675, -462.69274563121087, -730.3043896047828, -177.91783675377022, -803.3475377247329, -123.21506384550656, -288.37735593790933, -511.663635442421, -935.4803828802013, -548.1739301297515, 9.021245472855101, 176.38384936728073, -683.376632990387, -526.3294386844163, -426.29518577578256, -99.93550983744892, -294.5879110905898, 375.557575305272, -225.42275659780105, -129.60289944041153, -334.2941251693545, -455.6683746791106, -475.4900816461463, 210.8873025492031, -630.0458555956674, -587.6953754202436, -287.4340501813952, -444.3860785458773, -69.11474028116159, 44.36071564094622, -578.1881617155495, -525.9459771478588, -292.8339501328394, -416.6037298107371, -777.7848247527904, -538.9384716492261, 52.21336353034346, -533.2727205561553, -405.47493243232117, -526.4906129436246, -309.7857888542224, -287.1341950009269, -943.6774322611403, -565.1782899617104, 317.126614562645], "policy_predator_policy_reward": [0.0, 49.700072716266654, 374.80680019875285, 635.498739361829, 673.6113066742923, 133.65632877912995, 619.1150044864848, 609.5849661927375, 484.77258500299786, 560.5900118418724, 688.4873731792036, 576.313481172264, 509.94997575604447, 79.39035250814644, 517.7691004745755, 65.0553231070129, 258.9200403351205, 457.24803420449274, 634.1196777286547, 972.63792626618, 713.7896683386997, 945.6751968379439, 528.5848052445205, 538.8536629638362, 269.91723246845004, 388.33054630171875, 562.4371196744789, 760.601382305675, 15.066178077261755, 446.53316829993344, 554.117193649725, 4.192312060256737, 544.9888282262953, 465.5581607933731, 818.5087138594788, 174.09609625109817, 571.9640889234124, 487.14204147796784, 682.0892560709935, 700.8928675174973, 78.14614277446847, 377.41745054627563, 185.14490225868386, 748.7298429833864, 539.740643893651, 819.5452843337473, 743.1516483459626, 499.7929907573731, 390.551418605658, 770.8081057309755, 568.1999262433246, 754.3989635262283, 109.80551706182082, 604.1048377504378, 703.1380524343302, 282.6102874995816, 729.3480276230249, 792.3510767462399, 191.531290436063, 273.27900635757715, 502.563202971199, 635.7652010829509, 260.737442900329, 117.43344485232124, 244.43441611775958, 715.8414094667658, 430.588426601098, 557.4974215975909, 390.27091935028534, 516.1489577765977, 818.0949933331099, 227.56079509804783, 458.9467848556464, 537.6602691667568, 647.0505229597424, 562.5570538603235, 422.94131806721487, 578.1903884324804, 581.1809610271938, 92.04620392120003, 617.4092693600785, 623.1274636010427, 239.93392584982152, 26.593180808142797, 510.83095959543846, 606.8601129416373, 833.5206837201013, 571.193945173174, 488.8995027591076, 524.557054930097, 853.1412037918683, 300.1777104918024, 164.5169559353455, 286.52262937543975, 583.5194742287442, 704.753992640909, 398.17161618521175, 729.0485685537441, 154.027945509357, 738.0831304679373, 550.2438668534609, 376.92040387810266, 242.9807512820164, 259.1355191873617, 129.42789631297808, 307.87138512244667, 480.0541040302693, 224.41060360272166, 803.6341948090134, 77.21919143477194, 285.66609145368216, 432.26238725837715, 470.0397541811003, 242.83237226729932, 764.558106413018, 583.382510035018, 489.8589961527378, 347.0735538644747, 661.675099991942, 754.7095447431752, 302.0212960721108, 604.0681301637135, 602.6681831595238, 227.16158126760484, 382.36833146659353, 650.5378149738756, 668.5723321591643, 513.5360587080919, 726.855035080595, 280.73882122057313, 432.36691668965165, 354.88543839613334, 292.3823033956973, 774.5808672355647, 634.6993028197978, 697.1577961513226, 209.41387053654262, 393.6140009746257, 434.4650137795251, 248.4312037658976, 617.2652589540304, 583.960908706412, 292.1609797035638, 201.89339054071422, 567.997192595962, 680.7116530040545, 79.43112169866754, 24.396484374296904, 424.49630006497796, 815.4557544774816, 537.1941743849835, 473.9746579575746, 392.9222725010811, 688.1914072449003, 22.129792820077494, 41.748299477532576, 476.87405342874195, 780.0681723996778, 401.79863482906603, 740.3628136756981, 492.9242170479627, 391.12199413856763, 527.9636354424218, 944.3803828802015, 572.2616785940536, 19.54003900949486, 195.10234850645557, 662.7480673288852, 319.4844307242491, 659.6473407320182, 307.0712331941209, 178.72814645893476, 12.442424694727992, 248.22275659779973, 298.0024003569744, 349.8193924641055, 501.3991506144766, 625.9643817431407, 379.096792831238, 356.71719253633006, 301.45997120535986, 642.718193888307, 423.45161428067064, 247.23433854052936, 494.20112236598396, 500.14506708389865, 283.6701748760443, 706.6240574991843, 543.0086907282949, 781.1053784080841, 191.26392798216074, 503.28212459211994, 495.06998358606245, 756.5278422458637, 607.2075882952732, 618.9619366213234, 367.04797944928674, 946.3774322611403, 95.07529774409446, 526.5338773377524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.926918124698314, "mean_inference_ms": 9.196136819142353, "mean_action_processing_ms": 10.329480208198994, "mean_env_wait_ms": 15.03314653449356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05966007709503174, "StateBufferConnector_ms": 0.0737302303314209, "ViewRequirementAgentConnector_ms": 0.29155921936035156}, "num_episodes": 11, "episode_return_max": 707.5833443176748, "episode_return_min": -22.679864758063605, "episode_return_mean": 187.744728064711, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 69.53523021717085, "num_env_steps_trained_throughput_per_sec": 69.53523021717085, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 4116320.75, "restore_workers_time_ms": 0.435, "training_step_time_ms": 4116319.943, "sample_time_ms": 93528.607, "learn_time_ms": 4022753.301, "learn_throughput": 0.994, "synch_weights_time_ms": 32.05}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "fed12_00000", "date": "2024-08-22_07-46-50", "timestamp": 1724293010, "time_this_iter_s": 57.600399017333984, "time_total_s": 49331.88362812996, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f3deee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 49331.88362812996, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 57.28072289156627, "ram_util_percent": 83.46506024096387}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.539527196354335, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.163300092132003, "policy_loss": -0.0213066968694822, "vf_loss": 6.181706655088556, "vf_explained_var": 0.497722171601795, "kl": 0.014500652002564892, "entropy": 0.5770383677154621, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.277298004034336, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.336038884914741, "policy_loss": -0.025589505412428586, "vf_loss": 6.358759906809166, "vf_explained_var": 0.04708309091588177, "kl": 0.014342378778136754, "entropy": 0.3362971159516188, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 707.5833443176748, "episode_reward_min": -7.009665988185674, "episode_reward_mean": 190.068384163581, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1070.8531676793891, "predator_policy": 4.192312060256737}, "policy_reward_max": {"prey_policy": 394.407821499599, "predator_policy": 972.63792626618}, "policy_reward_mean": {"prey_policy": -370.9520411206393, "predator_policy": 465.98623320243047}, "custom_metrics": {}, "hist_stats": {"episode_reward": [344.90000000000066, 115.49999999999997, 488.13686433905065, 15.199999999999907, 217.29077197870868, 37.06101956850324, 43.45988920668891, 91.45558756177488, 48.658965163763675, 10.242023230295509, 41.58796404537823, 19.000596697430247, 327.94008462484703, 327.59643487604274, 58.09963689542565, 56.90000000000009, 68.29999999999995, 438.5227739885259, 235.9206478353401, 63.48949001460645, 132.25108652143706, 261.57927626195647, 359.30000000000155, 182.56566003680652, 488.7999999999998, -7.009665988185674, 27.00000000000012, 102.15281678757681, 422.90706622836075, 27.08529199185387, 10.33091564401349, 202.95040558424853, 358.1602875627319, 127.25378015219589, 576.6999999999998, 10.928609462578565, 320.1655808847436, 10.299999999999985, 107.48835366542818, 98.4434638158766, 32.19741759799957, 271.8308772885839, 201.35855403231727, 107.93895890252118, 329.75509020307857, 64.82763062652663, 421.75826346141923, 123.63408647971372, 154.79999999999993, 353.4213957060508, 9.599999999999994, 106.81454120848412, 29.39669914110094, 73.13099382914213, 45.75926876295792, 295.17211477257825, 113.50341543701279, 32.40000000000021, 38.47293429409479, 197.67589424661045, 211.28781881969275, 124.30576956675, 59.57596857233827, 156.6039474657114, 196.42232660642256, 576.8620364197458, 707.5833443176748, 88.64251008088385, 39.4000000000002, 30.200000000000134, 428.2000000000026, 63.94509059242745, 160.89607402626248, 472.4537914031132, 25.20000000000003, 52.649032946653094, 350.85763221223453, 26.50714699606742, 91.2759587250209, 410.8000000000027, 183.9247682113118, 196.20507603235828, 316.6554323211028, 69.04873949202612, 157.18513399416258, 460.5187433752789, 171.5143050945205, 129.72551457284771, 207.8209444553933, 312.850172843447, 389.89312311874886, 82.61378444835898, 373.55749968277985, 294.8313289638357, 349.77790882862115, 122.26994289602273, 183.84361560698878, 432.40000000000174, 31.034047907701655, 395.4360711333912], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-509.86910047457474, 271.9446768929873, -150.82004033512123, -449.84803420449197, -47.76757197640154, -1070.8531676793891, -703.3896683386973, -940.8751968379437, -648.1811878247722, -201.96650840487513, -253.28799000810443, -367.89876919355885, -565.1271141969668, -714.4514985764948, 2.688704485110586, -372.8324633005295, -83.41483880172946, -426.2357017444911, -541.018104987284, -459.2868608020888, -804.2320912934106, -146.78475477178696, -600.1930986070374, -439.91243509691174, -588.5301829358974, -466.51185602774444, -184.95629460867278, 56.98913616396709, -498.5044149837173, -377.2706933629257, -487.44064389364905, -814.9452843337463, -737.7516483459614, -436.89299075737335, -878.2813514287959, 155.44460108068972, -287.75996708596585, -798.918274848243, -6.706523834973206, -643.7143409626783, -433.2371077151119, -420.26014569735685, -674.7995015969269, -585.3203265103815, -73.73129043606411, -31.779006357576918, -475.47222687063055, -480.2905171467121, 176.3738389534567, -65.74472670610734, -229.55288233995535, -737.7326092327569, -419.6884266010964, -541.3974215975901, -458.5428029268167, -345.7242574124854, -908.2901896141809, 285.54146741138464, -439.73112052566717, -529.7906415048815, -642.1973289885832, -557.0793321874679, -171.68368670844174, -626.4976142070063, -551.016357522361, 235.9494801367001, -475.67027400667325, -637.6126788022522, -42.30799247890036, 352.4808858209359, -502.1854136518765, -604.5770494226188, -571.3223460158559, -513.2267019926759, -485.19950275910674, -517.9570549300958, -358.76689345383, -687.063667164409, -24.93472330867354, -327.66139818622935, -556.0220566307424, -700.053992640908, -395.6345654330703, -459.75474201729844, -179.317126379861, -511.43539556511314, -298.0434197520327, -521.1818920770097, -117.61394102748474, -54.74723923881692, 19.741464206390074, -392.2131150152856, -307.6723315922214, 24.96588742064958, -106.2955278578463, -650.9237719062232, -145.166091453682, -417.9623872583739, 88.23718143272491, -447.6879121750722, -758.8581064130175, -579.4825100350172, -548.9798919174982, -181.13811689122952, -627.9784008508407, -759.009544743175, -683.7188486017876, -149.23958380489432, -608.2397058874398, -175.83078977673247, -88.2888480719598, -649.4451835959326, -711.7610951852255, -356.84388024501476, -754.8178826478245, -220.37597365334483, -415.99398239555717, -332.7854383961283, -96.37524412340154, -772.912032261251, -644.1722539357257, -476.3970262156973, -181.19148078344722, -297.5306211609721, -152.69980955570472, -470.6204394173809, -337.90240670704395, -706.7198134876832, -126.9609797035634, -170.67106393429248, -708.7069907039399, 36.86018152366823, 248.76887830133245, 354.98685994337797, -413.26367290276073, -738.0458715588114, -326.0374379719703, -645.7313943705851, -367.92227250108, -682.9914072449, 61.87020717992297, 302.4517005224675, -462.69274563121087, -730.3043896047828, -177.91783675377022, -803.3475377247329, -123.21506384550656, -288.37735593790933, -511.663635442421, -935.4803828802013, -548.1739301297515, 9.021245472855101, 176.38384936728073, -683.376632990387, -526.3294386844163, -426.29518577578256, -99.93550983744892, -294.5879110905898, 375.557575305272, -225.42275659780105, -129.60289944041153, -334.2941251693545, -455.6683746791106, -475.4900816461463, 210.8873025492031, -630.0458555956674, -587.6953754202436, -287.4340501813952, -444.3860785458773, -69.11474028116159, 44.36071564094622, -578.1881617155495, -525.9459771478588, -292.8339501328394, -416.6037298107371, -777.7848247527904, -538.9384716492261, 52.21336353034346, -533.2727205561553, -405.47493243232117, -526.4906129436246, -309.7857888542224, -287.1341950009269, -943.6774322611403, -565.1782899617104, 317.126614562645, 98.4588116709698, -737.9894308876568, -546.8616653628359, 75.00425242271947, -800.3677774816397, -333.3363856731833, -328.58599279922413, -78.10990559106503, 394.407821499599, -613.1131365792158, -248.28374872910595, -472.9243492982404, 262.6551661203582, -734.2053291182472], "policy_predator_policy_reward": [517.7691004745755, 65.0553231070129, 258.9200403351205, 457.24803420449274, 634.1196777286547, 972.63792626618, 713.7896683386997, 945.6751968379439, 528.5848052445205, 538.8536629638362, 269.91723246845004, 388.33054630171875, 562.4371196744789, 760.601382305675, 15.066178077261755, 446.53316829993344, 554.117193649725, 4.192312060256737, 544.9888282262953, 465.5581607933731, 818.5087138594788, 174.09609625109817, 571.9640889234124, 487.14204147796784, 682.0892560709935, 700.8928675174973, 78.14614277446847, 377.41745054627563, 185.14490225868386, 748.7298429833864, 539.740643893651, 819.5452843337473, 743.1516483459626, 499.7929907573731, 390.551418605658, 770.8081057309755, 568.1999262433246, 754.3989635262283, 109.80551706182082, 604.1048377504378, 703.1380524343302, 282.6102874995816, 729.3480276230249, 792.3510767462399, 191.531290436063, 273.27900635757715, 502.563202971199, 635.7652010829509, 260.737442900329, 117.43344485232124, 244.43441611775958, 715.8414094667658, 430.588426601098, 557.4974215975909, 390.27091935028534, 516.1489577765977, 818.0949933331099, 227.56079509804783, 458.9467848556464, 537.6602691667568, 647.0505229597424, 562.5570538603235, 422.94131806721487, 578.1903884324804, 581.1809610271938, 92.04620392120003, 617.4092693600785, 623.1274636010427, 239.93392584982152, 26.593180808142797, 510.83095959543846, 606.8601129416373, 833.5206837201013, 571.193945173174, 488.8995027591076, 524.557054930097, 853.1412037918683, 300.1777104918024, 164.5169559353455, 286.52262937543975, 583.5194742287442, 704.753992640909, 398.17161618521175, 729.0485685537441, 154.027945509357, 738.0831304679373, 550.2438668534609, 376.92040387810266, 242.9807512820164, 259.1355191873617, 129.42789631297808, 307.87138512244667, 480.0541040302693, 224.41060360272166, 803.6341948090134, 77.21919143477194, 285.66609145368216, 432.26238725837715, 470.0397541811003, 242.83237226729932, 764.558106413018, 583.382510035018, 489.8589961527378, 347.0735538644747, 661.675099991942, 754.7095447431752, 302.0212960721108, 604.0681301637135, 602.6681831595238, 227.16158126760484, 382.36833146659353, 650.5378149738756, 668.5723321591643, 513.5360587080919, 726.855035080595, 280.73882122057313, 432.36691668965165, 354.88543839613334, 292.3823033956973, 774.5808672355647, 634.6993028197978, 697.1577961513226, 209.41387053654262, 393.6140009746257, 434.4650137795251, 248.4312037658976, 617.2652589540304, 583.960908706412, 292.1609797035638, 201.89339054071422, 567.997192595962, 680.7116530040545, 79.43112169866754, 24.396484374296904, 424.49630006497796, 815.4557544774816, 537.1941743849835, 473.9746579575746, 392.9222725010811, 688.1914072449003, 22.129792820077494, 41.748299477532576, 476.87405342874195, 780.0681723996778, 401.79863482906603, 740.3628136756981, 492.9242170479627, 391.12199413856763, 527.9636354424218, 944.3803828802015, 572.2616785940536, 19.54003900949486, 195.10234850645557, 662.7480673288852, 319.4844307242491, 659.6473407320182, 307.0712331941209, 178.72814645893476, 12.442424694727992, 248.22275659779973, 298.0024003569744, 349.8193924641055, 501.3991506144766, 625.9643817431407, 379.096792831238, 356.71719253633006, 301.45997120535986, 642.718193888307, 423.45161428067064, 247.23433854052936, 494.20112236598396, 500.14506708389865, 283.6701748760443, 706.6240574991843, 543.0086907282949, 781.1053784080841, 191.26392798216074, 503.28212459211994, 495.06998358606245, 756.5278422458637, 607.2075882952732, 618.9619366213234, 367.04797944928674, 946.3774322611403, 95.07529774409446, 526.5338773377524, 250.46706868494357, 683.8948794955764, 322.8831919168224, 498.7521298519174, 743.8301013693083, 512.1440046815427, 346.9859927992283, 243.55352119805406, 169.24671127841535, 481.85860380120323, 387.71445100284296, 364.52769493220484, 105.14637472069957, 761.839859410581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 25.162596345949012, "mean_inference_ms": 10.015005175877969, "mean_action_processing_ms": 11.147941054752726, "mean_env_wait_ms": 15.06534020143587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05981647968292236, "StateBufferConnector_ms": 0.07379257678985596, "ViewRequirementAgentConnector_ms": 0.32174527645111084}, "num_episodes": 7, "episode_return_max": 707.5833443176748, "episode_return_min": -7.009665988185674, "episode_return_mean": 190.068384163581, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 69.92349558662431, "num_env_steps_trained_throughput_per_sec": 69.92349558662431, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 4006496.021, "restore_workers_time_ms": 0.435, "training_step_time_ms": 4006495.212, "sample_time_ms": 93781.534, "learn_time_ms": 3912676.364, "learn_throughput": 1.022, "synch_weights_time_ms": 31.247}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "fed12_00000", "date": "2024-08-22_07-47-48", "timestamp": 1724293068, "time_this_iter_s": 57.2674298286438, "time_total_s": 49389.1510579586, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f3e5f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 49389.1510579586, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 48.12345679012345, "ram_util_percent": 82.62345679012344}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.85350148286769, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.386848070003368, "policy_loss": -0.016680699443720557, "vf_loss": 6.400996605807511, "vf_explained_var": 0.46727565523808595, "kl": 0.012660726634588428, "entropy": 0.5921739783551958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.058206176631666, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.088757557843728, "policy_loss": -0.02070904432884639, "vf_loss": 6.107173567474204, "vf_explained_var": 0.0688850753521793, "kl": 0.011465237607006674, "entropy": 0.32870381990122416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 707.5833443176748, "episode_reward_min": -7.009665988185674, "episode_reward_mean": 195.87378294214625, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -943.6774322611403, "predator_policy": 12.442424694727992}, "policy_reward_max": {"prey_policy": 394.407821499599, "predator_policy": 946.3774322611403}, "policy_reward_mean": {"prey_policy": -361.9663802831815, "predator_policy": 459.9032717542551}, "custom_metrics": {}, "hist_stats": {"episode_reward": [327.94008462484703, 327.59643487604274, 58.09963689542565, 56.90000000000009, 68.29999999999995, 438.5227739885259, 235.9206478353401, 63.48949001460645, 132.25108652143706, 261.57927626195647, 359.30000000000155, 182.56566003680652, 488.7999999999998, -7.009665988185674, 27.00000000000012, 102.15281678757681, 422.90706622836075, 27.08529199185387, 10.33091564401349, 202.95040558424853, 358.1602875627319, 127.25378015219589, 576.6999999999998, 10.928609462578565, 320.1655808847436, 10.299999999999985, 107.48835366542818, 98.4434638158766, 32.19741759799957, 271.8308772885839, 201.35855403231727, 107.93895890252118, 329.75509020307857, 64.82763062652663, 421.75826346141923, 123.63408647971372, 154.79999999999993, 353.4213957060508, 9.599999999999994, 106.81454120848412, 29.39669914110094, 73.13099382914213, 45.75926876295792, 295.17211477257825, 113.50341543701279, 32.40000000000021, 38.47293429409479, 197.67589424661045, 211.28781881969275, 124.30576956675, 59.57596857233827, 156.6039474657114, 196.42232660642256, 576.8620364197458, 707.5833443176748, 88.64251008088385, 39.4000000000002, 30.200000000000134, 428.2000000000026, 63.94509059242745, 160.89607402626248, 472.4537914031132, 25.20000000000003, 52.649032946653094, 350.85763221223453, 26.50714699606742, 91.2759587250209, 410.8000000000027, 183.9247682113118, 196.20507603235828, 316.6554323211028, 69.04873949202612, 157.18513399416258, 460.5187433752789, 171.5143050945205, 129.72551457284771, 207.8209444553933, 312.850172843447, 389.89312311874886, 82.61378444835898, 373.55749968277985, 294.8313289638357, 349.77790882862115, 122.26994289602273, 183.84361560698878, 432.40000000000174, 31.034047907701655, 395.4360711333912, 75.29999999999991, 217.89271749615915, 401.1019355272804, 51.06554060439834, 323.5198678242542, 58.68223304703364, 57.566170831720235, 337.70000000000107, 65.80000000000001, 11.783827436432098, 18.967316644485212, 433.6539502363519], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-588.5301829358974, -466.51185602774444, -184.95629460867278, 56.98913616396709, -498.5044149837173, -377.2706933629257, -487.44064389364905, -814.9452843337463, -737.7516483459614, -436.89299075737335, -878.2813514287959, 155.44460108068972, -287.75996708596585, -798.918274848243, -6.706523834973206, -643.7143409626783, -433.2371077151119, -420.26014569735685, -674.7995015969269, -585.3203265103815, -73.73129043606411, -31.779006357576918, -475.47222687063055, -480.2905171467121, 176.3738389534567, -65.74472670610734, -229.55288233995535, -737.7326092327569, -419.6884266010964, -541.3974215975901, -458.5428029268167, -345.7242574124854, -908.2901896141809, 285.54146741138464, -439.73112052566717, -529.7906415048815, -642.1973289885832, -557.0793321874679, -171.68368670844174, -626.4976142070063, -551.016357522361, 235.9494801367001, -475.67027400667325, -637.6126788022522, -42.30799247890036, 352.4808858209359, -502.1854136518765, -604.5770494226188, -571.3223460158559, -513.2267019926759, -485.19950275910674, -517.9570549300958, -358.76689345383, -687.063667164409, -24.93472330867354, -327.66139818622935, -556.0220566307424, -700.053992640908, -395.6345654330703, -459.75474201729844, -179.317126379861, -511.43539556511314, -298.0434197520327, -521.1818920770097, -117.61394102748474, -54.74723923881692, 19.741464206390074, -392.2131150152856, -307.6723315922214, 24.96588742064958, -106.2955278578463, -650.9237719062232, -145.166091453682, -417.9623872583739, 88.23718143272491, -447.6879121750722, -758.8581064130175, -579.4825100350172, -548.9798919174982, -181.13811689122952, -627.9784008508407, -759.009544743175, -683.7188486017876, -149.23958380489432, -608.2397058874398, -175.83078977673247, -88.2888480719598, -649.4451835959326, -711.7610951852255, -356.84388024501476, -754.8178826478245, -220.37597365334483, -415.99398239555717, -332.7854383961283, -96.37524412340154, -772.912032261251, -644.1722539357257, -476.3970262156973, -181.19148078344722, -297.5306211609721, -152.69980955570472, -470.6204394173809, -337.90240670704395, -706.7198134876832, -126.9609797035634, -170.67106393429248, -708.7069907039399, 36.86018152366823, 248.76887830133245, 354.98685994337797, -413.26367290276073, -738.0458715588114, -326.0374379719703, -645.7313943705851, -367.92227250108, -682.9914072449, 61.87020717992297, 302.4517005224675, -462.69274563121087, -730.3043896047828, -177.91783675377022, -803.3475377247329, -123.21506384550656, -288.37735593790933, -511.663635442421, -935.4803828802013, -548.1739301297515, 9.021245472855101, 176.38384936728073, -683.376632990387, -526.3294386844163, -426.29518577578256, -99.93550983744892, -294.5879110905898, 375.557575305272, -225.42275659780105, -129.60289944041153, -334.2941251693545, -455.6683746791106, -475.4900816461463, 210.8873025492031, -630.0458555956674, -587.6953754202436, -287.4340501813952, -444.3860785458773, -69.11474028116159, 44.36071564094622, -578.1881617155495, -525.9459771478588, -292.8339501328394, -416.6037298107371, -777.7848247527904, -538.9384716492261, 52.21336353034346, -533.2727205561553, -405.47493243232117, -526.4906129436246, -309.7857888542224, -287.1341950009269, -943.6774322611403, -565.1782899617104, 317.126614562645, 98.4588116709698, -737.9894308876568, -546.8616653628359, 75.00425242271947, -800.3677774816397, -333.3363856731833, -328.58599279922413, -78.10990559106503, 394.407821499599, -613.1131365792158, -248.28374872910595, -472.9243492982404, 262.6551661203582, -734.2053291182472, -670.9920532543687, -241.47446249411908, -366.66310617183746, -113.19873383277843, 20.902814896607165, -627.1288604293234, -290.0305976794656, -60.763604413760405, -119.44054293858176, -558.9402187907685, -493.8973184716708, -502.60811335854464, -520.4867255074457, -234.38291273149414, -309.3550682909977, 236.76687551004304, -651.340695179661, -382.78711358271744, -587.1839497406108, -393.4183345800656, -443.28146086688696, -489.72824797127544, -152.0757972989117, -474.97242140835283], "policy_predator_policy_reward": [682.0892560709935, 700.8928675174973, 78.14614277446847, 377.41745054627563, 185.14490225868386, 748.7298429833864, 539.740643893651, 819.5452843337473, 743.1516483459626, 499.7929907573731, 390.551418605658, 770.8081057309755, 568.1999262433246, 754.3989635262283, 109.80551706182082, 604.1048377504378, 703.1380524343302, 282.6102874995816, 729.3480276230249, 792.3510767462399, 191.531290436063, 273.27900635757715, 502.563202971199, 635.7652010829509, 260.737442900329, 117.43344485232124, 244.43441611775958, 715.8414094667658, 430.588426601098, 557.4974215975909, 390.27091935028534, 516.1489577765977, 818.0949933331099, 227.56079509804783, 458.9467848556464, 537.6602691667568, 647.0505229597424, 562.5570538603235, 422.94131806721487, 578.1903884324804, 581.1809610271938, 92.04620392120003, 617.4092693600785, 623.1274636010427, 239.93392584982152, 26.593180808142797, 510.83095959543846, 606.8601129416373, 833.5206837201013, 571.193945173174, 488.8995027591076, 524.557054930097, 853.1412037918683, 300.1777104918024, 164.5169559353455, 286.52262937543975, 583.5194742287442, 704.753992640909, 398.17161618521175, 729.0485685537441, 154.027945509357, 738.0831304679373, 550.2438668534609, 376.92040387810266, 242.9807512820164, 259.1355191873617, 129.42789631297808, 307.87138512244667, 480.0541040302693, 224.41060360272166, 803.6341948090134, 77.21919143477194, 285.66609145368216, 432.26238725837715, 470.0397541811003, 242.83237226729932, 764.558106413018, 583.382510035018, 489.8589961527378, 347.0735538644747, 661.675099991942, 754.7095447431752, 302.0212960721108, 604.0681301637135, 602.6681831595238, 227.16158126760484, 382.36833146659353, 650.5378149738756, 668.5723321591643, 513.5360587080919, 726.855035080595, 280.73882122057313, 432.36691668965165, 354.88543839613334, 292.3823033956973, 774.5808672355647, 634.6993028197978, 697.1577961513226, 209.41387053654262, 393.6140009746257, 434.4650137795251, 248.4312037658976, 617.2652589540304, 583.960908706412, 292.1609797035638, 201.89339054071422, 567.997192595962, 680.7116530040545, 79.43112169866754, 24.396484374296904, 424.49630006497796, 815.4557544774816, 537.1941743849835, 473.9746579575746, 392.9222725010811, 688.1914072449003, 22.129792820077494, 41.748299477532576, 476.87405342874195, 780.0681723996778, 401.79863482906603, 740.3628136756981, 492.9242170479627, 391.12199413856763, 527.9636354424218, 944.3803828802015, 572.2616785940536, 19.54003900949486, 195.10234850645557, 662.7480673288852, 319.4844307242491, 659.6473407320182, 307.0712331941209, 178.72814645893476, 12.442424694727992, 248.22275659779973, 298.0024003569744, 349.8193924641055, 501.3991506144766, 625.9643817431407, 379.096792831238, 356.71719253633006, 301.45997120535986, 642.718193888307, 423.45161428067064, 247.23433854052936, 494.20112236598396, 500.14506708389865, 283.6701748760443, 706.6240574991843, 543.0086907282949, 781.1053784080841, 191.26392798216074, 503.28212459211994, 495.06998358606245, 756.5278422458637, 607.2075882952732, 618.9619366213234, 367.04797944928674, 946.3774322611403, 95.07529774409446, 526.5338773377524, 250.46706868494357, 683.8948794955764, 322.8831919168224, 498.7521298519174, 743.8301013693083, 512.1440046815427, 346.9859927992283, 243.55352119805406, 169.24671127841535, 481.85860380120323, 387.71445100284296, 364.52769493220484, 105.14637472069957, 761.839859410581, 726.092053254369, 261.6744624941177, 382.6631061718405, 315.09145132893883, 453.7869512658025, 553.5410297941909, 335.3275384978693, 66.53220419975662, 464.31420684453553, 537.5864227090639, 543.4428010281429, 511.74486384910836, 402.390146523226, 410.04566254743406, 327.1550682910016, 83.13312448995687, 659.7406951796618, 440.1871135827183, 501.2436259535034, 491.14248580360766, 607.9902147668894, 343.9868107157593, 611.5029521712194, 449.19921677239677]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.359142125781922, "mean_inference_ms": 10.058290595353421, "mean_action_processing_ms": 14.32181217810195, "mean_env_wait_ms": 16.697857857670698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0576784610748291, "StateBufferConnector_ms": 0.07280898094177246, "ViewRequirementAgentConnector_ms": 0.3089827299118042}, "num_episodes": 12, "episode_return_max": 707.5833443176748, "episode_return_min": -7.009665988185674, "episode_return_mean": 195.87378294214625, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.9210335181429, "num_env_steps_trained_throughput_per_sec": 72.9210335181429, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 4007020.677, "restore_workers_time_ms": 0.436, "training_step_time_ms": 4007019.849, "sample_time_ms": 93769.011, "learn_time_ms": 3913212.478, "learn_throughput": 1.022, "synch_weights_time_ms": 32.198}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 100, "trial_id": "fed12_00000", "date": "2024-08-22_07-48-42", "timestamp": 1724293122, "time_this_iter_s": 54.92639207839966, "time_total_s": 49444.077450037, "pid": 98390, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f3de940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 49444.077450037, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 42.219230769230776, "ram_util_percent": 83.02820512820514}}
