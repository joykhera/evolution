{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.420429910065005, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.4933536047657965, "policy_loss": -0.018872267936994494, "vf_loss": 7.5103522989485, "vf_explained_var": 0.038833088944197965, "kl": 0.00936782683994838, "entropy": 1.602248367367598, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1847972547329924, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.1235253064089985, "policy_loss": -0.015788682339535582, "vf_loss": 6.137617583249612, "vf_explained_var": 0.03461070281487924, "kl": 0.00848199775363639, "entropy": 1.6035183024784876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.19215297390895, "num_env_steps_trained_throughput_per_sec": 67.19215297390895, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 59530.769, "restore_workers_time_ms": 0.027, "training_step_time_ms": 59530.704, "sample_time_ms": 4923.968, "learn_time_ms": 54587.896, "learn_throughput": 73.276, "synch_weights_time_ms": 14.56}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "42d11_00000", "date": "2024-08-22_10-11-47", "timestamp": 1724301707, "time_this_iter_s": 59.6135790348053, "time_total_s": 59.6135790348053, "pid": 75262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3179dbc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 59.6135790348053, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 38.37674418604651, "ram_util_percent": 83.41744186046512}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9850671977593155, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.253848385936999, "policy_loss": -0.02440330120192831, "vf_loss": 6.275493036754548, "vf_explained_var": 0.1555214242329673, "kl": 0.013793243940737315, "entropy": 1.5845141485885337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7278851124660048, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.0404601031510285, "policy_loss": -0.02080368940772676, "vf_loss": 4.0594542996593255, "vf_explained_var": 0.09348934037344796, "kl": 0.00904746264824151, "entropy": 1.5919239061219352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.69105041250691, "num_env_steps_trained_throughput_per_sec": 70.69105041250691, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 58057.513, "restore_workers_time_ms": 0.022, "training_step_time_ms": 58057.451, "sample_time_ms": 3889.135, "learn_time_ms": 54149.074, "learn_throughput": 73.87, "synch_weights_time_ms": 14.068}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "42d11_00000", "date": "2024-08-22_10-12-46", "timestamp": 1724301766, "time_this_iter_s": 56.64615178108215, "time_total_s": 116.25973081588745, "pid": 75262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3179f60d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 116.25973081588745, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 34.11904761904762, "ram_util_percent": 83.34523809523809}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.551506335962386, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.803948314858492, "policy_loss": -0.027376170708581057, "vf_loss": 5.828842148705134, "vf_explained_var": 0.2234728427791091, "kl": 0.012411687935939029, "entropy": 1.5729137124207915, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3758062330976366, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.407711895180758, "policy_loss": -0.019977601103129843, "vf_loss": 2.4259622892374715, "vf_explained_var": 0.10650075639366473, "kl": 0.008636030246240023, "entropy": 1.585293627289868, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.86173462925727, "num_env_steps_trained_throughput_per_sec": 70.86173462925727, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 57520.996, "restore_workers_time_ms": 0.02, "training_step_time_ms": 57520.929, "sample_time_ms": 3528.124, "learn_time_ms": 53971.277, "learn_throughput": 74.113, "synch_weights_time_ms": 16.772}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "42d11_00000", "date": "2024-08-22_10-13-43", "timestamp": 1724301823, "time_this_iter_s": 56.507298946380615, "time_total_s": 172.76702976226807, "pid": 75262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317a29ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 172.76702976226807, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 34.1175, "ram_util_percent": 83.305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.019713652197015, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.875866694677444, "policy_loss": -0.02241201221391007, "vf_loss": 6.896212429218191, "vf_explained_var": 0.24924119102261053, "kl": 0.010331252241191803, "entropy": 1.5595941348050637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.472815508186502, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.5906562745886506, "policy_loss": -0.019981526766248325, "vf_loss": 2.6087445664658118, "vf_explained_var": 0.1111039312743636, "kl": 0.009466159605746349, "entropy": 1.575801379466183, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.37131218042182, "num_env_steps_trained_throughput_per_sec": 67.37131218042182, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 57983.862, "restore_workers_time_ms": 0.018, "training_step_time_ms": 57983.797, "sample_time_ms": 3250.414, "learn_time_ms": 54710.086, "learn_throughput": 73.113, "synch_weights_time_ms": 15.908}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "42d11_00000", "date": "2024-08-22_10-14-42", "timestamp": 1724301882, "time_this_iter_s": 59.41807794570923, "time_total_s": 232.1851077079773, "pid": 75262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317a29430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 232.1851077079773, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 45.345882352941175, "ram_util_percent": 83.42470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.863351241968296, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.188434556426195, "policy_loss": -0.019993417550410543, "vf_loss": 7.20645882187697, "vf_explained_var": 0.2946280834536073, "kl": 0.009845701768555771, "entropy": 1.5491046028162436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.903943438441665, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.483708633253814, "policy_loss": -0.016606428655771114, "vf_loss": 2.498269019429646, "vf_explained_var": 0.14496299870430476, "kl": 0.010230200836021039, "entropy": 1.566876236597697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 60.61492871014552, "num_env_steps_trained_throughput_per_sec": 60.61492871014552, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 59585.16, "restore_workers_time_ms": 0.018, "training_step_time_ms": 59585.098, "sample_time_ms": 3609.928, "learn_time_ms": 55953.302, "learn_throughput": 71.488, "synch_weights_time_ms": 15.373}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "42d11_00000", "date": "2024-08-22_10-15-48", "timestamp": 1724301948, "time_this_iter_s": 66.04653525352478, "time_total_s": 298.2316429615021, "pid": 75262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317a21a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 298.2316429615021, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 51.58494623655915, "ram_util_percent": 83.352688172043}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.746850161199217, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.224496056036974, "policy_loss": -0.018290648048635196, "vf_loss": 7.240519201440155, "vf_explained_var": 0.3306969391605841, "kl": 0.011337521955218146, "entropy": 1.5442940409221346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.516170933101543, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.50279804077098, "policy_loss": -0.02255392321176019, "vf_loss": 2.5230832870044404, "vf_explained_var": 0.1323599152779453, "kl": 0.01134333550663931, "entropy": 1.5530816360756203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 443.5999999999996, "episode_reward_min": 308.5000000000004, "episode_reward_mean": 386.60316466337207, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 1600, "policy_reward_min": {"prey_policy": -148.84848104647622, "predator_policy": 2.913880234268376}, "policy_reward_max": {"prey_policy": 254.66165915451973, "predator_policy": 282.54848104647556}, "policy_reward_mean": {"prey_policy": 68.51696082870153, "predator_policy": 124.78462150298418}, "custom_metrics": {}, "hist_stats": {"episode_reward": [443.5999999999996, 403.6126586534885, 308.5000000000004, 390.6999999999998], "episode_lengths": [400, 400, 400, 400], "policy_prey_policy_reward": [254.66165915451973, -148.84848104647622, 46.54809645131328, -0.15933929243822398, 113.5901013971576, 29.06834666347475, 151.4989051651397, 101.77639813692164], "policy_predator_policy_reward": [55.23834084548023, 282.54848104647556, 115.60244928612795, 241.62145220848356, 152.05730429922082, 13.784247640146733, 2.913880234268376, 134.51081646367027]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.721870604117354, "mean_inference_ms": 4.153258597369685, "mean_action_processing_ms": 2.9474341815897165, "mean_env_wait_ms": 8.120761056651983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003585219383239746, "StateBufferConnector_ms": 0.006809830665588379, "ViewRequirementAgentConnector_ms": 0.10055005550384521}, "num_episodes": 4, "episode_return_max": 443.5999999999996, "episode_return_min": 308.5000000000004, "episode_return_mean": 386.60316466337207, "episodes_this_iter": 4}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.46907826666259, "num_env_steps_trained_throughput_per_sec": 70.46907826666259, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 59114.715, "restore_workers_time_ms": 0.017, "training_step_time_ms": 59114.657, "sample_time_ms": 3598.459, "learn_time_ms": 55495.053, "learn_throughput": 72.078, "synch_weights_time_ms": 15.187}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "42d11_00000", "date": "2024-08-22_10-16-45", "timestamp": 1724302005, "time_this_iter_s": 56.808562994003296, "time_total_s": 355.04020595550537, "pid": 75262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317a21b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 355.04020595550537, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 37.150617283950616, "ram_util_percent": 82.62222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.82228256498695, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.379408018929618, "policy_loss": -0.021036490095316104, "vf_loss": 7.3981321980713535, "vf_explained_var": 0.292615526819986, "kl": 0.011561561107300418, "entropy": 1.5144921301533936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2308170749081504, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.102475698915108, "policy_loss": -0.02246594981502288, "vf_loss": 3.122222227457339, "vf_explained_var": 0.15262616793945352, "kl": 0.013597161391572583, "entropy": 1.5207244933597626, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 674.564741912714, "episode_reward_min": 57.60000000000057, "episode_reward_mean": 367.36296268715455, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 19600, "policy_reward_min": {"prey_policy": -378.81743325247857, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 374.26254498789046, "predator_policy": 444.0456626202494}, "policy_reward_mean": {"prey_policy": 43.52933993303373, "predator_policy": 140.15214141054338}, "custom_metrics": {}, "hist_stats": {"episode_reward": [443.5999999999996, 403.6126586534885, 308.5000000000004, 390.6999999999998, 333.0000000000008, 157.99999999999918, 475.19999999999914, 557.1000000000004, 212.4421500994732, 486.2566153506149, 245.99999999999926, 438.6, 522.3126343751014, 207.2999999999991, 674.564741912714, 387.89743510361706, 57.60000000000057, 395.2000000000018, 652.2209668045394, 353.2000000000013, 401.2718892821257, 277.8640674847281, 396.70000000000005, 494.69397010590694, 518.0999999999999, 269.02603614569955, 622.3000000000004, 476.8404824180572, 281.91884819218365, 393.30731209688736, 311.63634307194155, 473.2595778603908, 176.37177752656265, 164.49999999999974, 403.18517532440245, 72.69870652539684, 446.9000000000011, 379.90000000000214, 584.1999999999995, 338.7000000000003, 254.60000000000005, 554.5999999999999, 280.7999999999993, 225.69999999999936, 269.6037833367415, 233.69999999999948, 231.59999999999954, 241.69999999999933, 521.8000000000001], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [254.66165915451973, -148.84848104647622, 46.54809645131328, -0.15933929243822398, 113.5901013971576, 29.06834666347475, 151.4989051651397, 101.77639813692164, 237.03808348984825, -300.452585318284, -4.1386604991960905, -26.57157708377874, 138.35317174700913, 106.07685765193646, 110.54859486584559, 206.82244481519825, -251.90879753291497, -5.1451697964811505, 158.77030241511292, -50.207068550057926, -9.500149145165333, 125.97276427199463, -7.574536798859953, 196.4171216759204, -8.164722594613915, 135.96291314195622, -217.13633257839686, 35.49789734594148, 286.20904232265696, 341.5531756779858, 76.41963965803606, -197.69952605458366, -167.87353066447088, -192.984147111134, -130.3898474685518, 355.9, 310.3145257518031, 181.27547893986682, 199.06474949223326, -253.44928803261126, -129.25797700107833, 79.65733198268414, 14.623449186566837, -132.54585067618498, 166.34306899167362, 101.03299918553802, -155.64499965054182, 333.72967632073835, 169.49282752383405, 182.37690887277904, -233.63661094010416, -36.08554174809325, 93.02235544318043, 315.9913417452125, 26.197803140958072, 195.1873940231828, 121.94086918077289, 70.41552604859739, 254.39722707968696, 17.709148985223198, 32.99785774634465, 26.578806357569697, -41.22906694276864, 102.74223844795566, -233.75491595153346, -367.327148118678, -20.12540574994628, -94.12693706296461, 290.8634822716904, -37.95838495192863, -46.73430030345546, 26.93503177014102, -124.57719280899693, 367.1024765355587, -87.75520650751395, 325.6360363467, 19.207945549518, 374.26254498789046, -123.15105201194616, 160.0268387685803, -240.10529487073615, 108.45949694530822, 227.92330094719804, 110.9657583636405, 112.47608281211296, -21.673269373361773, -54.584764339878426, 113.13452139928529, -131.6160781073426, 112.05138975816396, -378.81743325247857, 119.95313466542555, 24.005124684427905, -122.00898124761895, 39.77991917049089, 63.89600579037268, 159.18354752184555, 91.15574583974981], "policy_predator_policy_reward": [55.23834084548023, 282.54848104647556, 115.60244928612795, 241.62145220848356, 152.05730429922082, 13.784247640146733, 2.913880234268376, 134.51081646367027, 54.26671035699884, 342.14779147143844, 42.638660499196426, 146.0715770837788, 106.29401425708494, 124.47595634396977, 89.8097404610125, 149.91921985794298, 362.0827376283182, 107.4133798005531, 314.13036400421237, 63.56301748134535, 94.66953499958223, 34.857849873589096, 200.47453679885967, 49.28287832407977, 207.2120421365127, 187.30240169124627, 244.43633257839545, 144.5021026540587, 16.941906338166113, 29.860617573905134, 287.8118841781542, 221.36543732201034, 196.57353066446998, 221.88414711113325, 169.68984746855, 0.0, 48.38106351846111, 112.24989859440822, 130.43525050776665, 277.149288032612, 279.03293859779734, 171.83959570272253, 144.5768613742725, 251.20960760007367, 47.85693100832634, 81.46700081446137, 237.89096565833256, 78.71832777737806, 115.70777850386821, 50.52248509951858, 369.57967666780144, 169.168512166094, 165.57764455681965, 47.708658254787515, 161.793182966877, 93.6621022870389, 48.633009617219976, 40.92944334559568, 31.602087504972882, 89.59884852700466, 187.63846457548394, 64.42121439254142, 159.52272407649747, 252.22368227870584, 333.40817897652437, 444.0456626202494, 130.80140596025694, 147.95093685265252, 23.289056906726938, 126.9910210979126, 89.0312696479177, 3.466705410792785, 150.53878959357596, 53.83592667986098, 142.0191701608125, 0.0, 176.1465314271378, 14.582978035453024, 155.55105201194604, 146.27316123141958, 39.49685081068813, 346.7489471147399, 72.07669905280181, 143.6342416363589, 133.52391718788715, 56.473269373362264, 142.53969130872977, 24.610551631862045, 278.64285312571616, 10.52561856020198, 409.2186428533573, 83.345655733696, 158.5948753155719, 171.0089812476192, 7.704423566923059, 130.3196514722129, 107.11046476106296, 164.3502418773413]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.905659610774115, "mean_inference_ms": 4.720610571834387, "mean_action_processing_ms": 2.9955310605530747, "mean_env_wait_ms": 9.010979172524445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003735873163962851, "StateBufferConnector_ms": 0.004839897155761719, "ViewRequirementAgentConnector_ms": 0.1112521911153988}, "num_episodes": 45, "episode_return_max": 674.564741912714, "episode_return_min": 57.60000000000057, "episode_return_mean": 367.36296268715455, "episodes_this_iter": 45}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.213872134703, "num_env_steps_trained_throughput_per_sec": 73.213872134703, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 58474.679, "restore_workers_time_ms": 0.016, "training_step_time_ms": 58474.615, "sample_time_ms": 3419.358, "learn_time_ms": 55034.184, "learn_throughput": 72.682, "synch_weights_time_ms": 15.399}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "42d11_00000", "date": "2024-08-22_10-17-40", "timestamp": 1724302060, "time_this_iter_s": 54.66729998588562, "time_total_s": 409.707505941391, "pid": 75262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3179f6f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 409.707505941391, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 31.720512820512813, "ram_util_percent": 82.71410256410256}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.862422602328044, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.287413022883985, "policy_loss": -0.02828839899548305, "vf_loss": 7.312288326182693, "vf_explained_var": 0.3352814722628821, "kl": 0.01706543002849218, "entropy": 1.4307371153402582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.414009663099965, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.869851418651601, "policy_loss": -0.025046088624617487, "vf_loss": 4.89137819153922, "vf_explained_var": 0.19657455663832407, "kl": 0.017596577589582434, "entropy": 1.4459101654234388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 674.564741912714, "episode_reward_min": 57.60000000000057, "episode_reward_mean": 362.307050014226, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28400, "policy_reward_min": {"prey_policy": -378.81743325247857, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 378.35309088833424, "predator_policy": 505.75904047503917}, "policy_reward_mean": {"prey_policy": 34.623500037532914, "predator_policy": 146.5300249695799}, "custom_metrics": {}, "hist_stats": {"episode_reward": [443.5999999999996, 403.6126586534885, 308.5000000000004, 390.6999999999998, 333.0000000000008, 157.99999999999918, 475.19999999999914, 557.1000000000004, 212.4421500994732, 486.2566153506149, 245.99999999999926, 438.6, 522.3126343751014, 207.2999999999991, 674.564741912714, 387.89743510361706, 57.60000000000057, 395.2000000000018, 652.2209668045394, 353.2000000000013, 401.2718892821257, 277.8640674847281, 396.70000000000005, 494.69397010590694, 518.0999999999999, 269.02603614569955, 622.3000000000004, 476.8404824180572, 281.91884819218365, 393.30731209688736, 311.63634307194155, 473.2595778603908, 176.37177752656265, 164.49999999999974, 403.18517532440245, 72.69870652539684, 446.9000000000011, 379.90000000000214, 584.1999999999995, 338.7000000000003, 254.60000000000005, 554.5999999999999, 280.7999999999993, 225.69999999999936, 269.6037833367415, 233.69999999999948, 231.59999999999954, 241.69999999999933, 521.8000000000001, 268.01475958559956, 429.08184118969916, 177.68339120247032, 240.16487258553735, 207.98070136546247, 435.19999999999976, 123.00000000000011, 539.0999999999992, 530.7594465988795, 352.4000000000001, 366.190127715309, 458.9000000000017, 419.1000000000001, 220.50000000000014, 430.35682696063867, 258.3999999999999, 297.68685884446455, 444.42110535077853, 307.9317644977694, 506.7999999999995, 440.24368344286137, 269.0999999999973], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [254.66165915451973, -148.84848104647622, 46.54809645131328, -0.15933929243822398, 113.5901013971576, 29.06834666347475, 151.4989051651397, 101.77639813692164, 237.03808348984825, -300.452585318284, -4.1386604991960905, -26.57157708377874, 138.35317174700913, 106.07685765193646, 110.54859486584559, 206.82244481519825, -251.90879753291497, -5.1451697964811505, 158.77030241511292, -50.207068550057926, -9.500149145165333, 125.97276427199463, -7.574536798859953, 196.4171216759204, -8.164722594613915, 135.96291314195622, -217.13633257839686, 35.49789734594148, 286.20904232265696, 341.5531756779858, 76.41963965803606, -197.69952605458366, -167.87353066447088, -192.984147111134, -130.3898474685518, 355.9, 310.3145257518031, 181.27547893986682, 199.06474949223326, -253.44928803261126, -129.25797700107833, 79.65733198268414, 14.623449186566837, -132.54585067618498, 166.34306899167362, 101.03299918553802, -155.64499965054182, 333.72967632073835, 169.49282752383405, 182.37690887277904, -233.63661094010416, -36.08554174809325, 93.02235544318043, 315.9913417452125, 26.197803140958072, 195.1873940231828, 121.94086918077289, 70.41552604859739, 254.39722707968696, 17.709148985223198, 32.99785774634465, 26.578806357569697, -41.22906694276864, 102.74223844795566, -233.75491595153346, -367.327148118678, -20.12540574994628, -94.12693706296461, 290.8634822716904, -37.95838495192863, -46.73430030345546, 26.93503177014102, -124.57719280899693, 367.1024765355587, -87.75520650751395, 325.6360363467, 19.207945549518, 374.26254498789046, -123.15105201194616, 160.0268387685803, -240.10529487073615, 108.45949694530822, 227.92330094719804, 110.9657583636405, 112.47608281211296, -21.673269373361773, -54.584764339878426, 113.13452139928529, -131.6160781073426, 112.05138975816396, -378.81743325247857, 119.95313466542555, 24.005124684427905, -122.00898124761895, 39.77991917049089, 63.89600579037268, 159.18354752184555, 91.15574583974981, -355.66912596215224, 71.87962672882199, 68.42023261434531, 100.78780461128851, -370.67689807775014, -71.41433248374749, -52.67566608383068, 20.73429775258827, -183.8300777404508, 24.37061059019296, 12.437165824906941, 120.62840964820148, -176.57935873614204, -345.71677919524296, 346.7713776836591, 75.07729113317407, -20.37783891747023, 166.21394351429672, -36.58692760810598, 54.983111372785714, 35.627111439315634, -36.228478561237694, 378.35309088833424, -6.322544291595108, 177.69417933381268, 189.40071709908855, -42.48869211509941, -88.18087749077841, -55.12191778593835, 227.7716847761795, -299.99844450534323, -164.3121084341788, -129.0482728001997, 41.273748497216516, 171.08652049221317, 107.00348327250803, 27.887546507558593, -7.752566779411062, 68.77183224033105, 288.23240635886793, 42.18741802207575, 45.43144442489749, 90.28882734865742, 140.32871728572616], "policy_predator_policy_reward": [55.23834084548023, 282.54848104647556, 115.60244928612795, 241.62145220848356, 152.05730429922082, 13.784247640146733, 2.913880234268376, 134.51081646367027, 54.26671035699884, 342.14779147143844, 42.638660499196426, 146.0715770837788, 106.29401425708494, 124.47595634396977, 89.8097404610125, 149.91921985794298, 362.0827376283182, 107.4133798005531, 314.13036400421237, 63.56301748134535, 94.66953499958223, 34.857849873589096, 200.47453679885967, 49.28287832407977, 207.2120421365127, 187.30240169124627, 244.43633257839545, 144.5021026540587, 16.941906338166113, 29.860617573905134, 287.8118841781542, 221.36543732201034, 196.57353066446998, 221.88414711113325, 169.68984746855, 0.0, 48.38106351846111, 112.24989859440822, 130.43525050776665, 277.149288032612, 279.03293859779734, 171.83959570272253, 144.5768613742725, 251.20960760007367, 47.85693100832634, 81.46700081446137, 237.89096565833256, 78.71832777737806, 115.70777850386821, 50.52248509951858, 369.57967666780144, 169.168512166094, 165.57764455681965, 47.708658254787515, 161.793182966877, 93.6621022870389, 48.633009617219976, 40.92944334559568, 31.602087504972882, 89.59884852700466, 187.63846457548394, 64.42121439254142, 159.52272407649747, 252.22368227870584, 333.40817897652437, 444.0456626202494, 130.80140596025694, 147.95093685265252, 23.289056906726938, 126.9910210979126, 89.0312696479177, 3.466705410792785, 150.53878959357596, 53.83592667986098, 142.0191701608125, 0.0, 176.1465314271378, 14.582978035453024, 155.55105201194604, 146.27316123141958, 39.49685081068813, 346.7489471147399, 72.07669905280181, 143.6342416363589, 133.52391718788715, 56.473269373362264, 142.53969130872977, 24.610551631862045, 278.64285312571616, 10.52561856020198, 409.2186428533573, 83.345655733696, 158.5948753155719, 171.0089812476192, 7.704423566923059, 130.3196514722129, 107.11046476106296, 164.3502418773413, 505.75904047503917, 46.045218343890426, 166.2508253073433, 93.62297865672232, 362.64661543423296, 257.12800632973403, 90.64877184872654, 181.45746906805317, 307.72437735385023, 59.715791161868964, 150.4628341750923, 151.67159035179856, 238.23015191894802, 407.0659860124389, 1.8556766716486481, 115.39565451151789, 214.4164480907605, 170.50689391129347, 175.08692760810513, 158.91688862721338, 16.741654992282847, 350.04983984494964, 53.15312520766171, 33.71632819559959, 3.5779345865191745, 48.427168980579665, 188.8886921150983, 162.2808774907782, 166.65503240464855, 91.05202756574984, 294.2732831115718, 428.43726982795266, 213.00822870171532, 172.45315444573095, 55.078658924427664, 111.25244266163064, 216.31340360663228, 71.4833811629897, 90.23268574503228, 59.56307565576885, 208.9562654207853, 143.66855557510166, 19.413202911795363, 19.069252453819775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.887206763733943, "mean_inference_ms": 4.693357941743762, "mean_action_processing_ms": 2.9382616497665675, "mean_env_wait_ms": 9.046529869128042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036319208816743234, "StateBufferConnector_ms": 0.006400195645614409, "ViewRequirementAgentConnector_ms": 0.12662494686287892}, "num_episodes": 22, "episode_return_max": 674.564741912714, "episode_return_min": 57.60000000000057, "episode_return_mean": 362.307050014226, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.13381680584384, "num_env_steps_trained_throughput_per_sec": 71.13381680584384, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 58194.351, "restore_workers_time_ms": 0.016, "training_step_time_ms": 58194.285, "sample_time_ms": 3290.944, "learn_time_ms": 54882.562, "learn_throughput": 72.883, "synch_weights_time_ms": 15.45}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "42d11_00000", "date": "2024-08-22_10-18-36", "timestamp": 1724302116, "time_this_iter_s": 56.266465187072754, "time_total_s": 465.97397112846375, "pid": 75262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317a1d1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 465.97397112846375, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 36.30625, "ram_util_percent": 82.98625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.543088613489948, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.376000190916516, "policy_loss": -0.02624804792634985, "vf_loss": 7.399398176001493, "vf_explained_var": 0.23114312694816994, "kl": 0.014250327426959914, "entropy": 1.4405814901861564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.086279797995532, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.673719128477511, "policy_loss": -0.02572177559058502, "vf_loss": 4.695904086254261, "vf_explained_var": 0.19287284227906082, "kl": 0.017684048365693164, "entropy": 1.4256590794003199, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 674.564741912714, "episode_reward_min": 57.60000000000057, "episode_reward_mean": 362.307050014226, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28400, "policy_reward_min": {"prey_policy": -378.81743325247857, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 378.35309088833424, "predator_policy": 505.75904047503917}, "policy_reward_mean": {"prey_policy": 34.623500037532914, "predator_policy": 146.5300249695799}, "custom_metrics": {}, "hist_stats": {"episode_reward": [443.5999999999996, 403.6126586534885, 308.5000000000004, 390.6999999999998, 333.0000000000008, 157.99999999999918, 475.19999999999914, 557.1000000000004, 212.4421500994732, 486.2566153506149, 245.99999999999926, 438.6, 522.3126343751014, 207.2999999999991, 674.564741912714, 387.89743510361706, 57.60000000000057, 395.2000000000018, 652.2209668045394, 353.2000000000013, 401.2718892821257, 277.8640674847281, 396.70000000000005, 494.69397010590694, 518.0999999999999, 269.02603614569955, 622.3000000000004, 476.8404824180572, 281.91884819218365, 393.30731209688736, 311.63634307194155, 473.2595778603908, 176.37177752656265, 164.49999999999974, 403.18517532440245, 72.69870652539684, 446.9000000000011, 379.90000000000214, 584.1999999999995, 338.7000000000003, 254.60000000000005, 554.5999999999999, 280.7999999999993, 225.69999999999936, 269.6037833367415, 233.69999999999948, 231.59999999999954, 241.69999999999933, 521.8000000000001, 268.01475958559956, 429.08184118969916, 177.68339120247032, 240.16487258553735, 207.98070136546247, 435.19999999999976, 123.00000000000011, 539.0999999999992, 530.7594465988795, 352.4000000000001, 366.190127715309, 458.9000000000017, 419.1000000000001, 220.50000000000014, 430.35682696063867, 258.3999999999999, 297.68685884446455, 444.42110535077853, 307.9317644977694, 506.7999999999995, 440.24368344286137, 269.0999999999973], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [254.66165915451973, -148.84848104647622, 46.54809645131328, -0.15933929243822398, 113.5901013971576, 29.06834666347475, 151.4989051651397, 101.77639813692164, 237.03808348984825, -300.452585318284, -4.1386604991960905, -26.57157708377874, 138.35317174700913, 106.07685765193646, 110.54859486584559, 206.82244481519825, -251.90879753291497, -5.1451697964811505, 158.77030241511292, -50.207068550057926, -9.500149145165333, 125.97276427199463, -7.574536798859953, 196.4171216759204, -8.164722594613915, 135.96291314195622, -217.13633257839686, 35.49789734594148, 286.20904232265696, 341.5531756779858, 76.41963965803606, -197.69952605458366, -167.87353066447088, -192.984147111134, -130.3898474685518, 355.9, 310.3145257518031, 181.27547893986682, 199.06474949223326, -253.44928803261126, -129.25797700107833, 79.65733198268414, 14.623449186566837, -132.54585067618498, 166.34306899167362, 101.03299918553802, -155.64499965054182, 333.72967632073835, 169.49282752383405, 182.37690887277904, -233.63661094010416, -36.08554174809325, 93.02235544318043, 315.9913417452125, 26.197803140958072, 195.1873940231828, 121.94086918077289, 70.41552604859739, 254.39722707968696, 17.709148985223198, 32.99785774634465, 26.578806357569697, -41.22906694276864, 102.74223844795566, -233.75491595153346, -367.327148118678, -20.12540574994628, -94.12693706296461, 290.8634822716904, -37.95838495192863, -46.73430030345546, 26.93503177014102, -124.57719280899693, 367.1024765355587, -87.75520650751395, 325.6360363467, 19.207945549518, 374.26254498789046, -123.15105201194616, 160.0268387685803, -240.10529487073615, 108.45949694530822, 227.92330094719804, 110.9657583636405, 112.47608281211296, -21.673269373361773, -54.584764339878426, 113.13452139928529, -131.6160781073426, 112.05138975816396, -378.81743325247857, 119.95313466542555, 24.005124684427905, -122.00898124761895, 39.77991917049089, 63.89600579037268, 159.18354752184555, 91.15574583974981, -355.66912596215224, 71.87962672882199, 68.42023261434531, 100.78780461128851, -370.67689807775014, -71.41433248374749, -52.67566608383068, 20.73429775258827, -183.8300777404508, 24.37061059019296, 12.437165824906941, 120.62840964820148, -176.57935873614204, -345.71677919524296, 346.7713776836591, 75.07729113317407, -20.37783891747023, 166.21394351429672, -36.58692760810598, 54.983111372785714, 35.627111439315634, -36.228478561237694, 378.35309088833424, -6.322544291595108, 177.69417933381268, 189.40071709908855, -42.48869211509941, -88.18087749077841, -55.12191778593835, 227.7716847761795, -299.99844450534323, -164.3121084341788, -129.0482728001997, 41.273748497216516, 171.08652049221317, 107.00348327250803, 27.887546507558593, -7.752566779411062, 68.77183224033105, 288.23240635886793, 42.18741802207575, 45.43144442489749, 90.28882734865742, 140.32871728572616], "policy_predator_policy_reward": [55.23834084548023, 282.54848104647556, 115.60244928612795, 241.62145220848356, 152.05730429922082, 13.784247640146733, 2.913880234268376, 134.51081646367027, 54.26671035699884, 342.14779147143844, 42.638660499196426, 146.0715770837788, 106.29401425708494, 124.47595634396977, 89.8097404610125, 149.91921985794298, 362.0827376283182, 107.4133798005531, 314.13036400421237, 63.56301748134535, 94.66953499958223, 34.857849873589096, 200.47453679885967, 49.28287832407977, 207.2120421365127, 187.30240169124627, 244.43633257839545, 144.5021026540587, 16.941906338166113, 29.860617573905134, 287.8118841781542, 221.36543732201034, 196.57353066446998, 221.88414711113325, 169.68984746855, 0.0, 48.38106351846111, 112.24989859440822, 130.43525050776665, 277.149288032612, 279.03293859779734, 171.83959570272253, 144.5768613742725, 251.20960760007367, 47.85693100832634, 81.46700081446137, 237.89096565833256, 78.71832777737806, 115.70777850386821, 50.52248509951858, 369.57967666780144, 169.168512166094, 165.57764455681965, 47.708658254787515, 161.793182966877, 93.6621022870389, 48.633009617219976, 40.92944334559568, 31.602087504972882, 89.59884852700466, 187.63846457548394, 64.42121439254142, 159.52272407649747, 252.22368227870584, 333.40817897652437, 444.0456626202494, 130.80140596025694, 147.95093685265252, 23.289056906726938, 126.9910210979126, 89.0312696479177, 3.466705410792785, 150.53878959357596, 53.83592667986098, 142.0191701608125, 0.0, 176.1465314271378, 14.582978035453024, 155.55105201194604, 146.27316123141958, 39.49685081068813, 346.7489471147399, 72.07669905280181, 143.6342416363589, 133.52391718788715, 56.473269373362264, 142.53969130872977, 24.610551631862045, 278.64285312571616, 10.52561856020198, 409.2186428533573, 83.345655733696, 158.5948753155719, 171.0089812476192, 7.704423566923059, 130.3196514722129, 107.11046476106296, 164.3502418773413, 505.75904047503917, 46.045218343890426, 166.2508253073433, 93.62297865672232, 362.64661543423296, 257.12800632973403, 90.64877184872654, 181.45746906805317, 307.72437735385023, 59.715791161868964, 150.4628341750923, 151.67159035179856, 238.23015191894802, 407.0659860124389, 1.8556766716486481, 115.39565451151789, 214.4164480907605, 170.50689391129347, 175.08692760810513, 158.91688862721338, 16.741654992282847, 350.04983984494964, 53.15312520766171, 33.71632819559959, 3.5779345865191745, 48.427168980579665, 188.8886921150983, 162.2808774907782, 166.65503240464855, 91.05202756574984, 294.2732831115718, 428.43726982795266, 213.00822870171532, 172.45315444573095, 55.078658924427664, 111.25244266163064, 216.31340360663228, 71.4833811629897, 90.23268574503228, 59.56307565576885, 208.9562654207853, 143.66855557510166, 19.413202911795363, 19.069252453819775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.887206763733943, "mean_inference_ms": 4.693357941743762, "mean_action_processing_ms": 2.9382616497665675, "mean_env_wait_ms": 9.046529869128042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036319208816743234, "StateBufferConnector_ms": 0.006400195645614409, "ViewRequirementAgentConnector_ms": 0.12662494686287892}, "num_episodes": 0, "episode_return_max": 674.564741912714, "episode_return_min": 57.60000000000057, "episode_return_mean": 362.307050014226, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.6400253657071, "num_env_steps_trained_throughput_per_sec": 72.6400253657071, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 57846.763, "restore_workers_time_ms": 0.016, "training_step_time_ms": 57846.7, "sample_time_ms": 3244.443, "learn_time_ms": 54582.239, "learn_throughput": 73.284, "synch_weights_time_ms": 14.934}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "42d11_00000", "date": "2024-08-22_10-19-31", "timestamp": 1724302171, "time_this_iter_s": 55.10893797874451, "time_total_s": 521.0829091072083, "pid": 75262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317a219d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 521.0829091072083, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 33.35, "ram_util_percent": 82.65769230769229}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.310931629920132, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.62058423637713, "policy_loss": -0.025821668684246048, "vf_loss": 7.6434910055190795, "vf_explained_var": 0.25160958161429753, "kl": 0.014574502145861664, "entropy": 1.4601119057842034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.497102851842446, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.397391326213009, "policy_loss": -0.0249519236483759, "vf_loss": 4.419104787533876, "vf_explained_var": 0.20054868532236292, "kl": 0.016192318026774694, "entropy": 1.4340242218088222, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 674.564741912714, "episode_reward_min": 57.60000000000057, "episode_reward_mean": 362.307050014226, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28400, "policy_reward_min": {"prey_policy": -378.81743325247857, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 378.35309088833424, "predator_policy": 505.75904047503917}, "policy_reward_mean": {"prey_policy": 34.623500037532914, "predator_policy": 146.5300249695799}, "custom_metrics": {}, "hist_stats": {"episode_reward": [443.5999999999996, 403.6126586534885, 308.5000000000004, 390.6999999999998, 333.0000000000008, 157.99999999999918, 475.19999999999914, 557.1000000000004, 212.4421500994732, 486.2566153506149, 245.99999999999926, 438.6, 522.3126343751014, 207.2999999999991, 674.564741912714, 387.89743510361706, 57.60000000000057, 395.2000000000018, 652.2209668045394, 353.2000000000013, 401.2718892821257, 277.8640674847281, 396.70000000000005, 494.69397010590694, 518.0999999999999, 269.02603614569955, 622.3000000000004, 476.8404824180572, 281.91884819218365, 393.30731209688736, 311.63634307194155, 473.2595778603908, 176.37177752656265, 164.49999999999974, 403.18517532440245, 72.69870652539684, 446.9000000000011, 379.90000000000214, 584.1999999999995, 338.7000000000003, 254.60000000000005, 554.5999999999999, 280.7999999999993, 225.69999999999936, 269.6037833367415, 233.69999999999948, 231.59999999999954, 241.69999999999933, 521.8000000000001, 268.01475958559956, 429.08184118969916, 177.68339120247032, 240.16487258553735, 207.98070136546247, 435.19999999999976, 123.00000000000011, 539.0999999999992, 530.7594465988795, 352.4000000000001, 366.190127715309, 458.9000000000017, 419.1000000000001, 220.50000000000014, 430.35682696063867, 258.3999999999999, 297.68685884446455, 444.42110535077853, 307.9317644977694, 506.7999999999995, 440.24368344286137, 269.0999999999973], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [254.66165915451973, -148.84848104647622, 46.54809645131328, -0.15933929243822398, 113.5901013971576, 29.06834666347475, 151.4989051651397, 101.77639813692164, 237.03808348984825, -300.452585318284, -4.1386604991960905, -26.57157708377874, 138.35317174700913, 106.07685765193646, 110.54859486584559, 206.82244481519825, -251.90879753291497, -5.1451697964811505, 158.77030241511292, -50.207068550057926, -9.500149145165333, 125.97276427199463, -7.574536798859953, 196.4171216759204, -8.164722594613915, 135.96291314195622, -217.13633257839686, 35.49789734594148, 286.20904232265696, 341.5531756779858, 76.41963965803606, -197.69952605458366, -167.87353066447088, -192.984147111134, -130.3898474685518, 355.9, 310.3145257518031, 181.27547893986682, 199.06474949223326, -253.44928803261126, -129.25797700107833, 79.65733198268414, 14.623449186566837, -132.54585067618498, 166.34306899167362, 101.03299918553802, -155.64499965054182, 333.72967632073835, 169.49282752383405, 182.37690887277904, -233.63661094010416, -36.08554174809325, 93.02235544318043, 315.9913417452125, 26.197803140958072, 195.1873940231828, 121.94086918077289, 70.41552604859739, 254.39722707968696, 17.709148985223198, 32.99785774634465, 26.578806357569697, -41.22906694276864, 102.74223844795566, -233.75491595153346, -367.327148118678, -20.12540574994628, -94.12693706296461, 290.8634822716904, -37.95838495192863, -46.73430030345546, 26.93503177014102, -124.57719280899693, 367.1024765355587, -87.75520650751395, 325.6360363467, 19.207945549518, 374.26254498789046, -123.15105201194616, 160.0268387685803, -240.10529487073615, 108.45949694530822, 227.92330094719804, 110.9657583636405, 112.47608281211296, -21.673269373361773, -54.584764339878426, 113.13452139928529, -131.6160781073426, 112.05138975816396, -378.81743325247857, 119.95313466542555, 24.005124684427905, -122.00898124761895, 39.77991917049089, 63.89600579037268, 159.18354752184555, 91.15574583974981, -355.66912596215224, 71.87962672882199, 68.42023261434531, 100.78780461128851, -370.67689807775014, -71.41433248374749, -52.67566608383068, 20.73429775258827, -183.8300777404508, 24.37061059019296, 12.437165824906941, 120.62840964820148, -176.57935873614204, -345.71677919524296, 346.7713776836591, 75.07729113317407, -20.37783891747023, 166.21394351429672, -36.58692760810598, 54.983111372785714, 35.627111439315634, -36.228478561237694, 378.35309088833424, -6.322544291595108, 177.69417933381268, 189.40071709908855, -42.48869211509941, -88.18087749077841, -55.12191778593835, 227.7716847761795, -299.99844450534323, -164.3121084341788, -129.0482728001997, 41.273748497216516, 171.08652049221317, 107.00348327250803, 27.887546507558593, -7.752566779411062, 68.77183224033105, 288.23240635886793, 42.18741802207575, 45.43144442489749, 90.28882734865742, 140.32871728572616], "policy_predator_policy_reward": [55.23834084548023, 282.54848104647556, 115.60244928612795, 241.62145220848356, 152.05730429922082, 13.784247640146733, 2.913880234268376, 134.51081646367027, 54.26671035699884, 342.14779147143844, 42.638660499196426, 146.0715770837788, 106.29401425708494, 124.47595634396977, 89.8097404610125, 149.91921985794298, 362.0827376283182, 107.4133798005531, 314.13036400421237, 63.56301748134535, 94.66953499958223, 34.857849873589096, 200.47453679885967, 49.28287832407977, 207.2120421365127, 187.30240169124627, 244.43633257839545, 144.5021026540587, 16.941906338166113, 29.860617573905134, 287.8118841781542, 221.36543732201034, 196.57353066446998, 221.88414711113325, 169.68984746855, 0.0, 48.38106351846111, 112.24989859440822, 130.43525050776665, 277.149288032612, 279.03293859779734, 171.83959570272253, 144.5768613742725, 251.20960760007367, 47.85693100832634, 81.46700081446137, 237.89096565833256, 78.71832777737806, 115.70777850386821, 50.52248509951858, 369.57967666780144, 169.168512166094, 165.57764455681965, 47.708658254787515, 161.793182966877, 93.6621022870389, 48.633009617219976, 40.92944334559568, 31.602087504972882, 89.59884852700466, 187.63846457548394, 64.42121439254142, 159.52272407649747, 252.22368227870584, 333.40817897652437, 444.0456626202494, 130.80140596025694, 147.95093685265252, 23.289056906726938, 126.9910210979126, 89.0312696479177, 3.466705410792785, 150.53878959357596, 53.83592667986098, 142.0191701608125, 0.0, 176.1465314271378, 14.582978035453024, 155.55105201194604, 146.27316123141958, 39.49685081068813, 346.7489471147399, 72.07669905280181, 143.6342416363589, 133.52391718788715, 56.473269373362264, 142.53969130872977, 24.610551631862045, 278.64285312571616, 10.52561856020198, 409.2186428533573, 83.345655733696, 158.5948753155719, 171.0089812476192, 7.704423566923059, 130.3196514722129, 107.11046476106296, 164.3502418773413, 505.75904047503917, 46.045218343890426, 166.2508253073433, 93.62297865672232, 362.64661543423296, 257.12800632973403, 90.64877184872654, 181.45746906805317, 307.72437735385023, 59.715791161868964, 150.4628341750923, 151.67159035179856, 238.23015191894802, 407.0659860124389, 1.8556766716486481, 115.39565451151789, 214.4164480907605, 170.50689391129347, 175.08692760810513, 158.91688862721338, 16.741654992282847, 350.04983984494964, 53.15312520766171, 33.71632819559959, 3.5779345865191745, 48.427168980579665, 188.8886921150983, 162.2808774907782, 166.65503240464855, 91.05202756574984, 294.2732831115718, 428.43726982795266, 213.00822870171532, 172.45315444573095, 55.078658924427664, 111.25244266163064, 216.31340360663228, 71.4833811629897, 90.23268574503228, 59.56307565576885, 208.9562654207853, 143.66855557510166, 19.413202911795363, 19.069252453819775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.887206763733943, "mean_inference_ms": 4.693357941743762, "mean_action_processing_ms": 2.9382616497665675, "mean_env_wait_ms": 9.046529869128042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036319208816743234, "StateBufferConnector_ms": 0.006400195645614409, "ViewRequirementAgentConnector_ms": 0.12662494686287892}, "num_episodes": 0, "episode_return_max": 674.564741912714, "episode_return_min": 57.60000000000057, "episode_return_mean": 362.307050014226, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.16170433549233, "num_env_steps_trained_throughput_per_sec": 75.16170433549233, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 57383.947, "restore_workers_time_ms": 0.016, "training_step_time_ms": 57383.886, "sample_time_ms": 3156.993, "learn_time_ms": 54207.368, "learn_throughput": 73.791, "synch_weights_time_ms": 14.564}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "42d11_00000", "date": "2024-08-22_10-20-24", "timestamp": 1724302224, "time_this_iter_s": 53.25312519073486, "time_total_s": 574.3360342979431, "pid": 75262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317a46310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 574.3360342979431, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 27.911842105263162, "ram_util_percent": 82.48157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.464076883263058, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.472613893488727, "policy_loss": -0.02640315408451315, "vf_loss": 7.496258094323375, "vf_explained_var": 0.25624450754236294, "kl": 0.013794914691428108, "entropy": 1.45801939888606, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.369576706015875, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.656443157524028, "policy_loss": -0.021644292446099733, "vf_loss": 3.674691524329009, "vf_explained_var": 0.19671600483081958, "kl": 0.01697962265289216, "entropy": 1.4031893569325644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 674.564741912714, "episode_reward_min": 57.60000000000057, "episode_reward_mean": 362.307050014226, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28400, "policy_reward_min": {"prey_policy": -378.81743325247857, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 378.35309088833424, "predator_policy": 505.75904047503917}, "policy_reward_mean": {"prey_policy": 34.623500037532914, "predator_policy": 146.5300249695799}, "custom_metrics": {}, "hist_stats": {"episode_reward": [443.5999999999996, 403.6126586534885, 308.5000000000004, 390.6999999999998, 333.0000000000008, 157.99999999999918, 475.19999999999914, 557.1000000000004, 212.4421500994732, 486.2566153506149, 245.99999999999926, 438.6, 522.3126343751014, 207.2999999999991, 674.564741912714, 387.89743510361706, 57.60000000000057, 395.2000000000018, 652.2209668045394, 353.2000000000013, 401.2718892821257, 277.8640674847281, 396.70000000000005, 494.69397010590694, 518.0999999999999, 269.02603614569955, 622.3000000000004, 476.8404824180572, 281.91884819218365, 393.30731209688736, 311.63634307194155, 473.2595778603908, 176.37177752656265, 164.49999999999974, 403.18517532440245, 72.69870652539684, 446.9000000000011, 379.90000000000214, 584.1999999999995, 338.7000000000003, 254.60000000000005, 554.5999999999999, 280.7999999999993, 225.69999999999936, 269.6037833367415, 233.69999999999948, 231.59999999999954, 241.69999999999933, 521.8000000000001, 268.01475958559956, 429.08184118969916, 177.68339120247032, 240.16487258553735, 207.98070136546247, 435.19999999999976, 123.00000000000011, 539.0999999999992, 530.7594465988795, 352.4000000000001, 366.190127715309, 458.9000000000017, 419.1000000000001, 220.50000000000014, 430.35682696063867, 258.3999999999999, 297.68685884446455, 444.42110535077853, 307.9317644977694, 506.7999999999995, 440.24368344286137, 269.0999999999973], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [254.66165915451973, -148.84848104647622, 46.54809645131328, -0.15933929243822398, 113.5901013971576, 29.06834666347475, 151.4989051651397, 101.77639813692164, 237.03808348984825, -300.452585318284, -4.1386604991960905, -26.57157708377874, 138.35317174700913, 106.07685765193646, 110.54859486584559, 206.82244481519825, -251.90879753291497, -5.1451697964811505, 158.77030241511292, -50.207068550057926, -9.500149145165333, 125.97276427199463, -7.574536798859953, 196.4171216759204, -8.164722594613915, 135.96291314195622, -217.13633257839686, 35.49789734594148, 286.20904232265696, 341.5531756779858, 76.41963965803606, -197.69952605458366, -167.87353066447088, -192.984147111134, -130.3898474685518, 355.9, 310.3145257518031, 181.27547893986682, 199.06474949223326, -253.44928803261126, -129.25797700107833, 79.65733198268414, 14.623449186566837, -132.54585067618498, 166.34306899167362, 101.03299918553802, -155.64499965054182, 333.72967632073835, 169.49282752383405, 182.37690887277904, -233.63661094010416, -36.08554174809325, 93.02235544318043, 315.9913417452125, 26.197803140958072, 195.1873940231828, 121.94086918077289, 70.41552604859739, 254.39722707968696, 17.709148985223198, 32.99785774634465, 26.578806357569697, -41.22906694276864, 102.74223844795566, -233.75491595153346, -367.327148118678, -20.12540574994628, -94.12693706296461, 290.8634822716904, -37.95838495192863, -46.73430030345546, 26.93503177014102, -124.57719280899693, 367.1024765355587, -87.75520650751395, 325.6360363467, 19.207945549518, 374.26254498789046, -123.15105201194616, 160.0268387685803, -240.10529487073615, 108.45949694530822, 227.92330094719804, 110.9657583636405, 112.47608281211296, -21.673269373361773, -54.584764339878426, 113.13452139928529, -131.6160781073426, 112.05138975816396, -378.81743325247857, 119.95313466542555, 24.005124684427905, -122.00898124761895, 39.77991917049089, 63.89600579037268, 159.18354752184555, 91.15574583974981, -355.66912596215224, 71.87962672882199, 68.42023261434531, 100.78780461128851, -370.67689807775014, -71.41433248374749, -52.67566608383068, 20.73429775258827, -183.8300777404508, 24.37061059019296, 12.437165824906941, 120.62840964820148, -176.57935873614204, -345.71677919524296, 346.7713776836591, 75.07729113317407, -20.37783891747023, 166.21394351429672, -36.58692760810598, 54.983111372785714, 35.627111439315634, -36.228478561237694, 378.35309088833424, -6.322544291595108, 177.69417933381268, 189.40071709908855, -42.48869211509941, -88.18087749077841, -55.12191778593835, 227.7716847761795, -299.99844450534323, -164.3121084341788, -129.0482728001997, 41.273748497216516, 171.08652049221317, 107.00348327250803, 27.887546507558593, -7.752566779411062, 68.77183224033105, 288.23240635886793, 42.18741802207575, 45.43144442489749, 90.28882734865742, 140.32871728572616], "policy_predator_policy_reward": [55.23834084548023, 282.54848104647556, 115.60244928612795, 241.62145220848356, 152.05730429922082, 13.784247640146733, 2.913880234268376, 134.51081646367027, 54.26671035699884, 342.14779147143844, 42.638660499196426, 146.0715770837788, 106.29401425708494, 124.47595634396977, 89.8097404610125, 149.91921985794298, 362.0827376283182, 107.4133798005531, 314.13036400421237, 63.56301748134535, 94.66953499958223, 34.857849873589096, 200.47453679885967, 49.28287832407977, 207.2120421365127, 187.30240169124627, 244.43633257839545, 144.5021026540587, 16.941906338166113, 29.860617573905134, 287.8118841781542, 221.36543732201034, 196.57353066446998, 221.88414711113325, 169.68984746855, 0.0, 48.38106351846111, 112.24989859440822, 130.43525050776665, 277.149288032612, 279.03293859779734, 171.83959570272253, 144.5768613742725, 251.20960760007367, 47.85693100832634, 81.46700081446137, 237.89096565833256, 78.71832777737806, 115.70777850386821, 50.52248509951858, 369.57967666780144, 169.168512166094, 165.57764455681965, 47.708658254787515, 161.793182966877, 93.6621022870389, 48.633009617219976, 40.92944334559568, 31.602087504972882, 89.59884852700466, 187.63846457548394, 64.42121439254142, 159.52272407649747, 252.22368227870584, 333.40817897652437, 444.0456626202494, 130.80140596025694, 147.95093685265252, 23.289056906726938, 126.9910210979126, 89.0312696479177, 3.466705410792785, 150.53878959357596, 53.83592667986098, 142.0191701608125, 0.0, 176.1465314271378, 14.582978035453024, 155.55105201194604, 146.27316123141958, 39.49685081068813, 346.7489471147399, 72.07669905280181, 143.6342416363589, 133.52391718788715, 56.473269373362264, 142.53969130872977, 24.610551631862045, 278.64285312571616, 10.52561856020198, 409.2186428533573, 83.345655733696, 158.5948753155719, 171.0089812476192, 7.704423566923059, 130.3196514722129, 107.11046476106296, 164.3502418773413, 505.75904047503917, 46.045218343890426, 166.2508253073433, 93.62297865672232, 362.64661543423296, 257.12800632973403, 90.64877184872654, 181.45746906805317, 307.72437735385023, 59.715791161868964, 150.4628341750923, 151.67159035179856, 238.23015191894802, 407.0659860124389, 1.8556766716486481, 115.39565451151789, 214.4164480907605, 170.50689391129347, 175.08692760810513, 158.91688862721338, 16.741654992282847, 350.04983984494964, 53.15312520766171, 33.71632819559959, 3.5779345865191745, 48.427168980579665, 188.8886921150983, 162.2808774907782, 166.65503240464855, 91.05202756574984, 294.2732831115718, 428.43726982795266, 213.00822870171532, 172.45315444573095, 55.078658924427664, 111.25244266163064, 216.31340360663228, 71.4833811629897, 90.23268574503228, 59.56307565576885, 208.9562654207853, 143.66855557510166, 19.413202911795363, 19.069252453819775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.887206763733943, "mean_inference_ms": 4.693357941743762, "mean_action_processing_ms": 2.9382616497665675, "mean_env_wait_ms": 9.046529869128042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036319208816743234, "StateBufferConnector_ms": 0.006400195645614409, "ViewRequirementAgentConnector_ms": 0.12662494686287892}, "num_episodes": 0, "episode_return_max": 674.564741912714, "episode_return_min": 57.60000000000057, "episode_return_mean": 362.307050014226, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.24779425034059, "num_env_steps_trained_throughput_per_sec": 75.24779425034059, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 56746.641, "restore_workers_time_ms": 0.014, "training_step_time_ms": 56746.582, "sample_time_ms": 2859.939, "learn_time_ms": 53867.012, "learn_throughput": 74.257, "synch_weights_time_ms": 14.507}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "42d11_00000", "date": "2024-08-22_10-21-18", "timestamp": 1724302278, "time_this_iter_s": 53.2018780708313, "time_total_s": 627.5379123687744, "pid": 75262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317a463a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 627.5379123687744, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 29.88, "ram_util_percent": 81.22266666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.26941628203821, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.020578957108594, "policy_loss": -0.021659457839030043, "vf_loss": 7.039421301796323, "vf_explained_var": 0.27279609463833, "kl": 0.014085607168821509, "entropy": 1.4533635709651564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.916016628944054, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.005707689567848, "policy_loss": -0.024548824204787337, "vf_loss": 4.026713855430563, "vf_explained_var": 0.21196200251579284, "kl": 0.01771328172217759, "entropy": 1.380447873425862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 674.564741912714, "episode_reward_min": 57.60000000000057, "episode_reward_mean": 363.7195335213237, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 29200, "policy_reward_min": {"prey_policy": -378.81743325247857, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 378.35309088833424, "predator_policy": 807.4203835818694}, "policy_reward_mean": {"prey_policy": 27.967277914062212, "predator_policy": 153.89248884659952}, "custom_metrics": {}, "hist_stats": {"episode_reward": [443.5999999999996, 403.6126586534885, 308.5000000000004, 390.6999999999998, 333.0000000000008, 157.99999999999918, 475.19999999999914, 557.1000000000004, 212.4421500994732, 486.2566153506149, 245.99999999999926, 438.6, 522.3126343751014, 207.2999999999991, 674.564741912714, 387.89743510361706, 57.60000000000057, 395.2000000000018, 652.2209668045394, 353.2000000000013, 401.2718892821257, 277.8640674847281, 396.70000000000005, 494.69397010590694, 518.0999999999999, 269.02603614569955, 622.3000000000004, 476.8404824180572, 281.91884819218365, 393.30731209688736, 311.63634307194155, 473.2595778603908, 176.37177752656265, 164.49999999999974, 403.18517532440245, 72.69870652539684, 446.9000000000011, 379.90000000000214, 584.1999999999995, 338.7000000000003, 254.60000000000005, 554.5999999999999, 280.7999999999993, 225.69999999999936, 269.6037833367415, 233.69999999999948, 231.59999999999954, 241.69999999999933, 521.8000000000001, 268.01475958559956, 429.08184118969916, 177.68339120247032, 240.16487258553735, 207.98070136546247, 435.19999999999976, 123.00000000000011, 539.0999999999992, 530.7594465988795, 352.4000000000001, 366.190127715309, 458.9000000000017, 419.1000000000001, 220.50000000000014, 430.35682696063867, 258.3999999999999, 297.68685884446455, 444.42110535077853, 307.9317644977694, 506.7999999999995, 440.24368344286137, 269.0999999999973, 410.84842870839816, 416.876967338189], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [254.66165915451973, -148.84848104647622, 46.54809645131328, -0.15933929243822398, 113.5901013971576, 29.06834666347475, 151.4989051651397, 101.77639813692164, 237.03808348984825, -300.452585318284, -4.1386604991960905, -26.57157708377874, 138.35317174700913, 106.07685765193646, 110.54859486584559, 206.82244481519825, -251.90879753291497, -5.1451697964811505, 158.77030241511292, -50.207068550057926, -9.500149145165333, 125.97276427199463, -7.574536798859953, 196.4171216759204, -8.164722594613915, 135.96291314195622, -217.13633257839686, 35.49789734594148, 286.20904232265696, 341.5531756779858, 76.41963965803606, -197.69952605458366, -167.87353066447088, -192.984147111134, -130.3898474685518, 355.9, 310.3145257518031, 181.27547893986682, 199.06474949223326, -253.44928803261126, -129.25797700107833, 79.65733198268414, 14.623449186566837, -132.54585067618498, 166.34306899167362, 101.03299918553802, -155.64499965054182, 333.72967632073835, 169.49282752383405, 182.37690887277904, -233.63661094010416, -36.08554174809325, 93.02235544318043, 315.9913417452125, 26.197803140958072, 195.1873940231828, 121.94086918077289, 70.41552604859739, 254.39722707968696, 17.709148985223198, 32.99785774634465, 26.578806357569697, -41.22906694276864, 102.74223844795566, -233.75491595153346, -367.327148118678, -20.12540574994628, -94.12693706296461, 290.8634822716904, -37.95838495192863, -46.73430030345546, 26.93503177014102, -124.57719280899693, 367.1024765355587, -87.75520650751395, 325.6360363467, 19.207945549518, 374.26254498789046, -123.15105201194616, 160.0268387685803, -240.10529487073615, 108.45949694530822, 227.92330094719804, 110.9657583636405, 112.47608281211296, -21.673269373361773, -54.584764339878426, 113.13452139928529, -131.6160781073426, 112.05138975816396, -378.81743325247857, 119.95313466542555, 24.005124684427905, -122.00898124761895, 39.77991917049089, 63.89600579037268, 159.18354752184555, 91.15574583974981, -355.66912596215224, 71.87962672882199, 68.42023261434531, 100.78780461128851, -370.67689807775014, -71.41433248374749, -52.67566608383068, 20.73429775258827, -183.8300777404508, 24.37061059019296, 12.437165824906941, 120.62840964820148, -176.57935873614204, -345.71677919524296, 346.7713776836591, 75.07729113317407, -20.37783891747023, 166.21394351429672, -36.58692760810598, 54.983111372785714, 35.627111439315634, -36.228478561237694, 378.35309088833424, -6.322544291595108, 177.69417933381268, 189.40071709908855, -42.48869211509941, -88.18087749077841, -55.12191778593835, 227.7716847761795, -299.99844450534323, -164.3121084341788, -129.0482728001997, 41.273748497216516, 171.08652049221317, 107.00348327250803, 27.887546507558593, -7.752566779411062, 68.77183224033105, 288.23240635886793, 42.18741802207575, 45.43144442489749, 90.28882734865742, 140.32871728572616, -170.50933617044336, -235.98188545423446, -314.08107849154476, -112.74212976036843], "policy_predator_policy_reward": [55.23834084548023, 282.54848104647556, 115.60244928612795, 241.62145220848356, 152.05730429922082, 13.784247640146733, 2.913880234268376, 134.51081646367027, 54.26671035699884, 342.14779147143844, 42.638660499196426, 146.0715770837788, 106.29401425708494, 124.47595634396977, 89.8097404610125, 149.91921985794298, 362.0827376283182, 107.4133798005531, 314.13036400421237, 63.56301748134535, 94.66953499958223, 34.857849873589096, 200.47453679885967, 49.28287832407977, 207.2120421365127, 187.30240169124627, 244.43633257839545, 144.5021026540587, 16.941906338166113, 29.860617573905134, 287.8118841781542, 221.36543732201034, 196.57353066446998, 221.88414711113325, 169.68984746855, 0.0, 48.38106351846111, 112.24989859440822, 130.43525050776665, 277.149288032612, 279.03293859779734, 171.83959570272253, 144.5768613742725, 251.20960760007367, 47.85693100832634, 81.46700081446137, 237.89096565833256, 78.71832777737806, 115.70777850386821, 50.52248509951858, 369.57967666780144, 169.168512166094, 165.57764455681965, 47.708658254787515, 161.793182966877, 93.6621022870389, 48.633009617219976, 40.92944334559568, 31.602087504972882, 89.59884852700466, 187.63846457548394, 64.42121439254142, 159.52272407649747, 252.22368227870584, 333.40817897652437, 444.0456626202494, 130.80140596025694, 147.95093685265252, 23.289056906726938, 126.9910210979126, 89.0312696479177, 3.466705410792785, 150.53878959357596, 53.83592667986098, 142.0191701608125, 0.0, 176.1465314271378, 14.582978035453024, 155.55105201194604, 146.27316123141958, 39.49685081068813, 346.7489471147399, 72.07669905280181, 143.6342416363589, 133.52391718788715, 56.473269373362264, 142.53969130872977, 24.610551631862045, 278.64285312571616, 10.52561856020198, 409.2186428533573, 83.345655733696, 158.5948753155719, 171.0089812476192, 7.704423566923059, 130.3196514722129, 107.11046476106296, 164.3502418773413, 505.75904047503917, 46.045218343890426, 166.2508253073433, 93.62297865672232, 362.64661543423296, 257.12800632973403, 90.64877184872654, 181.45746906805317, 307.72437735385023, 59.715791161868964, 150.4628341750923, 151.67159035179856, 238.23015191894802, 407.0659860124389, 1.8556766716486481, 115.39565451151789, 214.4164480907605, 170.50689391129347, 175.08692760810513, 158.91688862721338, 16.741654992282847, 350.04983984494964, 53.15312520766171, 33.71632819559959, 3.5779345865191745, 48.427168980579665, 188.8886921150983, 162.2808774907782, 166.65503240464855, 91.05202756574984, 294.2732831115718, 428.43726982795266, 213.00822870171532, 172.45315444573095, 55.078658924427664, 111.25244266163064, 216.31340360663228, 71.4833811629897, 90.23268574503228, 59.56307565576885, 208.9562654207853, 143.66855557510166, 19.413202911795363, 19.069252453819775, 105.94210508000538, 711.3975452530702, 807.4203835818694, 36.27979200823244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.879854647386123, "mean_inference_ms": 4.672625285774722, "mean_action_processing_ms": 2.914978362502601, "mean_env_wait_ms": 9.020190903955656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03543177696123515, "StateBufferConnector_ms": 0.00633785169418544, "ViewRequirementAgentConnector_ms": 0.12585561569422893}, "num_episodes": 2, "episode_return_max": 674.564741912714, "episode_return_min": 57.60000000000057, "episode_return_mean": 363.7195335213237, "episodes_this_iter": 2}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.46212909244005, "num_env_steps_trained_throughput_per_sec": 71.46212909244005, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 56685.587, "restore_workers_time_ms": 0.014, "training_step_time_ms": 56685.527, "sample_time_ms": 2803.231, "learn_time_ms": 53862.595, "learn_throughput": 74.263, "synch_weights_time_ms": 14.716}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "42d11_00000", "date": "2024-08-22_10-22-14", "timestamp": 1724302334, "time_this_iter_s": 56.00076103210449, "time_total_s": 683.5386734008789, "pid": 75262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317a21af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 683.5386734008789, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 34.92, "ram_util_percent": 82.78125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.347248077960241, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.323517239787591, "policy_loss": -0.024269821292907987, "vf_loss": 7.344907525229075, "vf_explained_var": 0.21914717006304907, "kl": 0.014397728553524725, "entropy": 1.4326082096528754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.6009132423728865, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.874144184904755, "policy_loss": -0.02220694799082127, "vf_loss": 4.892674418984267, "vf_explained_var": 0.22729990094427077, "kl": 0.018383584960693956, "entropy": 1.300289289976554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 674.564741912714, "episode_reward_min": 57.60000000000057, "episode_reward_mean": 363.8517912720163, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 34400, "policy_reward_min": {"prey_policy": -418.0191419218886, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 378.35309088833424, "predator_policy": 807.4203835818694}, "policy_reward_mean": {"prey_policy": 19.236882897816596, "predator_policy": 162.6890127381914}, "custom_metrics": {}, "hist_stats": {"episode_reward": [443.5999999999996, 403.6126586534885, 308.5000000000004, 390.6999999999998, 333.0000000000008, 157.99999999999918, 475.19999999999914, 557.1000000000004, 212.4421500994732, 486.2566153506149, 245.99999999999926, 438.6, 522.3126343751014, 207.2999999999991, 674.564741912714, 387.89743510361706, 57.60000000000057, 395.2000000000018, 652.2209668045394, 353.2000000000013, 401.2718892821257, 277.8640674847281, 396.70000000000005, 494.69397010590694, 518.0999999999999, 269.02603614569955, 622.3000000000004, 476.8404824180572, 281.91884819218365, 393.30731209688736, 311.63634307194155, 473.2595778603908, 176.37177752656265, 164.49999999999974, 403.18517532440245, 72.69870652539684, 446.9000000000011, 379.90000000000214, 584.1999999999995, 338.7000000000003, 254.60000000000005, 554.5999999999999, 280.7999999999993, 225.69999999999936, 269.6037833367415, 233.69999999999948, 231.59999999999954, 241.69999999999933, 521.8000000000001, 268.01475958559956, 429.08184118969916, 177.68339120247032, 240.16487258553735, 207.98070136546247, 435.19999999999976, 123.00000000000011, 539.0999999999992, 530.7594465988795, 352.4000000000001, 366.190127715309, 458.9000000000017, 419.1000000000001, 220.50000000000014, 430.35682696063867, 258.3999999999999, 297.68685884446455, 444.42110535077853, 307.9317644977694, 506.7999999999995, 440.24368344286137, 269.0999999999973, 410.84842870839816, 416.876967338189, 262.48817281983656, 470.9355951646478, 387.3927465771262, 195.41781851882067, 510.82085397009143, 358.3969512732883, 307.64985478749213, 380.9764847886745, 372.2269156120383, 340.44821315203603, 506.0762639512737, 354.7982317214519, 292.10000000000286], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [254.66165915451973, -148.84848104647622, 46.54809645131328, -0.15933929243822398, 113.5901013971576, 29.06834666347475, 151.4989051651397, 101.77639813692164, 237.03808348984825, -300.452585318284, -4.1386604991960905, -26.57157708377874, 138.35317174700913, 106.07685765193646, 110.54859486584559, 206.82244481519825, -251.90879753291497, -5.1451697964811505, 158.77030241511292, -50.207068550057926, -9.500149145165333, 125.97276427199463, -7.574536798859953, 196.4171216759204, -8.164722594613915, 135.96291314195622, -217.13633257839686, 35.49789734594148, 286.20904232265696, 341.5531756779858, 76.41963965803606, -197.69952605458366, -167.87353066447088, -192.984147111134, -130.3898474685518, 355.9, 310.3145257518031, 181.27547893986682, 199.06474949223326, -253.44928803261126, -129.25797700107833, 79.65733198268414, 14.623449186566837, -132.54585067618498, 166.34306899167362, 101.03299918553802, -155.64499965054182, 333.72967632073835, 169.49282752383405, 182.37690887277904, -233.63661094010416, -36.08554174809325, 93.02235544318043, 315.9913417452125, 26.197803140958072, 195.1873940231828, 121.94086918077289, 70.41552604859739, 254.39722707968696, 17.709148985223198, 32.99785774634465, 26.578806357569697, -41.22906694276864, 102.74223844795566, -233.75491595153346, -367.327148118678, -20.12540574994628, -94.12693706296461, 290.8634822716904, -37.95838495192863, -46.73430030345546, 26.93503177014102, -124.57719280899693, 367.1024765355587, -87.75520650751395, 325.6360363467, 19.207945549518, 374.26254498789046, -123.15105201194616, 160.0268387685803, -240.10529487073615, 108.45949694530822, 227.92330094719804, 110.9657583636405, 112.47608281211296, -21.673269373361773, -54.584764339878426, 113.13452139928529, -131.6160781073426, 112.05138975816396, -378.81743325247857, 119.95313466542555, 24.005124684427905, -122.00898124761895, 39.77991917049089, 63.89600579037268, 159.18354752184555, 91.15574583974981, -355.66912596215224, 71.87962672882199, 68.42023261434531, 100.78780461128851, -370.67689807775014, -71.41433248374749, -52.67566608383068, 20.73429775258827, -183.8300777404508, 24.37061059019296, 12.437165824906941, 120.62840964820148, -176.57935873614204, -345.71677919524296, 346.7713776836591, 75.07729113317407, -20.37783891747023, 166.21394351429672, -36.58692760810598, 54.983111372785714, 35.627111439315634, -36.228478561237694, 378.35309088833424, -6.322544291595108, 177.69417933381268, 189.40071709908855, -42.48869211509941, -88.18087749077841, -55.12191778593835, 227.7716847761795, -299.99844450534323, -164.3121084341788, -129.0482728001997, 41.273748497216516, 171.08652049221317, 107.00348327250803, 27.887546507558593, -7.752566779411062, 68.77183224033105, 288.23240635886793, 42.18741802207575, 45.43144442489749, 90.28882734865742, 140.32871728572616, -170.50933617044336, -235.98188545423446, -314.08107849154476, -112.74212976036843, 19.26254462294141, 71.05493046301092, -194.67641466150866, 234.23072885085483, -32.89581505922937, -34.01173072623386, -177.99704722470528, -221.9529663771257, 53.84958780106833, 47.02792998548183, 174.19906835265544, -189.94932198425155, -18.60064869304199, -418.0191419218886, -111.77162926577599, -247.49514831623702, -305.575218869585, 100.70197300066792, -128.01010401133672, 13.237911249914148, 251.28130306271626, 68.27340656875288, -102.0185570766503, 226.0143137731244, 25.02905261492016, 124.33227681283275], "policy_predator_policy_reward": [55.23834084548023, 282.54848104647556, 115.60244928612795, 241.62145220848356, 152.05730429922082, 13.784247640146733, 2.913880234268376, 134.51081646367027, 54.26671035699884, 342.14779147143844, 42.638660499196426, 146.0715770837788, 106.29401425708494, 124.47595634396977, 89.8097404610125, 149.91921985794298, 362.0827376283182, 107.4133798005531, 314.13036400421237, 63.56301748134535, 94.66953499958223, 34.857849873589096, 200.47453679885967, 49.28287832407977, 207.2120421365127, 187.30240169124627, 244.43633257839545, 144.5021026540587, 16.941906338166113, 29.860617573905134, 287.8118841781542, 221.36543732201034, 196.57353066446998, 221.88414711113325, 169.68984746855, 0.0, 48.38106351846111, 112.24989859440822, 130.43525050776665, 277.149288032612, 279.03293859779734, 171.83959570272253, 144.5768613742725, 251.20960760007367, 47.85693100832634, 81.46700081446137, 237.89096565833256, 78.71832777737806, 115.70777850386821, 50.52248509951858, 369.57967666780144, 169.168512166094, 165.57764455681965, 47.708658254787515, 161.793182966877, 93.6621022870389, 48.633009617219976, 40.92944334559568, 31.602087504972882, 89.59884852700466, 187.63846457548394, 64.42121439254142, 159.52272407649747, 252.22368227870584, 333.40817897652437, 444.0456626202494, 130.80140596025694, 147.95093685265252, 23.289056906726938, 126.9910210979126, 89.0312696479177, 3.466705410792785, 150.53878959357596, 53.83592667986098, 142.0191701608125, 0.0, 176.1465314271378, 14.582978035453024, 155.55105201194604, 146.27316123141958, 39.49685081068813, 346.7489471147399, 72.07669905280181, 143.6342416363589, 133.52391718788715, 56.473269373362264, 142.53969130872977, 24.610551631862045, 278.64285312571616, 10.52561856020198, 409.2186428533573, 83.345655733696, 158.5948753155719, 171.0089812476192, 7.704423566923059, 130.3196514722129, 107.11046476106296, 164.3502418773413, 505.75904047503917, 46.045218343890426, 166.2508253073433, 93.62297865672232, 362.64661543423296, 257.12800632973403, 90.64877184872654, 181.45746906805317, 307.72437735385023, 59.715791161868964, 150.4628341750923, 151.67159035179856, 238.23015191894802, 407.0659860124389, 1.8556766716486481, 115.39565451151789, 214.4164480907605, 170.50689391129347, 175.08692760810513, 158.91688862721338, 16.741654992282847, 350.04983984494964, 53.15312520766171, 33.71632819559959, 3.5779345865191745, 48.427168980579665, 188.8886921150983, 162.2808774907782, 166.65503240464855, 91.05202756574984, 294.2732831115718, 428.43726982795266, 213.00822870171532, 172.45315444573095, 55.078658924427664, 111.25244266163064, 216.31340360663228, 71.4833811629897, 90.23268574503228, 59.56307565576885, 208.9562654207853, 143.66855557510166, 19.413202911795363, 19.069252453819775, 105.94210508000538, 711.3975452530702, 807.4203835818694, 36.27979200823244, 5.175047764684086, 166.99564996920068, 216.8554902477688, 214.52579072753232, 93.43517200375126, 360.8651203588377, 247.71979575376724, 347.64803636688475, 194.95226532465253, 214.99107085888843, 253.00072856321697, 121.1464763416641, 362.30967274162475, 381.9599726607985, 48.76464133751917, 691.4786210331687, 160.67835369821887, 416.42180778273627, 195.4640851415463, 259.7563207719086, 184.98095650944364, 1.540597810359479, 31.594045349448244, 199.20842967552727, 13.970947385079894, 128.76772318716695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.822453202611997, "mean_inference_ms": 4.599704578166343, "mean_action_processing_ms": 2.802533524415231, "mean_env_wait_ms": 9.00408118310505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030621401099271552, "StateBufferConnector_ms": 0.006008148193359375, "ViewRequirementAgentConnector_ms": 0.12239162311997524}, "num_episodes": 13, "episode_return_max": 674.564741912714, "episode_return_min": 57.60000000000057, "episode_return_mean": 363.8517912720163, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.43071528367346, "num_env_steps_trained_throughput_per_sec": 74.43071528367346, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 56414.916, "restore_workers_time_ms": 0.014, "training_step_time_ms": 56414.86, "sample_time_ms": 2743.333, "learn_time_ms": 53652.353, "learn_throughput": 74.554, "synch_weights_time_ms": 13.92}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "42d11_00000", "date": "2024-08-22_10-23-07", "timestamp": 1724302387, "time_this_iter_s": 53.789125204086304, "time_total_s": 737.3277986049652, "pid": 75262, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1710758b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 737.3277986049652, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 28.747368421052634, "ram_util_percent": 82.59473684210525}}
