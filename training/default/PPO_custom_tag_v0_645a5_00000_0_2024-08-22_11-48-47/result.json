{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4677829633471826, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.397626127515521, "policy_loss": -0.018057670727342604, "vf_loss": 6.4138434902070065, "vf_explained_var": 0.035538460117168526, "kl": 0.009201571797809154, "entropy": 1.60144101860662, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2024647752995845, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.229742220217589, "policy_loss": -0.02065946942456461, "vf_loss": 7.247933499270646, "vf_explained_var": 0.055599480741238466, "kl": 0.012341019263239725, "entropy": 1.5992011561595574, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 68.85643678507037, "num_env_steps_trained_throughput_per_sec": 68.85643678507037, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 58091.892, "restore_workers_time_ms": 0.019, "training_step_time_ms": 58091.832, "sample_time_ms": 5462.392, "learn_time_ms": 52612.674, "learn_throughput": 76.027, "synch_weights_time_ms": 14.689}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "645a5_00000", "date": "2024-08-22_11-54-18", "timestamp": 1724307858, "time_this_iter_s": 58.1794171333313, "time_total_s": 58.1794171333313, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x15eec6af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 58.1794171333313, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 43.727380952380955, "ram_util_percent": 83.56904761904762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.779173559801919, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.50120888904289, "policy_loss": -0.024406010870176253, "vf_loss": 4.523129378172456, "vf_explained_var": 0.11600343559784863, "kl": 0.012427679494161297, "entropy": 1.5824878517282073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.610751351225313, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.988166211143373, "policy_loss": -0.024034558623910896, "vf_loss": 6.009506353247103, "vf_explained_var": 0.18584911258763107, "kl": 0.013472033966062886, "entropy": 1.5764438263953677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.83556771430668, "num_env_steps_trained_throughput_per_sec": 67.83556771430668, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 58529.053, "restore_workers_time_ms": 0.093, "training_step_time_ms": 58528.864, "sample_time_ms": 5180.871, "learn_time_ms": 53330.787, "learn_throughput": 75.004, "synch_weights_time_ms": 14.129}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "645a5_00000", "date": "2024-08-22_11-55-21", "timestamp": 1724307921, "time_this_iter_s": 59.03346300125122, "time_total_s": 117.21288013458252, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x15eedf820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 117.21288013458252, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 43.66590909090909, "ram_util_percent": 83.47386363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7072381196829376, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.9706606495948065, "policy_loss": -0.019309152338885402, "vf_loss": 2.987833288926927, "vf_explained_var": 0.1516241577567247, "kl": 0.01068258444432455, "entropy": 1.5762223350938667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.709084936866054, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.325098637172154, "policy_loss": -0.021516085932309685, "vf_loss": 5.344391110586741, "vf_explained_var": 0.2650323951055133, "kl": 0.011118110204940888, "entropy": 1.5637588641000173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.23446775186426, "num_env_steps_trained_throughput_per_sec": 71.23446775186426, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 57736.902, "restore_workers_time_ms": 0.066, "training_step_time_ms": 57736.762, "sample_time_ms": 4486.689, "learn_time_ms": 53232.265, "learn_throughput": 75.142, "synch_weights_time_ms": 14.259}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "645a5_00000", "date": "2024-08-22_11-56-17", "timestamp": 1724307977, "time_this_iter_s": 56.225656270980835, "time_total_s": 173.43853640556335, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a118940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 173.43853640556335, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 35.93, "ram_util_percent": 83.33250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5614234728157204, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.039318256277256, "policy_loss": -0.023608897415497317, "vf_loss": 2.0604645486231203, "vf_explained_var": 0.13972247482607605, "kl": 0.012313030532157177, "entropy": 1.5630234001174805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.221737365180222, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.38711902338361, "policy_loss": -0.025100479916565947, "vf_loss": 5.409744885737303, "vf_explained_var": 0.2944144506303091, "kl": 0.012373137259646443, "entropy": 1.550979233608044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.82006635016495, "num_env_steps_trained_throughput_per_sec": 70.82006635016495, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 57422.971, "restore_workers_time_ms": 0.054, "training_step_time_ms": 57422.849, "sample_time_ms": 4074.684, "learn_time_ms": 53328.869, "learn_throughput": 75.006, "synch_weights_time_ms": 15.554}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "645a5_00000", "date": "2024-08-22_11-57-13", "timestamp": 1724308033, "time_this_iter_s": 56.49554991722107, "time_total_s": 229.93408632278442, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a118550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 229.93408632278442, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 38.896249999999995, "ram_util_percent": 83.38125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7565832463837174, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.0167384391739254, "policy_loss": -0.023715458003675968, "vf_loss": 2.0382146719586913, "vf_explained_var": 0.1475930356159412, "kl": 0.011196113447781908, "entropy": 1.5543230894381408, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.937963082361474, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.751751433730756, "policy_loss": -0.022566398668654813, "vf_loss": 5.771587038292456, "vf_explained_var": 0.4627211390033601, "kl": 0.013654027667965878, "entropy": 1.548187640798155, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.756367426342, "num_env_steps_trained_throughput_per_sec": 67.756367426342, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 57745.387, "restore_workers_time_ms": 0.047, "training_step_time_ms": 57745.28, "sample_time_ms": 4376.899, "learn_time_ms": 53349.19, "learn_throughput": 74.978, "synch_weights_time_ms": 15.514}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "645a5_00000", "date": "2024-08-22_11-58-12", "timestamp": 1724308092, "time_this_iter_s": 59.080581188201904, "time_total_s": 289.0146675109863, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a11fb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 289.0146675109863, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 39.166666666666664, "ram_util_percent": 83.41547619047617}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4621065573086813, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 1.7925726698189186, "policy_loss": -0.022647218799179115, "vf_loss": 1.813198807283684, "vf_explained_var": 0.14845757162760173, "kl": 0.010105397635036045, "entropy": 1.545176915958445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.345665046462306, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.047252986040065, "policy_loss": -0.02178685800665152, "vf_loss": 6.066580737078631, "vf_explained_var": 0.4667580651858496, "kl": 0.012295623672584062, "entropy": 1.5371340399696714, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.61832806939493, "num_env_steps_trained_throughput_per_sec": 71.61832806939493, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 57429.762, "restore_workers_time_ms": 0.042, "training_step_time_ms": 57429.664, "sample_time_ms": 4090.842, "learn_time_ms": 53319.872, "learn_throughput": 75.019, "synch_weights_time_ms": 15.6}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "645a5_00000", "date": "2024-08-22_11-59-08", "timestamp": 1724308148, "time_this_iter_s": 55.88016724586487, "time_total_s": 344.8948347568512, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a11fee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 344.8948347568512, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 34.548101265822794, "ram_util_percent": 83.35063291139241}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1424833706762425, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 1.5486472569130085, "policy_loss": -0.020520846677387242, "vf_loss": 1.56712964063599, "vf_explained_var": 0.169494497460663, "kl": 0.010192300756979319, "entropy": 1.5356782539811715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.880668370875101, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.085342716792273, "policy_loss": -0.021285420829903274, "vf_loss": 6.1045201301574705, "vf_explained_var": 0.6341653663014609, "kl": 0.010539996163012884, "entropy": 1.5306224476092707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.04417295082122, "num_env_steps_trained_throughput_per_sec": 71.04417295082122, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 57268.797, "restore_workers_time_ms": 0.038, "training_step_time_ms": 57268.707, "sample_time_ms": 3867.774, "learn_time_ms": 53381.086, "learn_throughput": 74.933, "synch_weights_time_ms": 15.298}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "645a5_00000", "date": "2024-08-22_12-00-05", "timestamp": 1724308205, "time_this_iter_s": 56.36054706573486, "time_total_s": 401.25538182258606, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a122b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 401.25538182258606, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 41.2625, "ram_util_percent": 83.33250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.95591141064331, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.1838730382540867, "policy_loss": -0.016795136023524695, "vf_loss": 2.1982221555142174, "vf_explained_var": 0.19044129687642294, "kl": 0.012230085888532577, "entropy": 1.5050040825964912, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 1007.3425000000004}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.257164536140584, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.124333252477898, "policy_loss": -0.022521524203980646, "vf_loss": 6.144304862602678, "vf_explained_var": 0.5969588537064809, "kl": 0.012749665905967867, "entropy": 1.518621242487872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 1007.3425000000004}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 716.3738243326479, "episode_reward_min": 118.00648670042213, "episode_reward_mean": 440.1583120989246, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 4800, "policy_reward_min": {"prey_policy": -268.1861668071717, "predator_policy": 10.920795376005934}, "policy_reward_max": {"prey_policy": 334.32732632527535, "predator_policy": 471.2090066931244}, "policy_reward_mean": {"prey_policy": 57.31856235426951, "predator_policy": 162.76059369519285}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.00648670042213, 615.3999999999994, 431.76691416727795, 274.1999999999995, 359.47899152275147, 530.3393795284953, 716.3738243326479, 589.2535850132917, 450.18056392221, 364.9000000000008, 465.1999999999991, 366.8000000000013], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-201.24106863591646, 1.2688798657422529, 333.3713026668235, 119.59232046999128, -71.53736313463932, 244.0976731423206, -50.82917838279889, -77.52620649501377, 10.072793062991131, -94.94692328509029, 253.00551504533527, -242.71010583165855, 334.32732632527535, 234.5015890101486, 245.4624569630346, 129.89547206630263, -268.1861668071717, 78.7970709948452, 226.376776310334, -123.9662428840361, 182.5075552106424, -131.8290736155017, 44.50000000000036, 200.64109444050763], "policy_predator_policy_reward": [255.80850726286252, 62.17016820773524, 39.82869733317648, 122.60767953000816, 157.6615947885425, 101.54500937105361, 289.42917838279857, 113.12620649501174, 248.54462436557745, 195.80849737927352, 48.83496362169426, 471.2090066931244, 66.74515982668048, 80.7997491705436, 10.920795376005934, 202.97486060794787, 199.3589699738844, 440.21068976065277, 161.35931256926372, 101.13015400443652, 129.29244478935755, 285.22907361550466, 102.94275631905566, 18.716149240436607]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.575245651917963, "mean_inference_ms": 6.762080305743477, "mean_action_processing_ms": 3.7127821366864726, "mean_env_wait_ms": 13.22723658780175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041226545969645185, "StateBufferConnector_ms": 0.00411371390024821, "ViewRequirementAgentConnector_ms": 0.1739551623662313}, "num_episodes": 12, "episode_return_max": 716.3738243326479, "episode_return_min": 118.00648670042213, "episode_return_mean": 440.1583120989246, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.65335793113893, "num_env_steps_trained_throughput_per_sec": 72.65335793113893, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 56992.193, "restore_workers_time_ms": 0.035, "training_step_time_ms": 56992.106, "sample_time_ms": 3702.015, "learn_time_ms": 53269.114, "learn_throughput": 75.09, "synch_weights_time_ms": 15.128}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "645a5_00000", "date": "2024-08-22_12-01-00", "timestamp": 1724308260, "time_this_iter_s": 55.13865804672241, "time_total_s": 456.3940398693085, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a11c1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 456.3940398693085, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 33.99102564102564, "ram_util_percent": 83.30256410256409}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.969550010514638, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.2494952571455133, "policy_loss": -0.022205954217770822, "vf_loss": 3.269262271268027, "vf_explained_var": 0.22956738500368026, "kl": 0.012194681756454643, "entropy": 1.4596644716918783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.527668848428776, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.636879342447513, "policy_loss": -0.025857615374551012, "vf_loss": 6.6595575519339745, "vf_explained_var": 0.5494745080748563, "kl": 0.015897026609520984, "entropy": 1.4759050571729266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 716.3738243326479, "episode_reward_min": 50.45546895475954, "episode_reward_mean": 362.9493437359538, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28400, "policy_reward_min": {"prey_policy": -554.3828616898514, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 567.0428811600835}, "policy_reward_mean": {"prey_policy": 29.18471010252802, "predator_policy": 152.2899617654489}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.00648670042213, 615.3999999999994, 431.76691416727795, 274.1999999999995, 359.47899152275147, 530.3393795284953, 716.3738243326479, 589.2535850132917, 450.18056392221, 364.9000000000008, 465.1999999999991, 366.8000000000013, 316.4000000000003, 571.3999999999999, 361.3000000000013, 252.0850729029153, 660.6999999999998, 420.8964210263408, 495.1236001461828, 413.70000000000005, 640.8, 502.86553956755284, 75.59999999999998, 160.79999999999947, 329.79999999999984, 154.25639426392422, 207.18836568820916, 539.2999999999995, 64.70000000000047, 288.1999999999996, 139.19999999999993, 133.69999999999933, 93.17300132213498, 58.351757596365275, 446.7750400285624, 449.9960420258991, 515.9343128709143, 357.13008530589775, 620.2, 64.5000000000006, 487.48755074184334, 199.2999999999997, 442.99999999999955, 238.14343590788926, 327.2999999999998, 374.36365647458524, 607.0726565307655, 81.30879837316557, 477.0967463098938, 491.76642204987104, 289.2000000000002, 319.99999999999955, 615.6, 308.01286347544954, 371.6000000000015, 662.9987274958014, 226.1999999999996, 526.3176097385935, 579.1153368474343, 525.0147587540813, 304.30000000000007, 307.61706433213266, 50.45546895475954, 223.85302134597646, 75.00000000000001, 68.1000000000004, 133.60000000000005, 390.7999999999993, 428.70000000000084, 573.2869211358554, 446.816988852629], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-201.24106863591646, 1.2688798657422529, 333.3713026668235, 119.59232046999128, -71.53736313463932, 244.0976731423206, -50.82917838279889, -77.52620649501377, 10.072793062991131, -94.94692328509029, 253.00551504533527, -242.71010583165855, 334.32732632527535, 234.5015890101486, 245.4624569630346, 129.89547206630263, -268.1861668071717, 78.7970709948452, 226.376776310334, -123.9662428840361, 182.5075552106424, -131.8290736155017, 44.50000000000036, 200.64109444050763, 250.23138004898527, -33.68514986518974, 178.802873087588, 238.88803877595944, 196.35377853028731, -37.758716592024065, -274.98830517049106, -295.6688326289921, 359.10570365522943, 240.60389072284735, -191.8899207350484, -55.78413548711356, 59.33128931505896, 216.42001567327145, 12.0861211823715, 102.33110342206326, 319.1349386266631, 187.7278616977215, 14.736604211874749, 174.81970160266457, 40.0000000000003, -42.249524236062584, -98.88577702489404, 3.336330138575923, 215.81592010585595, -554.3828616898514, -232.7368395700359, 7.662347733065268, -56.618600953239365, -283.5530460942813, -88.29598842856078, 345.73135771769677, -179.68703552003007, -297.61452517689327, -64.08507335006034, 112.64251619983264, -46.80411339520475, -209.16847193983676, -82.24853378260853, 57.958425831250345, -178.85464515565147, -69.06468896244822, -90.34859618392925, -45.43355933952728, 128.48949932622065, 245.33229564610227, 39.397026880319345, -3.574967084882374, 179.57855197425192, 232.5734660471443, 36.32883983153456, -49.56324312230429, 172.8505635657601, 226.03608370663565, -278.3349170970575, 30.569613521604236, -2.8235209473970313, 195.36068610967143, -126.0314281144098, 60.172722269982486, 107.79100413081618, 148.29856504936123, -313.85491647471287, -55.301331745659766, -37.19882153361032, 156.40253275692945, 196.6269597636079, -207.50696670314036, 184.93122794952248, 373.55978807917785, -60.37803320947567, -362.95511892321224, 123.99186445999182, 144.63110155983884, 10.963803270346926, 330.7000577239183, -26.028865922802233, 53.802617882191846, -147.13240521296743, 237.76244507157352, 82.84042290966096, 322.96266689103027, -68.4647992448787, 125.15727646308093, -208.91668476130565, 322.04237591058404, 299.6062265432927, 110.54340789911882, 151.20738533473573, -12.45394945524123, -7.911971020713139, 211.3268345802874, 197.14026413266288, 183.1570468393131, 14.913227103983559, 139.58641065911556, -126.65148247035896, 227.66091448031793, -70.29065494162194, -271.53628125492247, -82.37171472051415, -446.9937685701329, -181.5709413194396, -3.160571204106405, -77.18108488441965, 31.88705289060019, -79.87639045052025, -101.44079943838025, -45.88489996424087, -79.76586987744707, 327.8787698756249, -316.91172647914914, 400.0, -252.2725509968755, 279.11101480812266, 22.531581507784704, 132.79020537189552, -149.48364257219333], "policy_predator_policy_reward": [255.80850726286252, 62.17016820773524, 39.82869733317648, 122.60767953000816, 157.6615947885425, 101.54500937105361, 289.42917838279857, 113.12620649501174, 248.54462436557745, 195.80849737927352, 48.83496362169426, 471.2090066931244, 66.74515982668048, 80.7997491705436, 10.920795376005934, 202.97486060794787, 199.3589699738844, 440.21068976065277, 161.35931256926372, 101.13015400443652, 129.29244478935755, 285.22907361550466, 102.94275631905566, 18.716149240436607, 31.668619951014723, 68.18514986519025, 87.20165272360147, 66.50743541285124, 121.09802033134602, 81.60691773039063, 296.478566660314, 526.2636440420844, 22.894296344770563, 38.096109277152706, 340.45976578789873, 328.11071146060453, 194.17823134168816, 25.19406381616413, 108.56451878953243, 190.71825660603182, 19.465061373336912, 114.4721383022782, 199.56146036508096, 113.74777338793248, 0.0, 77.84952423606273, 222.18577702489355, 34.163669861424296, 101.32406042391425, 567.0428811600835, 317.6893233148042, 61.641562786094724, 156.95179487392247, 390.4082178618132, 194.10092442260404, 87.76370628825931, 206.82353736974403, 335.17802332718446, 98.58507335006051, 141.05748380016686, 80.3041133952052, 314.8684719398359, 128.8485337826083, 29.141574168749717, 208.09929909838064, 132.9930363418521, 40.182052676148054, 153.95186044367125, 40.610500673779384, 32.342744382460296, 144.30471548644675, 269.86926674401576, 87.18286839620038, 16.599426453317793, 216.91643128289135, 153.44805731377667, 143.94943643423994, 77.36391629336435, 303.73491709706207, 8.530386478395922, 261.1924288073794, 33.75795677218909, 160.53142811440887, 104.62727773001633, 7.349128813493334, 179.56130200632896, 447.11666838932825, 160.18301573893288, 131.06760694898907, 77.02868182769119, 58.336696710977385, 326.90696670314003, 46.559667262209636, 2.0219732398551504, 339.8587409724869, 164.7832095333656, 70.03546774865711, 138.4383125414054, 133.64732070653105, 16.455240349075847, 62.328865922802606, 199.09738211780783, 199.63240521296643, 29.73755492842648, 186.159577090339, 23.637333108969766, 129.140013789191, 122.18037246805413, 235.81668476130517, 22.657624089415982, 139.88141069382905, 112.96768235956071, 69.54106248882421, 17.905501631681307, 169.01332987203375, 153.88941630698565, 115.43706906324657, 83.38095681221216, 215.8057419446116, 154.7093790463708, 158.65148247035714, 44.63908551968206, 287.9551203591743, 361.4888801695015, 61.49080065713903, 518.3301515882682, 332.40037593490706, 76.18415793461621, 115.82320542075031, 4.470826573067303, 114.1763904505183, 135.24079943837836, 143.3848999642395, 115.86586987744722, 39.12123012437506, 340.7117264791493, 183.8272363934923, 97.1453146033832, 152.38569803184615, 119.25862678810195, 202.6880207899514, 260.8224052629753]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.391672084503677, "mean_inference_ms": 6.697803934663916, "mean_action_processing_ms": 3.593521264608221, "mean_env_wait_ms": 13.08213270033484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005316566413557025, "StateBufferConnector_ms": 0.0066280364990234375, "ViewRequirementAgentConnector_ms": 0.20961425673793738}, "num_episodes": 59, "episode_return_max": 716.3738243326479, "episode_return_min": 50.45546895475954, "episode_return_mean": 362.9493437359538, "episodes_this_iter": 59}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.05764385551686, "num_env_steps_trained_throughput_per_sec": 71.05764385551686, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 56914.431, "restore_workers_time_ms": 0.033, "training_step_time_ms": 56914.348, "sample_time_ms": 3614.145, "learn_time_ms": 53279.459, "learn_throughput": 75.076, "synch_weights_time_ms": 15.264}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "645a5_00000", "date": "2024-08-22_12-01-56", "timestamp": 1724308316, "time_this_iter_s": 56.351654052734375, "time_total_s": 512.7456939220428, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x15eedfaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 512.7456939220428, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 33.265, "ram_util_percent": 83.29124999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.428732839274028, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.193198330440218, "policy_loss": -0.024737903851123833, "vf_loss": 5.21443506763095, "vf_explained_var": 0.18659605093733975, "kl": 0.017505820420516467, "entropy": 1.3562026857699037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.263106126003164, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.09611371534842, "policy_loss": -0.021767903230936518, "vf_loss": 7.114325533215962, "vf_explained_var": 0.35658141324129056, "kl": 0.017780480170918125, "entropy": 1.4069107652341246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 716.3738243326479, "episode_reward_min": -68.26888083597322, "episode_reward_mean": 338.20408564288056, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -554.3828616898514, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 567.0428811600835}, "policy_reward_mean": {"prey_policy": 20.2924861009921, "predator_policy": 148.80955672044814}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.00648670042213, 615.3999999999994, 431.76691416727795, 274.1999999999995, 359.47899152275147, 530.3393795284953, 716.3738243326479, 589.2535850132917, 450.18056392221, 364.9000000000008, 465.1999999999991, 366.8000000000013, 316.4000000000003, 571.3999999999999, 361.3000000000013, 252.0850729029153, 660.6999999999998, 420.8964210263408, 495.1236001461828, 413.70000000000005, 640.8, 502.86553956755284, 75.59999999999998, 160.79999999999947, 329.79999999999984, 154.25639426392422, 207.18836568820916, 539.2999999999995, 64.70000000000047, 288.1999999999996, 139.19999999999993, 133.69999999999933, 93.17300132213498, 58.351757596365275, 446.7750400285624, 449.9960420258991, 515.9343128709143, 357.13008530589775, 620.2, 64.5000000000006, 487.48755074184334, 199.2999999999997, 442.99999999999955, 238.14343590788926, 327.2999999999998, 374.36365647458524, 607.0726565307655, 81.30879837316557, 477.0967463098938, 491.76642204987104, 289.2000000000002, 319.99999999999955, 615.6, 308.01286347544954, 371.6000000000015, 662.9987274958014, 226.1999999999996, 526.3176097385935, 579.1153368474343, 525.0147587540813, 304.30000000000007, 307.61706433213266, 50.45546895475954, 223.85302134597646, 75.00000000000001, 68.1000000000004, 133.60000000000005, 390.7999999999993, 428.70000000000084, 573.2869211358554, 446.816988852629, 288.63498775230926, 130.099999999997, 130.90000000000015, 514.4999999999998, -68.26888083597322, 78.89656160166523, 301.59679824362445, 88.50000000000016, 55.02930578823269, 360.4955038806338, 502.9999999999994, 73.20000000000013, 284.65275116279787, 69.40000000000033, 134.09999999999624, 329.09999999999945, 422.3000000000032, 601.6000000000004, 371.2272750132408], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-201.24106863591646, 1.2688798657422529, 333.3713026668235, 119.59232046999128, -71.53736313463932, 244.0976731423206, -50.82917838279889, -77.52620649501377, 10.072793062991131, -94.94692328509029, 253.00551504533527, -242.71010583165855, 334.32732632527535, 234.5015890101486, 245.4624569630346, 129.89547206630263, -268.1861668071717, 78.7970709948452, 226.376776310334, -123.9662428840361, 182.5075552106424, -131.8290736155017, 44.50000000000036, 200.64109444050763, 250.23138004898527, -33.68514986518974, 178.802873087588, 238.88803877595944, 196.35377853028731, -37.758716592024065, -274.98830517049106, -295.6688326289921, 359.10570365522943, 240.60389072284735, -191.8899207350484, -55.78413548711356, 59.33128931505896, 216.42001567327145, 12.0861211823715, 102.33110342206326, 319.1349386266631, 187.7278616977215, 14.736604211874749, 174.81970160266457, 40.0000000000003, -42.249524236062584, -98.88577702489404, 3.336330138575923, 215.81592010585595, -554.3828616898514, -232.7368395700359, 7.662347733065268, -56.618600953239365, -283.5530460942813, -88.29598842856078, 345.73135771769677, -179.68703552003007, -297.61452517689327, -64.08507335006034, 112.64251619983264, -46.80411339520475, -209.16847193983676, -82.24853378260853, 57.958425831250345, -178.85464515565147, -69.06468896244822, -90.34859618392925, -45.43355933952728, 128.48949932622065, 245.33229564610227, 39.397026880319345, -3.574967084882374, 179.57855197425192, 232.5734660471443, 36.32883983153456, -49.56324312230429, 172.8505635657601, 226.03608370663565, -278.3349170970575, 30.569613521604236, -2.8235209473970313, 195.36068610967143, -126.0314281144098, 60.172722269982486, 107.79100413081618, 148.29856504936123, -313.85491647471287, -55.301331745659766, -37.19882153361032, 156.40253275692945, 196.6269597636079, -207.50696670314036, 184.93122794952248, 373.55978807917785, -60.37803320947567, -362.95511892321224, 123.99186445999182, 144.63110155983884, 10.963803270346926, 330.7000577239183, -26.028865922802233, 53.802617882191846, -147.13240521296743, 237.76244507157352, 82.84042290966096, 322.96266689103027, -68.4647992448787, 125.15727646308093, -208.91668476130565, 322.04237591058404, 299.6062265432927, 110.54340789911882, 151.20738533473573, -12.45394945524123, -7.911971020713139, 211.3268345802874, 197.14026413266288, 183.1570468393131, 14.913227103983559, 139.58641065911556, -126.65148247035896, 227.66091448031793, -70.29065494162194, -271.53628125492247, -82.37171472051415, -446.9937685701329, -181.5709413194396, -3.160571204106405, -77.18108488441965, 31.88705289060019, -79.87639045052025, -101.44079943838025, -45.88489996424087, -79.76586987744707, 327.8787698756249, -316.91172647914914, 400.0, -252.2725509968755, 279.11101480812266, 22.531581507784704, 132.79020537189552, -149.48364257219333, 140.7775291224683, -283.5796993170686, 37.68966347949264, -66.89877839321669, -148.9334175405423, 61.095379032658066, 57.59195017341912, 242.61719993542093, -381.73699083208936, -169.61812835760907, 1.0364556275710726, -450.6237330306215, 227.71154834334885, -12.184887024289011, -52.74364606910354, 24.499567626943705, -8.868681404062837, -217.07842058765473, -46.845948471160625, -3.2443525968149878, 213.4485548186942, 134.16436766249632, -213.81982209785144, -25.169402617795875, 28.886582189934714, -290.03859166373405, 5.29355488061206, -120.29554575770197, 82.9415854839931, -22.725795557705176, 234.14217866799208, -83.62748015351771, 263.2126315002507, 83.19999999999914, 292.86881150859676, 109.34611226412741, 142.86474912772266, -276.9364363536038], "policy_predator_policy_reward": [255.80850726286252, 62.17016820773524, 39.82869733317648, 122.60767953000816, 157.6615947885425, 101.54500937105361, 289.42917838279857, 113.12620649501174, 248.54462436557745, 195.80849737927352, 48.83496362169426, 471.2090066931244, 66.74515982668048, 80.7997491705436, 10.920795376005934, 202.97486060794787, 199.3589699738844, 440.21068976065277, 161.35931256926372, 101.13015400443652, 129.29244478935755, 285.22907361550466, 102.94275631905566, 18.716149240436607, 31.668619951014723, 68.18514986519025, 87.20165272360147, 66.50743541285124, 121.09802033134602, 81.60691773039063, 296.478566660314, 526.2636440420844, 22.894296344770563, 38.096109277152706, 340.45976578789873, 328.11071146060453, 194.17823134168816, 25.19406381616413, 108.56451878953243, 190.71825660603182, 19.465061373336912, 114.4721383022782, 199.56146036508096, 113.74777338793248, 0.0, 77.84952423606273, 222.18577702489355, 34.163669861424296, 101.32406042391425, 567.0428811600835, 317.6893233148042, 61.641562786094724, 156.95179487392247, 390.4082178618132, 194.10092442260404, 87.76370628825931, 206.82353736974403, 335.17802332718446, 98.58507335006051, 141.05748380016686, 80.3041133952052, 314.8684719398359, 128.8485337826083, 29.141574168749717, 208.09929909838064, 132.9930363418521, 40.182052676148054, 153.95186044367125, 40.610500673779384, 32.342744382460296, 144.30471548644675, 269.86926674401576, 87.18286839620038, 16.599426453317793, 216.91643128289135, 153.44805731377667, 143.94943643423994, 77.36391629336435, 303.73491709706207, 8.530386478395922, 261.1924288073794, 33.75795677218909, 160.53142811440887, 104.62727773001633, 7.349128813493334, 179.56130200632896, 447.11666838932825, 160.18301573893288, 131.06760694898907, 77.02868182769119, 58.336696710977385, 326.90696670314003, 46.559667262209636, 2.0219732398551504, 339.8587409724869, 164.7832095333656, 70.03546774865711, 138.4383125414054, 133.64732070653105, 16.455240349075847, 62.328865922802606, 199.09738211780783, 199.63240521296643, 29.73755492842648, 186.159577090339, 23.637333108969766, 129.140013789191, 122.18037246805413, 235.81668476130517, 22.657624089415982, 139.88141069382905, 112.96768235956071, 69.54106248882421, 17.905501631681307, 169.01332987203375, 153.88941630698565, 115.43706906324657, 83.38095681221216, 215.8057419446116, 154.7093790463708, 158.65148247035714, 44.63908551968206, 287.9551203591743, 361.4888801695015, 61.49080065713903, 518.3301515882682, 332.40037593490706, 76.18415793461621, 115.82320542075031, 4.470826573067303, 114.1763904505183, 135.24079943837836, 143.3848999642395, 115.86586987744722, 39.12123012437506, 340.7117264791493, 183.8272363934923, 97.1453146033832, 152.38569803184615, 119.25862678810195, 202.6880207899514, 260.8224052629753, 119.97938091712608, 311.4577770297825, 57.81033652050748, 101.49877839321472, 190.9527976102681, 27.785240897614344, 156.70804982658032, 57.58280006457918, 128.60251928657604, 354.4837190671484, 260.98940805914094, 267.4944309455743, 22.951439495738697, 63.11869742882649, 88.34364606910232, 28.400432373056418, 26.189726756562614, 254.78668102338608, 337.0483799514387, 73.53742499717112, 13.780624387179481, 141.6064531316299, 147.7197165716534, 164.46950814399287, 212.38980628832354, 333.41495434827436, 33.20644511938814, 151.19554575770022, 1.8584145160060492, 72.02579555770538, 40.05782133200807, 138.52748015351764, 15.77505047700694, 60.112318022742265, 53.63118849140326, 145.75388773587244, 195.94059649492175, 309.3583657441994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.398050114831952, "mean_inference_ms": 6.6782906914273354, "mean_action_processing_ms": 3.5159396772638956, "mean_env_wait_ms": 13.11388431881354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005231963263617622, "StateBufferConnector_ms": 0.009911722607082792, "ViewRequirementAgentConnector_ms": 0.2000594139099121}, "num_episodes": 19, "episode_return_max": 716.3738243326479, "episode_return_min": -68.26888083597322, "episode_return_mean": 338.20408564288056, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.19313045590646, "num_env_steps_trained_throughput_per_sec": 71.19313045590646, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 56841.508, "restore_workers_time_ms": 0.031, "training_step_time_ms": 56841.429, "sample_time_ms": 3517.675, "learn_time_ms": 53303.508, "learn_throughput": 75.042, "synch_weights_time_ms": 14.995}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "645a5_00000", "date": "2024-08-22_12-02-53", "timestamp": 1724308373, "time_this_iter_s": 56.26590418815613, "time_total_s": 569.011598110199, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a11cc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 569.011598110199, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 34.36875, "ram_util_percent": 83.295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.8004414276471215, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.941346611926164, "policy_loss": -0.025036599028057285, "vf_loss": 4.963075082768839, "vf_explained_var": 0.19932623489823922, "kl": 0.016540606543372468, "entropy": 1.344737932164833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 986.5525000000015}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.552413630863978, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.698392406847111, "policy_loss": -0.02503563569311703, "vf_loss": 6.7203348477681475, "vf_explained_var": 0.39528273164279876, "kl": 0.015465964425956368, "entropy": 1.4199788699705134, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 986.5525000000015}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 716.3738243326479, "episode_reward_min": -68.26888083597322, "episode_reward_mean": 338.20408564288056, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -554.3828616898514, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 567.0428811600835}, "policy_reward_mean": {"prey_policy": 20.2924861009921, "predator_policy": 148.80955672044814}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.00648670042213, 615.3999999999994, 431.76691416727795, 274.1999999999995, 359.47899152275147, 530.3393795284953, 716.3738243326479, 589.2535850132917, 450.18056392221, 364.9000000000008, 465.1999999999991, 366.8000000000013, 316.4000000000003, 571.3999999999999, 361.3000000000013, 252.0850729029153, 660.6999999999998, 420.8964210263408, 495.1236001461828, 413.70000000000005, 640.8, 502.86553956755284, 75.59999999999998, 160.79999999999947, 329.79999999999984, 154.25639426392422, 207.18836568820916, 539.2999999999995, 64.70000000000047, 288.1999999999996, 139.19999999999993, 133.69999999999933, 93.17300132213498, 58.351757596365275, 446.7750400285624, 449.9960420258991, 515.9343128709143, 357.13008530589775, 620.2, 64.5000000000006, 487.48755074184334, 199.2999999999997, 442.99999999999955, 238.14343590788926, 327.2999999999998, 374.36365647458524, 607.0726565307655, 81.30879837316557, 477.0967463098938, 491.76642204987104, 289.2000000000002, 319.99999999999955, 615.6, 308.01286347544954, 371.6000000000015, 662.9987274958014, 226.1999999999996, 526.3176097385935, 579.1153368474343, 525.0147587540813, 304.30000000000007, 307.61706433213266, 50.45546895475954, 223.85302134597646, 75.00000000000001, 68.1000000000004, 133.60000000000005, 390.7999999999993, 428.70000000000084, 573.2869211358554, 446.816988852629, 288.63498775230926, 130.099999999997, 130.90000000000015, 514.4999999999998, -68.26888083597322, 78.89656160166523, 301.59679824362445, 88.50000000000016, 55.02930578823269, 360.4955038806338, 502.9999999999994, 73.20000000000013, 284.65275116279787, 69.40000000000033, 134.09999999999624, 329.09999999999945, 422.3000000000032, 601.6000000000004, 371.2272750132408], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-201.24106863591646, 1.2688798657422529, 333.3713026668235, 119.59232046999128, -71.53736313463932, 244.0976731423206, -50.82917838279889, -77.52620649501377, 10.072793062991131, -94.94692328509029, 253.00551504533527, -242.71010583165855, 334.32732632527535, 234.5015890101486, 245.4624569630346, 129.89547206630263, -268.1861668071717, 78.7970709948452, 226.376776310334, -123.9662428840361, 182.5075552106424, -131.8290736155017, 44.50000000000036, 200.64109444050763, 250.23138004898527, -33.68514986518974, 178.802873087588, 238.88803877595944, 196.35377853028731, -37.758716592024065, -274.98830517049106, -295.6688326289921, 359.10570365522943, 240.60389072284735, -191.8899207350484, -55.78413548711356, 59.33128931505896, 216.42001567327145, 12.0861211823715, 102.33110342206326, 319.1349386266631, 187.7278616977215, 14.736604211874749, 174.81970160266457, 40.0000000000003, -42.249524236062584, -98.88577702489404, 3.336330138575923, 215.81592010585595, -554.3828616898514, -232.7368395700359, 7.662347733065268, -56.618600953239365, -283.5530460942813, -88.29598842856078, 345.73135771769677, -179.68703552003007, -297.61452517689327, -64.08507335006034, 112.64251619983264, -46.80411339520475, -209.16847193983676, -82.24853378260853, 57.958425831250345, -178.85464515565147, -69.06468896244822, -90.34859618392925, -45.43355933952728, 128.48949932622065, 245.33229564610227, 39.397026880319345, -3.574967084882374, 179.57855197425192, 232.5734660471443, 36.32883983153456, -49.56324312230429, 172.8505635657601, 226.03608370663565, -278.3349170970575, 30.569613521604236, -2.8235209473970313, 195.36068610967143, -126.0314281144098, 60.172722269982486, 107.79100413081618, 148.29856504936123, -313.85491647471287, -55.301331745659766, -37.19882153361032, 156.40253275692945, 196.6269597636079, -207.50696670314036, 184.93122794952248, 373.55978807917785, -60.37803320947567, -362.95511892321224, 123.99186445999182, 144.63110155983884, 10.963803270346926, 330.7000577239183, -26.028865922802233, 53.802617882191846, -147.13240521296743, 237.76244507157352, 82.84042290966096, 322.96266689103027, -68.4647992448787, 125.15727646308093, -208.91668476130565, 322.04237591058404, 299.6062265432927, 110.54340789911882, 151.20738533473573, -12.45394945524123, -7.911971020713139, 211.3268345802874, 197.14026413266288, 183.1570468393131, 14.913227103983559, 139.58641065911556, -126.65148247035896, 227.66091448031793, -70.29065494162194, -271.53628125492247, -82.37171472051415, -446.9937685701329, -181.5709413194396, -3.160571204106405, -77.18108488441965, 31.88705289060019, -79.87639045052025, -101.44079943838025, -45.88489996424087, -79.76586987744707, 327.8787698756249, -316.91172647914914, 400.0, -252.2725509968755, 279.11101480812266, 22.531581507784704, 132.79020537189552, -149.48364257219333, 140.7775291224683, -283.5796993170686, 37.68966347949264, -66.89877839321669, -148.9334175405423, 61.095379032658066, 57.59195017341912, 242.61719993542093, -381.73699083208936, -169.61812835760907, 1.0364556275710726, -450.6237330306215, 227.71154834334885, -12.184887024289011, -52.74364606910354, 24.499567626943705, -8.868681404062837, -217.07842058765473, -46.845948471160625, -3.2443525968149878, 213.4485548186942, 134.16436766249632, -213.81982209785144, -25.169402617795875, 28.886582189934714, -290.03859166373405, 5.29355488061206, -120.29554575770197, 82.9415854839931, -22.725795557705176, 234.14217866799208, -83.62748015351771, 263.2126315002507, 83.19999999999914, 292.86881150859676, 109.34611226412741, 142.86474912772266, -276.9364363536038], "policy_predator_policy_reward": [255.80850726286252, 62.17016820773524, 39.82869733317648, 122.60767953000816, 157.6615947885425, 101.54500937105361, 289.42917838279857, 113.12620649501174, 248.54462436557745, 195.80849737927352, 48.83496362169426, 471.2090066931244, 66.74515982668048, 80.7997491705436, 10.920795376005934, 202.97486060794787, 199.3589699738844, 440.21068976065277, 161.35931256926372, 101.13015400443652, 129.29244478935755, 285.22907361550466, 102.94275631905566, 18.716149240436607, 31.668619951014723, 68.18514986519025, 87.20165272360147, 66.50743541285124, 121.09802033134602, 81.60691773039063, 296.478566660314, 526.2636440420844, 22.894296344770563, 38.096109277152706, 340.45976578789873, 328.11071146060453, 194.17823134168816, 25.19406381616413, 108.56451878953243, 190.71825660603182, 19.465061373336912, 114.4721383022782, 199.56146036508096, 113.74777338793248, 0.0, 77.84952423606273, 222.18577702489355, 34.163669861424296, 101.32406042391425, 567.0428811600835, 317.6893233148042, 61.641562786094724, 156.95179487392247, 390.4082178618132, 194.10092442260404, 87.76370628825931, 206.82353736974403, 335.17802332718446, 98.58507335006051, 141.05748380016686, 80.3041133952052, 314.8684719398359, 128.8485337826083, 29.141574168749717, 208.09929909838064, 132.9930363418521, 40.182052676148054, 153.95186044367125, 40.610500673779384, 32.342744382460296, 144.30471548644675, 269.86926674401576, 87.18286839620038, 16.599426453317793, 216.91643128289135, 153.44805731377667, 143.94943643423994, 77.36391629336435, 303.73491709706207, 8.530386478395922, 261.1924288073794, 33.75795677218909, 160.53142811440887, 104.62727773001633, 7.349128813493334, 179.56130200632896, 447.11666838932825, 160.18301573893288, 131.06760694898907, 77.02868182769119, 58.336696710977385, 326.90696670314003, 46.559667262209636, 2.0219732398551504, 339.8587409724869, 164.7832095333656, 70.03546774865711, 138.4383125414054, 133.64732070653105, 16.455240349075847, 62.328865922802606, 199.09738211780783, 199.63240521296643, 29.73755492842648, 186.159577090339, 23.637333108969766, 129.140013789191, 122.18037246805413, 235.81668476130517, 22.657624089415982, 139.88141069382905, 112.96768235956071, 69.54106248882421, 17.905501631681307, 169.01332987203375, 153.88941630698565, 115.43706906324657, 83.38095681221216, 215.8057419446116, 154.7093790463708, 158.65148247035714, 44.63908551968206, 287.9551203591743, 361.4888801695015, 61.49080065713903, 518.3301515882682, 332.40037593490706, 76.18415793461621, 115.82320542075031, 4.470826573067303, 114.1763904505183, 135.24079943837836, 143.3848999642395, 115.86586987744722, 39.12123012437506, 340.7117264791493, 183.8272363934923, 97.1453146033832, 152.38569803184615, 119.25862678810195, 202.6880207899514, 260.8224052629753, 119.97938091712608, 311.4577770297825, 57.81033652050748, 101.49877839321472, 190.9527976102681, 27.785240897614344, 156.70804982658032, 57.58280006457918, 128.60251928657604, 354.4837190671484, 260.98940805914094, 267.4944309455743, 22.951439495738697, 63.11869742882649, 88.34364606910232, 28.400432373056418, 26.189726756562614, 254.78668102338608, 337.0483799514387, 73.53742499717112, 13.780624387179481, 141.6064531316299, 147.7197165716534, 164.46950814399287, 212.38980628832354, 333.41495434827436, 33.20644511938814, 151.19554575770022, 1.8584145160060492, 72.02579555770538, 40.05782133200807, 138.52748015351764, 15.77505047700694, 60.112318022742265, 53.63118849140326, 145.75388773587244, 195.94059649492175, 309.3583657441994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.398050114831952, "mean_inference_ms": 6.6782906914273354, "mean_action_processing_ms": 3.5159396772638956, "mean_env_wait_ms": 13.11388431881354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005231963263617622, "StateBufferConnector_ms": 0.009911722607082792, "ViewRequirementAgentConnector_ms": 0.2000594139099121}, "num_episodes": 0, "episode_return_max": 716.3738243326479, "episode_return_min": -68.26888083597322, "episode_return_mean": 338.20408564288056, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.1260693636554, "num_env_steps_trained_throughput_per_sec": 72.1260693636554, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 56578.165, "restore_workers_time_ms": 0.031, "training_step_time_ms": 56578.087, "sample_time_ms": 3244.839, "learn_time_ms": 53313.157, "learn_throughput": 75.028, "synch_weights_time_ms": 14.809}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "645a5_00000", "date": "2024-08-22_12-03-48", "timestamp": 1724308428, "time_this_iter_s": 55.52546691894531, "time_total_s": 624.5370650291443, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a118f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 624.5370650291443, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 33.39493670886076, "ram_util_percent": 83.24430379746835}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.534914502958772, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.906100031686208, "policy_loss": -0.022971139325410443, "vf_loss": 3.925797437990784, "vf_explained_var": 0.24082565575680404, "kl": 0.016368662491292943, "entropy": 1.3710028528536438, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.201665423093019, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.980363976766193, "policy_loss": -0.022171978495532162, "vf_loss": 5.999680642728452, "vf_explained_var": 0.3825720432258788, "kl": 0.014276631502680994, "entropy": 1.4522228398020305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 716.3738243326479, "episode_reward_min": -68.26888083597322, "episode_reward_mean": 338.20408564288056, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -554.3828616898514, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 567.0428811600835}, "policy_reward_mean": {"prey_policy": 20.2924861009921, "predator_policy": 148.80955672044814}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.00648670042213, 615.3999999999994, 431.76691416727795, 274.1999999999995, 359.47899152275147, 530.3393795284953, 716.3738243326479, 589.2535850132917, 450.18056392221, 364.9000000000008, 465.1999999999991, 366.8000000000013, 316.4000000000003, 571.3999999999999, 361.3000000000013, 252.0850729029153, 660.6999999999998, 420.8964210263408, 495.1236001461828, 413.70000000000005, 640.8, 502.86553956755284, 75.59999999999998, 160.79999999999947, 329.79999999999984, 154.25639426392422, 207.18836568820916, 539.2999999999995, 64.70000000000047, 288.1999999999996, 139.19999999999993, 133.69999999999933, 93.17300132213498, 58.351757596365275, 446.7750400285624, 449.9960420258991, 515.9343128709143, 357.13008530589775, 620.2, 64.5000000000006, 487.48755074184334, 199.2999999999997, 442.99999999999955, 238.14343590788926, 327.2999999999998, 374.36365647458524, 607.0726565307655, 81.30879837316557, 477.0967463098938, 491.76642204987104, 289.2000000000002, 319.99999999999955, 615.6, 308.01286347544954, 371.6000000000015, 662.9987274958014, 226.1999999999996, 526.3176097385935, 579.1153368474343, 525.0147587540813, 304.30000000000007, 307.61706433213266, 50.45546895475954, 223.85302134597646, 75.00000000000001, 68.1000000000004, 133.60000000000005, 390.7999999999993, 428.70000000000084, 573.2869211358554, 446.816988852629, 288.63498775230926, 130.099999999997, 130.90000000000015, 514.4999999999998, -68.26888083597322, 78.89656160166523, 301.59679824362445, 88.50000000000016, 55.02930578823269, 360.4955038806338, 502.9999999999994, 73.20000000000013, 284.65275116279787, 69.40000000000033, 134.09999999999624, 329.09999999999945, 422.3000000000032, 601.6000000000004, 371.2272750132408], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-201.24106863591646, 1.2688798657422529, 333.3713026668235, 119.59232046999128, -71.53736313463932, 244.0976731423206, -50.82917838279889, -77.52620649501377, 10.072793062991131, -94.94692328509029, 253.00551504533527, -242.71010583165855, 334.32732632527535, 234.5015890101486, 245.4624569630346, 129.89547206630263, -268.1861668071717, 78.7970709948452, 226.376776310334, -123.9662428840361, 182.5075552106424, -131.8290736155017, 44.50000000000036, 200.64109444050763, 250.23138004898527, -33.68514986518974, 178.802873087588, 238.88803877595944, 196.35377853028731, -37.758716592024065, -274.98830517049106, -295.6688326289921, 359.10570365522943, 240.60389072284735, -191.8899207350484, -55.78413548711356, 59.33128931505896, 216.42001567327145, 12.0861211823715, 102.33110342206326, 319.1349386266631, 187.7278616977215, 14.736604211874749, 174.81970160266457, 40.0000000000003, -42.249524236062584, -98.88577702489404, 3.336330138575923, 215.81592010585595, -554.3828616898514, -232.7368395700359, 7.662347733065268, -56.618600953239365, -283.5530460942813, -88.29598842856078, 345.73135771769677, -179.68703552003007, -297.61452517689327, -64.08507335006034, 112.64251619983264, -46.80411339520475, -209.16847193983676, -82.24853378260853, 57.958425831250345, -178.85464515565147, -69.06468896244822, -90.34859618392925, -45.43355933952728, 128.48949932622065, 245.33229564610227, 39.397026880319345, -3.574967084882374, 179.57855197425192, 232.5734660471443, 36.32883983153456, -49.56324312230429, 172.8505635657601, 226.03608370663565, -278.3349170970575, 30.569613521604236, -2.8235209473970313, 195.36068610967143, -126.0314281144098, 60.172722269982486, 107.79100413081618, 148.29856504936123, -313.85491647471287, -55.301331745659766, -37.19882153361032, 156.40253275692945, 196.6269597636079, -207.50696670314036, 184.93122794952248, 373.55978807917785, -60.37803320947567, -362.95511892321224, 123.99186445999182, 144.63110155983884, 10.963803270346926, 330.7000577239183, -26.028865922802233, 53.802617882191846, -147.13240521296743, 237.76244507157352, 82.84042290966096, 322.96266689103027, -68.4647992448787, 125.15727646308093, -208.91668476130565, 322.04237591058404, 299.6062265432927, 110.54340789911882, 151.20738533473573, -12.45394945524123, -7.911971020713139, 211.3268345802874, 197.14026413266288, 183.1570468393131, 14.913227103983559, 139.58641065911556, -126.65148247035896, 227.66091448031793, -70.29065494162194, -271.53628125492247, -82.37171472051415, -446.9937685701329, -181.5709413194396, -3.160571204106405, -77.18108488441965, 31.88705289060019, -79.87639045052025, -101.44079943838025, -45.88489996424087, -79.76586987744707, 327.8787698756249, -316.91172647914914, 400.0, -252.2725509968755, 279.11101480812266, 22.531581507784704, 132.79020537189552, -149.48364257219333, 140.7775291224683, -283.5796993170686, 37.68966347949264, -66.89877839321669, -148.9334175405423, 61.095379032658066, 57.59195017341912, 242.61719993542093, -381.73699083208936, -169.61812835760907, 1.0364556275710726, -450.6237330306215, 227.71154834334885, -12.184887024289011, -52.74364606910354, 24.499567626943705, -8.868681404062837, -217.07842058765473, -46.845948471160625, -3.2443525968149878, 213.4485548186942, 134.16436766249632, -213.81982209785144, -25.169402617795875, 28.886582189934714, -290.03859166373405, 5.29355488061206, -120.29554575770197, 82.9415854839931, -22.725795557705176, 234.14217866799208, -83.62748015351771, 263.2126315002507, 83.19999999999914, 292.86881150859676, 109.34611226412741, 142.86474912772266, -276.9364363536038], "policy_predator_policy_reward": [255.80850726286252, 62.17016820773524, 39.82869733317648, 122.60767953000816, 157.6615947885425, 101.54500937105361, 289.42917838279857, 113.12620649501174, 248.54462436557745, 195.80849737927352, 48.83496362169426, 471.2090066931244, 66.74515982668048, 80.7997491705436, 10.920795376005934, 202.97486060794787, 199.3589699738844, 440.21068976065277, 161.35931256926372, 101.13015400443652, 129.29244478935755, 285.22907361550466, 102.94275631905566, 18.716149240436607, 31.668619951014723, 68.18514986519025, 87.20165272360147, 66.50743541285124, 121.09802033134602, 81.60691773039063, 296.478566660314, 526.2636440420844, 22.894296344770563, 38.096109277152706, 340.45976578789873, 328.11071146060453, 194.17823134168816, 25.19406381616413, 108.56451878953243, 190.71825660603182, 19.465061373336912, 114.4721383022782, 199.56146036508096, 113.74777338793248, 0.0, 77.84952423606273, 222.18577702489355, 34.163669861424296, 101.32406042391425, 567.0428811600835, 317.6893233148042, 61.641562786094724, 156.95179487392247, 390.4082178618132, 194.10092442260404, 87.76370628825931, 206.82353736974403, 335.17802332718446, 98.58507335006051, 141.05748380016686, 80.3041133952052, 314.8684719398359, 128.8485337826083, 29.141574168749717, 208.09929909838064, 132.9930363418521, 40.182052676148054, 153.95186044367125, 40.610500673779384, 32.342744382460296, 144.30471548644675, 269.86926674401576, 87.18286839620038, 16.599426453317793, 216.91643128289135, 153.44805731377667, 143.94943643423994, 77.36391629336435, 303.73491709706207, 8.530386478395922, 261.1924288073794, 33.75795677218909, 160.53142811440887, 104.62727773001633, 7.349128813493334, 179.56130200632896, 447.11666838932825, 160.18301573893288, 131.06760694898907, 77.02868182769119, 58.336696710977385, 326.90696670314003, 46.559667262209636, 2.0219732398551504, 339.8587409724869, 164.7832095333656, 70.03546774865711, 138.4383125414054, 133.64732070653105, 16.455240349075847, 62.328865922802606, 199.09738211780783, 199.63240521296643, 29.73755492842648, 186.159577090339, 23.637333108969766, 129.140013789191, 122.18037246805413, 235.81668476130517, 22.657624089415982, 139.88141069382905, 112.96768235956071, 69.54106248882421, 17.905501631681307, 169.01332987203375, 153.88941630698565, 115.43706906324657, 83.38095681221216, 215.8057419446116, 154.7093790463708, 158.65148247035714, 44.63908551968206, 287.9551203591743, 361.4888801695015, 61.49080065713903, 518.3301515882682, 332.40037593490706, 76.18415793461621, 115.82320542075031, 4.470826573067303, 114.1763904505183, 135.24079943837836, 143.3848999642395, 115.86586987744722, 39.12123012437506, 340.7117264791493, 183.8272363934923, 97.1453146033832, 152.38569803184615, 119.25862678810195, 202.6880207899514, 260.8224052629753, 119.97938091712608, 311.4577770297825, 57.81033652050748, 101.49877839321472, 190.9527976102681, 27.785240897614344, 156.70804982658032, 57.58280006457918, 128.60251928657604, 354.4837190671484, 260.98940805914094, 267.4944309455743, 22.951439495738697, 63.11869742882649, 88.34364606910232, 28.400432373056418, 26.189726756562614, 254.78668102338608, 337.0483799514387, 73.53742499717112, 13.780624387179481, 141.6064531316299, 147.7197165716534, 164.46950814399287, 212.38980628832354, 333.41495434827436, 33.20644511938814, 151.19554575770022, 1.8584145160060492, 72.02579555770538, 40.05782133200807, 138.52748015351764, 15.77505047700694, 60.112318022742265, 53.63118849140326, 145.75388773587244, 195.94059649492175, 309.3583657441994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.398050114831952, "mean_inference_ms": 6.6782906914273354, "mean_action_processing_ms": 3.5159396772638956, "mean_env_wait_ms": 13.11388431881354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005231963263617622, "StateBufferConnector_ms": 0.009911722607082792, "ViewRequirementAgentConnector_ms": 0.2000594139099121}, "num_episodes": 0, "episode_return_max": 716.3738243326479, "episode_return_min": -68.26888083597322, "episode_return_mean": 338.20408564288056, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.67350887657558, "num_env_steps_trained_throughput_per_sec": 72.67350887657558, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 56185.613, "restore_workers_time_ms": 0.015, "training_step_time_ms": 56185.562, "sample_time_ms": 3011.173, "learn_time_ms": 53154.085, "learn_throughput": 75.253, "synch_weights_time_ms": 15.085}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "645a5_00000", "date": "2024-08-22_12-04-43", "timestamp": 1724308483, "time_this_iter_s": 55.08812594413757, "time_total_s": 679.6251909732819, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x15eedfa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 679.6251909732819, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 33.52179487179488, "ram_util_percent": 83.15641025641027}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.7095661965627515, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.9822800703149626, "policy_loss": -0.017252944276677985, "vf_loss": 2.9967928489680014, "vf_explained_var": 0.25278323276963816, "kl": 0.013700846897280483, "entropy": 1.395362096110349, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.17320246538788, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.466153344401607, "policy_loss": -0.022313655384633906, "vf_loss": 5.485616415266007, "vf_explained_var": 0.42222147618652023, "kl": 0.01425287680276645, "entropy": 1.4630296071370443, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 716.3738243326479, "episode_reward_min": -68.26888083597322, "episode_reward_mean": 338.20408564288056, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -554.3828616898514, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 567.0428811600835}, "policy_reward_mean": {"prey_policy": 20.2924861009921, "predator_policy": 148.80955672044814}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.00648670042213, 615.3999999999994, 431.76691416727795, 274.1999999999995, 359.47899152275147, 530.3393795284953, 716.3738243326479, 589.2535850132917, 450.18056392221, 364.9000000000008, 465.1999999999991, 366.8000000000013, 316.4000000000003, 571.3999999999999, 361.3000000000013, 252.0850729029153, 660.6999999999998, 420.8964210263408, 495.1236001461828, 413.70000000000005, 640.8, 502.86553956755284, 75.59999999999998, 160.79999999999947, 329.79999999999984, 154.25639426392422, 207.18836568820916, 539.2999999999995, 64.70000000000047, 288.1999999999996, 139.19999999999993, 133.69999999999933, 93.17300132213498, 58.351757596365275, 446.7750400285624, 449.9960420258991, 515.9343128709143, 357.13008530589775, 620.2, 64.5000000000006, 487.48755074184334, 199.2999999999997, 442.99999999999955, 238.14343590788926, 327.2999999999998, 374.36365647458524, 607.0726565307655, 81.30879837316557, 477.0967463098938, 491.76642204987104, 289.2000000000002, 319.99999999999955, 615.6, 308.01286347544954, 371.6000000000015, 662.9987274958014, 226.1999999999996, 526.3176097385935, 579.1153368474343, 525.0147587540813, 304.30000000000007, 307.61706433213266, 50.45546895475954, 223.85302134597646, 75.00000000000001, 68.1000000000004, 133.60000000000005, 390.7999999999993, 428.70000000000084, 573.2869211358554, 446.816988852629, 288.63498775230926, 130.099999999997, 130.90000000000015, 514.4999999999998, -68.26888083597322, 78.89656160166523, 301.59679824362445, 88.50000000000016, 55.02930578823269, 360.4955038806338, 502.9999999999994, 73.20000000000013, 284.65275116279787, 69.40000000000033, 134.09999999999624, 329.09999999999945, 422.3000000000032, 601.6000000000004, 371.2272750132408], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-201.24106863591646, 1.2688798657422529, 333.3713026668235, 119.59232046999128, -71.53736313463932, 244.0976731423206, -50.82917838279889, -77.52620649501377, 10.072793062991131, -94.94692328509029, 253.00551504533527, -242.71010583165855, 334.32732632527535, 234.5015890101486, 245.4624569630346, 129.89547206630263, -268.1861668071717, 78.7970709948452, 226.376776310334, -123.9662428840361, 182.5075552106424, -131.8290736155017, 44.50000000000036, 200.64109444050763, 250.23138004898527, -33.68514986518974, 178.802873087588, 238.88803877595944, 196.35377853028731, -37.758716592024065, -274.98830517049106, -295.6688326289921, 359.10570365522943, 240.60389072284735, -191.8899207350484, -55.78413548711356, 59.33128931505896, 216.42001567327145, 12.0861211823715, 102.33110342206326, 319.1349386266631, 187.7278616977215, 14.736604211874749, 174.81970160266457, 40.0000000000003, -42.249524236062584, -98.88577702489404, 3.336330138575923, 215.81592010585595, -554.3828616898514, -232.7368395700359, 7.662347733065268, -56.618600953239365, -283.5530460942813, -88.29598842856078, 345.73135771769677, -179.68703552003007, -297.61452517689327, -64.08507335006034, 112.64251619983264, -46.80411339520475, -209.16847193983676, -82.24853378260853, 57.958425831250345, -178.85464515565147, -69.06468896244822, -90.34859618392925, -45.43355933952728, 128.48949932622065, 245.33229564610227, 39.397026880319345, -3.574967084882374, 179.57855197425192, 232.5734660471443, 36.32883983153456, -49.56324312230429, 172.8505635657601, 226.03608370663565, -278.3349170970575, 30.569613521604236, -2.8235209473970313, 195.36068610967143, -126.0314281144098, 60.172722269982486, 107.79100413081618, 148.29856504936123, -313.85491647471287, -55.301331745659766, -37.19882153361032, 156.40253275692945, 196.6269597636079, -207.50696670314036, 184.93122794952248, 373.55978807917785, -60.37803320947567, -362.95511892321224, 123.99186445999182, 144.63110155983884, 10.963803270346926, 330.7000577239183, -26.028865922802233, 53.802617882191846, -147.13240521296743, 237.76244507157352, 82.84042290966096, 322.96266689103027, -68.4647992448787, 125.15727646308093, -208.91668476130565, 322.04237591058404, 299.6062265432927, 110.54340789911882, 151.20738533473573, -12.45394945524123, -7.911971020713139, 211.3268345802874, 197.14026413266288, 183.1570468393131, 14.913227103983559, 139.58641065911556, -126.65148247035896, 227.66091448031793, -70.29065494162194, -271.53628125492247, -82.37171472051415, -446.9937685701329, -181.5709413194396, -3.160571204106405, -77.18108488441965, 31.88705289060019, -79.87639045052025, -101.44079943838025, -45.88489996424087, -79.76586987744707, 327.8787698756249, -316.91172647914914, 400.0, -252.2725509968755, 279.11101480812266, 22.531581507784704, 132.79020537189552, -149.48364257219333, 140.7775291224683, -283.5796993170686, 37.68966347949264, -66.89877839321669, -148.9334175405423, 61.095379032658066, 57.59195017341912, 242.61719993542093, -381.73699083208936, -169.61812835760907, 1.0364556275710726, -450.6237330306215, 227.71154834334885, -12.184887024289011, -52.74364606910354, 24.499567626943705, -8.868681404062837, -217.07842058765473, -46.845948471160625, -3.2443525968149878, 213.4485548186942, 134.16436766249632, -213.81982209785144, -25.169402617795875, 28.886582189934714, -290.03859166373405, 5.29355488061206, -120.29554575770197, 82.9415854839931, -22.725795557705176, 234.14217866799208, -83.62748015351771, 263.2126315002507, 83.19999999999914, 292.86881150859676, 109.34611226412741, 142.86474912772266, -276.9364363536038], "policy_predator_policy_reward": [255.80850726286252, 62.17016820773524, 39.82869733317648, 122.60767953000816, 157.6615947885425, 101.54500937105361, 289.42917838279857, 113.12620649501174, 248.54462436557745, 195.80849737927352, 48.83496362169426, 471.2090066931244, 66.74515982668048, 80.7997491705436, 10.920795376005934, 202.97486060794787, 199.3589699738844, 440.21068976065277, 161.35931256926372, 101.13015400443652, 129.29244478935755, 285.22907361550466, 102.94275631905566, 18.716149240436607, 31.668619951014723, 68.18514986519025, 87.20165272360147, 66.50743541285124, 121.09802033134602, 81.60691773039063, 296.478566660314, 526.2636440420844, 22.894296344770563, 38.096109277152706, 340.45976578789873, 328.11071146060453, 194.17823134168816, 25.19406381616413, 108.56451878953243, 190.71825660603182, 19.465061373336912, 114.4721383022782, 199.56146036508096, 113.74777338793248, 0.0, 77.84952423606273, 222.18577702489355, 34.163669861424296, 101.32406042391425, 567.0428811600835, 317.6893233148042, 61.641562786094724, 156.95179487392247, 390.4082178618132, 194.10092442260404, 87.76370628825931, 206.82353736974403, 335.17802332718446, 98.58507335006051, 141.05748380016686, 80.3041133952052, 314.8684719398359, 128.8485337826083, 29.141574168749717, 208.09929909838064, 132.9930363418521, 40.182052676148054, 153.95186044367125, 40.610500673779384, 32.342744382460296, 144.30471548644675, 269.86926674401576, 87.18286839620038, 16.599426453317793, 216.91643128289135, 153.44805731377667, 143.94943643423994, 77.36391629336435, 303.73491709706207, 8.530386478395922, 261.1924288073794, 33.75795677218909, 160.53142811440887, 104.62727773001633, 7.349128813493334, 179.56130200632896, 447.11666838932825, 160.18301573893288, 131.06760694898907, 77.02868182769119, 58.336696710977385, 326.90696670314003, 46.559667262209636, 2.0219732398551504, 339.8587409724869, 164.7832095333656, 70.03546774865711, 138.4383125414054, 133.64732070653105, 16.455240349075847, 62.328865922802606, 199.09738211780783, 199.63240521296643, 29.73755492842648, 186.159577090339, 23.637333108969766, 129.140013789191, 122.18037246805413, 235.81668476130517, 22.657624089415982, 139.88141069382905, 112.96768235956071, 69.54106248882421, 17.905501631681307, 169.01332987203375, 153.88941630698565, 115.43706906324657, 83.38095681221216, 215.8057419446116, 154.7093790463708, 158.65148247035714, 44.63908551968206, 287.9551203591743, 361.4888801695015, 61.49080065713903, 518.3301515882682, 332.40037593490706, 76.18415793461621, 115.82320542075031, 4.470826573067303, 114.1763904505183, 135.24079943837836, 143.3848999642395, 115.86586987744722, 39.12123012437506, 340.7117264791493, 183.8272363934923, 97.1453146033832, 152.38569803184615, 119.25862678810195, 202.6880207899514, 260.8224052629753, 119.97938091712608, 311.4577770297825, 57.81033652050748, 101.49877839321472, 190.9527976102681, 27.785240897614344, 156.70804982658032, 57.58280006457918, 128.60251928657604, 354.4837190671484, 260.98940805914094, 267.4944309455743, 22.951439495738697, 63.11869742882649, 88.34364606910232, 28.400432373056418, 26.189726756562614, 254.78668102338608, 337.0483799514387, 73.53742499717112, 13.780624387179481, 141.6064531316299, 147.7197165716534, 164.46950814399287, 212.38980628832354, 333.41495434827436, 33.20644511938814, 151.19554575770022, 1.8584145160060492, 72.02579555770538, 40.05782133200807, 138.52748015351764, 15.77505047700694, 60.112318022742265, 53.63118849140326, 145.75388773587244, 195.94059649492175, 309.3583657441994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.398050114831952, "mean_inference_ms": 6.6782906914273354, "mean_action_processing_ms": 3.5159396772638956, "mean_env_wait_ms": 13.11388431881354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005231963263617622, "StateBufferConnector_ms": 0.009911722607082792, "ViewRequirementAgentConnector_ms": 0.2000594139099121}, "num_episodes": 0, "episode_return_max": 716.3738243326479, "episode_return_min": -68.26888083597322, "episode_return_mean": 338.20408564288056, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.57240179374416, "num_env_steps_trained_throughput_per_sec": 72.57240179374416, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 56082.092, "restore_workers_time_ms": 0.015, "training_step_time_ms": 56082.023, "sample_time_ms": 2953.304, "learn_time_ms": 53108.24, "learn_throughput": 75.318, "synch_weights_time_ms": 15.357}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "645a5_00000", "date": "2024-08-22_12-05-39", "timestamp": 1724308539, "time_this_iter_s": 55.17261981964111, "time_total_s": 734.797810792923, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a16a8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 734.797810792923, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 33.03589743589743, "ram_util_percent": 83.0025641025641}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.890110324961799, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.6990107873760203, "policy_loss": -0.015529484375596795, "vf_loss": 2.711939890674813, "vf_explained_var": 0.2864110567897716, "kl": 0.013001931704354113, "entropy": 1.3911296330431782, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.56616734777178, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.010460548426108, "policy_loss": -0.023559041462207914, "vf_loss": 5.03110369828643, "vf_explained_var": 0.46094215165370356, "kl": 0.014579477804471497, "entropy": 1.4585041997293946, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 716.3738243326479, "episode_reward_min": -68.26888083597322, "episode_reward_mean": 338.20408564288056, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -554.3828616898514, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 567.0428811600835}, "policy_reward_mean": {"prey_policy": 20.2924861009921, "predator_policy": 148.80955672044814}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.00648670042213, 615.3999999999994, 431.76691416727795, 274.1999999999995, 359.47899152275147, 530.3393795284953, 716.3738243326479, 589.2535850132917, 450.18056392221, 364.9000000000008, 465.1999999999991, 366.8000000000013, 316.4000000000003, 571.3999999999999, 361.3000000000013, 252.0850729029153, 660.6999999999998, 420.8964210263408, 495.1236001461828, 413.70000000000005, 640.8, 502.86553956755284, 75.59999999999998, 160.79999999999947, 329.79999999999984, 154.25639426392422, 207.18836568820916, 539.2999999999995, 64.70000000000047, 288.1999999999996, 139.19999999999993, 133.69999999999933, 93.17300132213498, 58.351757596365275, 446.7750400285624, 449.9960420258991, 515.9343128709143, 357.13008530589775, 620.2, 64.5000000000006, 487.48755074184334, 199.2999999999997, 442.99999999999955, 238.14343590788926, 327.2999999999998, 374.36365647458524, 607.0726565307655, 81.30879837316557, 477.0967463098938, 491.76642204987104, 289.2000000000002, 319.99999999999955, 615.6, 308.01286347544954, 371.6000000000015, 662.9987274958014, 226.1999999999996, 526.3176097385935, 579.1153368474343, 525.0147587540813, 304.30000000000007, 307.61706433213266, 50.45546895475954, 223.85302134597646, 75.00000000000001, 68.1000000000004, 133.60000000000005, 390.7999999999993, 428.70000000000084, 573.2869211358554, 446.816988852629, 288.63498775230926, 130.099999999997, 130.90000000000015, 514.4999999999998, -68.26888083597322, 78.89656160166523, 301.59679824362445, 88.50000000000016, 55.02930578823269, 360.4955038806338, 502.9999999999994, 73.20000000000013, 284.65275116279787, 69.40000000000033, 134.09999999999624, 329.09999999999945, 422.3000000000032, 601.6000000000004, 371.2272750132408], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-201.24106863591646, 1.2688798657422529, 333.3713026668235, 119.59232046999128, -71.53736313463932, 244.0976731423206, -50.82917838279889, -77.52620649501377, 10.072793062991131, -94.94692328509029, 253.00551504533527, -242.71010583165855, 334.32732632527535, 234.5015890101486, 245.4624569630346, 129.89547206630263, -268.1861668071717, 78.7970709948452, 226.376776310334, -123.9662428840361, 182.5075552106424, -131.8290736155017, 44.50000000000036, 200.64109444050763, 250.23138004898527, -33.68514986518974, 178.802873087588, 238.88803877595944, 196.35377853028731, -37.758716592024065, -274.98830517049106, -295.6688326289921, 359.10570365522943, 240.60389072284735, -191.8899207350484, -55.78413548711356, 59.33128931505896, 216.42001567327145, 12.0861211823715, 102.33110342206326, 319.1349386266631, 187.7278616977215, 14.736604211874749, 174.81970160266457, 40.0000000000003, -42.249524236062584, -98.88577702489404, 3.336330138575923, 215.81592010585595, -554.3828616898514, -232.7368395700359, 7.662347733065268, -56.618600953239365, -283.5530460942813, -88.29598842856078, 345.73135771769677, -179.68703552003007, -297.61452517689327, -64.08507335006034, 112.64251619983264, -46.80411339520475, -209.16847193983676, -82.24853378260853, 57.958425831250345, -178.85464515565147, -69.06468896244822, -90.34859618392925, -45.43355933952728, 128.48949932622065, 245.33229564610227, 39.397026880319345, -3.574967084882374, 179.57855197425192, 232.5734660471443, 36.32883983153456, -49.56324312230429, 172.8505635657601, 226.03608370663565, -278.3349170970575, 30.569613521604236, -2.8235209473970313, 195.36068610967143, -126.0314281144098, 60.172722269982486, 107.79100413081618, 148.29856504936123, -313.85491647471287, -55.301331745659766, -37.19882153361032, 156.40253275692945, 196.6269597636079, -207.50696670314036, 184.93122794952248, 373.55978807917785, -60.37803320947567, -362.95511892321224, 123.99186445999182, 144.63110155983884, 10.963803270346926, 330.7000577239183, -26.028865922802233, 53.802617882191846, -147.13240521296743, 237.76244507157352, 82.84042290966096, 322.96266689103027, -68.4647992448787, 125.15727646308093, -208.91668476130565, 322.04237591058404, 299.6062265432927, 110.54340789911882, 151.20738533473573, -12.45394945524123, -7.911971020713139, 211.3268345802874, 197.14026413266288, 183.1570468393131, 14.913227103983559, 139.58641065911556, -126.65148247035896, 227.66091448031793, -70.29065494162194, -271.53628125492247, -82.37171472051415, -446.9937685701329, -181.5709413194396, -3.160571204106405, -77.18108488441965, 31.88705289060019, -79.87639045052025, -101.44079943838025, -45.88489996424087, -79.76586987744707, 327.8787698756249, -316.91172647914914, 400.0, -252.2725509968755, 279.11101480812266, 22.531581507784704, 132.79020537189552, -149.48364257219333, 140.7775291224683, -283.5796993170686, 37.68966347949264, -66.89877839321669, -148.9334175405423, 61.095379032658066, 57.59195017341912, 242.61719993542093, -381.73699083208936, -169.61812835760907, 1.0364556275710726, -450.6237330306215, 227.71154834334885, -12.184887024289011, -52.74364606910354, 24.499567626943705, -8.868681404062837, -217.07842058765473, -46.845948471160625, -3.2443525968149878, 213.4485548186942, 134.16436766249632, -213.81982209785144, -25.169402617795875, 28.886582189934714, -290.03859166373405, 5.29355488061206, -120.29554575770197, 82.9415854839931, -22.725795557705176, 234.14217866799208, -83.62748015351771, 263.2126315002507, 83.19999999999914, 292.86881150859676, 109.34611226412741, 142.86474912772266, -276.9364363536038], "policy_predator_policy_reward": [255.80850726286252, 62.17016820773524, 39.82869733317648, 122.60767953000816, 157.6615947885425, 101.54500937105361, 289.42917838279857, 113.12620649501174, 248.54462436557745, 195.80849737927352, 48.83496362169426, 471.2090066931244, 66.74515982668048, 80.7997491705436, 10.920795376005934, 202.97486060794787, 199.3589699738844, 440.21068976065277, 161.35931256926372, 101.13015400443652, 129.29244478935755, 285.22907361550466, 102.94275631905566, 18.716149240436607, 31.668619951014723, 68.18514986519025, 87.20165272360147, 66.50743541285124, 121.09802033134602, 81.60691773039063, 296.478566660314, 526.2636440420844, 22.894296344770563, 38.096109277152706, 340.45976578789873, 328.11071146060453, 194.17823134168816, 25.19406381616413, 108.56451878953243, 190.71825660603182, 19.465061373336912, 114.4721383022782, 199.56146036508096, 113.74777338793248, 0.0, 77.84952423606273, 222.18577702489355, 34.163669861424296, 101.32406042391425, 567.0428811600835, 317.6893233148042, 61.641562786094724, 156.95179487392247, 390.4082178618132, 194.10092442260404, 87.76370628825931, 206.82353736974403, 335.17802332718446, 98.58507335006051, 141.05748380016686, 80.3041133952052, 314.8684719398359, 128.8485337826083, 29.141574168749717, 208.09929909838064, 132.9930363418521, 40.182052676148054, 153.95186044367125, 40.610500673779384, 32.342744382460296, 144.30471548644675, 269.86926674401576, 87.18286839620038, 16.599426453317793, 216.91643128289135, 153.44805731377667, 143.94943643423994, 77.36391629336435, 303.73491709706207, 8.530386478395922, 261.1924288073794, 33.75795677218909, 160.53142811440887, 104.62727773001633, 7.349128813493334, 179.56130200632896, 447.11666838932825, 160.18301573893288, 131.06760694898907, 77.02868182769119, 58.336696710977385, 326.90696670314003, 46.559667262209636, 2.0219732398551504, 339.8587409724869, 164.7832095333656, 70.03546774865711, 138.4383125414054, 133.64732070653105, 16.455240349075847, 62.328865922802606, 199.09738211780783, 199.63240521296643, 29.73755492842648, 186.159577090339, 23.637333108969766, 129.140013789191, 122.18037246805413, 235.81668476130517, 22.657624089415982, 139.88141069382905, 112.96768235956071, 69.54106248882421, 17.905501631681307, 169.01332987203375, 153.88941630698565, 115.43706906324657, 83.38095681221216, 215.8057419446116, 154.7093790463708, 158.65148247035714, 44.63908551968206, 287.9551203591743, 361.4888801695015, 61.49080065713903, 518.3301515882682, 332.40037593490706, 76.18415793461621, 115.82320542075031, 4.470826573067303, 114.1763904505183, 135.24079943837836, 143.3848999642395, 115.86586987744722, 39.12123012437506, 340.7117264791493, 183.8272363934923, 97.1453146033832, 152.38569803184615, 119.25862678810195, 202.6880207899514, 260.8224052629753, 119.97938091712608, 311.4577770297825, 57.81033652050748, 101.49877839321472, 190.9527976102681, 27.785240897614344, 156.70804982658032, 57.58280006457918, 128.60251928657604, 354.4837190671484, 260.98940805914094, 267.4944309455743, 22.951439495738697, 63.11869742882649, 88.34364606910232, 28.400432373056418, 26.189726756562614, 254.78668102338608, 337.0483799514387, 73.53742499717112, 13.780624387179481, 141.6064531316299, 147.7197165716534, 164.46950814399287, 212.38980628832354, 333.41495434827436, 33.20644511938814, 151.19554575770022, 1.8584145160060492, 72.02579555770538, 40.05782133200807, 138.52748015351764, 15.77505047700694, 60.112318022742265, 53.63118849140326, 145.75388773587244, 195.94059649492175, 309.3583657441994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.398050114831952, "mean_inference_ms": 6.6782906914273354, "mean_action_processing_ms": 3.5159396772638956, "mean_env_wait_ms": 13.11388431881354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005231963263617622, "StateBufferConnector_ms": 0.009911722607082792, "ViewRequirementAgentConnector_ms": 0.2000594139099121}, "num_episodes": 0, "episode_return_max": 716.3738243326479, "episode_return_min": -68.26888083597322, "episode_return_mean": 338.20408564288056, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.37167924946517, "num_env_steps_trained_throughput_per_sec": 72.37167924946517, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 55960.999, "restore_workers_time_ms": 0.015, "training_step_time_ms": 55960.932, "sample_time_ms": 2928.448, "learn_time_ms": 53012.74, "learn_throughput": 75.454, "synch_weights_time_ms": 14.689}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "645a5_00000", "date": "2024-08-22_12-06-34", "timestamp": 1724308594, "time_this_iter_s": 55.33641290664673, "time_total_s": 790.1342236995697, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a11c0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 790.1342236995697, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 33.498717948717946, "ram_util_percent": 83.12820512820512}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.9431948790474545, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.2632312054987307, "policy_loss": -0.018844720715947606, "vf_loss": 2.278987191909205, "vf_explained_var": 0.30347468149725093, "kl": 0.015443657689220297, "entropy": 1.3996100775148503, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.362919874986012, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.523103444538419, "policy_loss": -0.02204737912139131, "vf_loss": 4.5429093946224794, "vf_explained_var": 0.5090975182081656, "kl": 0.011207239781432446, "entropy": 1.4542964874121247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 716.3738243326479, "episode_reward_min": -68.26888083597322, "episode_reward_mean": 338.20408564288056, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -554.3828616898514, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 567.0428811600835}, "policy_reward_mean": {"prey_policy": 20.2924861009921, "predator_policy": 148.80955672044814}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.00648670042213, 615.3999999999994, 431.76691416727795, 274.1999999999995, 359.47899152275147, 530.3393795284953, 716.3738243326479, 589.2535850132917, 450.18056392221, 364.9000000000008, 465.1999999999991, 366.8000000000013, 316.4000000000003, 571.3999999999999, 361.3000000000013, 252.0850729029153, 660.6999999999998, 420.8964210263408, 495.1236001461828, 413.70000000000005, 640.8, 502.86553956755284, 75.59999999999998, 160.79999999999947, 329.79999999999984, 154.25639426392422, 207.18836568820916, 539.2999999999995, 64.70000000000047, 288.1999999999996, 139.19999999999993, 133.69999999999933, 93.17300132213498, 58.351757596365275, 446.7750400285624, 449.9960420258991, 515.9343128709143, 357.13008530589775, 620.2, 64.5000000000006, 487.48755074184334, 199.2999999999997, 442.99999999999955, 238.14343590788926, 327.2999999999998, 374.36365647458524, 607.0726565307655, 81.30879837316557, 477.0967463098938, 491.76642204987104, 289.2000000000002, 319.99999999999955, 615.6, 308.01286347544954, 371.6000000000015, 662.9987274958014, 226.1999999999996, 526.3176097385935, 579.1153368474343, 525.0147587540813, 304.30000000000007, 307.61706433213266, 50.45546895475954, 223.85302134597646, 75.00000000000001, 68.1000000000004, 133.60000000000005, 390.7999999999993, 428.70000000000084, 573.2869211358554, 446.816988852629, 288.63498775230926, 130.099999999997, 130.90000000000015, 514.4999999999998, -68.26888083597322, 78.89656160166523, 301.59679824362445, 88.50000000000016, 55.02930578823269, 360.4955038806338, 502.9999999999994, 73.20000000000013, 284.65275116279787, 69.40000000000033, 134.09999999999624, 329.09999999999945, 422.3000000000032, 601.6000000000004, 371.2272750132408], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-201.24106863591646, 1.2688798657422529, 333.3713026668235, 119.59232046999128, -71.53736313463932, 244.0976731423206, -50.82917838279889, -77.52620649501377, 10.072793062991131, -94.94692328509029, 253.00551504533527, -242.71010583165855, 334.32732632527535, 234.5015890101486, 245.4624569630346, 129.89547206630263, -268.1861668071717, 78.7970709948452, 226.376776310334, -123.9662428840361, 182.5075552106424, -131.8290736155017, 44.50000000000036, 200.64109444050763, 250.23138004898527, -33.68514986518974, 178.802873087588, 238.88803877595944, 196.35377853028731, -37.758716592024065, -274.98830517049106, -295.6688326289921, 359.10570365522943, 240.60389072284735, -191.8899207350484, -55.78413548711356, 59.33128931505896, 216.42001567327145, 12.0861211823715, 102.33110342206326, 319.1349386266631, 187.7278616977215, 14.736604211874749, 174.81970160266457, 40.0000000000003, -42.249524236062584, -98.88577702489404, 3.336330138575923, 215.81592010585595, -554.3828616898514, -232.7368395700359, 7.662347733065268, -56.618600953239365, -283.5530460942813, -88.29598842856078, 345.73135771769677, -179.68703552003007, -297.61452517689327, -64.08507335006034, 112.64251619983264, -46.80411339520475, -209.16847193983676, -82.24853378260853, 57.958425831250345, -178.85464515565147, -69.06468896244822, -90.34859618392925, -45.43355933952728, 128.48949932622065, 245.33229564610227, 39.397026880319345, -3.574967084882374, 179.57855197425192, 232.5734660471443, 36.32883983153456, -49.56324312230429, 172.8505635657601, 226.03608370663565, -278.3349170970575, 30.569613521604236, -2.8235209473970313, 195.36068610967143, -126.0314281144098, 60.172722269982486, 107.79100413081618, 148.29856504936123, -313.85491647471287, -55.301331745659766, -37.19882153361032, 156.40253275692945, 196.6269597636079, -207.50696670314036, 184.93122794952248, 373.55978807917785, -60.37803320947567, -362.95511892321224, 123.99186445999182, 144.63110155983884, 10.963803270346926, 330.7000577239183, -26.028865922802233, 53.802617882191846, -147.13240521296743, 237.76244507157352, 82.84042290966096, 322.96266689103027, -68.4647992448787, 125.15727646308093, -208.91668476130565, 322.04237591058404, 299.6062265432927, 110.54340789911882, 151.20738533473573, -12.45394945524123, -7.911971020713139, 211.3268345802874, 197.14026413266288, 183.1570468393131, 14.913227103983559, 139.58641065911556, -126.65148247035896, 227.66091448031793, -70.29065494162194, -271.53628125492247, -82.37171472051415, -446.9937685701329, -181.5709413194396, -3.160571204106405, -77.18108488441965, 31.88705289060019, -79.87639045052025, -101.44079943838025, -45.88489996424087, -79.76586987744707, 327.8787698756249, -316.91172647914914, 400.0, -252.2725509968755, 279.11101480812266, 22.531581507784704, 132.79020537189552, -149.48364257219333, 140.7775291224683, -283.5796993170686, 37.68966347949264, -66.89877839321669, -148.9334175405423, 61.095379032658066, 57.59195017341912, 242.61719993542093, -381.73699083208936, -169.61812835760907, 1.0364556275710726, -450.6237330306215, 227.71154834334885, -12.184887024289011, -52.74364606910354, 24.499567626943705, -8.868681404062837, -217.07842058765473, -46.845948471160625, -3.2443525968149878, 213.4485548186942, 134.16436766249632, -213.81982209785144, -25.169402617795875, 28.886582189934714, -290.03859166373405, 5.29355488061206, -120.29554575770197, 82.9415854839931, -22.725795557705176, 234.14217866799208, -83.62748015351771, 263.2126315002507, 83.19999999999914, 292.86881150859676, 109.34611226412741, 142.86474912772266, -276.9364363536038], "policy_predator_policy_reward": [255.80850726286252, 62.17016820773524, 39.82869733317648, 122.60767953000816, 157.6615947885425, 101.54500937105361, 289.42917838279857, 113.12620649501174, 248.54462436557745, 195.80849737927352, 48.83496362169426, 471.2090066931244, 66.74515982668048, 80.7997491705436, 10.920795376005934, 202.97486060794787, 199.3589699738844, 440.21068976065277, 161.35931256926372, 101.13015400443652, 129.29244478935755, 285.22907361550466, 102.94275631905566, 18.716149240436607, 31.668619951014723, 68.18514986519025, 87.20165272360147, 66.50743541285124, 121.09802033134602, 81.60691773039063, 296.478566660314, 526.2636440420844, 22.894296344770563, 38.096109277152706, 340.45976578789873, 328.11071146060453, 194.17823134168816, 25.19406381616413, 108.56451878953243, 190.71825660603182, 19.465061373336912, 114.4721383022782, 199.56146036508096, 113.74777338793248, 0.0, 77.84952423606273, 222.18577702489355, 34.163669861424296, 101.32406042391425, 567.0428811600835, 317.6893233148042, 61.641562786094724, 156.95179487392247, 390.4082178618132, 194.10092442260404, 87.76370628825931, 206.82353736974403, 335.17802332718446, 98.58507335006051, 141.05748380016686, 80.3041133952052, 314.8684719398359, 128.8485337826083, 29.141574168749717, 208.09929909838064, 132.9930363418521, 40.182052676148054, 153.95186044367125, 40.610500673779384, 32.342744382460296, 144.30471548644675, 269.86926674401576, 87.18286839620038, 16.599426453317793, 216.91643128289135, 153.44805731377667, 143.94943643423994, 77.36391629336435, 303.73491709706207, 8.530386478395922, 261.1924288073794, 33.75795677218909, 160.53142811440887, 104.62727773001633, 7.349128813493334, 179.56130200632896, 447.11666838932825, 160.18301573893288, 131.06760694898907, 77.02868182769119, 58.336696710977385, 326.90696670314003, 46.559667262209636, 2.0219732398551504, 339.8587409724869, 164.7832095333656, 70.03546774865711, 138.4383125414054, 133.64732070653105, 16.455240349075847, 62.328865922802606, 199.09738211780783, 199.63240521296643, 29.73755492842648, 186.159577090339, 23.637333108969766, 129.140013789191, 122.18037246805413, 235.81668476130517, 22.657624089415982, 139.88141069382905, 112.96768235956071, 69.54106248882421, 17.905501631681307, 169.01332987203375, 153.88941630698565, 115.43706906324657, 83.38095681221216, 215.8057419446116, 154.7093790463708, 158.65148247035714, 44.63908551968206, 287.9551203591743, 361.4888801695015, 61.49080065713903, 518.3301515882682, 332.40037593490706, 76.18415793461621, 115.82320542075031, 4.470826573067303, 114.1763904505183, 135.24079943837836, 143.3848999642395, 115.86586987744722, 39.12123012437506, 340.7117264791493, 183.8272363934923, 97.1453146033832, 152.38569803184615, 119.25862678810195, 202.6880207899514, 260.8224052629753, 119.97938091712608, 311.4577770297825, 57.81033652050748, 101.49877839321472, 190.9527976102681, 27.785240897614344, 156.70804982658032, 57.58280006457918, 128.60251928657604, 354.4837190671484, 260.98940805914094, 267.4944309455743, 22.951439495738697, 63.11869742882649, 88.34364606910232, 28.400432373056418, 26.189726756562614, 254.78668102338608, 337.0483799514387, 73.53742499717112, 13.780624387179481, 141.6064531316299, 147.7197165716534, 164.46950814399287, 212.38980628832354, 333.41495434827436, 33.20644511938814, 151.19554575770022, 1.8584145160060492, 72.02579555770538, 40.05782133200807, 138.52748015351764, 15.77505047700694, 60.112318022742265, 53.63118849140326, 145.75388773587244, 195.94059649492175, 309.3583657441994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.398050114831952, "mean_inference_ms": 6.6782906914273354, "mean_action_processing_ms": 3.5159396772638956, "mean_env_wait_ms": 13.11388431881354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005231963263617622, "StateBufferConnector_ms": 0.009911722607082792, "ViewRequirementAgentConnector_ms": 0.2000594139099121}, "num_episodes": 0, "episode_return_max": 716.3738243326479, "episode_return_min": -68.26888083597322, "episode_return_mean": 338.20408564288056, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.17408704267817, "num_env_steps_trained_throughput_per_sec": 72.17408704267817, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 55599.649, "restore_workers_time_ms": 0.015, "training_step_time_ms": 55599.583, "sample_time_ms": 2618.403, "learn_time_ms": 52961.308, "learn_throughput": 75.527, "synch_weights_time_ms": 14.619}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "645a5_00000", "date": "2024-08-22_12-07-29", "timestamp": 1724308649, "time_this_iter_s": 55.470179080963135, "time_total_s": 845.6044027805328, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a16a700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 845.6044027805328, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 33.10512820512822, "ram_util_percent": 82.63717948717947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.878100995885001, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.2270502210924863, "policy_loss": -0.01710890673948501, "vf_loss": 2.241585395008168, "vf_explained_var": 0.3321184418819569, "kl": 0.01286867430246381, "entropy": 1.3743368063023482, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.03776968578813, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.035024609136833, "policy_loss": -0.021334079943262238, "vf_loss": 4.054044611996444, "vf_explained_var": 0.5536735171048098, "kl": 0.011570341378775618, "entropy": 1.438971495628357, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 716.3738243326479, "episode_reward_min": -68.26888083597322, "episode_reward_mean": 337.4071981186587, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 38000, "policy_reward_min": {"prey_policy": -554.3828616898514, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 776.5436638705049}, "policy_reward_mean": {"prey_policy": 9.074947106132509, "predator_policy": 159.6286519531968}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.00648670042213, 615.3999999999994, 431.76691416727795, 274.1999999999995, 359.47899152275147, 530.3393795284953, 716.3738243326479, 589.2535850132917, 450.18056392221, 364.9000000000008, 465.1999999999991, 366.8000000000013, 316.4000000000003, 571.3999999999999, 361.3000000000013, 252.0850729029153, 660.6999999999998, 420.8964210263408, 495.1236001461828, 413.70000000000005, 640.8, 502.86553956755284, 75.59999999999998, 160.79999999999947, 329.79999999999984, 154.25639426392422, 207.18836568820916, 539.2999999999995, 64.70000000000047, 288.1999999999996, 139.19999999999993, 133.69999999999933, 93.17300132213498, 58.351757596365275, 446.7750400285624, 449.9960420258991, 515.9343128709143, 357.13008530589775, 620.2, 64.5000000000006, 487.48755074184334, 199.2999999999997, 442.99999999999955, 238.14343590788926, 327.2999999999998, 374.36365647458524, 607.0726565307655, 81.30879837316557, 477.0967463098938, 491.76642204987104, 289.2000000000002, 319.99999999999955, 615.6, 308.01286347544954, 371.6000000000015, 662.9987274958014, 226.1999999999996, 526.3176097385935, 579.1153368474343, 525.0147587540813, 304.30000000000007, 307.61706433213266, 50.45546895475954, 223.85302134597646, 75.00000000000001, 68.1000000000004, 133.60000000000005, 390.7999999999993, 428.70000000000084, 573.2869211358554, 446.816988852629, 288.63498775230926, 130.099999999997, 130.90000000000015, 514.4999999999998, -68.26888083597322, 78.89656160166523, 301.59679824362445, 88.50000000000016, 55.02930578823269, 360.4955038806338, 502.9999999999994, 73.20000000000013, 284.65275116279787, 69.40000000000033, 134.09999999999624, 329.09999999999945, 422.3000000000032, 601.6000000000004, 371.2272750132408, 306.7207133417039, 234.44717094699263, 415.89999999999964, 400.6893998957706, 257.5588292288571], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-201.24106863591646, 1.2688798657422529, 333.3713026668235, 119.59232046999128, -71.53736313463932, 244.0976731423206, -50.82917838279889, -77.52620649501377, 10.072793062991131, -94.94692328509029, 253.00551504533527, -242.71010583165855, 334.32732632527535, 234.5015890101486, 245.4624569630346, 129.89547206630263, -268.1861668071717, 78.7970709948452, 226.376776310334, -123.9662428840361, 182.5075552106424, -131.8290736155017, 44.50000000000036, 200.64109444050763, 250.23138004898527, -33.68514986518974, 178.802873087588, 238.88803877595944, 196.35377853028731, -37.758716592024065, -274.98830517049106, -295.6688326289921, 359.10570365522943, 240.60389072284735, -191.8899207350484, -55.78413548711356, 59.33128931505896, 216.42001567327145, 12.0861211823715, 102.33110342206326, 319.1349386266631, 187.7278616977215, 14.736604211874749, 174.81970160266457, 40.0000000000003, -42.249524236062584, -98.88577702489404, 3.336330138575923, 215.81592010585595, -554.3828616898514, -232.7368395700359, 7.662347733065268, -56.618600953239365, -283.5530460942813, -88.29598842856078, 345.73135771769677, -179.68703552003007, -297.61452517689327, -64.08507335006034, 112.64251619983264, -46.80411339520475, -209.16847193983676, -82.24853378260853, 57.958425831250345, -178.85464515565147, -69.06468896244822, -90.34859618392925, -45.43355933952728, 128.48949932622065, 245.33229564610227, 39.397026880319345, -3.574967084882374, 179.57855197425192, 232.5734660471443, 36.32883983153456, -49.56324312230429, 172.8505635657601, 226.03608370663565, -278.3349170970575, 30.569613521604236, -2.8235209473970313, 195.36068610967143, -126.0314281144098, 60.172722269982486, 107.79100413081618, 148.29856504936123, -313.85491647471287, -55.301331745659766, -37.19882153361032, 156.40253275692945, 196.6269597636079, -207.50696670314036, 184.93122794952248, 373.55978807917785, -60.37803320947567, -362.95511892321224, 123.99186445999182, 144.63110155983884, 10.963803270346926, 330.7000577239183, -26.028865922802233, 53.802617882191846, -147.13240521296743, 237.76244507157352, 82.84042290966096, 322.96266689103027, -68.4647992448787, 125.15727646308093, -208.91668476130565, 322.04237591058404, 299.6062265432927, 110.54340789911882, 151.20738533473573, -12.45394945524123, -7.911971020713139, 211.3268345802874, 197.14026413266288, 183.1570468393131, 14.913227103983559, 139.58641065911556, -126.65148247035896, 227.66091448031793, -70.29065494162194, -271.53628125492247, -82.37171472051415, -446.9937685701329, -181.5709413194396, -3.160571204106405, -77.18108488441965, 31.88705289060019, -79.87639045052025, -101.44079943838025, -45.88489996424087, -79.76586987744707, 327.8787698756249, -316.91172647914914, 400.0, -252.2725509968755, 279.11101480812266, 22.531581507784704, 132.79020537189552, -149.48364257219333, 140.7775291224683, -283.5796993170686, 37.68966347949264, -66.89877839321669, -148.9334175405423, 61.095379032658066, 57.59195017341912, 242.61719993542093, -381.73699083208936, -169.61812835760907, 1.0364556275710726, -450.6237330306215, 227.71154834334885, -12.184887024289011, -52.74364606910354, 24.499567626943705, -8.868681404062837, -217.07842058765473, -46.845948471160625, -3.2443525968149878, 213.4485548186942, 134.16436766249632, -213.81982209785144, -25.169402617795875, 28.886582189934714, -290.03859166373405, 5.29355488061206, -120.29554575770197, 82.9415854839931, -22.725795557705176, 234.14217866799208, -83.62748015351771, 263.2126315002507, 83.19999999999914, 292.86881150859676, 109.34611226412741, 142.86474912772266, -276.9364363536038, -213.70442495579744, 108.9835556077536, -552.1691511159975, -21.766519052485066, 87.93154319541298, 89.16012736082997, -474.48805479857185, -65.37077362133658, -543.2212350506562, -343.7626155825529], "policy_predator_policy_reward": [255.80850726286252, 62.17016820773524, 39.82869733317648, 122.60767953000816, 157.6615947885425, 101.54500937105361, 289.42917838279857, 113.12620649501174, 248.54462436557745, 195.80849737927352, 48.83496362169426, 471.2090066931244, 66.74515982668048, 80.7997491705436, 10.920795376005934, 202.97486060794787, 199.3589699738844, 440.21068976065277, 161.35931256926372, 101.13015400443652, 129.29244478935755, 285.22907361550466, 102.94275631905566, 18.716149240436607, 31.668619951014723, 68.18514986519025, 87.20165272360147, 66.50743541285124, 121.09802033134602, 81.60691773039063, 296.478566660314, 526.2636440420844, 22.894296344770563, 38.096109277152706, 340.45976578789873, 328.11071146060453, 194.17823134168816, 25.19406381616413, 108.56451878953243, 190.71825660603182, 19.465061373336912, 114.4721383022782, 199.56146036508096, 113.74777338793248, 0.0, 77.84952423606273, 222.18577702489355, 34.163669861424296, 101.32406042391425, 567.0428811600835, 317.6893233148042, 61.641562786094724, 156.95179487392247, 390.4082178618132, 194.10092442260404, 87.76370628825931, 206.82353736974403, 335.17802332718446, 98.58507335006051, 141.05748380016686, 80.3041133952052, 314.8684719398359, 128.8485337826083, 29.141574168749717, 208.09929909838064, 132.9930363418521, 40.182052676148054, 153.95186044367125, 40.610500673779384, 32.342744382460296, 144.30471548644675, 269.86926674401576, 87.18286839620038, 16.599426453317793, 216.91643128289135, 153.44805731377667, 143.94943643423994, 77.36391629336435, 303.73491709706207, 8.530386478395922, 261.1924288073794, 33.75795677218909, 160.53142811440887, 104.62727773001633, 7.349128813493334, 179.56130200632896, 447.11666838932825, 160.18301573893288, 131.06760694898907, 77.02868182769119, 58.336696710977385, 326.90696670314003, 46.559667262209636, 2.0219732398551504, 339.8587409724869, 164.7832095333656, 70.03546774865711, 138.4383125414054, 133.64732070653105, 16.455240349075847, 62.328865922802606, 199.09738211780783, 199.63240521296643, 29.73755492842648, 186.159577090339, 23.637333108969766, 129.140013789191, 122.18037246805413, 235.81668476130517, 22.657624089415982, 139.88141069382905, 112.96768235956071, 69.54106248882421, 17.905501631681307, 169.01332987203375, 153.88941630698565, 115.43706906324657, 83.38095681221216, 215.8057419446116, 154.7093790463708, 158.65148247035714, 44.63908551968206, 287.9551203591743, 361.4888801695015, 61.49080065713903, 518.3301515882682, 332.40037593490706, 76.18415793461621, 115.82320542075031, 4.470826573067303, 114.1763904505183, 135.24079943837836, 143.3848999642395, 115.86586987744722, 39.12123012437506, 340.7117264791493, 183.8272363934923, 97.1453146033832, 152.38569803184615, 119.25862678810195, 202.6880207899514, 260.8224052629753, 119.97938091712608, 311.4577770297825, 57.81033652050748, 101.49877839321472, 190.9527976102681, 27.785240897614344, 156.70804982658032, 57.58280006457918, 128.60251928657604, 354.4837190671484, 260.98940805914094, 267.4944309455743, 22.951439495738697, 63.11869742882649, 88.34364606910232, 28.400432373056418, 26.189726756562614, 254.78668102338608, 337.0483799514387, 73.53742499717112, 13.780624387179481, 141.6064531316299, 147.7197165716534, 164.46950814399287, 212.38980628832354, 333.41495434827436, 33.20644511938814, 151.19554575770022, 1.8584145160060492, 72.02579555770538, 40.05782133200807, 138.52748015351764, 15.77505047700694, 60.112318022742265, 53.63118849140326, 145.75388773587244, 195.94059649492175, 309.3583657441994, 380.0128109887046, 31.428771701043285, 158.30750750736618, 650.0753336081115, 229.36845680458703, 9.439872639170066, 776.5436638705049, 164.0045644451754, 693.9040733680717, 450.63860649399504]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.371437758949369, "mean_inference_ms": 6.631523094553549, "mean_action_processing_ms": 3.4655845388281703, "mean_env_wait_ms": 13.080295327723304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005124368165668689, "StateBufferConnector_ms": 0.009575266587106805, "ViewRequirementAgentConnector_ms": 0.1978569281728644}, "num_episodes": 5, "episode_return_max": 716.3738243326479, "episode_return_min": -68.26888083597322, "episode_return_mean": 337.4071981186587, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.93900443368308, "num_env_steps_trained_throughput_per_sec": 71.93900443368308, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 55574.753, "restore_workers_time_ms": 0.015, "training_step_time_ms": 55574.687, "sample_time_ms": 2592.87, "learn_time_ms": 52962.147, "learn_throughput": 75.526, "synch_weights_time_ms": 14.26}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "645a5_00000", "date": "2024-08-22_12-08-25", "timestamp": 1724308705, "time_this_iter_s": 55.66171407699585, "time_total_s": 901.2661168575287, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a136f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 901.2661168575287, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 34.410126582278494, "ram_util_percent": 82.92151898734177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.897636469962105, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.9231124980739818, "policy_loss": -0.012090538209550595, "vf_loss": 2.9329154584142896, "vf_explained_var": 0.3110348691385259, "kl": 0.011437903003146252, "entropy": 1.3203167953188457, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.676335534847603, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.282453008051272, "policy_loss": -0.022877017413044258, "vf_loss": 4.302348061718007, "vf_explained_var": 0.5049819762113864, "kl": 0.014909838056980223, "entropy": 1.406515610028827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 750.1, "episode_reward_min": -68.26888083597322, "episode_reward_mean": 330.7178022230885, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1233.7585594142863, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1201.3139861824884}, "policy_reward_mean": {"prey_policy": -24.471785235756112, "predator_policy": 189.83068634730037}, "custom_metrics": {}, "hist_stats": {"episode_reward": [413.70000000000005, 640.8, 502.86553956755284, 75.59999999999998, 160.79999999999947, 329.79999999999984, 154.25639426392422, 207.18836568820916, 539.2999999999995, 64.70000000000047, 288.1999999999996, 139.19999999999993, 133.69999999999933, 93.17300132213498, 58.351757596365275, 446.7750400285624, 449.9960420258991, 515.9343128709143, 357.13008530589775, 620.2, 64.5000000000006, 487.48755074184334, 199.2999999999997, 442.99999999999955, 238.14343590788926, 327.2999999999998, 374.36365647458524, 607.0726565307655, 81.30879837316557, 477.0967463098938, 491.76642204987104, 289.2000000000002, 319.99999999999955, 615.6, 308.01286347544954, 371.6000000000015, 662.9987274958014, 226.1999999999996, 526.3176097385935, 579.1153368474343, 525.0147587540813, 304.30000000000007, 307.61706433213266, 50.45546895475954, 223.85302134597646, 75.00000000000001, 68.1000000000004, 133.60000000000005, 390.7999999999993, 428.70000000000084, 573.2869211358554, 446.816988852629, 288.63498775230926, 130.099999999997, 130.90000000000015, 514.4999999999998, -68.26888083597322, 78.89656160166523, 301.59679824362445, 88.50000000000016, 55.02930578823269, 360.4955038806338, 502.9999999999994, 73.20000000000013, 284.65275116279787, 69.40000000000033, 134.09999999999624, 329.09999999999945, 422.3000000000032, 601.6000000000004, 371.2272750132408, 306.7207133417039, 234.44717094699263, 415.89999999999964, 400.6893998957706, 257.5588292288571, 591.204214907954, 202.0774645607411, 219.00511756790362, 388.34357888081183, 717.3, 215.6999999999975, 157.78691727324775, 157.69999999999914, 121.99999999999912, 516.3337664830932, 0.26232787653891076, 305.1335036985652, 750.1, 438.6359677253802, 365.3494363928666, 348.0000000000009, 725.8219916805243, 333.96899728294426, 579.4613868552924, 405.22064683707225, 629.6999999999999, 582.129826212637, 519.3675364359974, 107.29855962724514], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [12.0861211823715, 102.33110342206326, 319.1349386266631, 187.7278616977215, 14.736604211874749, 174.81970160266457, 40.0000000000003, -42.249524236062584, -98.88577702489404, 3.336330138575923, 215.81592010585595, -554.3828616898514, -232.7368395700359, 7.662347733065268, -56.618600953239365, -283.5530460942813, -88.29598842856078, 345.73135771769677, -179.68703552003007, -297.61452517689327, -64.08507335006034, 112.64251619983264, -46.80411339520475, -209.16847193983676, -82.24853378260853, 57.958425831250345, -178.85464515565147, -69.06468896244822, -90.34859618392925, -45.43355933952728, 128.48949932622065, 245.33229564610227, 39.397026880319345, -3.574967084882374, 179.57855197425192, 232.5734660471443, 36.32883983153456, -49.56324312230429, 172.8505635657601, 226.03608370663565, -278.3349170970575, 30.569613521604236, -2.8235209473970313, 195.36068610967143, -126.0314281144098, 60.172722269982486, 107.79100413081618, 148.29856504936123, -313.85491647471287, -55.301331745659766, -37.19882153361032, 156.40253275692945, 196.6269597636079, -207.50696670314036, 184.93122794952248, 373.55978807917785, -60.37803320947567, -362.95511892321224, 123.99186445999182, 144.63110155983884, 10.963803270346926, 330.7000577239183, -26.028865922802233, 53.802617882191846, -147.13240521296743, 237.76244507157352, 82.84042290966096, 322.96266689103027, -68.4647992448787, 125.15727646308093, -208.91668476130565, 322.04237591058404, 299.6062265432927, 110.54340789911882, 151.20738533473573, -12.45394945524123, -7.911971020713139, 211.3268345802874, 197.14026413266288, 183.1570468393131, 14.913227103983559, 139.58641065911556, -126.65148247035896, 227.66091448031793, -70.29065494162194, -271.53628125492247, -82.37171472051415, -446.9937685701329, -181.5709413194396, -3.160571204106405, -77.18108488441965, 31.88705289060019, -79.87639045052025, -101.44079943838025, -45.88489996424087, -79.76586987744707, 327.8787698756249, -316.91172647914914, 400.0, -252.2725509968755, 279.11101480812266, 22.531581507784704, 132.79020537189552, -149.48364257219333, 140.7775291224683, -283.5796993170686, 37.68966347949264, -66.89877839321669, -148.9334175405423, 61.095379032658066, 57.59195017341912, 242.61719993542093, -381.73699083208936, -169.61812835760907, 1.0364556275710726, -450.6237330306215, 227.71154834334885, -12.184887024289011, -52.74364606910354, 24.499567626943705, -8.868681404062837, -217.07842058765473, -46.845948471160625, -3.2443525968149878, 213.4485548186942, 134.16436766249632, -213.81982209785144, -25.169402617795875, 28.886582189934714, -290.03859166373405, 5.29355488061206, -120.29554575770197, 82.9415854839931, -22.725795557705176, 234.14217866799208, -83.62748015351771, 263.2126315002507, 83.19999999999914, 292.86881150859676, 109.34611226412741, 142.86474912772266, -276.9364363536038, -213.70442495579744, 108.9835556077536, -552.1691511159975, -21.766519052485066, 87.93154319541298, 89.16012736082997, -474.48805479857185, -65.37077362133658, -543.2212350506562, -343.7626155825529, 63.87443747252127, 193.48914455543883, -349.04244795294716, -41.831736375533524, -299.4381247385706, -437.06886347949387, 174.43304316268487, -135.28113235426125, 360.39240776911186, 112.68400200552537, -12.817995096968538, -142.57132031342618, -1043.072018452996, -240.90906707464066, -671.2510469910574, 36.388248553848086, 33.27688161036323, -145.01443014110993, -5.4732796081758295, -6.644431257711176, -253.02855361802392, -1233.7585594142863, -622.3396933982416, -303.45077919327434, 320.71169827437893, 355.7924480204981, -124.308049627187, -376.30883845996794, -69.33792254051586, 158.89897378470874, 298.1599668611793, -112.22965244868072, 370.2517098544716, 243.86314306090296, -121.58621518023128, -296.9808563963844, 110.64415220601646, 227.23407953045833, 126.26885525345995, -92.13684261006637, 338.7566166341574, 191.36611581430418, 129.27460382612776, -52.142766493820716, -117.97945176190933, 70.00146790355137, -842.9316146798011, -159.8158979779885], "policy_predator_policy_reward": [108.56451878953243, 190.71825660603182, 19.465061373336912, 114.4721383022782, 199.56146036508096, 113.74777338793248, 0.0, 77.84952423606273, 222.18577702489355, 34.163669861424296, 101.32406042391425, 567.0428811600835, 317.6893233148042, 61.641562786094724, 156.95179487392247, 390.4082178618132, 194.10092442260404, 87.76370628825931, 206.82353736974403, 335.17802332718446, 98.58507335006051, 141.05748380016686, 80.3041133952052, 314.8684719398359, 128.8485337826083, 29.141574168749717, 208.09929909838064, 132.9930363418521, 40.182052676148054, 153.95186044367125, 40.610500673779384, 32.342744382460296, 144.30471548644675, 269.86926674401576, 87.18286839620038, 16.599426453317793, 216.91643128289135, 153.44805731377667, 143.94943643423994, 77.36391629336435, 303.73491709706207, 8.530386478395922, 261.1924288073794, 33.75795677218909, 160.53142811440887, 104.62727773001633, 7.349128813493334, 179.56130200632896, 447.11666838932825, 160.18301573893288, 131.06760694898907, 77.02868182769119, 58.336696710977385, 326.90696670314003, 46.559667262209636, 2.0219732398551504, 339.8587409724869, 164.7832095333656, 70.03546774865711, 138.4383125414054, 133.64732070653105, 16.455240349075847, 62.328865922802606, 199.09738211780783, 199.63240521296643, 29.73755492842648, 186.159577090339, 23.637333108969766, 129.140013789191, 122.18037246805413, 235.81668476130517, 22.657624089415982, 139.88141069382905, 112.96768235956071, 69.54106248882421, 17.905501631681307, 169.01332987203375, 153.88941630698565, 115.43706906324657, 83.38095681221216, 215.8057419446116, 154.7093790463708, 158.65148247035714, 44.63908551968206, 287.9551203591743, 361.4888801695015, 61.49080065713903, 518.3301515882682, 332.40037593490706, 76.18415793461621, 115.82320542075031, 4.470826573067303, 114.1763904505183, 135.24079943837836, 143.3848999642395, 115.86586987744722, 39.12123012437506, 340.7117264791493, 183.8272363934923, 97.1453146033832, 152.38569803184615, 119.25862678810195, 202.6880207899514, 260.8224052629753, 119.97938091712608, 311.4577770297825, 57.81033652050748, 101.49877839321472, 190.9527976102681, 27.785240897614344, 156.70804982658032, 57.58280006457918, 128.60251928657604, 354.4837190671484, 260.98940805914094, 267.4944309455743, 22.951439495738697, 63.11869742882649, 88.34364606910232, 28.400432373056418, 26.189726756562614, 254.78668102338608, 337.0483799514387, 73.53742499717112, 13.780624387179481, 141.6064531316299, 147.7197165716534, 164.46950814399287, 212.38980628832354, 333.41495434827436, 33.20644511938814, 151.19554575770022, 1.8584145160060492, 72.02579555770538, 40.05782133200807, 138.52748015351764, 15.77505047700694, 60.112318022742265, 53.63118849140326, 145.75388773587244, 195.94059649492175, 309.3583657441994, 380.0128109887046, 31.428771701043285, 158.30750750736618, 650.0753336081115, 229.36845680458703, 9.439872639170066, 776.5436638705049, 164.0045644451754, 693.9040733680717, 450.63860649399504, 59.802497952841804, 274.03813492715216, 566.2380909485533, 26.713557940671283, 83.80186383591091, 871.7102419500567, 180.80520130278137, 168.38646676960295, 190.74526557241248, 53.47832465295042, 367.7795121383269, 3.309803272067328, 849.1312223834186, 592.6367804174654, 259.6545372029241, 532.9082612342854, 5.083026780103052, 228.65452175064235, 90.66038875418322, 437.7910885947967, 1201.3139861824884, 285.7354547263654, 703.3760084984169, 527.5479677916642, 46.2883017256211, 27.307551979501884, 331.1425396567839, 608.1103161557518, 105.2873589333791, 170.50102621529135, 16.640033138820733, 145.42965244867887, 17.10939165057108, 94.5977471145787, 606.1792376438211, 146.3568312157422, 13.868285405532765, 227.71486971328468, 228.14679894152917, 142.9418352521488, 68.47605095767999, 31.10121659385853, 236.53966683467956, 268.45832204565056, 184.5040897684402, 382.8414305259158, 350.8178933683069, 759.2281789167281]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.130948947511297, "mean_inference_ms": 6.47350518317004, "mean_action_processing_ms": 3.206998603153748, "mean_env_wait_ms": 12.941309360255081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005028247833251953, "StateBufferConnector_ms": 0.008999943733215332, "ViewRequirementAgentConnector_ms": 0.1903170347213745}, "num_episodes": 24, "episode_return_max": 750.1, "episode_return_min": -68.26888083597322, "episode_return_mean": 330.7178022230885, "episodes_this_iter": 24}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.71415253602305, "num_env_steps_trained_throughput_per_sec": 72.71415253602305, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 55445.445, "restore_workers_time_ms": 0.015, "training_step_time_ms": 55445.379, "sample_time_ms": 2589.878, "learn_time_ms": 52835.982, "learn_throughput": 75.706, "synch_weights_time_ms": 14.36}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "645a5_00000", "date": "2024-08-22_12-09-20", "timestamp": 1724308760, "time_this_iter_s": 55.06707501411438, "time_total_s": 956.3331918716431, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a16a9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 956.3331918716431, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 33.74285714285714, "ram_util_percent": 83.01818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.44374541126231, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.293295200413497, "policy_loss": -0.015447664549500341, "vf_loss": 4.3059539749508815, "vf_explained_var": 0.3069526090823784, "kl": 0.013944429435604621, "entropy": 1.1574812506241774, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 1007.8149999999987}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.64572605235236, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.000250658913264, "policy_loss": -0.017170206103572453, "vf_loss": 5.014820991243635, "vf_explained_var": 0.37790696939463336, "kl": 0.012999433293573993, "entropy": 1.3706006475226589, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 1007.8149999999987}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 750.1, "episode_reward_min": -68.26888083597322, "episode_reward_mean": 319.2543622685209, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1233.7585594142863, "predator_policy": 1.8584145160060492}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1201.3139861824884}, "policy_reward_mean": {"prey_policy": -55.820266488122854, "predator_policy": 215.4474476223833}, "custom_metrics": {}, "hist_stats": {"episode_reward": [374.36365647458524, 607.0726565307655, 81.30879837316557, 477.0967463098938, 491.76642204987104, 289.2000000000002, 319.99999999999955, 615.6, 308.01286347544954, 371.6000000000015, 662.9987274958014, 226.1999999999996, 526.3176097385935, 579.1153368474343, 525.0147587540813, 304.30000000000007, 307.61706433213266, 50.45546895475954, 223.85302134597646, 75.00000000000001, 68.1000000000004, 133.60000000000005, 390.7999999999993, 428.70000000000084, 573.2869211358554, 446.816988852629, 288.63498775230926, 130.099999999997, 130.90000000000015, 514.4999999999998, -68.26888083597322, 78.89656160166523, 301.59679824362445, 88.50000000000016, 55.02930578823269, 360.4955038806338, 502.9999999999994, 73.20000000000013, 284.65275116279787, 69.40000000000033, 134.09999999999624, 329.09999999999945, 422.3000000000032, 601.6000000000004, 371.2272750132408, 306.7207133417039, 234.44717094699263, 415.89999999999964, 400.6893998957706, 257.5588292288571, 591.204214907954, 202.0774645607411, 219.00511756790362, 388.34357888081183, 717.3, 215.6999999999975, 157.78691727324775, 157.69999999999914, 121.99999999999912, 516.3337664830932, 0.26232787653891076, 305.1335036985652, 750.1, 438.6359677253802, 365.3494363928666, 348.0000000000009, 725.8219916805243, 333.96899728294426, 579.4613868552924, 405.22064683707225, 629.6999999999999, 582.129826212637, 519.3675364359974, 107.29855962724514, 247.7999999999982, 325.72656692977796, 350.6520093630721, 174.39999999999984, 92.4088495753464, 391.4000000000024, 580.9017935956351, 402.50000000000205, 191.91965216876832, 653.9634292194986, 76.19642776068001, 348.03564739521823, 396.0095110674016, 285.0413167535561, 73.80000000000008, 364.61019768623385, 97.57738473056189, 189.59999999999863, 306.20749096949703, 119.14103845675359, 243.88522355981306, 87.76660749319618, 109.18615413522917, 312.9000000000003, 276.900000000002, 106.52822900218194], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [196.6269597636079, -207.50696670314036, 184.93122794952248, 373.55978807917785, -60.37803320947567, -362.95511892321224, 123.99186445999182, 144.63110155983884, 10.963803270346926, 330.7000577239183, -26.028865922802233, 53.802617882191846, -147.13240521296743, 237.76244507157352, 82.84042290966096, 322.96266689103027, -68.4647992448787, 125.15727646308093, -208.91668476130565, 322.04237591058404, 299.6062265432927, 110.54340789911882, 151.20738533473573, -12.45394945524123, -7.911971020713139, 211.3268345802874, 197.14026413266288, 183.1570468393131, 14.913227103983559, 139.58641065911556, -126.65148247035896, 227.66091448031793, -70.29065494162194, -271.53628125492247, -82.37171472051415, -446.9937685701329, -181.5709413194396, -3.160571204106405, -77.18108488441965, 31.88705289060019, -79.87639045052025, -101.44079943838025, -45.88489996424087, -79.76586987744707, 327.8787698756249, -316.91172647914914, 400.0, -252.2725509968755, 279.11101480812266, 22.531581507784704, 132.79020537189552, -149.48364257219333, 140.7775291224683, -283.5796993170686, 37.68966347949264, -66.89877839321669, -148.9334175405423, 61.095379032658066, 57.59195017341912, 242.61719993542093, -381.73699083208936, -169.61812835760907, 1.0364556275710726, -450.6237330306215, 227.71154834334885, -12.184887024289011, -52.74364606910354, 24.499567626943705, -8.868681404062837, -217.07842058765473, -46.845948471160625, -3.2443525968149878, 213.4485548186942, 134.16436766249632, -213.81982209785144, -25.169402617795875, 28.886582189934714, -290.03859166373405, 5.29355488061206, -120.29554575770197, 82.9415854839931, -22.725795557705176, 234.14217866799208, -83.62748015351771, 263.2126315002507, 83.19999999999914, 292.86881150859676, 109.34611226412741, 142.86474912772266, -276.9364363536038, -213.70442495579744, 108.9835556077536, -552.1691511159975, -21.766519052485066, 87.93154319541298, 89.16012736082997, -474.48805479857185, -65.37077362133658, -543.2212350506562, -343.7626155825529, 63.87443747252127, 193.48914455543883, -349.04244795294716, -41.831736375533524, -299.4381247385706, -437.06886347949387, 174.43304316268487, -135.28113235426125, 360.39240776911186, 112.68400200552537, -12.817995096968538, -142.57132031342618, -1043.072018452996, -240.90906707464066, -671.2510469910574, 36.388248553848086, 33.27688161036323, -145.01443014110993, -5.4732796081758295, -6.644431257711176, -253.02855361802392, -1233.7585594142863, -622.3396933982416, -303.45077919327434, 320.71169827437893, 355.7924480204981, -124.308049627187, -376.30883845996794, -69.33792254051586, 158.89897378470874, 298.1599668611793, -112.22965244868072, 370.2517098544716, 243.86314306090296, -121.58621518023128, -296.9808563963844, 110.64415220601646, 227.23407953045833, 126.26885525345995, -92.13684261006637, 338.7566166341574, 191.36611581430418, 129.27460382612776, -52.142766493820716, -117.97945176190933, 70.00146790355137, -842.9316146798011, -159.8158979779885, -208.92944449016753, -122.24513370622594, -106.48364627368845, -121.3383014504625, -21.281040274485527, 59.17524963659281, -41.921184424222226, 93.99017030943494, -295.61478664304275, -388.00080077726284, 320.3996810695054, -498.9810914557497, 101.85629102996484, 17.179865679066268, 316.9629255007791, -54.72245449859316, -180.47372893245154, -37.11787588230648, 162.32838628820917, 284.96015031100643, -311.81775853335273, -460.046288008937, 38.646235268296145, 106.16162757837381, 118.10415889348138, 29.57323593459256, -225.72904710138587, -730.3359529045484, 2.5705888783976953, -74.5381020008892, -162.96652039527294, -249.9866513576521, -231.4375257425384, -649.835076684689, -75.09244752257013, 40.32687893820407, -158.69926582981725, -5.673930985309532, -285.6392825460849, -616.1232247642532, 97.10317146066821, 32.198055310795965, -131.40730068270338, -217.8822525815598, 29.275491050409407, -250.7260251037483, 7.4388126605074945, -184.61814069564005, -71.19451058503466, -248.04709919942192, -574.8279557727433, -67.76372610200268], "policy_predator_policy_reward": [58.336696710977385, 326.90696670314003, 46.559667262209636, 2.0219732398551504, 339.8587409724869, 164.7832095333656, 70.03546774865711, 138.4383125414054, 133.64732070653105, 16.455240349075847, 62.328865922802606, 199.09738211780783, 199.63240521296643, 29.73755492842648, 186.159577090339, 23.637333108969766, 129.140013789191, 122.18037246805413, 235.81668476130517, 22.657624089415982, 139.88141069382905, 112.96768235956071, 69.54106248882421, 17.905501631681307, 169.01332987203375, 153.88941630698565, 115.43706906324657, 83.38095681221216, 215.8057419446116, 154.7093790463708, 158.65148247035714, 44.63908551968206, 287.9551203591743, 361.4888801695015, 61.49080065713903, 518.3301515882682, 332.40037593490706, 76.18415793461621, 115.82320542075031, 4.470826573067303, 114.1763904505183, 135.24079943837836, 143.3848999642395, 115.86586987744722, 39.12123012437506, 340.7117264791493, 183.8272363934923, 97.1453146033832, 152.38569803184615, 119.25862678810195, 202.6880207899514, 260.8224052629753, 119.97938091712608, 311.4577770297825, 57.81033652050748, 101.49877839321472, 190.9527976102681, 27.785240897614344, 156.70804982658032, 57.58280006457918, 128.60251928657604, 354.4837190671484, 260.98940805914094, 267.4944309455743, 22.951439495738697, 63.11869742882649, 88.34364606910232, 28.400432373056418, 26.189726756562614, 254.78668102338608, 337.0483799514387, 73.53742499717112, 13.780624387179481, 141.6064531316299, 147.7197165716534, 164.46950814399287, 212.38980628832354, 333.41495434827436, 33.20644511938814, 151.19554575770022, 1.8584145160060492, 72.02579555770538, 40.05782133200807, 138.52748015351764, 15.77505047700694, 60.112318022742265, 53.63118849140326, 145.75388773587244, 195.94059649492175, 309.3583657441994, 380.0128109887046, 31.428771701043285, 158.30750750736618, 650.0753336081115, 229.36845680458703, 9.439872639170066, 776.5436638705049, 164.0045644451754, 693.9040733680717, 450.63860649399504, 59.802497952841804, 274.03813492715216, 566.2380909485533, 26.713557940671283, 83.80186383591091, 871.7102419500567, 180.80520130278137, 168.38646676960295, 190.74526557241248, 53.47832465295042, 367.7795121383269, 3.309803272067328, 849.1312223834186, 592.6367804174654, 259.6545372029241, 532.9082612342854, 5.083026780103052, 228.65452175064235, 90.66038875418322, 437.7910885947967, 1201.3139861824884, 285.7354547263654, 703.3760084984169, 527.5479677916642, 46.2883017256211, 27.307551979501884, 331.1425396567839, 608.1103161557518, 105.2873589333791, 170.50102621529135, 16.640033138820733, 145.42965244867887, 17.10939165057108, 94.5977471145787, 606.1792376438211, 146.3568312157422, 13.868285405532765, 227.71486971328468, 228.14679894152917, 142.9418352521488, 68.47605095767999, 31.10121659385853, 236.53966683467956, 268.45832204565056, 184.5040897684402, 382.8414305259158, 350.8178933683069, 759.2281789167281, 61.3467955474047, 517.627782648987, 269.6094688520353, 283.93904580189417, 154.4446210252269, 158.31317897573734, 119.18597868542096, 3.1450354293659717, 629.3779175080175, 146.64651948764535, 43.600318930494616, 526.3810914557542, 98.88585516854667, 362.979781718057, 51.03707449922094, 89.22245449859193, 259.5111194342823, 150.00013754924586, 143.95177904158902, 62.72311357869411, 407.95107722011863, 440.1093970828608, 43.56356365473352, 159.66422089381396, 212.89584110651862, 35.43627513280725, 275.0951937881919, 966.0111229712992, 35.52941112160254, 110.23810200088718, 425.9647734786355, 351.5985959605212, 627.4182527386549, 351.4317344191379, 146.0602144755348, 78.30535410882989, 118.2385300822115, 352.3421577024121, 827.8167410311472, 193.08680473594572, 89.6555467503503, 24.928450038000555, 301.66058643506034, 135.39557432239616, 12.810663084822243, 317.826025103752, 273.1611873394925, 216.91814069563821, 539.9609590133023, 56.18065077115268, 172.99785276759786, 576.1220581093332]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.790773914987548, "mean_inference_ms": 6.331418093887107, "mean_action_processing_ms": 3.008393238943693, "mean_env_wait_ms": 12.7667974389528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011650562286376953, "StateBufferConnector_ms": 0.008277535438537598, "ViewRequirementAgentConnector_ms": 0.16542041301727295}, "num_episodes": 26, "episode_return_max": 750.1, "episode_return_min": -68.26888083597322, "episode_return_mean": 319.2543622685209, "episodes_this_iter": 26}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.99298471146072, "num_env_steps_trained_throughput_per_sec": 71.99298471146072, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 55495.947, "restore_workers_time_ms": 0.014, "training_step_time_ms": 55495.881, "sample_time_ms": 2591.384, "learn_time_ms": 52886.191, "learn_throughput": 75.634, "synch_weights_time_ms": 14.304}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "645a5_00000", "date": "2024-08-22_12-10-16", "timestamp": 1724308816, "time_this_iter_s": 55.65018701553345, "time_total_s": 1011.9833788871765, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a122ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1011.9833788871765, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 33.05949367088608, "ram_util_percent": 82.35189873417721}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.210785280712067, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.492350087342439, "policy_loss": -0.018354805333973476, "vf_loss": 5.507830400189395, "vf_explained_var": 0.3016106990279344, "kl": 0.014372422073341945, "entropy": 1.0630392084046016, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 965.7624999999972}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.829257760098372, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.998708366464686, "policy_loss": -0.02809480294836537, "vf_loss": 6.023018128783614, "vf_explained_var": 0.3932499507116893, "kl": 0.018925237715264005, "entropy": 1.3081637716797925, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 965.7624999999972}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 750.1, "episode_reward_min": 0.26232787653891076, "episode_reward_mean": 316.9026788677272, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1233.7585594142863, "predator_policy": 1.8584145160060492}, "policy_reward_max": {"prey_policy": 370.2517098544716, "predator_policy": 1205.6087140400416}, "policy_reward_mean": {"prey_policy": -105.64943399135133, "predator_policy": 264.10077342521504}, "custom_metrics": {}, "hist_stats": {"episode_reward": [301.59679824362445, 88.50000000000016, 55.02930578823269, 360.4955038806338, 502.9999999999994, 73.20000000000013, 284.65275116279787, 69.40000000000033, 134.09999999999624, 329.09999999999945, 422.3000000000032, 601.6000000000004, 371.2272750132408, 306.7207133417039, 234.44717094699263, 415.89999999999964, 400.6893998957706, 257.5588292288571, 591.204214907954, 202.0774645607411, 219.00511756790362, 388.34357888081183, 717.3, 215.6999999999975, 157.78691727324775, 157.69999999999914, 121.99999999999912, 516.3337664830932, 0.26232787653891076, 305.1335036985652, 750.1, 438.6359677253802, 365.3494363928666, 348.0000000000009, 725.8219916805243, 333.96899728294426, 579.4613868552924, 405.22064683707225, 629.6999999999999, 582.129826212637, 519.3675364359974, 107.29855962724514, 247.7999999999982, 325.72656692977796, 350.6520093630721, 174.39999999999984, 92.4088495753464, 391.4000000000024, 580.9017935956351, 402.50000000000205, 191.91965216876832, 653.9634292194986, 76.19642776068001, 348.03564739521823, 396.0095110674016, 285.0413167535561, 73.80000000000008, 364.61019768623385, 97.57738473056189, 189.59999999999863, 306.20749096949703, 119.14103845675359, 243.88522355981306, 87.76660749319618, 109.18615413522917, 312.9000000000003, 276.900000000002, 106.52822900218194, 372.50273282850844, 248.390169887389, 296.0999999999999, 347.20000000000226, 189.60965701007197, 607.9999999999995, 360.00179257428573, 122.49999999999864, 189.99999999999937, 352.49999999999966, 435.85293033741425, 71.00000000000024, 392.12528725060855, 154.30000000000007, 261.3217672343254, 358.4000000000012, 101.23356238169924, 78.36791930831077, 381.7533684627203, 176.76621070024018, 679.2330582461867, 317.0712159942801, 527.3059597079932, 378.6000000000023, 323.92551214041964, 195.19999999999962, 77.93022504517413, 74.50000000000004, 652.7000000000002, 600.6, 573.8999999999996, 398.90000000000225], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [227.71154834334885, -12.184887024289011, -52.74364606910354, 24.499567626943705, -8.868681404062837, -217.07842058765473, -46.845948471160625, -3.2443525968149878, 213.4485548186942, 134.16436766249632, -213.81982209785144, -25.169402617795875, 28.886582189934714, -290.03859166373405, 5.29355488061206, -120.29554575770197, 82.9415854839931, -22.725795557705176, 234.14217866799208, -83.62748015351771, 263.2126315002507, 83.19999999999914, 292.86881150859676, 109.34611226412741, 142.86474912772266, -276.9364363536038, -213.70442495579744, 108.9835556077536, -552.1691511159975, -21.766519052485066, 87.93154319541298, 89.16012736082997, -474.48805479857185, -65.37077362133658, -543.2212350506562, -343.7626155825529, 63.87443747252127, 193.48914455543883, -349.04244795294716, -41.831736375533524, -299.4381247385706, -437.06886347949387, 174.43304316268487, -135.28113235426125, 360.39240776911186, 112.68400200552537, -12.817995096968538, -142.57132031342618, -1043.072018452996, -240.90906707464066, -671.2510469910574, 36.388248553848086, 33.27688161036323, -145.01443014110993, -5.4732796081758295, -6.644431257711176, -253.02855361802392, -1233.7585594142863, -622.3396933982416, -303.45077919327434, 320.71169827437893, 355.7924480204981, -124.308049627187, -376.30883845996794, -69.33792254051586, 158.89897378470874, 298.1599668611793, -112.22965244868072, 370.2517098544716, 243.86314306090296, -121.58621518023128, -296.9808563963844, 110.64415220601646, 227.23407953045833, 126.26885525345995, -92.13684261006637, 338.7566166341574, 191.36611581430418, 129.27460382612776, -52.142766493820716, -117.97945176190933, 70.00146790355137, -842.9316146798011, -159.8158979779885, -208.92944449016753, -122.24513370622594, -106.48364627368845, -121.3383014504625, -21.281040274485527, 59.17524963659281, -41.921184424222226, 93.99017030943494, -295.61478664304275, -388.00080077726284, 320.3996810695054, -498.9810914557497, 101.85629102996484, 17.179865679066268, 316.9629255007791, -54.72245449859316, -180.47372893245154, -37.11787588230648, 162.32838628820917, 284.96015031100643, -311.81775853335273, -460.046288008937, 38.646235268296145, 106.16162757837381, 118.10415889348138, 29.57323593459256, -225.72904710138587, -730.3359529045484, 2.5705888783976953, -74.5381020008892, -162.96652039527294, -249.9866513576521, -231.4375257425384, -649.835076684689, -75.09244752257013, 40.32687893820407, -158.69926582981725, -5.673930985309532, -285.6392825460849, -616.1232247642532, 97.10317146066821, 32.198055310795965, -131.40730068270338, -217.8822525815598, 29.275491050409407, -250.7260251037483, 7.4388126605074945, -184.61814069564005, -71.19451058503466, -248.04709919942192, -574.8279557727433, -67.76372610200268, -468.7557487895961, 85.99438527092302, -409.03863708759116, -399.51534256046705, 67.88969810275051, 13.526013578014885, -12.27406930819038, 13.68669281396221, -609.852543169854, -287.1202061031738, 315.3530038330927, 103.76764454045338, 287.16509449763294, -1150.9479045873654, -187.12908529119346, -911.4919981136549, -602.9514197167996, 74.21707549727536, -323.21071341670034, 160.02738294488464, -7.429652401331605, -167.65082541121987, 34.31777492256365, -197.41400993555263, -127.85460730207515, 279.3535482982578, -4.631123343533648, 48.2439067211489, -749.6619695587112, 10.542312576819455, 271.60160858669553, -120.80930107172159, -1141.2257840840396, 14.381074661686936, 37.347897022661314, -225.12518915962605, 332.75449829837186, -1161.2628905387876, -466.8881551024352, -672.6159552179223, 55.86264099171078, 330.8545927716437, -1109.2552715507125, -425.8592468595974, 140.47411966656077, -116.22323024087204, -4.664110876789426, 224.85853435166715, -140.31872332853055, -454.7271969905735, 40.0000000000003, 69.00432558275281, 19.11379559610113, -122.39068133547974, -55.482989057048584, -13.344623438469482, 111.59834691514584, 230.17913699677712, -254.25013255884284, 279.38846555046433, 347.68426747765557, -281.08985494400065, 274.87006351601485, 34.16099648628211], "policy_predator_policy_reward": [22.951439495738697, 63.11869742882649, 88.34364606910232, 28.400432373056418, 26.189726756562614, 254.78668102338608, 337.0483799514387, 73.53742499717112, 13.780624387179481, 141.6064531316299, 147.7197165716534, 164.46950814399287, 212.38980628832354, 333.41495434827436, 33.20644511938814, 151.19554575770022, 1.8584145160060492, 72.02579555770538, 40.05782133200807, 138.52748015351764, 15.77505047700694, 60.112318022742265, 53.63118849140326, 145.75388773587244, 195.94059649492175, 309.3583657441994, 380.0128109887046, 31.428771701043285, 158.30750750736618, 650.0753336081115, 229.36845680458703, 9.439872639170066, 776.5436638705049, 164.0045644451754, 693.9040733680717, 450.63860649399504, 59.802497952841804, 274.03813492715216, 566.2380909485533, 26.713557940671283, 83.80186383591091, 871.7102419500567, 180.80520130278137, 168.38646676960295, 190.74526557241248, 53.47832465295042, 367.7795121383269, 3.309803272067328, 849.1312223834186, 592.6367804174654, 259.6545372029241, 532.9082612342854, 5.083026780103052, 228.65452175064235, 90.66038875418322, 437.7910885947967, 1201.3139861824884, 285.7354547263654, 703.3760084984169, 527.5479677916642, 46.2883017256211, 27.307551979501884, 331.1425396567839, 608.1103161557518, 105.2873589333791, 170.50102621529135, 16.640033138820733, 145.42965244867887, 17.10939165057108, 94.5977471145787, 606.1792376438211, 146.3568312157422, 13.868285405532765, 227.71486971328468, 228.14679894152917, 142.9418352521488, 68.47605095767999, 31.10121659385853, 236.53966683467956, 268.45832204565056, 184.5040897684402, 382.8414305259158, 350.8178933683069, 759.2281789167281, 61.3467955474047, 517.627782648987, 269.6094688520353, 283.93904580189417, 154.4446210252269, 158.31317897573734, 119.18597868542096, 3.1450354293659717, 629.3779175080175, 146.64651948764535, 43.600318930494616, 526.3810914557542, 98.88585516854667, 362.979781718057, 51.03707449922094, 89.22245449859193, 259.5111194342823, 150.00013754924586, 143.95177904158902, 62.72311357869411, 407.95107722011863, 440.1093970828608, 43.56356365473352, 159.66422089381396, 212.89584110651862, 35.43627513280725, 275.0951937881919, 966.0111229712992, 35.52941112160254, 110.23810200088718, 425.9647734786355, 351.5985959605212, 627.4182527386549, 351.4317344191379, 146.0602144755348, 78.30535410882989, 118.2385300822115, 352.3421577024121, 827.8167410311472, 193.08680473594572, 89.6555467503503, 24.928450038000555, 301.66058643506034, 135.39557432239616, 12.810663084822243, 317.826025103752, 273.1611873394925, 216.91814069563821, 539.9609590133023, 56.18065077115268, 172.99785276759786, 576.1220581093332, 615.089811945733, 140.17428440145125, 152.9202259540379, 904.0239235814091, 185.4532792932942, 29.231009025940327, 314.0035017884582, 31.783874705770433, 227.86113760827504, 858.7212686748252, 186.8395335887703, 2.039818037683087, 69.1377983629525, 1154.6468043010657, 219.62908529119161, 1001.4919981136549, 685.1514197167988, 33.58292450272485, 111.58245064101955, 404.1008798307951, 6.995246201056759, 603.9381619489068, 5.18222507743657, 228.9140099355509, 164.51174616657846, 76.11460008784368, 42.13112334353398, 68.55609327885139, 899.3659484648501, 101.0754757513701, 54.59839141330449, 153.00930107171982, 1004.2719122213422, 223.8063595827117, 36.458642687170425, 229.68656875810527, 4.653046663093655, 1205.6087140400416, 566.4425208122345, 749.8278002083647, 232.8208045455781, 59.695019937254095, 819.7809022785681, 1032.4048321260232, 120.69039298873844, 382.3646772935664, 124.61826149610168, 33.78731502902093, 796.1338170832131, 122.83761537630983, 61.318552151463834, 24.87712226578343, 23.916429449073135, 157.29068133547787, 92.18298905704711, 51.14462343846997, 131.2997944695702, 179.62272161850655, 494.4501325588429, 81.01153444953566, 18.119811650579248, 489.1857758157671, 3.2217313509487084, 86.64720864675454]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.54288305925008, "mean_inference_ms": 5.970591895252166, "mean_action_processing_ms": 2.6893680515173086, "mean_env_wait_ms": 12.468226803983644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010802865028381348, "StateBufferConnector_ms": 0.00787818431854248, "ViewRequirementAgentConnector_ms": 0.2027062177658081}, "num_episodes": 32, "episode_return_max": 750.1, "episode_return_min": 0.26232787653891076, "episode_return_mean": 316.9026788677272, "episodes_this_iter": 32}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 14.587567210359376, "num_env_steps_trained_throughput_per_sec": 14.587567210359376, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 77287.325, "restore_workers_time_ms": 0.014, "training_step_time_ms": 77287.258, "sample_time_ms": 2540.444, "learn_time_ms": 74727.546, "learn_throughput": 53.528, "synch_weights_time_ms": 15.05}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "645a5_00000", "date": "2024-08-22_12-14-50", "timestamp": 1724309090, "time_this_iter_s": 274.30445623397827, "time_total_s": 1286.2878351211548, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a122d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1286.2878351211548, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 41.960714285714275, "ram_util_percent": 83.64523809523808}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.169099093871142, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.41627843543966, "policy_loss": -0.019330351666187642, "vf_loss": 7.432770349613573, "vf_explained_var": 0.23463863065003088, "kl": 0.01419214548927451, "entropy": 0.8915294872705268, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 986.0800000000017}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.979412897238655, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.2947851239058075, "policy_loss": -0.026237766358449502, "vf_loss": 7.317361972697828, "vf_explained_var": 0.215678411974478, "kl": 0.018304535543802316, "entropy": 1.2447809007432726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 986.0800000000017}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 750.1, "episode_reward_min": 0.26232787653891076, "episode_reward_mean": 317.3149324136283, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1233.7585594142863, "predator_policy": 1.8584145160060492}, "policy_reward_max": {"prey_policy": 370.2517098544716, "predator_policy": 1205.6087140400416}, "policy_reward_mean": {"prey_policy": -113.9065242984112, "predator_policy": 272.56399050522543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.4955038806338, 502.9999999999994, 73.20000000000013, 284.65275116279787, 69.40000000000033, 134.09999999999624, 329.09999999999945, 422.3000000000032, 601.6000000000004, 371.2272750132408, 306.7207133417039, 234.44717094699263, 415.89999999999964, 400.6893998957706, 257.5588292288571, 591.204214907954, 202.0774645607411, 219.00511756790362, 388.34357888081183, 717.3, 215.6999999999975, 157.78691727324775, 157.69999999999914, 121.99999999999912, 516.3337664830932, 0.26232787653891076, 305.1335036985652, 750.1, 438.6359677253802, 365.3494363928666, 348.0000000000009, 725.8219916805243, 333.96899728294426, 579.4613868552924, 405.22064683707225, 629.6999999999999, 582.129826212637, 519.3675364359974, 107.29855962724514, 247.7999999999982, 325.72656692977796, 350.6520093630721, 174.39999999999984, 92.4088495753464, 391.4000000000024, 580.9017935956351, 402.50000000000205, 191.91965216876832, 653.9634292194986, 76.19642776068001, 348.03564739521823, 396.0095110674016, 285.0413167535561, 73.80000000000008, 364.61019768623385, 97.57738473056189, 189.59999999999863, 306.20749096949703, 119.14103845675359, 243.88522355981306, 87.76660749319618, 109.18615413522917, 312.9000000000003, 276.900000000002, 106.52822900218194, 372.50273282850844, 248.390169887389, 296.0999999999999, 347.20000000000226, 189.60965701007197, 607.9999999999995, 360.00179257428573, 122.49999999999864, 189.99999999999937, 352.49999999999966, 435.85293033741425, 71.00000000000024, 392.12528725060855, 154.30000000000007, 261.3217672343254, 358.4000000000012, 101.23356238169924, 78.36791930831077, 381.7533684627203, 176.76621070024018, 679.2330582461867, 317.0712159942801, 527.3059597079932, 378.6000000000023, 323.92551214041964, 195.19999999999962, 77.93022504517413, 74.50000000000004, 652.7000000000002, 600.6, 573.8999999999996, 398.90000000000225, 176.7087026072551, 127.13942169814095, 182.50333431657154], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-46.845948471160625, -3.2443525968149878, 213.4485548186942, 134.16436766249632, -213.81982209785144, -25.169402617795875, 28.886582189934714, -290.03859166373405, 5.29355488061206, -120.29554575770197, 82.9415854839931, -22.725795557705176, 234.14217866799208, -83.62748015351771, 263.2126315002507, 83.19999999999914, 292.86881150859676, 109.34611226412741, 142.86474912772266, -276.9364363536038, -213.70442495579744, 108.9835556077536, -552.1691511159975, -21.766519052485066, 87.93154319541298, 89.16012736082997, -474.48805479857185, -65.37077362133658, -543.2212350506562, -343.7626155825529, 63.87443747252127, 193.48914455543883, -349.04244795294716, -41.831736375533524, -299.4381247385706, -437.06886347949387, 174.43304316268487, -135.28113235426125, 360.39240776911186, 112.68400200552537, -12.817995096968538, -142.57132031342618, -1043.072018452996, -240.90906707464066, -671.2510469910574, 36.388248553848086, 33.27688161036323, -145.01443014110993, -5.4732796081758295, -6.644431257711176, -253.02855361802392, -1233.7585594142863, -622.3396933982416, -303.45077919327434, 320.71169827437893, 355.7924480204981, -124.308049627187, -376.30883845996794, -69.33792254051586, 158.89897378470874, 298.1599668611793, -112.22965244868072, 370.2517098544716, 243.86314306090296, -121.58621518023128, -296.9808563963844, 110.64415220601646, 227.23407953045833, 126.26885525345995, -92.13684261006637, 338.7566166341574, 191.36611581430418, 129.27460382612776, -52.142766493820716, -117.97945176190933, 70.00146790355137, -842.9316146798011, -159.8158979779885, -208.92944449016753, -122.24513370622594, -106.48364627368845, -121.3383014504625, -21.281040274485527, 59.17524963659281, -41.921184424222226, 93.99017030943494, -295.61478664304275, -388.00080077726284, 320.3996810695054, -498.9810914557497, 101.85629102996484, 17.179865679066268, 316.9629255007791, -54.72245449859316, -180.47372893245154, -37.11787588230648, 162.32838628820917, 284.96015031100643, -311.81775853335273, -460.046288008937, 38.646235268296145, 106.16162757837381, 118.10415889348138, 29.57323593459256, -225.72904710138587, -730.3359529045484, 2.5705888783976953, -74.5381020008892, -162.96652039527294, -249.9866513576521, -231.4375257425384, -649.835076684689, -75.09244752257013, 40.32687893820407, -158.69926582981725, -5.673930985309532, -285.6392825460849, -616.1232247642532, 97.10317146066821, 32.198055310795965, -131.40730068270338, -217.8822525815598, 29.275491050409407, -250.7260251037483, 7.4388126605074945, -184.61814069564005, -71.19451058503466, -248.04709919942192, -574.8279557727433, -67.76372610200268, -468.7557487895961, 85.99438527092302, -409.03863708759116, -399.51534256046705, 67.88969810275051, 13.526013578014885, -12.27406930819038, 13.68669281396221, -609.852543169854, -287.1202061031738, 315.3530038330927, 103.76764454045338, 287.16509449763294, -1150.9479045873654, -187.12908529119346, -911.4919981136549, -602.9514197167996, 74.21707549727536, -323.21071341670034, 160.02738294488464, -7.429652401331605, -167.65082541121987, 34.31777492256365, -197.41400993555263, -127.85460730207515, 279.3535482982578, -4.631123343533648, 48.2439067211489, -749.6619695587112, 10.542312576819455, 271.60160858669553, -120.80930107172159, -1141.2257840840396, 14.381074661686936, 37.347897022661314, -225.12518915962605, 332.75449829837186, -1161.2628905387876, -466.8881551024352, -672.6159552179223, 55.86264099171078, 330.8545927716437, -1109.2552715507125, -425.8592468595974, 140.47411966656077, -116.22323024087204, -4.664110876789426, 224.85853435166715, -140.31872332853055, -454.7271969905735, 40.0000000000003, 69.00432558275281, 19.11379559610113, -122.39068133547974, -55.482989057048584, -13.344623438469482, 111.59834691514584, 230.17913699677712, -254.25013255884284, 279.38846555046433, 347.68426747765557, -281.08985494400065, 274.87006351601485, 34.16099648628211, -207.8664035651469, -1070.1981511627625, -86.9552659317021, -224.43430576153355, -151.27375387136414, 50.64529976571668], "policy_predator_policy_reward": [337.0483799514387, 73.53742499717112, 13.780624387179481, 141.6064531316299, 147.7197165716534, 164.46950814399287, 212.38980628832354, 333.41495434827436, 33.20644511938814, 151.19554575770022, 1.8584145160060492, 72.02579555770538, 40.05782133200807, 138.52748015351764, 15.77505047700694, 60.112318022742265, 53.63118849140326, 145.75388773587244, 195.94059649492175, 309.3583657441994, 380.0128109887046, 31.428771701043285, 158.30750750736618, 650.0753336081115, 229.36845680458703, 9.439872639170066, 776.5436638705049, 164.0045644451754, 693.9040733680717, 450.63860649399504, 59.802497952841804, 274.03813492715216, 566.2380909485533, 26.713557940671283, 83.80186383591091, 871.7102419500567, 180.80520130278137, 168.38646676960295, 190.74526557241248, 53.47832465295042, 367.7795121383269, 3.309803272067328, 849.1312223834186, 592.6367804174654, 259.6545372029241, 532.9082612342854, 5.083026780103052, 228.65452175064235, 90.66038875418322, 437.7910885947967, 1201.3139861824884, 285.7354547263654, 703.3760084984169, 527.5479677916642, 46.2883017256211, 27.307551979501884, 331.1425396567839, 608.1103161557518, 105.2873589333791, 170.50102621529135, 16.640033138820733, 145.42965244867887, 17.10939165057108, 94.5977471145787, 606.1792376438211, 146.3568312157422, 13.868285405532765, 227.71486971328468, 228.14679894152917, 142.9418352521488, 68.47605095767999, 31.10121659385853, 236.53966683467956, 268.45832204565056, 184.5040897684402, 382.8414305259158, 350.8178933683069, 759.2281789167281, 61.3467955474047, 517.627782648987, 269.6094688520353, 283.93904580189417, 154.4446210252269, 158.31317897573734, 119.18597868542096, 3.1450354293659717, 629.3779175080175, 146.64651948764535, 43.600318930494616, 526.3810914557542, 98.88585516854667, 362.979781718057, 51.03707449922094, 89.22245449859193, 259.5111194342823, 150.00013754924586, 143.95177904158902, 62.72311357869411, 407.95107722011863, 440.1093970828608, 43.56356365473352, 159.66422089381396, 212.89584110651862, 35.43627513280725, 275.0951937881919, 966.0111229712992, 35.52941112160254, 110.23810200088718, 425.9647734786355, 351.5985959605212, 627.4182527386549, 351.4317344191379, 146.0602144755348, 78.30535410882989, 118.2385300822115, 352.3421577024121, 827.8167410311472, 193.08680473594572, 89.6555467503503, 24.928450038000555, 301.66058643506034, 135.39557432239616, 12.810663084822243, 317.826025103752, 273.1611873394925, 216.91814069563821, 539.9609590133023, 56.18065077115268, 172.99785276759786, 576.1220581093332, 615.089811945733, 140.17428440145125, 152.9202259540379, 904.0239235814091, 185.4532792932942, 29.231009025940327, 314.0035017884582, 31.783874705770433, 227.86113760827504, 858.7212686748252, 186.8395335887703, 2.039818037683087, 69.1377983629525, 1154.6468043010657, 219.62908529119161, 1001.4919981136549, 685.1514197167988, 33.58292450272485, 111.58245064101955, 404.1008798307951, 6.995246201056759, 603.9381619489068, 5.18222507743657, 228.9140099355509, 164.51174616657846, 76.11460008784368, 42.13112334353398, 68.55609327885139, 899.3659484648501, 101.0754757513701, 54.59839141330449, 153.00930107171982, 1004.2719122213422, 223.8063595827117, 36.458642687170425, 229.68656875810527, 4.653046663093655, 1205.6087140400416, 566.4425208122345, 749.8278002083647, 232.8208045455781, 59.695019937254095, 819.7809022785681, 1032.4048321260232, 120.69039298873844, 382.3646772935664, 124.61826149610168, 33.78731502902093, 796.1338170832131, 122.83761537630983, 61.318552151463834, 24.87712226578343, 23.916429449073135, 157.29068133547787, 92.18298905704711, 51.14462343846997, 131.2997944695702, 179.62272161850655, 494.4501325588429, 81.01153444953566, 18.119811650579248, 489.1857758157671, 3.2217313509487084, 86.64720864675454, 504.3038458205567, 950.4694115146076, 331.4586016631589, 107.07039172821715, 91.44529176943266, 191.6864966527883]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.480940433090222, "mean_inference_ms": 5.933928580966791, "mean_action_processing_ms": 2.6973582758861228, "mean_env_wait_ms": 12.453281768248905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010888814926147461, "StateBufferConnector_ms": 0.007061123847961426, "ViewRequirementAgentConnector_ms": 0.22102868556976318}, "num_episodes": 3, "episode_return_max": 750.1, "episode_return_min": 0.26232787653891076, "episode_return_mean": 317.3149324136283, "episodes_this_iter": 3}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.98739840087657, "num_env_steps_trained_throughput_per_sec": 72.98739840087657, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 77149.203, "restore_workers_time_ms": 0.014, "training_step_time_ms": 77149.137, "sample_time_ms": 2653.368, "learn_time_ms": 74476.242, "learn_throughput": 53.708, "synch_weights_time_ms": 15.289}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "645a5_00000", "date": "2024-08-22_12-15-45", "timestamp": 1724309145, "time_this_iter_s": 54.860700845718384, "time_total_s": 1341.1485359668732, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a16a940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1341.1485359668732, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 34.45443037974684, "ram_util_percent": 83.56962025316456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.112885555577657, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.342776381527936, "policy_loss": -0.016368903439718658, "vf_loss": 6.356012653673767, "vf_explained_var": 0.3118539525087548, "kl": 0.015663235470228805, "entropy": 0.9896384450493666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 965.2900000000008}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.969643120065568, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.31863980823093, "policy_loss": -0.02226235535927117, "vf_loss": 6.337737474996577, "vf_explained_var": 0.1658451951685406, "kl": 0.015823445973484212, "entropy": 1.280436759335654, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 965.2900000000008}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 750.1, "episode_reward_min": 0.26232787653891076, "episode_reward_mean": 317.3149324136283, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1233.7585594142863, "predator_policy": 1.8584145160060492}, "policy_reward_max": {"prey_policy": 370.2517098544716, "predator_policy": 1205.6087140400416}, "policy_reward_mean": {"prey_policy": -113.9065242984112, "predator_policy": 272.56399050522543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.4955038806338, 502.9999999999994, 73.20000000000013, 284.65275116279787, 69.40000000000033, 134.09999999999624, 329.09999999999945, 422.3000000000032, 601.6000000000004, 371.2272750132408, 306.7207133417039, 234.44717094699263, 415.89999999999964, 400.6893998957706, 257.5588292288571, 591.204214907954, 202.0774645607411, 219.00511756790362, 388.34357888081183, 717.3, 215.6999999999975, 157.78691727324775, 157.69999999999914, 121.99999999999912, 516.3337664830932, 0.26232787653891076, 305.1335036985652, 750.1, 438.6359677253802, 365.3494363928666, 348.0000000000009, 725.8219916805243, 333.96899728294426, 579.4613868552924, 405.22064683707225, 629.6999999999999, 582.129826212637, 519.3675364359974, 107.29855962724514, 247.7999999999982, 325.72656692977796, 350.6520093630721, 174.39999999999984, 92.4088495753464, 391.4000000000024, 580.9017935956351, 402.50000000000205, 191.91965216876832, 653.9634292194986, 76.19642776068001, 348.03564739521823, 396.0095110674016, 285.0413167535561, 73.80000000000008, 364.61019768623385, 97.57738473056189, 189.59999999999863, 306.20749096949703, 119.14103845675359, 243.88522355981306, 87.76660749319618, 109.18615413522917, 312.9000000000003, 276.900000000002, 106.52822900218194, 372.50273282850844, 248.390169887389, 296.0999999999999, 347.20000000000226, 189.60965701007197, 607.9999999999995, 360.00179257428573, 122.49999999999864, 189.99999999999937, 352.49999999999966, 435.85293033741425, 71.00000000000024, 392.12528725060855, 154.30000000000007, 261.3217672343254, 358.4000000000012, 101.23356238169924, 78.36791930831077, 381.7533684627203, 176.76621070024018, 679.2330582461867, 317.0712159942801, 527.3059597079932, 378.6000000000023, 323.92551214041964, 195.19999999999962, 77.93022504517413, 74.50000000000004, 652.7000000000002, 600.6, 573.8999999999996, 398.90000000000225, 176.7087026072551, 127.13942169814095, 182.50333431657154], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-46.845948471160625, -3.2443525968149878, 213.4485548186942, 134.16436766249632, -213.81982209785144, -25.169402617795875, 28.886582189934714, -290.03859166373405, 5.29355488061206, -120.29554575770197, 82.9415854839931, -22.725795557705176, 234.14217866799208, -83.62748015351771, 263.2126315002507, 83.19999999999914, 292.86881150859676, 109.34611226412741, 142.86474912772266, -276.9364363536038, -213.70442495579744, 108.9835556077536, -552.1691511159975, -21.766519052485066, 87.93154319541298, 89.16012736082997, -474.48805479857185, -65.37077362133658, -543.2212350506562, -343.7626155825529, 63.87443747252127, 193.48914455543883, -349.04244795294716, -41.831736375533524, -299.4381247385706, -437.06886347949387, 174.43304316268487, -135.28113235426125, 360.39240776911186, 112.68400200552537, -12.817995096968538, -142.57132031342618, -1043.072018452996, -240.90906707464066, -671.2510469910574, 36.388248553848086, 33.27688161036323, -145.01443014110993, -5.4732796081758295, -6.644431257711176, -253.02855361802392, -1233.7585594142863, -622.3396933982416, -303.45077919327434, 320.71169827437893, 355.7924480204981, -124.308049627187, -376.30883845996794, -69.33792254051586, 158.89897378470874, 298.1599668611793, -112.22965244868072, 370.2517098544716, 243.86314306090296, -121.58621518023128, -296.9808563963844, 110.64415220601646, 227.23407953045833, 126.26885525345995, -92.13684261006637, 338.7566166341574, 191.36611581430418, 129.27460382612776, -52.142766493820716, -117.97945176190933, 70.00146790355137, -842.9316146798011, -159.8158979779885, -208.92944449016753, -122.24513370622594, -106.48364627368845, -121.3383014504625, -21.281040274485527, 59.17524963659281, -41.921184424222226, 93.99017030943494, -295.61478664304275, -388.00080077726284, 320.3996810695054, -498.9810914557497, 101.85629102996484, 17.179865679066268, 316.9629255007791, -54.72245449859316, -180.47372893245154, -37.11787588230648, 162.32838628820917, 284.96015031100643, -311.81775853335273, -460.046288008937, 38.646235268296145, 106.16162757837381, 118.10415889348138, 29.57323593459256, -225.72904710138587, -730.3359529045484, 2.5705888783976953, -74.5381020008892, -162.96652039527294, -249.9866513576521, -231.4375257425384, -649.835076684689, -75.09244752257013, 40.32687893820407, -158.69926582981725, -5.673930985309532, -285.6392825460849, -616.1232247642532, 97.10317146066821, 32.198055310795965, -131.40730068270338, -217.8822525815598, 29.275491050409407, -250.7260251037483, 7.4388126605074945, -184.61814069564005, -71.19451058503466, -248.04709919942192, -574.8279557727433, -67.76372610200268, -468.7557487895961, 85.99438527092302, -409.03863708759116, -399.51534256046705, 67.88969810275051, 13.526013578014885, -12.27406930819038, 13.68669281396221, -609.852543169854, -287.1202061031738, 315.3530038330927, 103.76764454045338, 287.16509449763294, -1150.9479045873654, -187.12908529119346, -911.4919981136549, -602.9514197167996, 74.21707549727536, -323.21071341670034, 160.02738294488464, -7.429652401331605, -167.65082541121987, 34.31777492256365, -197.41400993555263, -127.85460730207515, 279.3535482982578, -4.631123343533648, 48.2439067211489, -749.6619695587112, 10.542312576819455, 271.60160858669553, -120.80930107172159, -1141.2257840840396, 14.381074661686936, 37.347897022661314, -225.12518915962605, 332.75449829837186, -1161.2628905387876, -466.8881551024352, -672.6159552179223, 55.86264099171078, 330.8545927716437, -1109.2552715507125, -425.8592468595974, 140.47411966656077, -116.22323024087204, -4.664110876789426, 224.85853435166715, -140.31872332853055, -454.7271969905735, 40.0000000000003, 69.00432558275281, 19.11379559610113, -122.39068133547974, -55.482989057048584, -13.344623438469482, 111.59834691514584, 230.17913699677712, -254.25013255884284, 279.38846555046433, 347.68426747765557, -281.08985494400065, 274.87006351601485, 34.16099648628211, -207.8664035651469, -1070.1981511627625, -86.9552659317021, -224.43430576153355, -151.27375387136414, 50.64529976571668], "policy_predator_policy_reward": [337.0483799514387, 73.53742499717112, 13.780624387179481, 141.6064531316299, 147.7197165716534, 164.46950814399287, 212.38980628832354, 333.41495434827436, 33.20644511938814, 151.19554575770022, 1.8584145160060492, 72.02579555770538, 40.05782133200807, 138.52748015351764, 15.77505047700694, 60.112318022742265, 53.63118849140326, 145.75388773587244, 195.94059649492175, 309.3583657441994, 380.0128109887046, 31.428771701043285, 158.30750750736618, 650.0753336081115, 229.36845680458703, 9.439872639170066, 776.5436638705049, 164.0045644451754, 693.9040733680717, 450.63860649399504, 59.802497952841804, 274.03813492715216, 566.2380909485533, 26.713557940671283, 83.80186383591091, 871.7102419500567, 180.80520130278137, 168.38646676960295, 190.74526557241248, 53.47832465295042, 367.7795121383269, 3.309803272067328, 849.1312223834186, 592.6367804174654, 259.6545372029241, 532.9082612342854, 5.083026780103052, 228.65452175064235, 90.66038875418322, 437.7910885947967, 1201.3139861824884, 285.7354547263654, 703.3760084984169, 527.5479677916642, 46.2883017256211, 27.307551979501884, 331.1425396567839, 608.1103161557518, 105.2873589333791, 170.50102621529135, 16.640033138820733, 145.42965244867887, 17.10939165057108, 94.5977471145787, 606.1792376438211, 146.3568312157422, 13.868285405532765, 227.71486971328468, 228.14679894152917, 142.9418352521488, 68.47605095767999, 31.10121659385853, 236.53966683467956, 268.45832204565056, 184.5040897684402, 382.8414305259158, 350.8178933683069, 759.2281789167281, 61.3467955474047, 517.627782648987, 269.6094688520353, 283.93904580189417, 154.4446210252269, 158.31317897573734, 119.18597868542096, 3.1450354293659717, 629.3779175080175, 146.64651948764535, 43.600318930494616, 526.3810914557542, 98.88585516854667, 362.979781718057, 51.03707449922094, 89.22245449859193, 259.5111194342823, 150.00013754924586, 143.95177904158902, 62.72311357869411, 407.95107722011863, 440.1093970828608, 43.56356365473352, 159.66422089381396, 212.89584110651862, 35.43627513280725, 275.0951937881919, 966.0111229712992, 35.52941112160254, 110.23810200088718, 425.9647734786355, 351.5985959605212, 627.4182527386549, 351.4317344191379, 146.0602144755348, 78.30535410882989, 118.2385300822115, 352.3421577024121, 827.8167410311472, 193.08680473594572, 89.6555467503503, 24.928450038000555, 301.66058643506034, 135.39557432239616, 12.810663084822243, 317.826025103752, 273.1611873394925, 216.91814069563821, 539.9609590133023, 56.18065077115268, 172.99785276759786, 576.1220581093332, 615.089811945733, 140.17428440145125, 152.9202259540379, 904.0239235814091, 185.4532792932942, 29.231009025940327, 314.0035017884582, 31.783874705770433, 227.86113760827504, 858.7212686748252, 186.8395335887703, 2.039818037683087, 69.1377983629525, 1154.6468043010657, 219.62908529119161, 1001.4919981136549, 685.1514197167988, 33.58292450272485, 111.58245064101955, 404.1008798307951, 6.995246201056759, 603.9381619489068, 5.18222507743657, 228.9140099355509, 164.51174616657846, 76.11460008784368, 42.13112334353398, 68.55609327885139, 899.3659484648501, 101.0754757513701, 54.59839141330449, 153.00930107171982, 1004.2719122213422, 223.8063595827117, 36.458642687170425, 229.68656875810527, 4.653046663093655, 1205.6087140400416, 566.4425208122345, 749.8278002083647, 232.8208045455781, 59.695019937254095, 819.7809022785681, 1032.4048321260232, 120.69039298873844, 382.3646772935664, 124.61826149610168, 33.78731502902093, 796.1338170832131, 122.83761537630983, 61.318552151463834, 24.87712226578343, 23.916429449073135, 157.29068133547787, 92.18298905704711, 51.14462343846997, 131.2997944695702, 179.62272161850655, 494.4501325588429, 81.01153444953566, 18.119811650579248, 489.1857758157671, 3.2217313509487084, 86.64720864675454, 504.3038458205567, 950.4694115146076, 331.4586016631589, 107.07039172821715, 91.44529176943266, 191.6864966527883]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.480940433090222, "mean_inference_ms": 5.933928580966791, "mean_action_processing_ms": 2.6973582758861228, "mean_env_wait_ms": 12.453281768248905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010888814926147461, "StateBufferConnector_ms": 0.007061123847961426, "ViewRequirementAgentConnector_ms": 0.22102868556976318}, "num_episodes": 0, "episode_return_max": 750.1, "episode_return_min": 0.26232787653891076, "episode_return_mean": 317.3149324136283, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.6464465985876, "num_env_steps_trained_throughput_per_sec": 74.6464465985876, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 76961.952, "restore_workers_time_ms": 0.014, "training_step_time_ms": 76961.886, "sample_time_ms": 2638.411, "learn_time_ms": 74303.571, "learn_throughput": 53.833, "synch_weights_time_ms": 15.528}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "645a5_00000", "date": "2024-08-22_12-16-39", "timestamp": 1724309199, "time_this_iter_s": 53.63456082344055, "time_total_s": 1394.7830967903137, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a16ab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1394.7830967903137, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 32.64868421052632, "ram_util_percent": 83.20789473684209}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.507911306335813, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.843752612512579, "policy_loss": -0.016729338281349374, "vf_loss": 5.8577568828744235, "vf_explained_var": 0.3584549228981058, "kl": 0.01362542428603524, "entropy": 0.9783357943807329, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.21765886005901, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.68938817700381, "policy_loss": -0.025834235074442057, "vf_loss": 5.7119068092770044, "vf_explained_var": 0.16172804901839563, "kl": 0.0165781056762195, "entropy": 1.261209819745765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 750.1, "episode_reward_min": 0.26232787653891076, "episode_reward_mean": 317.3149324136283, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1233.7585594142863, "predator_policy": 1.8584145160060492}, "policy_reward_max": {"prey_policy": 370.2517098544716, "predator_policy": 1205.6087140400416}, "policy_reward_mean": {"prey_policy": -113.9065242984112, "predator_policy": 272.56399050522543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.4955038806338, 502.9999999999994, 73.20000000000013, 284.65275116279787, 69.40000000000033, 134.09999999999624, 329.09999999999945, 422.3000000000032, 601.6000000000004, 371.2272750132408, 306.7207133417039, 234.44717094699263, 415.89999999999964, 400.6893998957706, 257.5588292288571, 591.204214907954, 202.0774645607411, 219.00511756790362, 388.34357888081183, 717.3, 215.6999999999975, 157.78691727324775, 157.69999999999914, 121.99999999999912, 516.3337664830932, 0.26232787653891076, 305.1335036985652, 750.1, 438.6359677253802, 365.3494363928666, 348.0000000000009, 725.8219916805243, 333.96899728294426, 579.4613868552924, 405.22064683707225, 629.6999999999999, 582.129826212637, 519.3675364359974, 107.29855962724514, 247.7999999999982, 325.72656692977796, 350.6520093630721, 174.39999999999984, 92.4088495753464, 391.4000000000024, 580.9017935956351, 402.50000000000205, 191.91965216876832, 653.9634292194986, 76.19642776068001, 348.03564739521823, 396.0095110674016, 285.0413167535561, 73.80000000000008, 364.61019768623385, 97.57738473056189, 189.59999999999863, 306.20749096949703, 119.14103845675359, 243.88522355981306, 87.76660749319618, 109.18615413522917, 312.9000000000003, 276.900000000002, 106.52822900218194, 372.50273282850844, 248.390169887389, 296.0999999999999, 347.20000000000226, 189.60965701007197, 607.9999999999995, 360.00179257428573, 122.49999999999864, 189.99999999999937, 352.49999999999966, 435.85293033741425, 71.00000000000024, 392.12528725060855, 154.30000000000007, 261.3217672343254, 358.4000000000012, 101.23356238169924, 78.36791930831077, 381.7533684627203, 176.76621070024018, 679.2330582461867, 317.0712159942801, 527.3059597079932, 378.6000000000023, 323.92551214041964, 195.19999999999962, 77.93022504517413, 74.50000000000004, 652.7000000000002, 600.6, 573.8999999999996, 398.90000000000225, 176.7087026072551, 127.13942169814095, 182.50333431657154], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-46.845948471160625, -3.2443525968149878, 213.4485548186942, 134.16436766249632, -213.81982209785144, -25.169402617795875, 28.886582189934714, -290.03859166373405, 5.29355488061206, -120.29554575770197, 82.9415854839931, -22.725795557705176, 234.14217866799208, -83.62748015351771, 263.2126315002507, 83.19999999999914, 292.86881150859676, 109.34611226412741, 142.86474912772266, -276.9364363536038, -213.70442495579744, 108.9835556077536, -552.1691511159975, -21.766519052485066, 87.93154319541298, 89.16012736082997, -474.48805479857185, -65.37077362133658, -543.2212350506562, -343.7626155825529, 63.87443747252127, 193.48914455543883, -349.04244795294716, -41.831736375533524, -299.4381247385706, -437.06886347949387, 174.43304316268487, -135.28113235426125, 360.39240776911186, 112.68400200552537, -12.817995096968538, -142.57132031342618, -1043.072018452996, -240.90906707464066, -671.2510469910574, 36.388248553848086, 33.27688161036323, -145.01443014110993, -5.4732796081758295, -6.644431257711176, -253.02855361802392, -1233.7585594142863, -622.3396933982416, -303.45077919327434, 320.71169827437893, 355.7924480204981, -124.308049627187, -376.30883845996794, -69.33792254051586, 158.89897378470874, 298.1599668611793, -112.22965244868072, 370.2517098544716, 243.86314306090296, -121.58621518023128, -296.9808563963844, 110.64415220601646, 227.23407953045833, 126.26885525345995, -92.13684261006637, 338.7566166341574, 191.36611581430418, 129.27460382612776, -52.142766493820716, -117.97945176190933, 70.00146790355137, -842.9316146798011, -159.8158979779885, -208.92944449016753, -122.24513370622594, -106.48364627368845, -121.3383014504625, -21.281040274485527, 59.17524963659281, -41.921184424222226, 93.99017030943494, -295.61478664304275, -388.00080077726284, 320.3996810695054, -498.9810914557497, 101.85629102996484, 17.179865679066268, 316.9629255007791, -54.72245449859316, -180.47372893245154, -37.11787588230648, 162.32838628820917, 284.96015031100643, -311.81775853335273, -460.046288008937, 38.646235268296145, 106.16162757837381, 118.10415889348138, 29.57323593459256, -225.72904710138587, -730.3359529045484, 2.5705888783976953, -74.5381020008892, -162.96652039527294, -249.9866513576521, -231.4375257425384, -649.835076684689, -75.09244752257013, 40.32687893820407, -158.69926582981725, -5.673930985309532, -285.6392825460849, -616.1232247642532, 97.10317146066821, 32.198055310795965, -131.40730068270338, -217.8822525815598, 29.275491050409407, -250.7260251037483, 7.4388126605074945, -184.61814069564005, -71.19451058503466, -248.04709919942192, -574.8279557727433, -67.76372610200268, -468.7557487895961, 85.99438527092302, -409.03863708759116, -399.51534256046705, 67.88969810275051, 13.526013578014885, -12.27406930819038, 13.68669281396221, -609.852543169854, -287.1202061031738, 315.3530038330927, 103.76764454045338, 287.16509449763294, -1150.9479045873654, -187.12908529119346, -911.4919981136549, -602.9514197167996, 74.21707549727536, -323.21071341670034, 160.02738294488464, -7.429652401331605, -167.65082541121987, 34.31777492256365, -197.41400993555263, -127.85460730207515, 279.3535482982578, -4.631123343533648, 48.2439067211489, -749.6619695587112, 10.542312576819455, 271.60160858669553, -120.80930107172159, -1141.2257840840396, 14.381074661686936, 37.347897022661314, -225.12518915962605, 332.75449829837186, -1161.2628905387876, -466.8881551024352, -672.6159552179223, 55.86264099171078, 330.8545927716437, -1109.2552715507125, -425.8592468595974, 140.47411966656077, -116.22323024087204, -4.664110876789426, 224.85853435166715, -140.31872332853055, -454.7271969905735, 40.0000000000003, 69.00432558275281, 19.11379559610113, -122.39068133547974, -55.482989057048584, -13.344623438469482, 111.59834691514584, 230.17913699677712, -254.25013255884284, 279.38846555046433, 347.68426747765557, -281.08985494400065, 274.87006351601485, 34.16099648628211, -207.8664035651469, -1070.1981511627625, -86.9552659317021, -224.43430576153355, -151.27375387136414, 50.64529976571668], "policy_predator_policy_reward": [337.0483799514387, 73.53742499717112, 13.780624387179481, 141.6064531316299, 147.7197165716534, 164.46950814399287, 212.38980628832354, 333.41495434827436, 33.20644511938814, 151.19554575770022, 1.8584145160060492, 72.02579555770538, 40.05782133200807, 138.52748015351764, 15.77505047700694, 60.112318022742265, 53.63118849140326, 145.75388773587244, 195.94059649492175, 309.3583657441994, 380.0128109887046, 31.428771701043285, 158.30750750736618, 650.0753336081115, 229.36845680458703, 9.439872639170066, 776.5436638705049, 164.0045644451754, 693.9040733680717, 450.63860649399504, 59.802497952841804, 274.03813492715216, 566.2380909485533, 26.713557940671283, 83.80186383591091, 871.7102419500567, 180.80520130278137, 168.38646676960295, 190.74526557241248, 53.47832465295042, 367.7795121383269, 3.309803272067328, 849.1312223834186, 592.6367804174654, 259.6545372029241, 532.9082612342854, 5.083026780103052, 228.65452175064235, 90.66038875418322, 437.7910885947967, 1201.3139861824884, 285.7354547263654, 703.3760084984169, 527.5479677916642, 46.2883017256211, 27.307551979501884, 331.1425396567839, 608.1103161557518, 105.2873589333791, 170.50102621529135, 16.640033138820733, 145.42965244867887, 17.10939165057108, 94.5977471145787, 606.1792376438211, 146.3568312157422, 13.868285405532765, 227.71486971328468, 228.14679894152917, 142.9418352521488, 68.47605095767999, 31.10121659385853, 236.53966683467956, 268.45832204565056, 184.5040897684402, 382.8414305259158, 350.8178933683069, 759.2281789167281, 61.3467955474047, 517.627782648987, 269.6094688520353, 283.93904580189417, 154.4446210252269, 158.31317897573734, 119.18597868542096, 3.1450354293659717, 629.3779175080175, 146.64651948764535, 43.600318930494616, 526.3810914557542, 98.88585516854667, 362.979781718057, 51.03707449922094, 89.22245449859193, 259.5111194342823, 150.00013754924586, 143.95177904158902, 62.72311357869411, 407.95107722011863, 440.1093970828608, 43.56356365473352, 159.66422089381396, 212.89584110651862, 35.43627513280725, 275.0951937881919, 966.0111229712992, 35.52941112160254, 110.23810200088718, 425.9647734786355, 351.5985959605212, 627.4182527386549, 351.4317344191379, 146.0602144755348, 78.30535410882989, 118.2385300822115, 352.3421577024121, 827.8167410311472, 193.08680473594572, 89.6555467503503, 24.928450038000555, 301.66058643506034, 135.39557432239616, 12.810663084822243, 317.826025103752, 273.1611873394925, 216.91814069563821, 539.9609590133023, 56.18065077115268, 172.99785276759786, 576.1220581093332, 615.089811945733, 140.17428440145125, 152.9202259540379, 904.0239235814091, 185.4532792932942, 29.231009025940327, 314.0035017884582, 31.783874705770433, 227.86113760827504, 858.7212686748252, 186.8395335887703, 2.039818037683087, 69.1377983629525, 1154.6468043010657, 219.62908529119161, 1001.4919981136549, 685.1514197167988, 33.58292450272485, 111.58245064101955, 404.1008798307951, 6.995246201056759, 603.9381619489068, 5.18222507743657, 228.9140099355509, 164.51174616657846, 76.11460008784368, 42.13112334353398, 68.55609327885139, 899.3659484648501, 101.0754757513701, 54.59839141330449, 153.00930107171982, 1004.2719122213422, 223.8063595827117, 36.458642687170425, 229.68656875810527, 4.653046663093655, 1205.6087140400416, 566.4425208122345, 749.8278002083647, 232.8208045455781, 59.695019937254095, 819.7809022785681, 1032.4048321260232, 120.69039298873844, 382.3646772935664, 124.61826149610168, 33.78731502902093, 796.1338170832131, 122.83761537630983, 61.318552151463834, 24.87712226578343, 23.916429449073135, 157.29068133547787, 92.18298905704711, 51.14462343846997, 131.2997944695702, 179.62272161850655, 494.4501325588429, 81.01153444953566, 18.119811650579248, 489.1857758157671, 3.2217313509487084, 86.64720864675454, 504.3038458205567, 950.4694115146076, 331.4586016631589, 107.07039172821715, 91.44529176943266, 191.6864966527883]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.480940433090222, "mean_inference_ms": 5.933928580966791, "mean_action_processing_ms": 2.6973582758861228, "mean_env_wait_ms": 12.453281768248905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010888814926147461, "StateBufferConnector_ms": 0.007061123847961426, "ViewRequirementAgentConnector_ms": 0.22102868556976318}, "num_episodes": 0, "episode_return_max": 750.1, "episode_return_min": 0.26232787653891076, "episode_return_mean": 317.3149324136283, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.54241565802609, "num_env_steps_trained_throughput_per_sec": 75.54241565802609, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 76752.922, "restore_workers_time_ms": 0.014, "training_step_time_ms": 76752.855, "sample_time_ms": 2624.806, "learn_time_ms": 74108.368, "learn_throughput": 53.975, "synch_weights_time_ms": 15.345}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "645a5_00000", "date": "2024-08-22_12-17-32", "timestamp": 1724309252, "time_this_iter_s": 53.00466871261597, "time_total_s": 1447.7877655029297, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a11f8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1447.7877655029297, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 29.56933333333333, "ram_util_percent": 83.33599999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.545964190253505, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.306632658035036, "policy_loss": -0.01750885495502088, "vf_loss": 5.321094135128001, "vf_explained_var": 0.34645909468332925, "kl": 0.015236864147569846, "entropy": 1.029890342490383, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.517569375826568, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.0779867993460766, "policy_loss": -0.022495641115875473, "vf_loss": 5.09750908102308, "vf_explained_var": 0.24608169964381627, "kl": 0.014866854997213791, "entropy": 1.2416439933751626, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 750.1, "episode_reward_min": 0.26232787653891076, "episode_reward_mean": 317.3149324136283, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1233.7585594142863, "predator_policy": 1.8584145160060492}, "policy_reward_max": {"prey_policy": 370.2517098544716, "predator_policy": 1205.6087140400416}, "policy_reward_mean": {"prey_policy": -113.9065242984112, "predator_policy": 272.56399050522543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.4955038806338, 502.9999999999994, 73.20000000000013, 284.65275116279787, 69.40000000000033, 134.09999999999624, 329.09999999999945, 422.3000000000032, 601.6000000000004, 371.2272750132408, 306.7207133417039, 234.44717094699263, 415.89999999999964, 400.6893998957706, 257.5588292288571, 591.204214907954, 202.0774645607411, 219.00511756790362, 388.34357888081183, 717.3, 215.6999999999975, 157.78691727324775, 157.69999999999914, 121.99999999999912, 516.3337664830932, 0.26232787653891076, 305.1335036985652, 750.1, 438.6359677253802, 365.3494363928666, 348.0000000000009, 725.8219916805243, 333.96899728294426, 579.4613868552924, 405.22064683707225, 629.6999999999999, 582.129826212637, 519.3675364359974, 107.29855962724514, 247.7999999999982, 325.72656692977796, 350.6520093630721, 174.39999999999984, 92.4088495753464, 391.4000000000024, 580.9017935956351, 402.50000000000205, 191.91965216876832, 653.9634292194986, 76.19642776068001, 348.03564739521823, 396.0095110674016, 285.0413167535561, 73.80000000000008, 364.61019768623385, 97.57738473056189, 189.59999999999863, 306.20749096949703, 119.14103845675359, 243.88522355981306, 87.76660749319618, 109.18615413522917, 312.9000000000003, 276.900000000002, 106.52822900218194, 372.50273282850844, 248.390169887389, 296.0999999999999, 347.20000000000226, 189.60965701007197, 607.9999999999995, 360.00179257428573, 122.49999999999864, 189.99999999999937, 352.49999999999966, 435.85293033741425, 71.00000000000024, 392.12528725060855, 154.30000000000007, 261.3217672343254, 358.4000000000012, 101.23356238169924, 78.36791930831077, 381.7533684627203, 176.76621070024018, 679.2330582461867, 317.0712159942801, 527.3059597079932, 378.6000000000023, 323.92551214041964, 195.19999999999962, 77.93022504517413, 74.50000000000004, 652.7000000000002, 600.6, 573.8999999999996, 398.90000000000225, 176.7087026072551, 127.13942169814095, 182.50333431657154], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-46.845948471160625, -3.2443525968149878, 213.4485548186942, 134.16436766249632, -213.81982209785144, -25.169402617795875, 28.886582189934714, -290.03859166373405, 5.29355488061206, -120.29554575770197, 82.9415854839931, -22.725795557705176, 234.14217866799208, -83.62748015351771, 263.2126315002507, 83.19999999999914, 292.86881150859676, 109.34611226412741, 142.86474912772266, -276.9364363536038, -213.70442495579744, 108.9835556077536, -552.1691511159975, -21.766519052485066, 87.93154319541298, 89.16012736082997, -474.48805479857185, -65.37077362133658, -543.2212350506562, -343.7626155825529, 63.87443747252127, 193.48914455543883, -349.04244795294716, -41.831736375533524, -299.4381247385706, -437.06886347949387, 174.43304316268487, -135.28113235426125, 360.39240776911186, 112.68400200552537, -12.817995096968538, -142.57132031342618, -1043.072018452996, -240.90906707464066, -671.2510469910574, 36.388248553848086, 33.27688161036323, -145.01443014110993, -5.4732796081758295, -6.644431257711176, -253.02855361802392, -1233.7585594142863, -622.3396933982416, -303.45077919327434, 320.71169827437893, 355.7924480204981, -124.308049627187, -376.30883845996794, -69.33792254051586, 158.89897378470874, 298.1599668611793, -112.22965244868072, 370.2517098544716, 243.86314306090296, -121.58621518023128, -296.9808563963844, 110.64415220601646, 227.23407953045833, 126.26885525345995, -92.13684261006637, 338.7566166341574, 191.36611581430418, 129.27460382612776, -52.142766493820716, -117.97945176190933, 70.00146790355137, -842.9316146798011, -159.8158979779885, -208.92944449016753, -122.24513370622594, -106.48364627368845, -121.3383014504625, -21.281040274485527, 59.17524963659281, -41.921184424222226, 93.99017030943494, -295.61478664304275, -388.00080077726284, 320.3996810695054, -498.9810914557497, 101.85629102996484, 17.179865679066268, 316.9629255007791, -54.72245449859316, -180.47372893245154, -37.11787588230648, 162.32838628820917, 284.96015031100643, -311.81775853335273, -460.046288008937, 38.646235268296145, 106.16162757837381, 118.10415889348138, 29.57323593459256, -225.72904710138587, -730.3359529045484, 2.5705888783976953, -74.5381020008892, -162.96652039527294, -249.9866513576521, -231.4375257425384, -649.835076684689, -75.09244752257013, 40.32687893820407, -158.69926582981725, -5.673930985309532, -285.6392825460849, -616.1232247642532, 97.10317146066821, 32.198055310795965, -131.40730068270338, -217.8822525815598, 29.275491050409407, -250.7260251037483, 7.4388126605074945, -184.61814069564005, -71.19451058503466, -248.04709919942192, -574.8279557727433, -67.76372610200268, -468.7557487895961, 85.99438527092302, -409.03863708759116, -399.51534256046705, 67.88969810275051, 13.526013578014885, -12.27406930819038, 13.68669281396221, -609.852543169854, -287.1202061031738, 315.3530038330927, 103.76764454045338, 287.16509449763294, -1150.9479045873654, -187.12908529119346, -911.4919981136549, -602.9514197167996, 74.21707549727536, -323.21071341670034, 160.02738294488464, -7.429652401331605, -167.65082541121987, 34.31777492256365, -197.41400993555263, -127.85460730207515, 279.3535482982578, -4.631123343533648, 48.2439067211489, -749.6619695587112, 10.542312576819455, 271.60160858669553, -120.80930107172159, -1141.2257840840396, 14.381074661686936, 37.347897022661314, -225.12518915962605, 332.75449829837186, -1161.2628905387876, -466.8881551024352, -672.6159552179223, 55.86264099171078, 330.8545927716437, -1109.2552715507125, -425.8592468595974, 140.47411966656077, -116.22323024087204, -4.664110876789426, 224.85853435166715, -140.31872332853055, -454.7271969905735, 40.0000000000003, 69.00432558275281, 19.11379559610113, -122.39068133547974, -55.482989057048584, -13.344623438469482, 111.59834691514584, 230.17913699677712, -254.25013255884284, 279.38846555046433, 347.68426747765557, -281.08985494400065, 274.87006351601485, 34.16099648628211, -207.8664035651469, -1070.1981511627625, -86.9552659317021, -224.43430576153355, -151.27375387136414, 50.64529976571668], "policy_predator_policy_reward": [337.0483799514387, 73.53742499717112, 13.780624387179481, 141.6064531316299, 147.7197165716534, 164.46950814399287, 212.38980628832354, 333.41495434827436, 33.20644511938814, 151.19554575770022, 1.8584145160060492, 72.02579555770538, 40.05782133200807, 138.52748015351764, 15.77505047700694, 60.112318022742265, 53.63118849140326, 145.75388773587244, 195.94059649492175, 309.3583657441994, 380.0128109887046, 31.428771701043285, 158.30750750736618, 650.0753336081115, 229.36845680458703, 9.439872639170066, 776.5436638705049, 164.0045644451754, 693.9040733680717, 450.63860649399504, 59.802497952841804, 274.03813492715216, 566.2380909485533, 26.713557940671283, 83.80186383591091, 871.7102419500567, 180.80520130278137, 168.38646676960295, 190.74526557241248, 53.47832465295042, 367.7795121383269, 3.309803272067328, 849.1312223834186, 592.6367804174654, 259.6545372029241, 532.9082612342854, 5.083026780103052, 228.65452175064235, 90.66038875418322, 437.7910885947967, 1201.3139861824884, 285.7354547263654, 703.3760084984169, 527.5479677916642, 46.2883017256211, 27.307551979501884, 331.1425396567839, 608.1103161557518, 105.2873589333791, 170.50102621529135, 16.640033138820733, 145.42965244867887, 17.10939165057108, 94.5977471145787, 606.1792376438211, 146.3568312157422, 13.868285405532765, 227.71486971328468, 228.14679894152917, 142.9418352521488, 68.47605095767999, 31.10121659385853, 236.53966683467956, 268.45832204565056, 184.5040897684402, 382.8414305259158, 350.8178933683069, 759.2281789167281, 61.3467955474047, 517.627782648987, 269.6094688520353, 283.93904580189417, 154.4446210252269, 158.31317897573734, 119.18597868542096, 3.1450354293659717, 629.3779175080175, 146.64651948764535, 43.600318930494616, 526.3810914557542, 98.88585516854667, 362.979781718057, 51.03707449922094, 89.22245449859193, 259.5111194342823, 150.00013754924586, 143.95177904158902, 62.72311357869411, 407.95107722011863, 440.1093970828608, 43.56356365473352, 159.66422089381396, 212.89584110651862, 35.43627513280725, 275.0951937881919, 966.0111229712992, 35.52941112160254, 110.23810200088718, 425.9647734786355, 351.5985959605212, 627.4182527386549, 351.4317344191379, 146.0602144755348, 78.30535410882989, 118.2385300822115, 352.3421577024121, 827.8167410311472, 193.08680473594572, 89.6555467503503, 24.928450038000555, 301.66058643506034, 135.39557432239616, 12.810663084822243, 317.826025103752, 273.1611873394925, 216.91814069563821, 539.9609590133023, 56.18065077115268, 172.99785276759786, 576.1220581093332, 615.089811945733, 140.17428440145125, 152.9202259540379, 904.0239235814091, 185.4532792932942, 29.231009025940327, 314.0035017884582, 31.783874705770433, 227.86113760827504, 858.7212686748252, 186.8395335887703, 2.039818037683087, 69.1377983629525, 1154.6468043010657, 219.62908529119161, 1001.4919981136549, 685.1514197167988, 33.58292450272485, 111.58245064101955, 404.1008798307951, 6.995246201056759, 603.9381619489068, 5.18222507743657, 228.9140099355509, 164.51174616657846, 76.11460008784368, 42.13112334353398, 68.55609327885139, 899.3659484648501, 101.0754757513701, 54.59839141330449, 153.00930107171982, 1004.2719122213422, 223.8063595827117, 36.458642687170425, 229.68656875810527, 4.653046663093655, 1205.6087140400416, 566.4425208122345, 749.8278002083647, 232.8208045455781, 59.695019937254095, 819.7809022785681, 1032.4048321260232, 120.69039298873844, 382.3646772935664, 124.61826149610168, 33.78731502902093, 796.1338170832131, 122.83761537630983, 61.318552151463834, 24.87712226578343, 23.916429449073135, 157.29068133547787, 92.18298905704711, 51.14462343846997, 131.2997944695702, 179.62272161850655, 494.4501325588429, 81.01153444953566, 18.119811650579248, 489.1857758157671, 3.2217313509487084, 86.64720864675454, 504.3038458205567, 950.4694115146076, 331.4586016631589, 107.07039172821715, 91.44529176943266, 191.6864966527883]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.480940433090222, "mean_inference_ms": 5.933928580966791, "mean_action_processing_ms": 2.6973582758861228, "mean_env_wait_ms": 12.453281768248905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010888814926147461, "StateBufferConnector_ms": 0.007061123847961426, "ViewRequirementAgentConnector_ms": 0.22102868556976318}, "num_episodes": 0, "episode_return_max": 750.1, "episode_return_min": 0.26232787653891076, "episode_return_mean": 317.3149324136283, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.2012761689502, "num_env_steps_trained_throughput_per_sec": 76.2012761689502, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 76490.44, "restore_workers_time_ms": 0.014, "training_step_time_ms": 76490.385, "sample_time_ms": 2609.032, "learn_time_ms": 73862.077, "learn_throughput": 54.155, "synch_weights_time_ms": 15.037}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "645a5_00000", "date": "2024-08-22_12-18-25", "timestamp": 1724309305, "time_this_iter_s": 52.50695872306824, "time_total_s": 1500.294724225998, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a14bee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1500.294724225998, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 29.383783783783784, "ram_util_percent": 83.2054054054054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.815002351841598, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.428030128453774, "policy_loss": -0.016807878546283714, "vf_loss": 4.4422267010603, "vf_explained_var": 0.3815328781566923, "kl": 0.013056577993409028, "entropy": 1.0552018814301365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.783019191342056, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.69055290852905, "policy_loss": -0.02784840293233554, "vf_loss": 4.715402827061043, "vf_explained_var": 0.22523595879948327, "kl": 0.014992379748740445, "entropy": 1.2194601241242948, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 750.1, "episode_reward_min": 0.26232787653891076, "episode_reward_mean": 312.00144117616946, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1233.7585594142863, "predator_policy": 1.8584145160060492}, "policy_reward_max": {"prey_policy": 370.2517098544716, "predator_policy": 1236.76699816763}, "policy_reward_mean": {"prey_policy": -130.4339870706346, "predator_policy": 286.4347076587195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [284.65275116279787, 69.40000000000033, 134.09999999999624, 329.09999999999945, 422.3000000000032, 601.6000000000004, 371.2272750132408, 306.7207133417039, 234.44717094699263, 415.89999999999964, 400.6893998957706, 257.5588292288571, 591.204214907954, 202.0774645607411, 219.00511756790362, 388.34357888081183, 717.3, 215.6999999999975, 157.78691727324775, 157.69999999999914, 121.99999999999912, 516.3337664830932, 0.26232787653891076, 305.1335036985652, 750.1, 438.6359677253802, 365.3494363928666, 348.0000000000009, 725.8219916805243, 333.96899728294426, 579.4613868552924, 405.22064683707225, 629.6999999999999, 582.129826212637, 519.3675364359974, 107.29855962724514, 247.7999999999982, 325.72656692977796, 350.6520093630721, 174.39999999999984, 92.4088495753464, 391.4000000000024, 580.9017935956351, 402.50000000000205, 191.91965216876832, 653.9634292194986, 76.19642776068001, 348.03564739521823, 396.0095110674016, 285.0413167535561, 73.80000000000008, 364.61019768623385, 97.57738473056189, 189.59999999999863, 306.20749096949703, 119.14103845675359, 243.88522355981306, 87.76660749319618, 109.18615413522917, 312.9000000000003, 276.900000000002, 106.52822900218194, 372.50273282850844, 248.390169887389, 296.0999999999999, 347.20000000000226, 189.60965701007197, 607.9999999999995, 360.00179257428573, 122.49999999999864, 189.99999999999937, 352.49999999999966, 435.85293033741425, 71.00000000000024, 392.12528725060855, 154.30000000000007, 261.3217672343254, 358.4000000000012, 101.23356238169924, 78.36791930831077, 381.7533684627203, 176.76621070024018, 679.2330582461867, 317.0712159942801, 527.3059597079932, 378.6000000000023, 323.92551214041964, 195.19999999999962, 77.93022504517413, 74.50000000000004, 652.7000000000002, 600.6, 573.8999999999996, 398.90000000000225, 176.7087026072551, 127.13942169814095, 182.50333431657154, 126.28534222217542, 192.294844275504, 86.76619363707258], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [28.886582189934714, -290.03859166373405, 5.29355488061206, -120.29554575770197, 82.9415854839931, -22.725795557705176, 234.14217866799208, -83.62748015351771, 263.2126315002507, 83.19999999999914, 292.86881150859676, 109.34611226412741, 142.86474912772266, -276.9364363536038, -213.70442495579744, 108.9835556077536, -552.1691511159975, -21.766519052485066, 87.93154319541298, 89.16012736082997, -474.48805479857185, -65.37077362133658, -543.2212350506562, -343.7626155825529, 63.87443747252127, 193.48914455543883, -349.04244795294716, -41.831736375533524, -299.4381247385706, -437.06886347949387, 174.43304316268487, -135.28113235426125, 360.39240776911186, 112.68400200552537, -12.817995096968538, -142.57132031342618, -1043.072018452996, -240.90906707464066, -671.2510469910574, 36.388248553848086, 33.27688161036323, -145.01443014110993, -5.4732796081758295, -6.644431257711176, -253.02855361802392, -1233.7585594142863, -622.3396933982416, -303.45077919327434, 320.71169827437893, 355.7924480204981, -124.308049627187, -376.30883845996794, -69.33792254051586, 158.89897378470874, 298.1599668611793, -112.22965244868072, 370.2517098544716, 243.86314306090296, -121.58621518023128, -296.9808563963844, 110.64415220601646, 227.23407953045833, 126.26885525345995, -92.13684261006637, 338.7566166341574, 191.36611581430418, 129.27460382612776, -52.142766493820716, -117.97945176190933, 70.00146790355137, -842.9316146798011, -159.8158979779885, -208.92944449016753, -122.24513370622594, -106.48364627368845, -121.3383014504625, -21.281040274485527, 59.17524963659281, -41.921184424222226, 93.99017030943494, -295.61478664304275, -388.00080077726284, 320.3996810695054, -498.9810914557497, 101.85629102996484, 17.179865679066268, 316.9629255007791, -54.72245449859316, -180.47372893245154, -37.11787588230648, 162.32838628820917, 284.96015031100643, -311.81775853335273, -460.046288008937, 38.646235268296145, 106.16162757837381, 118.10415889348138, 29.57323593459256, -225.72904710138587, -730.3359529045484, 2.5705888783976953, -74.5381020008892, -162.96652039527294, -249.9866513576521, -231.4375257425384, -649.835076684689, -75.09244752257013, 40.32687893820407, -158.69926582981725, -5.673930985309532, -285.6392825460849, -616.1232247642532, 97.10317146066821, 32.198055310795965, -131.40730068270338, -217.8822525815598, 29.275491050409407, -250.7260251037483, 7.4388126605074945, -184.61814069564005, -71.19451058503466, -248.04709919942192, -574.8279557727433, -67.76372610200268, -468.7557487895961, 85.99438527092302, -409.03863708759116, -399.51534256046705, 67.88969810275051, 13.526013578014885, -12.27406930819038, 13.68669281396221, -609.852543169854, -287.1202061031738, 315.3530038330927, 103.76764454045338, 287.16509449763294, -1150.9479045873654, -187.12908529119346, -911.4919981136549, -602.9514197167996, 74.21707549727536, -323.21071341670034, 160.02738294488464, -7.429652401331605, -167.65082541121987, 34.31777492256365, -197.41400993555263, -127.85460730207515, 279.3535482982578, -4.631123343533648, 48.2439067211489, -749.6619695587112, 10.542312576819455, 271.60160858669553, -120.80930107172159, -1141.2257840840396, 14.381074661686936, 37.347897022661314, -225.12518915962605, 332.75449829837186, -1161.2628905387876, -466.8881551024352, -672.6159552179223, 55.86264099171078, 330.8545927716437, -1109.2552715507125, -425.8592468595974, 140.47411966656077, -116.22323024087204, -4.664110876789426, 224.85853435166715, -140.31872332853055, -454.7271969905735, 40.0000000000003, 69.00432558275281, 19.11379559610113, -122.39068133547974, -55.482989057048584, -13.344623438469482, 111.59834691514584, 230.17913699677712, -254.25013255884284, 279.38846555046433, 347.68426747765557, -281.08985494400065, 274.87006351601485, 34.16099648628211, -207.8664035651469, -1070.1981511627625, -86.9552659317021, -224.43430576153355, -151.27375387136414, 50.64529976571668, -654.5130273003263, -1231.5591351732337, -905.512841622566, -66.07429274280818, 6.448115983473649, -395.74797689165547], "policy_predator_policy_reward": [212.38980628832354, 333.41495434827436, 33.20644511938814, 151.19554575770022, 1.8584145160060492, 72.02579555770538, 40.05782133200807, 138.52748015351764, 15.77505047700694, 60.112318022742265, 53.63118849140326, 145.75388773587244, 195.94059649492175, 309.3583657441994, 380.0128109887046, 31.428771701043285, 158.30750750736618, 650.0753336081115, 229.36845680458703, 9.439872639170066, 776.5436638705049, 164.0045644451754, 693.9040733680717, 450.63860649399504, 59.802497952841804, 274.03813492715216, 566.2380909485533, 26.713557940671283, 83.80186383591091, 871.7102419500567, 180.80520130278137, 168.38646676960295, 190.74526557241248, 53.47832465295042, 367.7795121383269, 3.309803272067328, 849.1312223834186, 592.6367804174654, 259.6545372029241, 532.9082612342854, 5.083026780103052, 228.65452175064235, 90.66038875418322, 437.7910885947967, 1201.3139861824884, 285.7354547263654, 703.3760084984169, 527.5479677916642, 46.2883017256211, 27.307551979501884, 331.1425396567839, 608.1103161557518, 105.2873589333791, 170.50102621529135, 16.640033138820733, 145.42965244867887, 17.10939165057108, 94.5977471145787, 606.1792376438211, 146.3568312157422, 13.868285405532765, 227.71486971328468, 228.14679894152917, 142.9418352521488, 68.47605095767999, 31.10121659385853, 236.53966683467956, 268.45832204565056, 184.5040897684402, 382.8414305259158, 350.8178933683069, 759.2281789167281, 61.3467955474047, 517.627782648987, 269.6094688520353, 283.93904580189417, 154.4446210252269, 158.31317897573734, 119.18597868542096, 3.1450354293659717, 629.3779175080175, 146.64651948764535, 43.600318930494616, 526.3810914557542, 98.88585516854667, 362.979781718057, 51.03707449922094, 89.22245449859193, 259.5111194342823, 150.00013754924586, 143.95177904158902, 62.72311357869411, 407.95107722011863, 440.1093970828608, 43.56356365473352, 159.66422089381396, 212.89584110651862, 35.43627513280725, 275.0951937881919, 966.0111229712992, 35.52941112160254, 110.23810200088718, 425.9647734786355, 351.5985959605212, 627.4182527386549, 351.4317344191379, 146.0602144755348, 78.30535410882989, 118.2385300822115, 352.3421577024121, 827.8167410311472, 193.08680473594572, 89.6555467503503, 24.928450038000555, 301.66058643506034, 135.39557432239616, 12.810663084822243, 317.826025103752, 273.1611873394925, 216.91814069563821, 539.9609590133023, 56.18065077115268, 172.99785276759786, 576.1220581093332, 615.089811945733, 140.17428440145125, 152.9202259540379, 904.0239235814091, 185.4532792932942, 29.231009025940327, 314.0035017884582, 31.783874705770433, 227.86113760827504, 858.7212686748252, 186.8395335887703, 2.039818037683087, 69.1377983629525, 1154.6468043010657, 219.62908529119161, 1001.4919981136549, 685.1514197167988, 33.58292450272485, 111.58245064101955, 404.1008798307951, 6.995246201056759, 603.9381619489068, 5.18222507743657, 228.9140099355509, 164.51174616657846, 76.11460008784368, 42.13112334353398, 68.55609327885139, 899.3659484648501, 101.0754757513701, 54.59839141330449, 153.00930107171982, 1004.2719122213422, 223.8063595827117, 36.458642687170425, 229.68656875810527, 4.653046663093655, 1205.6087140400416, 566.4425208122345, 749.8278002083647, 232.8208045455781, 59.695019937254095, 819.7809022785681, 1032.4048321260232, 120.69039298873844, 382.3646772935664, 124.61826149610168, 33.78731502902093, 796.1338170832131, 122.83761537630983, 61.318552151463834, 24.87712226578343, 23.916429449073135, 157.29068133547787, 92.18298905704711, 51.14462343846997, 131.2997944695702, 179.62272161850655, 494.4501325588429, 81.01153444953566, 18.119811650579248, 489.1857758157671, 3.2217313509487084, 86.64720864675454, 504.3038458205567, 950.4694115146076, 331.4586016631589, 107.07039172821715, 91.44529176943266, 191.6864966527883, 775.5905065281027, 1236.76699816763, 262.2118404725451, 901.6701381683351, 421.39156267671706, 54.67449186854429]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.469707807199125, "mean_inference_ms": 5.89211306698514, "mean_action_processing_ms": 2.6500231171278235, "mean_env_wait_ms": 12.42266923182052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01083827018737793, "StateBufferConnector_ms": 0.0070343017578125, "ViewRequirementAgentConnector_ms": 0.22069990634918213}, "num_episodes": 3, "episode_return_max": 750.1, "episode_return_min": 0.26232787653891076, "episode_return_mean": 312.00144117616946, "episodes_this_iter": 3}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.48209259386346, "num_env_steps_trained_throughput_per_sec": 76.48209259386346, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 76193.398, "restore_workers_time_ms": 0.014, "training_step_time_ms": 76193.342, "sample_time_ms": 2555.443, "learn_time_ms": 73618.222, "learn_throughput": 54.334, "synch_weights_time_ms": 15.489}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "645a5_00000", "date": "2024-08-22_12-19-17", "timestamp": 1724309357, "time_this_iter_s": 52.35554885864258, "time_total_s": 1552.6502730846405, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x15eec6f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1552.6502730846405, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 28.294594594594596, "ram_util_percent": 83.17432432432433}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.51354826613078, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.544624507868732, "policy_loss": -0.014558090128388906, "vf_loss": 4.556587970572174, "vf_explained_var": 0.38515942301699724, "kl": 0.012973137248415874, "entropy": 1.042212457379336, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.160787841788045, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.780604243026208, "policy_loss": -0.022769969651997877, "vf_loss": 4.800398030861345, "vf_explained_var": 0.272559497564558, "kl": 0.014880921679829795, "entropy": 1.239386139092622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 750.1, "episode_reward_min": 0.26232787653891076, "episode_reward_mean": 292.9581278722434, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1371.3390831789163, "predator_policy": 2.039818037683087}, "policy_reward_max": {"prey_policy": 370.2517098544716, "predator_policy": 1316.0502665952552}, "policy_reward_mean": {"prey_policy": -208.40258328233102, "predator_policy": 354.8816472184528}, "custom_metrics": {}, "hist_stats": {"episode_reward": [202.0774645607411, 219.00511756790362, 388.34357888081183, 717.3, 215.6999999999975, 157.78691727324775, 157.69999999999914, 121.99999999999912, 516.3337664830932, 0.26232787653891076, 305.1335036985652, 750.1, 438.6359677253802, 365.3494363928666, 348.0000000000009, 725.8219916805243, 333.96899728294426, 579.4613868552924, 405.22064683707225, 629.6999999999999, 582.129826212637, 519.3675364359974, 107.29855962724514, 247.7999999999982, 325.72656692977796, 350.6520093630721, 174.39999999999984, 92.4088495753464, 391.4000000000024, 580.9017935956351, 402.50000000000205, 191.91965216876832, 653.9634292194986, 76.19642776068001, 348.03564739521823, 396.0095110674016, 285.0413167535561, 73.80000000000008, 364.61019768623385, 97.57738473056189, 189.59999999999863, 306.20749096949703, 119.14103845675359, 243.88522355981306, 87.76660749319618, 109.18615413522917, 312.9000000000003, 276.900000000002, 106.52822900218194, 372.50273282850844, 248.390169887389, 296.0999999999999, 347.20000000000226, 189.60965701007197, 607.9999999999995, 360.00179257428573, 122.49999999999864, 189.99999999999937, 352.49999999999966, 435.85293033741425, 71.00000000000024, 392.12528725060855, 154.30000000000007, 261.3217672343254, 358.4000000000012, 101.23356238169924, 78.36791930831077, 381.7533684627203, 176.76621070024018, 679.2330582461867, 317.0712159942801, 527.3059597079932, 378.6000000000023, 323.92551214041964, 195.19999999999962, 77.93022504517413, 74.50000000000004, 652.7000000000002, 600.6, 573.8999999999996, 398.90000000000225, 176.7087026072551, 127.13942169814095, 182.50333431657154, 126.28534222217542, 192.294844275504, 86.76619363707258, 332.8350106478024, 17.37439209902231, 323.63371582178087, 134.2999445697544, 87.59457002641602, 25.003202122245916, 139.91381321548354, 229.68402176213922, 237.70226725663943, 428.68301781121386, 127.22731402718543, 311.1879791710056, 119.42977557401092], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-349.04244795294716, -41.831736375533524, -299.4381247385706, -437.06886347949387, 174.43304316268487, -135.28113235426125, 360.39240776911186, 112.68400200552537, -12.817995096968538, -142.57132031342618, -1043.072018452996, -240.90906707464066, -671.2510469910574, 36.388248553848086, 33.27688161036323, -145.01443014110993, -5.4732796081758295, -6.644431257711176, -253.02855361802392, -1233.7585594142863, -622.3396933982416, -303.45077919327434, 320.71169827437893, 355.7924480204981, -124.308049627187, -376.30883845996794, -69.33792254051586, 158.89897378470874, 298.1599668611793, -112.22965244868072, 370.2517098544716, 243.86314306090296, -121.58621518023128, -296.9808563963844, 110.64415220601646, 227.23407953045833, 126.26885525345995, -92.13684261006637, 338.7566166341574, 191.36611581430418, 129.27460382612776, -52.142766493820716, -117.97945176190933, 70.00146790355137, -842.9316146798011, -159.8158979779885, -208.92944449016753, -122.24513370622594, -106.48364627368845, -121.3383014504625, -21.281040274485527, 59.17524963659281, -41.921184424222226, 93.99017030943494, -295.61478664304275, -388.00080077726284, 320.3996810695054, -498.9810914557497, 101.85629102996484, 17.179865679066268, 316.9629255007791, -54.72245449859316, -180.47372893245154, -37.11787588230648, 162.32838628820917, 284.96015031100643, -311.81775853335273, -460.046288008937, 38.646235268296145, 106.16162757837381, 118.10415889348138, 29.57323593459256, -225.72904710138587, -730.3359529045484, 2.5705888783976953, -74.5381020008892, -162.96652039527294, -249.9866513576521, -231.4375257425384, -649.835076684689, -75.09244752257013, 40.32687893820407, -158.69926582981725, -5.673930985309532, -285.6392825460849, -616.1232247642532, 97.10317146066821, 32.198055310795965, -131.40730068270338, -217.8822525815598, 29.275491050409407, -250.7260251037483, 7.4388126605074945, -184.61814069564005, -71.19451058503466, -248.04709919942192, -574.8279557727433, -67.76372610200268, -468.7557487895961, 85.99438527092302, -409.03863708759116, -399.51534256046705, 67.88969810275051, 13.526013578014885, -12.27406930819038, 13.68669281396221, -609.852543169854, -287.1202061031738, 315.3530038330927, 103.76764454045338, 287.16509449763294, -1150.9479045873654, -187.12908529119346, -911.4919981136549, -602.9514197167996, 74.21707549727536, -323.21071341670034, 160.02738294488464, -7.429652401331605, -167.65082541121987, 34.31777492256365, -197.41400993555263, -127.85460730207515, 279.3535482982578, -4.631123343533648, 48.2439067211489, -749.6619695587112, 10.542312576819455, 271.60160858669553, -120.80930107172159, -1141.2257840840396, 14.381074661686936, 37.347897022661314, -225.12518915962605, 332.75449829837186, -1161.2628905387876, -466.8881551024352, -672.6159552179223, 55.86264099171078, 330.8545927716437, -1109.2552715507125, -425.8592468595974, 140.47411966656077, -116.22323024087204, -4.664110876789426, 224.85853435166715, -140.31872332853055, -454.7271969905735, 40.0000000000003, 69.00432558275281, 19.11379559610113, -122.39068133547974, -55.482989057048584, -13.344623438469482, 111.59834691514584, 230.17913699677712, -254.25013255884284, 279.38846555046433, 347.68426747765557, -281.08985494400065, 274.87006351601485, 34.16099648628211, -207.8664035651469, -1070.1981511627625, -86.9552659317021, -224.43430576153355, -151.27375387136414, 50.64529976571668, -654.5130273003263, -1231.5591351732337, -905.512841622566, -66.07429274280818, 6.448115983473649, -395.74797689165547, -694.6274884161876, -770.1388899080556, -810.6794363331643, -1078.768352791078, -531.8307612321826, -618.9049824373748, -259.52895566964315, -132.28926140963662, -94.85302356341235, -987.5992744249075, -235.2072893937638, -1319.752530525861, -542.1466322544408, -80.16389332578687, -1047.2479964949318, -463.8145017986088, 26.560407359413446, -1269.6214970556703, -1371.3390831789163, -11.839674195247287, -167.81047185058208, -1365.0308011399281, -931.1387408837309, -1005.814489996229, -142.70375943690007, -909.3394718309354], "policy_predator_policy_reward": [566.2380909485533, 26.713557940671283, 83.80186383591091, 871.7102419500567, 180.80520130278137, 168.38646676960295, 190.74526557241248, 53.47832465295042, 367.7795121383269, 3.309803272067328, 849.1312223834186, 592.6367804174654, 259.6545372029241, 532.9082612342854, 5.083026780103052, 228.65452175064235, 90.66038875418322, 437.7910885947967, 1201.3139861824884, 285.7354547263654, 703.3760084984169, 527.5479677916642, 46.2883017256211, 27.307551979501884, 331.1425396567839, 608.1103161557518, 105.2873589333791, 170.50102621529135, 16.640033138820733, 145.42965244867887, 17.10939165057108, 94.5977471145787, 606.1792376438211, 146.3568312157422, 13.868285405532765, 227.71486971328468, 228.14679894152917, 142.9418352521488, 68.47605095767999, 31.10121659385853, 236.53966683467956, 268.45832204565056, 184.5040897684402, 382.8414305259158, 350.8178933683069, 759.2281789167281, 61.3467955474047, 517.627782648987, 269.6094688520353, 283.93904580189417, 154.4446210252269, 158.31317897573734, 119.18597868542096, 3.1450354293659717, 629.3779175080175, 146.64651948764535, 43.600318930494616, 526.3810914557542, 98.88585516854667, 362.979781718057, 51.03707449922094, 89.22245449859193, 259.5111194342823, 150.00013754924586, 143.95177904158902, 62.72311357869411, 407.95107722011863, 440.1093970828608, 43.56356365473352, 159.66422089381396, 212.89584110651862, 35.43627513280725, 275.0951937881919, 966.0111229712992, 35.52941112160254, 110.23810200088718, 425.9647734786355, 351.5985959605212, 627.4182527386549, 351.4317344191379, 146.0602144755348, 78.30535410882989, 118.2385300822115, 352.3421577024121, 827.8167410311472, 193.08680473594572, 89.6555467503503, 24.928450038000555, 301.66058643506034, 135.39557432239616, 12.810663084822243, 317.826025103752, 273.1611873394925, 216.91814069563821, 539.9609590133023, 56.18065077115268, 172.99785276759786, 576.1220581093332, 615.089811945733, 140.17428440145125, 152.9202259540379, 904.0239235814091, 185.4532792932942, 29.231009025940327, 314.0035017884582, 31.783874705770433, 227.86113760827504, 858.7212686748252, 186.8395335887703, 2.039818037683087, 69.1377983629525, 1154.6468043010657, 219.62908529119161, 1001.4919981136549, 685.1514197167988, 33.58292450272485, 111.58245064101955, 404.1008798307951, 6.995246201056759, 603.9381619489068, 5.18222507743657, 228.9140099355509, 164.51174616657846, 76.11460008784368, 42.13112334353398, 68.55609327885139, 899.3659484648501, 101.0754757513701, 54.59839141330449, 153.00930107171982, 1004.2719122213422, 223.8063595827117, 36.458642687170425, 229.68656875810527, 4.653046663093655, 1205.6087140400416, 566.4425208122345, 749.8278002083647, 232.8208045455781, 59.695019937254095, 819.7809022785681, 1032.4048321260232, 120.69039298873844, 382.3646772935664, 124.61826149610168, 33.78731502902093, 796.1338170832131, 122.83761537630983, 61.318552151463834, 24.87712226578343, 23.916429449073135, 157.29068133547787, 92.18298905704711, 51.14462343846997, 131.2997944695702, 179.62272161850655, 494.4501325588429, 81.01153444953566, 18.119811650579248, 489.1857758157671, 3.2217313509487084, 86.64720864675454, 504.3038458205567, 950.4694115146076, 331.4586016631589, 107.07039172821715, 91.44529176943266, 191.6864966527883, 775.5905065281027, 1236.76699816763, 262.2118404725451, 901.6701381683351, 421.39156267671706, 54.67449186854429, 1088.400631918437, 709.20075705361, 821.5462011664251, 1085.27598005684, 865.8057339428734, 608.5637255484662, 400.81008566937965, 125.30807597966088, 955.4184601154391, 214.62840789929783, 418.64222812292843, 1161.3207939189388, 510.20849525662084, 252.01584353909672, 820.3184346536309, 920.428085402054, 241.06415523304952, 1239.6992017198443, 886.6097040584315, 925.2520711269333, 1264.6405138612602, 395.4280731564355, 1316.0502665952552, 932.0909434557117, 262.67770466391795, 908.7953021779268]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.401355537069146, "mean_inference_ms": 5.84267728239559, "mean_action_processing_ms": 2.498821308019749, "mean_env_wait_ms": 12.367761512585941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010723114013671875, "StateBufferConnector_ms": 0.004666686058044434, "ViewRequirementAgentConnector_ms": 0.20997953414916992}, "num_episodes": 13, "episode_return_max": 750.1, "episode_return_min": 0.26232787653891076, "episode_return_mean": 292.9581278722434, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.79467927117567, "num_env_steps_trained_throughput_per_sec": 75.79467927117567, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 75928.658, "restore_workers_time_ms": 0.014, "training_step_time_ms": 75928.602, "sample_time_ms": 2531.265, "learn_time_ms": 73377.659, "learn_throughput": 54.513, "synch_weights_time_ms": 15.646}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "645a5_00000", "date": "2024-08-22_12-20-10", "timestamp": 1724309410, "time_this_iter_s": 52.81908822059631, "time_total_s": 1605.4693613052368, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a136280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1605.4693613052368, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 29.266666666666666, "ram_util_percent": 82.99466666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.881276890146669, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.156241507757278, "policy_loss": -0.01575903794654305, "vf_loss": 5.169278646650769, "vf_explained_var": 0.3950420754927176, "kl": 0.013609458514237924, "entropy": 0.9609195322271378, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.878730635132109, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.379616103727351, "policy_loss": -0.01902272178786536, "vf_loss": 5.395941888087641, "vf_explained_var": 0.1551472402123547, "kl": 0.013484641173657365, "entropy": 1.2124949124124316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 679.2330582461867, "episode_reward_min": 17.37439209902231, "episode_reward_mean": 257.88813280138555, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1381.1197660336977, "predator_policy": 0.8813419862421855}, "policy_reward_max": {"prey_policy": 347.68426747765557, "predator_policy": 1316.0502665952552}, "policy_reward_mean": {"prey_policy": -253.30661307991235, "predator_policy": 382.2506794806055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [579.4613868552924, 405.22064683707225, 629.6999999999999, 582.129826212637, 519.3675364359974, 107.29855962724514, 247.7999999999982, 325.72656692977796, 350.6520093630721, 174.39999999999984, 92.4088495753464, 391.4000000000024, 580.9017935956351, 402.50000000000205, 191.91965216876832, 653.9634292194986, 76.19642776068001, 348.03564739521823, 396.0095110674016, 285.0413167535561, 73.80000000000008, 364.61019768623385, 97.57738473056189, 189.59999999999863, 306.20749096949703, 119.14103845675359, 243.88522355981306, 87.76660749319618, 109.18615413522917, 312.9000000000003, 276.900000000002, 106.52822900218194, 372.50273282850844, 248.390169887389, 296.0999999999999, 347.20000000000226, 189.60965701007197, 607.9999999999995, 360.00179257428573, 122.49999999999864, 189.99999999999937, 352.49999999999966, 435.85293033741425, 71.00000000000024, 392.12528725060855, 154.30000000000007, 261.3217672343254, 358.4000000000012, 101.23356238169924, 78.36791930831077, 381.7533684627203, 176.76621070024018, 679.2330582461867, 317.0712159942801, 527.3059597079932, 378.6000000000023, 323.92551214041964, 195.19999999999962, 77.93022504517413, 74.50000000000004, 652.7000000000002, 600.6, 573.8999999999996, 398.90000000000225, 176.7087026072551, 127.13942169814095, 182.50333431657154, 126.28534222217542, 192.294844275504, 86.76619363707258, 332.8350106478024, 17.37439209902231, 323.63371582178087, 134.2999445697544, 87.59457002641602, 25.003202122245916, 139.91381321548354, 229.68402176213922, 237.70226725663943, 428.68301781121386, 127.22731402718543, 311.1879791710056, 119.42977557401092, 81.31232341090062, 193.79436315206712, 48.755116076658446, 166.1710112345241, 71.50448348012094, 382.20000000000255, 81.36416793455474, 304.4563384189125, 114.38860125904553, 319.8540126716582, 106.46729717305206, 155.32257219229493, 69.80000000000031, 103.93292182437986, 166.6963535086562, 55.60000000000052, 34.90000000000022], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [110.64415220601646, 227.23407953045833, 126.26885525345995, -92.13684261006637, 338.7566166341574, 191.36611581430418, 129.27460382612776, -52.142766493820716, -117.97945176190933, 70.00146790355137, -842.9316146798011, -159.8158979779885, -208.92944449016753, -122.24513370622594, -106.48364627368845, -121.3383014504625, -21.281040274485527, 59.17524963659281, -41.921184424222226, 93.99017030943494, -295.61478664304275, -388.00080077726284, 320.3996810695054, -498.9810914557497, 101.85629102996484, 17.179865679066268, 316.9629255007791, -54.72245449859316, -180.47372893245154, -37.11787588230648, 162.32838628820917, 284.96015031100643, -311.81775853335273, -460.046288008937, 38.646235268296145, 106.16162757837381, 118.10415889348138, 29.57323593459256, -225.72904710138587, -730.3359529045484, 2.5705888783976953, -74.5381020008892, -162.96652039527294, -249.9866513576521, -231.4375257425384, -649.835076684689, -75.09244752257013, 40.32687893820407, -158.69926582981725, -5.673930985309532, -285.6392825460849, -616.1232247642532, 97.10317146066821, 32.198055310795965, -131.40730068270338, -217.8822525815598, 29.275491050409407, -250.7260251037483, 7.4388126605074945, -184.61814069564005, -71.19451058503466, -248.04709919942192, -574.8279557727433, -67.76372610200268, -468.7557487895961, 85.99438527092302, -409.03863708759116, -399.51534256046705, 67.88969810275051, 13.526013578014885, -12.27406930819038, 13.68669281396221, -609.852543169854, -287.1202061031738, 315.3530038330927, 103.76764454045338, 287.16509449763294, -1150.9479045873654, -187.12908529119346, -911.4919981136549, -602.9514197167996, 74.21707549727536, -323.21071341670034, 160.02738294488464, -7.429652401331605, -167.65082541121987, 34.31777492256365, -197.41400993555263, -127.85460730207515, 279.3535482982578, -4.631123343533648, 48.2439067211489, -749.6619695587112, 10.542312576819455, 271.60160858669553, -120.80930107172159, -1141.2257840840396, 14.381074661686936, 37.347897022661314, -225.12518915962605, 332.75449829837186, -1161.2628905387876, -466.8881551024352, -672.6159552179223, 55.86264099171078, 330.8545927716437, -1109.2552715507125, -425.8592468595974, 140.47411966656077, -116.22323024087204, -4.664110876789426, 224.85853435166715, -140.31872332853055, -454.7271969905735, 40.0000000000003, 69.00432558275281, 19.11379559610113, -122.39068133547974, -55.482989057048584, -13.344623438469482, 111.59834691514584, 230.17913699677712, -254.25013255884284, 279.38846555046433, 347.68426747765557, -281.08985494400065, 274.87006351601485, 34.16099648628211, -207.8664035651469, -1070.1981511627625, -86.9552659317021, -224.43430576153355, -151.27375387136414, 50.64529976571668, -654.5130273003263, -1231.5591351732337, -905.512841622566, -66.07429274280818, 6.448115983473649, -395.74797689165547, -694.6274884161876, -770.1388899080556, -810.6794363331643, -1078.768352791078, -531.8307612321826, -618.9049824373748, -259.52895566964315, -132.28926140963662, -94.85302356341235, -987.5992744249075, -235.2072893937638, -1319.752530525861, -542.1466322544408, -80.16389332578687, -1047.2479964949318, -463.8145017986088, 26.560407359413446, -1269.6214970556703, -1371.3390831789163, -11.839674195247287, -167.81047185058208, -1365.0308011399281, -931.1387408837309, -1005.814489996229, -142.70375943690007, -909.3394718309354, 40.0000000000003, -172.70202115979592, -410.16258060382427, -509.7826119510322, -351.98021485145927, -305.48956627385417, -707.1725353404624, -93.03997370786779, -575.0448697591185, -826.4208348745464, -441.47521988176595, 246.7745652702019, -218.5276981468463, 26.11438343851167, -381.70352042475815, -1381.1197660336977, -270.3011193580531, -631.2006130984058, -1022.4973026125515, -464.5850801397325, -579.7696591121111, -60.86931725458629, -759.1982923200027, -572.5818512742752, -21.398961721839527, -204.1098571029404, -52.1463548277005, -379.8019241263629, 42.97088809615789, -531.1010128937328, -593.2078063068551, -20.263781995861436, -797.437636554596, -580.4663037685133], "policy_predator_policy_reward": [13.868285405532765, 227.71486971328468, 228.14679894152917, 142.9418352521488, 68.47605095767999, 31.10121659385853, 236.53966683467956, 268.45832204565056, 184.5040897684402, 382.8414305259158, 350.8178933683069, 759.2281789167281, 61.3467955474047, 517.627782648987, 269.6094688520353, 283.93904580189417, 154.4446210252269, 158.31317897573734, 119.18597868542096, 3.1450354293659717, 629.3779175080175, 146.64651948764535, 43.600318930494616, 526.3810914557542, 98.88585516854667, 362.979781718057, 51.03707449922094, 89.22245449859193, 259.5111194342823, 150.00013754924586, 143.95177904158902, 62.72311357869411, 407.95107722011863, 440.1093970828608, 43.56356365473352, 159.66422089381396, 212.89584110651862, 35.43627513280725, 275.0951937881919, 966.0111229712992, 35.52941112160254, 110.23810200088718, 425.9647734786355, 351.5985959605212, 627.4182527386549, 351.4317344191379, 146.0602144755348, 78.30535410882989, 118.2385300822115, 352.3421577024121, 827.8167410311472, 193.08680473594572, 89.6555467503503, 24.928450038000555, 301.66058643506034, 135.39557432239616, 12.810663084822243, 317.826025103752, 273.1611873394925, 216.91814069563821, 539.9609590133023, 56.18065077115268, 172.99785276759786, 576.1220581093332, 615.089811945733, 140.17428440145125, 152.9202259540379, 904.0239235814091, 185.4532792932942, 29.231009025940327, 314.0035017884582, 31.783874705770433, 227.86113760827504, 858.7212686748252, 186.8395335887703, 2.039818037683087, 69.1377983629525, 1154.6468043010657, 219.62908529119161, 1001.4919981136549, 685.1514197167988, 33.58292450272485, 111.58245064101955, 404.1008798307951, 6.995246201056759, 603.9381619489068, 5.18222507743657, 228.9140099355509, 164.51174616657846, 76.11460008784368, 42.13112334353398, 68.55609327885139, 899.3659484648501, 101.0754757513701, 54.59839141330449, 153.00930107171982, 1004.2719122213422, 223.8063595827117, 36.458642687170425, 229.68656875810527, 4.653046663093655, 1205.6087140400416, 566.4425208122345, 749.8278002083647, 232.8208045455781, 59.695019937254095, 819.7809022785681, 1032.4048321260232, 120.69039298873844, 382.3646772935664, 124.61826149610168, 33.78731502902093, 796.1338170832131, 122.83761537630983, 61.318552151463834, 24.87712226578343, 23.916429449073135, 157.29068133547787, 92.18298905704711, 51.14462343846997, 131.2997944695702, 179.62272161850655, 494.4501325588429, 81.01153444953566, 18.119811650579248, 489.1857758157671, 3.2217313509487084, 86.64720864675454, 504.3038458205567, 950.4694115146076, 331.4586016631589, 107.07039172821715, 91.44529176943266, 191.6864966527883, 775.5905065281027, 1236.76699816763, 262.2118404725451, 901.6701381683351, 421.39156267671706, 54.67449186854429, 1088.400631918437, 709.20075705361, 821.5462011664251, 1085.27598005684, 865.8057339428734, 608.5637255484662, 400.81008566937965, 125.30807597966088, 955.4184601154391, 214.62840789929783, 418.64222812292843, 1161.3207939189388, 510.20849525662084, 252.01584353909672, 820.3184346536309, 920.428085402054, 241.06415523304952, 1239.6992017198443, 886.6097040584315, 925.2520711269333, 1264.6405138612602, 395.4280731564355, 1316.0502665952552, 932.0909434557117, 262.67770466391795, 908.7953021779268, 9.112323410900942, 204.9020211597941, 369.9423939471573, 743.7971617597782, 35.6647637706229, 670.5601334313544, 724.9725353404665, 241.41098494239202, 777.2764230310833, 695.6937650827085, 571.3167908250989, 5.583863786471815, 252.0276981468444, 21.749784496043475, 1282.8925805782817, 784.3870442990878, 1015.0089917292632, 0.8813419862421855, 827.2029449043032, 979.7334505196449, 531.9776718754175, 215.12860166433705, 1046.4460389403976, 440.65667684617824, 58.398961721840045, 236.9098571029386, 130.5258375639787, 405.3553632144641, 37.61457095299477, 617.2119073532418, 613.5078063068595, 55.56378199586192, 814.1376365545998, 598.6663037685174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.302223014215502, "mean_inference_ms": 5.780082707839585, "mean_action_processing_ms": 2.442970866499817, "mean_env_wait_ms": 12.391177592160625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010637402534484863, "StateBufferConnector_ms": 0.005025029182434082, "ViewRequirementAgentConnector_ms": 0.19295620918273926}, "num_episodes": 17, "episode_return_max": 679.2330582461867, "episode_return_min": 17.37439209902231, "episode_return_mean": 257.88813280138555, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.65078792427317, "num_env_steps_trained_throughput_per_sec": 76.65078792427317, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 75586.864, "restore_workers_time_ms": 0.014, "training_step_time_ms": 75586.808, "sample_time_ms": 2496.592, "learn_time_ms": 73070.406, "learn_throughput": 54.742, "synch_weights_time_ms": 15.791}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "645a5_00000", "date": "2024-08-22_12-21-02", "timestamp": 1724309462, "time_this_iter_s": 52.23304224014282, "time_total_s": 1657.7024035453796, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a11c310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1657.7024035453796, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 27.856164383561648, "ram_util_percent": 82.97808219178081}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.517581769272134, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.877965163932275, "policy_loss": -0.012569503617724256, "vf_loss": 5.888131933111362, "vf_explained_var": 0.38379943172136943, "kl": 0.012013666353696, "entropy": 0.8981556064868099, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.778754475697008, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.868895154276853, "policy_loss": -0.023675149595414204, "vf_loss": 5.889721264662566, "vf_explained_var": 0.15737167565280166, "kl": 0.014245271538359621, "entropy": 1.18356597518164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 679.2330582461867, "episode_reward_min": 13.737228333652865, "episode_reward_mean": 229.97499851225032, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1565.246372354459, "predator_policy": 0.8813419862421855}, "policy_reward_max": {"prey_policy": 347.68426747765557, "predator_policy": 1316.0502665952552}, "policy_reward_mean": {"prey_policy": -318.18941798942615, "predator_policy": 433.17691724555186}, "custom_metrics": {}, "hist_stats": {"episode_reward": [402.50000000000205, 191.91965216876832, 653.9634292194986, 76.19642776068001, 348.03564739521823, 396.0095110674016, 285.0413167535561, 73.80000000000008, 364.61019768623385, 97.57738473056189, 189.59999999999863, 306.20749096949703, 119.14103845675359, 243.88522355981306, 87.76660749319618, 109.18615413522917, 312.9000000000003, 276.900000000002, 106.52822900218194, 372.50273282850844, 248.390169887389, 296.0999999999999, 347.20000000000226, 189.60965701007197, 607.9999999999995, 360.00179257428573, 122.49999999999864, 189.99999999999937, 352.49999999999966, 435.85293033741425, 71.00000000000024, 392.12528725060855, 154.30000000000007, 261.3217672343254, 358.4000000000012, 101.23356238169924, 78.36791930831077, 381.7533684627203, 176.76621070024018, 679.2330582461867, 317.0712159942801, 527.3059597079932, 378.6000000000023, 323.92551214041964, 195.19999999999962, 77.93022504517413, 74.50000000000004, 652.7000000000002, 600.6, 573.8999999999996, 398.90000000000225, 176.7087026072551, 127.13942169814095, 182.50333431657154, 126.28534222217542, 192.294844275504, 86.76619363707258, 332.8350106478024, 17.37439209902231, 323.63371582178087, 134.2999445697544, 87.59457002641602, 25.003202122245916, 139.91381321548354, 229.68402176213922, 237.70226725663943, 428.68301781121386, 127.22731402718543, 311.1879791710056, 119.42977557401092, 81.31232341090062, 193.79436315206712, 48.755116076658446, 166.1710112345241, 71.50448348012094, 382.20000000000255, 81.36416793455474, 304.4563384189125, 114.38860125904553, 319.8540126716582, 106.46729717305206, 155.32257219229493, 69.80000000000031, 103.93292182437986, 166.6963535086562, 55.60000000000052, 34.90000000000022, 209.2696945150931, 119.35732884675605, 483.4943855319823, 343.0561000754564, 138.84896704371312, 169.63929016154015, 13.737228333652865, 45.115246099692634, 120.44286038259496, 76.59999999999968, 63.42803351534569, 274.54986081690026, 137.6147511958341], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [316.9629255007791, -54.72245449859316, -180.47372893245154, -37.11787588230648, 162.32838628820917, 284.96015031100643, -311.81775853335273, -460.046288008937, 38.646235268296145, 106.16162757837381, 118.10415889348138, 29.57323593459256, -225.72904710138587, -730.3359529045484, 2.5705888783976953, -74.5381020008892, -162.96652039527294, -249.9866513576521, -231.4375257425384, -649.835076684689, -75.09244752257013, 40.32687893820407, -158.69926582981725, -5.673930985309532, -285.6392825460849, -616.1232247642532, 97.10317146066821, 32.198055310795965, -131.40730068270338, -217.8822525815598, 29.275491050409407, -250.7260251037483, 7.4388126605074945, -184.61814069564005, -71.19451058503466, -248.04709919942192, -574.8279557727433, -67.76372610200268, -468.7557487895961, 85.99438527092302, -409.03863708759116, -399.51534256046705, 67.88969810275051, 13.526013578014885, -12.27406930819038, 13.68669281396221, -609.852543169854, -287.1202061031738, 315.3530038330927, 103.76764454045338, 287.16509449763294, -1150.9479045873654, -187.12908529119346, -911.4919981136549, -602.9514197167996, 74.21707549727536, -323.21071341670034, 160.02738294488464, -7.429652401331605, -167.65082541121987, 34.31777492256365, -197.41400993555263, -127.85460730207515, 279.3535482982578, -4.631123343533648, 48.2439067211489, -749.6619695587112, 10.542312576819455, 271.60160858669553, -120.80930107172159, -1141.2257840840396, 14.381074661686936, 37.347897022661314, -225.12518915962605, 332.75449829837186, -1161.2628905387876, -466.8881551024352, -672.6159552179223, 55.86264099171078, 330.8545927716437, -1109.2552715507125, -425.8592468595974, 140.47411966656077, -116.22323024087204, -4.664110876789426, 224.85853435166715, -140.31872332853055, -454.7271969905735, 40.0000000000003, 69.00432558275281, 19.11379559610113, -122.39068133547974, -55.482989057048584, -13.344623438469482, 111.59834691514584, 230.17913699677712, -254.25013255884284, 279.38846555046433, 347.68426747765557, -281.08985494400065, 274.87006351601485, 34.16099648628211, -207.8664035651469, -1070.1981511627625, -86.9552659317021, -224.43430576153355, -151.27375387136414, 50.64529976571668, -654.5130273003263, -1231.5591351732337, -905.512841622566, -66.07429274280818, 6.448115983473649, -395.74797689165547, -694.6274884161876, -770.1388899080556, -810.6794363331643, -1078.768352791078, -531.8307612321826, -618.9049824373748, -259.52895566964315, -132.28926140963662, -94.85302356341235, -987.5992744249075, -235.2072893937638, -1319.752530525861, -542.1466322544408, -80.16389332578687, -1047.2479964949318, -463.8145017986088, 26.560407359413446, -1269.6214970556703, -1371.3390831789163, -11.839674195247287, -167.81047185058208, -1365.0308011399281, -931.1387408837309, -1005.814489996229, -142.70375943690007, -909.3394718309354, 40.0000000000003, -172.70202115979592, -410.16258060382427, -509.7826119510322, -351.98021485145927, -305.48956627385417, -707.1725353404624, -93.03997370786779, -575.0448697591185, -826.4208348745464, -441.47521988176595, 246.7745652702019, -218.5276981468463, 26.11438343851167, -381.70352042475815, -1381.1197660336977, -270.3011193580531, -631.2006130984058, -1022.4973026125515, -464.5850801397325, -579.7696591121111, -60.86931725458629, -759.1982923200027, -572.5818512742752, -21.398961721839527, -204.1098571029404, -52.1463548277005, -379.8019241263629, 42.97088809615789, -531.1010128937328, -593.2078063068551, -20.263781995861436, -797.437636554596, -580.4663037685133, -762.8959736139266, -846.4960528833622, -1565.246372354459, -230.86423057721674, 105.6102096731183, 261.77832082378944, 101.70147774930103, -781.6336163687497, 0.4839449758062696, -756.4173894100176, -988.9383666340655, -524.1013589877927, -594.4977819016636, -370.10391926960807, -403.989791431679, -936.0104122370366, -441.8994459659178, -1016.1956255652033, 20.578764538750494, -745.2391706002868, -684.2123288537074, -675.4490514891563, -105.93945996382871, -1144.6511973922459, -85.66266401938209, -1089.9243442704733], "policy_predator_policy_reward": [51.03707449922094, 89.22245449859193, 259.5111194342823, 150.00013754924586, 143.95177904158902, 62.72311357869411, 407.95107722011863, 440.1093970828608, 43.56356365473352, 159.66422089381396, 212.89584110651862, 35.43627513280725, 275.0951937881919, 966.0111229712992, 35.52941112160254, 110.23810200088718, 425.9647734786355, 351.5985959605212, 627.4182527386549, 351.4317344191379, 146.0602144755348, 78.30535410882989, 118.2385300822115, 352.3421577024121, 827.8167410311472, 193.08680473594572, 89.6555467503503, 24.928450038000555, 301.66058643506034, 135.39557432239616, 12.810663084822243, 317.826025103752, 273.1611873394925, 216.91814069563821, 539.9609590133023, 56.18065077115268, 172.99785276759786, 576.1220581093332, 615.089811945733, 140.17428440145125, 152.9202259540379, 904.0239235814091, 185.4532792932942, 29.231009025940327, 314.0035017884582, 31.783874705770433, 227.86113760827504, 858.7212686748252, 186.8395335887703, 2.039818037683087, 69.1377983629525, 1154.6468043010657, 219.62908529119161, 1001.4919981136549, 685.1514197167988, 33.58292450272485, 111.58245064101955, 404.1008798307951, 6.995246201056759, 603.9381619489068, 5.18222507743657, 228.9140099355509, 164.51174616657846, 76.11460008784368, 42.13112334353398, 68.55609327885139, 899.3659484648501, 101.0754757513701, 54.59839141330449, 153.00930107171982, 1004.2719122213422, 223.8063595827117, 36.458642687170425, 229.68656875810527, 4.653046663093655, 1205.6087140400416, 566.4425208122345, 749.8278002083647, 232.8208045455781, 59.695019937254095, 819.7809022785681, 1032.4048321260232, 120.69039298873844, 382.3646772935664, 124.61826149610168, 33.78731502902093, 796.1338170832131, 122.83761537630983, 61.318552151463834, 24.87712226578343, 23.916429449073135, 157.29068133547787, 92.18298905704711, 51.14462343846997, 131.2997944695702, 179.62272161850655, 494.4501325588429, 81.01153444953566, 18.119811650579248, 489.1857758157671, 3.2217313509487084, 86.64720864675454, 504.3038458205567, 950.4694115146076, 331.4586016631589, 107.07039172821715, 91.44529176943266, 191.6864966527883, 775.5905065281027, 1236.76699816763, 262.2118404725451, 901.6701381683351, 421.39156267671706, 54.67449186854429, 1088.400631918437, 709.20075705361, 821.5462011664251, 1085.27598005684, 865.8057339428734, 608.5637255484662, 400.81008566937965, 125.30807597966088, 955.4184601154391, 214.62840789929783, 418.64222812292843, 1161.3207939189388, 510.20849525662084, 252.01584353909672, 820.3184346536309, 920.428085402054, 241.06415523304952, 1239.6992017198443, 886.6097040584315, 925.2520711269333, 1264.6405138612602, 395.4280731564355, 1316.0502665952552, 932.0909434557117, 262.67770466391795, 908.7953021779268, 9.112323410900942, 204.9020211597941, 369.9423939471573, 743.7971617597782, 35.6647637706229, 670.5601334313544, 724.9725353404665, 241.41098494239202, 777.2764230310833, 695.6937650827085, 571.3167908250989, 5.583863786471815, 252.0276981468444, 21.749784496043475, 1282.8925805782817, 784.3870442990878, 1015.0089917292632, 0.8813419862421855, 827.2029449043032, 979.7334505196449, 531.9776718754175, 215.12860166433705, 1046.4460389403976, 440.65667684617824, 58.398961721840045, 236.9098571029386, 130.5258375639787, 405.3553632144641, 37.61457095299477, 617.2119073532418, 613.5078063068595, 55.56378199586192, 814.1376365545998, 598.6663037685174, 971.1571063561757, 847.5046146562091, 680.1212938482464, 1235.346637930187, 46.07405402455705, 70.03180101051169, 2.91061355533125, 1020.0776251395746, 228.6767782515146, 666.1056332264158, 936.4097694144998, 746.2692463689083, 312.9012520791114, 665.4376774258213, 427.4398109777563, 957.6756387906522, 835.1321936504979, 743.405738263225, 758.0755506738377, 43.18485538769881, 502.0139813220137, 921.0754325362024, 978.027790349466, 547.1127278235119, 235.67050027248956, 1077.531259213198]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.257370170661589, "mean_inference_ms": 5.765272350726571, "mean_action_processing_ms": 2.3715289955427927, "mean_env_wait_ms": 12.389219011162345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010535240173339844, "StateBufferConnector_ms": 0.005041837692260742, "ViewRequirementAgentConnector_ms": 0.18981492519378662}, "num_episodes": 13, "episode_return_max": 679.2330582461867, "episode_return_min": 13.737228333652865, "episode_return_mean": 229.97499851225032, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.0616303538224, "num_env_steps_trained_throughput_per_sec": 76.0616303538224, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 75344.765, "restore_workers_time_ms": 0.014, "training_step_time_ms": 75344.709, "sample_time_ms": 2471.271, "learn_time_ms": 72854.206, "learn_throughput": 54.904, "synch_weights_time_ms": 15.883}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "645a5_00000", "date": "2024-08-22_12-21-55", "timestamp": 1724309515, "time_this_iter_s": 52.64606714248657, "time_total_s": 1710.3484706878662, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x15eec6f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1710.3484706878662, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 28.894666666666666, "ram_util_percent": 82.87333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.996174193311621, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.339244901566278, "policy_loss": -0.014638481172117055, "vf_loss": 6.351255103519985, "vf_explained_var": 0.38567733957023215, "kl": 0.01314129939465414, "entropy": 0.861866741710239, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.168850269172557, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.249133646929706, "policy_loss": -0.021264038380807038, "vf_loss": 6.267893878492729, "vf_explained_var": 0.1648454660145694, "kl": 0.012518917106180673, "entropy": 1.1983660496101178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 679.2330582461867, "episode_reward_min": -23.517792898195182, "episode_reward_mean": 199.4885593014851, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1565.246372354459, "predator_policy": 0.8813419862421855}, "policy_reward_max": {"prey_policy": 347.68426747765557, "predator_policy": 1316.0502665952552}, "policy_reward_mean": {"prey_policy": -400.05710082471387, "predator_policy": 499.80138047545717}, "custom_metrics": {}, "hist_stats": {"episode_reward": [296.0999999999999, 347.20000000000226, 189.60965701007197, 607.9999999999995, 360.00179257428573, 122.49999999999864, 189.99999999999937, 352.49999999999966, 435.85293033741425, 71.00000000000024, 392.12528725060855, 154.30000000000007, 261.3217672343254, 358.4000000000012, 101.23356238169924, 78.36791930831077, 381.7533684627203, 176.76621070024018, 679.2330582461867, 317.0712159942801, 527.3059597079932, 378.6000000000023, 323.92551214041964, 195.19999999999962, 77.93022504517413, 74.50000000000004, 652.7000000000002, 600.6, 573.8999999999996, 398.90000000000225, 176.7087026072551, 127.13942169814095, 182.50333431657154, 126.28534222217542, 192.294844275504, 86.76619363707258, 332.8350106478024, 17.37439209902231, 323.63371582178087, 134.2999445697544, 87.59457002641602, 25.003202122245916, 139.91381321548354, 229.68402176213922, 237.70226725663943, 428.68301781121386, 127.22731402718543, 311.1879791710056, 119.42977557401092, 81.31232341090062, 193.79436315206712, 48.755116076658446, 166.1710112345241, 71.50448348012094, 382.20000000000255, 81.36416793455474, 304.4563384189125, 114.38860125904553, 319.8540126716582, 106.46729717305206, 155.32257219229493, 69.80000000000031, 103.93292182437986, 166.6963535086562, 55.60000000000052, 34.90000000000022, 209.2696945150931, 119.35732884675605, 483.4943855319823, 343.0561000754564, 138.84896704371312, 169.63929016154015, 13.737228333652865, 45.115246099692634, 120.44286038259496, 76.59999999999968, 63.42803351534569, 274.54986081690026, 137.6147511958341, -23.517792898195182, 276.53465678151935, 163.74190341512053, 106.5078014970241, 37.10308436297188, 26.631120181407713, 192.06613537041324, 94.59327055040124, 61.20000000000061, 183.72830643568196, -23.354588640990173, 10.786893353164242, 178.10696689390636, 242.12738473742107, 239.83614888083284, 58.713757747002056, 73.4000000000001, 63.12502099628543, 249.31433571406595, 19.13469190885889, -15.761805248923663], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [67.88969810275051, 13.526013578014885, -12.27406930819038, 13.68669281396221, -609.852543169854, -287.1202061031738, 315.3530038330927, 103.76764454045338, 287.16509449763294, -1150.9479045873654, -187.12908529119346, -911.4919981136549, -602.9514197167996, 74.21707549727536, -323.21071341670034, 160.02738294488464, -7.429652401331605, -167.65082541121987, 34.31777492256365, -197.41400993555263, -127.85460730207515, 279.3535482982578, -4.631123343533648, 48.2439067211489, -749.6619695587112, 10.542312576819455, 271.60160858669553, -120.80930107172159, -1141.2257840840396, 14.381074661686936, 37.347897022661314, -225.12518915962605, 332.75449829837186, -1161.2628905387876, -466.8881551024352, -672.6159552179223, 55.86264099171078, 330.8545927716437, -1109.2552715507125, -425.8592468595974, 140.47411966656077, -116.22323024087204, -4.664110876789426, 224.85853435166715, -140.31872332853055, -454.7271969905735, 40.0000000000003, 69.00432558275281, 19.11379559610113, -122.39068133547974, -55.482989057048584, -13.344623438469482, 111.59834691514584, 230.17913699677712, -254.25013255884284, 279.38846555046433, 347.68426747765557, -281.08985494400065, 274.87006351601485, 34.16099648628211, -207.8664035651469, -1070.1981511627625, -86.9552659317021, -224.43430576153355, -151.27375387136414, 50.64529976571668, -654.5130273003263, -1231.5591351732337, -905.512841622566, -66.07429274280818, 6.448115983473649, -395.74797689165547, -694.6274884161876, -770.1388899080556, -810.6794363331643, -1078.768352791078, -531.8307612321826, -618.9049824373748, -259.52895566964315, -132.28926140963662, -94.85302356341235, -987.5992744249075, -235.2072893937638, -1319.752530525861, -542.1466322544408, -80.16389332578687, -1047.2479964949318, -463.8145017986088, 26.560407359413446, -1269.6214970556703, -1371.3390831789163, -11.839674195247287, -167.81047185058208, -1365.0308011399281, -931.1387408837309, -1005.814489996229, -142.70375943690007, -909.3394718309354, 40.0000000000003, -172.70202115979592, -410.16258060382427, -509.7826119510322, -351.98021485145927, -305.48956627385417, -707.1725353404624, -93.03997370786779, -575.0448697591185, -826.4208348745464, -441.47521988176595, 246.7745652702019, -218.5276981468463, 26.11438343851167, -381.70352042475815, -1381.1197660336977, -270.3011193580531, -631.2006130984058, -1022.4973026125515, -464.5850801397325, -579.7696591121111, -60.86931725458629, -759.1982923200027, -572.5818512742752, -21.398961721839527, -204.1098571029404, -52.1463548277005, -379.8019241263629, 42.97088809615789, -531.1010128937328, -593.2078063068551, -20.263781995861436, -797.437636554596, -580.4663037685133, -762.8959736139266, -846.4960528833622, -1565.246372354459, -230.86423057721674, 105.6102096731183, 261.77832082378944, 101.70147774930103, -781.6336163687497, 0.4839449758062696, -756.4173894100176, -988.9383666340655, -524.1013589877927, -594.4977819016636, -370.10391926960807, -403.989791431679, -936.0104122370366, -441.8994459659178, -1016.1956255652033, 20.578764538750494, -745.2391706002868, -684.2123288537074, -675.4490514891563, -105.93945996382871, -1144.6511973922459, -85.66266401938209, -1089.9243442704733, -930.7032762940236, -735.8964754052853, -731.2027401602758, -973.502777029269, -414.251067539997, -262.815409417306, -582.5986178912457, -208.7698243316238, -852.6570832918454, -551.9553403769369, -1026.7691928774093, -1097.676382224858, -132.65817370980298, -1206.2473582348885, -984.3628302762397, -393.3324178200984, 31.783661654543078, -470.72443320313425, -462.3797289515853, -984.5211664540128, -354.80650647538806, -681.7907737975186, -65.40727018439797, -544.1652748936925, -963.4989307883511, -349.30329597368257, 20.190662135100396, -937.4939268703029, -741.9336943288407, -83.67959637770221, -960.42605330978, -1026.0554928199404, 26.23356766574627, -102.06593211692973, -736.0214010640881, -167.6375218293108, 83.80146618005375, -243.84626248593258, -141.86343437947596, -406.28973753983496, -404.2840377227572, -804.3202557517329], "policy_predator_policy_reward": [185.4532792932942, 29.231009025940327, 314.0035017884582, 31.783874705770433, 227.86113760827504, 858.7212686748252, 186.8395335887703, 2.039818037683087, 69.1377983629525, 1154.6468043010657, 219.62908529119161, 1001.4919981136549, 685.1514197167988, 33.58292450272485, 111.58245064101955, 404.1008798307951, 6.995246201056759, 603.9381619489068, 5.18222507743657, 228.9140099355509, 164.51174616657846, 76.11460008784368, 42.13112334353398, 68.55609327885139, 899.3659484648501, 101.0754757513701, 54.59839141330449, 153.00930107171982, 1004.2719122213422, 223.8063595827117, 36.458642687170425, 229.68656875810527, 4.653046663093655, 1205.6087140400416, 566.4425208122345, 749.8278002083647, 232.8208045455781, 59.695019937254095, 819.7809022785681, 1032.4048321260232, 120.69039298873844, 382.3646772935664, 124.61826149610168, 33.78731502902093, 796.1338170832131, 122.83761537630983, 61.318552151463834, 24.87712226578343, 23.916429449073135, 157.29068133547787, 92.18298905704711, 51.14462343846997, 131.2997944695702, 179.62272161850655, 494.4501325588429, 81.01153444953566, 18.119811650579248, 489.1857758157671, 3.2217313509487084, 86.64720864675454, 504.3038458205567, 950.4694115146076, 331.4586016631589, 107.07039172821715, 91.44529176943266, 191.6864966527883, 775.5905065281027, 1236.76699816763, 262.2118404725451, 901.6701381683351, 421.39156267671706, 54.67449186854429, 1088.400631918437, 709.20075705361, 821.5462011664251, 1085.27598005684, 865.8057339428734, 608.5637255484662, 400.81008566937965, 125.30807597966088, 955.4184601154391, 214.62840789929783, 418.64222812292843, 1161.3207939189388, 510.20849525662084, 252.01584353909672, 820.3184346536309, 920.428085402054, 241.06415523304952, 1239.6992017198443, 886.6097040584315, 925.2520711269333, 1264.6405138612602, 395.4280731564355, 1316.0502665952552, 932.0909434557117, 262.67770466391795, 908.7953021779268, 9.112323410900942, 204.9020211597941, 369.9423939471573, 743.7971617597782, 35.6647637706229, 670.5601334313544, 724.9725353404665, 241.41098494239202, 777.2764230310833, 695.6937650827085, 571.3167908250989, 5.583863786471815, 252.0276981468444, 21.749784496043475, 1282.8925805782817, 784.3870442990878, 1015.0089917292632, 0.8813419862421855, 827.2029449043032, 979.7334505196449, 531.9776718754175, 215.12860166433705, 1046.4460389403976, 440.65667684617824, 58.398961721840045, 236.9098571029386, 130.5258375639787, 405.3553632144641, 37.61457095299477, 617.2119073532418, 613.5078063068595, 55.56378199586192, 814.1376365545998, 598.6663037685174, 971.1571063561757, 847.5046146562091, 680.1212938482464, 1235.346637930187, 46.07405402455705, 70.03180101051169, 2.91061355533125, 1020.0776251395746, 228.6767782515146, 666.1056332264158, 936.4097694144998, 746.2692463689083, 312.9012520791114, 665.4376774258213, 427.4398109777563, 957.6756387906522, 835.1321936504979, 743.405738263225, 758.0755506738377, 43.18485538769881, 502.0139813220137, 921.0754325362024, 978.027790349466, 547.1127278235119, 235.67050027248956, 1077.531259213198, 965.339313539673, 677.7426452614457, 787.286871310411, 1193.9533026606541, 408.72031869865236, 432.0880616737787, 381.09613220929907, 516.7801115105996, 828.1484606996, 613.5670473321593, 1040.2778088583923, 1110.7988864252818, 678.6250979813508, 852.3465693337515, 668.1394577840033, 804.1490608627417, 7.516338345457098, 492.6244332031391, 768.8339562106901, 861.795245630598, 1.6412971742204452, 1011.6013944577031, 24.550067030565685, 595.8093714006894, 1138.1520821287427, 352.75711152719833, 127.2948854540494, 1032.1357640185752, 816.4066295800106, 249.0428100073671, 855.9802530302836, 1189.2150508464324, 12.866432334253805, 136.36593211692778, 842.8398407932143, 123.94410309646699, 253.1608838672101, 156.19824815273972, 54.868156616556014, 512.4197072116165, 298.44253277739534, 894.3999554481763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.159034325453547, "mean_inference_ms": 5.661168127302733, "mean_action_processing_ms": 2.302835047102209, "mean_env_wait_ms": 12.413526041259333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005942702293395996, "StateBufferConnector_ms": 0.006692409515380859, "ViewRequirementAgentConnector_ms": 0.19187402725219727}, "num_episodes": 21, "episode_return_max": 679.2330582461867, "episode_return_min": -23.517792898195182, "episode_return_mean": 199.4885593014851, "episodes_this_iter": 21}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.02127469918764, "num_env_steps_trained_throughput_per_sec": 76.02127469918764, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 75050.353, "restore_workers_time_ms": 0.014, "training_step_time_ms": 75050.299, "sample_time_ms": 2417.505, "learn_time_ms": 72613.587, "learn_throughput": 55.086, "synch_weights_time_ms": 15.942}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "645a5_00000", "date": "2024-08-22_12-22-47", "timestamp": 1724309567, "time_this_iter_s": 52.6687388420105, "time_total_s": 1763.0172095298767, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a1361f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1763.0172095298767, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 28.375675675675677, "ram_util_percent": 82.90135135135137}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.287473088660568, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.077931596362402, "policy_loss": -0.015338006665900586, "vf_loss": 7.090766143041944, "vf_explained_var": 0.2894263217058131, "kl": 0.012517268464915337, "entropy": 0.7589830808538608, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 965.7624999999972}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.720595023997877, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.880556466339757, "policy_loss": -0.019791928464891733, "vf_loss": 6.897903163597067, "vf_explained_var": 0.11911328898535835, "kl": 0.012226240717308231, "entropy": 1.1476807097909312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 965.7624999999972}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 679.2330582461867, "episode_reward_min": -23.517792898195182, "episode_reward_mean": 175.4969970732191, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1565.246372354459, "predator_policy": 0.8813419862421855}, "policy_reward_max": {"prey_policy": 347.68426747765557, "predator_policy": 1316.0502665952552}, "policy_reward_mean": {"prey_policy": -446.92299017660685, "predator_policy": 534.6714887132174}, "custom_metrics": {}, "hist_stats": {"episode_reward": [679.2330582461867, 317.0712159942801, 527.3059597079932, 378.6000000000023, 323.92551214041964, 195.19999999999962, 77.93022504517413, 74.50000000000004, 652.7000000000002, 600.6, 573.8999999999996, 398.90000000000225, 176.7087026072551, 127.13942169814095, 182.50333431657154, 126.28534222217542, 192.294844275504, 86.76619363707258, 332.8350106478024, 17.37439209902231, 323.63371582178087, 134.2999445697544, 87.59457002641602, 25.003202122245916, 139.91381321548354, 229.68402176213922, 237.70226725663943, 428.68301781121386, 127.22731402718543, 311.1879791710056, 119.42977557401092, 81.31232341090062, 193.79436315206712, 48.755116076658446, 166.1710112345241, 71.50448348012094, 382.20000000000255, 81.36416793455474, 304.4563384189125, 114.38860125904553, 319.8540126716582, 106.46729717305206, 155.32257219229493, 69.80000000000031, 103.93292182437986, 166.6963535086562, 55.60000000000052, 34.90000000000022, 209.2696945150931, 119.35732884675605, 483.4943855319823, 343.0561000754564, 138.84896704371312, 169.63929016154015, 13.737228333652865, 45.115246099692634, 120.44286038259496, 76.59999999999968, 63.42803351534569, 274.54986081690026, 137.6147511958341, -23.517792898195182, 276.53465678151935, 163.74190341512053, 106.5078014970241, 37.10308436297188, 26.631120181407713, 192.06613537041324, 94.59327055040124, 61.20000000000061, 183.72830643568196, -23.354588640990173, 10.786893353164242, 178.10696689390636, 242.12738473742107, 239.83614888083284, 58.713757747002056, 73.4000000000001, 63.12502099628543, 249.31433571406595, 19.13469190885889, -15.761805248923663, 151.7319012453101, 73.30000000000011, 48.826624290603185, 87.25580134629658, 190.32294179134354, 89.45950458219504, 12.199408767207439, 129.7017722762014, 367.0640384131007, 218.3506536477932, 136.50851133366552, 73.00000000000013, 8.329722865868858, 294.3030399897615, 139.59373902184007, 223.14535894885168, 226.0898897904417, 8.693364122595925], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [55.86264099171078, 330.8545927716437, -1109.2552715507125, -425.8592468595974, 140.47411966656077, -116.22323024087204, -4.664110876789426, 224.85853435166715, -140.31872332853055, -454.7271969905735, 40.0000000000003, 69.00432558275281, 19.11379559610113, -122.39068133547974, -55.482989057048584, -13.344623438469482, 111.59834691514584, 230.17913699677712, -254.25013255884284, 279.38846555046433, 347.68426747765557, -281.08985494400065, 274.87006351601485, 34.16099648628211, -207.8664035651469, -1070.1981511627625, -86.9552659317021, -224.43430576153355, -151.27375387136414, 50.64529976571668, -654.5130273003263, -1231.5591351732337, -905.512841622566, -66.07429274280818, 6.448115983473649, -395.74797689165547, -694.6274884161876, -770.1388899080556, -810.6794363331643, -1078.768352791078, -531.8307612321826, -618.9049824373748, -259.52895566964315, -132.28926140963662, -94.85302356341235, -987.5992744249075, -235.2072893937638, -1319.752530525861, -542.1466322544408, -80.16389332578687, -1047.2479964949318, -463.8145017986088, 26.560407359413446, -1269.6214970556703, -1371.3390831789163, -11.839674195247287, -167.81047185058208, -1365.0308011399281, -931.1387408837309, -1005.814489996229, -142.70375943690007, -909.3394718309354, 40.0000000000003, -172.70202115979592, -410.16258060382427, -509.7826119510322, -351.98021485145927, -305.48956627385417, -707.1725353404624, -93.03997370786779, -575.0448697591185, -826.4208348745464, -441.47521988176595, 246.7745652702019, -218.5276981468463, 26.11438343851167, -381.70352042475815, -1381.1197660336977, -270.3011193580531, -631.2006130984058, -1022.4973026125515, -464.5850801397325, -579.7696591121111, -60.86931725458629, -759.1982923200027, -572.5818512742752, -21.398961721839527, -204.1098571029404, -52.1463548277005, -379.8019241263629, 42.97088809615789, -531.1010128937328, -593.2078063068551, -20.263781995861436, -797.437636554596, -580.4663037685133, -762.8959736139266, -846.4960528833622, -1565.246372354459, -230.86423057721674, 105.6102096731183, 261.77832082378944, 101.70147774930103, -781.6336163687497, 0.4839449758062696, -756.4173894100176, -988.9383666340655, -524.1013589877927, -594.4977819016636, -370.10391926960807, -403.989791431679, -936.0104122370366, -441.8994459659178, -1016.1956255652033, 20.578764538750494, -745.2391706002868, -684.2123288537074, -675.4490514891563, -105.93945996382871, -1144.6511973922459, -85.66266401938209, -1089.9243442704733, -930.7032762940236, -735.8964754052853, -731.2027401602758, -973.502777029269, -414.251067539997, -262.815409417306, -582.5986178912457, -208.7698243316238, -852.6570832918454, -551.9553403769369, -1026.7691928774093, -1097.676382224858, -132.65817370980298, -1206.2473582348885, -984.3628302762397, -393.3324178200984, 31.783661654543078, -470.72443320313425, -462.3797289515853, -984.5211664540128, -354.80650647538806, -681.7907737975186, -65.40727018439797, -544.1652748936925, -963.4989307883511, -349.30329597368257, 20.190662135100396, -937.4939268703029, -741.9336943288407, -83.67959637770221, -960.42605330978, -1026.0554928199404, 26.23356766574627, -102.06593211692973, -736.0214010640881, -167.6375218293108, 83.80146618005375, -243.84626248593258, -141.86343437947596, -406.28973753983496, -404.2840377227572, -804.3202557517329, -260.99713270706246, -581.9029414632433, 13.464069351197743, -46.18902678596006, -310.5813471500364, -598.5729581248145, -323.7829749461525, -846.3645019288082, -655.833540254612, -460.32660168697595, -785.0716718473517, -521.1549003821408, -342.2870440665342, -687.4698755058077, -435.80314810868356, -613.2586590211596, -490.2706538838279, -236.89704405815354, -756.1147862620032, -5.003946419233822, -838.8596283030264, -640.9169323668448, -112.98900899463061, 36.08583777359439, -197.22725878791877, -712.1453805868889, -38.40494075890473, -598.2960612816835, -1061.8813113188553, -258.14527487951796, -756.0410594440497, -540.9948103907, 13.955350945072576, -353.8637541593511, -571.6901406040479, -860.7169879070902], "policy_predator_policy_reward": [232.8208045455781, 59.695019937254095, 819.7809022785681, 1032.4048321260232, 120.69039298873844, 382.3646772935664, 124.61826149610168, 33.78731502902093, 796.1338170832131, 122.83761537630983, 61.318552151463834, 24.87712226578343, 23.916429449073135, 157.29068133547787, 92.18298905704711, 51.14462343846997, 131.2997944695702, 179.62272161850655, 494.4501325588429, 81.01153444953566, 18.119811650579248, 489.1857758157671, 3.2217313509487084, 86.64720864675454, 504.3038458205567, 950.4694115146076, 331.4586016631589, 107.07039172821715, 91.44529176943266, 191.6864966527883, 775.5905065281027, 1236.76699816763, 262.2118404725451, 901.6701381683351, 421.39156267671706, 54.67449186854429, 1088.400631918437, 709.20075705361, 821.5462011664251, 1085.27598005684, 865.8057339428734, 608.5637255484662, 400.81008566937965, 125.30807597966088, 955.4184601154391, 214.62840789929783, 418.64222812292843, 1161.3207939189388, 510.20849525662084, 252.01584353909672, 820.3184346536309, 920.428085402054, 241.06415523304952, 1239.6992017198443, 886.6097040584315, 925.2520711269333, 1264.6405138612602, 395.4280731564355, 1316.0502665952552, 932.0909434557117, 262.67770466391795, 908.7953021779268, 9.112323410900942, 204.9020211597941, 369.9423939471573, 743.7971617597782, 35.6647637706229, 670.5601334313544, 724.9725353404665, 241.41098494239202, 777.2764230310833, 695.6937650827085, 571.3167908250989, 5.583863786471815, 252.0276981468444, 21.749784496043475, 1282.8925805782817, 784.3870442990878, 1015.0089917292632, 0.8813419862421855, 827.2029449043032, 979.7334505196449, 531.9776718754175, 215.12860166433705, 1046.4460389403976, 440.65667684617824, 58.398961721840045, 236.9098571029386, 130.5258375639787, 405.3553632144641, 37.61457095299477, 617.2119073532418, 613.5078063068595, 55.56378199586192, 814.1376365545998, 598.6663037685174, 971.1571063561757, 847.5046146562091, 680.1212938482464, 1235.346637930187, 46.07405402455705, 70.03180101051169, 2.91061355533125, 1020.0776251395746, 228.6767782515146, 666.1056332264158, 936.4097694144998, 746.2692463689083, 312.9012520791114, 665.4376774258213, 427.4398109777563, 957.6756387906522, 835.1321936504979, 743.405738263225, 758.0755506738377, 43.18485538769881, 502.0139813220137, 921.0754325362024, 978.027790349466, 547.1127278235119, 235.67050027248956, 1077.531259213198, 965.339313539673, 677.7426452614457, 787.286871310411, 1193.9533026606541, 408.72031869865236, 432.0880616737787, 381.09613220929907, 516.7801115105996, 828.1484606996, 613.5670473321593, 1040.2778088583923, 1110.7988864252818, 678.6250979813508, 852.3465693337515, 668.1394577840033, 804.1490608627417, 7.516338345457098, 492.6244332031391, 768.8339562106901, 861.795245630598, 1.6412971742204452, 1011.6013944577031, 24.550067030565685, 595.8093714006894, 1138.1520821287427, 352.75711152719833, 127.2948854540494, 1032.1357640185752, 816.4066295800106, 249.0428100073671, 855.9802530302836, 1189.2150508464324, 12.866432334253805, 136.36593211692778, 842.8398407932143, 123.94410309646699, 253.1608838672101, 156.19824815273972, 54.868156616556014, 512.4197072116165, 298.44253277739534, 894.3999554481763, 712.8856161058927, 281.7463593097292, 24.635930648802308, 81.38902678595933, 632.0755663859629, 325.9053631795017, 389.7387762924568, 867.6645019288101, 680.905061320168, 625.5780224127645, 670.2548192867087, 725.4312575249861, 207.25409955387718, 834.7022287856802, 555.6408380831668, 623.1227413228825, 457.74719027053465, 636.4845460845454, 771.8528705353547, 207.61651579367532, 604.0897686880041, 1012.195303315537, 146.28900899462872, 3.6141622264058517, 712.921478054891, 204.78088418578443, 422.3601797535192, 508.64386227682616, 1052.7079097767416, 406.912415443474, 1138.6130582526514, 381.56817053095097, 233.25318832289355, 332.74510468183666, 642.4268770782384, 798.6736155554979]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.057181446504315, "mean_inference_ms": 5.548543464038833, "mean_action_processing_ms": 2.2748811166412226, "mean_env_wait_ms": 12.439790132915926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005692601203918457, "StateBufferConnector_ms": 0.006475925445556641, "ViewRequirementAgentConnector_ms": 0.14406812191009521}, "num_episodes": 18, "episode_return_max": 679.2330582461867, "episode_return_min": -23.517792898195182, "episode_return_mean": 175.4969970732191, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.67134303892509, "num_env_steps_trained_throughput_per_sec": 76.67134303892509, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 52846.816, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52846.763, "sample_time_ms": 2398.193, "learn_time_ms": 50430.492, "learn_throughput": 79.317, "synch_weights_time_ms": 15.063}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "645a5_00000", "date": "2024-08-22_12-23-40", "timestamp": 1724309620, "time_this_iter_s": 52.22670912742615, "time_total_s": 1815.2439186573029, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a1319d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1815.2439186573029, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 28.25675675675676, "ram_util_percent": 83.14189189189189}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.752042535120848, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.616234557086198, "policy_loss": -0.011156566880603947, "vf_loss": 7.625488916528288, "vf_explained_var": 0.26510976783182255, "kl": 0.009511049428003687, "entropy": 0.6829468870289112, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.371667676028752, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.09858100855792, "policy_loss": -0.025578334376156805, "vf_loss": 7.120858590817325, "vf_explained_var": 0.19257402823715614, "kl": 0.016503703049704353, "entropy": 1.065027271345179, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 652.7000000000002, "episode_reward_min": -23.517792898195182, "episode_reward_mean": 158.9786568143805, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1565.246372354459, "predator_policy": 0.8813419862421855}, "policy_reward_max": {"prey_policy": 347.68426747765557, "predator_policy": 1316.0502665952552}, "policy_reward_mean": {"prey_policy": -466.82264607709806, "predator_policy": 546.3119744842895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [195.19999999999962, 77.93022504517413, 74.50000000000004, 652.7000000000002, 600.6, 573.8999999999996, 398.90000000000225, 176.7087026072551, 127.13942169814095, 182.50333431657154, 126.28534222217542, 192.294844275504, 86.76619363707258, 332.8350106478024, 17.37439209902231, 323.63371582178087, 134.2999445697544, 87.59457002641602, 25.003202122245916, 139.91381321548354, 229.68402176213922, 237.70226725663943, 428.68301781121386, 127.22731402718543, 311.1879791710056, 119.42977557401092, 81.31232341090062, 193.79436315206712, 48.755116076658446, 166.1710112345241, 71.50448348012094, 382.20000000000255, 81.36416793455474, 304.4563384189125, 114.38860125904553, 319.8540126716582, 106.46729717305206, 155.32257219229493, 69.80000000000031, 103.93292182437986, 166.6963535086562, 55.60000000000052, 34.90000000000022, 209.2696945150931, 119.35732884675605, 483.4943855319823, 343.0561000754564, 138.84896704371312, 169.63929016154015, 13.737228333652865, 45.115246099692634, 120.44286038259496, 76.59999999999968, 63.42803351534569, 274.54986081690026, 137.6147511958341, -23.517792898195182, 276.53465678151935, 163.74190341512053, 106.5078014970241, 37.10308436297188, 26.631120181407713, 192.06613537041324, 94.59327055040124, 61.20000000000061, 183.72830643568196, -23.354588640990173, 10.786893353164242, 178.10696689390636, 242.12738473742107, 239.83614888083284, 58.713757747002056, 73.4000000000001, 63.12502099628543, 249.31433571406595, 19.13469190885889, -15.761805248923663, 151.7319012453101, 73.30000000000011, 48.826624290603185, 87.25580134629658, 190.32294179134354, 89.45950458219504, 12.199408767207439, 129.7017722762014, 367.0640384131007, 218.3506536477932, 136.50851133366552, 73.00000000000013, 8.329722865868858, 294.3030399897615, 139.59373902184007, 223.14535894885168, 226.0898897904417, 8.693364122595925, 231.15374046019315, 82.72396626933038, 144.18583600322668, 38.72566805472415, 77.51250941754606], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [40.0000000000003, 69.00432558275281, 19.11379559610113, -122.39068133547974, -55.482989057048584, -13.344623438469482, 111.59834691514584, 230.17913699677712, -254.25013255884284, 279.38846555046433, 347.68426747765557, -281.08985494400065, 274.87006351601485, 34.16099648628211, -207.8664035651469, -1070.1981511627625, -86.9552659317021, -224.43430576153355, -151.27375387136414, 50.64529976571668, -654.5130273003263, -1231.5591351732337, -905.512841622566, -66.07429274280818, 6.448115983473649, -395.74797689165547, -694.6274884161876, -770.1388899080556, -810.6794363331643, -1078.768352791078, -531.8307612321826, -618.9049824373748, -259.52895566964315, -132.28926140963662, -94.85302356341235, -987.5992744249075, -235.2072893937638, -1319.752530525861, -542.1466322544408, -80.16389332578687, -1047.2479964949318, -463.8145017986088, 26.560407359413446, -1269.6214970556703, -1371.3390831789163, -11.839674195247287, -167.81047185058208, -1365.0308011399281, -931.1387408837309, -1005.814489996229, -142.70375943690007, -909.3394718309354, 40.0000000000003, -172.70202115979592, -410.16258060382427, -509.7826119510322, -351.98021485145927, -305.48956627385417, -707.1725353404624, -93.03997370786779, -575.0448697591185, -826.4208348745464, -441.47521988176595, 246.7745652702019, -218.5276981468463, 26.11438343851167, -381.70352042475815, -1381.1197660336977, -270.3011193580531, -631.2006130984058, -1022.4973026125515, -464.5850801397325, -579.7696591121111, -60.86931725458629, -759.1982923200027, -572.5818512742752, -21.398961721839527, -204.1098571029404, -52.1463548277005, -379.8019241263629, 42.97088809615789, -531.1010128937328, -593.2078063068551, -20.263781995861436, -797.437636554596, -580.4663037685133, -762.8959736139266, -846.4960528833622, -1565.246372354459, -230.86423057721674, 105.6102096731183, 261.77832082378944, 101.70147774930103, -781.6336163687497, 0.4839449758062696, -756.4173894100176, -988.9383666340655, -524.1013589877927, -594.4977819016636, -370.10391926960807, -403.989791431679, -936.0104122370366, -441.8994459659178, -1016.1956255652033, 20.578764538750494, -745.2391706002868, -684.2123288537074, -675.4490514891563, -105.93945996382871, -1144.6511973922459, -85.66266401938209, -1089.9243442704733, -930.7032762940236, -735.8964754052853, -731.2027401602758, -973.502777029269, -414.251067539997, -262.815409417306, -582.5986178912457, -208.7698243316238, -852.6570832918454, -551.9553403769369, -1026.7691928774093, -1097.676382224858, -132.65817370980298, -1206.2473582348885, -984.3628302762397, -393.3324178200984, 31.783661654543078, -470.72443320313425, -462.3797289515853, -984.5211664540128, -354.80650647538806, -681.7907737975186, -65.40727018439797, -544.1652748936925, -963.4989307883511, -349.30329597368257, 20.190662135100396, -937.4939268703029, -741.9336943288407, -83.67959637770221, -960.42605330978, -1026.0554928199404, 26.23356766574627, -102.06593211692973, -736.0214010640881, -167.6375218293108, 83.80146618005375, -243.84626248593258, -141.86343437947596, -406.28973753983496, -404.2840377227572, -804.3202557517329, -260.99713270706246, -581.9029414632433, 13.464069351197743, -46.18902678596006, -310.5813471500364, -598.5729581248145, -323.7829749461525, -846.3645019288082, -655.833540254612, -460.32660168697595, -785.0716718473517, -521.1549003821408, -342.2870440665342, -687.4698755058077, -435.80314810868356, -613.2586590211596, -490.2706538838279, -236.89704405815354, -756.1147862620032, -5.003946419233822, -838.8596283030264, -640.9169323668448, -112.98900899463061, 36.08583777359439, -197.22725878791877, -712.1453805868889, -38.40494075890473, -598.2960612816835, -1061.8813113188553, -258.14527487951796, -756.0410594440497, -540.9948103907, 13.955350945072576, -353.8637541593511, -571.6901406040479, -860.7169879070902, -212.67203327538988, -447.0830194634429, -401.8843914015678, -848.8727651185606, -304.0102113539485, -1163.1030136741292, -252.24169204186072, -965.8800013740563, -406.1591762370525, -477.02276822374], "policy_predator_policy_reward": [61.318552151463834, 24.87712226578343, 23.916429449073135, 157.29068133547787, 92.18298905704711, 51.14462343846997, 131.2997944695702, 179.62272161850655, 494.4501325588429, 81.01153444953566, 18.119811650579248, 489.1857758157671, 3.2217313509487084, 86.64720864675454, 504.3038458205567, 950.4694115146076, 331.4586016631589, 107.07039172821715, 91.44529176943266, 191.6864966527883, 775.5905065281027, 1236.76699816763, 262.2118404725451, 901.6701381683351, 421.39156267671706, 54.67449186854429, 1088.400631918437, 709.20075705361, 821.5462011664251, 1085.27598005684, 865.8057339428734, 608.5637255484662, 400.81008566937965, 125.30807597966088, 955.4184601154391, 214.62840789929783, 418.64222812292843, 1161.3207939189388, 510.20849525662084, 252.01584353909672, 820.3184346536309, 920.428085402054, 241.06415523304952, 1239.6992017198443, 886.6097040584315, 925.2520711269333, 1264.6405138612602, 395.4280731564355, 1316.0502665952552, 932.0909434557117, 262.67770466391795, 908.7953021779268, 9.112323410900942, 204.9020211597941, 369.9423939471573, 743.7971617597782, 35.6647637706229, 670.5601334313544, 724.9725353404665, 241.41098494239202, 777.2764230310833, 695.6937650827085, 571.3167908250989, 5.583863786471815, 252.0276981468444, 21.749784496043475, 1282.8925805782817, 784.3870442990878, 1015.0089917292632, 0.8813419862421855, 827.2029449043032, 979.7334505196449, 531.9776718754175, 215.12860166433705, 1046.4460389403976, 440.65667684617824, 58.398961721840045, 236.9098571029386, 130.5258375639787, 405.3553632144641, 37.61457095299477, 617.2119073532418, 613.5078063068595, 55.56378199586192, 814.1376365545998, 598.6663037685174, 971.1571063561757, 847.5046146562091, 680.1212938482464, 1235.346637930187, 46.07405402455705, 70.03180101051169, 2.91061355533125, 1020.0776251395746, 228.6767782515146, 666.1056332264158, 936.4097694144998, 746.2692463689083, 312.9012520791114, 665.4376774258213, 427.4398109777563, 957.6756387906522, 835.1321936504979, 743.405738263225, 758.0755506738377, 43.18485538769881, 502.0139813220137, 921.0754325362024, 978.027790349466, 547.1127278235119, 235.67050027248956, 1077.531259213198, 965.339313539673, 677.7426452614457, 787.286871310411, 1193.9533026606541, 408.72031869865236, 432.0880616737787, 381.09613220929907, 516.7801115105996, 828.1484606996, 613.5670473321593, 1040.2778088583923, 1110.7988864252818, 678.6250979813508, 852.3465693337515, 668.1394577840033, 804.1490608627417, 7.516338345457098, 492.6244332031391, 768.8339562106901, 861.795245630598, 1.6412971742204452, 1011.6013944577031, 24.550067030565685, 595.8093714006894, 1138.1520821287427, 352.75711152719833, 127.2948854540494, 1032.1357640185752, 816.4066295800106, 249.0428100073671, 855.9802530302836, 1189.2150508464324, 12.866432334253805, 136.36593211692778, 842.8398407932143, 123.94410309646699, 253.1608838672101, 156.19824815273972, 54.868156616556014, 512.4197072116165, 298.44253277739534, 894.3999554481763, 712.8856161058927, 281.7463593097292, 24.635930648802308, 81.38902678595933, 632.0755663859629, 325.9053631795017, 389.7387762924568, 867.6645019288101, 680.905061320168, 625.5780224127645, 670.2548192867087, 725.4312575249861, 207.25409955387718, 834.7022287856802, 555.6408380831668, 623.1227413228825, 457.74719027053465, 636.4845460845454, 771.8528705353547, 207.61651579367532, 604.0897686880041, 1012.195303315537, 146.28900899462872, 3.6141622264058517, 712.921478054891, 204.78088418578443, 422.3601797535192, 508.64386227682616, 1052.7079097767416, 406.912415443474, 1138.6130582526514, 381.56817053095097, 233.25318832289355, 332.74510468183666, 642.4268770782384, 798.6736155554979, 460.6584658979112, 430.2503273011215, 369.88111469345813, 963.6000080960046, 560.7845441631968, 1050.514516868107, 1171.1340264823084, 85.71333498833205, 942.3471711173277, 18.347282761019038]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.039215163563791, "mean_inference_ms": 5.548840524836299, "mean_action_processing_ms": 2.2182324112914946, "mean_env_wait_ms": 12.427610175594113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056563615798950195, "StateBufferConnector_ms": 0.006429433822631836, "ViewRequirementAgentConnector_ms": 0.14253175258636475}, "num_episodes": 5, "episode_return_max": 652.7000000000002, "episode_return_min": -23.517792898195182, "episode_return_mean": 158.9786568143805, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.2372150775285, "num_env_steps_trained_throughput_per_sec": 76.2372150775285, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 52613.199, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52613.147, "sample_time_ms": 2238.377, "learn_time_ms": 50356.623, "learn_throughput": 79.433, "synch_weights_time_ms": 15.194}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "645a5_00000", "date": "2024-08-22_12-24-32", "timestamp": 1724309672, "time_this_iter_s": 52.537946939468384, "time_total_s": 1867.7818655967712, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a121dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1867.7818655967712, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 29.098648648648652, "ram_util_percent": 82.9135135135135}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.329046376104708, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.937528115731698, "policy_loss": -0.011464030594964113, "vf_loss": 6.946952139132868, "vf_explained_var": 0.27561576114129765, "kl": 0.010199948381041251, "entropy": 0.7393452004780845, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 965.7624999999972}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.979476668216564, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.5942194151499915, "policy_loss": -0.02519991355209005, "vf_loss": 6.61625728884702, "vf_explained_var": 0.2856919689468606, "kl": 0.015810241525322594, "entropy": 1.0137321420447536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 965.7624999999972}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 652.7000000000002, "episode_reward_min": -23.517792898195182, "episode_reward_mean": 158.9786568143805, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1565.246372354459, "predator_policy": 0.8813419862421855}, "policy_reward_max": {"prey_policy": 347.68426747765557, "predator_policy": 1316.0502665952552}, "policy_reward_mean": {"prey_policy": -466.82264607709806, "predator_policy": 546.3119744842895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [195.19999999999962, 77.93022504517413, 74.50000000000004, 652.7000000000002, 600.6, 573.8999999999996, 398.90000000000225, 176.7087026072551, 127.13942169814095, 182.50333431657154, 126.28534222217542, 192.294844275504, 86.76619363707258, 332.8350106478024, 17.37439209902231, 323.63371582178087, 134.2999445697544, 87.59457002641602, 25.003202122245916, 139.91381321548354, 229.68402176213922, 237.70226725663943, 428.68301781121386, 127.22731402718543, 311.1879791710056, 119.42977557401092, 81.31232341090062, 193.79436315206712, 48.755116076658446, 166.1710112345241, 71.50448348012094, 382.20000000000255, 81.36416793455474, 304.4563384189125, 114.38860125904553, 319.8540126716582, 106.46729717305206, 155.32257219229493, 69.80000000000031, 103.93292182437986, 166.6963535086562, 55.60000000000052, 34.90000000000022, 209.2696945150931, 119.35732884675605, 483.4943855319823, 343.0561000754564, 138.84896704371312, 169.63929016154015, 13.737228333652865, 45.115246099692634, 120.44286038259496, 76.59999999999968, 63.42803351534569, 274.54986081690026, 137.6147511958341, -23.517792898195182, 276.53465678151935, 163.74190341512053, 106.5078014970241, 37.10308436297188, 26.631120181407713, 192.06613537041324, 94.59327055040124, 61.20000000000061, 183.72830643568196, -23.354588640990173, 10.786893353164242, 178.10696689390636, 242.12738473742107, 239.83614888083284, 58.713757747002056, 73.4000000000001, 63.12502099628543, 249.31433571406595, 19.13469190885889, -15.761805248923663, 151.7319012453101, 73.30000000000011, 48.826624290603185, 87.25580134629658, 190.32294179134354, 89.45950458219504, 12.199408767207439, 129.7017722762014, 367.0640384131007, 218.3506536477932, 136.50851133366552, 73.00000000000013, 8.329722865868858, 294.3030399897615, 139.59373902184007, 223.14535894885168, 226.0898897904417, 8.693364122595925, 231.15374046019315, 82.72396626933038, 144.18583600322668, 38.72566805472415, 77.51250941754606], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [40.0000000000003, 69.00432558275281, 19.11379559610113, -122.39068133547974, -55.482989057048584, -13.344623438469482, 111.59834691514584, 230.17913699677712, -254.25013255884284, 279.38846555046433, 347.68426747765557, -281.08985494400065, 274.87006351601485, 34.16099648628211, -207.8664035651469, -1070.1981511627625, -86.9552659317021, -224.43430576153355, -151.27375387136414, 50.64529976571668, -654.5130273003263, -1231.5591351732337, -905.512841622566, -66.07429274280818, 6.448115983473649, -395.74797689165547, -694.6274884161876, -770.1388899080556, -810.6794363331643, -1078.768352791078, -531.8307612321826, -618.9049824373748, -259.52895566964315, -132.28926140963662, -94.85302356341235, -987.5992744249075, -235.2072893937638, -1319.752530525861, -542.1466322544408, -80.16389332578687, -1047.2479964949318, -463.8145017986088, 26.560407359413446, -1269.6214970556703, -1371.3390831789163, -11.839674195247287, -167.81047185058208, -1365.0308011399281, -931.1387408837309, -1005.814489996229, -142.70375943690007, -909.3394718309354, 40.0000000000003, -172.70202115979592, -410.16258060382427, -509.7826119510322, -351.98021485145927, -305.48956627385417, -707.1725353404624, -93.03997370786779, -575.0448697591185, -826.4208348745464, -441.47521988176595, 246.7745652702019, -218.5276981468463, 26.11438343851167, -381.70352042475815, -1381.1197660336977, -270.3011193580531, -631.2006130984058, -1022.4973026125515, -464.5850801397325, -579.7696591121111, -60.86931725458629, -759.1982923200027, -572.5818512742752, -21.398961721839527, -204.1098571029404, -52.1463548277005, -379.8019241263629, 42.97088809615789, -531.1010128937328, -593.2078063068551, -20.263781995861436, -797.437636554596, -580.4663037685133, -762.8959736139266, -846.4960528833622, -1565.246372354459, -230.86423057721674, 105.6102096731183, 261.77832082378944, 101.70147774930103, -781.6336163687497, 0.4839449758062696, -756.4173894100176, -988.9383666340655, -524.1013589877927, -594.4977819016636, -370.10391926960807, -403.989791431679, -936.0104122370366, -441.8994459659178, -1016.1956255652033, 20.578764538750494, -745.2391706002868, -684.2123288537074, -675.4490514891563, -105.93945996382871, -1144.6511973922459, -85.66266401938209, -1089.9243442704733, -930.7032762940236, -735.8964754052853, -731.2027401602758, -973.502777029269, -414.251067539997, -262.815409417306, -582.5986178912457, -208.7698243316238, -852.6570832918454, -551.9553403769369, -1026.7691928774093, -1097.676382224858, -132.65817370980298, -1206.2473582348885, -984.3628302762397, -393.3324178200984, 31.783661654543078, -470.72443320313425, -462.3797289515853, -984.5211664540128, -354.80650647538806, -681.7907737975186, -65.40727018439797, -544.1652748936925, -963.4989307883511, -349.30329597368257, 20.190662135100396, -937.4939268703029, -741.9336943288407, -83.67959637770221, -960.42605330978, -1026.0554928199404, 26.23356766574627, -102.06593211692973, -736.0214010640881, -167.6375218293108, 83.80146618005375, -243.84626248593258, -141.86343437947596, -406.28973753983496, -404.2840377227572, -804.3202557517329, -260.99713270706246, -581.9029414632433, 13.464069351197743, -46.18902678596006, -310.5813471500364, -598.5729581248145, -323.7829749461525, -846.3645019288082, -655.833540254612, -460.32660168697595, -785.0716718473517, -521.1549003821408, -342.2870440665342, -687.4698755058077, -435.80314810868356, -613.2586590211596, -490.2706538838279, -236.89704405815354, -756.1147862620032, -5.003946419233822, -838.8596283030264, -640.9169323668448, -112.98900899463061, 36.08583777359439, -197.22725878791877, -712.1453805868889, -38.40494075890473, -598.2960612816835, -1061.8813113188553, -258.14527487951796, -756.0410594440497, -540.9948103907, 13.955350945072576, -353.8637541593511, -571.6901406040479, -860.7169879070902, -212.67203327538988, -447.0830194634429, -401.8843914015678, -848.8727651185606, -304.0102113539485, -1163.1030136741292, -252.24169204186072, -965.8800013740563, -406.1591762370525, -477.02276822374], "policy_predator_policy_reward": [61.318552151463834, 24.87712226578343, 23.916429449073135, 157.29068133547787, 92.18298905704711, 51.14462343846997, 131.2997944695702, 179.62272161850655, 494.4501325588429, 81.01153444953566, 18.119811650579248, 489.1857758157671, 3.2217313509487084, 86.64720864675454, 504.3038458205567, 950.4694115146076, 331.4586016631589, 107.07039172821715, 91.44529176943266, 191.6864966527883, 775.5905065281027, 1236.76699816763, 262.2118404725451, 901.6701381683351, 421.39156267671706, 54.67449186854429, 1088.400631918437, 709.20075705361, 821.5462011664251, 1085.27598005684, 865.8057339428734, 608.5637255484662, 400.81008566937965, 125.30807597966088, 955.4184601154391, 214.62840789929783, 418.64222812292843, 1161.3207939189388, 510.20849525662084, 252.01584353909672, 820.3184346536309, 920.428085402054, 241.06415523304952, 1239.6992017198443, 886.6097040584315, 925.2520711269333, 1264.6405138612602, 395.4280731564355, 1316.0502665952552, 932.0909434557117, 262.67770466391795, 908.7953021779268, 9.112323410900942, 204.9020211597941, 369.9423939471573, 743.7971617597782, 35.6647637706229, 670.5601334313544, 724.9725353404665, 241.41098494239202, 777.2764230310833, 695.6937650827085, 571.3167908250989, 5.583863786471815, 252.0276981468444, 21.749784496043475, 1282.8925805782817, 784.3870442990878, 1015.0089917292632, 0.8813419862421855, 827.2029449043032, 979.7334505196449, 531.9776718754175, 215.12860166433705, 1046.4460389403976, 440.65667684617824, 58.398961721840045, 236.9098571029386, 130.5258375639787, 405.3553632144641, 37.61457095299477, 617.2119073532418, 613.5078063068595, 55.56378199586192, 814.1376365545998, 598.6663037685174, 971.1571063561757, 847.5046146562091, 680.1212938482464, 1235.346637930187, 46.07405402455705, 70.03180101051169, 2.91061355533125, 1020.0776251395746, 228.6767782515146, 666.1056332264158, 936.4097694144998, 746.2692463689083, 312.9012520791114, 665.4376774258213, 427.4398109777563, 957.6756387906522, 835.1321936504979, 743.405738263225, 758.0755506738377, 43.18485538769881, 502.0139813220137, 921.0754325362024, 978.027790349466, 547.1127278235119, 235.67050027248956, 1077.531259213198, 965.339313539673, 677.7426452614457, 787.286871310411, 1193.9533026606541, 408.72031869865236, 432.0880616737787, 381.09613220929907, 516.7801115105996, 828.1484606996, 613.5670473321593, 1040.2778088583923, 1110.7988864252818, 678.6250979813508, 852.3465693337515, 668.1394577840033, 804.1490608627417, 7.516338345457098, 492.6244332031391, 768.8339562106901, 861.795245630598, 1.6412971742204452, 1011.6013944577031, 24.550067030565685, 595.8093714006894, 1138.1520821287427, 352.75711152719833, 127.2948854540494, 1032.1357640185752, 816.4066295800106, 249.0428100073671, 855.9802530302836, 1189.2150508464324, 12.866432334253805, 136.36593211692778, 842.8398407932143, 123.94410309646699, 253.1608838672101, 156.19824815273972, 54.868156616556014, 512.4197072116165, 298.44253277739534, 894.3999554481763, 712.8856161058927, 281.7463593097292, 24.635930648802308, 81.38902678595933, 632.0755663859629, 325.9053631795017, 389.7387762924568, 867.6645019288101, 680.905061320168, 625.5780224127645, 670.2548192867087, 725.4312575249861, 207.25409955387718, 834.7022287856802, 555.6408380831668, 623.1227413228825, 457.74719027053465, 636.4845460845454, 771.8528705353547, 207.61651579367532, 604.0897686880041, 1012.195303315537, 146.28900899462872, 3.6141622264058517, 712.921478054891, 204.78088418578443, 422.3601797535192, 508.64386227682616, 1052.7079097767416, 406.912415443474, 1138.6130582526514, 381.56817053095097, 233.25318832289355, 332.74510468183666, 642.4268770782384, 798.6736155554979, 460.6584658979112, 430.2503273011215, 369.88111469345813, 963.6000080960046, 560.7845441631968, 1050.514516868107, 1171.1340264823084, 85.71333498833205, 942.3471711173277, 18.347282761019038]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.039215163563791, "mean_inference_ms": 5.548840524836299, "mean_action_processing_ms": 2.2182324112914946, "mean_env_wait_ms": 12.427610175594113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056563615798950195, "StateBufferConnector_ms": 0.006429433822631836, "ViewRequirementAgentConnector_ms": 0.14253175258636475}, "num_episodes": 0, "episode_return_max": 652.7000000000002, "episode_return_min": -23.517792898195182, "episode_return_mean": 158.9786568143805, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.38704821802627, "num_env_steps_trained_throughput_per_sec": 75.38704821802627, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 52560.556, "restore_workers_time_ms": 0.015, "training_step_time_ms": 52560.503, "sample_time_ms": 2198.252, "learn_time_ms": 50344.365, "learn_throughput": 79.453, "synch_weights_time_ms": 15.072}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "645a5_00000", "date": "2024-08-22_12-25-25", "timestamp": 1724309725, "time_this_iter_s": 53.114850759506226, "time_total_s": 1920.8967163562775, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a136790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1920.8967163562775, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 28.52533333333333, "ram_util_percent": 82.91866666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.884071940089029, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.45925653195255, "policy_loss": -0.01412940232437991, "vf_loss": 6.471228907600282, "vf_explained_var": 0.29282789104199286, "kl": 0.010785173702364167, "entropy": 0.7555965016758631, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 965.7624999999972}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.879371820366572, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.800773020396157, "policy_loss": -0.02069005533096888, "vf_loss": 6.818681902607913, "vf_explained_var": 0.26972995561266705, "kl": 0.013905967496552322, "entropy": 0.9520025543750279, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 965.7624999999972}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 600.6, "episode_reward_min": -23.517792898195182, "episode_reward_mean": 151.35112515737367, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1565.246372354459, "predator_policy": 0.8813419862421855}, "policy_reward_max": {"prey_policy": 347.68426747765557, "predator_policy": 1483.7051324621762}, "policy_reward_mean": {"prey_policy": -510.0885778844129, "predator_policy": 585.764140463101}, "custom_metrics": {}, "hist_stats": {"episode_reward": [600.6, 573.8999999999996, 398.90000000000225, 176.7087026072551, 127.13942169814095, 182.50333431657154, 126.28534222217542, 192.294844275504, 86.76619363707258, 332.8350106478024, 17.37439209902231, 323.63371582178087, 134.2999445697544, 87.59457002641602, 25.003202122245916, 139.91381321548354, 229.68402176213922, 237.70226725663943, 428.68301781121386, 127.22731402718543, 311.1879791710056, 119.42977557401092, 81.31232341090062, 193.79436315206712, 48.755116076658446, 166.1710112345241, 71.50448348012094, 382.20000000000255, 81.36416793455474, 304.4563384189125, 114.38860125904553, 319.8540126716582, 106.46729717305206, 155.32257219229493, 69.80000000000031, 103.93292182437986, 166.6963535086562, 55.60000000000052, 34.90000000000022, 209.2696945150931, 119.35732884675605, 483.4943855319823, 343.0561000754564, 138.84896704371312, 169.63929016154015, 13.737228333652865, 45.115246099692634, 120.44286038259496, 76.59999999999968, 63.42803351534569, 274.54986081690026, 137.6147511958341, -23.517792898195182, 276.53465678151935, 163.74190341512053, 106.5078014970241, 37.10308436297188, 26.631120181407713, 192.06613537041324, 94.59327055040124, 61.20000000000061, 183.72830643568196, -23.354588640990173, 10.786893353164242, 178.10696689390636, 242.12738473742107, 239.83614888083284, 58.713757747002056, 73.4000000000001, 63.12502099628543, 249.31433571406595, 19.13469190885889, -15.761805248923663, 151.7319012453101, 73.30000000000011, 48.826624290603185, 87.25580134629658, 190.32294179134354, 89.45950458219504, 12.199408767207439, 129.7017722762014, 367.0640384131007, 218.3506536477932, 136.50851133366552, 73.00000000000013, 8.329722865868858, 294.3030399897615, 139.59373902184007, 223.14535894885168, 226.0898897904417, 8.693364122595925, 231.15374046019315, 82.72396626933038, 144.18583600322668, 38.72566805472415, 77.51250941754606, 184.89185339649993, 33.5852059479879, 7.599999999999982, 11.499999999999968], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-254.25013255884284, 279.38846555046433, 347.68426747765557, -281.08985494400065, 274.87006351601485, 34.16099648628211, -207.8664035651469, -1070.1981511627625, -86.9552659317021, -224.43430576153355, -151.27375387136414, 50.64529976571668, -654.5130273003263, -1231.5591351732337, -905.512841622566, -66.07429274280818, 6.448115983473649, -395.74797689165547, -694.6274884161876, -770.1388899080556, -810.6794363331643, -1078.768352791078, -531.8307612321826, -618.9049824373748, -259.52895566964315, -132.28926140963662, -94.85302356341235, -987.5992744249075, -235.2072893937638, -1319.752530525861, -542.1466322544408, -80.16389332578687, -1047.2479964949318, -463.8145017986088, 26.560407359413446, -1269.6214970556703, -1371.3390831789163, -11.839674195247287, -167.81047185058208, -1365.0308011399281, -931.1387408837309, -1005.814489996229, -142.70375943690007, -909.3394718309354, 40.0000000000003, -172.70202115979592, -410.16258060382427, -509.7826119510322, -351.98021485145927, -305.48956627385417, -707.1725353404624, -93.03997370786779, -575.0448697591185, -826.4208348745464, -441.47521988176595, 246.7745652702019, -218.5276981468463, 26.11438343851167, -381.70352042475815, -1381.1197660336977, -270.3011193580531, -631.2006130984058, -1022.4973026125515, -464.5850801397325, -579.7696591121111, -60.86931725458629, -759.1982923200027, -572.5818512742752, -21.398961721839527, -204.1098571029404, -52.1463548277005, -379.8019241263629, 42.97088809615789, -531.1010128937328, -593.2078063068551, -20.263781995861436, -797.437636554596, -580.4663037685133, -762.8959736139266, -846.4960528833622, -1565.246372354459, -230.86423057721674, 105.6102096731183, 261.77832082378944, 101.70147774930103, -781.6336163687497, 0.4839449758062696, -756.4173894100176, -988.9383666340655, -524.1013589877927, -594.4977819016636, -370.10391926960807, -403.989791431679, -936.0104122370366, -441.8994459659178, -1016.1956255652033, 20.578764538750494, -745.2391706002868, -684.2123288537074, -675.4490514891563, -105.93945996382871, -1144.6511973922459, -85.66266401938209, -1089.9243442704733, -930.7032762940236, -735.8964754052853, -731.2027401602758, -973.502777029269, -414.251067539997, -262.815409417306, -582.5986178912457, -208.7698243316238, -852.6570832918454, -551.9553403769369, -1026.7691928774093, -1097.676382224858, -132.65817370980298, -1206.2473582348885, -984.3628302762397, -393.3324178200984, 31.783661654543078, -470.72443320313425, -462.3797289515853, -984.5211664540128, -354.80650647538806, -681.7907737975186, -65.40727018439797, -544.1652748936925, -963.4989307883511, -349.30329597368257, 20.190662135100396, -937.4939268703029, -741.9336943288407, -83.67959637770221, -960.42605330978, -1026.0554928199404, 26.23356766574627, -102.06593211692973, -736.0214010640881, -167.6375218293108, 83.80146618005375, -243.84626248593258, -141.86343437947596, -406.28973753983496, -404.2840377227572, -804.3202557517329, -260.99713270706246, -581.9029414632433, 13.464069351197743, -46.18902678596006, -310.5813471500364, -598.5729581248145, -323.7829749461525, -846.3645019288082, -655.833540254612, -460.32660168697595, -785.0716718473517, -521.1549003821408, -342.2870440665342, -687.4698755058077, -435.80314810868356, -613.2586590211596, -490.2706538838279, -236.89704405815354, -756.1147862620032, -5.003946419233822, -838.8596283030264, -640.9169323668448, -112.98900899463061, 36.08583777359439, -197.22725878791877, -712.1453805868889, -38.40494075890473, -598.2960612816835, -1061.8813113188553, -258.14527487951796, -756.0410594440497, -540.9948103907, 13.955350945072576, -353.8637541593511, -571.6901406040479, -860.7169879070902, -212.67203327538988, -447.0830194634429, -401.8843914015678, -848.8727651185606, -304.0102113539485, -1163.1030136741292, -252.24169204186072, -965.8800013740563, -406.1591762370525, -477.02276822374, -633.2659299073285, -551.7317876384798, -801.3913001414811, -1351.394082506261, -1129.826457504977, -1215.7420532769133, -1207.552306765575, -1483.605132462176], "policy_predator_policy_reward": [494.4501325588429, 81.01153444953566, 18.119811650579248, 489.1857758157671, 3.2217313509487084, 86.64720864675454, 504.3038458205567, 950.4694115146076, 331.4586016631589, 107.07039172821715, 91.44529176943266, 191.6864966527883, 775.5905065281027, 1236.76699816763, 262.2118404725451, 901.6701381683351, 421.39156267671706, 54.67449186854429, 1088.400631918437, 709.20075705361, 821.5462011664251, 1085.27598005684, 865.8057339428734, 608.5637255484662, 400.81008566937965, 125.30807597966088, 955.4184601154391, 214.62840789929783, 418.64222812292843, 1161.3207939189388, 510.20849525662084, 252.01584353909672, 820.3184346536309, 920.428085402054, 241.06415523304952, 1239.6992017198443, 886.6097040584315, 925.2520711269333, 1264.6405138612602, 395.4280731564355, 1316.0502665952552, 932.0909434557117, 262.67770466391795, 908.7953021779268, 9.112323410900942, 204.9020211597941, 369.9423939471573, 743.7971617597782, 35.6647637706229, 670.5601334313544, 724.9725353404665, 241.41098494239202, 777.2764230310833, 695.6937650827085, 571.3167908250989, 5.583863786471815, 252.0276981468444, 21.749784496043475, 1282.8925805782817, 784.3870442990878, 1015.0089917292632, 0.8813419862421855, 827.2029449043032, 979.7334505196449, 531.9776718754175, 215.12860166433705, 1046.4460389403976, 440.65667684617824, 58.398961721840045, 236.9098571029386, 130.5258375639787, 405.3553632144641, 37.61457095299477, 617.2119073532418, 613.5078063068595, 55.56378199586192, 814.1376365545998, 598.6663037685174, 971.1571063561757, 847.5046146562091, 680.1212938482464, 1235.346637930187, 46.07405402455705, 70.03180101051169, 2.91061355533125, 1020.0776251395746, 228.6767782515146, 666.1056332264158, 936.4097694144998, 746.2692463689083, 312.9012520791114, 665.4376774258213, 427.4398109777563, 957.6756387906522, 835.1321936504979, 743.405738263225, 758.0755506738377, 43.18485538769881, 502.0139813220137, 921.0754325362024, 978.027790349466, 547.1127278235119, 235.67050027248956, 1077.531259213198, 965.339313539673, 677.7426452614457, 787.286871310411, 1193.9533026606541, 408.72031869865236, 432.0880616737787, 381.09613220929907, 516.7801115105996, 828.1484606996, 613.5670473321593, 1040.2778088583923, 1110.7988864252818, 678.6250979813508, 852.3465693337515, 668.1394577840033, 804.1490608627417, 7.516338345457098, 492.6244332031391, 768.8339562106901, 861.795245630598, 1.6412971742204452, 1011.6013944577031, 24.550067030565685, 595.8093714006894, 1138.1520821287427, 352.75711152719833, 127.2948854540494, 1032.1357640185752, 816.4066295800106, 249.0428100073671, 855.9802530302836, 1189.2150508464324, 12.866432334253805, 136.36593211692778, 842.8398407932143, 123.94410309646699, 253.1608838672101, 156.19824815273972, 54.868156616556014, 512.4197072116165, 298.44253277739534, 894.3999554481763, 712.8856161058927, 281.7463593097292, 24.635930648802308, 81.38902678595933, 632.0755663859629, 325.9053631795017, 389.7387762924568, 867.6645019288101, 680.905061320168, 625.5780224127645, 670.2548192867087, 725.4312575249861, 207.25409955387718, 834.7022287856802, 555.6408380831668, 623.1227413228825, 457.74719027053465, 636.4845460845454, 771.8528705353547, 207.61651579367532, 604.0897686880041, 1012.195303315537, 146.28900899462872, 3.6141622264058517, 712.921478054891, 204.78088418578443, 422.3601797535192, 508.64386227682616, 1052.7079097767416, 406.912415443474, 1138.6130582526514, 381.56817053095097, 233.25318832289355, 332.74510468183666, 642.4268770782384, 798.6736155554979, 460.6584658979112, 430.2503273011215, 369.88111469345813, 963.6000080960046, 560.7845441631968, 1050.514516868107, 1171.1340264823084, 85.71333498833205, 942.3471711173277, 18.347282761019038, 607.967160367918, 761.9224105743953, 829.5393528201522, 1356.8312357755722, 1135.8264575049732, 1217.3420532769137, 1218.9523067655655, 1483.7051324621762]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.034859472442073, "mean_inference_ms": 5.5335229842095055, "mean_action_processing_ms": 2.182689364750353, "mean_env_wait_ms": 12.419807857335629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005659937858581543, "StateBufferConnector_ms": 0.009282588958740234, "ViewRequirementAgentConnector_ms": 0.14060473442077637}, "num_episodes": 4, "episode_return_max": 600.6, "episode_return_min": -23.517792898195182, "episode_return_mean": 151.35112515737367, "episodes_this_iter": 4}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.38637073304122, "num_env_steps_trained_throughput_per_sec": 75.38637073304122, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 52571.516, "restore_workers_time_ms": 0.015, "training_step_time_ms": 52571.464, "sample_time_ms": 2168.666, "learn_time_ms": 50384.866, "learn_throughput": 79.389, "synch_weights_time_ms": 15.068}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "645a5_00000", "date": "2024-08-22_12-26-19", "timestamp": 1724309779, "time_this_iter_s": 53.109400033950806, "time_total_s": 1974.0061163902283, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a16adc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1974.0061163902283, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 29.862666666666666, "ram_util_percent": 83.09466666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.621369513885054, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.951127910866308, "policy_loss": -0.017648377478930843, "vf_loss": 5.966080159989614, "vf_explained_var": 0.42773040596139494, "kl": 0.013480693438440246, "entropy": 0.7842969482222563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 1028.1324999999997}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.37132793936149, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.237820526405617, "policy_loss": -0.02372921379036689, "vf_loss": 6.258518105209189, "vf_explained_var": 0.3083381581243384, "kl": 0.015158201296808858, "entropy": 0.9470226524368165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 1028.1324999999997}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 935.8627720494608, "episode_reward_min": -23.517792898195182, "episode_reward_mean": 143.42672829993128, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1649.5812722655594, "predator_policy": 0.8813419862421855}, "policy_reward_max": {"prey_policy": 261.77832082378944, "predator_policy": 1653.0816001597748}, "policy_reward_mean": {"prey_policy": -553.0550282973222, "predator_policy": 624.7683924472891}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.37439209902231, 323.63371582178087, 134.2999445697544, 87.59457002641602, 25.003202122245916, 139.91381321548354, 229.68402176213922, 237.70226725663943, 428.68301781121386, 127.22731402718543, 311.1879791710056, 119.42977557401092, 81.31232341090062, 193.79436315206712, 48.755116076658446, 166.1710112345241, 71.50448348012094, 382.20000000000255, 81.36416793455474, 304.4563384189125, 114.38860125904553, 319.8540126716582, 106.46729717305206, 155.32257219229493, 69.80000000000031, 103.93292182437986, 166.6963535086562, 55.60000000000052, 34.90000000000022, 209.2696945150931, 119.35732884675605, 483.4943855319823, 343.0561000754564, 138.84896704371312, 169.63929016154015, 13.737228333652865, 45.115246099692634, 120.44286038259496, 76.59999999999968, 63.42803351534569, 274.54986081690026, 137.6147511958341, -23.517792898195182, 276.53465678151935, 163.74190341512053, 106.5078014970241, 37.10308436297188, 26.631120181407713, 192.06613537041324, 94.59327055040124, 61.20000000000061, 183.72830643568196, -23.354588640990173, 10.786893353164242, 178.10696689390636, 242.12738473742107, 239.83614888083284, 58.713757747002056, 73.4000000000001, 63.12502099628543, 249.31433571406595, 19.13469190885889, -15.761805248923663, 151.7319012453101, 73.30000000000011, 48.826624290603185, 87.25580134629658, 190.32294179134354, 89.45950458219504, 12.199408767207439, 129.7017722762014, 367.0640384131007, 218.3506536477932, 136.50851133366552, 73.00000000000013, 8.329722865868858, 294.3030399897615, 139.59373902184007, 223.14535894885168, 226.0898897904417, 8.693364122595925, 231.15374046019315, 82.72396626933038, 144.18583600322668, 38.72566805472415, 77.51250941754606, 184.89185339649993, 33.5852059479879, 7.599999999999982, 11.499999999999968, 200.38078330686048, 339.6357653572295, 11.59999999999998, 935.8627720494608, 118.73243315865092, 100.27731613067306, 126.33331389264768, 114.37202660958332, 19.027905925112083, 39.27084723007054], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-810.6794363331643, -1078.768352791078, -531.8307612321826, -618.9049824373748, -259.52895566964315, -132.28926140963662, -94.85302356341235, -987.5992744249075, -235.2072893937638, -1319.752530525861, -542.1466322544408, -80.16389332578687, -1047.2479964949318, -463.8145017986088, 26.560407359413446, -1269.6214970556703, -1371.3390831789163, -11.839674195247287, -167.81047185058208, -1365.0308011399281, -931.1387408837309, -1005.814489996229, -142.70375943690007, -909.3394718309354, 40.0000000000003, -172.70202115979592, -410.16258060382427, -509.7826119510322, -351.98021485145927, -305.48956627385417, -707.1725353404624, -93.03997370786779, -575.0448697591185, -826.4208348745464, -441.47521988176595, 246.7745652702019, -218.5276981468463, 26.11438343851167, -381.70352042475815, -1381.1197660336977, -270.3011193580531, -631.2006130984058, -1022.4973026125515, -464.5850801397325, -579.7696591121111, -60.86931725458629, -759.1982923200027, -572.5818512742752, -21.398961721839527, -204.1098571029404, -52.1463548277005, -379.8019241263629, 42.97088809615789, -531.1010128937328, -593.2078063068551, -20.263781995861436, -797.437636554596, -580.4663037685133, -762.8959736139266, -846.4960528833622, -1565.246372354459, -230.86423057721674, 105.6102096731183, 261.77832082378944, 101.70147774930103, -781.6336163687497, 0.4839449758062696, -756.4173894100176, -988.9383666340655, -524.1013589877927, -594.4977819016636, -370.10391926960807, -403.989791431679, -936.0104122370366, -441.8994459659178, -1016.1956255652033, 20.578764538750494, -745.2391706002868, -684.2123288537074, -675.4490514891563, -105.93945996382871, -1144.6511973922459, -85.66266401938209, -1089.9243442704733, -930.7032762940236, -735.8964754052853, -731.2027401602758, -973.502777029269, -414.251067539997, -262.815409417306, -582.5986178912457, -208.7698243316238, -852.6570832918454, -551.9553403769369, -1026.7691928774093, -1097.676382224858, -132.65817370980298, -1206.2473582348885, -984.3628302762397, -393.3324178200984, 31.783661654543078, -470.72443320313425, -462.3797289515853, -984.5211664540128, -354.80650647538806, -681.7907737975186, -65.40727018439797, -544.1652748936925, -963.4989307883511, -349.30329597368257, 20.190662135100396, -937.4939268703029, -741.9336943288407, -83.67959637770221, -960.42605330978, -1026.0554928199404, 26.23356766574627, -102.06593211692973, -736.0214010640881, -167.6375218293108, 83.80146618005375, -243.84626248593258, -141.86343437947596, -406.28973753983496, -404.2840377227572, -804.3202557517329, -260.99713270706246, -581.9029414632433, 13.464069351197743, -46.18902678596006, -310.5813471500364, -598.5729581248145, -323.7829749461525, -846.3645019288082, -655.833540254612, -460.32660168697595, -785.0716718473517, -521.1549003821408, -342.2870440665342, -687.4698755058077, -435.80314810868356, -613.2586590211596, -490.2706538838279, -236.89704405815354, -756.1147862620032, -5.003946419233822, -838.8596283030264, -640.9169323668448, -112.98900899463061, 36.08583777359439, -197.22725878791877, -712.1453805868889, -38.40494075890473, -598.2960612816835, -1061.8813113188553, -258.14527487951796, -756.0410594440497, -540.9948103907, 13.955350945072576, -353.8637541593511, -571.6901406040479, -860.7169879070902, -212.67203327538988, -447.0830194634429, -401.8843914015678, -848.8727651185606, -304.0102113539485, -1163.1030136741292, -252.24169204186072, -965.8800013740563, -406.1591762370525, -477.02276822374, -633.2659299073285, -551.7317876384798, -801.3913001414811, -1351.394082506261, -1129.826457504977, -1215.7420532769133, -1207.552306765575, -1483.605132462176, -28.757284117570727, -871.778674351904, -1099.3123035380459, -386.17306470081803, -1382.598104233421, -1649.5812722655594, -1018.8951141898613, 21.066360395409085, -98.95693704463065, -623.9354377385926, -213.38556745259743, -980.7703524564414, -1282.6371094719227, -759.6529828890585, -476.4251010774283, -1079.1203316485305, -320.13204578288514, -812.5469120909014, -42.067859475514936, -1488.674299522173], "policy_predator_policy_reward": [821.5462011664251, 1085.27598005684, 865.8057339428734, 608.5637255484662, 400.81008566937965, 125.30807597966088, 955.4184601154391, 214.62840789929783, 418.64222812292843, 1161.3207939189388, 510.20849525662084, 252.01584353909672, 820.3184346536309, 920.428085402054, 241.06415523304952, 1239.6992017198443, 886.6097040584315, 925.2520711269333, 1264.6405138612602, 395.4280731564355, 1316.0502665952552, 932.0909434557117, 262.67770466391795, 908.7953021779268, 9.112323410900942, 204.9020211597941, 369.9423939471573, 743.7971617597782, 35.6647637706229, 670.5601334313544, 724.9725353404665, 241.41098494239202, 777.2764230310833, 695.6937650827085, 571.3167908250989, 5.583863786471815, 252.0276981468444, 21.749784496043475, 1282.8925805782817, 784.3870442990878, 1015.0089917292632, 0.8813419862421855, 827.2029449043032, 979.7334505196449, 531.9776718754175, 215.12860166433705, 1046.4460389403976, 440.65667684617824, 58.398961721840045, 236.9098571029386, 130.5258375639787, 405.3553632144641, 37.61457095299477, 617.2119073532418, 613.5078063068595, 55.56378199586192, 814.1376365545998, 598.6663037685174, 971.1571063561757, 847.5046146562091, 680.1212938482464, 1235.346637930187, 46.07405402455705, 70.03180101051169, 2.91061355533125, 1020.0776251395746, 228.6767782515146, 666.1056332264158, 936.4097694144998, 746.2692463689083, 312.9012520791114, 665.4376774258213, 427.4398109777563, 957.6756387906522, 835.1321936504979, 743.405738263225, 758.0755506738377, 43.18485538769881, 502.0139813220137, 921.0754325362024, 978.027790349466, 547.1127278235119, 235.67050027248956, 1077.531259213198, 965.339313539673, 677.7426452614457, 787.286871310411, 1193.9533026606541, 408.72031869865236, 432.0880616737787, 381.09613220929907, 516.7801115105996, 828.1484606996, 613.5670473321593, 1040.2778088583923, 1110.7988864252818, 678.6250979813508, 852.3465693337515, 668.1394577840033, 804.1490608627417, 7.516338345457098, 492.6244332031391, 768.8339562106901, 861.795245630598, 1.6412971742204452, 1011.6013944577031, 24.550067030565685, 595.8093714006894, 1138.1520821287427, 352.75711152719833, 127.2948854540494, 1032.1357640185752, 816.4066295800106, 249.0428100073671, 855.9802530302836, 1189.2150508464324, 12.866432334253805, 136.36593211692778, 842.8398407932143, 123.94410309646699, 253.1608838672101, 156.19824815273972, 54.868156616556014, 512.4197072116165, 298.44253277739534, 894.3999554481763, 712.8856161058927, 281.7463593097292, 24.635930648802308, 81.38902678595933, 632.0755663859629, 325.9053631795017, 389.7387762924568, 867.6645019288101, 680.905061320168, 625.5780224127645, 670.2548192867087, 725.4312575249861, 207.25409955387718, 834.7022287856802, 555.6408380831668, 623.1227413228825, 457.74719027053465, 636.4845460845454, 771.8528705353547, 207.61651579367532, 604.0897686880041, 1012.195303315537, 146.28900899462872, 3.6141622264058517, 712.921478054891, 204.78088418578443, 422.3601797535192, 508.64386227682616, 1052.7079097767416, 406.912415443474, 1138.6130582526514, 381.56817053095097, 233.25318832289355, 332.74510468183666, 642.4268770782384, 798.6736155554979, 460.6584658979112, 430.2503273011215, 369.88111469345813, 963.6000080960046, 560.7845441631968, 1050.514516868107, 1171.1340264823084, 85.71333498833205, 942.3471711173277, 18.347282761019038, 607.967160367918, 761.9224105743953, 829.5393528201522, 1356.8312357755722, 1135.8264575049732, 1217.3420532769137, 1218.9523067655655, 1483.7051324621762, 448.21335952240116, 652.7033822539402, 1021.7836292479168, 803.3375043481784, 1653.0816001597748, 1390.6977763392038, 900.8166024690366, 1032.8749233748767, 160.11308405065958, 681.5117238912203, 309.38543152348586, 985.047804516227, 1251.6192469613338, 917.0041592923002, 742.4457419410882, 927.4717173944532, 357.92908071638476, 793.7777830825207, 80.03870670558489, 1489.9742995221718]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.975557915161091, "mean_inference_ms": 5.476811373803927, "mean_action_processing_ms": 2.151287789404953, "mean_env_wait_ms": 12.42446701172875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005742192268371582, "StateBufferConnector_ms": 0.009251713752746582, "ViewRequirementAgentConnector_ms": 0.12869572639465332}, "num_episodes": 10, "episode_return_max": 935.8627720494608, "episode_return_min": -23.517792898195182, "episode_return_mean": 143.42672829993128, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.41551055933115, "num_env_steps_trained_throughput_per_sec": 76.41551055933115, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 52556.8, "restore_workers_time_ms": 0.015, "training_step_time_ms": 52556.754, "sample_time_ms": 2142.621, "learn_time_ms": 50396.21, "learn_throughput": 79.371, "synch_weights_time_ms": 15.118}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "645a5_00000", "date": "2024-08-22_12-27-11", "timestamp": 1724309831, "time_this_iter_s": 52.40567207336426, "time_total_s": 2026.4117884635925, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a136e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2026.4117884635925, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 28.04864864864864, "ram_util_percent": 83.03513513513514}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.532939020035759, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.9955846995903705, "policy_loss": -0.01290993966093218, "vf_loss": 6.006014779509691, "vf_explained_var": 0.3430563787619273, "kl": 0.012399400816244818, "entropy": 0.770762952704909, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 965.2900000000008}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.623459308708786, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.667893656473312, "policy_loss": -0.019008874580899757, "vf_loss": 6.6840512651615045, "vf_explained_var": 0.36155540794922564, "kl": 0.014256298997582345, "entropy": 0.9276419801371438, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 965.2900000000008}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 935.8627720494608, "episode_reward_min": -50.47238596016277, "episode_reward_mean": 133.85488796019655, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1649.5812722655594, "predator_policy": 0.8813419862421855}, "policy_reward_max": {"prey_policy": 261.77832082378944, "predator_policy": 1653.0816001597748}, "policy_reward_mean": {"prey_policy": -569.5610264399871, "predator_policy": 636.4884704200867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [311.1879791710056, 119.42977557401092, 81.31232341090062, 193.79436315206712, 48.755116076658446, 166.1710112345241, 71.50448348012094, 382.20000000000255, 81.36416793455474, 304.4563384189125, 114.38860125904553, 319.8540126716582, 106.46729717305206, 155.32257219229493, 69.80000000000031, 103.93292182437986, 166.6963535086562, 55.60000000000052, 34.90000000000022, 209.2696945150931, 119.35732884675605, 483.4943855319823, 343.0561000754564, 138.84896704371312, 169.63929016154015, 13.737228333652865, 45.115246099692634, 120.44286038259496, 76.59999999999968, 63.42803351534569, 274.54986081690026, 137.6147511958341, -23.517792898195182, 276.53465678151935, 163.74190341512053, 106.5078014970241, 37.10308436297188, 26.631120181407713, 192.06613537041324, 94.59327055040124, 61.20000000000061, 183.72830643568196, -23.354588640990173, 10.786893353164242, 178.10696689390636, 242.12738473742107, 239.83614888083284, 58.713757747002056, 73.4000000000001, 63.12502099628543, 249.31433571406595, 19.13469190885889, -15.761805248923663, 151.7319012453101, 73.30000000000011, 48.826624290603185, 87.25580134629658, 190.32294179134354, 89.45950458219504, 12.199408767207439, 129.7017722762014, 367.0640384131007, 218.3506536477932, 136.50851133366552, 73.00000000000013, 8.329722865868858, 294.3030399897615, 139.59373902184007, 223.14535894885168, 226.0898897904417, 8.693364122595925, 231.15374046019315, 82.72396626933038, 144.18583600322668, 38.72566805472415, 77.51250941754606, 184.89185339649993, 33.5852059479879, 7.599999999999982, 11.499999999999968, 200.38078330686048, 339.6357653572295, 11.59999999999998, 935.8627720494608, 118.73243315865092, 100.27731613067306, 126.33331389264768, 114.37202660958332, 19.027905925112083, 39.27084723007054, 309.5200950389966, 119.93457951187955, 222.75365215811735, 228.42092692163047, 27.280973164415656, -28.189879726063623, -37.394977411747455, -50.47238596016277, 8.961058557608187, -6.8818175162657305], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-931.1387408837309, -1005.814489996229, -142.70375943690007, -909.3394718309354, 40.0000000000003, -172.70202115979592, -410.16258060382427, -509.7826119510322, -351.98021485145927, -305.48956627385417, -707.1725353404624, -93.03997370786779, -575.0448697591185, -826.4208348745464, -441.47521988176595, 246.7745652702019, -218.5276981468463, 26.11438343851167, -381.70352042475815, -1381.1197660336977, -270.3011193580531, -631.2006130984058, -1022.4973026125515, -464.5850801397325, -579.7696591121111, -60.86931725458629, -759.1982923200027, -572.5818512742752, -21.398961721839527, -204.1098571029404, -52.1463548277005, -379.8019241263629, 42.97088809615789, -531.1010128937328, -593.2078063068551, -20.263781995861436, -797.437636554596, -580.4663037685133, -762.8959736139266, -846.4960528833622, -1565.246372354459, -230.86423057721674, 105.6102096731183, 261.77832082378944, 101.70147774930103, -781.6336163687497, 0.4839449758062696, -756.4173894100176, -988.9383666340655, -524.1013589877927, -594.4977819016636, -370.10391926960807, -403.989791431679, -936.0104122370366, -441.8994459659178, -1016.1956255652033, 20.578764538750494, -745.2391706002868, -684.2123288537074, -675.4490514891563, -105.93945996382871, -1144.6511973922459, -85.66266401938209, -1089.9243442704733, -930.7032762940236, -735.8964754052853, -731.2027401602758, -973.502777029269, -414.251067539997, -262.815409417306, -582.5986178912457, -208.7698243316238, -852.6570832918454, -551.9553403769369, -1026.7691928774093, -1097.676382224858, -132.65817370980298, -1206.2473582348885, -984.3628302762397, -393.3324178200984, 31.783661654543078, -470.72443320313425, -462.3797289515853, -984.5211664540128, -354.80650647538806, -681.7907737975186, -65.40727018439797, -544.1652748936925, -963.4989307883511, -349.30329597368257, 20.190662135100396, -937.4939268703029, -741.9336943288407, -83.67959637770221, -960.42605330978, -1026.0554928199404, 26.23356766574627, -102.06593211692973, -736.0214010640881, -167.6375218293108, 83.80146618005375, -243.84626248593258, -141.86343437947596, -406.28973753983496, -404.2840377227572, -804.3202557517329, -260.99713270706246, -581.9029414632433, 13.464069351197743, -46.18902678596006, -310.5813471500364, -598.5729581248145, -323.7829749461525, -846.3645019288082, -655.833540254612, -460.32660168697595, -785.0716718473517, -521.1549003821408, -342.2870440665342, -687.4698755058077, -435.80314810868356, -613.2586590211596, -490.2706538838279, -236.89704405815354, -756.1147862620032, -5.003946419233822, -838.8596283030264, -640.9169323668448, -112.98900899463061, 36.08583777359439, -197.22725878791877, -712.1453805868889, -38.40494075890473, -598.2960612816835, -1061.8813113188553, -258.14527487951796, -756.0410594440497, -540.9948103907, 13.955350945072576, -353.8637541593511, -571.6901406040479, -860.7169879070902, -212.67203327538988, -447.0830194634429, -401.8843914015678, -848.8727651185606, -304.0102113539485, -1163.1030136741292, -252.24169204186072, -965.8800013740563, -406.1591762370525, -477.02276822374, -633.2659299073285, -551.7317876384798, -801.3913001414811, -1351.394082506261, -1129.826457504977, -1215.7420532769133, -1207.552306765575, -1483.605132462176, -28.757284117570727, -871.778674351904, -1099.3123035380459, -386.17306470081803, -1382.598104233421, -1649.5812722655594, -1018.8951141898613, 21.066360395409085, -98.95693704463065, -623.9354377385926, -213.38556745259743, -980.7703524564414, -1282.6371094719227, -759.6529828890585, -476.4251010774283, -1079.1203316485305, -320.13204578288514, -812.5469120909014, -42.067859475514936, -1488.674299522173, -514.7891619452639, -1116.500532095999, -717.834861666313, -908.556688273686, -551.7622005440213, -755.5842274653543, -834.2996748224617, -1289.1446376729523, -1417.1662628319134, -338.70792701427365, -701.1448634967971, -597.1551108552407, -1321.7142326797468, -928.6306315481261, -656.568916588843, -785.7221561281431, -869.8217895832452, -382.1633894538827, -66.73171761561709, -909.0686579668222], "policy_predator_policy_reward": [1316.0502665952552, 932.0909434557117, 262.67770466391795, 908.7953021779268, 9.112323410900942, 204.9020211597941, 369.9423939471573, 743.7971617597782, 35.6647637706229, 670.5601334313544, 724.9725353404665, 241.41098494239202, 777.2764230310833, 695.6937650827085, 571.3167908250989, 5.583863786471815, 252.0276981468444, 21.749784496043475, 1282.8925805782817, 784.3870442990878, 1015.0089917292632, 0.8813419862421855, 827.2029449043032, 979.7334505196449, 531.9776718754175, 215.12860166433705, 1046.4460389403976, 440.65667684617824, 58.398961721840045, 236.9098571029386, 130.5258375639787, 405.3553632144641, 37.61457095299477, 617.2119073532418, 613.5078063068595, 55.56378199586192, 814.1376365545998, 598.6663037685174, 971.1571063561757, 847.5046146562091, 680.1212938482464, 1235.346637930187, 46.07405402455705, 70.03180101051169, 2.91061355533125, 1020.0776251395746, 228.6767782515146, 666.1056332264158, 936.4097694144998, 746.2692463689083, 312.9012520791114, 665.4376774258213, 427.4398109777563, 957.6756387906522, 835.1321936504979, 743.405738263225, 758.0755506738377, 43.18485538769881, 502.0139813220137, 921.0754325362024, 978.027790349466, 547.1127278235119, 235.67050027248956, 1077.531259213198, 965.339313539673, 677.7426452614457, 787.286871310411, 1193.9533026606541, 408.72031869865236, 432.0880616737787, 381.09613220929907, 516.7801115105996, 828.1484606996, 613.5670473321593, 1040.2778088583923, 1110.7988864252818, 678.6250979813508, 852.3465693337515, 668.1394577840033, 804.1490608627417, 7.516338345457098, 492.6244332031391, 768.8339562106901, 861.795245630598, 1.6412971742204452, 1011.6013944577031, 24.550067030565685, 595.8093714006894, 1138.1520821287427, 352.75711152719833, 127.2948854540494, 1032.1357640185752, 816.4066295800106, 249.0428100073671, 855.9802530302836, 1189.2150508464324, 12.866432334253805, 136.36593211692778, 842.8398407932143, 123.94410309646699, 253.1608838672101, 156.19824815273972, 54.868156616556014, 512.4197072116165, 298.44253277739534, 894.3999554481763, 712.8856161058927, 281.7463593097292, 24.635930648802308, 81.38902678595933, 632.0755663859629, 325.9053631795017, 389.7387762924568, 867.6645019288101, 680.905061320168, 625.5780224127645, 670.2548192867087, 725.4312575249861, 207.25409955387718, 834.7022287856802, 555.6408380831668, 623.1227413228825, 457.74719027053465, 636.4845460845454, 771.8528705353547, 207.61651579367532, 604.0897686880041, 1012.195303315537, 146.28900899462872, 3.6141622264058517, 712.921478054891, 204.78088418578443, 422.3601797535192, 508.64386227682616, 1052.7079097767416, 406.912415443474, 1138.6130582526514, 381.56817053095097, 233.25318832289355, 332.74510468183666, 642.4268770782384, 798.6736155554979, 460.6584658979112, 430.2503273011215, 369.88111469345813, 963.6000080960046, 560.7845441631968, 1050.514516868107, 1171.1340264823084, 85.71333498833205, 942.3471711173277, 18.347282761019038, 607.967160367918, 761.9224105743953, 829.5393528201522, 1356.8312357755722, 1135.8264575049732, 1217.3420532769137, 1218.9523067655655, 1483.7051324621762, 448.21335952240116, 652.7033822539402, 1021.7836292479168, 803.3375043481784, 1653.0816001597748, 1390.6977763392038, 900.8166024690366, 1032.8749233748767, 160.11308405065958, 681.5117238912203, 309.38543152348586, 985.047804516227, 1251.6192469613338, 917.0041592923002, 742.4457419410882, 927.4717173944532, 357.92908071638476, 793.7777830825207, 80.03870670558489, 1489.9742995221718, 1070.9882367702028, 869.8215523100583, 801.2169903634455, 945.1091390884402, 708.7978950463388, 821.3021851211572, 1353.074437227884, 998.7908021891643, 1417.1662628319134, 365.9889001786957, 806.1384191228435, 463.97167550313475, 1468.4186002958165, 744.5312865203055, 381.5304782426687, 1010.2882085141604, 1226.7495818246882, 34.19665577004913, 295.34005601917755, 673.578502046998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.926975467955502, "mean_inference_ms": 5.445669457729061, "mean_action_processing_ms": 2.1377042974149316, "mean_env_wait_ms": 12.405933336751765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005626797676086426, "StateBufferConnector_ms": 0.009230852127075195, "ViewRequirementAgentConnector_ms": 0.13244080543518066}, "num_episodes": 10, "episode_return_max": 935.8627720494608, "episode_return_min": -50.47238596016277, "episode_return_mean": 133.85488796019655, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.15815510137305, "num_env_steps_trained_throughput_per_sec": 75.15815510137305, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 52648.928, "restore_workers_time_ms": 0.015, "training_step_time_ms": 52648.883, "sample_time_ms": 2244.017, "learn_time_ms": 50386.958, "learn_throughput": 79.386, "synch_weights_time_ms": 14.928}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "645a5_00000", "date": "2024-08-22_12-28-04", "timestamp": 1724309884, "time_this_iter_s": 53.27743697166443, "time_total_s": 2079.689225435257, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a121820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2079.689225435257, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 30.052000000000007, "ram_util_percent": 83.05866666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.073817670345306, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.740377252568644, "policy_loss": -0.013718311079142113, "vf_loss": 5.751838934610761, "vf_explained_var": 0.36445763136343984, "kl": 0.01128317055110105, "entropy": 0.7948537356639035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.072093506370273, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.916838884605933, "policy_loss": -0.01744326083186679, "vf_loss": 5.9317381704925864, "vf_explained_var": 0.3137893876386067, "kl": 0.012719811093328254, "entropy": 0.976086677792211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 935.8627720494608, "episode_reward_min": -90.6875086860469, "episode_reward_mean": 115.86654901555006, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1649.5812722655594, "predator_policy": 1.6412971742204452}, "policy_reward_max": {"prey_policy": 261.77832082378944, "predator_policy": 1653.0816001597748}, "policy_reward_mean": {"prey_policy": -595.1819975857521, "predator_policy": 653.1152720935283}, "custom_metrics": {}, "hist_stats": {"episode_reward": [155.32257219229493, 69.80000000000031, 103.93292182437986, 166.6963535086562, 55.60000000000052, 34.90000000000022, 209.2696945150931, 119.35732884675605, 483.4943855319823, 343.0561000754564, 138.84896704371312, 169.63929016154015, 13.737228333652865, 45.115246099692634, 120.44286038259496, 76.59999999999968, 63.42803351534569, 274.54986081690026, 137.6147511958341, -23.517792898195182, 276.53465678151935, 163.74190341512053, 106.5078014970241, 37.10308436297188, 26.631120181407713, 192.06613537041324, 94.59327055040124, 61.20000000000061, 183.72830643568196, -23.354588640990173, 10.786893353164242, 178.10696689390636, 242.12738473742107, 239.83614888083284, 58.713757747002056, 73.4000000000001, 63.12502099628543, 249.31433571406595, 19.13469190885889, -15.761805248923663, 151.7319012453101, 73.30000000000011, 48.826624290603185, 87.25580134629658, 190.32294179134354, 89.45950458219504, 12.199408767207439, 129.7017722762014, 367.0640384131007, 218.3506536477932, 136.50851133366552, 73.00000000000013, 8.329722865868858, 294.3030399897615, 139.59373902184007, 223.14535894885168, 226.0898897904417, 8.693364122595925, 231.15374046019315, 82.72396626933038, 144.18583600322668, 38.72566805472415, 77.51250941754606, 184.89185339649993, 33.5852059479879, 7.599999999999982, 11.499999999999968, 200.38078330686048, 339.6357653572295, 11.59999999999998, 935.8627720494608, 118.73243315865092, 100.27731613067306, 126.33331389264768, 114.37202660958332, 19.027905925112083, 39.27084723007054, 309.5200950389966, 119.93457951187955, 222.75365215811735, 228.42092692163047, 27.280973164415656, -28.189879726063623, -37.394977411747455, -50.47238596016277, 8.961058557608187, -6.8818175162657305, 138.8541111240451, -10.082028487538295, -90.6875086860469, 231.7514243373243, 19.393473685263896, -4.6462579084228866, -11.785995495431946, 50.70000000000045, -86.05227249653328, 38.486972717594945, 68.46416477301268, 45.42559175216169, 112.22989977643115], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-759.1982923200027, -572.5818512742752, -21.398961721839527, -204.1098571029404, -52.1463548277005, -379.8019241263629, 42.97088809615789, -531.1010128937328, -593.2078063068551, -20.263781995861436, -797.437636554596, -580.4663037685133, -762.8959736139266, -846.4960528833622, -1565.246372354459, -230.86423057721674, 105.6102096731183, 261.77832082378944, 101.70147774930103, -781.6336163687497, 0.4839449758062696, -756.4173894100176, -988.9383666340655, -524.1013589877927, -594.4977819016636, -370.10391926960807, -403.989791431679, -936.0104122370366, -441.8994459659178, -1016.1956255652033, 20.578764538750494, -745.2391706002868, -684.2123288537074, -675.4490514891563, -105.93945996382871, -1144.6511973922459, -85.66266401938209, -1089.9243442704733, -930.7032762940236, -735.8964754052853, -731.2027401602758, -973.502777029269, -414.251067539997, -262.815409417306, -582.5986178912457, -208.7698243316238, -852.6570832918454, -551.9553403769369, -1026.7691928774093, -1097.676382224858, -132.65817370980298, -1206.2473582348885, -984.3628302762397, -393.3324178200984, 31.783661654543078, -470.72443320313425, -462.3797289515853, -984.5211664540128, -354.80650647538806, -681.7907737975186, -65.40727018439797, -544.1652748936925, -963.4989307883511, -349.30329597368257, 20.190662135100396, -937.4939268703029, -741.9336943288407, -83.67959637770221, -960.42605330978, -1026.0554928199404, 26.23356766574627, -102.06593211692973, -736.0214010640881, -167.6375218293108, 83.80146618005375, -243.84626248593258, -141.86343437947596, -406.28973753983496, -404.2840377227572, -804.3202557517329, -260.99713270706246, -581.9029414632433, 13.464069351197743, -46.18902678596006, -310.5813471500364, -598.5729581248145, -323.7829749461525, -846.3645019288082, -655.833540254612, -460.32660168697595, -785.0716718473517, -521.1549003821408, -342.2870440665342, -687.4698755058077, -435.80314810868356, -613.2586590211596, -490.2706538838279, -236.89704405815354, -756.1147862620032, -5.003946419233822, -838.8596283030264, -640.9169323668448, -112.98900899463061, 36.08583777359439, -197.22725878791877, -712.1453805868889, -38.40494075890473, -598.2960612816835, -1061.8813113188553, -258.14527487951796, -756.0410594440497, -540.9948103907, 13.955350945072576, -353.8637541593511, -571.6901406040479, -860.7169879070902, -212.67203327538988, -447.0830194634429, -401.8843914015678, -848.8727651185606, -304.0102113539485, -1163.1030136741292, -252.24169204186072, -965.8800013740563, -406.1591762370525, -477.02276822374, -633.2659299073285, -551.7317876384798, -801.3913001414811, -1351.394082506261, -1129.826457504977, -1215.7420532769133, -1207.552306765575, -1483.605132462176, -28.757284117570727, -871.778674351904, -1099.3123035380459, -386.17306470081803, -1382.598104233421, -1649.5812722655594, -1018.8951141898613, 21.066360395409085, -98.95693704463065, -623.9354377385926, -213.38556745259743, -980.7703524564414, -1282.6371094719227, -759.6529828890585, -476.4251010774283, -1079.1203316485305, -320.13204578288514, -812.5469120909014, -42.067859475514936, -1488.674299522173, -514.7891619452639, -1116.500532095999, -717.834861666313, -908.556688273686, -551.7622005440213, -755.5842274653543, -834.2996748224617, -1289.1446376729523, -1417.1662628319134, -338.70792701427365, -701.1448634967971, -597.1551108552407, -1321.7142326797468, -928.6306315481261, -656.568916588843, -785.7221561281431, -869.8217895832452, -382.1633894538827, -66.73171761561709, -909.0686579668222, 16.57142782176583, -1342.0626799059721, -666.0422167999551, -752.2880402138071, -376.8863326064458, -776.6988661934682, -586.4418865150567, -409.1457651714793, -780.5038853529287, -620.5269309300254, -1167.7328618305858, -778.8170027963458, -294.2360178352179, -1204.851325422978, -466.8430373123907, -394.39189631930964, -323.3137643873468, -1337.678884943804, -1447.9000256687711, -44.79769268510709, -60.57495860426632, -79.8357400345415, -984.417432074628, -165.07759486591175, -1031.2373820861517, -1128.4154544418282], "policy_predator_policy_reward": [1046.4460389403976, 440.65667684617824, 58.398961721840045, 236.9098571029386, 130.5258375639787, 405.3553632144641, 37.61457095299477, 617.2119073532418, 613.5078063068595, 55.56378199586192, 814.1376365545998, 598.6663037685174, 971.1571063561757, 847.5046146562091, 680.1212938482464, 1235.346637930187, 46.07405402455705, 70.03180101051169, 2.91061355533125, 1020.0776251395746, 228.6767782515146, 666.1056332264158, 936.4097694144998, 746.2692463689083, 312.9012520791114, 665.4376774258213, 427.4398109777563, 957.6756387906522, 835.1321936504979, 743.405738263225, 758.0755506738377, 43.18485538769881, 502.0139813220137, 921.0754325362024, 978.027790349466, 547.1127278235119, 235.67050027248956, 1077.531259213198, 965.339313539673, 677.7426452614457, 787.286871310411, 1193.9533026606541, 408.72031869865236, 432.0880616737787, 381.09613220929907, 516.7801115105996, 828.1484606996, 613.5670473321593, 1040.2778088583923, 1110.7988864252818, 678.6250979813508, 852.3465693337515, 668.1394577840033, 804.1490608627417, 7.516338345457098, 492.6244332031391, 768.8339562106901, 861.795245630598, 1.6412971742204452, 1011.6013944577031, 24.550067030565685, 595.8093714006894, 1138.1520821287427, 352.75711152719833, 127.2948854540494, 1032.1357640185752, 816.4066295800106, 249.0428100073671, 855.9802530302836, 1189.2150508464324, 12.866432334253805, 136.36593211692778, 842.8398407932143, 123.94410309646699, 253.1608838672101, 156.19824815273972, 54.868156616556014, 512.4197072116165, 298.44253277739534, 894.3999554481763, 712.8856161058927, 281.7463593097292, 24.635930648802308, 81.38902678595933, 632.0755663859629, 325.9053631795017, 389.7387762924568, 867.6645019288101, 680.905061320168, 625.5780224127645, 670.2548192867087, 725.4312575249861, 207.25409955387718, 834.7022287856802, 555.6408380831668, 623.1227413228825, 457.74719027053465, 636.4845460845454, 771.8528705353547, 207.61651579367532, 604.0897686880041, 1012.195303315537, 146.28900899462872, 3.6141622264058517, 712.921478054891, 204.78088418578443, 422.3601797535192, 508.64386227682616, 1052.7079097767416, 406.912415443474, 1138.6130582526514, 381.56817053095097, 233.25318832289355, 332.74510468183666, 642.4268770782384, 798.6736155554979, 460.6584658979112, 430.2503273011215, 369.88111469345813, 963.6000080960046, 560.7845441631968, 1050.514516868107, 1171.1340264823084, 85.71333498833205, 942.3471711173277, 18.347282761019038, 607.967160367918, 761.9224105743953, 829.5393528201522, 1356.8312357755722, 1135.8264575049732, 1217.3420532769137, 1218.9523067655655, 1483.7051324621762, 448.21335952240116, 652.7033822539402, 1021.7836292479168, 803.3375043481784, 1653.0816001597748, 1390.6977763392038, 900.8166024690366, 1032.8749233748767, 160.11308405065958, 681.5117238912203, 309.38543152348586, 985.047804516227, 1251.6192469613338, 917.0041592923002, 742.4457419410882, 927.4717173944532, 357.92908071638476, 793.7777830825207, 80.03870670558489, 1489.9742995221718, 1070.9882367702028, 869.8215523100583, 801.2169903634455, 945.1091390884402, 708.7978950463388, 821.3021851211572, 1353.074437227884, 998.7908021891643, 1417.1662628319134, 365.9889001786957, 806.1384191228435, 463.97167550313475, 1468.4186002958165, 744.5312865203055, 381.5304782426687, 1010.2882085141604, 1226.7495818246882, 34.19665577004913, 295.34005601917755, 673.578502046998, 854.3650577716105, 609.9803054366366, 629.9965393586655, 778.2516891675641, 171.9457552542882, 890.9519348595807, 869.8709402754349, 357.4681357484299, 672.615804521892, 747.8084854463323, 1034.4745429793086, 907.4290637391989, 523.1368469377464, 964.1645008250168, 493.84303731239686, 418.09189631931486, 145.45193085618425, 1429.4884459784325, 1447.9000256687711, 83.28466540270111, 54.41795684442803, 154.45690656738844, 82.38699644949016, 1112.5336222432068, 995.9010211080708, 1275.9817151963393]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.878194052101549, "mean_inference_ms": 5.41976825373251, "mean_action_processing_ms": 2.1155100880435516, "mean_env_wait_ms": 12.397626958615984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005666851997375488, "StateBufferConnector_ms": 0.009013891220092773, "ViewRequirementAgentConnector_ms": 0.13392305374145508}, "num_episodes": 13, "episode_return_max": 935.8627720494608, "episode_return_min": -90.6875086860469, "episode_return_mean": 115.86654901555006, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.25400262847022, "num_env_steps_trained_throughput_per_sec": 74.25400262847022, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 52758.427, "restore_workers_time_ms": 0.015, "training_step_time_ms": 52758.382, "sample_time_ms": 2366.689, "learn_time_ms": 50373.927, "learn_throughput": 79.406, "synch_weights_time_ms": 14.748}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "645a5_00000", "date": "2024-08-22_12-28-58", "timestamp": 1724309938, "time_this_iter_s": 53.916197776794434, "time_total_s": 2133.6054232120514, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a174dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2133.6054232120514, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 30.588157894736835, "ram_util_percent": 82.82894736842103}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.536537608520064, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.215230767941349, "policy_loss": -0.013651491459779362, "vf_loss": 6.226745440720251, "vf_explained_var": 0.34778442007523996, "kl": 0.010684142173046158, "entropy": 0.7309481682916167, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 986.5525000000052}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.492255627068262, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.243824430748268, "policy_loss": -0.022257818907706273, "vf_loss": 6.263218901649354, "vf_explained_var": 0.46190178772759816, "kl": 0.014316726956398242, "entropy": 0.9358956094456728, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 986.5525000000052}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 935.8627720494608, "episode_reward_min": -110.0640682066082, "episode_reward_mean": 110.07320022944701, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1649.5812722655594, "predator_policy": 1.6412971742204452}, "policy_reward_max": {"prey_policy": 261.77832082378944, "predator_policy": 1653.0816001597748}, "policy_reward_mean": {"prey_policy": -598.1676320367733, "predator_policy": 653.2042321514979}, "custom_metrics": {}, "hist_stats": {"episode_reward": [119.35732884675605, 483.4943855319823, 343.0561000754564, 138.84896704371312, 169.63929016154015, 13.737228333652865, 45.115246099692634, 120.44286038259496, 76.59999999999968, 63.42803351534569, 274.54986081690026, 137.6147511958341, -23.517792898195182, 276.53465678151935, 163.74190341512053, 106.5078014970241, 37.10308436297188, 26.631120181407713, 192.06613537041324, 94.59327055040124, 61.20000000000061, 183.72830643568196, -23.354588640990173, 10.786893353164242, 178.10696689390636, 242.12738473742107, 239.83614888083284, 58.713757747002056, 73.4000000000001, 63.12502099628543, 249.31433571406595, 19.13469190885889, -15.761805248923663, 151.7319012453101, 73.30000000000011, 48.826624290603185, 87.25580134629658, 190.32294179134354, 89.45950458219504, 12.199408767207439, 129.7017722762014, 367.0640384131007, 218.3506536477932, 136.50851133366552, 73.00000000000013, 8.329722865868858, 294.3030399897615, 139.59373902184007, 223.14535894885168, 226.0898897904417, 8.693364122595925, 231.15374046019315, 82.72396626933038, 144.18583600322668, 38.72566805472415, 77.51250941754606, 184.89185339649993, 33.5852059479879, 7.599999999999982, 11.499999999999968, 200.38078330686048, 339.6357653572295, 11.59999999999998, 935.8627720494608, 118.73243315865092, 100.27731613067306, 126.33331389264768, 114.37202660958332, 19.027905925112083, 39.27084723007054, 309.5200950389966, 119.93457951187955, 222.75365215811735, 228.42092692163047, 27.280973164415656, -28.189879726063623, -37.394977411747455, -50.47238596016277, 8.961058557608187, -6.8818175162657305, 138.8541111240451, -10.082028487538295, -90.6875086860469, 231.7514243373243, 19.393473685263896, -4.6462579084228866, -11.785995495431946, 50.70000000000045, -86.05227249653328, 38.486972717594945, 68.46416477301268, 45.42559175216169, 112.22989977643115, 77.74151158897774, 72.80000000000014, 110.40093211369583, -110.0640682066082, 40.79972678736136, 12.708561146696304, 11.799999999999976], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1565.246372354459, -230.86423057721674, 105.6102096731183, 261.77832082378944, 101.70147774930103, -781.6336163687497, 0.4839449758062696, -756.4173894100176, -988.9383666340655, -524.1013589877927, -594.4977819016636, -370.10391926960807, -403.989791431679, -936.0104122370366, -441.8994459659178, -1016.1956255652033, 20.578764538750494, -745.2391706002868, -684.2123288537074, -675.4490514891563, -105.93945996382871, -1144.6511973922459, -85.66266401938209, -1089.9243442704733, -930.7032762940236, -735.8964754052853, -731.2027401602758, -973.502777029269, -414.251067539997, -262.815409417306, -582.5986178912457, -208.7698243316238, -852.6570832918454, -551.9553403769369, -1026.7691928774093, -1097.676382224858, -132.65817370980298, -1206.2473582348885, -984.3628302762397, -393.3324178200984, 31.783661654543078, -470.72443320313425, -462.3797289515853, -984.5211664540128, -354.80650647538806, -681.7907737975186, -65.40727018439797, -544.1652748936925, -963.4989307883511, -349.30329597368257, 20.190662135100396, -937.4939268703029, -741.9336943288407, -83.67959637770221, -960.42605330978, -1026.0554928199404, 26.23356766574627, -102.06593211692973, -736.0214010640881, -167.6375218293108, 83.80146618005375, -243.84626248593258, -141.86343437947596, -406.28973753983496, -404.2840377227572, -804.3202557517329, -260.99713270706246, -581.9029414632433, 13.464069351197743, -46.18902678596006, -310.5813471500364, -598.5729581248145, -323.7829749461525, -846.3645019288082, -655.833540254612, -460.32660168697595, -785.0716718473517, -521.1549003821408, -342.2870440665342, -687.4698755058077, -435.80314810868356, -613.2586590211596, -490.2706538838279, -236.89704405815354, -756.1147862620032, -5.003946419233822, -838.8596283030264, -640.9169323668448, -112.98900899463061, 36.08583777359439, -197.22725878791877, -712.1453805868889, -38.40494075890473, -598.2960612816835, -1061.8813113188553, -258.14527487951796, -756.0410594440497, -540.9948103907, 13.955350945072576, -353.8637541593511, -571.6901406040479, -860.7169879070902, -212.67203327538988, -447.0830194634429, -401.8843914015678, -848.8727651185606, -304.0102113539485, -1163.1030136741292, -252.24169204186072, -965.8800013740563, -406.1591762370525, -477.02276822374, -633.2659299073285, -551.7317876384798, -801.3913001414811, -1351.394082506261, -1129.826457504977, -1215.7420532769133, -1207.552306765575, -1483.605132462176, -28.757284117570727, -871.778674351904, -1099.3123035380459, -386.17306470081803, -1382.598104233421, -1649.5812722655594, -1018.8951141898613, 21.066360395409085, -98.95693704463065, -623.9354377385926, -213.38556745259743, -980.7703524564414, -1282.6371094719227, -759.6529828890585, -476.4251010774283, -1079.1203316485305, -320.13204578288514, -812.5469120909014, -42.067859475514936, -1488.674299522173, -514.7891619452639, -1116.500532095999, -717.834861666313, -908.556688273686, -551.7622005440213, -755.5842274653543, -834.2996748224617, -1289.1446376729523, -1417.1662628319134, -338.70792701427365, -701.1448634967971, -597.1551108552407, -1321.7142326797468, -928.6306315481261, -656.568916588843, -785.7221561281431, -869.8217895832452, -382.1633894538827, -66.73171761561709, -909.0686579668222, 16.57142782176583, -1342.0626799059721, -666.0422167999551, -752.2880402138071, -376.8863326064458, -776.6988661934682, -586.4418865150567, -409.1457651714793, -780.5038853529287, -620.5269309300254, -1167.7328618305858, -778.8170027963458, -294.2360178352179, -1204.851325422978, -466.8430373123907, -394.39189631930964, -323.3137643873468, -1337.678884943804, -1447.9000256687711, -44.79769268510709, -60.57495860426632, -79.8357400345415, -984.417432074628, -165.07759486591175, -1031.2373820861517, -1128.4154544418282, -427.0156420706229, -569.1425545570994, 26.93968422694526, -57.291428139528875, 30.08441147489476, -488.5808786745987, -376.2093530535086, -902.3224333280232, -444.58189232708025, -332.4139149703632, -126.8954628736866, -740.0749498557255, -1187.7058170380035, -1080.051580311619], "policy_predator_policy_reward": [680.1212938482464, 1235.346637930187, 46.07405402455705, 70.03180101051169, 2.91061355533125, 1020.0776251395746, 228.6767782515146, 666.1056332264158, 936.4097694144998, 746.2692463689083, 312.9012520791114, 665.4376774258213, 427.4398109777563, 957.6756387906522, 835.1321936504979, 743.405738263225, 758.0755506738377, 43.18485538769881, 502.0139813220137, 921.0754325362024, 978.027790349466, 547.1127278235119, 235.67050027248956, 1077.531259213198, 965.339313539673, 677.7426452614457, 787.286871310411, 1193.9533026606541, 408.72031869865236, 432.0880616737787, 381.09613220929907, 516.7801115105996, 828.1484606996, 613.5670473321593, 1040.2778088583923, 1110.7988864252818, 678.6250979813508, 852.3465693337515, 668.1394577840033, 804.1490608627417, 7.516338345457098, 492.6244332031391, 768.8339562106901, 861.795245630598, 1.6412971742204452, 1011.6013944577031, 24.550067030565685, 595.8093714006894, 1138.1520821287427, 352.75711152719833, 127.2948854540494, 1032.1357640185752, 816.4066295800106, 249.0428100073671, 855.9802530302836, 1189.2150508464324, 12.866432334253805, 136.36593211692778, 842.8398407932143, 123.94410309646699, 253.1608838672101, 156.19824815273972, 54.868156616556014, 512.4197072116165, 298.44253277739534, 894.3999554481763, 712.8856161058927, 281.7463593097292, 24.635930648802308, 81.38902678595933, 632.0755663859629, 325.9053631795017, 389.7387762924568, 867.6645019288101, 680.905061320168, 625.5780224127645, 670.2548192867087, 725.4312575249861, 207.25409955387718, 834.7022287856802, 555.6408380831668, 623.1227413228825, 457.74719027053465, 636.4845460845454, 771.8528705353547, 207.61651579367532, 604.0897686880041, 1012.195303315537, 146.28900899462872, 3.6141622264058517, 712.921478054891, 204.78088418578443, 422.3601797535192, 508.64386227682616, 1052.7079097767416, 406.912415443474, 1138.6130582526514, 381.56817053095097, 233.25318832289355, 332.74510468183666, 642.4268770782384, 798.6736155554979, 460.6584658979112, 430.2503273011215, 369.88111469345813, 963.6000080960046, 560.7845441631968, 1050.514516868107, 1171.1340264823084, 85.71333498833205, 942.3471711173277, 18.347282761019038, 607.967160367918, 761.9224105743953, 829.5393528201522, 1356.8312357755722, 1135.8264575049732, 1217.3420532769137, 1218.9523067655655, 1483.7051324621762, 448.21335952240116, 652.7033822539402, 1021.7836292479168, 803.3375043481784, 1653.0816001597748, 1390.6977763392038, 900.8166024690366, 1032.8749233748767, 160.11308405065958, 681.5117238912203, 309.38543152348586, 985.047804516227, 1251.6192469613338, 917.0041592923002, 742.4457419410882, 927.4717173944532, 357.92908071638476, 793.7777830825207, 80.03870670558489, 1489.9742995221718, 1070.9882367702028, 869.8215523100583, 801.2169903634455, 945.1091390884402, 708.7978950463388, 821.3021851211572, 1353.074437227884, 998.7908021891643, 1417.1662628319134, 365.9889001786957, 806.1384191228435, 463.97167550313475, 1468.4186002958165, 744.5312865203055, 381.5304782426687, 1010.2882085141604, 1226.7495818246882, 34.19665577004913, 295.34005601917755, 673.578502046998, 854.3650577716105, 609.9803054366366, 629.9965393586655, 778.2516891675641, 171.9457552542882, 890.9519348595807, 869.8709402754349, 357.4681357484299, 672.615804521892, 747.8084854463323, 1034.4745429793086, 907.4290637391989, 523.1368469377464, 964.1645008250168, 493.84303731239686, 418.09189631931486, 145.45193085618425, 1429.4884459784325, 1447.9000256687711, 83.28466540270111, 54.41795684442803, 154.45690656738844, 82.38699644949016, 1112.5336222432068, 995.9010211080708, 1275.9817151963393, 334.6014105123282, 739.2982977043795, 12.060315773054828, 91.09142813952755, 60.84798549470361, 508.0494138187049, 243.51868804354578, 924.9490301313822, 802.9077856718155, 14.887748412991549, 40.2081015465017, 839.4708723296106, 1189.7058170380042, 1089.8515803116125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.875307621786676, "mean_inference_ms": 5.392521214003532, "mean_action_processing_ms": 2.1075447170616615, "mean_env_wait_ms": 12.389786000517926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005636930465698242, "StateBufferConnector_ms": 0.008845329284667969, "ViewRequirementAgentConnector_ms": 0.13025140762329102}, "num_episodes": 7, "episode_return_max": 935.8627720494608, "episode_return_min": -110.0640682066082, "episode_return_mean": 110.07320022944701, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.58575570915376, "num_env_steps_trained_throughput_per_sec": 75.58575570915376, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 52831.958, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52831.912, "sample_time_ms": 2364.192, "learn_time_ms": 50449.568, "learn_throughput": 79.287, "synch_weights_time_ms": 15.009}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "645a5_00000", "date": "2024-08-22_12-29-51", "timestamp": 1724309991, "time_this_iter_s": 52.95951008796692, "time_total_s": 2186.5649333000183, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a131430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2186.5649333000183, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 33.30266666666667, "ram_util_percent": 83.05066666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.698059141825116, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.655564953536584, "policy_loss": -0.013087212776262609, "vf_loss": 6.666542563615022, "vf_explained_var": 0.33658818630945114, "kl": 0.010547957004038076, "entropy": 0.6573345824681892, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 965.2899999999935}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.285576186703626, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.4558405268129215, "policy_loss": -0.02576263747744696, "vf_loss": 6.478417275191615, "vf_explained_var": 0.5016859241263576, "kl": 0.01592944202841156, "entropy": 0.9510056626859796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 965.2899999999935}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 935.8627720494608, "episode_reward_min": -110.0640682066082, "episode_reward_mean": 105.06652830800611, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1708.3000246487775, "predator_policy": 1.199091563222897}, "policy_reward_max": {"prey_policy": 83.80146618005375, "predator_policy": 1678.266985797635}, "policy_reward_mean": {"prey_policy": -622.0161024473127, "predator_policy": 674.5493666013168}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.517792898195182, 276.53465678151935, 163.74190341512053, 106.5078014970241, 37.10308436297188, 26.631120181407713, 192.06613537041324, 94.59327055040124, 61.20000000000061, 183.72830643568196, -23.354588640990173, 10.786893353164242, 178.10696689390636, 242.12738473742107, 239.83614888083284, 58.713757747002056, 73.4000000000001, 63.12502099628543, 249.31433571406595, 19.13469190885889, -15.761805248923663, 151.7319012453101, 73.30000000000011, 48.826624290603185, 87.25580134629658, 190.32294179134354, 89.45950458219504, 12.199408767207439, 129.7017722762014, 367.0640384131007, 218.3506536477932, 136.50851133366552, 73.00000000000013, 8.329722865868858, 294.3030399897615, 139.59373902184007, 223.14535894885168, 226.0898897904417, 8.693364122595925, 231.15374046019315, 82.72396626933038, 144.18583600322668, 38.72566805472415, 77.51250941754606, 184.89185339649993, 33.5852059479879, 7.599999999999982, 11.499999999999968, 200.38078330686048, 339.6357653572295, 11.59999999999998, 935.8627720494608, 118.73243315865092, 100.27731613067306, 126.33331389264768, 114.37202660958332, 19.027905925112083, 39.27084723007054, 309.5200950389966, 119.93457951187955, 222.75365215811735, 228.42092692163047, 27.280973164415656, -28.189879726063623, -37.394977411747455, -50.47238596016277, 8.961058557608187, -6.8818175162657305, 138.8541111240451, -10.082028487538295, -90.6875086860469, 231.7514243373243, 19.393473685263896, -4.6462579084228866, -11.785995495431946, 50.70000000000045, -86.05227249653328, 38.486972717594945, 68.46416477301268, 45.42559175216169, 112.22989977643115, 77.74151158897774, 72.80000000000014, 110.40093211369583, -110.0640682066082, 40.79972678736136, 12.708561146696304, 11.799999999999976, 323.7301756273615, 244.16699890229197, 20.300000000000022, 58.20000000000056, 177.31686902752435, -91.77075534543454, -63.097241068366955, 343.1063389753558, 78.51709280982155, -71.51030359400886, 106.9435069502695, 359.3141775745634], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-930.7032762940236, -735.8964754052853, -731.2027401602758, -973.502777029269, -414.251067539997, -262.815409417306, -582.5986178912457, -208.7698243316238, -852.6570832918454, -551.9553403769369, -1026.7691928774093, -1097.676382224858, -132.65817370980298, -1206.2473582348885, -984.3628302762397, -393.3324178200984, 31.783661654543078, -470.72443320313425, -462.3797289515853, -984.5211664540128, -354.80650647538806, -681.7907737975186, -65.40727018439797, -544.1652748936925, -963.4989307883511, -349.30329597368257, 20.190662135100396, -937.4939268703029, -741.9336943288407, -83.67959637770221, -960.42605330978, -1026.0554928199404, 26.23356766574627, -102.06593211692973, -736.0214010640881, -167.6375218293108, 83.80146618005375, -243.84626248593258, -141.86343437947596, -406.28973753983496, -404.2840377227572, -804.3202557517329, -260.99713270706246, -581.9029414632433, 13.464069351197743, -46.18902678596006, -310.5813471500364, -598.5729581248145, -323.7829749461525, -846.3645019288082, -655.833540254612, -460.32660168697595, -785.0716718473517, -521.1549003821408, -342.2870440665342, -687.4698755058077, -435.80314810868356, -613.2586590211596, -490.2706538838279, -236.89704405815354, -756.1147862620032, -5.003946419233822, -838.8596283030264, -640.9169323668448, -112.98900899463061, 36.08583777359439, -197.22725878791877, -712.1453805868889, -38.40494075890473, -598.2960612816835, -1061.8813113188553, -258.14527487951796, -756.0410594440497, -540.9948103907, 13.955350945072576, -353.8637541593511, -571.6901406040479, -860.7169879070902, -212.67203327538988, -447.0830194634429, -401.8843914015678, -848.8727651185606, -304.0102113539485, -1163.1030136741292, -252.24169204186072, -965.8800013740563, -406.1591762370525, -477.02276822374, -633.2659299073285, -551.7317876384798, -801.3913001414811, -1351.394082506261, -1129.826457504977, -1215.7420532769133, -1207.552306765575, -1483.605132462176, -28.757284117570727, -871.778674351904, -1099.3123035380459, -386.17306470081803, -1382.598104233421, -1649.5812722655594, -1018.8951141898613, 21.066360395409085, -98.95693704463065, -623.9354377385926, -213.38556745259743, -980.7703524564414, -1282.6371094719227, -759.6529828890585, -476.4251010774283, -1079.1203316485305, -320.13204578288514, -812.5469120909014, -42.067859475514936, -1488.674299522173, -514.7891619452639, -1116.500532095999, -717.834861666313, -908.556688273686, -551.7622005440213, -755.5842274653543, -834.2996748224617, -1289.1446376729523, -1417.1662628319134, -338.70792701427365, -701.1448634967971, -597.1551108552407, -1321.7142326797468, -928.6306315481261, -656.568916588843, -785.7221561281431, -869.8217895832452, -382.1633894538827, -66.73171761561709, -909.0686579668222, 16.57142782176583, -1342.0626799059721, -666.0422167999551, -752.2880402138071, -376.8863326064458, -776.6988661934682, -586.4418865150567, -409.1457651714793, -780.5038853529287, -620.5269309300254, -1167.7328618305858, -778.8170027963458, -294.2360178352179, -1204.851325422978, -466.8430373123907, -394.39189631930964, -323.3137643873468, -1337.678884943804, -1447.9000256687711, -44.79769268510709, -60.57495860426632, -79.8357400345415, -984.417432074628, -165.07759486591175, -1031.2373820861517, -1128.4154544418282, -427.0156420706229, -569.1425545570994, 26.93968422694526, -57.291428139528875, 30.08441147489476, -488.5808786745987, -376.2093530535086, -902.3224333280232, -444.58189232708025, -332.4139149703632, -126.8954628736866, -740.0749498557255, -1187.7058170380035, -1080.051580311619, -1072.8131781532309, -231.23213911218798, -561.9086715983049, -746.5228433215764, -777.4157443208385, -1547.1984243912618, -378.41716093397974, -32.90577206360135, -782.904586729738, -986.9177340424297, -398.02590891851423, -905.871779100483, -1007.1738711773497, -207.7160376408256, -686.1790141001941, -1708.3000246487775, -20.41165737825554, -671.6516325779523, -571.5002467154995, -453.2547927667388, -769.1705680631877, -995.0509547331588, -710.6647373296787, -1197.310411821847], "policy_predator_policy_reward": [965.339313539673, 677.7426452614457, 787.286871310411, 1193.9533026606541, 408.72031869865236, 432.0880616737787, 381.09613220929907, 516.7801115105996, 828.1484606996, 613.5670473321593, 1040.2778088583923, 1110.7988864252818, 678.6250979813508, 852.3465693337515, 668.1394577840033, 804.1490608627417, 7.516338345457098, 492.6244332031391, 768.8339562106901, 861.795245630598, 1.6412971742204452, 1011.6013944577031, 24.550067030565685, 595.8093714006894, 1138.1520821287427, 352.75711152719833, 127.2948854540494, 1032.1357640185752, 816.4066295800106, 249.0428100073671, 855.9802530302836, 1189.2150508464324, 12.866432334253805, 136.36593211692778, 842.8398407932143, 123.94410309646699, 253.1608838672101, 156.19824815273972, 54.868156616556014, 512.4197072116165, 298.44253277739534, 894.3999554481763, 712.8856161058927, 281.7463593097292, 24.635930648802308, 81.38902678595933, 632.0755663859629, 325.9053631795017, 389.7387762924568, 867.6645019288101, 680.905061320168, 625.5780224127645, 670.2548192867087, 725.4312575249861, 207.25409955387718, 834.7022287856802, 555.6408380831668, 623.1227413228825, 457.74719027053465, 636.4845460845454, 771.8528705353547, 207.61651579367532, 604.0897686880041, 1012.195303315537, 146.28900899462872, 3.6141622264058517, 712.921478054891, 204.78088418578443, 422.3601797535192, 508.64386227682616, 1052.7079097767416, 406.912415443474, 1138.6130582526514, 381.56817053095097, 233.25318832289355, 332.74510468183666, 642.4268770782384, 798.6736155554979, 460.6584658979112, 430.2503273011215, 369.88111469345813, 963.6000080960046, 560.7845441631968, 1050.514516868107, 1171.1340264823084, 85.71333498833205, 942.3471711173277, 18.347282761019038, 607.967160367918, 761.9224105743953, 829.5393528201522, 1356.8312357755722, 1135.8264575049732, 1217.3420532769137, 1218.9523067655655, 1483.7051324621762, 448.21335952240116, 652.7033822539402, 1021.7836292479168, 803.3375043481784, 1653.0816001597748, 1390.6977763392038, 900.8166024690366, 1032.8749233748767, 160.11308405065958, 681.5117238912203, 309.38543152348586, 985.047804516227, 1251.6192469613338, 917.0041592923002, 742.4457419410882, 927.4717173944532, 357.92908071638476, 793.7777830825207, 80.03870670558489, 1489.9742995221718, 1070.9882367702028, 869.8215523100583, 801.2169903634455, 945.1091390884402, 708.7978950463388, 821.3021851211572, 1353.074437227884, 998.7908021891643, 1417.1662628319134, 365.9889001786957, 806.1384191228435, 463.97167550313475, 1468.4186002958165, 744.5312865203055, 381.5304782426687, 1010.2882085141604, 1226.7495818246882, 34.19665577004913, 295.34005601917755, 673.578502046998, 854.3650577716105, 609.9803054366366, 629.9965393586655, 778.2516891675641, 171.9457552542882, 890.9519348595807, 869.8709402754349, 357.4681357484299, 672.615804521892, 747.8084854463323, 1034.4745429793086, 907.4290637391989, 523.1368469377464, 964.1645008250168, 493.84303731239686, 418.09189631931486, 145.45193085618425, 1429.4884459784325, 1447.9000256687711, 83.28466540270111, 54.41795684442803, 154.45690656738844, 82.38699644949016, 1112.5336222432068, 995.9010211080708, 1275.9817151963393, 334.6014105123282, 739.2982977043795, 12.060315773054828, 91.09142813952755, 60.84798549470361, 508.0494138187049, 243.51868804354578, 924.9490301313822, 802.9077856718155, 14.887748412991549, 40.2081015465017, 839.4708723296106, 1189.7058170380042, 1089.8515803116125, 924.4786260155455, 703.2968668772288, 857.8482067121133, 694.7503071100639, 797.7157443208431, 1547.1984243912618, 401.31716093398495, 68.20577206360186, 959.0191641534828, 988.1200256462141, 255.9255894472998, 956.201343226262, 1150.5935761865858, 1.199091563222897, 1059.3183919266949, 1678.266985797635, 433.1033607632373, 337.47702200279656, 726.5342497970965, 226.7104860911395, 917.8041792171568, 953.360850529461, 1131.8708616646884, 1135.4184650614018]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.850278069850337, "mean_inference_ms": 5.3624821011980535, "mean_action_processing_ms": 2.084418962969325, "mean_env_wait_ms": 12.372827154356068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064508914947509766, "StateBufferConnector_ms": 0.009110212326049805, "ViewRequirementAgentConnector_ms": 0.13564670085906982}, "num_episodes": 12, "episode_return_max": 935.8627720494608, "episode_return_min": -110.0640682066082, "episode_return_mean": 105.06652830800611, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.92462565222348, "num_env_steps_trained_throughput_per_sec": 75.92462565222348, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 52841.447, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52841.402, "sample_time_ms": 2365.821, "learn_time_ms": 50457.711, "learn_throughput": 79.274, "synch_weights_time_ms": 14.777}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "645a5_00000", "date": "2024-08-22_12-30-44", "timestamp": 1724310044, "time_this_iter_s": 52.738577127456665, "time_total_s": 2239.303510427475, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a11c5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2239.303510427475, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 28.874324324324323, "ram_util_percent": 82.59189189189188}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.017127575823869, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.883551980326415, "policy_loss": -0.01277395455146987, "vf_loss": 6.894424494738301, "vf_explained_var": 0.3644737330694047, "kl": 0.009507309257732853, "entropy": 0.613546340191175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 965.2899999999935}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.98519090035605, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.872815258540804, "policy_loss": -0.023552217426162862, "vf_loss": 6.893487836191894, "vf_explained_var": 0.45769164199551576, "kl": 0.014398232866916313, "entropy": 0.9208011463836387, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 965.2899999999935}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 935.8627720494608, "episode_reward_min": -110.0640682066082, "episode_reward_mean": 115.18615877856536, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1708.3000246487775, "predator_policy": 1.199091563222897}, "policy_reward_max": {"prey_policy": 173.13443932943449, "predator_policy": 1678.266985797635}, "policy_reward_mean": {"prey_policy": -637.492951854264, "predator_policy": 695.086031243548}, "custom_metrics": {}, "hist_stats": {"episode_reward": [239.83614888083284, 58.713757747002056, 73.4000000000001, 63.12502099628543, 249.31433571406595, 19.13469190885889, -15.761805248923663, 151.7319012453101, 73.30000000000011, 48.826624290603185, 87.25580134629658, 190.32294179134354, 89.45950458219504, 12.199408767207439, 129.7017722762014, 367.0640384131007, 218.3506536477932, 136.50851133366552, 73.00000000000013, 8.329722865868858, 294.3030399897615, 139.59373902184007, 223.14535894885168, 226.0898897904417, 8.693364122595925, 231.15374046019315, 82.72396626933038, 144.18583600322668, 38.72566805472415, 77.51250941754606, 184.89185339649993, 33.5852059479879, 7.599999999999982, 11.499999999999968, 200.38078330686048, 339.6357653572295, 11.59999999999998, 935.8627720494608, 118.73243315865092, 100.27731613067306, 126.33331389264768, 114.37202660958332, 19.027905925112083, 39.27084723007054, 309.5200950389966, 119.93457951187955, 222.75365215811735, 228.42092692163047, 27.280973164415656, -28.189879726063623, -37.394977411747455, -50.47238596016277, 8.961058557608187, -6.8818175162657305, 138.8541111240451, -10.082028487538295, -90.6875086860469, 231.7514243373243, 19.393473685263896, -4.6462579084228866, -11.785995495431946, 50.70000000000045, -86.05227249653328, 38.486972717594945, 68.46416477301268, 45.42559175216169, 112.22989977643115, 77.74151158897774, 72.80000000000014, 110.40093211369583, -110.0640682066082, 40.79972678736136, 12.708561146696304, 11.799999999999976, 323.7301756273615, 244.16699890229197, 20.300000000000022, 58.20000000000056, 177.31686902752435, -91.77075534543454, -63.097241068366955, 343.1063389753558, 78.51709280982155, -71.51030359400886, 106.9435069502695, 359.3141775745634, 77.77552752315164, 29.69386418001281, 122.38634591273876, 21.36162934966922, 3.8000000000000007, 375.5898673461358, 257.89965339569966, 518.4972847404633, 127.06760160391866, 62.05551167607736, 415.46125161206567, 185.4715840470491, 248.58970319770236, 92.5683645110859], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-741.9336943288407, -83.67959637770221, -960.42605330978, -1026.0554928199404, 26.23356766574627, -102.06593211692973, -736.0214010640881, -167.6375218293108, 83.80146618005375, -243.84626248593258, -141.86343437947596, -406.28973753983496, -404.2840377227572, -804.3202557517329, -260.99713270706246, -581.9029414632433, 13.464069351197743, -46.18902678596006, -310.5813471500364, -598.5729581248145, -323.7829749461525, -846.3645019288082, -655.833540254612, -460.32660168697595, -785.0716718473517, -521.1549003821408, -342.2870440665342, -687.4698755058077, -435.80314810868356, -613.2586590211596, -490.2706538838279, -236.89704405815354, -756.1147862620032, -5.003946419233822, -838.8596283030264, -640.9169323668448, -112.98900899463061, 36.08583777359439, -197.22725878791877, -712.1453805868889, -38.40494075890473, -598.2960612816835, -1061.8813113188553, -258.14527487951796, -756.0410594440497, -540.9948103907, 13.955350945072576, -353.8637541593511, -571.6901406040479, -860.7169879070902, -212.67203327538988, -447.0830194634429, -401.8843914015678, -848.8727651185606, -304.0102113539485, -1163.1030136741292, -252.24169204186072, -965.8800013740563, -406.1591762370525, -477.02276822374, -633.2659299073285, -551.7317876384798, -801.3913001414811, -1351.394082506261, -1129.826457504977, -1215.7420532769133, -1207.552306765575, -1483.605132462176, -28.757284117570727, -871.778674351904, -1099.3123035380459, -386.17306470081803, -1382.598104233421, -1649.5812722655594, -1018.8951141898613, 21.066360395409085, -98.95693704463065, -623.9354377385926, -213.38556745259743, -980.7703524564414, -1282.6371094719227, -759.6529828890585, -476.4251010774283, -1079.1203316485305, -320.13204578288514, -812.5469120909014, -42.067859475514936, -1488.674299522173, -514.7891619452639, -1116.500532095999, -717.834861666313, -908.556688273686, -551.7622005440213, -755.5842274653543, -834.2996748224617, -1289.1446376729523, -1417.1662628319134, -338.70792701427365, -701.1448634967971, -597.1551108552407, -1321.7142326797468, -928.6306315481261, -656.568916588843, -785.7221561281431, -869.8217895832452, -382.1633894538827, -66.73171761561709, -909.0686579668222, 16.57142782176583, -1342.0626799059721, -666.0422167999551, -752.2880402138071, -376.8863326064458, -776.6988661934682, -586.4418865150567, -409.1457651714793, -780.5038853529287, -620.5269309300254, -1167.7328618305858, -778.8170027963458, -294.2360178352179, -1204.851325422978, -466.8430373123907, -394.39189631930964, -323.3137643873468, -1337.678884943804, -1447.9000256687711, -44.79769268510709, -60.57495860426632, -79.8357400345415, -984.417432074628, -165.07759486591175, -1031.2373820861517, -1128.4154544418282, -427.0156420706229, -569.1425545570994, 26.93968422694526, -57.291428139528875, 30.08441147489476, -488.5808786745987, -376.2093530535086, -902.3224333280232, -444.58189232708025, -332.4139149703632, -126.8954628736866, -740.0749498557255, -1187.7058170380035, -1080.051580311619, -1072.8131781532309, -231.23213911218798, -561.9086715983049, -746.5228433215764, -777.4157443208385, -1547.1984243912618, -378.41716093397974, -32.90577206360135, -782.904586729738, -986.9177340424297, -398.02590891851423, -905.871779100483, -1007.1738711773497, -207.7160376408256, -686.1790141001941, -1708.3000246487775, -20.41165737825554, -671.6516325779523, -571.5002467154995, -453.2547927667388, -769.1705680631877, -995.0509547331588, -710.6647373296787, -1197.310411821847, -160.4673933437999, -303.637675263492, -663.2888490656147, -515.2414047362411, -909.8457063369955, -1506.5842951988882, -253.5093699378602, -953.3294441870636, -1174.8206109172063, -1184.8371821863366, -785.8566803333796, -340.54005843747194, -1189.8022621808789, -668.5375154600787, -763.1219043510217, 173.13443932943449, -901.8040840560242, -962.0047483626408, -316.93328402655976, -403.7437297206421, -1207.2112595121137, -371.5421718794953, -1262.9040868318125, -202.59225695006833, -321.9436286553897, -784.3419435729116, -1199.6154301988217, -807.9632957004225], "policy_predator_policy_reward": [816.4066295800106, 249.0428100073671, 855.9802530302836, 1189.2150508464324, 12.866432334253805, 136.36593211692778, 842.8398407932143, 123.94410309646699, 253.1608838672101, 156.19824815273972, 54.868156616556014, 512.4197072116165, 298.44253277739534, 894.3999554481763, 712.8856161058927, 281.7463593097292, 24.635930648802308, 81.38902678595933, 632.0755663859629, 325.9053631795017, 389.7387762924568, 867.6645019288101, 680.905061320168, 625.5780224127645, 670.2548192867087, 725.4312575249861, 207.25409955387718, 834.7022287856802, 555.6408380831668, 623.1227413228825, 457.74719027053465, 636.4845460845454, 771.8528705353547, 207.61651579367532, 604.0897686880041, 1012.195303315537, 146.28900899462872, 3.6141622264058517, 712.921478054891, 204.78088418578443, 422.3601797535192, 508.64386227682616, 1052.7079097767416, 406.912415443474, 1138.6130582526514, 381.56817053095097, 233.25318832289355, 332.74510468183666, 642.4268770782384, 798.6736155554979, 460.6584658979112, 430.2503273011215, 369.88111469345813, 963.6000080960046, 560.7845441631968, 1050.514516868107, 1171.1340264823084, 85.71333498833205, 942.3471711173277, 18.347282761019038, 607.967160367918, 761.9224105743953, 829.5393528201522, 1356.8312357755722, 1135.8264575049732, 1217.3420532769137, 1218.9523067655655, 1483.7051324621762, 448.21335952240116, 652.7033822539402, 1021.7836292479168, 803.3375043481784, 1653.0816001597748, 1390.6977763392038, 900.8166024690366, 1032.8749233748767, 160.11308405065958, 681.5117238912203, 309.38543152348586, 985.047804516227, 1251.6192469613338, 917.0041592923002, 742.4457419410882, 927.4717173944532, 357.92908071638476, 793.7777830825207, 80.03870670558489, 1489.9742995221718, 1070.9882367702028, 869.8215523100583, 801.2169903634455, 945.1091390884402, 708.7978950463388, 821.3021851211572, 1353.074437227884, 998.7908021891643, 1417.1662628319134, 365.9889001786957, 806.1384191228435, 463.97167550313475, 1468.4186002958165, 744.5312865203055, 381.5304782426687, 1010.2882085141604, 1226.7495818246882, 34.19665577004913, 295.34005601917755, 673.578502046998, 854.3650577716105, 609.9803054366366, 629.9965393586655, 778.2516891675641, 171.9457552542882, 890.9519348595807, 869.8709402754349, 357.4681357484299, 672.615804521892, 747.8084854463323, 1034.4745429793086, 907.4290637391989, 523.1368469377464, 964.1645008250168, 493.84303731239686, 418.09189631931486, 145.45193085618425, 1429.4884459784325, 1447.9000256687711, 83.28466540270111, 54.41795684442803, 154.45690656738844, 82.38699644949016, 1112.5336222432068, 995.9010211080708, 1275.9817151963393, 334.6014105123282, 739.2982977043795, 12.060315773054828, 91.09142813952755, 60.84798549470361, 508.0494138187049, 243.51868804354578, 924.9490301313822, 802.9077856718155, 14.887748412991549, 40.2081015465017, 839.4708723296106, 1189.7058170380042, 1089.8515803116125, 924.4786260155455, 703.2968668772288, 857.8482067121133, 694.7503071100639, 797.7157443208431, 1547.1984243912618, 401.31716093398495, 68.20577206360186, 959.0191641534828, 988.1200256462141, 255.9255894472998, 956.201343226262, 1150.5935761865858, 1.199091563222897, 1059.3183919266949, 1678.266985797635, 433.1033607632373, 337.47702200279656, 726.5342497970965, 226.7104860911395, 917.8041792171568, 953.360850529461, 1131.8708616646884, 1135.4184650614018, 129.35952676726717, 412.5210693631789, 507.37522677917747, 700.8488912026946, 1054.2133024559469, 1484.6030449926795, 658.1642650308048, 570.036178443789, 1175.1206109172062, 1188.3371821863363, 851.4669622726126, 650.5196438443822, 1160.28779616305, 955.9516348736169, 439.02323991763825, 669.4615098444092, 1047.9319254158181, 942.9445086067657, 357.39505158126155, 425.33747384202906, 942.4696954540524, 1051.7449875496277, 755.0083915471508, 895.9595362817743, 615.1152323384811, 739.760043087534, 875.0668742752115, 1225.0802161351232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.808395840924817, "mean_inference_ms": 5.3186607052197425, "mean_action_processing_ms": 2.083834504046345, "mean_env_wait_ms": 12.400307540745318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004282236099243164, "StateBufferConnector_ms": 0.00917506217956543, "ViewRequirementAgentConnector_ms": 0.13638734817504883}, "num_episodes": 14, "episode_return_max": 935.8627720494608, "episode_return_min": -110.0640682066082, "episode_return_mean": 115.18615877856536, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.01745432124306, "num_env_steps_trained_throughput_per_sec": 77.01745432124306, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 52773.39, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52773.345, "sample_time_ms": 2375.963, "learn_time_ms": 50379.59, "learn_throughput": 79.397, "synch_weights_time_ms": 14.764}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "645a5_00000", "date": "2024-08-22_12-31-36", "timestamp": 1724310096, "time_this_iter_s": 51.976353883743286, "time_total_s": 2291.2798643112183, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a16ae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2291.2798643112183, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 27.414864864864864, "ram_util_percent": 82.32027027027029}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.151438954204478, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.755520541075046, "policy_loss": -0.015829833751672476, "vf_loss": 6.768867887012542, "vf_explained_var": 0.33267098280487867, "kl": 0.012412450165566668, "entropy": 0.6418407009549872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.773720296318569, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.835343719664074, "policy_loss": -0.024768816503060478, "vf_loss": 6.857193928168564, "vf_explained_var": 0.4029580571348705, "kl": 0.014593052706513652, "entropy": 0.9099510418359564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 935.8627720494608, "episode_reward_min": -113.11845200065457, "episode_reward_mean": 119.14335867044532, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1830.8812967545732, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 329.4354799754761, "predator_policy": 1830.8812967545732}, "policy_reward_mean": {"prey_policy": -671.9635194638424, "predator_policy": 731.5351987990663}, "custom_metrics": {}, "hist_stats": {"episode_reward": [136.50851133366552, 73.00000000000013, 8.329722865868858, 294.3030399897615, 139.59373902184007, 223.14535894885168, 226.0898897904417, 8.693364122595925, 231.15374046019315, 82.72396626933038, 144.18583600322668, 38.72566805472415, 77.51250941754606, 184.89185339649993, 33.5852059479879, 7.599999999999982, 11.499999999999968, 200.38078330686048, 339.6357653572295, 11.59999999999998, 935.8627720494608, 118.73243315865092, 100.27731613067306, 126.33331389264768, 114.37202660958332, 19.027905925112083, 39.27084723007054, 309.5200950389966, 119.93457951187955, 222.75365215811735, 228.42092692163047, 27.280973164415656, -28.189879726063623, -37.394977411747455, -50.47238596016277, 8.961058557608187, -6.8818175162657305, 138.8541111240451, -10.082028487538295, -90.6875086860469, 231.7514243373243, 19.393473685263896, -4.6462579084228866, -11.785995495431946, 50.70000000000045, -86.05227249653328, 38.486972717594945, 68.46416477301268, 45.42559175216169, 112.22989977643115, 77.74151158897774, 72.80000000000014, 110.40093211369583, -110.0640682066082, 40.79972678736136, 12.708561146696304, 11.799999999999976, 323.7301756273615, 244.16699890229197, 20.300000000000022, 58.20000000000056, 177.31686902752435, -91.77075534543454, -63.097241068366955, 343.1063389753558, 78.51709280982155, -71.51030359400886, 106.9435069502695, 359.3141775745634, 77.77552752315164, 29.69386418001281, 122.38634591273876, 21.36162934966922, 3.8000000000000007, 375.5898673461358, 257.89965339569966, 518.4972847404633, 127.06760160391866, 62.05551167607736, 415.46125161206567, 185.4715840470491, 248.58970319770236, 92.5683645110859, 115.99999999999966, 3.9999999999999973, 185.93463334038796, -113.11845200065457, 370.2298148845147, 61.10817773657104, 156.181264228961, 791.0537421633345, 4.004671489815953, 2.570716439152992, 66.80000000000048, 501.6321113494041, 22.78927023104198, 207.77871794812683, 59.48573941381626, -110.19700403673217, 125.44138235842931], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-838.8596283030264, -640.9169323668448, -112.98900899463061, 36.08583777359439, -197.22725878791877, -712.1453805868889, -38.40494075890473, -598.2960612816835, -1061.8813113188553, -258.14527487951796, -756.0410594440497, -540.9948103907, 13.955350945072576, -353.8637541593511, -571.6901406040479, -860.7169879070902, -212.67203327538988, -447.0830194634429, -401.8843914015678, -848.8727651185606, -304.0102113539485, -1163.1030136741292, -252.24169204186072, -965.8800013740563, -406.1591762370525, -477.02276822374, -633.2659299073285, -551.7317876384798, -801.3913001414811, -1351.394082506261, -1129.826457504977, -1215.7420532769133, -1207.552306765575, -1483.605132462176, -28.757284117570727, -871.778674351904, -1099.3123035380459, -386.17306470081803, -1382.598104233421, -1649.5812722655594, -1018.8951141898613, 21.066360395409085, -98.95693704463065, -623.9354377385926, -213.38556745259743, -980.7703524564414, -1282.6371094719227, -759.6529828890585, -476.4251010774283, -1079.1203316485305, -320.13204578288514, -812.5469120909014, -42.067859475514936, -1488.674299522173, -514.7891619452639, -1116.500532095999, -717.834861666313, -908.556688273686, -551.7622005440213, -755.5842274653543, -834.2996748224617, -1289.1446376729523, -1417.1662628319134, -338.70792701427365, -701.1448634967971, -597.1551108552407, -1321.7142326797468, -928.6306315481261, -656.568916588843, -785.7221561281431, -869.8217895832452, -382.1633894538827, -66.73171761561709, -909.0686579668222, 16.57142782176583, -1342.0626799059721, -666.0422167999551, -752.2880402138071, -376.8863326064458, -776.6988661934682, -586.4418865150567, -409.1457651714793, -780.5038853529287, -620.5269309300254, -1167.7328618305858, -778.8170027963458, -294.2360178352179, -1204.851325422978, -466.8430373123907, -394.39189631930964, -323.3137643873468, -1337.678884943804, -1447.9000256687711, -44.79769268510709, -60.57495860426632, -79.8357400345415, -984.417432074628, -165.07759486591175, -1031.2373820861517, -1128.4154544418282, -427.0156420706229, -569.1425545570994, 26.93968422694526, -57.291428139528875, 30.08441147489476, -488.5808786745987, -376.2093530535086, -902.3224333280232, -444.58189232708025, -332.4139149703632, -126.8954628736866, -740.0749498557255, -1187.7058170380035, -1080.051580311619, -1072.8131781532309, -231.23213911218798, -561.9086715983049, -746.5228433215764, -777.4157443208385, -1547.1984243912618, -378.41716093397974, -32.90577206360135, -782.904586729738, -986.9177340424297, -398.02590891851423, -905.871779100483, -1007.1738711773497, -207.7160376408256, -686.1790141001941, -1708.3000246487775, -20.41165737825554, -671.6516325779523, -571.5002467154995, -453.2547927667388, -769.1705680631877, -995.0509547331588, -710.6647373296787, -1197.310411821847, -160.4673933437999, -303.637675263492, -663.2888490656147, -515.2414047362411, -909.8457063369955, -1506.5842951988882, -253.5093699378602, -953.3294441870636, -1174.8206109172063, -1184.8371821863366, -785.8566803333796, -340.54005843747194, -1189.8022621808789, -668.5375154600787, -763.1219043510217, 173.13443932943449, -901.8040840560242, -962.0047483626408, -316.93328402655976, -403.7437297206421, -1207.2112595121137, -371.5421718794953, -1262.9040868318125, -202.59225695006833, -321.9436286553897, -784.3419435729116, -1199.6154301988217, -807.9632957004225, -24.928237892892568, -17.10034378921724, -1830.8812967545732, -616.5783235141772, -671.8173544271808, -489.3839764408101, -768.9991927241443, -587.7108447701729, -25.150292135657104, -1428.5720492637597, -415.5028222391756, -185.7589231203226, -622.0341022317627, -1360.7358425923558, -895.9166606766429, 329.4354799754761, -783.1734527841011, -1198.3562027975531, -1194.7033466352464, -1543.410567545399, -584.1296952245974, 23.62061835865976, 77.71461369507847, -1016.394139990887, -852.5261569559635, -332.4439224718042, -496.07358514688065, -642.0790843238307, -1334.098523119521, -249.13763398251845, -635.967747888154, -903.858934608991, -75.3911097500124, -194.8769392784914], "policy_predator_policy_reward": [604.0897686880041, 1012.195303315537, 146.28900899462872, 3.6141622264058517, 712.921478054891, 204.78088418578443, 422.3601797535192, 508.64386227682616, 1052.7079097767416, 406.912415443474, 1138.6130582526514, 381.56817053095097, 233.25318832289355, 332.74510468183666, 642.4268770782384, 798.6736155554979, 460.6584658979112, 430.2503273011215, 369.88111469345813, 963.6000080960046, 560.7845441631968, 1050.514516868107, 1171.1340264823084, 85.71333498833205, 942.3471711173277, 18.347282761019038, 607.967160367918, 761.9224105743953, 829.5393528201522, 1356.8312357755722, 1135.8264575049732, 1217.3420532769137, 1218.9523067655655, 1483.7051324621762, 448.21335952240116, 652.7033822539402, 1021.7836292479168, 803.3375043481784, 1653.0816001597748, 1390.6977763392038, 900.8166024690366, 1032.8749233748767, 160.11308405065958, 681.5117238912203, 309.38543152348586, 985.047804516227, 1251.6192469613338, 917.0041592923002, 742.4457419410882, 927.4717173944532, 357.92908071638476, 793.7777830825207, 80.03870670558489, 1489.9742995221718, 1070.9882367702028, 869.8215523100583, 801.2169903634455, 945.1091390884402, 708.7978950463388, 821.3021851211572, 1353.074437227884, 998.7908021891643, 1417.1662628319134, 365.9889001786957, 806.1384191228435, 463.97167550313475, 1468.4186002958165, 744.5312865203055, 381.5304782426687, 1010.2882085141604, 1226.7495818246882, 34.19665577004913, 295.34005601917755, 673.578502046998, 854.3650577716105, 609.9803054366366, 629.9965393586655, 778.2516891675641, 171.9457552542882, 890.9519348595807, 869.8709402754349, 357.4681357484299, 672.615804521892, 747.8084854463323, 1034.4745429793086, 907.4290637391989, 523.1368469377464, 964.1645008250168, 493.84303731239686, 418.09189631931486, 145.45193085618425, 1429.4884459784325, 1447.9000256687711, 83.28466540270111, 54.41795684442803, 154.45690656738844, 82.38699644949016, 1112.5336222432068, 995.9010211080708, 1275.9817151963393, 334.6014105123282, 739.2982977043795, 12.060315773054828, 91.09142813952755, 60.84798549470361, 508.0494138187049, 243.51868804354578, 924.9490301313822, 802.9077856718155, 14.887748412991549, 40.2081015465017, 839.4708723296106, 1189.7058170380042, 1089.8515803116125, 924.4786260155455, 703.2968668772288, 857.8482067121133, 694.7503071100639, 797.7157443208431, 1547.1984243912618, 401.31716093398495, 68.20577206360186, 959.0191641534828, 988.1200256462141, 255.9255894472998, 956.201343226262, 1150.5935761865858, 1.199091563222897, 1059.3183919266949, 1678.266985797635, 433.1033607632373, 337.47702200279656, 726.5342497970965, 226.7104860911395, 917.8041792171568, 953.360850529461, 1131.8708616646884, 1135.4184650614018, 129.35952676726717, 412.5210693631789, 507.37522677917747, 700.8488912026946, 1054.2133024559469, 1484.6030449926795, 658.1642650308048, 570.036178443789, 1175.1206109172062, 1188.3371821863363, 851.4669622726126, 650.5196438443822, 1160.28779616305, 955.9516348736169, 439.02323991763825, 669.4615098444092, 1047.9319254158181, 942.9445086067657, 357.39505158126155, 425.33747384202906, 942.4696954540524, 1051.7449875496277, 755.0083915471508, 895.9595362817743, 615.1152323384811, 739.760043087534, 875.0668742752115, 1225.0802161351232, 158.02858168211046, 0.0, 1830.8812967545732, 620.5783235141782, 597.5420192605752, 749.593944947808, 552.5421673562556, 691.0494181374153, 410.1126909273339, 1413.839465356596, 418.4753722206879, 243.8945508753857, 647.7551855645958, 1491.1960234884793, 634.9309616992463, 722.603961165255, 780.5773961286119, 1204.9569309428593, 1215.6095969803318, 1525.0750336394665, 612.2296952246033, 15.07938164134028, 479.6771997545213, 960.634437890691, 347.42317824245396, 860.3361714163644, 1216.1415946770828, 129.78979274175583, 1350.7628856388524, 291.9590108770063, 346.61217704201334, 1083.0175014184074, 256.6827699126509, 139.02666147428204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.753299193018714, "mean_inference_ms": 5.270647948230968, "mean_action_processing_ms": 2.075516631911334, "mean_env_wait_ms": 12.396224563403651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043441057205200195, "StateBufferConnector_ms": 0.009229540824890137, "ViewRequirementAgentConnector_ms": 0.16373670101165771}, "num_episodes": 17, "episode_return_max": 935.8627720494608, "episode_return_min": -113.11845200065457, "episode_return_mean": 119.14335867044532, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.11537583531063, "num_env_steps_trained_throughput_per_sec": 77.11537583531063, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 52743.35, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52743.305, "sample_time_ms": 2374.607, "learn_time_ms": 50350.878, "learn_throughput": 79.443, "synch_weights_time_ms": 14.739}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "645a5_00000", "date": "2024-08-22_12-32-28", "timestamp": 1724310148, "time_this_iter_s": 51.92524790763855, "time_total_s": 2343.205112218857, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x15eec6f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2343.205112218857, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 26.721917808219178, "ram_util_percent": 82.6109589041096}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.638534263454417, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.344807348806391, "policy_loss": -0.012987217364004917, "vf_loss": 7.355656000419899, "vf_explained_var": 0.3425788097911411, "kl": 0.010692875199488035, "entropy": 0.5914706464324678, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.961935266868148, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.242376326505469, "policy_loss": -0.018166265000771516, "vf_loss": 7.257949257401562, "vf_explained_var": 0.4027371853116959, "kl": 0.012966694809969455, "entropy": 0.862327956585657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 935.8627720494608, "episode_reward_min": -118.93016081360638, "episode_reward_mean": 121.02808053127563, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1830.8812967545732, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 329.4354799754761, "predator_policy": 1830.8812967545732}, "policy_reward_mean": {"prey_policy": -684.4095867100722, "predator_policy": 744.9236269757109}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.693364122595925, 231.15374046019315, 82.72396626933038, 144.18583600322668, 38.72566805472415, 77.51250941754606, 184.89185339649993, 33.5852059479879, 7.599999999999982, 11.499999999999968, 200.38078330686048, 339.6357653572295, 11.59999999999998, 935.8627720494608, 118.73243315865092, 100.27731613067306, 126.33331389264768, 114.37202660958332, 19.027905925112083, 39.27084723007054, 309.5200950389966, 119.93457951187955, 222.75365215811735, 228.42092692163047, 27.280973164415656, -28.189879726063623, -37.394977411747455, -50.47238596016277, 8.961058557608187, -6.8818175162657305, 138.8541111240451, -10.082028487538295, -90.6875086860469, 231.7514243373243, 19.393473685263896, -4.6462579084228866, -11.785995495431946, 50.70000000000045, -86.05227249653328, 38.486972717594945, 68.46416477301268, 45.42559175216169, 112.22989977643115, 77.74151158897774, 72.80000000000014, 110.40093211369583, -110.0640682066082, 40.79972678736136, 12.708561146696304, 11.799999999999976, 323.7301756273615, 244.16699890229197, 20.300000000000022, 58.20000000000056, 177.31686902752435, -91.77075534543454, -63.097241068366955, 343.1063389753558, 78.51709280982155, -71.51030359400886, 106.9435069502695, 359.3141775745634, 77.77552752315164, 29.69386418001281, 122.38634591273876, 21.36162934966922, 3.8000000000000007, 375.5898673461358, 257.89965339569966, 518.4972847404633, 127.06760160391866, 62.05551167607736, 415.46125161206567, 185.4715840470491, 248.58970319770236, 92.5683645110859, 115.99999999999966, 3.9999999999999973, 185.93463334038796, -113.11845200065457, 370.2298148845147, 61.10817773657104, 156.181264228961, 791.0537421633345, 4.004671489815953, 2.570716439152992, 66.80000000000048, 501.6321113494041, 22.78927023104198, 207.77871794812683, 59.48573941381626, -110.19700403673217, 125.44138235842931, 739.9012146143874, 326.4688423145726, 316.41554577666847, 65.81631877618636, -47.15746220007818, -118.93016081360638, 6.928149565329489], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-571.6901406040479, -860.7169879070902, -212.67203327538988, -447.0830194634429, -401.8843914015678, -848.8727651185606, -304.0102113539485, -1163.1030136741292, -252.24169204186072, -965.8800013740563, -406.1591762370525, -477.02276822374, -633.2659299073285, -551.7317876384798, -801.3913001414811, -1351.394082506261, -1129.826457504977, -1215.7420532769133, -1207.552306765575, -1483.605132462176, -28.757284117570727, -871.778674351904, -1099.3123035380459, -386.17306470081803, -1382.598104233421, -1649.5812722655594, -1018.8951141898613, 21.066360395409085, -98.95693704463065, -623.9354377385926, -213.38556745259743, -980.7703524564414, -1282.6371094719227, -759.6529828890585, -476.4251010774283, -1079.1203316485305, -320.13204578288514, -812.5469120909014, -42.067859475514936, -1488.674299522173, -514.7891619452639, -1116.500532095999, -717.834861666313, -908.556688273686, -551.7622005440213, -755.5842274653543, -834.2996748224617, -1289.1446376729523, -1417.1662628319134, -338.70792701427365, -701.1448634967971, -597.1551108552407, -1321.7142326797468, -928.6306315481261, -656.568916588843, -785.7221561281431, -869.8217895832452, -382.1633894538827, -66.73171761561709, -909.0686579668222, 16.57142782176583, -1342.0626799059721, -666.0422167999551, -752.2880402138071, -376.8863326064458, -776.6988661934682, -586.4418865150567, -409.1457651714793, -780.5038853529287, -620.5269309300254, -1167.7328618305858, -778.8170027963458, -294.2360178352179, -1204.851325422978, -466.8430373123907, -394.39189631930964, -323.3137643873468, -1337.678884943804, -1447.9000256687711, -44.79769268510709, -60.57495860426632, -79.8357400345415, -984.417432074628, -165.07759486591175, -1031.2373820861517, -1128.4154544418282, -427.0156420706229, -569.1425545570994, 26.93968422694526, -57.291428139528875, 30.08441147489476, -488.5808786745987, -376.2093530535086, -902.3224333280232, -444.58189232708025, -332.4139149703632, -126.8954628736866, -740.0749498557255, -1187.7058170380035, -1080.051580311619, -1072.8131781532309, -231.23213911218798, -561.9086715983049, -746.5228433215764, -777.4157443208385, -1547.1984243912618, -378.41716093397974, -32.90577206360135, -782.904586729738, -986.9177340424297, -398.02590891851423, -905.871779100483, -1007.1738711773497, -207.7160376408256, -686.1790141001941, -1708.3000246487775, -20.41165737825554, -671.6516325779523, -571.5002467154995, -453.2547927667388, -769.1705680631877, -995.0509547331588, -710.6647373296787, -1197.310411821847, -160.4673933437999, -303.637675263492, -663.2888490656147, -515.2414047362411, -909.8457063369955, -1506.5842951988882, -253.5093699378602, -953.3294441870636, -1174.8206109172063, -1184.8371821863366, -785.8566803333796, -340.54005843747194, -1189.8022621808789, -668.5375154600787, -763.1219043510217, 173.13443932943449, -901.8040840560242, -962.0047483626408, -316.93328402655976, -403.7437297206421, -1207.2112595121137, -371.5421718794953, -1262.9040868318125, -202.59225695006833, -321.9436286553897, -784.3419435729116, -1199.6154301988217, -807.9632957004225, -24.928237892892568, -17.10034378921724, -1830.8812967545732, -616.5783235141772, -671.8173544271808, -489.3839764408101, -768.9991927241443, -587.7108447701729, -25.150292135657104, -1428.5720492637597, -415.5028222391756, -185.7589231203226, -622.0341022317627, -1360.7358425923558, -895.9166606766429, 329.4354799754761, -783.1734527841011, -1198.3562027975531, -1194.7033466352464, -1543.410567545399, -584.1296952245974, 23.62061835865976, 77.71461369507847, -1016.394139990887, -852.5261569559635, -332.4439224718042, -496.07358514688065, -642.0790843238307, -1334.098523119521, -249.13763398251845, -635.967747888154, -903.858934608991, -75.3911097500124, -194.8769392784914, -97.00872318489655, -1103.3104654999725, -930.5714424367991, -565.5862203063167, -1019.8652729279806, -393.89548363434056, -223.4526172966702, -176.20855735326566, -448.5499095123238, -834.4025876978556, -425.76038067582016, -1015.5360227088399, -599.2228269506334, -715.5671716139028], "policy_predator_policy_reward": [642.4268770782384, 798.6736155554979, 460.6584658979112, 430.2503273011215, 369.88111469345813, 963.6000080960046, 560.7845441631968, 1050.514516868107, 1171.1340264823084, 85.71333498833205, 942.3471711173277, 18.347282761019038, 607.967160367918, 761.9224105743953, 829.5393528201522, 1356.8312357755722, 1135.8264575049732, 1217.3420532769137, 1218.9523067655655, 1483.7051324621762, 448.21335952240116, 652.7033822539402, 1021.7836292479168, 803.3375043481784, 1653.0816001597748, 1390.6977763392038, 900.8166024690366, 1032.8749233748767, 160.11308405065958, 681.5117238912203, 309.38543152348586, 985.047804516227, 1251.6192469613338, 917.0041592923002, 742.4457419410882, 927.4717173944532, 357.92908071638476, 793.7777830825207, 80.03870670558489, 1489.9742995221718, 1070.9882367702028, 869.8215523100583, 801.2169903634455, 945.1091390884402, 708.7978950463388, 821.3021851211572, 1353.074437227884, 998.7908021891643, 1417.1662628319134, 365.9889001786957, 806.1384191228435, 463.97167550313475, 1468.4186002958165, 744.5312865203055, 381.5304782426687, 1010.2882085141604, 1226.7495818246882, 34.19665577004913, 295.34005601917755, 673.578502046998, 854.3650577716105, 609.9803054366366, 629.9965393586655, 778.2516891675641, 171.9457552542882, 890.9519348595807, 869.8709402754349, 357.4681357484299, 672.615804521892, 747.8084854463323, 1034.4745429793086, 907.4290637391989, 523.1368469377464, 964.1645008250168, 493.84303731239686, 418.09189631931486, 145.45193085618425, 1429.4884459784325, 1447.9000256687711, 83.28466540270111, 54.41795684442803, 154.45690656738844, 82.38699644949016, 1112.5336222432068, 995.9010211080708, 1275.9817151963393, 334.6014105123282, 739.2982977043795, 12.060315773054828, 91.09142813952755, 60.84798549470361, 508.0494138187049, 243.51868804354578, 924.9490301313822, 802.9077856718155, 14.887748412991549, 40.2081015465017, 839.4708723296106, 1189.7058170380042, 1089.8515803116125, 924.4786260155455, 703.2968668772288, 857.8482067121133, 694.7503071100639, 797.7157443208431, 1547.1984243912618, 401.31716093398495, 68.20577206360186, 959.0191641534828, 988.1200256462141, 255.9255894472998, 956.201343226262, 1150.5935761865858, 1.199091563222897, 1059.3183919266949, 1678.266985797635, 433.1033607632373, 337.47702200279656, 726.5342497970965, 226.7104860911395, 917.8041792171568, 953.360850529461, 1131.8708616646884, 1135.4184650614018, 129.35952676726717, 412.5210693631789, 507.37522677917747, 700.8488912026946, 1054.2133024559469, 1484.6030449926795, 658.1642650308048, 570.036178443789, 1175.1206109172062, 1188.3371821863363, 851.4669622726126, 650.5196438443822, 1160.28779616305, 955.9516348736169, 439.02323991763825, 669.4615098444092, 1047.9319254158181, 942.9445086067657, 357.39505158126155, 425.33747384202906, 942.4696954540524, 1051.7449875496277, 755.0083915471508, 895.9595362817743, 615.1152323384811, 739.760043087534, 875.0668742752115, 1225.0802161351232, 158.02858168211046, 0.0, 1830.8812967545732, 620.5783235141782, 597.5420192605752, 749.593944947808, 552.5421673562556, 691.0494181374153, 410.1126909273339, 1413.839465356596, 418.4753722206879, 243.8945508753857, 647.7551855645958, 1491.1960234884793, 634.9309616992463, 722.603961165255, 780.5773961286119, 1204.9569309428593, 1215.6095969803318, 1525.0750336394665, 612.2296952246033, 15.07938164134028, 479.6771997545213, 960.634437890691, 347.42317824245396, 860.3361714163644, 1216.1415946770828, 129.78979274175583, 1350.7628856388524, 291.9590108770063, 346.61217704201334, 1083.0175014184074, 256.6827699126509, 139.02666147428204, 965.2116527566814, 975.0087505425672, 810.6896790984839, 1011.9368259592143, 1132.9538047226108, 597.2224976163741, 261.30828405279794, 204.1692093733203, 270.5089184388705, 965.2861165712335, 261.34778221376905, 1061.0184603572866, 599.458159039647, 722.2599890902251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.753047671758441, "mean_inference_ms": 5.258589002325722, "mean_action_processing_ms": 2.0463688261581354, "mean_env_wait_ms": 12.36717470422426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004401683807373047, "StateBufferConnector_ms": 0.009250283241271973, "ViewRequirementAgentConnector_ms": 0.1798797845840454}, "num_episodes": 7, "episode_return_max": 935.8627720494608, "episode_return_min": -118.93016081360638, "episode_return_mean": 121.02808053127563, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 69.21792047000875, "num_env_steps_trained_throughput_per_sec": 69.21792047000875, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 53275.419, "restore_workers_time_ms": 0.015, "training_step_time_ms": 53275.373, "sample_time_ms": 2376.488, "learn_time_ms": 50881.109, "learn_throughput": 78.615, "synch_weights_time_ms": 14.562}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "645a5_00000", "date": "2024-08-22_12-33-26", "timestamp": 1724310206, "time_this_iter_s": 57.8314950466156, "time_total_s": 2401.0366072654724, "pid": 51133, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16a174f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2401.0366072654724, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 42.610975609756096, "ram_util_percent": 82.85609756097561}}
