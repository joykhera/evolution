{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7381649922835765, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.523440347399031, "policy_loss": -0.015727490912777958, "vf_loss": 8.53770139255221, "vf_explained_var": 0.058627122230630706, "kl": 0.007332199598199357, "entropy": 1.6036584305384802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6688570345362658, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.363045491364898, "policy_loss": -0.011631348999907021, "vf_loss": 6.373057011447886, "vf_explained_var": 0.009590976515775004, "kl": 0.008099193972530503, "entropy": 1.6032852497050372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 395.7954576750752, "episode_reward_min": 59.20000000000057, "episode_reward_mean": 241.36935053951336, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -397.85042468127494, "predator_policy": 6.8566530349489225}, "policy_reward_max": {"prey_policy": 216.3710590814682, "predator_policy": 452.904995314885}, "policy_reward_mean": {"prey_policy": -80.72250841646355, "predator_policy": 201.40718368622035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [219.99999999999915, 287.10000000000014, 386.5000000000049, 226.76414965389438, 262.6036949223957, 237.95895638012294, 96.4018962241271, 395.7954576750752, 59.20000000000057], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-101.75168193461471, -396.7049953148832, -106.73912491431616, 125.37145804732721, 28.238923083808324, 182.52203126128344, -10.492567368115933, -175.88572052878953, -188.01696314816022, 9.241924479539179, -54.830268043593954, 190.0605596731327, -161.20014751524974, -237.4773764636852, -397.85042468127494, 216.3710590814682, -7.10802311743902, -366.75381409278043], "policy_predator_policy_reward": [265.5516819346144, 452.904995314885, 166.85349459463632, 101.61417227235157, 168.88239261995787, 6.8566530349489225, 181.75127513363338, 231.39116241716715, 347.4112661051959, 93.96746748582031, 80.61048225946473, 22.118182491121512, 281.6240311538119, 213.45538904924928, 277.4949416617994, 299.7798816130842, 43.80802311743938, 389.25381409278526]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7304519048343663, "mean_inference_ms": 1.5921330495078034, "mean_action_processing_ms": 0.27062143994135296, "mean_env_wait_ms": 0.19718116118971823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005752510494656033, "StateBufferConnector_ms": 0.0028941366407606336, "ViewRequirementAgentConnector_ms": 0.0822199715508355}, "num_episodes": 9, "episode_return_max": 395.7954576750752, "episode_return_min": 59.20000000000057, "episode_return_mean": 241.36935053951336, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.78234171022433, "num_env_steps_trained_throughput_per_sec": 81.78234171022433, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 48910.322, "restore_workers_time_ms": 0.019, "training_step_time_ms": 48910.266, "sample_time_ms": 1309.924, "learn_time_ms": 47588.506, "learn_throughput": 84.054, "synch_weights_time_ms": 10.784}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "929db_00000", "date": "2024-08-22_10-32-20", "timestamp": 1724302940, "time_this_iter_s": 48.94972801208496, "time_total_s": 48.94972801208496, "pid": 93290, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2873ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 48.94972801208496, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.625714285714285, "ram_util_percent": 79.67428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.608451335896891, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.820929131432185, "policy_loss": -0.023754682582211754, "vf_loss": 7.8420149714858445, "vf_explained_var": 0.09565938629170574, "kl": 0.013344250974817746, "entropy": 1.573279497989271, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.054192868206236, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.627438633025639, "policy_loss": -0.017597370559876913, "vf_loss": 4.643742654310963, "vf_explained_var": 0.02329196289733604, "kl": 0.006466724625361241, "entropy": 1.5940248816732376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 487.5378891979823, "episode_reward_min": 59.20000000000057, "episode_reward_mean": 265.26426786638, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -397.85042468127494, "predator_policy": 1.803524294305085}, "policy_reward_max": {"prey_policy": 311.53626419317993, "predator_policy": 452.904995314885}, "policy_reward_mean": {"prey_policy": -36.47867984708377, "predator_policy": 169.11081378027356}, "custom_metrics": {}, "hist_stats": {"episode_reward": [219.99999999999915, 287.10000000000014, 386.5000000000049, 226.76414965389438, 262.6036949223957, 237.95895638012294, 96.4018962241271, 395.7954576750752, 59.20000000000057, 197.09999999999937, 446.10000000000093, 152.79999999999976, 487.5378891979823, 204.69999999999737, 313.2000000000002, 459.60000000000514, 206.89477754123607, 134.4999999999993], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-101.75168193461471, -396.7049953148832, -106.73912491431616, 125.37145804732721, 28.238923083808324, 182.52203126128344, -10.492567368115933, -175.88572052878953, -188.01696314816022, 9.241924479539179, -54.830268043593954, 190.0605596731327, -161.20014751524974, -237.4773764636852, -397.85042468127494, 216.3710590814682, -7.10802311743902, -366.75381409278043, -191.6111026540542, -132.2416802611736, 311.53626419317993, -189.4022743663046, 7.7706410387299325, 7.010307702756553, 142.83101552998428, 217.75313834384465, 28.778670445999172, -46.811372943251115, 130.38955500644644, -108.05164722950218, 97.40472125400217, 200.19999999999874, -208.74165583553201, 39.87346266416984, -120.51621470573077, -46.39915118223451], "policy_predator_policy_reward": [265.5516819346144, 452.904995314885, 166.85349459463632, 101.61417227235157, 168.88239261995787, 6.8566530349489225, 181.75127513363338, 231.39116241716715, 347.4112661051959, 93.96746748582031, 80.61048225946473, 22.118182491121512, 281.6240311538119, 213.45538904924928, 277.4949416617994, 299.7798816130842, 43.80802311743938, 389.25381409278526, 341.41110265405416, 179.5416802611739, 23.36373580681976, 300.60227436630515, 115.81142959234015, 22.207621666173356, 93.50019784418805, 33.45353747995913, 115.14757425716877, 107.5851282400827, 104.1554523138488, 186.70663990920602, 160.19175445169247, 1.803524294305085, 167.65062648127002, 208.1123442313313, 213.940840837229, 87.47452505073464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6823945907345776, "mean_inference_ms": 1.498930628854537, "mean_action_processing_ms": 0.2581318215807613, "mean_env_wait_ms": 0.18821971924535624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005486276414659288, "StateBufferConnector_ms": 0.0028173128763834634, "ViewRequirementAgentConnector_ms": 0.08070932494269477}, "num_episodes": 9, "episode_return_max": 487.5378891979823, "episode_return_min": 59.20000000000057, "episode_return_mean": 265.26426786638, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.18105209014492, "num_env_steps_trained_throughput_per_sec": 84.18105209014492, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 48213.48, "restore_workers_time_ms": 0.016, "training_step_time_ms": 48213.433, "sample_time_ms": 1162.067, "learn_time_ms": 47039.196, "learn_throughput": 85.035, "synch_weights_time_ms": 10.653}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "929db_00000", "date": "2024-08-22_10-33-10", "timestamp": 1724302990, "time_this_iter_s": 47.55979800224304, "time_total_s": 96.509526014328, "pid": 93290, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28be550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 96.509526014328, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 20.938028169014082, "ram_util_percent": 80.63380281690142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.534953240821601, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.095920049576533, "policy_loss": -0.02134819818148143, "vf_loss": 8.115080791049534, "vf_explained_var": 0.08984714150428771, "kl": 0.010937313698228517, "entropy": 1.5509785352560579, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2404729043049787, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.609584517327566, "policy_loss": -0.02325972163921626, "vf_loss": 4.630894492542933, "vf_explained_var": 0.045409674303872244, "kl": 0.009748735904611415, "entropy": 1.5690561698227332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 487.5378891979823, "episode_reward_min": -25.452902693287154, "episode_reward_mean": 265.54851935425035, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -454.8343960155999, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 341.8494371104173, "predator_policy": 452.904995314885}, "policy_reward_mean": {"prey_policy": -31.066141370568904, "predator_policy": 163.8404010476938}, "custom_metrics": {}, "hist_stats": {"episode_reward": [219.99999999999915, 287.10000000000014, 386.5000000000049, 226.76414965389438, 262.6036949223957, 237.95895638012294, 96.4018962241271, 395.7954576750752, 59.20000000000057, 197.09999999999937, 446.10000000000093, 152.79999999999976, 487.5378891979823, 204.69999999999737, 313.2000000000002, 459.60000000000514, 206.89477754123607, 134.4999999999993, 399.81619550799303, 373.5000000000001, 219.84143054987783, 468.43734992528516, 237.59999999999877, -25.452902693287154, 390.10000000000224, 19.31112768004821, 311.90000000000015], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-101.75168193461471, -396.7049953148832, -106.73912491431616, 125.37145804732721, 28.238923083808324, 182.52203126128344, -10.492567368115933, -175.88572052878953, -188.01696314816022, 9.241924479539179, -54.830268043593954, 190.0605596731327, -161.20014751524974, -237.4773764636852, -397.85042468127494, 216.3710590814682, -7.10802311743902, -366.75381409278043, -191.6111026540542, -132.2416802611736, 311.53626419317993, -189.4022743663046, 7.7706410387299325, 7.010307702756553, 142.83101552998428, 217.75313834384465, 28.778670445999172, -46.811372943251115, 130.38955500644644, -108.05164722950218, 97.40472125400217, 200.19999999999874, -208.74165583553201, 39.87346266416984, -120.51621470573077, -46.39915118223451, 159.79678112596562, -171.90541760438612, 143.4782323473115, 59.555640919031, -22.49870272916675, -138.97426599809836, 225.49555880899158, 132.71507479208077, 175.98958164530066, -199.53280058175642, -303.5232634583872, -454.8343960155999, -141.26145244989905, 341.8494371104173, -51.99248725326952, -359.34034187216884, -17.85102582911457, 258.494687527043], "policy_predator_policy_reward": [265.5516819346144, 452.904995314885, 166.85349459463632, 101.61417227235157, 168.88239261995787, 6.8566530349489225, 181.75127513363338, 231.39116241716715, 347.4112661051959, 93.96746748582031, 80.61048225946473, 22.118182491121512, 281.6240311538119, 213.45538904924928, 277.4949416617994, 299.7798816130842, 43.80802311743938, 389.25381409278526, 341.41110265405416, 179.5416802611739, 23.36373580681976, 300.60227436630515, 115.81142959234015, 22.207621666173356, 93.50019784418805, 33.45353747995913, 115.14757425716877, 107.5851282400827, 104.1554523138488, 186.70663990920602, 160.19175445169247, 1.803524294305085, 167.65062648127002, 208.1123442313313, 213.940840837229, 87.47452505073464, 405.46405267580855, 6.4607793106039955, 75.82447140427426, 94.64165532938163, 260.603070299261, 120.7113289778805, 95.04959237551243, 15.177123948698405, 35.71041835469896, 225.4328005817563, 306.787023234326, 426.11773354637603, 178.16145244989764, 11.350562889583115, 426.54274523322266, 4.101211572264278, 71.25633830207205, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6589171591280656, "mean_inference_ms": 1.4665851496341178, "mean_action_processing_ms": 0.2544238031047161, "mean_env_wait_ms": 0.18539924228278742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005373689863416884, "StateBufferConnector_ms": 0.002818195908157914, "ViewRequirementAgentConnector_ms": 0.08101330863104926}, "num_episodes": 9, "episode_return_max": 487.5378891979823, "episode_return_min": -25.452902693287154, "episode_return_mean": 265.54851935425035, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.38288683409814, "num_env_steps_trained_throughput_per_sec": 82.38288683409814, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 48326.914, "restore_workers_time_ms": 0.015, "training_step_time_ms": 48326.867, "sample_time_ms": 1151.594, "learn_time_ms": 47162.122, "learn_throughput": 84.814, "synch_weights_time_ms": 11.546}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "929db_00000", "date": "2024-08-22_10-33-59", "timestamp": 1724303039, "time_this_iter_s": 48.58787298202515, "time_total_s": 145.09739899635315, "pid": 93290, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28c98b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 145.09739899635315, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 21.182608695652174, "ram_util_percent": 80.39710144927535}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0607482978275846, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.174268676616528, "policy_loss": -0.022318824761665412, "vf_loss": 8.194198602595657, "vf_explained_var": 0.09955909400389938, "kl": 0.011944461094292449, "entropy": 1.5292032512407454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.330174250924398, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.892543008844688, "policy_loss": -0.021217422548770196, "vf_loss": 4.911617064728308, "vf_explained_var": 0.0415716808309, "kl": 0.010716876067970955, "entropy": 1.552314011886637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 518.0999999999997, "episode_reward_min": -25.452902693287154, "episode_reward_mean": 286.59645528853326, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -539.6990253904004, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 341.8494371104173, "predator_policy": 553.3990253904021}, "policy_reward_mean": {"prey_policy": -20.678959400993605, "predator_policy": 163.97718704525994}, "custom_metrics": {}, "hist_stats": {"episode_reward": [219.99999999999915, 287.10000000000014, 386.5000000000049, 226.76414965389438, 262.6036949223957, 237.95895638012294, 96.4018962241271, 395.7954576750752, 59.20000000000057, 197.09999999999937, 446.10000000000093, 152.79999999999976, 487.5378891979823, 204.69999999999737, 313.2000000000002, 459.60000000000514, 206.89477754123607, 134.4999999999993, 399.81619550799303, 373.5000000000001, 219.84143054987783, 468.43734992528516, 237.59999999999877, -25.452902693287154, 390.10000000000224, 19.31112768004821, 311.90000000000015, 391.20000000000226, 518.0999999999997, 194.19999999999956, 398.3000000000021, 339.03104346299955, 387.70000000000226, 212.99999999999903, 350.20000000000175, 355.93132435943375], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-101.75168193461471, -396.7049953148832, -106.73912491431616, 125.37145804732721, 28.238923083808324, 182.52203126128344, -10.492567368115933, -175.88572052878953, -188.01696314816022, 9.241924479539179, -54.830268043593954, 190.0605596731327, -161.20014751524974, -237.4773764636852, -397.85042468127494, 216.3710590814682, -7.10802311743902, -366.75381409278043, -191.6111026540542, -132.2416802611736, 311.53626419317993, -189.4022743663046, 7.7706410387299325, 7.010307702756553, 142.83101552998428, 217.75313834384465, 28.778670445999172, -46.811372943251115, 130.38955500644644, -108.05164722950218, 97.40472125400217, 200.19999999999874, -208.74165583553201, 39.87346266416984, -120.51621470573077, -46.39915118223451, 159.79678112596562, -171.90541760438612, 143.4782323473115, 59.555640919031, -22.49870272916675, -138.97426599809836, 225.49555880899158, 132.71507479208077, 175.98958164530066, -199.53280058175642, -303.5232634583872, -454.8343960155999, -141.26145244989905, 341.8494371104173, -51.99248725326952, -359.34034187216884, -17.85102582911457, 258.494687527043, -152.60824626806243, 329.56022980198367, -72.96948868181826, 330.2721806952115, -113.422264532202, -539.6990253904004, 32.21276972728408, 323.9158271930269, -118.39874667152576, 117.9588742564073, 29.97959420166357, 339.2214430826214, 12.728279862277827, -175.5202698010575, -110.22079449571471, 203.6244486512157, 45.56197858179711, -293.5102330735272], "policy_predator_policy_reward": [265.5516819346144, 452.904995314885, 166.85349459463632, 101.61417227235157, 168.88239261995787, 6.8566530349489225, 181.75127513363338, 231.39116241716715, 347.4112661051959, 93.96746748582031, 80.61048225946473, 22.118182491121512, 281.6240311538119, 213.45538904924928, 277.4949416617994, 299.7798816130842, 43.80802311743938, 389.25381409278526, 341.41110265405416, 179.5416802611739, 23.36373580681976, 300.60227436630515, 115.81142959234015, 22.207621666173356, 93.50019784418805, 33.45353747995913, 115.14757425716877, 107.5851282400827, 104.1554523138488, 186.70663990920602, 160.19175445169247, 1.803524294305085, 167.65062648127002, 208.1123442313313, 213.940840837229, 87.47452505073464, 405.46405267580855, 6.4607793106039955, 75.82447140427426, 94.64165532938163, 260.603070299261, 120.7113289778805, 95.04959237551243, 15.177123948698405, 35.71041835469896, 225.4328005817563, 306.787023234326, 426.11773354637603, 178.16145244989764, 11.350562889583115, 426.54274523322266, 4.101211572264278, 71.25633830207205, 0.0, 182.13139002106936, 32.116626445008585, 258.7694886818177, 2.027819304788498, 293.9222645322022, 553.3990253904021, 7.087230272716097, 35.08417280697312, 216.36864182868828, 123.10227404942677, 17.26705440478469, 1.2319083109308597, 25.171720137722225, 350.62026980105765, 143.82079449571447, 112.97555134878463, 452.60230405829145, 151.2772747928718]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6436909943789405, "mean_inference_ms": 1.4384887737473022, "mean_action_processing_ms": 0.25084129280011336, "mean_env_wait_ms": 0.18256953100675916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005641910764906142, "StateBufferConnector_ms": 0.002991490893893772, "ViewRequirementAgentConnector_ms": 0.085181991259257}, "num_episodes": 9, "episode_return_max": 518.0999999999997, "episode_return_min": -25.452902693287154, "episode_return_mean": 286.59645528853326, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.13484759641243, "num_env_steps_trained_throughput_per_sec": 82.13484759641243, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 48420.287, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48420.245, "sample_time_ms": 1114.836, "learn_time_ms": 47291.421, "learn_throughput": 84.582, "synch_weights_time_ms": 12.592}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "929db_00000", "date": "2024-08-22_10-34-47", "timestamp": 1724303087, "time_this_iter_s": 48.7051887512207, "time_total_s": 193.80258774757385, "pid": 93290, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b288b280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 193.80258774757385, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.92, "ram_util_percent": 79.53000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.688094487865135, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.998022223275806, "policy_loss": -0.02257756129949398, "vf_loss": 9.018782234696484, "vf_explained_var": 0.16051105175699507, "kl": 0.009087726772465653, "entropy": 1.5139350828039584, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5819636641671417, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.943083550059606, "policy_loss": -0.02671251561487754, "vf_loss": 3.9677676855571686, "vf_explained_var": 0.07244376962777799, "kl": 0.01014183668792651, "entropy": 1.5420965566836968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 719.8286879847938, "episode_reward_min": -25.452902693287154, "episode_reward_mean": 321.8654429309241, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 18000, "policy_reward_min": {"prey_policy": -539.6990253904004, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 356.6371322568426, "predator_policy": 553.3990253904021}, "policy_reward_mean": {"prey_policy": -2.554383112952766, "predator_policy": 163.48710457841455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [219.99999999999915, 287.10000000000014, 386.5000000000049, 226.76414965389438, 262.6036949223957, 237.95895638012294, 96.4018962241271, 395.7954576750752, 59.20000000000057, 197.09999999999937, 446.10000000000093, 152.79999999999976, 487.5378891979823, 204.69999999999737, 313.2000000000002, 459.60000000000514, 206.89477754123607, 134.4999999999993, 399.81619550799303, 373.5000000000001, 219.84143054987783, 468.43734992528516, 237.59999999999877, -25.452902693287154, 390.10000000000224, 19.31112768004821, 311.90000000000015, 391.20000000000226, 518.0999999999997, 194.19999999999956, 398.3000000000021, 339.03104346299955, 387.70000000000226, 212.99999999999903, 350.20000000000175, 355.93132435943375, 344.94634695151274, 719.8286879847938, 492.10000000000014, 296.2000000000005, 647.2000000000007, 344.7000000000007, 445.6000000000006, 428.60000000000014, 447.2975065680748], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-101.75168193461471, -396.7049953148832, -106.73912491431616, 125.37145804732721, 28.238923083808324, 182.52203126128344, -10.492567368115933, -175.88572052878953, -188.01696314816022, 9.241924479539179, -54.830268043593954, 190.0605596731327, -161.20014751524974, -237.4773764636852, -397.85042468127494, 216.3710590814682, -7.10802311743902, -366.75381409278043, -191.6111026540542, -132.2416802611736, 311.53626419317993, -189.4022743663046, 7.7706410387299325, 7.010307702756553, 142.83101552998428, 217.75313834384465, 28.778670445999172, -46.811372943251115, 130.38955500644644, -108.05164722950218, 97.40472125400217, 200.19999999999874, -208.74165583553201, 39.87346266416984, -120.51621470573077, -46.39915118223451, 159.79678112596562, -171.90541760438612, 143.4782323473115, 59.555640919031, -22.49870272916675, -138.97426599809836, 225.49555880899158, 132.71507479208077, 175.98958164530066, -199.53280058175642, -303.5232634583872, -454.8343960155999, -141.26145244989905, 341.8494371104173, -51.99248725326952, -359.34034187216884, -17.85102582911457, 258.494687527043, -152.60824626806243, 329.56022980198367, -72.96948868181826, 330.2721806952115, -113.422264532202, -539.6990253904004, 32.21276972728408, 323.9158271930269, -118.39874667152576, 117.9588742564073, 29.97959420166357, 339.2214430826214, 12.728279862277827, -175.5202698010575, -110.22079449571471, 203.6244486512157, 45.56197858179711, -293.5102330735272, 170.5286883240416, 51.418144395739034, 216.11763254460152, 356.6371322568426, -96.23269169730384, 37.260610598492406, -487.09314572832614, 193.24225497514095, 333.6143942246203, 204.6829408902285, -30.211294125476023, 210.84185365748897, 14.850310776191781, -4.752038276900273, -90.4429537637092, 234.1700272502234, 162.03431855832952, -217.6755881544341], "policy_predator_policy_reward": [265.5516819346144, 452.904995314885, 166.85349459463632, 101.61417227235157, 168.88239261995787, 6.8566530349489225, 181.75127513363338, 231.39116241716715, 347.4112661051959, 93.96746748582031, 80.61048225946473, 22.118182491121512, 281.6240311538119, 213.45538904924928, 277.4949416617994, 299.7798816130842, 43.80802311743938, 389.25381409278526, 341.41110265405416, 179.5416802611739, 23.36373580681976, 300.60227436630515, 115.81142959234015, 22.207621666173356, 93.50019784418805, 33.45353747995913, 115.14757425716877, 107.5851282400827, 104.1554523138488, 186.70663990920602, 160.19175445169247, 1.803524294305085, 167.65062648127002, 208.1123442313313, 213.940840837229, 87.47452505073464, 405.46405267580855, 6.4607793106039955, 75.82447140427426, 94.64165532938163, 260.603070299261, 120.7113289778805, 95.04959237551243, 15.177123948698405, 35.71041835469896, 225.4328005817563, 306.787023234326, 426.11773354637603, 178.16145244989764, 11.350562889583115, 426.54274523322266, 4.101211572264278, 71.25633830207205, 0.0, 182.13139002106936, 32.116626445008585, 258.7694886818177, 2.027819304788498, 293.9222645322022, 553.3990253904021, 7.087230272716097, 35.08417280697312, 216.36864182868828, 123.10227404942677, 17.26705440478469, 1.2319083109308597, 25.171720137722225, 350.62026980105765, 143.82079449571447, 112.97555134878463, 452.60230405829145, 151.2772747928718, 82.48303781173922, 40.51647641999319, 98.96536289976007, 48.10856028358935, 329.1485446363947, 221.92353646241614, 503.5931457283291, 86.45774502485857, 17.6672302988579, 91.23543458629348, 3.321979830875562, 160.74746063711152, 351.1330096643864, 84.3687178363212, 253.04295376370885, 31.8299727497766, 66.16739047059862, 436.7713856935802]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6309665790699436, "mean_inference_ms": 1.4127845564823032, "mean_action_processing_ms": 0.247698395769653, "mean_env_wait_ms": 0.17979421417478983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057464175754123265, "StateBufferConnector_ms": 0.0030154652065700954, "ViewRequirementAgentConnector_ms": 0.08738597234090169}, "num_episodes": 9, "episode_return_max": 719.8286879847938, "episode_return_min": -25.452902693287154, "episode_return_mean": 321.8654429309241, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.85401958511139, "num_env_steps_trained_throughput_per_sec": 81.85401958511139, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 48509.728, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48509.687, "sample_time_ms": 1083.879, "learn_time_ms": 47411.401, "learn_throughput": 84.368, "synch_weights_time_ms": 13.023}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "929db_00000", "date": "2024-08-22_10-35-36", "timestamp": 1724303136, "time_this_iter_s": 48.87257695198059, "time_total_s": 242.67516469955444, "pid": 93290, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28cb3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 242.67516469955444, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.294202898550726, "ram_util_percent": 78.80724637681159}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.968951488140399, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.945771330121964, "policy_loss": -0.023996696910431617, "vf_loss": 8.967850140667466, "vf_explained_var": 0.10750827675773984, "kl": 0.009589384286245454, "entropy": 1.491763355303063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7858176321579666, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.997873860944516, "policy_loss": -0.02614031795008236, "vf_loss": 5.021608292993414, "vf_explained_var": 0.06726006231610737, "kl": 0.01202943287675854, "entropy": 1.5203572540686874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 719.8286879847938, "episode_reward_min": -25.452902693287154, "episode_reward_mean": 350.2540437343608, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 21600, "policy_reward_min": {"prey_policy": -539.6990253904004, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 356.6371322568426, "predator_policy": 553.3990253904021}, "policy_reward_mean": {"prey_policy": 16.792938019439084, "predator_policy": 158.33408384774108}, "custom_metrics": {}, "hist_stats": {"episode_reward": [219.99999999999915, 287.10000000000014, 386.5000000000049, 226.76414965389438, 262.6036949223957, 237.95895638012294, 96.4018962241271, 395.7954576750752, 59.20000000000057, 197.09999999999937, 446.10000000000093, 152.79999999999976, 487.5378891979823, 204.69999999999737, 313.2000000000002, 459.60000000000514, 206.89477754123607, 134.4999999999993, 399.81619550799303, 373.5000000000001, 219.84143054987783, 468.43734992528516, 237.59999999999877, -25.452902693287154, 390.10000000000224, 19.31112768004821, 311.90000000000015, 391.20000000000226, 518.0999999999997, 194.19999999999956, 398.3000000000021, 339.03104346299955, 387.70000000000226, 212.99999999999903, 350.20000000000175, 355.93132435943375, 344.94634695151274, 719.8286879847938, 492.10000000000014, 296.2000000000005, 647.2000000000007, 344.7000000000007, 445.6000000000006, 428.60000000000014, 447.2975065680748, 527.5023049483383, 262.6999999999989, 671.1000000000007, 475.1000000000007, 383.50100488341934, 450.5806387950462, 678.3905660504971, 334.3999999999994, 646.4989150865974], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-101.75168193461471, -396.7049953148832, -106.73912491431616, 125.37145804732721, 28.238923083808324, 182.52203126128344, -10.492567368115933, -175.88572052878953, -188.01696314816022, 9.241924479539179, -54.830268043593954, 190.0605596731327, -161.20014751524974, -237.4773764636852, -397.85042468127494, 216.3710590814682, -7.10802311743902, -366.75381409278043, -191.6111026540542, -132.2416802611736, 311.53626419317993, -189.4022743663046, 7.7706410387299325, 7.010307702756553, 142.83101552998428, 217.75313834384465, 28.778670445999172, -46.811372943251115, 130.38955500644644, -108.05164722950218, 97.40472125400217, 200.19999999999874, -208.74165583553201, 39.87346266416984, -120.51621470573077, -46.39915118223451, 159.79678112596562, -171.90541760438612, 143.4782323473115, 59.555640919031, -22.49870272916675, -138.97426599809836, 225.49555880899158, 132.71507479208077, 175.98958164530066, -199.53280058175642, -303.5232634583872, -454.8343960155999, -141.26145244989905, 341.8494371104173, -51.99248725326952, -359.34034187216884, -17.85102582911457, 258.494687527043, -152.60824626806243, 329.56022980198367, -72.96948868181826, 330.2721806952115, -113.422264532202, -539.6990253904004, 32.21276972728408, 323.9158271930269, -118.39874667152576, 117.9588742564073, 29.97959420166357, 339.2214430826214, 12.728279862277827, -175.5202698010575, -110.22079449571471, 203.6244486512157, 45.56197858179711, -293.5102330735272, 170.5286883240416, 51.418144395739034, 216.11763254460152, 356.6371322568426, -96.23269169730384, 37.260610598492406, -487.09314572832614, 193.24225497514095, 333.6143942246203, 204.6829408902285, -30.211294125476023, 210.84185365748897, 14.850310776191781, -4.752038276900273, -90.4429537637092, 234.1700272502234, 162.03431855832952, -217.6755881544341, 28.692282649269963, 348.9215935338498, -399.92971675066894, 86.27051623955649, 249.8131652097523, 336.3778816836732, -255.49761371821575, 356.24665264238797, 73.34784607608609, -55.89599729485533, 202.19942623517835, -27.3181769896988, 281.9730810850971, 320.0902152119901, -7.2800935373470566, 29.187467241963944, 140.37242938953747, 335.9608273576132], "policy_predator_policy_reward": [265.5516819346144, 452.904995314885, 166.85349459463632, 101.61417227235157, 168.88239261995787, 6.8566530349489225, 181.75127513363338, 231.39116241716715, 347.4112661051959, 93.96746748582031, 80.61048225946473, 22.118182491121512, 281.6240311538119, 213.45538904924928, 277.4949416617994, 299.7798816130842, 43.80802311743938, 389.25381409278526, 341.41110265405416, 179.5416802611739, 23.36373580681976, 300.60227436630515, 115.81142959234015, 22.207621666173356, 93.50019784418805, 33.45353747995913, 115.14757425716877, 107.5851282400827, 104.1554523138488, 186.70663990920602, 160.19175445169247, 1.803524294305085, 167.65062648127002, 208.1123442313313, 213.940840837229, 87.47452505073464, 405.46405267580855, 6.4607793106039955, 75.82447140427426, 94.64165532938163, 260.603070299261, 120.7113289778805, 95.04959237551243, 15.177123948698405, 35.71041835469896, 225.4328005817563, 306.787023234326, 426.11773354637603, 178.16145244989764, 11.350562889583115, 426.54274523322266, 4.101211572264278, 71.25633830207205, 0.0, 182.13139002106936, 32.116626445008585, 258.7694886818177, 2.027819304788498, 293.9222645322022, 553.3990253904021, 7.087230272716097, 35.08417280697312, 216.36864182868828, 123.10227404942677, 17.26705440478469, 1.2319083109308597, 25.171720137722225, 350.62026980105765, 143.82079449571447, 112.97555134878463, 452.60230405829145, 151.2772747928718, 82.48303781173922, 40.51647641999319, 98.96536289976007, 48.10856028358935, 329.1485446363947, 221.92353646241614, 503.5931457283291, 86.45774502485857, 17.6672302988579, 91.23543458629348, 3.321979830875562, 160.74746063711152, 351.1330096643864, 84.3687178363212, 253.04295376370885, 31.8299727497766, 66.16739047059862, 436.7713856935802, 83.0462718299145, 66.84215693530486, 422.2297167506739, 154.1294837604433, 69.4868347902476, 15.422118316326866, 359.39761371821675, 14.953347357612122, 214.25250210990308, 151.79665399228338, 233.54258398811638, 42.15680556145023, 21.574943437222775, 54.75232631618611, 309.3741434114924, 3.118482883890715, 21.405126328935552, 148.76053201051053]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6206616614305263, "mean_inference_ms": 1.393322266233116, "mean_action_processing_ms": 0.24520348530638833, "mean_env_wait_ms": 0.17766103163410985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056637658013237845, "StateBufferConnector_ms": 0.0029934777153862845, "ViewRequirementAgentConnector_ms": 0.08617639541625977}, "num_episodes": 9, "episode_return_max": 719.8286879847938, "episode_return_min": -25.452902693287154, "episode_return_mean": 350.2540437343608, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.98993107215254, "num_env_steps_trained_throughput_per_sec": 82.98993107215254, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 48457.878, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48457.837, "sample_time_ms": 1074.077, "learn_time_ms": 47369.324, "learn_throughput": 84.443, "synch_weights_time_ms": 13.086}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "929db_00000", "date": "2024-08-22_10-36-24", "timestamp": 1724303184, "time_this_iter_s": 48.20443415641785, "time_total_s": 290.8795988559723, "pid": 93290, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28da940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 290.8795988559723, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 16.53333333333334, "ram_util_percent": 79.5072463768116}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.491800243829293, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.941137712973136, "policy_loss": -0.021650592946797293, "vf_loss": 8.960595804547507, "vf_explained_var": 0.02952352894677056, "kl": 0.010962539100299006, "entropy": 1.476427489992172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.676054044785323, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.496470325712174, "policy_loss": -0.022928235243153437, "vf_loss": 7.516874103445224, "vf_explained_var": 0.0781658670574269, "kl": 0.012622309220972168, "entropy": 1.4787225889781164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 719.8286879847938, "episode_reward_min": -25.452902693287154, "episode_reward_mean": 353.0721353880226, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 25200, "policy_reward_min": {"prey_policy": -539.6990253904004, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 356.6371322568426, "predator_policy": 553.3990253904021}, "policy_reward_mean": {"prey_policy": 10.223535538137574, "predator_policy": 166.31253215587353}, "custom_metrics": {}, "hist_stats": {"episode_reward": [219.99999999999915, 287.10000000000014, 386.5000000000049, 226.76414965389438, 262.6036949223957, 237.95895638012294, 96.4018962241271, 395.7954576750752, 59.20000000000057, 197.09999999999937, 446.10000000000093, 152.79999999999976, 487.5378891979823, 204.69999999999737, 313.2000000000002, 459.60000000000514, 206.89477754123607, 134.4999999999993, 399.81619550799303, 373.5000000000001, 219.84143054987783, 468.43734992528516, 237.59999999999877, -25.452902693287154, 390.10000000000224, 19.31112768004821, 311.90000000000015, 391.20000000000226, 518.0999999999997, 194.19999999999956, 398.3000000000021, 339.03104346299955, 387.70000000000226, 212.99999999999903, 350.20000000000175, 355.93132435943375, 344.94634695151274, 719.8286879847938, 492.10000000000014, 296.2000000000005, 647.2000000000007, 344.7000000000007, 445.6000000000006, 428.60000000000014, 447.2975065680748, 527.5023049483383, 262.6999999999989, 671.1000000000007, 475.1000000000007, 383.50100488341934, 450.5806387950462, 678.3905660504971, 334.3999999999994, 646.4989150865974, 211.59249172698216, 84.95679904959515, 194.9999999999987, 623.400000000001, 404.08564510026997, 406.09078069862454, 360.0191172744544, 411.5664291466219, 633.1149047933951], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-101.75168193461471, -396.7049953148832, -106.73912491431616, 125.37145804732721, 28.238923083808324, 182.52203126128344, -10.492567368115933, -175.88572052878953, -188.01696314816022, 9.241924479539179, -54.830268043593954, 190.0605596731327, -161.20014751524974, -237.4773764636852, -397.85042468127494, 216.3710590814682, -7.10802311743902, -366.75381409278043, -191.6111026540542, -132.2416802611736, 311.53626419317993, -189.4022743663046, 7.7706410387299325, 7.010307702756553, 142.83101552998428, 217.75313834384465, 28.778670445999172, -46.811372943251115, 130.38955500644644, -108.05164722950218, 97.40472125400217, 200.19999999999874, -208.74165583553201, 39.87346266416984, -120.51621470573077, -46.39915118223451, 159.79678112596562, -171.90541760438612, 143.4782323473115, 59.555640919031, -22.49870272916675, -138.97426599809836, 225.49555880899158, 132.71507479208077, 175.98958164530066, -199.53280058175642, -303.5232634583872, -454.8343960155999, -141.26145244989905, 341.8494371104173, -51.99248725326952, -359.34034187216884, -17.85102582911457, 258.494687527043, -152.60824626806243, 329.56022980198367, -72.96948868181826, 330.2721806952115, -113.422264532202, -539.6990253904004, 32.21276972728408, 323.9158271930269, -118.39874667152576, 117.9588742564073, 29.97959420166357, 339.2214430826214, 12.728279862277827, -175.5202698010575, -110.22079449571471, 203.6244486512157, 45.56197858179711, -293.5102330735272, 170.5286883240416, 51.418144395739034, 216.11763254460152, 356.6371322568426, -96.23269169730384, 37.260610598492406, -487.09314572832614, 193.24225497514095, 333.6143942246203, 204.6829408902285, -30.211294125476023, 210.84185365748897, 14.850310776191781, -4.752038276900273, -90.4429537637092, 234.1700272502234, 162.03431855832952, -217.6755881544341, 28.692282649269963, 348.9215935338498, -399.92971675066894, 86.27051623955649, 249.8131652097523, 336.3778816836732, -255.49761371821575, 356.24665264238797, 73.34784607608609, -55.89599729485533, 202.19942623517835, -27.3181769896988, 281.9730810850971, 320.0902152119901, -7.2800935373470566, 29.187467241963944, 140.37242938953747, 335.9608273576132, -286.86937038095857, -421.16748358634766, -269.1186781917936, -383.4900770624981, -347.59647057545504, -55.25454216876611, 284.0488385064749, 204.07371812330376, 51.50356786822174, 265.31074570311625, -167.77432621315435, 115.50561750912253, 229.71872142123706, -0.5799763476286844, 184.38026891214992, -343.5001230700401, 221.4505917548493, 193.88714950407993], "policy_predator_policy_reward": [265.5516819346144, 452.904995314885, 166.85349459463632, 101.61417227235157, 168.88239261995787, 6.8566530349489225, 181.75127513363338, 231.39116241716715, 347.4112661051959, 93.96746748582031, 80.61048225946473, 22.118182491121512, 281.6240311538119, 213.45538904924928, 277.4949416617994, 299.7798816130842, 43.80802311743938, 389.25381409278526, 341.41110265405416, 179.5416802611739, 23.36373580681976, 300.60227436630515, 115.81142959234015, 22.207621666173356, 93.50019784418805, 33.45353747995913, 115.14757425716877, 107.5851282400827, 104.1554523138488, 186.70663990920602, 160.19175445169247, 1.803524294305085, 167.65062648127002, 208.1123442313313, 213.940840837229, 87.47452505073464, 405.46405267580855, 6.4607793106039955, 75.82447140427426, 94.64165532938163, 260.603070299261, 120.7113289778805, 95.04959237551243, 15.177123948698405, 35.71041835469896, 225.4328005817563, 306.787023234326, 426.11773354637603, 178.16145244989764, 11.350562889583115, 426.54274523322266, 4.101211572264278, 71.25633830207205, 0.0, 182.13139002106936, 32.116626445008585, 258.7694886818177, 2.027819304788498, 293.9222645322022, 553.3990253904021, 7.087230272716097, 35.08417280697312, 216.36864182868828, 123.10227404942677, 17.26705440478469, 1.2319083109308597, 25.171720137722225, 350.62026980105765, 143.82079449571447, 112.97555134878463, 452.60230405829145, 151.2772747928718, 82.48303781173922, 40.51647641999319, 98.96536289976007, 48.10856028358935, 329.1485446363947, 221.92353646241614, 503.5931457283291, 86.45774502485857, 17.6672302988579, 91.23543458629348, 3.321979830875562, 160.74746063711152, 351.1330096643864, 84.3687178363212, 253.04295376370885, 31.8299727497766, 66.16739047059862, 436.7713856935802, 83.0462718299145, 66.84215693530486, 422.2297167506739, 154.1294837604433, 69.4868347902476, 15.422118316326866, 359.39761371821675, 14.953347357612122, 214.25250210990308, 151.79665399228338, 233.54258398811638, 42.15680556145023, 21.574943437222775, 54.75232631618611, 309.3741434114924, 3.118482883890715, 21.405126328935552, 148.76053201051053, 421.3499358934771, 498.2794098008114, 323.0939805469931, 414.471573756896, 468.8964705754552, 128.95454216876442, 61.651161493525244, 73.6262818766958, 30.429268005337, 56.84206352359506, 174.3563394545271, 284.00314994812715, 84.2935472099278, 46.58682499091692, 363.7191428147859, 206.9671404897254, 173.03535887246585, 44.7418046619993]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6135093811317922, "mean_inference_ms": 1.3760723506807837, "mean_action_processing_ms": 0.24302688087913585, "mean_env_wait_ms": 0.1757393921592461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005541718195355128, "StateBufferConnector_ms": 0.0029346299549889944, "ViewRequirementAgentConnector_ms": 0.08428607668195452}, "num_episodes": 9, "episode_return_max": 719.8286879847938, "episode_return_min": -25.452902693287154, "episode_return_mean": 353.0721353880226, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.81318590278383, "num_env_steps_trained_throughput_per_sec": 82.81318590278383, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 48435.537, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48435.497, "sample_time_ms": 1061.131, "learn_time_ms": 47360.12, "learn_throughput": 84.459, "synch_weights_time_ms": 12.989}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "929db_00000", "date": "2024-08-22_10-37-13", "timestamp": 1724303233, "time_this_iter_s": 48.30655384063721, "time_total_s": 339.1861526966095, "pid": 93290, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b288b9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 339.1861526966095, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.302941176470586, "ram_util_percent": 79.44852941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.010861212898184, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.19702952854217, "policy_loss": -0.02339794418993825, "vf_loss": 8.218047199047431, "vf_explained_var": 0.1011698841417908, "kl": 0.011901383360278997, "entropy": 1.4751066255821752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8602811328317754, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.645413233237292, "policy_loss": -0.024396782828662446, "vf_loss": 6.667405454191582, "vf_explained_var": 0.0904901105890829, "kl": 0.01202281945683896, "entropy": 1.4542013382154797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 719.8286879847938, "episode_reward_min": -25.452902693287154, "episode_reward_mean": 341.77585448176546, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -539.6990253904004, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 356.6371322568426, "predator_policy": 553.3990253904021}, "policy_reward_mean": {"prey_policy": -10.09484815605323, "predator_policy": 180.98277539693578}, "custom_metrics": {}, "hist_stats": {"episode_reward": [219.99999999999915, 287.10000000000014, 386.5000000000049, 226.76414965389438, 262.6036949223957, 237.95895638012294, 96.4018962241271, 395.7954576750752, 59.20000000000057, 197.09999999999937, 446.10000000000093, 152.79999999999976, 487.5378891979823, 204.69999999999737, 313.2000000000002, 459.60000000000514, 206.89477754123607, 134.4999999999993, 399.81619550799303, 373.5000000000001, 219.84143054987783, 468.43734992528516, 237.59999999999877, -25.452902693287154, 390.10000000000224, 19.31112768004821, 311.90000000000015, 391.20000000000226, 518.0999999999997, 194.19999999999956, 398.3000000000021, 339.03104346299955, 387.70000000000226, 212.99999999999903, 350.20000000000175, 355.93132435943375, 344.94634695151274, 719.8286879847938, 492.10000000000014, 296.2000000000005, 647.2000000000007, 344.7000000000007, 445.6000000000006, 428.60000000000014, 447.2975065680748, 527.5023049483383, 262.6999999999989, 671.1000000000007, 475.1000000000007, 383.50100488341934, 450.5806387950462, 678.3905660504971, 334.3999999999994, 646.4989150865974, 211.59249172698216, 84.95679904959515, 194.9999999999987, 623.400000000001, 404.08564510026997, 406.09078069862454, 360.0191172744544, 411.5664291466219, 633.1149047933951, 237.96601601899513, 405.65831392767745, 382.40344366163276, 193.2688026399267, 110.76083903113185, 297.4220985444541, 322.0320850121774, 226.5610716515814, 188.2443227541082], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-101.75168193461471, -396.7049953148832, -106.73912491431616, 125.37145804732721, 28.238923083808324, 182.52203126128344, -10.492567368115933, -175.88572052878953, -188.01696314816022, 9.241924479539179, -54.830268043593954, 190.0605596731327, -161.20014751524974, -237.4773764636852, -397.85042468127494, 216.3710590814682, -7.10802311743902, -366.75381409278043, -191.6111026540542, -132.2416802611736, 311.53626419317993, -189.4022743663046, 7.7706410387299325, 7.010307702756553, 142.83101552998428, 217.75313834384465, 28.778670445999172, -46.811372943251115, 130.38955500644644, -108.05164722950218, 97.40472125400217, 200.19999999999874, -208.74165583553201, 39.87346266416984, -120.51621470573077, -46.39915118223451, 159.79678112596562, -171.90541760438612, 143.4782323473115, 59.555640919031, -22.49870272916675, -138.97426599809836, 225.49555880899158, 132.71507479208077, 175.98958164530066, -199.53280058175642, -303.5232634583872, -454.8343960155999, -141.26145244989905, 341.8494371104173, -51.99248725326952, -359.34034187216884, -17.85102582911457, 258.494687527043, -152.60824626806243, 329.56022980198367, -72.96948868181826, 330.2721806952115, -113.422264532202, -539.6990253904004, 32.21276972728408, 323.9158271930269, -118.39874667152576, 117.9588742564073, 29.97959420166357, 339.2214430826214, 12.728279862277827, -175.5202698010575, -110.22079449571471, 203.6244486512157, 45.56197858179711, -293.5102330735272, 170.5286883240416, 51.418144395739034, 216.11763254460152, 356.6371322568426, -96.23269169730384, 37.260610598492406, -487.09314572832614, 193.24225497514095, 333.6143942246203, 204.6829408902285, -30.211294125476023, 210.84185365748897, 14.850310776191781, -4.752038276900273, -90.4429537637092, 234.1700272502234, 162.03431855832952, -217.6755881544341, 28.692282649269963, 348.9215935338498, -399.92971675066894, 86.27051623955649, 249.8131652097523, 336.3778816836732, -255.49761371821575, 356.24665264238797, 73.34784607608609, -55.89599729485533, 202.19942623517835, -27.3181769896988, 281.9730810850971, 320.0902152119901, -7.2800935373470566, 29.187467241963944, 140.37242938953747, 335.9608273576132, -286.86937038095857, -421.16748358634766, -269.1186781917936, -383.4900770624981, -347.59647057545504, -55.25454216876611, 284.0488385064749, 204.07371812330376, 51.50356786822174, 265.31074570311625, -167.77432621315435, 115.50561750912253, 229.71872142123706, -0.5799763476286844, 184.38026891214992, -343.5001230700401, 221.4505917548493, 193.88714950407993, 11.434832288496766, -239.19023733730367, -2.466945337582553, -55.19963911824961, 203.17853813640193, -152.0917503237869, -422.510064874694, -20.063710826401902, -269.499671122226, -303.46889141307884, 50.3478745090699, -136.25894611245377, -30.472421226997163, -388.7107333353383, -155.0825587502004, -297.18806745905937, -247.4012543687817, -287.1799656048144], "policy_predator_policy_reward": [265.5516819346144, 452.904995314885, 166.85349459463632, 101.61417227235157, 168.88239261995787, 6.8566530349489225, 181.75127513363338, 231.39116241716715, 347.4112661051959, 93.96746748582031, 80.61048225946473, 22.118182491121512, 281.6240311538119, 213.45538904924928, 277.4949416617994, 299.7798816130842, 43.80802311743938, 389.25381409278526, 341.41110265405416, 179.5416802611739, 23.36373580681976, 300.60227436630515, 115.81142959234015, 22.207621666173356, 93.50019784418805, 33.45353747995913, 115.14757425716877, 107.5851282400827, 104.1554523138488, 186.70663990920602, 160.19175445169247, 1.803524294305085, 167.65062648127002, 208.1123442313313, 213.940840837229, 87.47452505073464, 405.46405267580855, 6.4607793106039955, 75.82447140427426, 94.64165532938163, 260.603070299261, 120.7113289778805, 95.04959237551243, 15.177123948698405, 35.71041835469896, 225.4328005817563, 306.787023234326, 426.11773354637603, 178.16145244989764, 11.350562889583115, 426.54274523322266, 4.101211572264278, 71.25633830207205, 0.0, 182.13139002106936, 32.116626445008585, 258.7694886818177, 2.027819304788498, 293.9222645322022, 553.3990253904021, 7.087230272716097, 35.08417280697312, 216.36864182868828, 123.10227404942677, 17.26705440478469, 1.2319083109308597, 25.171720137722225, 350.62026980105765, 143.82079449571447, 112.97555134878463, 452.60230405829145, 151.2772747928718, 82.48303781173922, 40.51647641999319, 98.96536289976007, 48.10856028358935, 329.1485446363947, 221.92353646241614, 503.5931457283291, 86.45774502485857, 17.6672302988579, 91.23543458629348, 3.321979830875562, 160.74746063711152, 351.1330096643864, 84.3687178363212, 253.04295376370885, 31.8299727497766, 66.16739047059862, 436.7713856935802, 83.0462718299145, 66.84215693530486, 422.2297167506739, 154.1294837604433, 69.4868347902476, 15.422118316326866, 359.39761371821675, 14.953347357612122, 214.25250210990308, 151.79665399228338, 233.54258398811638, 42.15680556145023, 21.574943437222775, 54.75232631618611, 309.3741434114924, 3.118482883890715, 21.405126328935552, 148.76053201051053, 421.3499358934771, 498.2794098008114, 323.0939805469931, 414.471573756896, 468.8964705754552, 128.95454216876442, 61.651161493525244, 73.6262818766958, 30.429268005337, 56.84206352359506, 174.3563394545271, 284.00314994812715, 84.2935472099278, 46.58682499091692, 363.7191428147859, 206.9671404897254, 173.03535887246585, 44.7418046619993, 64.53851063923383, 401.18291042856833, 119.20194473095606, 344.1229536525527, 158.6718989407614, 172.64475690825526, 284.14909293917907, 351.69348540184694, 310.5259251670276, 373.2034763994091, 182.83516915707386, 200.49800099076342, 287.81098437936396, 453.4042551951494, 246.06333551807955, 432.76836234276124, 365.41245537307753, 357.4130873546303]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6068596486475487, "mean_inference_ms": 1.3607358507164344, "mean_action_processing_ms": 0.24111004901396915, "mean_env_wait_ms": 0.17401083440343393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005512932936350505, "StateBufferConnector_ms": 0.0029171506563822427, "ViewRequirementAgentConnector_ms": 0.08392731348673503}, "num_episodes": 9, "episode_return_max": 719.8286879847938, "episode_return_min": -25.452902693287154, "episode_return_mean": 341.77585448176546, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.98808133343617, "num_env_steps_trained_throughput_per_sec": 81.98808133343617, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 48479.543, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48479.504, "sample_time_ms": 1044.528, "learn_time_ms": 47420.191, "learn_throughput": 84.352, "synch_weights_time_ms": 13.404}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "929db_00000", "date": "2024-08-22_10-38-02", "timestamp": 1724303282, "time_this_iter_s": 48.817174673080444, "time_total_s": 388.00332736968994, "pid": 93290, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28e0670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 388.00332736968994, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 21.508571428571432, "ram_util_percent": 80.26714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.33416224106279, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.495399136013456, "policy_loss": -0.0257653690144055, "vf_loss": 8.518780453999836, "vf_explained_var": 0.017323830897215182, "kl": 0.011920242059537957, "entropy": 1.457226397183837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.973242178102019, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.274247231559148, "policy_loss": -0.023623389820198692, "vf_loss": 8.29557258893573, "vf_explained_var": 0.06366236758610559, "kl": 0.011490151066876748, "entropy": 1.4257995733508357, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 719.8286879847938, "episode_reward_min": -25.452902693287154, "episode_reward_mean": 341.67097557210144, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 34000, "policy_reward_min": {"prey_policy": -539.6990253904004, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 356.6371322568426, "predator_policy": 553.3990253904021}, "policy_reward_mean": {"prey_policy": -10.679056700850465, "predator_policy": 181.51454448690103}, "custom_metrics": {}, "hist_stats": {"episode_reward": [219.99999999999915, 287.10000000000014, 386.5000000000049, 226.76414965389438, 262.6036949223957, 237.95895638012294, 96.4018962241271, 395.7954576750752, 59.20000000000057, 197.09999999999937, 446.10000000000093, 152.79999999999976, 487.5378891979823, 204.69999999999737, 313.2000000000002, 459.60000000000514, 206.89477754123607, 134.4999999999993, 399.81619550799303, 373.5000000000001, 219.84143054987783, 468.43734992528516, 237.59999999999877, -25.452902693287154, 390.10000000000224, 19.31112768004821, 311.90000000000015, 391.20000000000226, 518.0999999999997, 194.19999999999956, 398.3000000000021, 339.03104346299955, 387.70000000000226, 212.99999999999903, 350.20000000000175, 355.93132435943375, 344.94634695151274, 719.8286879847938, 492.10000000000014, 296.2000000000005, 647.2000000000007, 344.7000000000007, 445.6000000000006, 428.60000000000014, 447.2975065680748, 527.5023049483383, 262.6999999999989, 671.1000000000007, 475.1000000000007, 383.50100488341934, 450.5806387950462, 678.3905660504971, 334.3999999999994, 646.4989150865974, 211.59249172698216, 84.95679904959515, 194.9999999999987, 623.400000000001, 404.08564510026997, 406.09078069862454, 360.0191172744544, 411.5664291466219, 633.1149047933951, 237.96601601899513, 405.65831392767745, 382.40344366163276, 193.2688026399267, 110.76083903113185, 297.4220985444541, 322.0320850121774, 226.5610716515814, 188.2443227541082, 595.0806460086095, 312.2793485711627, 338.54770648570405, 261.1257801657002, 268.9862784603651, 419.6889762371507, 270.94324859615836, 330.7053151621917, 319.5488681046035, 161.05821402937465, 473.82484715234585, 246.07782972283042, 436.3043422453104], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-101.75168193461471, -396.7049953148832, -106.73912491431616, 125.37145804732721, 28.238923083808324, 182.52203126128344, -10.492567368115933, -175.88572052878953, -188.01696314816022, 9.241924479539179, -54.830268043593954, 190.0605596731327, -161.20014751524974, -237.4773764636852, -397.85042468127494, 216.3710590814682, -7.10802311743902, -366.75381409278043, -191.6111026540542, -132.2416802611736, 311.53626419317993, -189.4022743663046, 7.7706410387299325, 7.010307702756553, 142.83101552998428, 217.75313834384465, 28.778670445999172, -46.811372943251115, 130.38955500644644, -108.05164722950218, 97.40472125400217, 200.19999999999874, -208.74165583553201, 39.87346266416984, -120.51621470573077, -46.39915118223451, 159.79678112596562, -171.90541760438612, 143.4782323473115, 59.555640919031, -22.49870272916675, -138.97426599809836, 225.49555880899158, 132.71507479208077, 175.98958164530066, -199.53280058175642, -303.5232634583872, -454.8343960155999, -141.26145244989905, 341.8494371104173, -51.99248725326952, -359.34034187216884, -17.85102582911457, 258.494687527043, -152.60824626806243, 329.56022980198367, -72.96948868181826, 330.2721806952115, -113.422264532202, -539.6990253904004, 32.21276972728408, 323.9158271930269, -118.39874667152576, 117.9588742564073, 29.97959420166357, 339.2214430826214, 12.728279862277827, -175.5202698010575, -110.22079449571471, 203.6244486512157, 45.56197858179711, -293.5102330735272, 170.5286883240416, 51.418144395739034, 216.11763254460152, 356.6371322568426, -96.23269169730384, 37.260610598492406, -487.09314572832614, 193.24225497514095, 333.6143942246203, 204.6829408902285, -30.211294125476023, 210.84185365748897, 14.850310776191781, -4.752038276900273, -90.4429537637092, 234.1700272502234, 162.03431855832952, -217.6755881544341, 28.692282649269963, 348.9215935338498, -399.92971675066894, 86.27051623955649, 249.8131652097523, 336.3778816836732, -255.49761371821575, 356.24665264238797, 73.34784607608609, -55.89599729485533, 202.19942623517835, -27.3181769896988, 281.9730810850971, 320.0902152119901, -7.2800935373470566, 29.187467241963944, 140.37242938953747, 335.9608273576132, -286.86937038095857, -421.16748358634766, -269.1186781917936, -383.4900770624981, -347.59647057545504, -55.25454216876611, 284.0488385064749, 204.07371812330376, 51.50356786822174, 265.31074570311625, -167.77432621315435, 115.50561750912253, 229.71872142123706, -0.5799763476286844, 184.38026891214992, -343.5001230700401, 221.4505917548493, 193.88714950407993, 11.434832288496766, -239.19023733730367, -2.466945337582553, -55.19963911824961, 203.17853813640193, -152.0917503237869, -422.510064874694, -20.063710826401902, -269.499671122226, -303.46889141307884, 50.3478745090699, -136.25894611245377, -30.472421226997163, -388.7107333353383, -155.0825587502004, -297.18806745905937, -247.4012543687817, -287.1799656048144, 101.02405974788823, 269.1018473329621, -102.86535826340734, -112.59317031162384, 14.796755052228441, 10.502571973679917, -116.01796214573626, -272.7472369953875, -196.61744904516112, -76.7507937957145, 131.67353755661608, 74.33029038430422, 33.78962250602179, -79.28182056668243, 217.3, -173.6197207196628, 16.457793928150082, -153.86891733438915, -35.93826217451389, 38.01687303217978, 153.4480680473634, 127.84734719803049, -226.1747678761059, -35.1941470466673, 82.05273390075263, -50.453399058038734], "policy_predator_policy_reward": [265.5516819346144, 452.904995314885, 166.85349459463632, 101.61417227235157, 168.88239261995787, 6.8566530349489225, 181.75127513363338, 231.39116241716715, 347.4112661051959, 93.96746748582031, 80.61048225946473, 22.118182491121512, 281.6240311538119, 213.45538904924928, 277.4949416617994, 299.7798816130842, 43.80802311743938, 389.25381409278526, 341.41110265405416, 179.5416802611739, 23.36373580681976, 300.60227436630515, 115.81142959234015, 22.207621666173356, 93.50019784418805, 33.45353747995913, 115.14757425716877, 107.5851282400827, 104.1554523138488, 186.70663990920602, 160.19175445169247, 1.803524294305085, 167.65062648127002, 208.1123442313313, 213.940840837229, 87.47452505073464, 405.46405267580855, 6.4607793106039955, 75.82447140427426, 94.64165532938163, 260.603070299261, 120.7113289778805, 95.04959237551243, 15.177123948698405, 35.71041835469896, 225.4328005817563, 306.787023234326, 426.11773354637603, 178.16145244989764, 11.350562889583115, 426.54274523322266, 4.101211572264278, 71.25633830207205, 0.0, 182.13139002106936, 32.116626445008585, 258.7694886818177, 2.027819304788498, 293.9222645322022, 553.3990253904021, 7.087230272716097, 35.08417280697312, 216.36864182868828, 123.10227404942677, 17.26705440478469, 1.2319083109308597, 25.171720137722225, 350.62026980105765, 143.82079449571447, 112.97555134878463, 452.60230405829145, 151.2772747928718, 82.48303781173922, 40.51647641999319, 98.96536289976007, 48.10856028358935, 329.1485446363947, 221.92353646241614, 503.5931457283291, 86.45774502485857, 17.6672302988579, 91.23543458629348, 3.321979830875562, 160.74746063711152, 351.1330096643864, 84.3687178363212, 253.04295376370885, 31.8299727497766, 66.16739047059862, 436.7713856935802, 83.0462718299145, 66.84215693530486, 422.2297167506739, 154.1294837604433, 69.4868347902476, 15.422118316326866, 359.39761371821675, 14.953347357612122, 214.25250210990308, 151.79665399228338, 233.54258398811638, 42.15680556145023, 21.574943437222775, 54.75232631618611, 309.3741434114924, 3.118482883890715, 21.405126328935552, 148.76053201051053, 421.3499358934771, 498.2794098008114, 323.0939805469931, 414.471573756896, 468.8964705754552, 128.95454216876442, 61.651161493525244, 73.6262818766958, 30.429268005337, 56.84206352359506, 174.3563394545271, 284.00314994812715, 84.2935472099278, 46.58682499091692, 363.7191428147859, 206.9671404897254, 173.03535887246585, 44.7418046619993, 64.53851063923383, 401.18291042856833, 119.20194473095606, 344.1229536525527, 158.6718989407614, 172.64475690825526, 284.14909293917907, 351.69348540184694, 310.5259251670276, 373.2034763994091, 182.83516915707386, 200.49800099076342, 287.81098437936396, 453.4042551951494, 246.06333551807955, 432.76836234276124, 365.41245537307753, 357.4130873546303, 0.0, 224.95473892775863, 370.7409403314502, 156.9969368147428, 22.405442481992306, 290.8429369777999, 206.61488314373707, 443.27609616309, 214.19749478233592, 328.15702651890575, 106.3700953653779, 107.31505293085209, 79.1925291081338, 237.242917548687, 174.25434138487333, 112.77069449697987, 170.0709926655483, 286.8889988452938, 55.85509200345194, 103.12451116825986, 45.66200156010063, 146.86743034685102, 271.57290052257264, 235.8738441230308, 96.29399494641339, 308.4110124561811]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5986449447409676, "mean_inference_ms": 1.343109926846531, "mean_action_processing_ms": 0.23898676826173423, "mean_env_wait_ms": 0.17219218294153785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059161466710707725, "StateBufferConnector_ms": 0.0029343717238482308, "ViewRequirementAgentConnector_ms": 0.08365028044756721}, "num_episodes": 13, "episode_return_max": 719.8286879847938, "episode_return_min": -25.452902693287154, "episode_return_mean": 341.67097557210144, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.0893409894128, "num_env_steps_trained_throughput_per_sec": 77.0893409894128, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 48858.245, "restore_workers_time_ms": 0.014, "training_step_time_ms": 48858.205, "sample_time_ms": 1043.935, "learn_time_ms": 47799.202, "learn_throughput": 83.683, "synch_weights_time_ms": 13.556}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "929db_00000", "date": "2024-08-22_10-38-54", "timestamp": 1724303334, "time_this_iter_s": 51.91674304008484, "time_total_s": 439.9200704097748, "pid": 93290, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158000ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 439.9200704097748, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 30.26891891891892, "ram_util_percent": 81.93648648648647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.097898790949867, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.120196887172719, "policy_loss": -0.023438474743149033, "vf_loss": 7.141356348108363, "vf_explained_var": 0.27224735176121745, "kl": 0.011395071426193767, "entropy": 1.4561885829325076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.800067404590586, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.373947369863116, "policy_loss": -0.022455406736301642, "vf_loss": 4.394438259689896, "vf_explained_var": 0.10486134618678421, "kl": 0.009822493220800473, "entropy": 1.4279241433219305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 719.8286879847938, "episode_reward_min": -25.452902693287154, "episode_reward_mean": 341.76823286816057, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 39600, "policy_reward_min": {"prey_policy": -539.6990253904004, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 356.6371322568426, "predator_policy": 553.3990253904021}, "policy_reward_mean": {"prey_policy": -8.226456999435268, "predator_policy": 179.11057343351547}, "custom_metrics": {}, "hist_stats": {"episode_reward": [219.99999999999915, 287.10000000000014, 386.5000000000049, 226.76414965389438, 262.6036949223957, 237.95895638012294, 96.4018962241271, 395.7954576750752, 59.20000000000057, 197.09999999999937, 446.10000000000093, 152.79999999999976, 487.5378891979823, 204.69999999999737, 313.2000000000002, 459.60000000000514, 206.89477754123607, 134.4999999999993, 399.81619550799303, 373.5000000000001, 219.84143054987783, 468.43734992528516, 237.59999999999877, -25.452902693287154, 390.10000000000224, 19.31112768004821, 311.90000000000015, 391.20000000000226, 518.0999999999997, 194.19999999999956, 398.3000000000021, 339.03104346299955, 387.70000000000226, 212.99999999999903, 350.20000000000175, 355.93132435943375, 344.94634695151274, 719.8286879847938, 492.10000000000014, 296.2000000000005, 647.2000000000007, 344.7000000000007, 445.6000000000006, 428.60000000000014, 447.2975065680748, 527.5023049483383, 262.6999999999989, 671.1000000000007, 475.1000000000007, 383.50100488341934, 450.5806387950462, 678.3905660504971, 334.3999999999994, 646.4989150865974, 211.59249172698216, 84.95679904959515, 194.9999999999987, 623.400000000001, 404.08564510026997, 406.09078069862454, 360.0191172744544, 411.5664291466219, 633.1149047933951, 237.96601601899513, 405.65831392767745, 382.40344366163276, 193.2688026399267, 110.76083903113185, 297.4220985444541, 322.0320850121774, 226.5610716515814, 188.2443227541082, 595.0806460086095, 312.2793485711627, 338.54770648570405, 261.1257801657002, 268.9862784603651, 419.6889762371507, 270.94324859615836, 330.7053151621917, 319.5488681046035, 161.05821402937465, 473.82484715234585, 246.07782972283042, 436.3043422453104, 118.92016594565641, 354.10000000000093, 416.8835244735091, 511.8999999999995, 164.6964025323973, 592.6951249617964, 355.82531458131876, 353.52385659452995, 406.30400443469426, 375.2000000000012, 239.1114516514291, 388.62431690836524, 212.66939143139723, 302.5685768041902], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-101.75168193461471, -396.7049953148832, -106.73912491431616, 125.37145804732721, 28.238923083808324, 182.52203126128344, -10.492567368115933, -175.88572052878953, -188.01696314816022, 9.241924479539179, -54.830268043593954, 190.0605596731327, -161.20014751524974, -237.4773764636852, -397.85042468127494, 216.3710590814682, -7.10802311743902, -366.75381409278043, -191.6111026540542, -132.2416802611736, 311.53626419317993, -189.4022743663046, 7.7706410387299325, 7.010307702756553, 142.83101552998428, 217.75313834384465, 28.778670445999172, -46.811372943251115, 130.38955500644644, -108.05164722950218, 97.40472125400217, 200.19999999999874, -208.74165583553201, 39.87346266416984, -120.51621470573077, -46.39915118223451, 159.79678112596562, -171.90541760438612, 143.4782323473115, 59.555640919031, -22.49870272916675, -138.97426599809836, 225.49555880899158, 132.71507479208077, 175.98958164530066, -199.53280058175642, -303.5232634583872, -454.8343960155999, -141.26145244989905, 341.8494371104173, -51.99248725326952, -359.34034187216884, -17.85102582911457, 258.494687527043, -152.60824626806243, 329.56022980198367, -72.96948868181826, 330.2721806952115, -113.422264532202, -539.6990253904004, 32.21276972728408, 323.9158271930269, -118.39874667152576, 117.9588742564073, 29.97959420166357, 339.2214430826214, 12.728279862277827, -175.5202698010575, -110.22079449571471, 203.6244486512157, 45.56197858179711, -293.5102330735272, 170.5286883240416, 51.418144395739034, 216.11763254460152, 356.6371322568426, -96.23269169730384, 37.260610598492406, -487.09314572832614, 193.24225497514095, 333.6143942246203, 204.6829408902285, -30.211294125476023, 210.84185365748897, 14.850310776191781, -4.752038276900273, -90.4429537637092, 234.1700272502234, 162.03431855832952, -217.6755881544341, 28.692282649269963, 348.9215935338498, -399.92971675066894, 86.27051623955649, 249.8131652097523, 336.3778816836732, -255.49761371821575, 356.24665264238797, 73.34784607608609, -55.89599729485533, 202.19942623517835, -27.3181769896988, 281.9730810850971, 320.0902152119901, -7.2800935373470566, 29.187467241963944, 140.37242938953747, 335.9608273576132, -286.86937038095857, -421.16748358634766, -269.1186781917936, -383.4900770624981, -347.59647057545504, -55.25454216876611, 284.0488385064749, 204.07371812330376, 51.50356786822174, 265.31074570311625, -167.77432621315435, 115.50561750912253, 229.71872142123706, -0.5799763476286844, 184.38026891214992, -343.5001230700401, 221.4505917548493, 193.88714950407993, 11.434832288496766, -239.19023733730367, -2.466945337582553, -55.19963911824961, 203.17853813640193, -152.0917503237869, -422.510064874694, -20.063710826401902, -269.499671122226, -303.46889141307884, 50.3478745090699, -136.25894611245377, -30.472421226997163, -388.7107333353383, -155.0825587502004, -297.18806745905937, -247.4012543687817, -287.1799656048144, 101.02405974788823, 269.1018473329621, -102.86535826340734, -112.59317031162384, 14.796755052228441, 10.502571973679917, -116.01796214573626, -272.7472369953875, -196.61744904516112, -76.7507937957145, 131.67353755661608, 74.33029038430422, 33.78962250602179, -79.28182056668243, 217.3, -173.6197207196628, 16.457793928150082, -153.86891733438915, -35.93826217451389, 38.01687303217978, 153.4480680473634, 127.84734719803049, -226.1747678761059, -35.1941470466673, 82.05273390075263, -50.453399058038734, -16.16004474664787, -123.57120143622915, -3.1197979379901972, 174.90135159670112, -73.33490894306541, 282.43555147145344, 287.9486239007326, 172.6218293693081, -400.66054306745053, -270.49620702887336, 266.46185951807, -98.72691705840177, 155.01273845189613, 47.32556874772475, 178.03883422387474, -184.7385117064464, -37.67147072929674, 68.96728683745653, 289.65865626056404, 17.61078942099192, -70.69899940950654, -316.1758316031524, 281.1053247795234, 9.345025561290162, -56.08526262907836, -335.2675369806141, -148.85959390149267, 90.73454029505564], "policy_predator_policy_reward": [265.5516819346144, 452.904995314885, 166.85349459463632, 101.61417227235157, 168.88239261995787, 6.8566530349489225, 181.75127513363338, 231.39116241716715, 347.4112661051959, 93.96746748582031, 80.61048225946473, 22.118182491121512, 281.6240311538119, 213.45538904924928, 277.4949416617994, 299.7798816130842, 43.80802311743938, 389.25381409278526, 341.41110265405416, 179.5416802611739, 23.36373580681976, 300.60227436630515, 115.81142959234015, 22.207621666173356, 93.50019784418805, 33.45353747995913, 115.14757425716877, 107.5851282400827, 104.1554523138488, 186.70663990920602, 160.19175445169247, 1.803524294305085, 167.65062648127002, 208.1123442313313, 213.940840837229, 87.47452505073464, 405.46405267580855, 6.4607793106039955, 75.82447140427426, 94.64165532938163, 260.603070299261, 120.7113289778805, 95.04959237551243, 15.177123948698405, 35.71041835469896, 225.4328005817563, 306.787023234326, 426.11773354637603, 178.16145244989764, 11.350562889583115, 426.54274523322266, 4.101211572264278, 71.25633830207205, 0.0, 182.13139002106936, 32.116626445008585, 258.7694886818177, 2.027819304788498, 293.9222645322022, 553.3990253904021, 7.087230272716097, 35.08417280697312, 216.36864182868828, 123.10227404942677, 17.26705440478469, 1.2319083109308597, 25.171720137722225, 350.62026980105765, 143.82079449571447, 112.97555134878463, 452.60230405829145, 151.2772747928718, 82.48303781173922, 40.51647641999319, 98.96536289976007, 48.10856028358935, 329.1485446363947, 221.92353646241614, 503.5931457283291, 86.45774502485857, 17.6672302988579, 91.23543458629348, 3.321979830875562, 160.74746063711152, 351.1330096643864, 84.3687178363212, 253.04295376370885, 31.8299727497766, 66.16739047059862, 436.7713856935802, 83.0462718299145, 66.84215693530486, 422.2297167506739, 154.1294837604433, 69.4868347902476, 15.422118316326866, 359.39761371821675, 14.953347357612122, 214.25250210990308, 151.79665399228338, 233.54258398811638, 42.15680556145023, 21.574943437222775, 54.75232631618611, 309.3741434114924, 3.118482883890715, 21.405126328935552, 148.76053201051053, 421.3499358934771, 498.2794098008114, 323.0939805469931, 414.471573756896, 468.8964705754552, 128.95454216876442, 61.651161493525244, 73.6262818766958, 30.429268005337, 56.84206352359506, 174.3563394545271, 284.00314994812715, 84.2935472099278, 46.58682499091692, 363.7191428147859, 206.9671404897254, 173.03535887246585, 44.7418046619993, 64.53851063923383, 401.18291042856833, 119.20194473095606, 344.1229536525527, 158.6718989407614, 172.64475690825526, 284.14909293917907, 351.69348540184694, 310.5259251670276, 373.2034763994091, 182.83516915707386, 200.49800099076342, 287.81098437936396, 453.4042551951494, 246.06333551807955, 432.76836234276124, 365.41245537307753, 357.4130873546303, 0.0, 224.95473892775863, 370.7409403314502, 156.9969368147428, 22.405442481992306, 290.8429369777999, 206.61488314373707, 443.27609616309, 214.19749478233592, 328.15702651890575, 106.3700953653779, 107.31505293085209, 79.1925291081338, 237.242917548687, 174.25434138487333, 112.77069449697987, 170.0709926655483, 286.8889988452938, 55.85509200345194, 103.12451116825986, 45.66200156010063, 146.86743034685102, 271.57290052257264, 235.8738441230308, 96.29399494641339, 308.4110124561811, 89.44304664600712, 169.20836548252768, 39.91979793799038, 142.39864840329875, 127.65499951285105, 80.12788243226584, 0.0, 51.32954672995891, 371.44193159248897, 464.4112210362357, 79.34819952066768, 345.6119829814607, 38.70485446703994, 114.7821529146573, 66.69218102159445, 293.5313530555043, 169.62093914543775, 205.38724918109693, 46.841343739435885, 21.089210579008093, 177.63913944968863, 448.34714321440094, 48.27722143338482, 49.89674513416541, 316.55151933331734, 287.47067170777274, 190.95331960149596, 169.74031080912977]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5930504319411677, "mean_inference_ms": 1.3303246482167284, "mean_action_processing_ms": 0.2374908819047127, "mean_env_wait_ms": 0.17094677981532178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006087861879907473, "StateBufferConnector_ms": 0.0032138342809195472, "ViewRequirementAgentConnector_ms": 0.09349512331413501}, "num_episodes": 14, "episode_return_max": 719.8286879847938, "episode_return_min": -25.452902693287154, "episode_return_mean": 341.76823286816057, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.80828229481972, "num_env_steps_trained_throughput_per_sec": 78.80828229481972, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 49048.03, "restore_workers_time_ms": 0.013, "training_step_time_ms": 49047.99, "sample_time_ms": 1045.047, "learn_time_ms": 47987.808, "learn_throughput": 83.355, "synch_weights_time_ms": 13.674}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "929db_00000", "date": "2024-08-22_10-39-44", "timestamp": 1724303384, "time_this_iter_s": 50.78465390205383, "time_total_s": 490.7047243118286, "pid": 93290, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28e01f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 490.7047243118286, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 26.313888888888886, "ram_util_percent": 80.88194444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.852658692932634, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.411836051184034, "policy_loss": -0.02340942432687534, "vf_loss": 7.433280324179028, "vf_explained_var": 0.13424685329356523, "kl": 0.009825747665228786, "entropy": 1.4534377709267632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.356404376345337, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.780680174928493, "policy_loss": -0.02494086542378658, "vf_loss": 4.803332237844114, "vf_explained_var": 0.08440627998145168, "kl": 0.011443975316335184, "entropy": 1.407113876607683, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 719.8286879847938, "episode_reward_min": -25.452902693287154, "episode_reward_mean": 347.4783220295638, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -539.6990253904004, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 356.6371322568426, "predator_policy": 553.3990253904021}, "policy_reward_mean": {"prey_policy": -1.879164392570833, "predator_policy": 175.61832540735267}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.20000000000057, 197.09999999999937, 446.10000000000093, 152.79999999999976, 487.5378891979823, 204.69999999999737, 313.2000000000002, 459.60000000000514, 206.89477754123607, 134.4999999999993, 399.81619550799303, 373.5000000000001, 219.84143054987783, 468.43734992528516, 237.59999999999877, -25.452902693287154, 390.10000000000224, 19.31112768004821, 311.90000000000015, 391.20000000000226, 518.0999999999997, 194.19999999999956, 398.3000000000021, 339.03104346299955, 387.70000000000226, 212.99999999999903, 350.20000000000175, 355.93132435943375, 344.94634695151274, 719.8286879847938, 492.10000000000014, 296.2000000000005, 647.2000000000007, 344.7000000000007, 445.6000000000006, 428.60000000000014, 447.2975065680748, 527.5023049483383, 262.6999999999989, 671.1000000000007, 475.1000000000007, 383.50100488341934, 450.5806387950462, 678.3905660504971, 334.3999999999994, 646.4989150865974, 211.59249172698216, 84.95679904959515, 194.9999999999987, 623.400000000001, 404.08564510026997, 406.09078069862454, 360.0191172744544, 411.5664291466219, 633.1149047933951, 237.96601601899513, 405.65831392767745, 382.40344366163276, 193.2688026399267, 110.76083903113185, 297.4220985444541, 322.0320850121774, 226.5610716515814, 188.2443227541082, 595.0806460086095, 312.2793485711627, 338.54770648570405, 261.1257801657002, 268.9862784603651, 419.6889762371507, 270.94324859615836, 330.7053151621917, 319.5488681046035, 161.05821402937465, 473.82484715234585, 246.07782972283042, 436.3043422453104, 118.92016594565641, 354.10000000000093, 416.8835244735091, 511.8999999999995, 164.6964025323973, 592.6951249617964, 355.82531458131876, 353.52385659452995, 406.30400443469426, 375.2000000000012, 239.1114516514291, 388.62431690836524, 212.66939143139723, 302.5685768041902, 564.2571544937098, 442.1310805226093, 426.90699731635345, 224.53121104132651, 82.09999999999984, 377.4041437880111, 403.57920621198485, 423.5634999160338, 81.42801057407766], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-7.10802311743902, -366.75381409278043, -191.6111026540542, -132.2416802611736, 311.53626419317993, -189.4022743663046, 7.7706410387299325, 7.010307702756553, 142.83101552998428, 217.75313834384465, 28.778670445999172, -46.811372943251115, 130.38955500644644, -108.05164722950218, 97.40472125400217, 200.19999999999874, -208.74165583553201, 39.87346266416984, -120.51621470573077, -46.39915118223451, 159.79678112596562, -171.90541760438612, 143.4782323473115, 59.555640919031, -22.49870272916675, -138.97426599809836, 225.49555880899158, 132.71507479208077, 175.98958164530066, -199.53280058175642, -303.5232634583872, -454.8343960155999, -141.26145244989905, 341.8494371104173, -51.99248725326952, -359.34034187216884, -17.85102582911457, 258.494687527043, -152.60824626806243, 329.56022980198367, -72.96948868181826, 330.2721806952115, -113.422264532202, -539.6990253904004, 32.21276972728408, 323.9158271930269, -118.39874667152576, 117.9588742564073, 29.97959420166357, 339.2214430826214, 12.728279862277827, -175.5202698010575, -110.22079449571471, 203.6244486512157, 45.56197858179711, -293.5102330735272, 170.5286883240416, 51.418144395739034, 216.11763254460152, 356.6371322568426, -96.23269169730384, 37.260610598492406, -487.09314572832614, 193.24225497514095, 333.6143942246203, 204.6829408902285, -30.211294125476023, 210.84185365748897, 14.850310776191781, -4.752038276900273, -90.4429537637092, 234.1700272502234, 162.03431855832952, -217.6755881544341, 28.692282649269963, 348.9215935338498, -399.92971675066894, 86.27051623955649, 249.8131652097523, 336.3778816836732, -255.49761371821575, 356.24665264238797, 73.34784607608609, -55.89599729485533, 202.19942623517835, -27.3181769896988, 281.9730810850971, 320.0902152119901, -7.2800935373470566, 29.187467241963944, 140.37242938953747, 335.9608273576132, -286.86937038095857, -421.16748358634766, -269.1186781917936, -383.4900770624981, -347.59647057545504, -55.25454216876611, 284.0488385064749, 204.07371812330376, 51.50356786822174, 265.31074570311625, -167.77432621315435, 115.50561750912253, 229.71872142123706, -0.5799763476286844, 184.38026891214992, -343.5001230700401, 221.4505917548493, 193.88714950407993, 11.434832288496766, -239.19023733730367, -2.466945337582553, -55.19963911824961, 203.17853813640193, -152.0917503237869, -422.510064874694, -20.063710826401902, -269.499671122226, -303.46889141307884, 50.3478745090699, -136.25894611245377, -30.472421226997163, -388.7107333353383, -155.0825587502004, -297.18806745905937, -247.4012543687817, -287.1799656048144, 101.02405974788823, 269.1018473329621, -102.86535826340734, -112.59317031162384, 14.796755052228441, 10.502571973679917, -116.01796214573626, -272.7472369953875, -196.61744904516112, -76.7507937957145, 131.67353755661608, 74.33029038430422, 33.78962250602179, -79.28182056668243, 217.3, -173.6197207196628, 16.457793928150082, -153.86891733438915, -35.93826217451389, 38.01687303217978, 153.4480680473634, 127.84734719803049, -226.1747678761059, -35.1941470466673, 82.05273390075263, -50.453399058038734, -16.16004474664787, -123.57120143622915, -3.1197979379901972, 174.90135159670112, -73.33490894306541, 282.43555147145344, 287.9486239007326, 172.6218293693081, -400.66054306745053, -270.49620702887336, 266.46185951807, -98.72691705840177, 155.01273845189613, 47.32556874772475, 178.03883422387474, -184.7385117064464, -37.67147072929674, 68.96728683745653, 289.65865626056404, 17.61078942099192, -70.69899940950654, -316.1758316031524, 281.1053247795234, 9.345025561290162, -56.08526262907836, -335.2675369806141, -148.85959390149267, 90.73454029505564, 112.2641090259763, 174.55894306519278, 218.09728207490986, -75.76517594952247, -14.194312679789526, 219.9820068959894, -299.78385521284616, 11.50566419080018, 22.388908192694718, 43.60000000000029, 213.3514554510347, -344.0689416364005, 27.449861903146697, -85.50072524706599, -86.9440090658537, 2.206198075914479, -3.420419452725155, 38.135303456434514], "policy_predator_policy_reward": [43.80802311743938, 389.25381409278526, 341.41110265405416, 179.5416802611739, 23.36373580681976, 300.60227436630515, 115.81142959234015, 22.207621666173356, 93.50019784418805, 33.45353747995913, 115.14757425716877, 107.5851282400827, 104.1554523138488, 186.70663990920602, 160.19175445169247, 1.803524294305085, 167.65062648127002, 208.1123442313313, 213.940840837229, 87.47452505073464, 405.46405267580855, 6.4607793106039955, 75.82447140427426, 94.64165532938163, 260.603070299261, 120.7113289778805, 95.04959237551243, 15.177123948698405, 35.71041835469896, 225.4328005817563, 306.787023234326, 426.11773354637603, 178.16145244989764, 11.350562889583115, 426.54274523322266, 4.101211572264278, 71.25633830207205, 0.0, 182.13139002106936, 32.116626445008585, 258.7694886818177, 2.027819304788498, 293.9222645322022, 553.3990253904021, 7.087230272716097, 35.08417280697312, 216.36864182868828, 123.10227404942677, 17.26705440478469, 1.2319083109308597, 25.171720137722225, 350.62026980105765, 143.82079449571447, 112.97555134878463, 452.60230405829145, 151.2772747928718, 82.48303781173922, 40.51647641999319, 98.96536289976007, 48.10856028358935, 329.1485446363947, 221.92353646241614, 503.5931457283291, 86.45774502485857, 17.6672302988579, 91.23543458629348, 3.321979830875562, 160.74746063711152, 351.1330096643864, 84.3687178363212, 253.04295376370885, 31.8299727497766, 66.16739047059862, 436.7713856935802, 83.0462718299145, 66.84215693530486, 422.2297167506739, 154.1294837604433, 69.4868347902476, 15.422118316326866, 359.39761371821675, 14.953347357612122, 214.25250210990308, 151.79665399228338, 233.54258398811638, 42.15680556145023, 21.574943437222775, 54.75232631618611, 309.3741434114924, 3.118482883890715, 21.405126328935552, 148.76053201051053, 421.3499358934771, 498.2794098008114, 323.0939805469931, 414.471573756896, 468.8964705754552, 128.95454216876442, 61.651161493525244, 73.6262818766958, 30.429268005337, 56.84206352359506, 174.3563394545271, 284.00314994812715, 84.2935472099278, 46.58682499091692, 363.7191428147859, 206.9671404897254, 173.03535887246585, 44.7418046619993, 64.53851063923383, 401.18291042856833, 119.20194473095606, 344.1229536525527, 158.6718989407614, 172.64475690825526, 284.14909293917907, 351.69348540184694, 310.5259251670276, 373.2034763994091, 182.83516915707386, 200.49800099076342, 287.81098437936396, 453.4042551951494, 246.06333551807955, 432.76836234276124, 365.41245537307753, 357.4130873546303, 0.0, 224.95473892775863, 370.7409403314502, 156.9969368147428, 22.405442481992306, 290.8429369777999, 206.61488314373707, 443.27609616309, 214.19749478233592, 328.15702651890575, 106.3700953653779, 107.31505293085209, 79.1925291081338, 237.242917548687, 174.25434138487333, 112.77069449697987, 170.0709926655483, 286.8889988452938, 55.85509200345194, 103.12451116825986, 45.66200156010063, 146.86743034685102, 271.57290052257264, 235.8738441230308, 96.29399494641339, 308.4110124561811, 89.44304664600712, 169.20836548252768, 39.91979793799038, 142.39864840329875, 127.65499951285105, 80.12788243226584, 0.0, 51.32954672995891, 371.44193159248897, 464.4112210362357, 79.34819952066768, 345.6119829814607, 38.70485446703994, 114.7821529146573, 66.69218102159445, 293.5313530555043, 169.62093914543775, 205.38724918109693, 46.841343739435885, 21.089210579008093, 177.63913944968863, 448.34714321440094, 48.27722143338482, 49.89674513416541, 316.55151933331734, 287.47067170777274, 190.95331960149596, 169.74031080912977, 216.19444755826126, 61.239654844279734, 152.67473467018, 147.12423972703715, 26.971175072698607, 194.14812802745612, 11.676020720983066, 501.1333813423902, 6.930663040094679, 9.180428767210659, 34.037207406273716, 474.08442256710316, 355.18830669672263, 106.44176285917908, 330.16840511293594, 178.13290579303677, 30.458576735605003, 16.2545498347642]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.57995720183889, "mean_inference_ms": 1.303139545538463, "mean_action_processing_ms": 0.23447937122886053, "mean_env_wait_ms": 0.16827150717788847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005931496620178223, "StateBufferConnector_ms": 0.003220200538635254, "ViewRequirementAgentConnector_ms": 0.09431827068328857}, "num_episodes": 9, "episode_return_max": 719.8286879847938, "episode_return_min": -25.452902693287154, "episode_return_mean": 347.4783220295638, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.07358621774704, "num_env_steps_trained_throughput_per_sec": 81.07358621774704, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 49090.788, "restore_workers_time_ms": 0.013, "training_step_time_ms": 49090.75, "sample_time_ms": 1030.197, "learn_time_ms": 48045.526, "learn_throughput": 83.254, "synch_weights_time_ms": 13.596}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "929db_00000", "date": "2024-08-22_10-40-34", "timestamp": 1724303434, "time_this_iter_s": 49.341614961624146, "time_total_s": 540.0463392734528, "pid": 93290, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b288b700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 540.0463392734528, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 20.61, "ram_util_percent": 80.35142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.35392024580133, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.704494132945147, "policy_loss": -0.026541010850040174, "vf_loss": 7.728983493835207, "vf_explained_var": 0.38132967081650226, "kl": 0.010258327183088018, "entropy": 1.459286559511114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.414563222410818, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.8525915916003877, "policy_loss": -0.022925098057313964, "vf_loss": 2.873598130102511, "vf_explained_var": 0.11258373724089729, "kl": 0.009592819202425386, "entropy": 1.4038904330087087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 719.8286879847938, "episode_reward_min": -25.452902693287154, "episode_reward_mean": 363.36533108940165, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -539.6990253904004, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 390.0096928506951, "predator_policy": 579.0145176980715}, "policy_reward_mean": {"prey_policy": 9.10153054622778, "predator_policy": 172.58113499847283}, "custom_metrics": {}, "hist_stats": {"episode_reward": [134.4999999999993, 399.81619550799303, 373.5000000000001, 219.84143054987783, 468.43734992528516, 237.59999999999877, -25.452902693287154, 390.10000000000224, 19.31112768004821, 311.90000000000015, 391.20000000000226, 518.0999999999997, 194.19999999999956, 398.3000000000021, 339.03104346299955, 387.70000000000226, 212.99999999999903, 350.20000000000175, 355.93132435943375, 344.94634695151274, 719.8286879847938, 492.10000000000014, 296.2000000000005, 647.2000000000007, 344.7000000000007, 445.6000000000006, 428.60000000000014, 447.2975065680748, 527.5023049483383, 262.6999999999989, 671.1000000000007, 475.1000000000007, 383.50100488341934, 450.5806387950462, 678.3905660504971, 334.3999999999994, 646.4989150865974, 211.59249172698216, 84.95679904959515, 194.9999999999987, 623.400000000001, 404.08564510026997, 406.09078069862454, 360.0191172744544, 411.5664291466219, 633.1149047933951, 237.96601601899513, 405.65831392767745, 382.40344366163276, 193.2688026399267, 110.76083903113185, 297.4220985444541, 322.0320850121774, 226.5610716515814, 188.2443227541082, 595.0806460086095, 312.2793485711627, 338.54770648570405, 261.1257801657002, 268.9862784603651, 419.6889762371507, 270.94324859615836, 330.7053151621917, 319.5488681046035, 161.05821402937465, 473.82484715234585, 246.07782972283042, 436.3043422453104, 118.92016594565641, 354.10000000000093, 416.8835244735091, 511.8999999999995, 164.6964025323973, 592.6951249617964, 355.82531458131876, 353.52385659452995, 406.30400443469426, 375.2000000000012, 239.1114516514291, 388.62431690836524, 212.66939143139723, 302.5685768041902, 564.2571544937098, 442.1310805226093, 426.90699731635345, 224.53121104132651, 82.09999999999984, 377.4041437880111, 403.57920621198485, 423.5634999160338, 81.42801057407766, 255.2066011714486, 337.98388347648404, 693.9999999999999, 252.81457613089165, 632.7, 401.1122106045432, 465.1156903816711, 473.3590050427199, 603.5416059152258], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-120.51621470573077, -46.39915118223451, 159.79678112596562, -171.90541760438612, 143.4782323473115, 59.555640919031, -22.49870272916675, -138.97426599809836, 225.49555880899158, 132.71507479208077, 175.98958164530066, -199.53280058175642, -303.5232634583872, -454.8343960155999, -141.26145244989905, 341.8494371104173, -51.99248725326952, -359.34034187216884, -17.85102582911457, 258.494687527043, -152.60824626806243, 329.56022980198367, -72.96948868181826, 330.2721806952115, -113.422264532202, -539.6990253904004, 32.21276972728408, 323.9158271930269, -118.39874667152576, 117.9588742564073, 29.97959420166357, 339.2214430826214, 12.728279862277827, -175.5202698010575, -110.22079449571471, 203.6244486512157, 45.56197858179711, -293.5102330735272, 170.5286883240416, 51.418144395739034, 216.11763254460152, 356.6371322568426, -96.23269169730384, 37.260610598492406, -487.09314572832614, 193.24225497514095, 333.6143942246203, 204.6829408902285, -30.211294125476023, 210.84185365748897, 14.850310776191781, -4.752038276900273, -90.4429537637092, 234.1700272502234, 162.03431855832952, -217.6755881544341, 28.692282649269963, 348.9215935338498, -399.92971675066894, 86.27051623955649, 249.8131652097523, 336.3778816836732, -255.49761371821575, 356.24665264238797, 73.34784607608609, -55.89599729485533, 202.19942623517835, -27.3181769896988, 281.9730810850971, 320.0902152119901, -7.2800935373470566, 29.187467241963944, 140.37242938953747, 335.9608273576132, -286.86937038095857, -421.16748358634766, -269.1186781917936, -383.4900770624981, -347.59647057545504, -55.25454216876611, 284.0488385064749, 204.07371812330376, 51.50356786822174, 265.31074570311625, -167.77432621315435, 115.50561750912253, 229.71872142123706, -0.5799763476286844, 184.38026891214992, -343.5001230700401, 221.4505917548493, 193.88714950407993, 11.434832288496766, -239.19023733730367, -2.466945337582553, -55.19963911824961, 203.17853813640193, -152.0917503237869, -422.510064874694, -20.063710826401902, -269.499671122226, -303.46889141307884, 50.3478745090699, -136.25894611245377, -30.472421226997163, -388.7107333353383, -155.0825587502004, -297.18806745905937, -247.4012543687817, -287.1799656048144, 101.02405974788823, 269.1018473329621, -102.86535826340734, -112.59317031162384, 14.796755052228441, 10.502571973679917, -116.01796214573626, -272.7472369953875, -196.61744904516112, -76.7507937957145, 131.67353755661608, 74.33029038430422, 33.78962250602179, -79.28182056668243, 217.3, -173.6197207196628, 16.457793928150082, -153.86891733438915, -35.93826217451389, 38.01687303217978, 153.4480680473634, 127.84734719803049, -226.1747678761059, -35.1941470466673, 82.05273390075263, -50.453399058038734, -16.16004474664787, -123.57120143622915, -3.1197979379901972, 174.90135159670112, -73.33490894306541, 282.43555147145344, 287.9486239007326, 172.6218293693081, -400.66054306745053, -270.49620702887336, 266.46185951807, -98.72691705840177, 155.01273845189613, 47.32556874772475, 178.03883422387474, -184.7385117064464, -37.67147072929674, 68.96728683745653, 289.65865626056404, 17.61078942099192, -70.69899940950654, -316.1758316031524, 281.1053247795234, 9.345025561290162, -56.08526262907836, -335.2675369806141, -148.85959390149267, 90.73454029505564, 112.2641090259763, 174.55894306519278, 218.09728207490986, -75.76517594952247, -14.194312679789526, 219.9820068959894, -299.78385521284616, 11.50566419080018, 22.388908192694718, 43.60000000000029, 213.3514554510347, -344.0689416364005, 27.449861903146697, -85.50072524706599, -86.9440090658537, 2.206198075914479, -3.420419452725155, 38.135303456434514, -1.6953296425810684, 198.7482783867294, 26.54752632226709, 241.2359559949665, 275.7329114300136, 289.38517011283557, -357.1626925795504, -79.48457875840319, 243.50579712997677, 104.63926745220436, -1.6104100471059333, 204.6943510376527, 152.98878832261866, 158.80000000000013, -31.002460556730952, 390.0096928506951, 44.73517974583612, 268.8977462373732], "policy_predator_policy_reward": [213.940840837229, 87.47452505073464, 405.46405267580855, 6.4607793106039955, 75.82447140427426, 94.64165532938163, 260.603070299261, 120.7113289778805, 95.04959237551243, 15.177123948698405, 35.71041835469896, 225.4328005817563, 306.787023234326, 426.11773354637603, 178.16145244989764, 11.350562889583115, 426.54274523322266, 4.101211572264278, 71.25633830207205, 0.0, 182.13139002106936, 32.116626445008585, 258.7694886818177, 2.027819304788498, 293.9222645322022, 553.3990253904021, 7.087230272716097, 35.08417280697312, 216.36864182868828, 123.10227404942677, 17.26705440478469, 1.2319083109308597, 25.171720137722225, 350.62026980105765, 143.82079449571447, 112.97555134878463, 452.60230405829145, 151.2772747928718, 82.48303781173922, 40.51647641999319, 98.96536289976007, 48.10856028358935, 329.1485446363947, 221.92353646241614, 503.5931457283291, 86.45774502485857, 17.6672302988579, 91.23543458629348, 3.321979830875562, 160.74746063711152, 351.1330096643864, 84.3687178363212, 253.04295376370885, 31.8299727497766, 66.16739047059862, 436.7713856935802, 83.0462718299145, 66.84215693530486, 422.2297167506739, 154.1294837604433, 69.4868347902476, 15.422118316326866, 359.39761371821675, 14.953347357612122, 214.25250210990308, 151.79665399228338, 233.54258398811638, 42.15680556145023, 21.574943437222775, 54.75232631618611, 309.3741434114924, 3.118482883890715, 21.405126328935552, 148.76053201051053, 421.3499358934771, 498.2794098008114, 323.0939805469931, 414.471573756896, 468.8964705754552, 128.95454216876442, 61.651161493525244, 73.6262818766958, 30.429268005337, 56.84206352359506, 174.3563394545271, 284.00314994812715, 84.2935472099278, 46.58682499091692, 363.7191428147859, 206.9671404897254, 173.03535887246585, 44.7418046619993, 64.53851063923383, 401.18291042856833, 119.20194473095606, 344.1229536525527, 158.6718989407614, 172.64475690825526, 284.14909293917907, 351.69348540184694, 310.5259251670276, 373.2034763994091, 182.83516915707386, 200.49800099076342, 287.81098437936396, 453.4042551951494, 246.06333551807955, 432.76836234276124, 365.41245537307753, 357.4130873546303, 0.0, 224.95473892775863, 370.7409403314502, 156.9969368147428, 22.405442481992306, 290.8429369777999, 206.61488314373707, 443.27609616309, 214.19749478233592, 328.15702651890575, 106.3700953653779, 107.31505293085209, 79.1925291081338, 237.242917548687, 174.25434138487333, 112.77069449697987, 170.0709926655483, 286.8889988452938, 55.85509200345194, 103.12451116825986, 45.66200156010063, 146.86743034685102, 271.57290052257264, 235.8738441230308, 96.29399494641339, 308.4110124561811, 89.44304664600712, 169.20836548252768, 39.91979793799038, 142.39864840329875, 127.65499951285105, 80.12788243226584, 0.0, 51.32954672995891, 371.44193159248897, 464.4112210362357, 79.34819952066768, 345.6119829814607, 38.70485446703994, 114.7821529146573, 66.69218102159445, 293.5313530555043, 169.62093914543775, 205.38724918109693, 46.841343739435885, 21.089210579008093, 177.63913944968863, 448.34714321440094, 48.27722143338482, 49.89674513416541, 316.55151933331734, 287.47067170777274, 190.95331960149596, 169.74031080912977, 216.19444755826126, 61.239654844279734, 152.67473467018, 147.12423972703715, 26.971175072698607, 194.14812802745612, 11.676020720983066, 501.1333813423902, 6.930663040094679, 9.180428767210659, 34.037207406273716, 474.08442256710316, 355.18830669672263, 106.44176285917908, 330.16840511293594, 178.13290579303677, 30.458576735605003, 16.2545498347642, 35.605704717809736, 22.547947709491467, 64.58954766568012, 5.610853493569735, 53.66708856998646, 75.21482988716431, 579.0145176980715, 110.44732977077318, 83.09420287002321, 201.4607325477957, 60.11041004710611, 137.91785956688827, 88.78019687177068, 64.5467051872824, 93.10246055673129, 21.249312192020955, 103.18754998880587, 186.72112994320963]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5714585979486777, "mean_inference_ms": 1.28777048764289, "mean_action_processing_ms": 0.23237916998183775, "mean_env_wait_ms": 0.16670915281656778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005796551704406738, "StateBufferConnector_ms": 0.003253936767578125, "ViewRequirementAgentConnector_ms": 0.09480416774749756}, "num_episodes": 9, "episode_return_max": 719.8286879847938, "episode_return_min": -25.452902693287154, "episode_return_mean": 363.36533108940165, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.55917265228051, "num_env_steps_trained_throughput_per_sec": 77.55917265228051, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 49496.477, "restore_workers_time_ms": 0.013, "training_step_time_ms": 49496.439, "sample_time_ms": 1024.661, "learn_time_ms": 48455.811, "learn_throughput": 82.549, "synch_weights_time_ms": 14.21}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "929db_00000", "date": "2024-08-22_10-41-25", "timestamp": 1724303485, "time_this_iter_s": 51.60621905326843, "time_total_s": 591.6525583267212, "pid": 93290, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28cb670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 591.6525583267212, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 23.883333333333333, "ram_util_percent": 81.31944444444444}}
