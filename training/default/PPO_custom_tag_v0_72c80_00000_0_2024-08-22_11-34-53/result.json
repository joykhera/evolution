{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7124975560834168, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.49537312139279, "policy_loss": -0.020128524349263262, "vf_loss": 7.5134663258910805, "vf_explained_var": 0.024515188087231268, "kl": 0.010176586834147138, "entropy": 1.6016465279160352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2037376799753734, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.129541979895698, "policy_loss": -0.016909256028799863, "vf_loss": 6.144680486658894, "vf_explained_var": 0.037008685472781064, "kl": 0.008853879112075205, "entropy": 1.6026721031577498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 68.07086681215178, "num_env_steps_trained_throughput_per_sec": 68.07086681215178, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 58762.311, "restore_workers_time_ms": 0.037, "training_step_time_ms": 58762.219, "sample_time_ms": 4449.179, "learn_time_ms": 54292.258, "learn_throughput": 73.675, "synch_weights_time_ms": 16.65}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "72c80_00000", "date": "2024-08-22_11-38-37", "timestamp": 1724306917, "time_this_iter_s": 58.803937911987305, "time_total_s": 58.803937911987305, "pid": 40806, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ec2ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 58.803937911987305, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 34.99294117647059, "ram_util_percent": 83.47294117647058}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8499956267220634, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.217969929730451, "policy_loss": -0.0268932259637892, "vf_loss": 6.242467251782695, "vf_explained_var": 0.09140688896809936, "kl": 0.011979441354531677, "entropy": 1.5838974034344708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4851675845958567, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.513139115439521, "policy_loss": -0.02746640943217451, "vf_loss": 4.53864372735301, "vf_explained_var": 0.08467204160791225, "kl": 0.009808949857830715, "entropy": 1.5893157093613237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.45434209375486, "num_env_steps_trained_throughput_per_sec": 71.45434209375486, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 57371.062, "restore_workers_time_ms": 0.025, "training_step_time_ms": 57370.983, "sample_time_ms": 3545.302, "learn_time_ms": 53808.118, "learn_throughput": 74.338, "synch_weights_time_ms": 14.286}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "72c80_00000", "date": "2024-08-22_11-39-36", "timestamp": 1724306976, "time_this_iter_s": 56.04410004615784, "time_total_s": 114.84803795814514, "pid": 40806, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327eda160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 114.84803795814514, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 31.03614457831325, "ram_util_percent": 83.09879518072287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.291429633280588, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.924105905603479, "policy_loss": -0.025556131848873245, "vf_loss": 5.947231544514812, "vf_explained_var": 0.15399915276381074, "kl": 0.012152402401684966, "entropy": 1.571751318911396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.987897390978677, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.182192622543012, "policy_loss": -0.021970315049427053, "vf_loss": 3.2023062784205036, "vf_explained_var": 0.1181555744201418, "kl": 0.009283288830531535, "entropy": 1.5809421351977757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 69.86577851943849, "num_env_steps_trained_throughput_per_sec": 69.86577851943849, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 57331.591, "restore_workers_time_ms": 0.022, "training_step_time_ms": 57331.504, "sample_time_ms": 3259.053, "learn_time_ms": 54054.594, "learn_throughput": 73.999, "synch_weights_time_ms": 13.961}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "72c80_00000", "date": "2024-08-22_11-40-33", "timestamp": 1724307033, "time_this_iter_s": 57.29243588447571, "time_total_s": 172.14047384262085, "pid": 40806, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33101aa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 172.14047384262085, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 35.70243902439025, "ram_util_percent": 83.24756097560973}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.939185200734113, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.656041677666719, "policy_loss": -0.023978614556681977, "vf_loss": 5.677448317108961, "vf_explained_var": 0.28191377589942285, "kl": 0.012859907833842077, "entropy": 1.56206092260502, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.575840271906878, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.6716127829576926, "policy_loss": -0.023674758755301357, "vf_loss": 2.6933782620404765, "vf_explained_var": 0.09356134180669431, "kl": 0.009546380682488677, "entropy": 1.5671070230070245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.61607251433318, "num_env_steps_trained_throughput_per_sec": 71.61607251433318, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 56962.041, "restore_workers_time_ms": 0.02, "training_step_time_ms": 56961.963, "sample_time_ms": 3060.639, "learn_time_ms": 53883.703, "learn_throughput": 74.234, "synch_weights_time_ms": 13.934}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "72c80_00000", "date": "2024-08-22_11-41-29", "timestamp": 1724307089, "time_this_iter_s": 55.90610599517822, "time_total_s": 228.04657983779907, "pid": 40806, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33101a940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 228.04657983779907, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 31.707594936708855, "ram_util_percent": 82.9354430379747}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.948073602574212, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.817361992881412, "policy_loss": -0.023925793348816494, "vf_loss": 5.838856802037153, "vf_explained_var": 0.24585902031767307, "kl": 0.012154934891110296, "entropy": 1.5509150880985159, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2324237661386923, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.343200686936656, "policy_loss": -0.025223366516548648, "vf_loss": 2.3663358039326137, "vf_explained_var": 0.08312985436626212, "kl": 0.010441244681853624, "entropy": 1.5511439319010134, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.54378983329195, "num_env_steps_trained_throughput_per_sec": 70.54378983329195, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 56910.108, "restore_workers_time_ms": 0.019, "training_step_time_ms": 56910.036, "sample_time_ms": 3138.792, "learn_time_ms": 53753.176, "learn_throughput": 74.414, "synch_weights_time_ms": 13.965}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "72c80_00000", "date": "2024-08-22_11-42-26", "timestamp": 1724307146, "time_this_iter_s": 56.74704599380493, "time_total_s": 284.793625831604, "pid": 40806, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310259d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 284.793625831604, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 33.772839506172836, "ram_util_percent": 83.11604938271607}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.345683300242853, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.145354691258183, "policy_loss": -0.02209719090239593, "vf_loss": 6.1650609117336375, "vf_explained_var": 0.32849811665595524, "kl": 0.011954881831210245, "entropy": 1.53531142851663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.456952812495055, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.5957850144653722, "policy_loss": -0.02126903047528926, "vf_loss": 2.615088010780395, "vf_explained_var": 0.15384489140182575, "kl": 0.009830175405959525, "entropy": 1.544363694531577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 69.70987205392846, "num_env_steps_trained_throughput_per_sec": 69.70987205392846, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 56988.538, "restore_workers_time_ms": 0.018, "training_step_time_ms": 56988.471, "sample_time_ms": 3323.661, "learn_time_ms": 53646.938, "learn_throughput": 74.562, "synch_weights_time_ms": 14.091}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "72c80_00000", "date": "2024-08-22_11-43-23", "timestamp": 1724307203, "time_this_iter_s": 57.43648600578308, "time_total_s": 342.2301118373871, "pid": 40806, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331025790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 342.2301118373871, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 31.47901234567901, "ram_util_percent": 83.31975308641977}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.732078444074701, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.64132862696572, "policy_loss": -0.025885426342578496, "vf_loss": 6.6648188800408095, "vf_explained_var": 0.2872985474962406, "kl": 0.011975882248952985, "entropy": 1.526928737050011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4104448494141693, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.889530265205121, "policy_loss": -0.019259692601386515, "vf_loss": 2.906714055020973, "vf_explained_var": 0.174096347415258, "kl": 0.010379508455412058, "entropy": 1.5206415918138292, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 705.1000000000004, "episode_reward_min": -25.436495175014322, "episode_reward_mean": 291.4344764814108, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 18800, "policy_reward_min": {"prey_policy": -544.1840425301488, "predator_policy": 2.026393602980987}, "policy_reward_max": {"prey_policy": 384.70000000000016, "predator_policy": 620.2143295752379}, "policy_reward_mean": {"prey_policy": -33.625389606102914, "predator_policy": 179.34262784680806}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.89999999999915, 132.99999999999977, 339.8559985745813, 198.82940395223198, 315.9104826835379, 354.6634947745424, 149.29999999999995, 181.59762999960202, 261.12202856174054, 420.9321661636556, 447.6016712427198, 72.10000000000018, 72.20000000000017, 168.59999999999883, 348.5000000000009, 282.1964196269459, 427.90000000000276, 183.31147243808513, 221.0263434675871, 376.7524836338964, 628.0146576844813, 278.42270821068536, 262.7999999999989, 265.6999999999998, 242.3000000000002, 282.78568322093383, 435.06100233873656, 310.6923994000433, 182.63497537737786, 462.7004852632656, 507.77219210515057, 293.4999999999999, 506.3000000000016, -25.436495175014322, 82.29999999999953, 559.3, 76.69999999999985, 79.79999999999956, 60.200000000000585, 387.08520437603374, 432.5082825546266, 430.475036191564, 167.39889702796017, 705.1000000000004, 397.800000000002, 320.12293933837, 199.08283159296056], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-92.71025174948903, 26.79645295829303, 46.22090541204518, -130.85447494174772, -224.72460024047706, 167.51371171127934, -11.965780805238895, -94.34486528492224, -247.87837655165728, -115.26352248137967, -24.02719702096968, -196.36395011269946, -45.04338837989806, -16.37151953287296, -188.40363537394234, -183.82325854502304, -255.38997573319597, 158.58213523916385, 40.44363729653152, -59.16136761967606, 22.798512965247248, -74.41957176361316, 37.03192278358345, -185.71817349121756, -101.39046355747996, 28.74227787112817, -15.656766095930834, -348.7139682123626, 6.603144870327926, 95.74182504386827, -112.86370059877359, 3.8023570185582827, -30.838570292651767, 384.4175847435904, -84.43414763303146, -544.1840425301488, -73.75325185057847, -229.56792665935637, 13.711561989350024, 80.69770729464975, 236.87925048690386, 109.99820331765012, -251.64487190456902, -61.8576537662866, 20.228868041122375, -93.57150034305373, 38.97283099424625, 99.7096877174799, -127.24624941990197, -2.7159884687117426, -248.15281926781716, 64.36782562211654, -35.246443552190435, 147.32430761222358, -41.741624680657374, 98.68722322400254, -144.71287296357778, 39.69769298267339, 83.47243388871198, -68.6349586580485, 166.27262985670498, 180.83006031587934, 90.36441059169934, -209.20052569148163, 247.90882105211722, 142.36291240128674, -288.4973231174214, -359.3192537759219, -161.77261498071678, 1.5533349271845205, 59.62906800440285, 256.3865488479336, -83.59585105739855, -158.29771229451342, -39.51917065754234, -354.91700287014754, -284.1086276237607, -101.6605324323446, -27.612370777945642, 111.1000000000002, 384.70000000000016, -70.40955059287897, 228.99999999999898, -26.10493527523512, -153.78275203629917, 3.6743047812401244, 260.01635325385007, 339.69206102747927, -277.9493542961264, 351.36794137919776, -327.41833456167825, -355.91999185134205, -12.022199637824698, 17.41270311633091], "policy_predator_policy_reward": [163.81025174948746, 113.00354704170634, 54.87909458795484, 162.7544749417459, 244.4637650098873, 152.60312209388908, 270.74683612087796, 34.3932139215154, 352.41318002482745, 326.63920169174605, 152.54050759976295, 422.51413430844855, 158.34338837989716, 52.371519532873464, 345.1436196878381, 208.68090423072817, 151.01215943506912, 206.91770962070382, 140.4897370371167, 299.16015944968325, 123.88199513269684, 375.34073490838836, 2.668077216416811, 218.11817349121577, 134.49046355747825, 10.35772212887197, 277.38517015730025, 255.58556415099346, 225.79165989609123, 20.36337018971066, 91.37721925401166, 299.8805439531487, 65.6385702926522, 8.68241525640958, 191.7153330260276, 620.2143295752379, 286.3306907281822, 238.01683124934004, 50.45051297824972, 231.89270137164522, 150.60852069211495, 130.5286831878125, 444.4687070090848, 147.45652687245664, 52.33111865963362, 283.81151364229635, 78.69388284528263, 48.32359844299144, 243.846249419901, 128.41598846871045, 275.05281926781674, 191.51785759881773, 218.40912734647083, 104.57401093223216, 93.11098526458207, 160.6358155921153, 213.90970162251963, 73.74045373576406, 182.1378979021354, 265.7251121304674, 60.79969840237196, 99.86980353019419, 70.03558940830071, 342.300525691481, 64.19117894788273, 51.837087598713296, 22.684734755088428, 599.6953469632417, 206.37261498071499, 36.14666507281565, 223.57093199559714, 19.7134511520664, 117.5958510573968, 200.997712294512, 79.31917065754203, 394.9170028701523, 313.0086276237669, 132.96053243234294, 131.88845559260147, 171.70911956137925, 53.4101216874128, 64.80771146008826, 5.680794257220378, 221.89917720957624, 144.53729760229643, 172.97004668071972, 103.36519211569009, 2.026393602980987, 300.24935429612873, 24.13205862080245, 409.6875328910395, 593.7737328603513, 112.67045851974505, 81.02186959470994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.189554553569142, "mean_inference_ms": 4.959546927901057, "mean_action_processing_ms": 1.9769345344418208, "mean_env_wait_ms": 8.709209740089108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006279793191463389, "StateBufferConnector_ms": 0.004681881437910364, "ViewRequirementAgentConnector_ms": 0.27531106421288026}, "num_episodes": 47, "episode_return_max": 705.1000000000004, "episode_return_min": -25.436495175014322, "episode_return_mean": 291.4344764814108, "episodes_this_iter": 47}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.99024754992334, "num_env_steps_trained_throughput_per_sec": 70.99024754992334, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 56896.715, "restore_workers_time_ms": 0.018, "training_step_time_ms": 56896.65, "sample_time_ms": 3226.765, "learn_time_ms": 53649.759, "learn_throughput": 74.558, "synch_weights_time_ms": 16.304}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "72c80_00000", "date": "2024-08-22_11-44-20", "timestamp": 1724307260, "time_this_iter_s": 56.40935397148132, "time_total_s": 398.6394658088684, "pid": 40806, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327edaee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 398.6394658088684, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 34.60875, "ram_util_percent": 82.9375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.121954511460803, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.210349334232391, "policy_loss": -0.0255563478936594, "vf_loss": 7.232580517208765, "vf_explained_var": 0.2978329722843473, "kl": 0.016625793999129976, "entropy": 1.4367342805105543, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.010518665288491, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.234563652674357, "policy_loss": -0.027106282226347103, "vf_loss": 5.258622055961972, "vf_explained_var": 0.1533767460830628, "kl": 0.015239298291425542, "entropy": 1.4349924120953474, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 705.1000000000004, "episode_reward_min": -25.436495175014322, "episode_reward_mean": 301.6251030202227, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -544.1840425301488, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.5311287004828, "predator_policy": 620.2143295752379}, "policy_reward_mean": {"prey_policy": -22.19160503056065, "predator_policy": 173.00415654067186}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.89999999999915, 132.99999999999977, 339.8559985745813, 198.82940395223198, 315.9104826835379, 354.6634947745424, 149.29999999999995, 181.59762999960202, 261.12202856174054, 420.9321661636556, 447.6016712427198, 72.10000000000018, 72.20000000000017, 168.59999999999883, 348.5000000000009, 282.1964196269459, 427.90000000000276, 183.31147243808513, 221.0263434675871, 376.7524836338964, 628.0146576844813, 278.42270821068536, 262.7999999999989, 265.6999999999998, 242.3000000000002, 282.78568322093383, 435.06100233873656, 310.6923994000433, 182.63497537737786, 462.7004852632656, 507.77219210515057, 293.4999999999999, 506.3000000000016, -25.436495175014322, 82.29999999999953, 559.3, 76.69999999999985, 79.79999999999956, 60.200000000000585, 387.08520437603374, 432.5082825546266, 430.475036191564, 167.39889702796017, 705.1000000000004, 397.800000000002, 320.12293933837, 199.08283159296056, 394.1999999999997, 234.21553890552005, 531.2999999999994, 324.75597962057583, 259.8999999999986, 247.79999999999905, 295.39999999999986, 505.6235875062276, 551.9000000000001, 278.99999999999966, 136.07594415933764, 488.67172848623363, 205.09999999999943, 301.1999999999995, 281.3999999999995, 214.6651650792328, 312.9000000000002, 316.4000000000002, 635.4999999999998, 73.67081240898051, 476.0102553231921, 371.0000000000015, 135.54981562025853, 153.44819572017684, 293.8999999999988], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-92.71025174948903, 26.79645295829303, 46.22090541204518, -130.85447494174772, -224.72460024047706, 167.51371171127934, -11.965780805238895, -94.34486528492224, -247.87837655165728, -115.26352248137967, -24.02719702096968, -196.36395011269946, -45.04338837989806, -16.37151953287296, -188.40363537394234, -183.82325854502304, -255.38997573319597, 158.58213523916385, 40.44363729653152, -59.16136761967606, 22.798512965247248, -74.41957176361316, 37.03192278358345, -185.71817349121756, -101.39046355747996, 28.74227787112817, -15.656766095930834, -348.7139682123626, 6.603144870327926, 95.74182504386827, -112.86370059877359, 3.8023570185582827, -30.838570292651767, 384.4175847435904, -84.43414763303146, -544.1840425301488, -73.75325185057847, -229.56792665935637, 13.711561989350024, 80.69770729464975, 236.87925048690386, 109.99820331765012, -251.64487190456902, -61.8576537662866, 20.228868041122375, -93.57150034305373, 38.97283099424625, 99.7096877174799, -127.24624941990197, -2.7159884687117426, -248.15281926781716, 64.36782562211654, -35.246443552190435, 147.32430761222358, -41.741624680657374, 98.68722322400254, -144.71287296357778, 39.69769298267339, 83.47243388871198, -68.6349586580485, 166.27262985670498, 180.83006031587934, 90.36441059169934, -209.20052569148163, 247.90882105211722, 142.36291240128674, -288.4973231174214, -359.3192537759219, -161.77261498071678, 1.5533349271845205, 59.62906800440285, 256.3865488479336, -83.59585105739855, -158.29771229451342, -39.51917065754234, -354.91700287014754, -284.1086276237607, -101.6605324323446, -27.612370777945642, 111.1000000000002, 384.70000000000016, -70.40955059287897, 228.99999999999898, -26.10493527523512, -153.78275203629917, 3.6743047812401244, 260.01635325385007, 339.69206102747927, -277.9493542961264, 351.36794137919776, -327.41833456167825, -355.91999185134205, -12.022199637824698, 17.41270311633091, 79.02766223464786, -328.3983869800388, -195.2694309775567, -212.78784492422213, 171.60876114182753, 264.2927702322013, 274.6563392712102, -129.34543244257227, 195.41213499500583, -72.88059218886184, -55.99657716876991, -137.7876540236384, 43.88567273869988, -49.88195128114987, -150.65070539737394, 229.44571334488808, -24.69030356213048, 261.79909894170225, -35.10712622060747, 44.251848940104374, -136.92844615372724, -150.27292039947, -3.184997504444887, -60.57917929896577, 40.82151129604488, 78.39015010487765, 207.67597070358258, -76.98299403538712, -8.209631843725674, 78.51017969496232, -24.190150145773252, 19.330526913705413, 38.67175415024607, -9.014003496731359, -111.85427989325385, 82.62921154469284, 395.5311287004828, 104.5537145031559, -395.4828728294752, -165.12502077046935, -82.15436221472395, 218.87968140544882, -67.14527002564151, 215.16942287449038, -300.12966238937037, -205.00922010307454, -42.063299401403015, -16.26969742304236, 10.93115846326957, 157.1130994732961], "policy_predator_policy_reward": [163.81025174948746, 113.00354704170634, 54.87909458795484, 162.7544749417459, 244.4637650098873, 152.60312209388908, 270.74683612087796, 34.3932139215154, 352.41318002482745, 326.63920169174605, 152.54050759976295, 422.51413430844855, 158.34338837989716, 52.371519532873464, 345.1436196878381, 208.68090423072817, 151.01215943506912, 206.91770962070382, 140.4897370371167, 299.16015944968325, 123.88199513269684, 375.34073490838836, 2.668077216416811, 218.11817349121577, 134.49046355747825, 10.35772212887197, 277.38517015730025, 255.58556415099346, 225.79165989609123, 20.36337018971066, 91.37721925401166, 299.8805439531487, 65.6385702926522, 8.68241525640958, 191.7153330260276, 620.2143295752379, 286.3306907281822, 238.01683124934004, 50.45051297824972, 231.89270137164522, 150.60852069211495, 130.5286831878125, 444.4687070090848, 147.45652687245664, 52.33111865963362, 283.81151364229635, 78.69388284528263, 48.32359844299144, 243.846249419901, 128.41598846871045, 275.05281926781674, 191.51785759881773, 218.40912734647083, 104.57401093223216, 93.11098526458207, 160.6358155921153, 213.90970162251963, 73.74045373576406, 182.1378979021354, 265.7251121304674, 60.79969840237196, 99.86980353019419, 70.03558940830071, 342.300525691481, 64.19117894788273, 51.837087598713296, 22.684734755088428, 599.6953469632417, 206.37261498071499, 36.14666507281565, 223.57093199559714, 19.7134511520664, 117.5958510573968, 200.997712294512, 79.31917065754203, 394.9170028701523, 313.0086276237669, 132.96053243234294, 131.88845559260147, 171.70911956137925, 53.4101216874128, 64.80771146008826, 5.680794257220378, 221.89917720957624, 144.53729760229643, 172.97004668071972, 103.36519211569009, 2.026393602980987, 300.24935429612873, 24.13205862080245, 409.6875328910395, 593.7737328603513, 112.67045851974505, 81.02186959470994, 198.4723377653521, 445.09838698003995, 115.93175295826225, 526.3410618490356, 81.49123885817241, 13.907229767798905, 39.975614768707736, 139.46945802322782, 23.997027457544267, 113.37142973631201, 89.89657716876938, 351.6876540236387, 147.81432726129987, 153.58195128114843, 108.26625398342493, 318.56232557528864, 283.94969157387857, 30.841513046549576, 118.46446352353337, 151.39081375696958, 351.77369964587155, 71.50361106666227, 240.915595292418, 311.5203099972264, 0.8784887039554344, 85.00984989512256, 160.2663564622663, 10.240666869538371, 199.95052831865485, 11.148923830108417, 129.03023280167403, 90.49455550962765, 236.72824584975385, 46.51400349673176, 289.6249361199407, 56.000132228619314, 0.0, 135.41515679636112, 242.09446848217044, 392.1842375267606, 117.97882084962764, 221.30611528283626, 101.44527002563956, 121.53057712550947, 472.1147947129396, 168.57390339976317, 46.62730269451606, 165.15388985010637, 124.05015753756774, 1.805584525866521]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.208496511656354, "mean_inference_ms": 4.983671095369312, "mean_action_processing_ms": 2.063273078269895, "mean_env_wait_ms": 8.88319993954163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063285231590271, "StateBufferConnector_ms": 0.00709990660349528, "ViewRequirementAgentConnector_ms": 0.3126293420791626}, "num_episodes": 25, "episode_return_max": 705.1000000000004, "episode_return_min": -25.436495175014322, "episode_return_mean": 301.6251030202227, "episodes_this_iter": 25}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.24243993496698, "num_env_steps_trained_throughput_per_sec": 70.24243993496698, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 56902.83, "restore_workers_time_ms": 0.018, "training_step_time_ms": 56902.767, "sample_time_ms": 3286.38, "learn_time_ms": 53596.783, "learn_throughput": 74.631, "synch_weights_time_ms": 16.05}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "72c80_00000", "date": "2024-08-22_11-45-17", "timestamp": 1724307317, "time_this_iter_s": 57.02091026306152, "time_total_s": 455.66037607192993, "pid": 40806, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16daece50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 455.66037607192993, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 32.312345679012346, "ram_util_percent": 82.99876543209876}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.774467399574461, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.910475358761177, "policy_loss": -0.023382422944195767, "vf_loss": 6.930985531478963, "vf_explained_var": 0.300775977574959, "kl": 0.014361274648684436, "entropy": 1.4485111911460835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999993}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.283119303839547, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.114060307936693, "policy_loss": -0.025743746418239816, "vf_loss": 4.136758061439272, "vf_explained_var": 0.1894013048795165, "kl": 0.015229979014546468, "entropy": 1.4399886613800412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999993}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 705.1000000000004, "episode_reward_min": -25.436495175014322, "episode_reward_mean": 301.6251030202227, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -544.1840425301488, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.5311287004828, "predator_policy": 620.2143295752379}, "policy_reward_mean": {"prey_policy": -22.19160503056065, "predator_policy": 173.00415654067186}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.89999999999915, 132.99999999999977, 339.8559985745813, 198.82940395223198, 315.9104826835379, 354.6634947745424, 149.29999999999995, 181.59762999960202, 261.12202856174054, 420.9321661636556, 447.6016712427198, 72.10000000000018, 72.20000000000017, 168.59999999999883, 348.5000000000009, 282.1964196269459, 427.90000000000276, 183.31147243808513, 221.0263434675871, 376.7524836338964, 628.0146576844813, 278.42270821068536, 262.7999999999989, 265.6999999999998, 242.3000000000002, 282.78568322093383, 435.06100233873656, 310.6923994000433, 182.63497537737786, 462.7004852632656, 507.77219210515057, 293.4999999999999, 506.3000000000016, -25.436495175014322, 82.29999999999953, 559.3, 76.69999999999985, 79.79999999999956, 60.200000000000585, 387.08520437603374, 432.5082825546266, 430.475036191564, 167.39889702796017, 705.1000000000004, 397.800000000002, 320.12293933837, 199.08283159296056, 394.1999999999997, 234.21553890552005, 531.2999999999994, 324.75597962057583, 259.8999999999986, 247.79999999999905, 295.39999999999986, 505.6235875062276, 551.9000000000001, 278.99999999999966, 136.07594415933764, 488.67172848623363, 205.09999999999943, 301.1999999999995, 281.3999999999995, 214.6651650792328, 312.9000000000002, 316.4000000000002, 635.4999999999998, 73.67081240898051, 476.0102553231921, 371.0000000000015, 135.54981562025853, 153.44819572017684, 293.8999999999988], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-92.71025174948903, 26.79645295829303, 46.22090541204518, -130.85447494174772, -224.72460024047706, 167.51371171127934, -11.965780805238895, -94.34486528492224, -247.87837655165728, -115.26352248137967, -24.02719702096968, -196.36395011269946, -45.04338837989806, -16.37151953287296, -188.40363537394234, -183.82325854502304, -255.38997573319597, 158.58213523916385, 40.44363729653152, -59.16136761967606, 22.798512965247248, -74.41957176361316, 37.03192278358345, -185.71817349121756, -101.39046355747996, 28.74227787112817, -15.656766095930834, -348.7139682123626, 6.603144870327926, 95.74182504386827, -112.86370059877359, 3.8023570185582827, -30.838570292651767, 384.4175847435904, -84.43414763303146, -544.1840425301488, -73.75325185057847, -229.56792665935637, 13.711561989350024, 80.69770729464975, 236.87925048690386, 109.99820331765012, -251.64487190456902, -61.8576537662866, 20.228868041122375, -93.57150034305373, 38.97283099424625, 99.7096877174799, -127.24624941990197, -2.7159884687117426, -248.15281926781716, 64.36782562211654, -35.246443552190435, 147.32430761222358, -41.741624680657374, 98.68722322400254, -144.71287296357778, 39.69769298267339, 83.47243388871198, -68.6349586580485, 166.27262985670498, 180.83006031587934, 90.36441059169934, -209.20052569148163, 247.90882105211722, 142.36291240128674, -288.4973231174214, -359.3192537759219, -161.77261498071678, 1.5533349271845205, 59.62906800440285, 256.3865488479336, -83.59585105739855, -158.29771229451342, -39.51917065754234, -354.91700287014754, -284.1086276237607, -101.6605324323446, -27.612370777945642, 111.1000000000002, 384.70000000000016, -70.40955059287897, 228.99999999999898, -26.10493527523512, -153.78275203629917, 3.6743047812401244, 260.01635325385007, 339.69206102747927, -277.9493542961264, 351.36794137919776, -327.41833456167825, -355.91999185134205, -12.022199637824698, 17.41270311633091, 79.02766223464786, -328.3983869800388, -195.2694309775567, -212.78784492422213, 171.60876114182753, 264.2927702322013, 274.6563392712102, -129.34543244257227, 195.41213499500583, -72.88059218886184, -55.99657716876991, -137.7876540236384, 43.88567273869988, -49.88195128114987, -150.65070539737394, 229.44571334488808, -24.69030356213048, 261.79909894170225, -35.10712622060747, 44.251848940104374, -136.92844615372724, -150.27292039947, -3.184997504444887, -60.57917929896577, 40.82151129604488, 78.39015010487765, 207.67597070358258, -76.98299403538712, -8.209631843725674, 78.51017969496232, -24.190150145773252, 19.330526913705413, 38.67175415024607, -9.014003496731359, -111.85427989325385, 82.62921154469284, 395.5311287004828, 104.5537145031559, -395.4828728294752, -165.12502077046935, -82.15436221472395, 218.87968140544882, -67.14527002564151, 215.16942287449038, -300.12966238937037, -205.00922010307454, -42.063299401403015, -16.26969742304236, 10.93115846326957, 157.1130994732961], "policy_predator_policy_reward": [163.81025174948746, 113.00354704170634, 54.87909458795484, 162.7544749417459, 244.4637650098873, 152.60312209388908, 270.74683612087796, 34.3932139215154, 352.41318002482745, 326.63920169174605, 152.54050759976295, 422.51413430844855, 158.34338837989716, 52.371519532873464, 345.1436196878381, 208.68090423072817, 151.01215943506912, 206.91770962070382, 140.4897370371167, 299.16015944968325, 123.88199513269684, 375.34073490838836, 2.668077216416811, 218.11817349121577, 134.49046355747825, 10.35772212887197, 277.38517015730025, 255.58556415099346, 225.79165989609123, 20.36337018971066, 91.37721925401166, 299.8805439531487, 65.6385702926522, 8.68241525640958, 191.7153330260276, 620.2143295752379, 286.3306907281822, 238.01683124934004, 50.45051297824972, 231.89270137164522, 150.60852069211495, 130.5286831878125, 444.4687070090848, 147.45652687245664, 52.33111865963362, 283.81151364229635, 78.69388284528263, 48.32359844299144, 243.846249419901, 128.41598846871045, 275.05281926781674, 191.51785759881773, 218.40912734647083, 104.57401093223216, 93.11098526458207, 160.6358155921153, 213.90970162251963, 73.74045373576406, 182.1378979021354, 265.7251121304674, 60.79969840237196, 99.86980353019419, 70.03558940830071, 342.300525691481, 64.19117894788273, 51.837087598713296, 22.684734755088428, 599.6953469632417, 206.37261498071499, 36.14666507281565, 223.57093199559714, 19.7134511520664, 117.5958510573968, 200.997712294512, 79.31917065754203, 394.9170028701523, 313.0086276237669, 132.96053243234294, 131.88845559260147, 171.70911956137925, 53.4101216874128, 64.80771146008826, 5.680794257220378, 221.89917720957624, 144.53729760229643, 172.97004668071972, 103.36519211569009, 2.026393602980987, 300.24935429612873, 24.13205862080245, 409.6875328910395, 593.7737328603513, 112.67045851974505, 81.02186959470994, 198.4723377653521, 445.09838698003995, 115.93175295826225, 526.3410618490356, 81.49123885817241, 13.907229767798905, 39.975614768707736, 139.46945802322782, 23.997027457544267, 113.37142973631201, 89.89657716876938, 351.6876540236387, 147.81432726129987, 153.58195128114843, 108.26625398342493, 318.56232557528864, 283.94969157387857, 30.841513046549576, 118.46446352353337, 151.39081375696958, 351.77369964587155, 71.50361106666227, 240.915595292418, 311.5203099972264, 0.8784887039554344, 85.00984989512256, 160.2663564622663, 10.240666869538371, 199.95052831865485, 11.148923830108417, 129.03023280167403, 90.49455550962765, 236.72824584975385, 46.51400349673176, 289.6249361199407, 56.000132228619314, 0.0, 135.41515679636112, 242.09446848217044, 392.1842375267606, 117.97882084962764, 221.30611528283626, 101.44527002563956, 121.53057712550947, 472.1147947129396, 168.57390339976317, 46.62730269451606, 165.15388985010637, 124.05015753756774, 1.805584525866521]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.208496511656354, "mean_inference_ms": 4.983671095369312, "mean_action_processing_ms": 2.063273078269895, "mean_env_wait_ms": 8.88319993954163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063285231590271, "StateBufferConnector_ms": 0.00709990660349528, "ViewRequirementAgentConnector_ms": 0.3126293420791626}, "num_episodes": 0, "episode_return_max": 705.1000000000004, "episode_return_min": -25.436495175014322, "episode_return_mean": 301.6251030202227, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.43406617183169, "num_env_steps_trained_throughput_per_sec": 72.43406617183169, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 56716.143, "restore_workers_time_ms": 0.017, "training_step_time_ms": 56716.08, "sample_time_ms": 3182.377, "learn_time_ms": 53514.117, "learn_throughput": 74.747, "synch_weights_time_ms": 15.866}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "72c80_00000", "date": "2024-08-22_11-46-12", "timestamp": 1724307372, "time_this_iter_s": 55.27456784248352, "time_total_s": 510.93494391441345, "pid": 40806, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x327ec2af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 510.93494391441345, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 33.41518987341771, "ram_util_percent": 83.22784810126582}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.106657563000129, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.17916682687386, "policy_loss": -0.023327800746213784, "vf_loss": 7.19995314961388, "vf_explained_var": 0.2783168446450006, "kl": 0.012707404253964938, "entropy": 1.48121250413713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.6524784546680555, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.9123071756312457, "policy_loss": -0.023805743087546297, "vf_loss": 3.9327882408465027, "vf_explained_var": 0.17420070997621648, "kl": 0.016623373465395715, "entropy": 1.452555650251883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 705.1000000000004, "episode_reward_min": -25.436495175014322, "episode_reward_mean": 301.6251030202227, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -544.1840425301488, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.5311287004828, "predator_policy": 620.2143295752379}, "policy_reward_mean": {"prey_policy": -22.19160503056065, "predator_policy": 173.00415654067186}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.89999999999915, 132.99999999999977, 339.8559985745813, 198.82940395223198, 315.9104826835379, 354.6634947745424, 149.29999999999995, 181.59762999960202, 261.12202856174054, 420.9321661636556, 447.6016712427198, 72.10000000000018, 72.20000000000017, 168.59999999999883, 348.5000000000009, 282.1964196269459, 427.90000000000276, 183.31147243808513, 221.0263434675871, 376.7524836338964, 628.0146576844813, 278.42270821068536, 262.7999999999989, 265.6999999999998, 242.3000000000002, 282.78568322093383, 435.06100233873656, 310.6923994000433, 182.63497537737786, 462.7004852632656, 507.77219210515057, 293.4999999999999, 506.3000000000016, -25.436495175014322, 82.29999999999953, 559.3, 76.69999999999985, 79.79999999999956, 60.200000000000585, 387.08520437603374, 432.5082825546266, 430.475036191564, 167.39889702796017, 705.1000000000004, 397.800000000002, 320.12293933837, 199.08283159296056, 394.1999999999997, 234.21553890552005, 531.2999999999994, 324.75597962057583, 259.8999999999986, 247.79999999999905, 295.39999999999986, 505.6235875062276, 551.9000000000001, 278.99999999999966, 136.07594415933764, 488.67172848623363, 205.09999999999943, 301.1999999999995, 281.3999999999995, 214.6651650792328, 312.9000000000002, 316.4000000000002, 635.4999999999998, 73.67081240898051, 476.0102553231921, 371.0000000000015, 135.54981562025853, 153.44819572017684, 293.8999999999988], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-92.71025174948903, 26.79645295829303, 46.22090541204518, -130.85447494174772, -224.72460024047706, 167.51371171127934, -11.965780805238895, -94.34486528492224, -247.87837655165728, -115.26352248137967, -24.02719702096968, -196.36395011269946, -45.04338837989806, -16.37151953287296, -188.40363537394234, -183.82325854502304, -255.38997573319597, 158.58213523916385, 40.44363729653152, -59.16136761967606, 22.798512965247248, -74.41957176361316, 37.03192278358345, -185.71817349121756, -101.39046355747996, 28.74227787112817, -15.656766095930834, -348.7139682123626, 6.603144870327926, 95.74182504386827, -112.86370059877359, 3.8023570185582827, -30.838570292651767, 384.4175847435904, -84.43414763303146, -544.1840425301488, -73.75325185057847, -229.56792665935637, 13.711561989350024, 80.69770729464975, 236.87925048690386, 109.99820331765012, -251.64487190456902, -61.8576537662866, 20.228868041122375, -93.57150034305373, 38.97283099424625, 99.7096877174799, -127.24624941990197, -2.7159884687117426, -248.15281926781716, 64.36782562211654, -35.246443552190435, 147.32430761222358, -41.741624680657374, 98.68722322400254, -144.71287296357778, 39.69769298267339, 83.47243388871198, -68.6349586580485, 166.27262985670498, 180.83006031587934, 90.36441059169934, -209.20052569148163, 247.90882105211722, 142.36291240128674, -288.4973231174214, -359.3192537759219, -161.77261498071678, 1.5533349271845205, 59.62906800440285, 256.3865488479336, -83.59585105739855, -158.29771229451342, -39.51917065754234, -354.91700287014754, -284.1086276237607, -101.6605324323446, -27.612370777945642, 111.1000000000002, 384.70000000000016, -70.40955059287897, 228.99999999999898, -26.10493527523512, -153.78275203629917, 3.6743047812401244, 260.01635325385007, 339.69206102747927, -277.9493542961264, 351.36794137919776, -327.41833456167825, -355.91999185134205, -12.022199637824698, 17.41270311633091, 79.02766223464786, -328.3983869800388, -195.2694309775567, -212.78784492422213, 171.60876114182753, 264.2927702322013, 274.6563392712102, -129.34543244257227, 195.41213499500583, -72.88059218886184, -55.99657716876991, -137.7876540236384, 43.88567273869988, -49.88195128114987, -150.65070539737394, 229.44571334488808, -24.69030356213048, 261.79909894170225, -35.10712622060747, 44.251848940104374, -136.92844615372724, -150.27292039947, -3.184997504444887, -60.57917929896577, 40.82151129604488, 78.39015010487765, 207.67597070358258, -76.98299403538712, -8.209631843725674, 78.51017969496232, -24.190150145773252, 19.330526913705413, 38.67175415024607, -9.014003496731359, -111.85427989325385, 82.62921154469284, 395.5311287004828, 104.5537145031559, -395.4828728294752, -165.12502077046935, -82.15436221472395, 218.87968140544882, -67.14527002564151, 215.16942287449038, -300.12966238937037, -205.00922010307454, -42.063299401403015, -16.26969742304236, 10.93115846326957, 157.1130994732961], "policy_predator_policy_reward": [163.81025174948746, 113.00354704170634, 54.87909458795484, 162.7544749417459, 244.4637650098873, 152.60312209388908, 270.74683612087796, 34.3932139215154, 352.41318002482745, 326.63920169174605, 152.54050759976295, 422.51413430844855, 158.34338837989716, 52.371519532873464, 345.1436196878381, 208.68090423072817, 151.01215943506912, 206.91770962070382, 140.4897370371167, 299.16015944968325, 123.88199513269684, 375.34073490838836, 2.668077216416811, 218.11817349121577, 134.49046355747825, 10.35772212887197, 277.38517015730025, 255.58556415099346, 225.79165989609123, 20.36337018971066, 91.37721925401166, 299.8805439531487, 65.6385702926522, 8.68241525640958, 191.7153330260276, 620.2143295752379, 286.3306907281822, 238.01683124934004, 50.45051297824972, 231.89270137164522, 150.60852069211495, 130.5286831878125, 444.4687070090848, 147.45652687245664, 52.33111865963362, 283.81151364229635, 78.69388284528263, 48.32359844299144, 243.846249419901, 128.41598846871045, 275.05281926781674, 191.51785759881773, 218.40912734647083, 104.57401093223216, 93.11098526458207, 160.6358155921153, 213.90970162251963, 73.74045373576406, 182.1378979021354, 265.7251121304674, 60.79969840237196, 99.86980353019419, 70.03558940830071, 342.300525691481, 64.19117894788273, 51.837087598713296, 22.684734755088428, 599.6953469632417, 206.37261498071499, 36.14666507281565, 223.57093199559714, 19.7134511520664, 117.5958510573968, 200.997712294512, 79.31917065754203, 394.9170028701523, 313.0086276237669, 132.96053243234294, 131.88845559260147, 171.70911956137925, 53.4101216874128, 64.80771146008826, 5.680794257220378, 221.89917720957624, 144.53729760229643, 172.97004668071972, 103.36519211569009, 2.026393602980987, 300.24935429612873, 24.13205862080245, 409.6875328910395, 593.7737328603513, 112.67045851974505, 81.02186959470994, 198.4723377653521, 445.09838698003995, 115.93175295826225, 526.3410618490356, 81.49123885817241, 13.907229767798905, 39.975614768707736, 139.46945802322782, 23.997027457544267, 113.37142973631201, 89.89657716876938, 351.6876540236387, 147.81432726129987, 153.58195128114843, 108.26625398342493, 318.56232557528864, 283.94969157387857, 30.841513046549576, 118.46446352353337, 151.39081375696958, 351.77369964587155, 71.50361106666227, 240.915595292418, 311.5203099972264, 0.8784887039554344, 85.00984989512256, 160.2663564622663, 10.240666869538371, 199.95052831865485, 11.148923830108417, 129.03023280167403, 90.49455550962765, 236.72824584975385, 46.51400349673176, 289.6249361199407, 56.000132228619314, 0.0, 135.41515679636112, 242.09446848217044, 392.1842375267606, 117.97882084962764, 221.30611528283626, 101.44527002563956, 121.53057712550947, 472.1147947129396, 168.57390339976317, 46.62730269451606, 165.15388985010637, 124.05015753756774, 1.805584525866521]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.208496511656354, "mean_inference_ms": 4.983671095369312, "mean_action_processing_ms": 2.063273078269895, "mean_env_wait_ms": 8.88319993954163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063285231590271, "StateBufferConnector_ms": 0.00709990660349528, "ViewRequirementAgentConnector_ms": 0.3126293420791626}, "num_episodes": 0, "episode_return_max": 705.1000000000004, "episode_return_min": -25.436495175014322, "episode_return_mean": 301.6251030202227, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.6725665084616, "num_env_steps_trained_throughput_per_sec": 71.6725665084616, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 56625.465, "restore_workers_time_ms": 0.017, "training_step_time_ms": 56625.404, "sample_time_ms": 3101.333, "learn_time_ms": 53504.646, "learn_throughput": 74.76, "synch_weights_time_ms": 15.844}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "72c80_00000", "date": "2024-08-22_11-47-08", "timestamp": 1724307428, "time_this_iter_s": 55.865265130996704, "time_total_s": 566.8002090454102, "pid": 40806, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 8000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33102c310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 566.8002090454102, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 29.65822784810126, "ram_util_percent": 83.34683544303796}}
