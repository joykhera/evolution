{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.17446710991441572, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3336493339488116, "policy_loss": -0.002200098313199031, "vf_loss": 3.335200211358449, "vf_explained_var": 0.00047652018133294646, "kl": 0.0032461304066554956, "entropy": 1.6062646802771028, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2919094013306435, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.978465605538989, "policy_loss": -0.0014728118436381458, "vf_loss": 6.979583079726607, "vf_explained_var": 0.004067353312931363, "kl": 0.0017767532924075338, "entropy": 1.607616117139342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 217.0, "episode_reward_min": -227.0, "episode_reward_mean": 18.333333333333332, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -265.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 148.0, "predator_policy": 167.0}, "policy_reward_mean": {"prey_policy": -18.75, "predator_policy": 27.916666666666668}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 55.0, 107.0, -43.0, 108.0, 43.0, -214.0, -6.0, -30.0, 175.0, -9.0, -47.0, -45.0, 217.0, -227.0, 120.0, 0.0, 83.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, 44.0, 5.0, 50.0, 59.0, -4.0, 0.0, -86.0, 116.0, -74.0, -211.0, 148.0, -190.0, -265.0, -20.0, 4.0, -36.0, -36.0, 45.0, 121.0, -193.0, 44.0, -8.0, -78.0, -8.0, -96.0, 114.0, 79.0, -149.0, -245.0, 120.0, 0.0, 0.0, 0.0, 23.0, 54.0], "policy_predator_policy_reward": [1.0, 0.0, 0.0, 0.0, 51.0, 1.0, 43.0, 0.0, 13.0, 53.0, 106.0, 0.0, 95.0, 146.0, 10.0, 0.0, 42.0, 0.0, 2.0, 7.0, 54.0, 86.0, 39.0, 0.0, 11.0, 48.0, 22.0, 2.0, 167.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3665477095098053, "mean_inference_ms": 3.8461766563563264, "mean_action_processing_ms": 0.531002870717098, "mean_env_wait_ms": 0.47620861385469304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015565421846177842, "StateBufferConnector_ms": 0.003825293646918403, "ViewRequirementAgentConnector_ms": 0.6828188896179199}, "num_episodes": 18, "episode_return_max": 217.0, "episode_return_min": -227.0, "episode_return_mean": 18.333333333333332, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.8839385428289, "num_env_steps_trained_throughput_per_sec": 312.8839385428289, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12784.306, "restore_workers_time_ms": 0.022, "training_step_time_ms": 12784.241, "sample_time_ms": 2903.659, "learn_time_ms": 9846.068, "learn_throughput": 406.254, "synch_weights_time_ms": 20.189}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "45bed_00000", "date": "2024-08-13_01-10-17", "timestamp": 1723525817, "time_this_iter_s": 12.837249994277954, "time_total_s": 12.837249994277954, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33069e8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.837249994277954, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 57.4421052631579, "ram_util_percent": 83.7421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3309595022133734, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.559438046198043, "policy_loss": -0.002106264011106557, "vf_loss": 4.56103661363087, "vf_explained_var": -0.0032303670096018957, "kl": 0.005076955115203822, "entropy": 1.6028665173621404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6447912192573307, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.998791254638995, "policy_loss": -0.0016156267138227583, "vf_loss": 6.000017889719161, "vf_explained_var": 0.0176593662885131, "kl": 0.003889888521069505, "entropy": 1.6067949819817113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 217.0, "episode_reward_min": -227.0, "episode_reward_mean": 13.833333333333334, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -306.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 148.0, "predator_policy": 167.0}, "policy_reward_mean": {"prey_policy": -26.055555555555557, "predator_policy": 32.97222222222222}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 55.0, 107.0, -43.0, 108.0, 43.0, -214.0, -6.0, -30.0, 175.0, -9.0, -47.0, -45.0, 217.0, -227.0, 120.0, 0.0, 83.0, 40.0, -35.0, -11.0, -67.0, 75.0, 48.0, -48.0, 7.0, -80.0, 127.0, 15.0, 77.0, -112.0, 114.0, 14.0, -140.0, 152.0, -8.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, 44.0, 5.0, 50.0, 59.0, -4.0, 0.0, -86.0, 116.0, -74.0, -211.0, 148.0, -190.0, -265.0, -20.0, 4.0, -36.0, -36.0, 45.0, 121.0, -193.0, 44.0, -8.0, -78.0, -8.0, -96.0, 114.0, 79.0, -149.0, -245.0, 120.0, 0.0, 0.0, 0.0, 23.0, 54.0, 0.0, 30.0, -72.0, 0.0, -81.0, -87.0, -18.0, -169.0, 10.0, 2.0, 19.0, -6.0, -28.0, -70.0, 1.0, 6.0, -160.0, 0.0, 92.0, 35.0, 0.0, -31.0, -78.0, 80.0, 0.0, -243.0, 116.0, -96.0, 145.0, -281.0, -306.0, 1.0, 18.0, 56.0, -130.0, 44.0], "policy_predator_policy_reward": [1.0, 0.0, 0.0, 0.0, 51.0, 1.0, 43.0, 0.0, 13.0, 53.0, 106.0, 0.0, 95.0, 146.0, 10.0, 0.0, 42.0, 0.0, 2.0, 7.0, 54.0, 86.0, 39.0, 0.0, 11.0, 48.0, 22.0, 2.0, 167.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 0.0, 37.0, 75.0, 82.0, 45.0, 75.0, 0.0, 63.0, 0.0, 35.0, 5.0, 45.0, 0.0, 0.0, 0.0, 80.0, 0.0, 0.0, 6.0, 40.0, 42.0, 33.0, 131.0, 0.0, 86.0, 8.0, 133.0, 17.0, 153.0, 12.0, 40.0, 38.0, 0.0, 78.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.176933633323622, "mean_inference_ms": 3.2750096971592733, "mean_action_processing_ms": 0.4619232598166192, "mean_env_wait_ms": 0.4132149250587772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010551677809821235, "StateBufferConnector_ms": 0.003366337882147895, "ViewRequirementAgentConnector_ms": 0.38327078024546307}, "num_episodes": 18, "episode_return_max": 217.0, "episode_return_min": -227.0, "episode_return_mean": 13.833333333333334, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 364.66588877205425, "num_env_steps_trained_throughput_per_sec": 364.66588877205425, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 11876.638, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11876.506, "sample_time_ms": 2064.516, "learn_time_ms": 9785.619, "learn_throughput": 408.763, "synch_weights_time_ms": 16.548}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "45bed_00000", "date": "2024-08-13_01-10-31", "timestamp": 1723525831, "time_this_iter_s": 11.000170946121216, "time_total_s": 23.83742094039917, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33069e820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.83742094039917, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 49.184210526315795, "ram_util_percent": 83.44210526315788}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.24577689083716855, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.108224839508218, "policy_loss": -0.0024624109121591403, "vf_loss": 3.1100344989665603, "vf_explained_var": 0.0027810218157591645, "kl": 0.00652763450320027, "entropy": 1.599281418954254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6890039247298051, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.771211833045596, "policy_loss": -0.0011970060717353902, "vf_loss": 5.772266335966726, "vf_explained_var": 0.016532502697889136, "kl": 0.0028497945944017736, "entropy": 1.6076314402635765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 217.0, "episode_reward_min": -227.0, "episode_reward_mean": 13.87037037037037, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -306.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 148.0, "predator_policy": 167.0}, "policy_reward_mean": {"prey_policy": -24.564814814814813, "predator_policy": 31.5}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 55.0, 107.0, -43.0, 108.0, 43.0, -214.0, -6.0, -30.0, 175.0, -9.0, -47.0, -45.0, 217.0, -227.0, 120.0, 0.0, 83.0, 40.0, -35.0, -11.0, -67.0, 75.0, 48.0, -48.0, 7.0, -80.0, 127.0, 15.0, 77.0, -112.0, 114.0, 14.0, -140.0, 152.0, -8.0, -46.0, -118.0, 8.0, 141.0, -24.0, -81.0, 170.0, -124.0, 35.0, -94.0, 45.0, -2.0, 120.0, -4.0, -38.0, 17.0, 175.0, 71.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, 44.0, 5.0, 50.0, 59.0, -4.0, 0.0, -86.0, 116.0, -74.0, -211.0, 148.0, -190.0, -265.0, -20.0, 4.0, -36.0, -36.0, 45.0, 121.0, -193.0, 44.0, -8.0, -78.0, -8.0, -96.0, 114.0, 79.0, -149.0, -245.0, 120.0, 0.0, 0.0, 0.0, 23.0, 54.0, 0.0, 30.0, -72.0, 0.0, -81.0, -87.0, -18.0, -169.0, 10.0, 2.0, 19.0, -6.0, -28.0, -70.0, 1.0, 6.0, -160.0, 0.0, 92.0, 35.0, 0.0, -31.0, -78.0, 80.0, 0.0, -243.0, 116.0, -96.0, 145.0, -281.0, -306.0, 1.0, 18.0, 56.0, -130.0, 44.0, -205.0, 41.0, -263.0, 13.0, -120.0, 68.0, 141.0, 0.0, -170.0, -18.0, -6.0, -158.0, 104.0, 46.0, -115.0, -75.0, 0.0, -29.0, -197.0, -23.0, 45.0, 0.0, -84.0, 15.0, 104.0, 16.0, 2.0, -15.0, -151.0, 37.0, 2.0, 15.0, -2.0, 134.0, 71.0, 0.0], "policy_predator_policy_reward": [1.0, 0.0, 0.0, 0.0, 51.0, 1.0, 43.0, 0.0, 13.0, 53.0, 106.0, 0.0, 95.0, 146.0, 10.0, 0.0, 42.0, 0.0, 2.0, 7.0, 54.0, 86.0, 39.0, 0.0, 11.0, 48.0, 22.0, 2.0, 167.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 0.0, 37.0, 75.0, 82.0, 45.0, 75.0, 0.0, 63.0, 0.0, 35.0, 5.0, 45.0, 0.0, 0.0, 0.0, 80.0, 0.0, 0.0, 6.0, 40.0, 42.0, 33.0, 131.0, 0.0, 86.0, 8.0, 133.0, 17.0, 153.0, 12.0, 40.0, 38.0, 0.0, 78.0, 118.0, 0.0, 132.0, 0.0, 52.0, 8.0, 0.0, 0.0, 82.0, 82.0, 0.0, 83.0, 0.0, 20.0, 0.0, 66.0, 50.0, 14.0, 0.0, 126.0, 0.0, 0.0, 67.0, 0.0, 0.0, 0.0, 0.0, 9.0, 76.0, 0.0, 0.0, 0.0, 24.0, 19.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0678172905138352, "mean_inference_ms": 2.9599681010695758, "mean_action_processing_ms": 0.4232740180444802, "mean_env_wait_ms": 0.3775704277250393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009488397174411349, "StateBufferConnector_ms": 0.0048796335856119795, "ViewRequirementAgentConnector_ms": 0.30241652771278665}, "num_episodes": 18, "episode_return_max": 217.0, "episode_return_min": -227.0, "episode_return_mean": 13.87037037037037, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 358.59652551649566, "num_env_steps_trained_throughput_per_sec": 358.59652551649566, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 11635.96, "restore_workers_time_ms": 0.022, "training_step_time_ms": 11635.858, "sample_time_ms": 1791.532, "learn_time_ms": 9821.877, "learn_throughput": 407.254, "synch_weights_time_ms": 14.965}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "45bed_00000", "date": "2024-08-13_01-10-42", "timestamp": 1723525842, "time_this_iter_s": 11.210653066635132, "time_total_s": 35.0480740070343, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33069e1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.0480740070343, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 50.65625, "ram_util_percent": 83.31875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2845773152711373, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0080648222928326, "policy_loss": -0.0019135441340348393, "vf_loss": 3.0095016201967915, "vf_explained_var": 0.002262799544309182, "kl": 0.00476748728028471, "entropy": 1.5875143358947108, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0521466832351747, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.715177397500901, "policy_loss": -0.0011635782821695247, "vf_loss": 5.716273464223065, "vf_explained_var": 0.020171832123761453, "kl": 0.0027005562429498397, "entropy": 1.6053881322265302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 217.0, "episode_reward_min": -227.0, "episode_reward_mean": 14.166666666666666, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -307.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 157.0, "predator_policy": 167.0}, "policy_reward_mean": {"prey_policy": -22.40972222222222, "predator_policy": 29.493055555555557}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 55.0, 107.0, -43.0, 108.0, 43.0, -214.0, -6.0, -30.0, 175.0, -9.0, -47.0, -45.0, 217.0, -227.0, 120.0, 0.0, 83.0, 40.0, -35.0, -11.0, -67.0, 75.0, 48.0, -48.0, 7.0, -80.0, 127.0, 15.0, 77.0, -112.0, 114.0, 14.0, -140.0, 152.0, -8.0, -46.0, -118.0, 8.0, 141.0, -24.0, -81.0, 170.0, -124.0, 35.0, -94.0, 45.0, -2.0, 120.0, -4.0, -38.0, 17.0, 175.0, 71.0, 66.0, 58.0, -108.0, 119.0, 48.0, 21.0, -65.0, -11.0, -104.0, 2.0, -107.0, 198.0, -57.0, 211.0, -198.0, 55.0, -14.0, 157.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, 44.0, 5.0, 50.0, 59.0, -4.0, 0.0, -86.0, 116.0, -74.0, -211.0, 148.0, -190.0, -265.0, -20.0, 4.0, -36.0, -36.0, 45.0, 121.0, -193.0, 44.0, -8.0, -78.0, -8.0, -96.0, 114.0, 79.0, -149.0, -245.0, 120.0, 0.0, 0.0, 0.0, 23.0, 54.0, 0.0, 30.0, -72.0, 0.0, -81.0, -87.0, -18.0, -169.0, 10.0, 2.0, 19.0, -6.0, -28.0, -70.0, 1.0, 6.0, -160.0, 0.0, 92.0, 35.0, 0.0, -31.0, -78.0, 80.0, 0.0, -243.0, 116.0, -96.0, 145.0, -281.0, -306.0, 1.0, 18.0, 56.0, -130.0, 44.0, -205.0, 41.0, -263.0, 13.0, -120.0, 68.0, 141.0, 0.0, -170.0, -18.0, -6.0, -158.0, 104.0, 46.0, -115.0, -75.0, 0.0, -29.0, -197.0, -23.0, 45.0, 0.0, -84.0, 15.0, 104.0, 16.0, 2.0, -15.0, -151.0, 37.0, 2.0, 15.0, -2.0, 134.0, 71.0, 0.0, 31.0, 35.0, 65.0, -52.0, -46.0, -135.0, 96.0, 23.0, 55.0, -32.0, 7.0, 2.0, 5.0, -164.0, -61.0, 8.0, -72.0, -142.0, 0.0, 1.0, -228.0, 0.0, 51.0, 141.0, 0.0, -114.0, 130.0, 81.0, -57.0, -307.0, 25.0, -40.0, 0.0, -37.0, 157.0, 0.0], "policy_predator_policy_reward": [1.0, 0.0, 0.0, 0.0, 51.0, 1.0, 43.0, 0.0, 13.0, 53.0, 106.0, 0.0, 95.0, 146.0, 10.0, 0.0, 42.0, 0.0, 2.0, 7.0, 54.0, 86.0, 39.0, 0.0, 11.0, 48.0, 22.0, 2.0, 167.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 0.0, 37.0, 75.0, 82.0, 45.0, 75.0, 0.0, 63.0, 0.0, 35.0, 5.0, 45.0, 0.0, 0.0, 0.0, 80.0, 0.0, 0.0, 6.0, 40.0, 42.0, 33.0, 131.0, 0.0, 86.0, 8.0, 133.0, 17.0, 153.0, 12.0, 40.0, 38.0, 0.0, 78.0, 118.0, 0.0, 132.0, 0.0, 52.0, 8.0, 0.0, 0.0, 82.0, 82.0, 0.0, 83.0, 0.0, 20.0, 0.0, 66.0, 50.0, 14.0, 0.0, 126.0, 0.0, 0.0, 67.0, 0.0, 0.0, 0.0, 0.0, 9.0, 76.0, 0.0, 0.0, 0.0, 24.0, 19.0, 0.0, 0.0, 0.0, 0.0, 18.0, 27.0, 0.0, 73.0, 0.0, 0.0, 7.0, 18.0, 4.0, 8.0, 9.0, 85.0, 11.0, 31.0, 49.0, 61.0, 0.0, 1.0, 121.0, 0.0, 6.0, 0.0, 0.0, 57.0, 0.0, 0.0, 45.0, 121.0, 25.0, 45.0, 0.0, 23.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9979767375046882, "mean_inference_ms": 2.758292261739946, "mean_action_processing_ms": 0.3980344127914395, "mean_env_wait_ms": 0.35479188326789224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008917351563771566, "StateBufferConnector_ms": 0.004394849141438802, "ViewRequirementAgentConnector_ms": 0.2527438931994968}, "num_episodes": 18, "episode_return_max": 217.0, "episode_return_min": -227.0, "episode_return_mean": 14.166666666666666, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.8348033072388, "num_env_steps_trained_throughput_per_sec": 287.8348033072388, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12201.188, "restore_workers_time_ms": 0.02, "training_step_time_ms": 12201.097, "sample_time_ms": 1686.505, "learn_time_ms": 10492.229, "learn_throughput": 381.235, "synch_weights_time_ms": 14.751}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "45bed_00000", "date": "2024-08-13_01-10-56", "timestamp": 1723525856, "time_this_iter_s": 13.975733995437622, "time_total_s": 49.023808002471924, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3306b7af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 49.023808002471924, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 68.29999999999998, "ram_util_percent": 83.61999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.36916695582882436, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.974271804567367, "policy_loss": -0.0018660334119371203, "vf_loss": 4.975774153830513, "vf_explained_var": 0.004614010815897946, "kl": 0.007273677051117723, "entropy": 1.573417582650664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9569420712926086, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.711256504563427, "policy_loss": -0.0016606448135688585, "vf_loss": 6.71286115368838, "vf_explained_var": 0.008927818013246727, "kl": 0.0044798567342677524, "entropy": 1.5979398878793867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 217.0, "episode_reward_min": -227.0, "episode_reward_mean": 12.8989898989899, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -324.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 157.0, "predator_policy": 167.0}, "policy_reward_mean": {"prey_policy": -24.949494949494948, "predator_policy": 31.3989898989899}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 55.0, 107.0, -43.0, 108.0, 43.0, -214.0, -6.0, -30.0, 175.0, -9.0, -47.0, -45.0, 217.0, -227.0, 120.0, 0.0, 83.0, 40.0, -35.0, -11.0, -67.0, 75.0, 48.0, -48.0, 7.0, -80.0, 127.0, 15.0, 77.0, -112.0, 114.0, 14.0, -140.0, 152.0, -8.0, -46.0, -118.0, 8.0, 141.0, -24.0, -81.0, 170.0, -124.0, 35.0, -94.0, 45.0, -2.0, 120.0, -4.0, -38.0, 17.0, 175.0, 71.0, 66.0, 58.0, -108.0, 119.0, 48.0, 21.0, -65.0, -11.0, -104.0, 2.0, -107.0, 198.0, -57.0, 211.0, -198.0, 55.0, -14.0, 157.0, -72.0, 9.0, 190.0, 3.0, -28.0, 103.0, 116.0, 131.0, -23.0, -105.0, -31.0, 1.0, 210.0, -64.0, -57.0, -12.0, -219.0, 80.0, 3.0, 40.0, -57.0, -97.0, -17.0, -46.0, 12.0, 40.0, 147.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, 44.0, 5.0, 50.0, 59.0, -4.0, 0.0, -86.0, 116.0, -74.0, -211.0, 148.0, -190.0, -265.0, -20.0, 4.0, -36.0, -36.0, 45.0, 121.0, -193.0, 44.0, -8.0, -78.0, -8.0, -96.0, 114.0, 79.0, -149.0, -245.0, 120.0, 0.0, 0.0, 0.0, 23.0, 54.0, 0.0, 30.0, -72.0, 0.0, -81.0, -87.0, -18.0, -169.0, 10.0, 2.0, 19.0, -6.0, -28.0, -70.0, 1.0, 6.0, -160.0, 0.0, 92.0, 35.0, 0.0, -31.0, -78.0, 80.0, 0.0, -243.0, 116.0, -96.0, 145.0, -281.0, -306.0, 1.0, 18.0, 56.0, -130.0, 44.0, -205.0, 41.0, -263.0, 13.0, -120.0, 68.0, 141.0, 0.0, -170.0, -18.0, -6.0, -158.0, 104.0, 46.0, -115.0, -75.0, 0.0, -29.0, -197.0, -23.0, 45.0, 0.0, -84.0, 15.0, 104.0, 16.0, 2.0, -15.0, -151.0, 37.0, 2.0, 15.0, -2.0, 134.0, 71.0, 0.0, 31.0, 35.0, 65.0, -52.0, -46.0, -135.0, 96.0, 23.0, 55.0, -32.0, 7.0, 2.0, 5.0, -164.0, -61.0, 8.0, -72.0, -142.0, 0.0, 1.0, -228.0, 0.0, 51.0, 141.0, 0.0, -114.0, 130.0, 81.0, -57.0, -307.0, 25.0, -40.0, 0.0, -37.0, 157.0, 0.0, -194.0, -36.0, -131.0, 46.0, 55.0, 135.0, -5.0, 0.0, -57.0, 0.0, -46.0, 63.0, 106.0, -17.0, 56.0, -13.0, -44.0, -9.0, 5.0, -324.0, -109.0, -41.0, -43.0, -6.0, 120.0, 87.0, -165.0, 0.0, -163.0, 0.0, 7.0, -39.0, -203.0, -210.0, 55.0, 0.0, 2.0, -18.0, 19.0, -102.0, -218.0, 0.0, -16.0, -221.0, -98.0, 19.0, 0.0, -106.0, 0.0, -13.0, 34.0, 0.0, 85.0, 40.0], "policy_predator_policy_reward": [1.0, 0.0, 0.0, 0.0, 51.0, 1.0, 43.0, 0.0, 13.0, 53.0, 106.0, 0.0, 95.0, 146.0, 10.0, 0.0, 42.0, 0.0, 2.0, 7.0, 54.0, 86.0, 39.0, 0.0, 11.0, 48.0, 22.0, 2.0, 167.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 0.0, 37.0, 75.0, 82.0, 45.0, 75.0, 0.0, 63.0, 0.0, 35.0, 5.0, 45.0, 0.0, 0.0, 0.0, 80.0, 0.0, 0.0, 6.0, 40.0, 42.0, 33.0, 131.0, 0.0, 86.0, 8.0, 133.0, 17.0, 153.0, 12.0, 40.0, 38.0, 0.0, 78.0, 118.0, 0.0, 132.0, 0.0, 52.0, 8.0, 0.0, 0.0, 82.0, 82.0, 0.0, 83.0, 0.0, 20.0, 0.0, 66.0, 50.0, 14.0, 0.0, 126.0, 0.0, 0.0, 67.0, 0.0, 0.0, 0.0, 0.0, 9.0, 76.0, 0.0, 0.0, 0.0, 24.0, 19.0, 0.0, 0.0, 0.0, 0.0, 18.0, 27.0, 0.0, 73.0, 0.0, 0.0, 7.0, 18.0, 4.0, 8.0, 9.0, 85.0, 11.0, 31.0, 49.0, 61.0, 0.0, 1.0, 121.0, 0.0, 6.0, 0.0, 0.0, 57.0, 0.0, 0.0, 45.0, 121.0, 25.0, 45.0, 0.0, 23.0, 0.0, 0.0, 53.0, 105.0, 94.0, 0.0, 0.0, 0.0, 0.0, 8.0, 28.0, 1.0, 0.0, 86.0, 27.0, 0.0, 78.0, 10.0, 22.0, 8.0, 131.0, 83.0, 14.0, 105.0, 47.0, 3.0, 0.0, 3.0, 0.0, 101.0, 0.0, 106.0, 20.0, 0.0, 43.0, 151.0, 0.0, 25.0, 19.0, 0.0, 28.0, 95.0, 61.0, 100.0, 56.0, 84.0, 10.0, 52.0, 60.0, 0.0, 0.0, 25.0, 0.0, 6.0, 9.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2139379562629213, "mean_inference_ms": 4.103647898133921, "mean_action_processing_ms": 0.6226469978040738, "mean_env_wait_ms": 0.5802672172189881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010492946162368313, "StateBufferConnector_ms": 0.008036873557350853, "ViewRequirementAgentConnector_ms": 0.23548603057861328}, "num_episodes": 27, "episode_return_max": 217.0, "episode_return_min": -227.0, "episode_return_mean": 12.8989898989899, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 131.02154135249242, "num_env_steps_trained_throughput_per_sec": 131.02154135249242, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 15866.819, "restore_workers_time_ms": 0.02, "training_step_time_ms": 15866.732, "sample_time_ms": 5400.248, "learn_time_ms": 10444.643, "learn_throughput": 382.971, "synch_weights_time_ms": 14.699}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "45bed_00000", "date": "2024-08-13_01-11-27", "timestamp": 1723525887, "time_this_iter_s": 30.59502387046814, "time_total_s": 79.61883187294006, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33069e820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 79.61883187294006, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 64.53809523809524, "ram_util_percent": 83.26666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2683145771522528, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.89573620027966, "policy_loss": -0.0017189256531536263, "vf_loss": 2.8971367164894386, "vf_explained_var": -0.0002104597432272775, "kl": 0.006368143134860385, "entropy": 1.5775120330866053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1400874018945075, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.644065682345597, "policy_loss": -0.0031399244210983395, "vf_loss": 5.647173643364478, "vf_explained_var": 0.03311132384986474, "kl": 0.0051129971479593065, "entropy": 1.6010913183449438, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 211.0, "episode_reward_min": -219.0, "episode_reward_mean": 14.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -324.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 157.0, "predator_policy": 153.0}, "policy_reward_mean": {"prey_policy": -23.245, "predator_policy": 30.265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.0, 40.0, -35.0, -11.0, -67.0, 75.0, 48.0, -48.0, 7.0, -80.0, 127.0, 15.0, 77.0, -112.0, 114.0, 14.0, -140.0, 152.0, -8.0, -46.0, -118.0, 8.0, 141.0, -24.0, -81.0, 170.0, -124.0, 35.0, -94.0, 45.0, -2.0, 120.0, -4.0, -38.0, 17.0, 175.0, 71.0, 66.0, 58.0, -108.0, 119.0, 48.0, 21.0, -65.0, -11.0, -104.0, 2.0, -107.0, 198.0, -57.0, 211.0, -198.0, 55.0, -14.0, 157.0, -72.0, 9.0, 190.0, 3.0, -28.0, 103.0, 116.0, 131.0, -23.0, -105.0, -31.0, 1.0, 210.0, -64.0, -57.0, -12.0, -219.0, 80.0, 3.0, 40.0, -57.0, -97.0, -17.0, -46.0, 12.0, 40.0, 147.0, -29.0, -70.0, 40.0, 0.0, -45.0, -48.0, 0.0, 115.0, 101.0, 108.0, 133.0, -92.0, -102.0, 88.0, 123.0, 125.0, -3.0, -70.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [23.0, 54.0, 0.0, 30.0, -72.0, 0.0, -81.0, -87.0, -18.0, -169.0, 10.0, 2.0, 19.0, -6.0, -28.0, -70.0, 1.0, 6.0, -160.0, 0.0, 92.0, 35.0, 0.0, -31.0, -78.0, 80.0, 0.0, -243.0, 116.0, -96.0, 145.0, -281.0, -306.0, 1.0, 18.0, 56.0, -130.0, 44.0, -205.0, 41.0, -263.0, 13.0, -120.0, 68.0, 141.0, 0.0, -170.0, -18.0, -6.0, -158.0, 104.0, 46.0, -115.0, -75.0, 0.0, -29.0, -197.0, -23.0, 45.0, 0.0, -84.0, 15.0, 104.0, 16.0, 2.0, -15.0, -151.0, 37.0, 2.0, 15.0, -2.0, 134.0, 71.0, 0.0, 31.0, 35.0, 65.0, -52.0, -46.0, -135.0, 96.0, 23.0, 55.0, -32.0, 7.0, 2.0, 5.0, -164.0, -61.0, 8.0, -72.0, -142.0, 0.0, 1.0, -228.0, 0.0, 51.0, 141.0, 0.0, -114.0, 130.0, 81.0, -57.0, -307.0, 25.0, -40.0, 0.0, -37.0, 157.0, 0.0, -194.0, -36.0, -131.0, 46.0, 55.0, 135.0, -5.0, 0.0, -57.0, 0.0, -46.0, 63.0, 106.0, -17.0, 56.0, -13.0, -44.0, -9.0, 5.0, -324.0, -109.0, -41.0, -43.0, -6.0, 120.0, 87.0, -165.0, 0.0, -163.0, 0.0, 7.0, -39.0, -203.0, -210.0, 55.0, 0.0, 2.0, -18.0, 19.0, -102.0, -218.0, 0.0, -16.0, -221.0, -98.0, 19.0, 0.0, -106.0, 0.0, -13.0, 34.0, 0.0, 85.0, 40.0, 0.0, -60.0, -209.0, 31.0, 9.0, 23.0, 0.0, 0.0, -73.0, -75.0, -154.0, 12.0, 0.0, 0.0, 0.0, 112.0, 101.0, 0.0, 0.0, 108.0, 86.0, 27.0, 10.0, -204.0, 2.0, -208.0, 4.0, 84.0, 71.0, -4.0, 0.0, 118.0, 0.0, -57.0, 8.0, -223.0], "policy_predator_policy_reward": [6.0, 0.0, 0.0, 10.0, 0.0, 37.0, 75.0, 82.0, 45.0, 75.0, 0.0, 63.0, 0.0, 35.0, 5.0, 45.0, 0.0, 0.0, 0.0, 80.0, 0.0, 0.0, 6.0, 40.0, 42.0, 33.0, 131.0, 0.0, 86.0, 8.0, 133.0, 17.0, 153.0, 12.0, 40.0, 38.0, 0.0, 78.0, 118.0, 0.0, 132.0, 0.0, 52.0, 8.0, 0.0, 0.0, 82.0, 82.0, 0.0, 83.0, 0.0, 20.0, 0.0, 66.0, 50.0, 14.0, 0.0, 126.0, 0.0, 0.0, 67.0, 0.0, 0.0, 0.0, 0.0, 9.0, 76.0, 0.0, 0.0, 0.0, 24.0, 19.0, 0.0, 0.0, 0.0, 0.0, 18.0, 27.0, 0.0, 73.0, 0.0, 0.0, 7.0, 18.0, 4.0, 8.0, 9.0, 85.0, 11.0, 31.0, 49.0, 61.0, 0.0, 1.0, 121.0, 0.0, 6.0, 0.0, 0.0, 57.0, 0.0, 0.0, 45.0, 121.0, 25.0, 45.0, 0.0, 23.0, 0.0, 0.0, 53.0, 105.0, 94.0, 0.0, 0.0, 0.0, 0.0, 8.0, 28.0, 1.0, 0.0, 86.0, 27.0, 0.0, 78.0, 10.0, 22.0, 8.0, 131.0, 83.0, 14.0, 105.0, 47.0, 3.0, 0.0, 3.0, 0.0, 101.0, 0.0, 106.0, 20.0, 0.0, 43.0, 151.0, 0.0, 25.0, 19.0, 0.0, 28.0, 95.0, 61.0, 100.0, 56.0, 84.0, 10.0, 52.0, 60.0, 0.0, 0.0, 25.0, 0.0, 6.0, 9.0, 13.0, 31.0, 0.0, 0.0, 108.0, 0.0, 8.0, 0.0, 0.0, 40.0, 63.0, 15.0, 79.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 102.0, 0.0, 104.0, 0.0, 0.0, 34.0, 22.0, 7.0, 0.0, 0.0, 54.0, 112.0, 33.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2619094194294136, "mean_inference_ms": 4.604547275206227, "mean_action_processing_ms": 0.7162073262374237, "mean_env_wait_ms": 0.676284637450363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008299112319946289, "StateBufferConnector_ms": 0.007871866226196289, "ViewRequirementAgentConnector_ms": 0.13546013832092285}, "num_episodes": 18, "episode_return_max": 211.0, "episode_return_min": -219.0, "episode_return_mean": 14.04, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 344.3874245216331, "num_env_steps_trained_throughput_per_sec": 344.3874245216331, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 15158.154, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15158.075, "sample_time_ms": 4710.533, "learn_time_ms": 10425.795, "learn_throughput": 383.664, "synch_weights_time_ms": 15.406}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "45bed_00000", "date": "2024-08-13_01-11-39", "timestamp": 1723525899, "time_this_iter_s": 11.662233829498291, "time_total_s": 91.28106570243835, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3307521f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 91.28106570243835, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 51.2, "ram_util_percent": 82.16470588235293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2116035008497497, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5720941916975395, "policy_loss": -0.004362566510299171, "vf_loss": 3.5758480804937856, "vf_explained_var": 1.4277362318896743e-05, "kl": 0.012173599397678616, "entropy": 1.5866430104094207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9776176615879334, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.432328205512314, "policy_loss": -0.002659150550792378, "vf_loss": 5.434953011406792, "vf_explained_var": 0.0297583592316461, "kl": 0.005491824713869554, "entropy": 1.5980808687588526, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 211.0, "episode_reward_min": -219.0, "episode_reward_mean": 14.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -324.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 157.0, "predator_policy": 151.0}, "policy_reward_mean": {"prey_policy": -21.885, "predator_policy": 29.065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.0, -46.0, -118.0, 8.0, 141.0, -24.0, -81.0, 170.0, -124.0, 35.0, -94.0, 45.0, -2.0, 120.0, -4.0, -38.0, 17.0, 175.0, 71.0, 66.0, 58.0, -108.0, 119.0, 48.0, 21.0, -65.0, -11.0, -104.0, 2.0, -107.0, 198.0, -57.0, 211.0, -198.0, 55.0, -14.0, 157.0, -72.0, 9.0, 190.0, 3.0, -28.0, 103.0, 116.0, 131.0, -23.0, -105.0, -31.0, 1.0, 210.0, -64.0, -57.0, -12.0, -219.0, 80.0, 3.0, 40.0, -57.0, -97.0, -17.0, -46.0, 12.0, 40.0, 147.0, -29.0, -70.0, 40.0, 0.0, -45.0, -48.0, 0.0, 115.0, 101.0, 108.0, 133.0, -92.0, -102.0, 88.0, 123.0, 125.0, -3.0, -70.0, 123.0, -106.0, 58.0, 0.0, -12.0, -24.0, -79.0, 49.0, 135.0, 34.0, -41.0, 7.0, 36.0, -64.0, 78.0, 166.0, -35.0, -34.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-130.0, 44.0, -205.0, 41.0, -263.0, 13.0, -120.0, 68.0, 141.0, 0.0, -170.0, -18.0, -6.0, -158.0, 104.0, 46.0, -115.0, -75.0, 0.0, -29.0, -197.0, -23.0, 45.0, 0.0, -84.0, 15.0, 104.0, 16.0, 2.0, -15.0, -151.0, 37.0, 2.0, 15.0, -2.0, 134.0, 71.0, 0.0, 31.0, 35.0, 65.0, -52.0, -46.0, -135.0, 96.0, 23.0, 55.0, -32.0, 7.0, 2.0, 5.0, -164.0, -61.0, 8.0, -72.0, -142.0, 0.0, 1.0, -228.0, 0.0, 51.0, 141.0, 0.0, -114.0, 130.0, 81.0, -57.0, -307.0, 25.0, -40.0, 0.0, -37.0, 157.0, 0.0, -194.0, -36.0, -131.0, 46.0, 55.0, 135.0, -5.0, 0.0, -57.0, 0.0, -46.0, 63.0, 106.0, -17.0, 56.0, -13.0, -44.0, -9.0, 5.0, -324.0, -109.0, -41.0, -43.0, -6.0, 120.0, 87.0, -165.0, 0.0, -163.0, 0.0, 7.0, -39.0, -203.0, -210.0, 55.0, 0.0, 2.0, -18.0, 19.0, -102.0, -218.0, 0.0, -16.0, -221.0, -98.0, 19.0, 0.0, -106.0, 0.0, -13.0, 34.0, 0.0, 85.0, 40.0, 0.0, -60.0, -209.0, 31.0, 9.0, 23.0, 0.0, 0.0, -73.0, -75.0, -154.0, 12.0, 0.0, 0.0, 0.0, 112.0, 101.0, 0.0, 0.0, 108.0, 86.0, 27.0, 10.0, -204.0, 2.0, -208.0, 4.0, 84.0, 71.0, -4.0, 0.0, 118.0, 0.0, -57.0, 8.0, -223.0, 101.0, -99.0, 17.0, -246.0, -117.0, 106.0, 0.0, -11.0, 43.0, -110.0, -24.0, -25.0, -151.0, -26.0, 59.0, -80.0, 73.0, 21.0, -70.0, 66.0, 8.0, -98.0, -65.0, 15.0, -21.0, 7.0, 26.0, -180.0, 40.0, -36.0, 27.0, 132.0, -70.0, 0.0, 4.0, -82.0], "policy_predator_policy_reward": [0.0, 78.0, 118.0, 0.0, 132.0, 0.0, 52.0, 8.0, 0.0, 0.0, 82.0, 82.0, 0.0, 83.0, 0.0, 20.0, 0.0, 66.0, 50.0, 14.0, 0.0, 126.0, 0.0, 0.0, 67.0, 0.0, 0.0, 0.0, 0.0, 9.0, 76.0, 0.0, 0.0, 0.0, 24.0, 19.0, 0.0, 0.0, 0.0, 0.0, 18.0, 27.0, 0.0, 73.0, 0.0, 0.0, 7.0, 18.0, 4.0, 8.0, 9.0, 85.0, 11.0, 31.0, 49.0, 61.0, 0.0, 1.0, 121.0, 0.0, 6.0, 0.0, 0.0, 57.0, 0.0, 0.0, 45.0, 121.0, 25.0, 45.0, 0.0, 23.0, 0.0, 0.0, 53.0, 105.0, 94.0, 0.0, 0.0, 0.0, 0.0, 8.0, 28.0, 1.0, 0.0, 86.0, 27.0, 0.0, 78.0, 10.0, 22.0, 8.0, 131.0, 83.0, 14.0, 105.0, 47.0, 3.0, 0.0, 3.0, 0.0, 101.0, 0.0, 106.0, 20.0, 0.0, 43.0, 151.0, 0.0, 25.0, 19.0, 0.0, 28.0, 95.0, 61.0, 100.0, 56.0, 84.0, 10.0, 52.0, 60.0, 0.0, 0.0, 25.0, 0.0, 6.0, 9.0, 13.0, 31.0, 0.0, 0.0, 108.0, 0.0, 8.0, 0.0, 0.0, 40.0, 63.0, 15.0, 79.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 102.0, 0.0, 104.0, 0.0, 0.0, 34.0, 22.0, 7.0, 0.0, 0.0, 54.0, 112.0, 33.0, 37.0, 84.0, 0.0, 123.0, 51.0, 18.0, 11.0, 0.0, 41.0, 14.0, 12.0, 13.0, 66.0, 32.0, 0.0, 70.0, 33.0, 8.0, 0.0, 38.0, 49.0, 0.0, 14.0, 43.0, 42.0, 8.0, 28.0, 62.0, 17.0, 57.0, 7.0, 0.0, 35.0, 0.0, 44.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3450105593932635, "mean_inference_ms": 5.189009665257182, "mean_action_processing_ms": 0.8159181101027205, "mean_env_wait_ms": 0.7758338332781076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00843954086303711, "StateBufferConnector_ms": 0.008148431777954102, "ViewRequirementAgentConnector_ms": 0.14681494235992432}, "num_episodes": 18, "episode_return_max": 211.0, "episode_return_min": -219.0, "episode_return_mean": 14.36, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.92931357919997, "num_env_steps_trained_throughput_per_sec": 313.92931357919997, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 14812.951, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14812.876, "sample_time_ms": 4270.358, "learn_time_ms": 10521.557, "learn_throughput": 380.172, "synch_weights_time_ms": 15.394}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "45bed_00000", "date": "2024-08-13_01-11-51", "timestamp": 1723525911, "time_this_iter_s": 12.761901140213013, "time_total_s": 104.04296684265137, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x330752280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 104.04296684265137, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 53.78333333333333, "ram_util_percent": 81.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.23868354447974413, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.874121620793822, "policy_loss": -0.0010852425970215962, "vf_loss": 3.87491084772443, "vf_explained_var": -0.0001467264833904448, "kl": 0.005920341512251191, "entropy": 1.5727122079758418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0522958469177996, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.367214122651116, "policy_loss": -0.0030303268215407138, "vf_loss": 5.370208572079895, "vf_explained_var": 0.01900985449079483, "kl": 0.005739472465461793, "entropy": 1.5864661700511105, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 211.0, "episode_reward_min": -219.0, "episode_reward_mean": 15.54, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -324.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 157.0, "predator_policy": 151.0}, "policy_reward_mean": {"prey_policy": -20.965, "predator_policy": 28.735}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.0, 66.0, 58.0, -108.0, 119.0, 48.0, 21.0, -65.0, -11.0, -104.0, 2.0, -107.0, 198.0, -57.0, 211.0, -198.0, 55.0, -14.0, 157.0, -72.0, 9.0, 190.0, 3.0, -28.0, 103.0, 116.0, 131.0, -23.0, -105.0, -31.0, 1.0, 210.0, -64.0, -57.0, -12.0, -219.0, 80.0, 3.0, 40.0, -57.0, -97.0, -17.0, -46.0, 12.0, 40.0, 147.0, -29.0, -70.0, 40.0, 0.0, -45.0, -48.0, 0.0, 115.0, 101.0, 108.0, 133.0, -92.0, -102.0, 88.0, 123.0, 125.0, -3.0, -70.0, 123.0, -106.0, 58.0, 0.0, -12.0, -24.0, -79.0, 49.0, 135.0, 34.0, -41.0, 7.0, 36.0, -64.0, 78.0, 166.0, -35.0, -34.0, -77.0, 56.0, 92.0, 7.0, 0.0, 5.0, -26.0, -6.0, -24.0, -29.0, -49.0, 104.0, 50.0, 87.0, 122.0, -82.0, 90.0, -30.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [71.0, 0.0, 31.0, 35.0, 65.0, -52.0, -46.0, -135.0, 96.0, 23.0, 55.0, -32.0, 7.0, 2.0, 5.0, -164.0, -61.0, 8.0, -72.0, -142.0, 0.0, 1.0, -228.0, 0.0, 51.0, 141.0, 0.0, -114.0, 130.0, 81.0, -57.0, -307.0, 25.0, -40.0, 0.0, -37.0, 157.0, 0.0, -194.0, -36.0, -131.0, 46.0, 55.0, 135.0, -5.0, 0.0, -57.0, 0.0, -46.0, 63.0, 106.0, -17.0, 56.0, -13.0, -44.0, -9.0, 5.0, -324.0, -109.0, -41.0, -43.0, -6.0, 120.0, 87.0, -165.0, 0.0, -163.0, 0.0, 7.0, -39.0, -203.0, -210.0, 55.0, 0.0, 2.0, -18.0, 19.0, -102.0, -218.0, 0.0, -16.0, -221.0, -98.0, 19.0, 0.0, -106.0, 0.0, -13.0, 34.0, 0.0, 85.0, 40.0, 0.0, -60.0, -209.0, 31.0, 9.0, 23.0, 0.0, 0.0, -73.0, -75.0, -154.0, 12.0, 0.0, 0.0, 0.0, 112.0, 101.0, 0.0, 0.0, 108.0, 86.0, 27.0, 10.0, -204.0, 2.0, -208.0, 4.0, 84.0, 71.0, -4.0, 0.0, 118.0, 0.0, -57.0, 8.0, -223.0, 101.0, -99.0, 17.0, -246.0, -117.0, 106.0, 0.0, -11.0, 43.0, -110.0, -24.0, -25.0, -151.0, -26.0, 59.0, -80.0, 73.0, 21.0, -70.0, 66.0, 8.0, -98.0, -65.0, 15.0, -21.0, 7.0, 26.0, -180.0, 40.0, -36.0, 27.0, 132.0, -70.0, 0.0, 4.0, -82.0, 4.0, -273.0, -84.0, 76.0, 92.0, 0.0, 11.0, -99.0, 0.0, 0.0, 19.0, -39.0, -64.0, 0.0, -43.0, -83.0, -44.0, -30.0, -230.0, 36.0, -112.0, 0.0, 102.0, 0.0, -114.0, 97.0, 87.0, 0.0, 108.0, 12.0, -90.0, -90.0, 0.0, 90.0, 27.0, -116.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 18.0, 27.0, 0.0, 73.0, 0.0, 0.0, 7.0, 18.0, 4.0, 8.0, 9.0, 85.0, 11.0, 31.0, 49.0, 61.0, 0.0, 1.0, 121.0, 0.0, 6.0, 0.0, 0.0, 57.0, 0.0, 0.0, 45.0, 121.0, 25.0, 45.0, 0.0, 23.0, 0.0, 0.0, 53.0, 105.0, 94.0, 0.0, 0.0, 0.0, 0.0, 8.0, 28.0, 1.0, 0.0, 86.0, 27.0, 0.0, 78.0, 10.0, 22.0, 8.0, 131.0, 83.0, 14.0, 105.0, 47.0, 3.0, 0.0, 3.0, 0.0, 101.0, 0.0, 106.0, 20.0, 0.0, 43.0, 151.0, 0.0, 25.0, 19.0, 0.0, 28.0, 95.0, 61.0, 100.0, 56.0, 84.0, 10.0, 52.0, 60.0, 0.0, 0.0, 25.0, 0.0, 6.0, 9.0, 13.0, 31.0, 0.0, 0.0, 108.0, 0.0, 8.0, 0.0, 0.0, 40.0, 63.0, 15.0, 79.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 102.0, 0.0, 104.0, 0.0, 0.0, 34.0, 22.0, 7.0, 0.0, 0.0, 54.0, 112.0, 33.0, 37.0, 84.0, 0.0, 123.0, 51.0, 18.0, 11.0, 0.0, 41.0, 14.0, 12.0, 13.0, 66.0, 32.0, 0.0, 70.0, 33.0, 8.0, 0.0, 38.0, 49.0, 0.0, 14.0, 43.0, 42.0, 8.0, 28.0, 62.0, 17.0, 57.0, 7.0, 0.0, 35.0, 0.0, 44.0, 0.0, 65.0, 127.0, 42.0, 22.0, 0.0, 0.0, 68.0, 27.0, 0.0, 0.0, 0.0, 25.0, 17.0, 21.0, 54.0, 66.0, 26.0, 24.0, 119.0, 46.0, 22.0, 41.0, 2.0, 0.0, 36.0, 31.0, 0.0, 0.0, 2.0, 0.0, 0.0, 98.0, 0.0, 0.0, 59.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.460752575695838, "mean_inference_ms": 5.789132314345473, "mean_action_processing_ms": 0.9136836287090646, "mean_env_wait_ms": 0.8719193521987271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009133696556091309, "StateBufferConnector_ms": 0.007803678512573242, "ViewRequirementAgentConnector_ms": 0.15778517723083496}, "num_episodes": 18, "episode_return_max": 211.0, "episode_return_min": -219.0, "episode_return_mean": 15.54, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 24.403112668946797, "num_env_steps_trained_throughput_per_sec": 24.403112668946797, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 33450.523, "restore_workers_time_ms": 0.018, "training_step_time_ms": 33450.45, "sample_time_ms": 4088.935, "learn_time_ms": 29333.172, "learn_throughput": 136.364, "synch_weights_time_ms": 22.308}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "45bed_00000", "date": "2024-08-13_01-14-38", "timestamp": 1723526078, "time_this_iter_s": 166.34635591506958, "time_total_s": 270.38932275772095, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3306b7a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 270.38932275772095, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 83.22926829268293, "ram_util_percent": 83.58780487804877}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.29107921859495856, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.509305958142356, "policy_loss": -0.001336748413027082, "vf_loss": 4.51043892499631, "vf_explained_var": 0.0005909942129932383, "kl": 0.00407594534040486, "entropy": 1.5652604452516667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5621326622272296, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.122582666457645, "policy_loss": -0.0035352030159195975, "vf_loss": 7.126075170658253, "vf_explained_var": 0.021272530915245176, "kl": 0.00683556010024981, "entropy": 1.5726769921010133, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 210.0, "episode_reward_min": -219.0, "episode_reward_mean": 15.38, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -346.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.0, "predator_policy": 173.0}, "policy_reward_mean": {"prey_policy": -22.6, "predator_policy": 30.29}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, -28.0, 103.0, 116.0, 131.0, -23.0, -105.0, -31.0, 1.0, 210.0, -64.0, -57.0, -12.0, -219.0, 80.0, 3.0, 40.0, -57.0, -97.0, -17.0, -46.0, 12.0, 40.0, 147.0, -29.0, -70.0, 40.0, 0.0, -45.0, -48.0, 0.0, 115.0, 101.0, 108.0, 133.0, -92.0, -102.0, 88.0, 123.0, 125.0, -3.0, -70.0, 123.0, -106.0, 58.0, 0.0, -12.0, -24.0, -79.0, 49.0, 135.0, 34.0, -41.0, 7.0, 36.0, -64.0, 78.0, 166.0, -35.0, -34.0, -77.0, 56.0, 92.0, 7.0, 0.0, 5.0, -26.0, -6.0, -24.0, -29.0, -49.0, 104.0, 50.0, 87.0, 122.0, -82.0, 90.0, -30.0, 32.0, 140.0, -100.0, -63.0, 182.0, -31.0, 7.0, 75.0, 50.0, -101.0, -115.0, 45.0, 113.0, -43.0, -30.0, 6.0, 0.0, 6.0, 194.0, 68.0, -23.0, 41.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-5.0, 0.0, -57.0, 0.0, -46.0, 63.0, 106.0, -17.0, 56.0, -13.0, -44.0, -9.0, 5.0, -324.0, -109.0, -41.0, -43.0, -6.0, 120.0, 87.0, -165.0, 0.0, -163.0, 0.0, 7.0, -39.0, -203.0, -210.0, 55.0, 0.0, 2.0, -18.0, 19.0, -102.0, -218.0, 0.0, -16.0, -221.0, -98.0, 19.0, 0.0, -106.0, 0.0, -13.0, 34.0, 0.0, 85.0, 40.0, 0.0, -60.0, -209.0, 31.0, 9.0, 23.0, 0.0, 0.0, -73.0, -75.0, -154.0, 12.0, 0.0, 0.0, 0.0, 112.0, 101.0, 0.0, 0.0, 108.0, 86.0, 27.0, 10.0, -204.0, 2.0, -208.0, 4.0, 84.0, 71.0, -4.0, 0.0, 118.0, 0.0, -57.0, 8.0, -223.0, 101.0, -99.0, 17.0, -246.0, -117.0, 106.0, 0.0, -11.0, 43.0, -110.0, -24.0, -25.0, -151.0, -26.0, 59.0, -80.0, 73.0, 21.0, -70.0, 66.0, 8.0, -98.0, -65.0, 15.0, -21.0, 7.0, 26.0, -180.0, 40.0, -36.0, 27.0, 132.0, -70.0, 0.0, 4.0, -82.0, 4.0, -273.0, -84.0, 76.0, 92.0, 0.0, 11.0, -99.0, 0.0, 0.0, 19.0, -39.0, -64.0, 0.0, -43.0, -83.0, -44.0, -30.0, -230.0, 36.0, -112.0, 0.0, 102.0, 0.0, -114.0, 97.0, 87.0, 0.0, 108.0, 12.0, -90.0, -90.0, 0.0, 90.0, 27.0, -116.0, 31.0, 1.0, 87.0, 52.0, 43.0, -298.0, -126.0, -52.0, 3.0, 179.0, 51.0, -245.0, -24.0, 19.0, -5.0, 39.0, 7.0, -30.0, 72.0, -346.0, -49.0, -208.0, -8.0, 14.0, 23.0, 65.0, -10.0, -141.0, -64.0, 2.0, 0.0, 6.0, 0.0, -46.0, -56.0, -25.0, 41.0, 127.0, -20.0, 12.0, -46.0, 0.0, 78.0, -108.0], "policy_predator_policy_reward": [0.0, 8.0, 28.0, 1.0, 0.0, 86.0, 27.0, 0.0, 78.0, 10.0, 22.0, 8.0, 131.0, 83.0, 14.0, 105.0, 47.0, 3.0, 0.0, 3.0, 0.0, 101.0, 0.0, 106.0, 20.0, 0.0, 43.0, 151.0, 0.0, 25.0, 19.0, 0.0, 28.0, 95.0, 61.0, 100.0, 56.0, 84.0, 10.0, 52.0, 60.0, 0.0, 0.0, 25.0, 0.0, 6.0, 9.0, 13.0, 31.0, 0.0, 0.0, 108.0, 0.0, 8.0, 0.0, 0.0, 40.0, 63.0, 15.0, 79.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 102.0, 0.0, 104.0, 0.0, 0.0, 34.0, 22.0, 7.0, 0.0, 0.0, 54.0, 112.0, 33.0, 37.0, 84.0, 0.0, 123.0, 51.0, 18.0, 11.0, 0.0, 41.0, 14.0, 12.0, 13.0, 66.0, 32.0, 0.0, 70.0, 33.0, 8.0, 0.0, 38.0, 49.0, 0.0, 14.0, 43.0, 42.0, 8.0, 28.0, 62.0, 17.0, 57.0, 7.0, 0.0, 35.0, 0.0, 44.0, 0.0, 65.0, 127.0, 42.0, 22.0, 0.0, 0.0, 68.0, 27.0, 0.0, 0.0, 0.0, 25.0, 17.0, 21.0, 54.0, 66.0, 26.0, 24.0, 119.0, 46.0, 22.0, 41.0, 2.0, 0.0, 36.0, 31.0, 0.0, 0.0, 2.0, 0.0, 0.0, 98.0, 0.0, 0.0, 59.0, 0.0, 0.0, 0.0, 0.0, 1.0, 153.0, 2.0, 6.0, 109.0, 0.0, 0.0, 124.0, 39.0, 12.0, 0.0, 41.0, 0.0, 73.0, 0.0, 0.0, 173.0, 0.0, 142.0, 0.0, 39.0, 14.0, 11.0, 99.0, 9.0, 32.0, 0.0, 0.0, 0.0, 46.0, 0.0, 62.0, 25.0, 1.0, 25.0, 42.0, 34.0, 5.0, 18.0, 55.0, 16.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6048897997628995, "mean_inference_ms": 6.3451733698176875, "mean_action_processing_ms": 1.012801521879449, "mean_env_wait_ms": 1.00997346176182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012141108512878418, "StateBufferConnector_ms": 0.008162260055541992, "ViewRequirementAgentConnector_ms": 0.23084568977355957}, "num_episodes": 22, "episode_return_max": 210.0, "episode_return_min": -219.0, "episode_return_mean": 15.38, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 225.13556503676404, "num_env_steps_trained_throughput_per_sec": 225.13556503676404, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 31707.95, "restore_workers_time_ms": 0.052, "training_step_time_ms": 31707.8, "sample_time_ms": 4114.251, "learn_time_ms": 27565.695, "learn_throughput": 145.108, "synch_weights_time_ms": 22.07}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "45bed_00000", "date": "2024-08-13_01-14-57", "timestamp": 1723526097, "time_this_iter_s": 17.82187795639038, "time_total_s": 288.2112007141113, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33062fc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 288.2112007141113, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 74.12222222222223, "ram_util_percent": 83.41481481481482}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.33052196291191555, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.791437203291232, "policy_loss": -0.0014191925641464651, "vf_loss": 3.7926181523257463, "vf_explained_var": -0.0005158659011598617, "kl": 0.00952984295057597, "entropy": 1.5588429362054854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.657167633484911, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.457829158268278, "policy_loss": -0.0008241846876603271, "vf_loss": 6.458627080412769, "vf_explained_var": 0.028895938806432896, "kl": 0.004203222867752527, "entropy": 1.588191222576868, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 254.0, "episode_reward_min": -250.0, "episode_reward_mean": 18.39, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -346.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.0, "predator_policy": 217.0}, "policy_reward_mean": {"prey_policy": -20.495, "predator_policy": 29.69}, "custom_metrics": {}, "hist_stats": {"episode_reward": [147.0, -29.0, -70.0, 40.0, 0.0, -45.0, -48.0, 0.0, 115.0, 101.0, 108.0, 133.0, -92.0, -102.0, 88.0, 123.0, 125.0, -3.0, -70.0, 123.0, -106.0, 58.0, 0.0, -12.0, -24.0, -79.0, 49.0, 135.0, 34.0, -41.0, 7.0, 36.0, -64.0, 78.0, 166.0, -35.0, -34.0, -77.0, 56.0, 92.0, 7.0, 0.0, 5.0, -26.0, -6.0, -24.0, -29.0, -49.0, 104.0, 50.0, 87.0, 122.0, -82.0, 90.0, -30.0, 32.0, 140.0, -100.0, -63.0, 182.0, -31.0, 7.0, 75.0, 50.0, -101.0, -115.0, 45.0, 113.0, -43.0, -30.0, 6.0, 0.0, 6.0, 194.0, 68.0, -23.0, 41.0, 27.0, 164.0, 13.0, 89.0, 10.0, 32.0, 254.0, 163.0, -45.0, 115.0, 41.0, 44.0, -61.0, 11.0, -74.0, -73.0, 52.0, -16.0, -56.0, -250.0, -107.0, 0.0, -49.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [85.0, 40.0, 0.0, -60.0, -209.0, 31.0, 9.0, 23.0, 0.0, 0.0, -73.0, -75.0, -154.0, 12.0, 0.0, 0.0, 0.0, 112.0, 101.0, 0.0, 0.0, 108.0, 86.0, 27.0, 10.0, -204.0, 2.0, -208.0, 4.0, 84.0, 71.0, -4.0, 0.0, 118.0, 0.0, -57.0, 8.0, -223.0, 101.0, -99.0, 17.0, -246.0, -117.0, 106.0, 0.0, -11.0, 43.0, -110.0, -24.0, -25.0, -151.0, -26.0, 59.0, -80.0, 73.0, 21.0, -70.0, 66.0, 8.0, -98.0, -65.0, 15.0, -21.0, 7.0, 26.0, -180.0, 40.0, -36.0, 27.0, 132.0, -70.0, 0.0, 4.0, -82.0, 4.0, -273.0, -84.0, 76.0, 92.0, 0.0, 11.0, -99.0, 0.0, 0.0, 19.0, -39.0, -64.0, 0.0, -43.0, -83.0, -44.0, -30.0, -230.0, 36.0, -112.0, 0.0, 102.0, 0.0, -114.0, 97.0, 87.0, 0.0, 108.0, 12.0, -90.0, -90.0, 0.0, 90.0, 27.0, -116.0, 31.0, 1.0, 87.0, 52.0, 43.0, -298.0, -126.0, -52.0, 3.0, 179.0, 51.0, -245.0, -24.0, 19.0, -5.0, 39.0, 7.0, -30.0, 72.0, -346.0, -49.0, -208.0, -8.0, 14.0, 23.0, 65.0, -10.0, -141.0, -64.0, 2.0, 0.0, 6.0, 0.0, -46.0, -56.0, -25.0, 41.0, 127.0, -20.0, 12.0, -46.0, 0.0, 78.0, -108.0, -24.0, 39.0, 164.0, 0.0, 8.0, -4.0, 64.0, 8.0, -8.0, 0.0, -2.0, 15.0, 169.0, 81.0, 35.0, 99.0, -16.0, -105.0, -30.0, 66.0, 86.0, -183.0, 102.0, -151.0, -184.0, 3.0, 14.0, -31.0, -129.0, -39.0, -50.0, -136.0, 85.0, -102.0, -85.0, -1.0, -8.0, -113.0, -176.0, -346.0, 5.0, -228.0, 2.0, -4.0, 50.0, -232.0], "policy_predator_policy_reward": [9.0, 13.0, 31.0, 0.0, 0.0, 108.0, 0.0, 8.0, 0.0, 0.0, 40.0, 63.0, 15.0, 79.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 102.0, 0.0, 104.0, 0.0, 0.0, 34.0, 22.0, 7.0, 0.0, 0.0, 54.0, 112.0, 33.0, 37.0, 84.0, 0.0, 123.0, 51.0, 18.0, 11.0, 0.0, 41.0, 14.0, 12.0, 13.0, 66.0, 32.0, 0.0, 70.0, 33.0, 8.0, 0.0, 38.0, 49.0, 0.0, 14.0, 43.0, 42.0, 8.0, 28.0, 62.0, 17.0, 57.0, 7.0, 0.0, 35.0, 0.0, 44.0, 0.0, 65.0, 127.0, 42.0, 22.0, 0.0, 0.0, 68.0, 27.0, 0.0, 0.0, 0.0, 25.0, 17.0, 21.0, 54.0, 66.0, 26.0, 24.0, 119.0, 46.0, 22.0, 41.0, 2.0, 0.0, 36.0, 31.0, 0.0, 0.0, 2.0, 0.0, 0.0, 98.0, 0.0, 0.0, 59.0, 0.0, 0.0, 0.0, 0.0, 1.0, 153.0, 2.0, 6.0, 109.0, 0.0, 0.0, 124.0, 39.0, 12.0, 0.0, 41.0, 0.0, 73.0, 0.0, 0.0, 173.0, 0.0, 142.0, 0.0, 39.0, 14.0, 11.0, 99.0, 9.0, 32.0, 0.0, 0.0, 0.0, 46.0, 0.0, 62.0, 25.0, 1.0, 25.0, 42.0, 34.0, 5.0, 18.0, 55.0, 16.0, 12.0, 0.0, 0.0, 0.0, 9.0, 0.0, 10.0, 7.0, 4.0, 14.0, 1.0, 18.0, 1.0, 3.0, 0.0, 29.0, 68.0, 8.0, 75.0, 4.0, 115.0, 23.0, 93.0, 0.0, 94.0, 26.0, 2.0, 26.0, 71.0, 23.0, 68.0, 45.0, 69.0, 0.0, 70.0, 0.0, 65.0, 0.0, 55.0, 217.0, 116.0, 0.0, 2.0, 0.0, 71.0, 62.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5354808614005924, "mean_inference_ms": 5.94540943401038, "mean_action_processing_ms": 0.9110440291644792, "mean_env_wait_ms": 0.8647829158530047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011782407760620117, "StateBufferConnector_ms": 0.00688481330871582, "ViewRequirementAgentConnector_ms": 0.2608071565628052}, "num_episodes": 23, "episode_return_max": 254.0, "episode_return_min": -250.0, "episode_return_mean": 18.39, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 228.98454108783085, "num_env_steps_trained_throughput_per_sec": 228.98454108783085, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 30283.999, "restore_workers_time_ms": 0.049, "training_step_time_ms": 30283.858, "sample_time_ms": 4037.301, "learn_time_ms": 26217.331, "learn_throughput": 152.571, "synch_weights_time_ms": 22.944}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "45bed_00000", "date": "2024-08-13_01-15-14", "timestamp": 1723526114, "time_this_iter_s": 17.534139156341553, "time_total_s": 305.7453398704529, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33073cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 305.7453398704529, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 68.58800000000001, "ram_util_percent": 83.68800000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.32116993671017036, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.433848739553381, "policy_loss": -0.000610816303305525, "vf_loss": 3.4343181311138093, "vf_explained_var": 0.0037608094947047966, "kl": 0.005657143250695655, "entropy": 1.551761662833905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2492817682721626, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.24738014967984, "policy_loss": -0.0034472595060135794, "vf_loss": 5.250816422038608, "vf_explained_var": 0.007842737310147159, "kl": 0.0035177759606434393, "entropy": 1.5951288918969493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 254.0, "episode_reward_min": -250.0, "episode_reward_mean": 14.62, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -346.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.0, "predator_policy": 217.0}, "policy_reward_mean": {"prey_policy": -22.11, "predator_policy": 29.42}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-70.0, 123.0, -106.0, 58.0, 0.0, -12.0, -24.0, -79.0, 49.0, 135.0, 34.0, -41.0, 7.0, 36.0, -64.0, 78.0, 166.0, -35.0, -34.0, -77.0, 56.0, 92.0, 7.0, 0.0, 5.0, -26.0, -6.0, -24.0, -29.0, -49.0, 104.0, 50.0, 87.0, 122.0, -82.0, 90.0, -30.0, 32.0, 140.0, -100.0, -63.0, 182.0, -31.0, 7.0, 75.0, 50.0, -101.0, -115.0, 45.0, 113.0, -43.0, -30.0, 6.0, 0.0, 6.0, 194.0, 68.0, -23.0, 41.0, 27.0, 164.0, 13.0, 89.0, 10.0, 32.0, 254.0, 163.0, -45.0, 115.0, 41.0, 44.0, -61.0, 11.0, -74.0, -73.0, 52.0, -16.0, -56.0, -250.0, -107.0, 0.0, -49.0, 12.0, 0.0, -117.0, 1.0, 57.0, 2.0, -20.0, -6.0, 22.0, 9.0, 124.0, 36.0, -64.0, 46.0, -40.0, 63.0, 112.0, -23.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [8.0, -223.0, 101.0, -99.0, 17.0, -246.0, -117.0, 106.0, 0.0, -11.0, 43.0, -110.0, -24.0, -25.0, -151.0, -26.0, 59.0, -80.0, 73.0, 21.0, -70.0, 66.0, 8.0, -98.0, -65.0, 15.0, -21.0, 7.0, 26.0, -180.0, 40.0, -36.0, 27.0, 132.0, -70.0, 0.0, 4.0, -82.0, 4.0, -273.0, -84.0, 76.0, 92.0, 0.0, 11.0, -99.0, 0.0, 0.0, 19.0, -39.0, -64.0, 0.0, -43.0, -83.0, -44.0, -30.0, -230.0, 36.0, -112.0, 0.0, 102.0, 0.0, -114.0, 97.0, 87.0, 0.0, 108.0, 12.0, -90.0, -90.0, 0.0, 90.0, 27.0, -116.0, 31.0, 1.0, 87.0, 52.0, 43.0, -298.0, -126.0, -52.0, 3.0, 179.0, 51.0, -245.0, -24.0, 19.0, -5.0, 39.0, 7.0, -30.0, 72.0, -346.0, -49.0, -208.0, -8.0, 14.0, 23.0, 65.0, -10.0, -141.0, -64.0, 2.0, 0.0, 6.0, 0.0, -46.0, -56.0, -25.0, 41.0, 127.0, -20.0, 12.0, -46.0, 0.0, 78.0, -108.0, -24.0, 39.0, 164.0, 0.0, 8.0, -4.0, 64.0, 8.0, -8.0, 0.0, -2.0, 15.0, 169.0, 81.0, 35.0, 99.0, -16.0, -105.0, -30.0, 66.0, 86.0, -183.0, 102.0, -151.0, -184.0, 3.0, 14.0, -31.0, -129.0, -39.0, -50.0, -136.0, 85.0, -102.0, -85.0, -1.0, -8.0, -113.0, -176.0, -346.0, 5.0, -228.0, 2.0, -4.0, 50.0, -232.0, 0.0, 12.0, 0.0, 0.0, -255.0, -36.0, 0.0, -60.0, 0.0, 36.0, -107.0, 17.0, -47.0, 0.0, -12.0, 0.0, 58.0, -72.0, 0.0, 9.0, 126.0, -4.0, -107.0, 60.0, -60.0, -79.0, 0.0, 32.0, 0.0, -80.0, 44.0, 19.0, 63.0, 49.0, 0.0, -50.0], "policy_predator_policy_reward": [112.0, 33.0, 37.0, 84.0, 0.0, 123.0, 51.0, 18.0, 11.0, 0.0, 41.0, 14.0, 12.0, 13.0, 66.0, 32.0, 0.0, 70.0, 33.0, 8.0, 0.0, 38.0, 49.0, 0.0, 14.0, 43.0, 42.0, 8.0, 28.0, 62.0, 17.0, 57.0, 7.0, 0.0, 35.0, 0.0, 44.0, 0.0, 65.0, 127.0, 42.0, 22.0, 0.0, 0.0, 68.0, 27.0, 0.0, 0.0, 0.0, 25.0, 17.0, 21.0, 54.0, 66.0, 26.0, 24.0, 119.0, 46.0, 22.0, 41.0, 2.0, 0.0, 36.0, 31.0, 0.0, 0.0, 2.0, 0.0, 0.0, 98.0, 0.0, 0.0, 59.0, 0.0, 0.0, 0.0, 0.0, 1.0, 153.0, 2.0, 6.0, 109.0, 0.0, 0.0, 124.0, 39.0, 12.0, 0.0, 41.0, 0.0, 73.0, 0.0, 0.0, 173.0, 0.0, 142.0, 0.0, 39.0, 14.0, 11.0, 99.0, 9.0, 32.0, 0.0, 0.0, 0.0, 46.0, 0.0, 62.0, 25.0, 1.0, 25.0, 42.0, 34.0, 5.0, 18.0, 55.0, 16.0, 12.0, 0.0, 0.0, 0.0, 9.0, 0.0, 10.0, 7.0, 4.0, 14.0, 1.0, 18.0, 1.0, 3.0, 0.0, 29.0, 68.0, 8.0, 75.0, 4.0, 115.0, 23.0, 93.0, 0.0, 94.0, 26.0, 2.0, 26.0, 71.0, 23.0, 68.0, 45.0, 69.0, 0.0, 70.0, 0.0, 65.0, 0.0, 55.0, 217.0, 116.0, 0.0, 2.0, 0.0, 71.0, 62.0, 0.0, 0.0, 0.0, 0.0, 86.0, 88.0, 43.0, 18.0, 0.0, 21.0, 59.0, 33.0, 27.0, 0.0, 0.0, 6.0, 36.0, 0.0, 0.0, 0.0, 2.0, 0.0, 83.0, 0.0, 44.0, 31.0, 2.0, 12.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 2.0, 25.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5227057745185915, "mean_inference_ms": 5.699173607134657, "mean_action_processing_ms": 0.8654679949812154, "mean_env_wait_ms": 0.8159204182184644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012764692306518555, "StateBufferConnector_ms": 0.0069991350173950195, "ViewRequirementAgentConnector_ms": 0.2913846969604492}, "num_episodes": 18, "episode_return_max": 254.0, "episode_return_min": -250.0, "episode_return_mean": 14.62, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 244.55481880706566, "num_env_steps_trained_throughput_per_sec": 244.55481880706566, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 30641.195, "restore_workers_time_ms": 0.048, "training_step_time_ms": 30641.054, "sample_time_ms": 3994.494, "learn_time_ms": 26618.423, "learn_throughput": 150.272, "synch_weights_time_ms": 22.542}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "45bed_00000", "date": "2024-08-13_01-15-31", "timestamp": 1723526131, "time_this_iter_s": 16.41474413871765, "time_total_s": 322.16008400917053, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3306b7a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 322.16008400917053, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 64.3521739130435, "ram_util_percent": 83.56521739130434}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2709186883791099, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6236766834107654, "policy_loss": -0.0032593635438138216, "vf_loss": 3.62661057035759, "vf_explained_var": 0.00034047100279066295, "kl": 0.013019358983753237, "entropy": 1.5340870146398191, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.611569727929654, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.910047428191654, "policy_loss": -0.0026447972433060094, "vf_loss": 6.91268279590304, "vf_explained_var": 0.021410980174150416, "kl": 0.006026852130037181, "entropy": 1.5851823249191204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 254.0, "episode_reward_min": -250.0, "episode_reward_mean": 8.27, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -346.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.0, "predator_policy": 217.0}, "policy_reward_mean": {"prey_policy": -26.355, "predator_policy": 30.49}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, -77.0, 56.0, 92.0, 7.0, 0.0, 5.0, -26.0, -6.0, -24.0, -29.0, -49.0, 104.0, 50.0, 87.0, 122.0, -82.0, 90.0, -30.0, 32.0, 140.0, -100.0, -63.0, 182.0, -31.0, 7.0, 75.0, 50.0, -101.0, -115.0, 45.0, 113.0, -43.0, -30.0, 6.0, 0.0, 6.0, 194.0, 68.0, -23.0, 41.0, 27.0, 164.0, 13.0, 89.0, 10.0, 32.0, 254.0, 163.0, -45.0, 115.0, 41.0, 44.0, -61.0, 11.0, -74.0, -73.0, 52.0, -16.0, -56.0, -250.0, -107.0, 0.0, -49.0, 12.0, 0.0, -117.0, 1.0, 57.0, 2.0, -20.0, -6.0, 22.0, 9.0, 124.0, 36.0, -64.0, 46.0, -40.0, 63.0, 112.0, -23.0, -10.0, 5.0, 105.0, -17.0, -206.0, -42.0, -70.0, 21.0, -67.0, 60.0, -27.0, -9.0, 82.0, -39.0, -93.0, 74.0, -29.0, -118.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [4.0, -82.0, 4.0, -273.0, -84.0, 76.0, 92.0, 0.0, 11.0, -99.0, 0.0, 0.0, 19.0, -39.0, -64.0, 0.0, -43.0, -83.0, -44.0, -30.0, -230.0, 36.0, -112.0, 0.0, 102.0, 0.0, -114.0, 97.0, 87.0, 0.0, 108.0, 12.0, -90.0, -90.0, 0.0, 90.0, 27.0, -116.0, 31.0, 1.0, 87.0, 52.0, 43.0, -298.0, -126.0, -52.0, 3.0, 179.0, 51.0, -245.0, -24.0, 19.0, -5.0, 39.0, 7.0, -30.0, 72.0, -346.0, -49.0, -208.0, -8.0, 14.0, 23.0, 65.0, -10.0, -141.0, -64.0, 2.0, 0.0, 6.0, 0.0, -46.0, -56.0, -25.0, 41.0, 127.0, -20.0, 12.0, -46.0, 0.0, 78.0, -108.0, -24.0, 39.0, 164.0, 0.0, 8.0, -4.0, 64.0, 8.0, -8.0, 0.0, -2.0, 15.0, 169.0, 81.0, 35.0, 99.0, -16.0, -105.0, -30.0, 66.0, 86.0, -183.0, 102.0, -151.0, -184.0, 3.0, 14.0, -31.0, -129.0, -39.0, -50.0, -136.0, 85.0, -102.0, -85.0, -1.0, -8.0, -113.0, -176.0, -346.0, 5.0, -228.0, 2.0, -4.0, 50.0, -232.0, 0.0, 12.0, 0.0, 0.0, -255.0, -36.0, 0.0, -60.0, 0.0, 36.0, -107.0, 17.0, -47.0, 0.0, -12.0, 0.0, 58.0, -72.0, 0.0, 9.0, 126.0, -4.0, -107.0, 60.0, -60.0, -79.0, 0.0, 32.0, 0.0, -80.0, 44.0, 19.0, 63.0, 49.0, 0.0, -50.0, -102.0, 16.0, 39.0, -97.0, 105.0, 0.0, -52.0, 0.0, -102.0, -296.0, -2.0, -118.0, -98.0, -46.0, 2.0, 19.0, 43.0, -256.0, 60.0, 0.0, -122.0, 3.0, -19.0, -5.0, -17.0, 29.0, -111.0, -29.0, -149.0, -145.0, 31.0, 43.0, 2.0, -96.0, -86.0, -196.0], "policy_predator_policy_reward": [44.0, 0.0, 65.0, 127.0, 42.0, 22.0, 0.0, 0.0, 68.0, 27.0, 0.0, 0.0, 0.0, 25.0, 17.0, 21.0, 54.0, 66.0, 26.0, 24.0, 119.0, 46.0, 22.0, 41.0, 2.0, 0.0, 36.0, 31.0, 0.0, 0.0, 2.0, 0.0, 0.0, 98.0, 0.0, 0.0, 59.0, 0.0, 0.0, 0.0, 0.0, 1.0, 153.0, 2.0, 6.0, 109.0, 0.0, 0.0, 124.0, 39.0, 12.0, 0.0, 41.0, 0.0, 73.0, 0.0, 0.0, 173.0, 0.0, 142.0, 0.0, 39.0, 14.0, 11.0, 99.0, 9.0, 32.0, 0.0, 0.0, 0.0, 46.0, 0.0, 62.0, 25.0, 1.0, 25.0, 42.0, 34.0, 5.0, 18.0, 55.0, 16.0, 12.0, 0.0, 0.0, 0.0, 9.0, 0.0, 10.0, 7.0, 4.0, 14.0, 1.0, 18.0, 1.0, 3.0, 0.0, 29.0, 68.0, 8.0, 75.0, 4.0, 115.0, 23.0, 93.0, 0.0, 94.0, 26.0, 2.0, 26.0, 71.0, 23.0, 68.0, 45.0, 69.0, 0.0, 70.0, 0.0, 65.0, 0.0, 55.0, 217.0, 116.0, 0.0, 2.0, 0.0, 71.0, 62.0, 0.0, 0.0, 0.0, 0.0, 86.0, 88.0, 43.0, 18.0, 0.0, 21.0, 59.0, 33.0, 27.0, 0.0, 0.0, 6.0, 36.0, 0.0, 0.0, 0.0, 2.0, 0.0, 83.0, 0.0, 44.0, 31.0, 2.0, 12.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 2.0, 25.0, 64.0, 12.0, 50.0, 13.0, 0.0, 0.0, 0.0, 35.0, 151.0, 41.0, 19.0, 59.0, 31.0, 43.0, 0.0, 0.0, 18.0, 128.0, 0.0, 0.0, 0.0, 92.0, 15.0, 0.0, 23.0, 47.0, 31.0, 70.0, 163.0, 38.0, 0.0, 0.0, 24.0, 41.0, 126.0, 38.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5267043669334788, "mean_inference_ms": 5.548676614891494, "mean_action_processing_ms": 0.8341782539321408, "mean_env_wait_ms": 0.7809941867898914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012856721878051758, "StateBufferConnector_ms": 0.007251381874084473, "ViewRequirementAgentConnector_ms": 0.30265283584594727}, "num_episodes": 18, "episode_return_max": 254.0, "episode_return_min": -250.0, "episode_return_mean": 8.27, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.4156943863586, "num_env_steps_trained_throughput_per_sec": 264.4156943863586, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 31057.068, "restore_workers_time_ms": 0.046, "training_step_time_ms": 31056.943, "sample_time_ms": 4142.603, "learn_time_ms": 26886.736, "learn_throughput": 148.772, "synch_weights_time_ms": 22.33}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "45bed_00000", "date": "2024-08-13_01-15-46", "timestamp": 1723526146, "time_this_iter_s": 15.198418378829956, "time_total_s": 337.3585023880005, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33071c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 337.3585023880005, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 63.2409090909091, "ram_util_percent": 83.26363636363635}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2523900265928614, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9008423671520576, "policy_loss": -0.0009373134502244216, "vf_loss": 1.9016481365160967, "vf_explained_var": 0.002922568781666024, "kl": 0.005261819931642729, "entropy": 1.5011405736681014, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.454661732888411, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.5411771123371425, "policy_loss": -0.002190889442024171, "vf_loss": 5.543361818475067, "vf_explained_var": 0.049672061961794654, "kl": 0.003959468966120727, "entropy": 1.5748227846054803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 254.0, "episode_reward_min": -250.0, "episode_reward_mean": 11.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -346.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.0, "predator_policy": 217.0}, "policy_reward_mean": {"prey_policy": -24.975, "predator_policy": 30.615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.0, 32.0, 140.0, -100.0, -63.0, 182.0, -31.0, 7.0, 75.0, 50.0, -101.0, -115.0, 45.0, 113.0, -43.0, -30.0, 6.0, 0.0, 6.0, 194.0, 68.0, -23.0, 41.0, 27.0, 164.0, 13.0, 89.0, 10.0, 32.0, 254.0, 163.0, -45.0, 115.0, 41.0, 44.0, -61.0, 11.0, -74.0, -73.0, 52.0, -16.0, -56.0, -250.0, -107.0, 0.0, -49.0, 12.0, 0.0, -117.0, 1.0, 57.0, 2.0, -20.0, -6.0, 22.0, 9.0, 124.0, 36.0, -64.0, 46.0, -40.0, 63.0, 112.0, -23.0, -10.0, 5.0, 105.0, -17.0, -206.0, -42.0, -70.0, 21.0, -67.0, 60.0, -27.0, -9.0, 82.0, -39.0, -93.0, 74.0, -29.0, -118.0, -53.0, -2.0, 90.0, 8.0, 8.0, 144.0, 3.0, -7.0, 72.0, -24.0, 74.0, 51.0, 16.0, 126.0, -97.0, 35.0, 98.0, 45.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [27.0, -116.0, 31.0, 1.0, 87.0, 52.0, 43.0, -298.0, -126.0, -52.0, 3.0, 179.0, 51.0, -245.0, -24.0, 19.0, -5.0, 39.0, 7.0, -30.0, 72.0, -346.0, -49.0, -208.0, -8.0, 14.0, 23.0, 65.0, -10.0, -141.0, -64.0, 2.0, 0.0, 6.0, 0.0, -46.0, -56.0, -25.0, 41.0, 127.0, -20.0, 12.0, -46.0, 0.0, 78.0, -108.0, -24.0, 39.0, 164.0, 0.0, 8.0, -4.0, 64.0, 8.0, -8.0, 0.0, -2.0, 15.0, 169.0, 81.0, 35.0, 99.0, -16.0, -105.0, -30.0, 66.0, 86.0, -183.0, 102.0, -151.0, -184.0, 3.0, 14.0, -31.0, -129.0, -39.0, -50.0, -136.0, 85.0, -102.0, -85.0, -1.0, -8.0, -113.0, -176.0, -346.0, 5.0, -228.0, 2.0, -4.0, 50.0, -232.0, 0.0, 12.0, 0.0, 0.0, -255.0, -36.0, 0.0, -60.0, 0.0, 36.0, -107.0, 17.0, -47.0, 0.0, -12.0, 0.0, 58.0, -72.0, 0.0, 9.0, 126.0, -4.0, -107.0, 60.0, -60.0, -79.0, 0.0, 32.0, 0.0, -80.0, 44.0, 19.0, 63.0, 49.0, 0.0, -50.0, -102.0, 16.0, 39.0, -97.0, 105.0, 0.0, -52.0, 0.0, -102.0, -296.0, -2.0, -118.0, -98.0, -46.0, 2.0, 19.0, 43.0, -256.0, 60.0, 0.0, -122.0, 3.0, -19.0, -5.0, -17.0, 29.0, -111.0, -29.0, -149.0, -145.0, 31.0, 43.0, 2.0, -96.0, -86.0, -196.0, -167.0, -6.0, -35.0, -32.0, 68.0, -35.0, -124.0, 62.0, 41.0, -76.0, 58.0, 61.0, 72.0, -173.0, -64.0, 13.0, -33.0, 34.0, 0.0, -144.0, -78.0, 92.0, 30.0, 21.0, -76.0, -11.0, -24.0, 130.0, -168.0, -35.0, 35.0, 0.0, 13.0, 61.0, -22.0, 49.0], "policy_predator_policy_reward": [59.0, 0.0, 0.0, 0.0, 0.0, 1.0, 153.0, 2.0, 6.0, 109.0, 0.0, 0.0, 124.0, 39.0, 12.0, 0.0, 41.0, 0.0, 73.0, 0.0, 0.0, 173.0, 0.0, 142.0, 0.0, 39.0, 14.0, 11.0, 99.0, 9.0, 32.0, 0.0, 0.0, 0.0, 46.0, 0.0, 62.0, 25.0, 1.0, 25.0, 42.0, 34.0, 5.0, 18.0, 55.0, 16.0, 12.0, 0.0, 0.0, 0.0, 9.0, 0.0, 10.0, 7.0, 4.0, 14.0, 1.0, 18.0, 1.0, 3.0, 0.0, 29.0, 68.0, 8.0, 75.0, 4.0, 115.0, 23.0, 93.0, 0.0, 94.0, 26.0, 2.0, 26.0, 71.0, 23.0, 68.0, 45.0, 69.0, 0.0, 70.0, 0.0, 65.0, 0.0, 55.0, 217.0, 116.0, 0.0, 2.0, 0.0, 71.0, 62.0, 0.0, 0.0, 0.0, 0.0, 86.0, 88.0, 43.0, 18.0, 0.0, 21.0, 59.0, 33.0, 27.0, 0.0, 0.0, 6.0, 36.0, 0.0, 0.0, 0.0, 2.0, 0.0, 83.0, 0.0, 44.0, 31.0, 2.0, 12.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 2.0, 25.0, 64.0, 12.0, 50.0, 13.0, 0.0, 0.0, 0.0, 35.0, 151.0, 41.0, 19.0, 59.0, 31.0, 43.0, 0.0, 0.0, 18.0, 128.0, 0.0, 0.0, 0.0, 92.0, 15.0, 0.0, 23.0, 47.0, 31.0, 70.0, 163.0, 38.0, 0.0, 0.0, 24.0, 41.0, 126.0, 38.0, 12.0, 108.0, 48.0, 17.0, 57.0, 0.0, 0.0, 70.0, 43.0, 0.0, 25.0, 0.0, 104.0, 0.0, 0.0, 44.0, 55.0, 16.0, 77.0, 43.0, 39.0, 21.0, 0.0, 0.0, 0.0, 103.0, 20.0, 0.0, 94.0, 12.0, 0.0, 0.0, 0.0, 24.0, 18.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5181807798891191, "mean_inference_ms": 5.428029544816841, "mean_action_processing_ms": 0.8084970308929472, "mean_env_wait_ms": 0.752498246655598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011773228645324707, "StateBufferConnector_ms": 0.006830811500549316, "ViewRequirementAgentConnector_ms": 0.2939598560333252}, "num_episodes": 18, "episode_return_max": 254.0, "episode_return_min": -250.0, "episode_return_mean": 11.28, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.27527113733146, "num_env_steps_trained_throughput_per_sec": 277.27527113733146, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 31384.218, "restore_workers_time_ms": 0.046, "training_step_time_ms": 31384.093, "sample_time_ms": 4219.049, "learn_time_ms": 27136.065, "learn_throughput": 147.405, "synch_weights_time_ms": 23.656}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "45bed_00000", "date": "2024-08-13_01-16-01", "timestamp": 1723526161, "time_this_iter_s": 14.462703943252563, "time_total_s": 351.82120633125305, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33071d0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 351.82120633125305, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 58.374999999999986, "ram_util_percent": 83.46000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2748013910615728, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.199062687316269, "policy_loss": -0.003782078829746713, "vf_loss": 2.2023879145819043, "vf_explained_var": 0.0052177437083431024, "kl": 0.01827395435765666, "entropy": 1.521788411228745, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.556056765265881, "cur_kl_coeff": 0.00078125, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.400019576183703, "policy_loss": -0.0016897352115453157, "vf_loss": 5.401705913064341, "vf_explained_var": 0.052041561609853515, "kl": 0.004364640674734067, "entropy": 1.5535679054007958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 268.0, "episode_reward_min": -250.0, "episode_reward_mean": 20.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -346.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 176.0, "predator_policy": 217.0}, "policy_reward_mean": {"prey_policy": -17.815, "predator_policy": 27.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 32.0, 254.0, 163.0, -45.0, 115.0, 41.0, 44.0, -61.0, 11.0, -74.0, -73.0, 52.0, -16.0, -56.0, -250.0, -107.0, 0.0, -49.0, 12.0, 0.0, -117.0, 1.0, 57.0, 2.0, -20.0, -6.0, 22.0, 9.0, 124.0, 36.0, -64.0, 46.0, -40.0, 63.0, 112.0, -23.0, -10.0, 5.0, 105.0, -17.0, -206.0, -42.0, -70.0, 21.0, -67.0, 60.0, -27.0, -9.0, 82.0, -39.0, -93.0, 74.0, -29.0, -118.0, -53.0, -2.0, 90.0, 8.0, 8.0, 144.0, 3.0, -7.0, 72.0, -24.0, 74.0, 51.0, 16.0, 126.0, -97.0, 35.0, 98.0, 45.0, 128.0, -185.0, 176.0, -8.0, 47.0, 88.0, 46.0, 37.0, -10.0, 41.0, 99.0, -4.0, 135.0, -44.0, 148.0, 193.0, 32.0, 80.0, 157.0, 106.0, 92.0, -146.0, -77.0, 96.0, 34.0, 268.0, 91.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.0, 0.0, -2.0, 15.0, 169.0, 81.0, 35.0, 99.0, -16.0, -105.0, -30.0, 66.0, 86.0, -183.0, 102.0, -151.0, -184.0, 3.0, 14.0, -31.0, -129.0, -39.0, -50.0, -136.0, 85.0, -102.0, -85.0, -1.0, -8.0, -113.0, -176.0, -346.0, 5.0, -228.0, 2.0, -4.0, 50.0, -232.0, 0.0, 12.0, 0.0, 0.0, -255.0, -36.0, 0.0, -60.0, 0.0, 36.0, -107.0, 17.0, -47.0, 0.0, -12.0, 0.0, 58.0, -72.0, 0.0, 9.0, 126.0, -4.0, -107.0, 60.0, -60.0, -79.0, 0.0, 32.0, 0.0, -80.0, 44.0, 19.0, 63.0, 49.0, 0.0, -50.0, -102.0, 16.0, 39.0, -97.0, 105.0, 0.0, -52.0, 0.0, -102.0, -296.0, -2.0, -118.0, -98.0, -46.0, 2.0, 19.0, 43.0, -256.0, 60.0, 0.0, -122.0, 3.0, -19.0, -5.0, -17.0, 29.0, -111.0, -29.0, -149.0, -145.0, 31.0, 43.0, 2.0, -96.0, -86.0, -196.0, -167.0, -6.0, -35.0, -32.0, 68.0, -35.0, -124.0, 62.0, 41.0, -76.0, 58.0, 61.0, 72.0, -173.0, -64.0, 13.0, -33.0, 34.0, 0.0, -144.0, -78.0, 92.0, 30.0, 21.0, -76.0, -11.0, -24.0, 130.0, -168.0, -35.0, 35.0, 0.0, 13.0, 61.0, -22.0, 49.0, 69.0, 56.0, -178.0, -139.0, 0.0, 176.0, -23.0, 2.0, 1.0, 5.0, 0.0, 51.0, 11.0, 35.0, 17.0, 9.0, -198.0, 56.0, 0.0, 31.0, -6.0, 81.0, 0.0, -8.0, 7.0, 103.0, -149.0, 0.0, 128.0, -25.0, 105.0, 80.0, 32.0, 0.0, 55.0, 18.0, 0.0, 157.0, 106.0, 0.0, 87.0, 5.0, -34.0, -256.0, -86.0, -101.0, -51.0, 52.0, 33.0, 0.0, 85.0, 153.0, 47.0, 44.0], "policy_predator_policy_reward": [4.0, 14.0, 1.0, 18.0, 1.0, 3.0, 0.0, 29.0, 68.0, 8.0, 75.0, 4.0, 115.0, 23.0, 93.0, 0.0, 94.0, 26.0, 2.0, 26.0, 71.0, 23.0, 68.0, 45.0, 69.0, 0.0, 70.0, 0.0, 65.0, 0.0, 55.0, 217.0, 116.0, 0.0, 2.0, 0.0, 71.0, 62.0, 0.0, 0.0, 0.0, 0.0, 86.0, 88.0, 43.0, 18.0, 0.0, 21.0, 59.0, 33.0, 27.0, 0.0, 0.0, 6.0, 36.0, 0.0, 0.0, 0.0, 2.0, 0.0, 83.0, 0.0, 44.0, 31.0, 2.0, 12.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 2.0, 25.0, 64.0, 12.0, 50.0, 13.0, 0.0, 0.0, 0.0, 35.0, 151.0, 41.0, 19.0, 59.0, 31.0, 43.0, 0.0, 0.0, 18.0, 128.0, 0.0, 0.0, 0.0, 92.0, 15.0, 0.0, 23.0, 47.0, 31.0, 70.0, 163.0, 38.0, 0.0, 0.0, 24.0, 41.0, 126.0, 38.0, 12.0, 108.0, 48.0, 17.0, 57.0, 0.0, 0.0, 70.0, 43.0, 0.0, 25.0, 0.0, 104.0, 0.0, 0.0, 44.0, 55.0, 16.0, 77.0, 43.0, 39.0, 21.0, 0.0, 0.0, 0.0, 103.0, 20.0, 0.0, 94.0, 12.0, 0.0, 0.0, 0.0, 24.0, 18.0, 0.0, 0.0, 3.0, 108.0, 24.0, 0.0, 0.0, 13.0, 0.0, 21.0, 20.0, 0.0, 37.0, 0.0, 0.0, 0.0, 11.0, 81.0, 51.0, 0.0, 10.0, 3.0, 21.0, 0.0, 4.0, 9.0, 16.0, 81.0, 24.0, 2.0, 43.0, 8.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 135.0, 62.0, 48.0, 38.0, 57.0, 0.0, 1.0, 18.0, 12.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5217529275514383, "mean_inference_ms": 5.130591256423392, "mean_action_processing_ms": 0.8073085653086771, "mean_env_wait_ms": 0.708225487216643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008211731910705566, "StateBufferConnector_ms": 0.007227420806884766, "ViewRequirementAgentConnector_ms": 0.22447562217712402}, "num_episodes": 27, "episode_return_max": 268.0, "episode_return_min": -250.0, "episode_return_mean": 20.32, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.18214057937095, "num_env_steps_trained_throughput_per_sec": 251.18214057937095, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 31587.002, "restore_workers_time_ms": 0.046, "training_step_time_ms": 31586.877, "sample_time_ms": 4292.318, "learn_time_ms": 27265.658, "learn_throughput": 146.705, "synch_weights_time_ms": 24.137}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "45bed_00000", "date": "2024-08-13_01-16-17", "timestamp": 1723526177, "time_this_iter_s": 15.971385955810547, "time_total_s": 367.7925922870636, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33073cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 367.7925922870636, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 65.75652173913043, "ram_util_percent": 83.28260869565216}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2559522895723897, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.598765006961015, "policy_loss": -0.00259931781242981, "vf_loss": 1.6012159564507702, "vf_explained_var": 0.010650439647139695, "kl": 0.005934674075845196, "entropy": 1.5362629315209768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6023306856907549, "cur_kl_coeff": 0.000390625, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.262996078168274, "policy_loss": -0.0034987646524631787, "vf_loss": 5.266492212890948, "vf_explained_var": 0.09128129526420876, "kl": 0.006758937857391556, "entropy": 1.5140107448769624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 268.0, "episode_reward_min": -206.0, "episode_reward_mean": 36.64, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -296.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 176.0, "predator_policy": 163.0}, "policy_reward_mean": {"prey_policy": -4.89, "predator_policy": 23.21}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.0, 12.0, 0.0, -117.0, 1.0, 57.0, 2.0, -20.0, -6.0, 22.0, 9.0, 124.0, 36.0, -64.0, 46.0, -40.0, 63.0, 112.0, -23.0, -10.0, 5.0, 105.0, -17.0, -206.0, -42.0, -70.0, 21.0, -67.0, 60.0, -27.0, -9.0, 82.0, -39.0, -93.0, 74.0, -29.0, -118.0, -53.0, -2.0, 90.0, 8.0, 8.0, 144.0, 3.0, -7.0, 72.0, -24.0, 74.0, 51.0, 16.0, 126.0, -97.0, 35.0, 98.0, 45.0, 128.0, -185.0, 176.0, -8.0, 47.0, 88.0, 46.0, 37.0, -10.0, 41.0, 99.0, -4.0, 135.0, -44.0, 148.0, 193.0, 32.0, 80.0, 157.0, 106.0, 92.0, -146.0, -77.0, 96.0, 34.0, 268.0, 91.0, -65.0, -33.0, 12.0, 0.0, 50.0, 197.0, 231.0, 125.0, 152.0, 123.0, 0.0, 125.0, 191.0, 135.0, 59.0, 200.0, 16.0, 154.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [50.0, -232.0, 0.0, 12.0, 0.0, 0.0, -255.0, -36.0, 0.0, -60.0, 0.0, 36.0, -107.0, 17.0, -47.0, 0.0, -12.0, 0.0, 58.0, -72.0, 0.0, 9.0, 126.0, -4.0, -107.0, 60.0, -60.0, -79.0, 0.0, 32.0, 0.0, -80.0, 44.0, 19.0, 63.0, 49.0, 0.0, -50.0, -102.0, 16.0, 39.0, -97.0, 105.0, 0.0, -52.0, 0.0, -102.0, -296.0, -2.0, -118.0, -98.0, -46.0, 2.0, 19.0, 43.0, -256.0, 60.0, 0.0, -122.0, 3.0, -19.0, -5.0, -17.0, 29.0, -111.0, -29.0, -149.0, -145.0, 31.0, 43.0, 2.0, -96.0, -86.0, -196.0, -167.0, -6.0, -35.0, -32.0, 68.0, -35.0, -124.0, 62.0, 41.0, -76.0, 58.0, 61.0, 72.0, -173.0, -64.0, 13.0, -33.0, 34.0, 0.0, -144.0, -78.0, 92.0, 30.0, 21.0, -76.0, -11.0, -24.0, 130.0, -168.0, -35.0, 35.0, 0.0, 13.0, 61.0, -22.0, 49.0, 69.0, 56.0, -178.0, -139.0, 0.0, 176.0, -23.0, 2.0, 1.0, 5.0, 0.0, 51.0, 11.0, 35.0, 17.0, 9.0, -198.0, 56.0, 0.0, 31.0, -6.0, 81.0, 0.0, -8.0, 7.0, 103.0, -149.0, 0.0, 128.0, -25.0, 105.0, 80.0, 32.0, 0.0, 55.0, 18.0, 0.0, 157.0, 106.0, 0.0, 87.0, 5.0, -34.0, -256.0, -86.0, -101.0, -51.0, 52.0, 33.0, 0.0, 85.0, 153.0, 47.0, 44.0, -54.0, -77.0, -62.0, -2.0, -87.0, 45.0, 0.0, 0.0, 38.0, -3.0, 58.0, 123.0, 127.0, 94.0, 75.0, 5.0, 48.0, 85.0, 34.0, 89.0, 0.0, 0.0, 75.0, 0.0, 36.0, 130.0, 135.0, 0.0, 62.0, -6.0, 150.0, 31.0, -64.0, -19.0, 30.0, 124.0], "policy_predator_policy_reward": [71.0, 62.0, 0.0, 0.0, 0.0, 0.0, 86.0, 88.0, 43.0, 18.0, 0.0, 21.0, 59.0, 33.0, 27.0, 0.0, 0.0, 6.0, 36.0, 0.0, 0.0, 0.0, 2.0, 0.0, 83.0, 0.0, 44.0, 31.0, 2.0, 12.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 2.0, 25.0, 64.0, 12.0, 50.0, 13.0, 0.0, 0.0, 0.0, 35.0, 151.0, 41.0, 19.0, 59.0, 31.0, 43.0, 0.0, 0.0, 18.0, 128.0, 0.0, 0.0, 0.0, 92.0, 15.0, 0.0, 23.0, 47.0, 31.0, 70.0, 163.0, 38.0, 0.0, 0.0, 24.0, 41.0, 126.0, 38.0, 12.0, 108.0, 48.0, 17.0, 57.0, 0.0, 0.0, 70.0, 43.0, 0.0, 25.0, 0.0, 104.0, 0.0, 0.0, 44.0, 55.0, 16.0, 77.0, 43.0, 39.0, 21.0, 0.0, 0.0, 0.0, 103.0, 20.0, 0.0, 94.0, 12.0, 0.0, 0.0, 0.0, 24.0, 18.0, 0.0, 0.0, 3.0, 108.0, 24.0, 0.0, 0.0, 13.0, 0.0, 21.0, 20.0, 0.0, 37.0, 0.0, 0.0, 0.0, 11.0, 81.0, 51.0, 0.0, 10.0, 3.0, 21.0, 0.0, 4.0, 9.0, 16.0, 81.0, 24.0, 2.0, 43.0, 8.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 135.0, 62.0, 48.0, 38.0, 57.0, 0.0, 1.0, 18.0, 12.0, 0.0, 0.0, 66.0, 0.0, 31.0, 0.0, 54.0, 0.0, 0.0, 0.0, 0.0, 15.0, 8.0, 8.0, 8.0, 2.0, 31.0, 14.0, 18.0, 1.0, 0.0, 0.0, 0.0, 0.0, 24.0, 26.0, 0.0, 25.0, 0.0, 0.0, 3.0, 0.0, 8.0, 11.0, 0.0, 99.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4514841328923456, "mean_inference_ms": 5.053180125544377, "mean_action_processing_ms": 0.7442154937712132, "mean_env_wait_ms": 0.6823966239352782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006597995758056641, "StateBufferConnector_ms": 0.004907369613647461, "ViewRequirementAgentConnector_ms": 0.19165360927581787}, "num_episodes": 18, "episode_return_max": 268.0, "episode_return_min": -206.0, "episode_return_mean": 36.64, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.35383831022733, "num_env_steps_trained_throughput_per_sec": 271.35383831022733, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 30008.159, "restore_workers_time_ms": 0.046, "training_step_time_ms": 30008.036, "sample_time_ms": 2468.331, "learn_time_ms": 27511.25, "learn_throughput": 145.395, "synch_weights_time_ms": 23.746}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "45bed_00000", "date": "2024-08-13_01-16-32", "timestamp": 1723526192, "time_this_iter_s": 14.799715042114258, "time_total_s": 382.59230732917786, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3306b7820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 382.59230732917786, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 61.77142857142857, "ram_util_percent": 83.01904761904761}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3192678442688058, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3497070340252426, "policy_loss": -0.00346877138825163, "vf_loss": 3.352761303684699, "vf_explained_var": 7.486671367019573e-05, "kl": 0.016580142329311535, "entropy": 1.4393336793102285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.037440888465397, "cur_kl_coeff": 0.000390625, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.824463569802582, "policy_loss": -0.005590430029517621, "vf_loss": 5.830051273012918, "vf_explained_var": 0.052180952874440995, "kl": 0.006976125694029092, "entropy": 1.49410262088927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 272.0, "episode_reward_min": -206.0, "episode_reward_mean": 43.66, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -296.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 186.0, "predator_policy": 163.0}, "policy_reward_mean": {"prey_policy": -1.69, "predator_policy": 23.52}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, -10.0, 5.0, 105.0, -17.0, -206.0, -42.0, -70.0, 21.0, -67.0, 60.0, -27.0, -9.0, 82.0, -39.0, -93.0, 74.0, -29.0, -118.0, -53.0, -2.0, 90.0, 8.0, 8.0, 144.0, 3.0, -7.0, 72.0, -24.0, 74.0, 51.0, 16.0, 126.0, -97.0, 35.0, 98.0, 45.0, 128.0, -185.0, 176.0, -8.0, 47.0, 88.0, 46.0, 37.0, -10.0, 41.0, 99.0, -4.0, 135.0, -44.0, 148.0, 193.0, 32.0, 80.0, 157.0, 106.0, 92.0, -146.0, -77.0, 96.0, 34.0, 268.0, 91.0, -65.0, -33.0, 12.0, 0.0, 50.0, 197.0, 231.0, 125.0, 152.0, 123.0, 0.0, 125.0, 191.0, 135.0, 59.0, 200.0, 16.0, 154.0, -2.0, 40.0, 20.0, 82.0, 114.0, 272.0, 10.0, 118.0, -14.0, -102.0, 94.0, 2.0, -7.0, -34.0, -10.0, 67.0, 82.0, 158.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -50.0, -102.0, 16.0, 39.0, -97.0, 105.0, 0.0, -52.0, 0.0, -102.0, -296.0, -2.0, -118.0, -98.0, -46.0, 2.0, 19.0, 43.0, -256.0, 60.0, 0.0, -122.0, 3.0, -19.0, -5.0, -17.0, 29.0, -111.0, -29.0, -149.0, -145.0, 31.0, 43.0, 2.0, -96.0, -86.0, -196.0, -167.0, -6.0, -35.0, -32.0, 68.0, -35.0, -124.0, 62.0, 41.0, -76.0, 58.0, 61.0, 72.0, -173.0, -64.0, 13.0, -33.0, 34.0, 0.0, -144.0, -78.0, 92.0, 30.0, 21.0, -76.0, -11.0, -24.0, 130.0, -168.0, -35.0, 35.0, 0.0, 13.0, 61.0, -22.0, 49.0, 69.0, 56.0, -178.0, -139.0, 0.0, 176.0, -23.0, 2.0, 1.0, 5.0, 0.0, 51.0, 11.0, 35.0, 17.0, 9.0, -198.0, 56.0, 0.0, 31.0, -6.0, 81.0, 0.0, -8.0, 7.0, 103.0, -149.0, 0.0, 128.0, -25.0, 105.0, 80.0, 32.0, 0.0, 55.0, 18.0, 0.0, 157.0, 106.0, 0.0, 87.0, 5.0, -34.0, -256.0, -86.0, -101.0, -51.0, 52.0, 33.0, 0.0, 85.0, 153.0, 47.0, 44.0, -54.0, -77.0, -62.0, -2.0, -87.0, 45.0, 0.0, 0.0, 38.0, -3.0, 58.0, 123.0, 127.0, 94.0, 75.0, 5.0, 48.0, 85.0, 34.0, 89.0, 0.0, 0.0, 75.0, 0.0, 36.0, 130.0, 135.0, 0.0, 62.0, -6.0, 150.0, 31.0, -64.0, -19.0, 30.0, 124.0, -73.0, 0.0, 26.0, -19.0, -73.0, -14.0, 11.0, 71.0, -16.0, 84.0, 186.0, 28.0, 3.0, 0.0, -51.0, 129.0, -28.0, 0.0, -72.0, -132.0, 5.0, 17.0, 3.0, -2.0, -19.0, -98.0, 4.0, -119.0, -20.0, 0.0, 54.0, -21.0, 0.0, 82.0, -65.0, 183.0], "policy_predator_policy_reward": [2.0, 25.0, 64.0, 12.0, 50.0, 13.0, 0.0, 0.0, 0.0, 35.0, 151.0, 41.0, 19.0, 59.0, 31.0, 43.0, 0.0, 0.0, 18.0, 128.0, 0.0, 0.0, 0.0, 92.0, 15.0, 0.0, 23.0, 47.0, 31.0, 70.0, 163.0, 38.0, 0.0, 0.0, 24.0, 41.0, 126.0, 38.0, 12.0, 108.0, 48.0, 17.0, 57.0, 0.0, 0.0, 70.0, 43.0, 0.0, 25.0, 0.0, 104.0, 0.0, 0.0, 44.0, 55.0, 16.0, 77.0, 43.0, 39.0, 21.0, 0.0, 0.0, 0.0, 103.0, 20.0, 0.0, 94.0, 12.0, 0.0, 0.0, 0.0, 24.0, 18.0, 0.0, 0.0, 3.0, 108.0, 24.0, 0.0, 0.0, 13.0, 0.0, 21.0, 20.0, 0.0, 37.0, 0.0, 0.0, 0.0, 11.0, 81.0, 51.0, 0.0, 10.0, 3.0, 21.0, 0.0, 4.0, 9.0, 16.0, 81.0, 24.0, 2.0, 43.0, 8.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 135.0, 62.0, 48.0, 38.0, 57.0, 0.0, 1.0, 18.0, 12.0, 0.0, 0.0, 66.0, 0.0, 31.0, 0.0, 54.0, 0.0, 0.0, 0.0, 0.0, 15.0, 8.0, 8.0, 8.0, 2.0, 31.0, 14.0, 18.0, 1.0, 0.0, 0.0, 0.0, 0.0, 24.0, 26.0, 0.0, 25.0, 0.0, 0.0, 3.0, 0.0, 8.0, 11.0, 0.0, 99.0, 0.0, 0.0, 69.0, 2.0, 22.0, 11.0, 64.0, 43.0, 0.0, 0.0, 8.0, 38.0, 45.0, 13.0, 7.0, 0.0, 27.0, 13.0, 14.0, 0.0, 66.0, 36.0, 66.0, 6.0, 1.0, 0.0, 43.0, 67.0, 81.0, 0.0, 10.0, 0.0, 34.0, 0.0, 0.0, 0.0, 0.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.421688495468598, "mean_inference_ms": 4.91716356043939, "mean_action_processing_ms": 0.7202111441972661, "mean_env_wait_ms": 0.6596012982076858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005868315696716309, "StateBufferConnector_ms": 0.005452394485473633, "ViewRequirementAgentConnector_ms": 0.16464614868164062}, "num_episodes": 18, "episode_return_max": 272.0, "episode_return_min": -206.0, "episode_return_mean": 43.66, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.35610040454344, "num_env_steps_trained_throughput_per_sec": 276.35610040454344, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 30294.085, "restore_workers_time_ms": 0.047, "training_step_time_ms": 30293.96, "sample_time_ms": 2572.347, "learn_time_ms": 27693.325, "learn_throughput": 144.439, "synch_weights_time_ms": 23.532}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "45bed_00000", "date": "2024-08-13_01-16-46", "timestamp": 1723526206, "time_this_iter_s": 14.5380380153656, "time_total_s": 397.13034534454346, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x330621d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 397.13034534454346, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 60.39047619047619, "ram_util_percent": 83.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.35376032394943413, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.528739026362303, "policy_loss": -0.003916181178108134, "vf_loss": 3.5322699833168554, "vf_explained_var": 0.004276036869281183, "kl": 0.01540884739989045, "entropy": 1.3909053967743323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.683874811760332, "cur_kl_coeff": 0.000390625, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.318002658420139, "policy_loss": -0.0006173736641242627, "vf_loss": 7.318618136360532, "vf_explained_var": 0.09057545844839994, "kl": 0.00484490803843806, "entropy": 1.458653917262163, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 281.0, "episode_reward_min": -185.0, "episode_reward_mean": 66.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -256.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.0, "predator_policy": 135.0}, "policy_reward_mean": {"prey_policy": 11.015, "predator_policy": 22.115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-118.0, -53.0, -2.0, 90.0, 8.0, 8.0, 144.0, 3.0, -7.0, 72.0, -24.0, 74.0, 51.0, 16.0, 126.0, -97.0, 35.0, 98.0, 45.0, 128.0, -185.0, 176.0, -8.0, 47.0, 88.0, 46.0, 37.0, -10.0, 41.0, 99.0, -4.0, 135.0, -44.0, 148.0, 193.0, 32.0, 80.0, 157.0, 106.0, 92.0, -146.0, -77.0, 96.0, 34.0, 268.0, 91.0, -65.0, -33.0, 12.0, 0.0, 50.0, 197.0, 231.0, 125.0, 152.0, 123.0, 0.0, 125.0, 191.0, 135.0, 59.0, 200.0, 16.0, 154.0, -2.0, 40.0, 20.0, 82.0, 114.0, 272.0, 10.0, 118.0, -14.0, -102.0, 94.0, 2.0, -7.0, -34.0, -10.0, 67.0, 82.0, 158.0, -148.0, 123.0, 57.0, 124.0, 271.0, 281.0, -24.0, 95.0, 207.0, 8.0, 279.0, 10.0, 219.0, 231.0, 33.0, -4.0, 54.0, 159.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-86.0, -196.0, -167.0, -6.0, -35.0, -32.0, 68.0, -35.0, -124.0, 62.0, 41.0, -76.0, 58.0, 61.0, 72.0, -173.0, -64.0, 13.0, -33.0, 34.0, 0.0, -144.0, -78.0, 92.0, 30.0, 21.0, -76.0, -11.0, -24.0, 130.0, -168.0, -35.0, 35.0, 0.0, 13.0, 61.0, -22.0, 49.0, 69.0, 56.0, -178.0, -139.0, 0.0, 176.0, -23.0, 2.0, 1.0, 5.0, 0.0, 51.0, 11.0, 35.0, 17.0, 9.0, -198.0, 56.0, 0.0, 31.0, -6.0, 81.0, 0.0, -8.0, 7.0, 103.0, -149.0, 0.0, 128.0, -25.0, 105.0, 80.0, 32.0, 0.0, 55.0, 18.0, 0.0, 157.0, 106.0, 0.0, 87.0, 5.0, -34.0, -256.0, -86.0, -101.0, -51.0, 52.0, 33.0, 0.0, 85.0, 153.0, 47.0, 44.0, -54.0, -77.0, -62.0, -2.0, -87.0, 45.0, 0.0, 0.0, 38.0, -3.0, 58.0, 123.0, 127.0, 94.0, 75.0, 5.0, 48.0, 85.0, 34.0, 89.0, 0.0, 0.0, 75.0, 0.0, 36.0, 130.0, 135.0, 0.0, 62.0, -6.0, 150.0, 31.0, -64.0, -19.0, 30.0, 124.0, -73.0, 0.0, 26.0, -19.0, -73.0, -14.0, 11.0, 71.0, -16.0, 84.0, 186.0, 28.0, 3.0, 0.0, -51.0, 129.0, -28.0, 0.0, -72.0, -132.0, 5.0, 17.0, 3.0, -2.0, -19.0, -98.0, 4.0, -119.0, -20.0, 0.0, 54.0, -21.0, 0.0, 82.0, -65.0, 183.0, -80.0, -154.0, -134.0, 190.0, 17.0, 0.0, -20.0, 127.0, 104.0, 127.0, 126.0, 146.0, -170.0, 36.0, -103.0, 140.0, 186.0, -128.0, 8.0, 0.0, 135.0, 132.0, 8.0, 0.0, 121.0, 71.0, 50.0, 143.0, -13.0, -56.0, -55.0, -31.0, -80.0, 74.0, 188.0, -84.0], "policy_predator_policy_reward": [126.0, 38.0, 12.0, 108.0, 48.0, 17.0, 57.0, 0.0, 0.0, 70.0, 43.0, 0.0, 25.0, 0.0, 104.0, 0.0, 0.0, 44.0, 55.0, 16.0, 77.0, 43.0, 39.0, 21.0, 0.0, 0.0, 0.0, 103.0, 20.0, 0.0, 94.0, 12.0, 0.0, 0.0, 0.0, 24.0, 18.0, 0.0, 0.0, 3.0, 108.0, 24.0, 0.0, 0.0, 13.0, 0.0, 21.0, 20.0, 0.0, 37.0, 0.0, 0.0, 0.0, 11.0, 81.0, 51.0, 0.0, 10.0, 3.0, 21.0, 0.0, 4.0, 9.0, 16.0, 81.0, 24.0, 2.0, 43.0, 8.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 135.0, 62.0, 48.0, 38.0, 57.0, 0.0, 1.0, 18.0, 12.0, 0.0, 0.0, 66.0, 0.0, 31.0, 0.0, 54.0, 0.0, 0.0, 0.0, 0.0, 15.0, 8.0, 8.0, 8.0, 2.0, 31.0, 14.0, 18.0, 1.0, 0.0, 0.0, 0.0, 0.0, 24.0, 26.0, 0.0, 25.0, 0.0, 0.0, 3.0, 0.0, 8.0, 11.0, 0.0, 99.0, 0.0, 0.0, 69.0, 2.0, 22.0, 11.0, 64.0, 43.0, 0.0, 0.0, 8.0, 38.0, 45.0, 13.0, 7.0, 0.0, 27.0, 13.0, 14.0, 0.0, 66.0, 36.0, 66.0, 6.0, 1.0, 0.0, 43.0, 67.0, 81.0, 0.0, 10.0, 0.0, 34.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 86.0, 1.0, 66.0, 27.0, 13.0, 7.0, 10.0, 0.0, 40.0, 9.0, 0.0, 18.0, 92.0, 0.0, 58.0, 77.0, 72.0, 0.0, 0.0, 12.0, 0.0, 0.0, 2.0, 0.0, 27.0, 5.0, 33.0, 52.0, 50.0, 77.0, 5.0, 0.0, 60.0, 0.0, 55.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.388190610906621, "mean_inference_ms": 4.78360655482108, "mean_action_processing_ms": 0.696692660542607, "mean_env_wait_ms": 0.6386249383105612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005365252494812012, "StateBufferConnector_ms": 0.004995942115783691, "ViewRequirementAgentConnector_ms": 0.14643847942352295}, "num_episodes": 18, "episode_return_max": 281.0, "episode_return_min": -185.0, "episode_return_mean": 66.26, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.89525242807207, "num_env_steps_trained_throughput_per_sec": 317.89525242807207, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 30278.189, "restore_workers_time_ms": 0.047, "training_step_time_ms": 30278.064, "sample_time_ms": 2566.274, "learn_time_ms": 27683.233, "learn_throughput": 144.492, "synch_weights_time_ms": 23.679}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "45bed_00000", "date": "2024-08-13_01-16-59", "timestamp": 1723526219, "time_this_iter_s": 12.636138916015625, "time_total_s": 409.7664842605591, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3305f3940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 409.7664842605591, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 51.55, "ram_util_percent": 83.02777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3070247817705706, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.809309254121528, "policy_loss": -0.0025297594350324106, "vf_loss": 2.8116004164256747, "vf_explained_var": 0.004006218657922492, "kl": 0.00954388359552957, "entropy": 1.4350757651228123, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5943237312414027, "cur_kl_coeff": 0.0001953125, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.738751431369277, "policy_loss": -0.0032223373799333496, "vf_loss": 6.74197259908, "vf_explained_var": 0.07604620989668306, "kl": 0.006000711215954634, "entropy": 1.4842796217196832, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 356.0, "episode_reward_min": -148.0, "episode_reward_mean": 69.91, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -262.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.0, "predator_policy": 135.0}, "policy_reward_mean": {"prey_policy": 13.635, "predator_policy": 21.32}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.0, 47.0, 88.0, 46.0, 37.0, -10.0, 41.0, 99.0, -4.0, 135.0, -44.0, 148.0, 193.0, 32.0, 80.0, 157.0, 106.0, 92.0, -146.0, -77.0, 96.0, 34.0, 268.0, 91.0, -65.0, -33.0, 12.0, 0.0, 50.0, 197.0, 231.0, 125.0, 152.0, 123.0, 0.0, 125.0, 191.0, 135.0, 59.0, 200.0, 16.0, 154.0, -2.0, 40.0, 20.0, 82.0, 114.0, 272.0, 10.0, 118.0, -14.0, -102.0, 94.0, 2.0, -7.0, -34.0, -10.0, 67.0, 82.0, 158.0, -148.0, 123.0, 57.0, 124.0, 271.0, 281.0, -24.0, 95.0, 207.0, 8.0, 279.0, 10.0, 219.0, 231.0, 33.0, -4.0, 54.0, 159.0, -139.0, -16.0, 176.0, 356.0, 88.0, -104.0, 60.0, 174.0, 82.0, 70.0, 15.0, 122.0, 51.0, 62.0, 14.0, 0.0, -30.0, 23.0, -127.0, 94.0, 14.0, -32.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-23.0, 2.0, 1.0, 5.0, 0.0, 51.0, 11.0, 35.0, 17.0, 9.0, -198.0, 56.0, 0.0, 31.0, -6.0, 81.0, 0.0, -8.0, 7.0, 103.0, -149.0, 0.0, 128.0, -25.0, 105.0, 80.0, 32.0, 0.0, 55.0, 18.0, 0.0, 157.0, 106.0, 0.0, 87.0, 5.0, -34.0, -256.0, -86.0, -101.0, -51.0, 52.0, 33.0, 0.0, 85.0, 153.0, 47.0, 44.0, -54.0, -77.0, -62.0, -2.0, -87.0, 45.0, 0.0, 0.0, 38.0, -3.0, 58.0, 123.0, 127.0, 94.0, 75.0, 5.0, 48.0, 85.0, 34.0, 89.0, 0.0, 0.0, 75.0, 0.0, 36.0, 130.0, 135.0, 0.0, 62.0, -6.0, 150.0, 31.0, -64.0, -19.0, 30.0, 124.0, -73.0, 0.0, 26.0, -19.0, -73.0, -14.0, 11.0, 71.0, -16.0, 84.0, 186.0, 28.0, 3.0, 0.0, -51.0, 129.0, -28.0, 0.0, -72.0, -132.0, 5.0, 17.0, 3.0, -2.0, -19.0, -98.0, 4.0, -119.0, -20.0, 0.0, 54.0, -21.0, 0.0, 82.0, -65.0, 183.0, -80.0, -154.0, -134.0, 190.0, 17.0, 0.0, -20.0, 127.0, 104.0, 127.0, 126.0, 146.0, -170.0, 36.0, -103.0, 140.0, 186.0, -128.0, 8.0, 0.0, 135.0, 132.0, 8.0, 0.0, 121.0, 71.0, 50.0, 143.0, -13.0, -56.0, -55.0, -31.0, -80.0, 74.0, 188.0, -84.0, -56.0, -184.0, 53.0, -164.0, -29.0, 149.0, 150.0, 188.0, 68.0, 20.0, 27.0, -262.0, 22.0, 0.0, 165.0, -18.0, 182.0, -200.0, -21.0, 22.0, 9.0, 6.0, 1.0, 121.0, 13.0, 0.0, 48.0, -2.0, -139.0, 45.0, 0.0, 0.0, -60.0, 0.0, 138.0, -236.0, -187.0, -96.0, 94.0, 0.0, -42.0, 3.0, 0.0, -65.0], "policy_predator_policy_reward": [13.0, 0.0, 21.0, 20.0, 0.0, 37.0, 0.0, 0.0, 0.0, 11.0, 81.0, 51.0, 0.0, 10.0, 3.0, 21.0, 0.0, 4.0, 9.0, 16.0, 81.0, 24.0, 2.0, 43.0, 8.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 135.0, 62.0, 48.0, 38.0, 57.0, 0.0, 1.0, 18.0, 12.0, 0.0, 0.0, 66.0, 0.0, 31.0, 0.0, 54.0, 0.0, 0.0, 0.0, 0.0, 15.0, 8.0, 8.0, 8.0, 2.0, 31.0, 14.0, 18.0, 1.0, 0.0, 0.0, 0.0, 0.0, 24.0, 26.0, 0.0, 25.0, 0.0, 0.0, 3.0, 0.0, 8.0, 11.0, 0.0, 99.0, 0.0, 0.0, 69.0, 2.0, 22.0, 11.0, 64.0, 43.0, 0.0, 0.0, 8.0, 38.0, 45.0, 13.0, 7.0, 0.0, 27.0, 13.0, 14.0, 0.0, 66.0, 36.0, 66.0, 6.0, 1.0, 0.0, 43.0, 67.0, 81.0, 0.0, 10.0, 0.0, 34.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 86.0, 1.0, 66.0, 27.0, 13.0, 7.0, 10.0, 0.0, 40.0, 9.0, 0.0, 18.0, 92.0, 0.0, 58.0, 77.0, 72.0, 0.0, 0.0, 12.0, 0.0, 0.0, 2.0, 0.0, 27.0, 5.0, 33.0, 52.0, 50.0, 77.0, 5.0, 0.0, 60.0, 0.0, 55.0, 0.0, 101.0, 0.0, 95.0, 1.0, 55.0, 0.0, 18.0, 0.0, 0.0, 131.0, 0.0, 0.0, 38.0, 27.0, 0.0, 0.0, 100.0, 69.0, 0.0, 0.0, 0.0, 0.0, 0.0, 38.0, 0.0, 16.0, 0.0, 35.0, 73.0, 0.0, 0.0, 30.0, 0.0, 119.0, 2.0, 78.0, 78.0, 0.0, 0.0, 51.0, 2.0, 0.0, 33.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.356145707171397, "mean_inference_ms": 4.604921352301778, "mean_action_processing_ms": 0.6740744944789526, "mean_env_wait_ms": 0.6399600813628491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005276918411254883, "StateBufferConnector_ms": 0.005447268486022949, "ViewRequirementAgentConnector_ms": 0.13969337940216064}, "num_episodes": 22, "episode_return_max": 356.0, "episode_return_min": -148.0, "episode_return_mean": 69.91, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.07466615554716, "num_env_steps_trained_throughput_per_sec": 307.07466615554716, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 15189.452, "restore_workers_time_ms": 0.047, "training_step_time_ms": 15189.327, "sample_time_ms": 2453.005, "learn_time_ms": 12713.585, "learn_throughput": 314.624, "synch_weights_time_ms": 18.517}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "45bed_00000", "date": "2024-08-13_01-17-12", "timestamp": 1723526232, "time_this_iter_s": 13.059626817703247, "time_total_s": 422.82611107826233, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3306b7820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 422.82611107826233, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 59.638888888888886, "ram_util_percent": 83.40555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4128898900652689, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6840342707104154, "policy_loss": -0.001639448790490706, "vf_loss": 3.6854530388716036, "vf_explained_var": 0.0067609914396175004, "kl": 0.008827175268074932, "entropy": 1.3271481527222528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.075044514010192, "cur_kl_coeff": 0.0001953125, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.542607862987215, "policy_loss": -0.002926647794930629, "vf_loss": 7.545533117163118, "vf_explained_var": 0.08393844911661097, "kl": 0.007154241029926563, "entropy": 1.345946855393667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 381.0, "episode_reward_min": -351.0, "episode_reward_mean": 70.76, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -330.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 169.0}, "policy_reward_mean": {"prey_policy": 10.49, "predator_policy": 24.89}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.0, -65.0, -33.0, 12.0, 0.0, 50.0, 197.0, 231.0, 125.0, 152.0, 123.0, 0.0, 125.0, 191.0, 135.0, 59.0, 200.0, 16.0, 154.0, -2.0, 40.0, 20.0, 82.0, 114.0, 272.0, 10.0, 118.0, -14.0, -102.0, 94.0, 2.0, -7.0, -34.0, -10.0, 67.0, 82.0, 158.0, -148.0, 123.0, 57.0, 124.0, 271.0, 281.0, -24.0, 95.0, 207.0, 8.0, 279.0, 10.0, 219.0, 231.0, 33.0, -4.0, 54.0, 159.0, -139.0, -16.0, 176.0, 356.0, 88.0, -104.0, 60.0, 174.0, 82.0, 70.0, 15.0, 122.0, 51.0, 62.0, 14.0, 0.0, -30.0, 23.0, -127.0, 94.0, 14.0, -32.0, 35.0, 161.0, 66.0, -13.0, 49.0, -68.0, 357.0, -43.0, -56.0, 5.0, 67.0, -351.0, -55.0, 51.0, 219.0, 216.0, 173.0, 146.0, 381.0, 93.0, -233.0, 179.0, 116.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [47.0, 44.0, -54.0, -77.0, -62.0, -2.0, -87.0, 45.0, 0.0, 0.0, 38.0, -3.0, 58.0, 123.0, 127.0, 94.0, 75.0, 5.0, 48.0, 85.0, 34.0, 89.0, 0.0, 0.0, 75.0, 0.0, 36.0, 130.0, 135.0, 0.0, 62.0, -6.0, 150.0, 31.0, -64.0, -19.0, 30.0, 124.0, -73.0, 0.0, 26.0, -19.0, -73.0, -14.0, 11.0, 71.0, -16.0, 84.0, 186.0, 28.0, 3.0, 0.0, -51.0, 129.0, -28.0, 0.0, -72.0, -132.0, 5.0, 17.0, 3.0, -2.0, -19.0, -98.0, 4.0, -119.0, -20.0, 0.0, 54.0, -21.0, 0.0, 82.0, -65.0, 183.0, -80.0, -154.0, -134.0, 190.0, 17.0, 0.0, -20.0, 127.0, 104.0, 127.0, 126.0, 146.0, -170.0, 36.0, -103.0, 140.0, 186.0, -128.0, 8.0, 0.0, 135.0, 132.0, 8.0, 0.0, 121.0, 71.0, 50.0, 143.0, -13.0, -56.0, -55.0, -31.0, -80.0, 74.0, 188.0, -84.0, -56.0, -184.0, 53.0, -164.0, -29.0, 149.0, 150.0, 188.0, 68.0, 20.0, 27.0, -262.0, 22.0, 0.0, 165.0, -18.0, 182.0, -200.0, -21.0, 22.0, 9.0, 6.0, 1.0, 121.0, 13.0, 0.0, 48.0, -2.0, -139.0, 45.0, 0.0, 0.0, -60.0, 0.0, 138.0, -236.0, -187.0, -96.0, 94.0, 0.0, -42.0, 3.0, 0.0, -65.0, -43.0, -6.0, -50.0, 186.0, -50.0, 58.0, 0.0, -116.0, -280.0, 166.0, -1.0, -136.0, 200.0, 157.0, -147.0, 28.0, 33.0, -198.0, 5.0, 0.0, -168.0, 114.0, -202.0, -330.0, 29.0, -216.0, 99.0, -121.0, 95.0, 124.0, 104.0, 64.0, 151.0, 5.0, 137.0, 9.0, 194.0, 181.0, 70.0, -54.0, -116.0, -260.0, 0.0, 174.0, -2.0, 52.0], "policy_predator_policy_reward": [0.0, 0.0, 66.0, 0.0, 31.0, 0.0, 54.0, 0.0, 0.0, 0.0, 0.0, 15.0, 8.0, 8.0, 8.0, 2.0, 31.0, 14.0, 18.0, 1.0, 0.0, 0.0, 0.0, 0.0, 24.0, 26.0, 0.0, 25.0, 0.0, 0.0, 3.0, 0.0, 8.0, 11.0, 0.0, 99.0, 0.0, 0.0, 69.0, 2.0, 22.0, 11.0, 64.0, 43.0, 0.0, 0.0, 8.0, 38.0, 45.0, 13.0, 7.0, 0.0, 27.0, 13.0, 14.0, 0.0, 66.0, 36.0, 66.0, 6.0, 1.0, 0.0, 43.0, 67.0, 81.0, 0.0, 10.0, 0.0, 34.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 86.0, 1.0, 66.0, 27.0, 13.0, 7.0, 10.0, 0.0, 40.0, 9.0, 0.0, 18.0, 92.0, 0.0, 58.0, 77.0, 72.0, 0.0, 0.0, 12.0, 0.0, 0.0, 2.0, 0.0, 27.0, 5.0, 33.0, 52.0, 50.0, 77.0, 5.0, 0.0, 60.0, 0.0, 55.0, 0.0, 101.0, 0.0, 95.0, 1.0, 55.0, 0.0, 18.0, 0.0, 0.0, 131.0, 0.0, 0.0, 38.0, 27.0, 0.0, 0.0, 100.0, 69.0, 0.0, 0.0, 0.0, 0.0, 0.0, 38.0, 0.0, 16.0, 0.0, 35.0, 73.0, 0.0, 0.0, 30.0, 0.0, 119.0, 2.0, 78.0, 78.0, 0.0, 0.0, 51.0, 2.0, 0.0, 33.0, 17.0, 67.0, 25.0, 0.0, 25.0, 33.0, 98.0, 5.0, 54.0, 109.0, 0.0, 69.0, 0.0, 0.0, 22.0, 54.0, 17.0, 92.0, 0.0, 0.0, 0.0, 121.0, 169.0, 12.0, 40.0, 92.0, 19.0, 54.0, 0.0, 0.0, 44.0, 4.0, 15.0, 2.0, 0.0, 0.0, 0.0, 6.0, 77.0, 0.0, 0.0, 143.0, 0.0, 5.0, 0.0, 66.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.315047018248315, "mean_inference_ms": 4.493187669603564, "mean_action_processing_ms": 0.6466825836026286, "mean_env_wait_ms": 0.5951374047367299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006185412406921387, "StateBufferConnector_ms": 0.004702448844909668, "ViewRequirementAgentConnector_ms": 0.1309981346130371}, "num_episodes": 23, "episode_return_max": 381.0, "episode_return_min": -351.0, "episode_return_mean": 70.76, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.04487207249335, "num_env_steps_trained_throughput_per_sec": 204.04487207249335, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 15373.069, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15373.016, "sample_time_ms": 2186.078, "learn_time_ms": 13163.178, "learn_throughput": 303.878, "synch_weights_time_ms": 19.595}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "45bed_00000", "date": "2024-08-13_01-17-32", "timestamp": 1723526252, "time_this_iter_s": 19.672584772109985, "time_total_s": 442.4986958503723, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33062fd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 442.4986958503723, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 80.33571428571429, "ram_util_percent": 83.70000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4573596100682619, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.685651886147797, "policy_loss": -0.004715952532927668, "vf_loss": 3.6900580049191833, "vf_explained_var": 0.014527797919732553, "kl": 0.012393576088410772, "entropy": 1.2637632412254496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.45498987586883, "cur_kl_coeff": 0.0001953125, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.779693890627099, "policy_loss": 0.0020689203321352287, "vf_loss": 7.777623322653392, "vf_explained_var": 0.03394969711228023, "kl": 0.008335329118906467, "entropy": 1.38968377926993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 381.0, "episode_reward_min": -351.0, "episode_reward_mean": 61.37, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -330.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 169.0}, "policy_reward_mean": {"prey_policy": 2.42, "predator_policy": 28.265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [154.0, -2.0, 40.0, 20.0, 82.0, 114.0, 272.0, 10.0, 118.0, -14.0, -102.0, 94.0, 2.0, -7.0, -34.0, -10.0, 67.0, 82.0, 158.0, -148.0, 123.0, 57.0, 124.0, 271.0, 281.0, -24.0, 95.0, 207.0, 8.0, 279.0, 10.0, 219.0, 231.0, 33.0, -4.0, 54.0, 159.0, -139.0, -16.0, 176.0, 356.0, 88.0, -104.0, 60.0, 174.0, 82.0, 70.0, 15.0, 122.0, 51.0, 62.0, 14.0, 0.0, -30.0, 23.0, -127.0, 94.0, 14.0, -32.0, 35.0, 161.0, 66.0, -13.0, 49.0, -68.0, 357.0, -43.0, -56.0, 5.0, 67.0, -351.0, -55.0, 51.0, 219.0, 216.0, 173.0, 146.0, 381.0, 93.0, -233.0, 179.0, 116.0, -58.0, -10.0, 198.0, 148.0, 16.0, 22.0, 40.0, 2.0, 182.0, 88.0, -15.0, 147.0, -101.0, 95.0, 113.0, -113.0, 50.0, -134.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [30.0, 124.0, -73.0, 0.0, 26.0, -19.0, -73.0, -14.0, 11.0, 71.0, -16.0, 84.0, 186.0, 28.0, 3.0, 0.0, -51.0, 129.0, -28.0, 0.0, -72.0, -132.0, 5.0, 17.0, 3.0, -2.0, -19.0, -98.0, 4.0, -119.0, -20.0, 0.0, 54.0, -21.0, 0.0, 82.0, -65.0, 183.0, -80.0, -154.0, -134.0, 190.0, 17.0, 0.0, -20.0, 127.0, 104.0, 127.0, 126.0, 146.0, -170.0, 36.0, -103.0, 140.0, 186.0, -128.0, 8.0, 0.0, 135.0, 132.0, 8.0, 0.0, 121.0, 71.0, 50.0, 143.0, -13.0, -56.0, -55.0, -31.0, -80.0, 74.0, 188.0, -84.0, -56.0, -184.0, 53.0, -164.0, -29.0, 149.0, 150.0, 188.0, 68.0, 20.0, 27.0, -262.0, 22.0, 0.0, 165.0, -18.0, 182.0, -200.0, -21.0, 22.0, 9.0, 6.0, 1.0, 121.0, 13.0, 0.0, 48.0, -2.0, -139.0, 45.0, 0.0, 0.0, -60.0, 0.0, 138.0, -236.0, -187.0, -96.0, 94.0, 0.0, -42.0, 3.0, 0.0, -65.0, -43.0, -6.0, -50.0, 186.0, -50.0, 58.0, 0.0, -116.0, -280.0, 166.0, -1.0, -136.0, 200.0, 157.0, -147.0, 28.0, 33.0, -198.0, 5.0, 0.0, -168.0, 114.0, -202.0, -330.0, 29.0, -216.0, 99.0, -121.0, 95.0, 124.0, 104.0, 64.0, 151.0, 5.0, 137.0, 9.0, 194.0, 181.0, 70.0, -54.0, -116.0, -260.0, 0.0, 174.0, -2.0, 52.0, -15.0, -102.0, -86.0, 27.0, 149.0, -31.0, 58.0, 90.0, 2.0, 10.0, -88.0, 8.0, -13.0, 10.0, 18.0, -72.0, 127.0, 44.0, 30.0, -8.0, -59.0, -29.0, 28.0, 68.0, 5.0, -318.0, 0.0, 95.0, 0.0, 99.0, -222.0, -23.0, -11.0, 54.0, -15.0, -287.0], "policy_predator_policy_reward": [0.0, 0.0, 69.0, 2.0, 22.0, 11.0, 64.0, 43.0, 0.0, 0.0, 8.0, 38.0, 45.0, 13.0, 7.0, 0.0, 27.0, 13.0, 14.0, 0.0, 66.0, 36.0, 66.0, 6.0, 1.0, 0.0, 43.0, 67.0, 81.0, 0.0, 10.0, 0.0, 34.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 86.0, 1.0, 66.0, 27.0, 13.0, 7.0, 10.0, 0.0, 40.0, 9.0, 0.0, 18.0, 92.0, 0.0, 58.0, 77.0, 72.0, 0.0, 0.0, 12.0, 0.0, 0.0, 2.0, 0.0, 27.0, 5.0, 33.0, 52.0, 50.0, 77.0, 5.0, 0.0, 60.0, 0.0, 55.0, 0.0, 101.0, 0.0, 95.0, 1.0, 55.0, 0.0, 18.0, 0.0, 0.0, 131.0, 0.0, 0.0, 38.0, 27.0, 0.0, 0.0, 100.0, 69.0, 0.0, 0.0, 0.0, 0.0, 0.0, 38.0, 0.0, 16.0, 0.0, 35.0, 73.0, 0.0, 0.0, 30.0, 0.0, 119.0, 2.0, 78.0, 78.0, 0.0, 0.0, 51.0, 2.0, 0.0, 33.0, 17.0, 67.0, 25.0, 0.0, 25.0, 33.0, 98.0, 5.0, 54.0, 109.0, 0.0, 69.0, 0.0, 0.0, 22.0, 54.0, 17.0, 92.0, 0.0, 0.0, 0.0, 121.0, 169.0, 12.0, 40.0, 92.0, 19.0, 54.0, 0.0, 0.0, 44.0, 4.0, 15.0, 2.0, 0.0, 0.0, 0.0, 6.0, 77.0, 0.0, 0.0, 143.0, 0.0, 5.0, 0.0, 66.0, 32.0, 27.0, 0.0, 49.0, 44.0, 36.0, 0.0, 0.0, 4.0, 0.0, 99.0, 3.0, 34.0, 9.0, 40.0, 16.0, 11.0, 0.0, 0.0, 66.0, 39.0, 34.0, 31.0, 20.0, 126.0, 86.0, 0.0, 0.0, 0.0, 14.0, 5.0, 127.0, 0.0, 7.0, 168.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.297049247402852, "mean_inference_ms": 4.404797342700593, "mean_action_processing_ms": 0.6319537918921149, "mean_env_wait_ms": 0.5808449814924063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005827546119689941, "StateBufferConnector_ms": 0.005241751670837402, "ViewRequirementAgentConnector_ms": 0.14665615558624268}, "num_episodes": 18, "episode_return_max": 381.0, "episode_return_min": -351.0, "episode_return_mean": 61.37, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 205.096611460566, "num_env_steps_trained_throughput_per_sec": 205.096611460566, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 15576.527, "restore_workers_time_ms": 0.017, "training_step_time_ms": 15576.472, "sample_time_ms": 2192.203, "learn_time_ms": 13362.851, "learn_throughput": 299.337, "synch_weights_time_ms": 18.121}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "45bed_00000", "date": "2024-08-13_01-17-51", "timestamp": 1723526271, "time_this_iter_s": 19.5312922000885, "time_total_s": 462.0299880504608, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33062fee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 462.0299880504608, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 77.88571428571427, "ram_util_percent": 83.61785714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.46423626102152327, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.555001289125473, "policy_loss": -0.0030086055432480795, "vf_loss": 4.557609371533469, "vf_explained_var": 0.012782260539039733, "kl": 0.01602056104882157, "entropy": 1.2022926637735316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.9500166730748285, "cur_kl_coeff": 0.0001953125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.433166398447026, "policy_loss": -0.0027628647499821253, "vf_loss": 8.435927707429917, "vf_explained_var": 0.02310982355995784, "kl": 0.0074964352743476905, "entropy": 1.2542051118517679, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 386.0, "episode_reward_min": -351.0, "episode_reward_mean": 64.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -330.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 169.0}, "policy_reward_mean": {"prey_policy": 0.54, "predator_policy": 31.86}, "custom_metrics": {}, "hist_stats": {"episode_reward": [158.0, -148.0, 123.0, 57.0, 124.0, 271.0, 281.0, -24.0, 95.0, 207.0, 8.0, 279.0, 10.0, 219.0, 231.0, 33.0, -4.0, 54.0, 159.0, -139.0, -16.0, 176.0, 356.0, 88.0, -104.0, 60.0, 174.0, 82.0, 70.0, 15.0, 122.0, 51.0, 62.0, 14.0, 0.0, -30.0, 23.0, -127.0, 94.0, 14.0, -32.0, 35.0, 161.0, 66.0, -13.0, 49.0, -68.0, 357.0, -43.0, -56.0, 5.0, 67.0, -351.0, -55.0, 51.0, 219.0, 216.0, 173.0, 146.0, 381.0, 93.0, -233.0, 179.0, 116.0, -58.0, -10.0, 198.0, 148.0, 16.0, 22.0, 40.0, 2.0, 182.0, 88.0, -15.0, 147.0, -101.0, 95.0, 113.0, -113.0, 50.0, -134.0, 83.0, 29.0, -51.0, 60.0, 146.0, -166.0, 386.0, 322.0, 130.0, 14.0, 73.0, -67.0, 34.0, 210.0, 153.0, -39.0, -77.0, -11.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-65.0, 183.0, -80.0, -154.0, -134.0, 190.0, 17.0, 0.0, -20.0, 127.0, 104.0, 127.0, 126.0, 146.0, -170.0, 36.0, -103.0, 140.0, 186.0, -128.0, 8.0, 0.0, 135.0, 132.0, 8.0, 0.0, 121.0, 71.0, 50.0, 143.0, -13.0, -56.0, -55.0, -31.0, -80.0, 74.0, 188.0, -84.0, -56.0, -184.0, 53.0, -164.0, -29.0, 149.0, 150.0, 188.0, 68.0, 20.0, 27.0, -262.0, 22.0, 0.0, 165.0, -18.0, 182.0, -200.0, -21.0, 22.0, 9.0, 6.0, 1.0, 121.0, 13.0, 0.0, 48.0, -2.0, -139.0, 45.0, 0.0, 0.0, -60.0, 0.0, 138.0, -236.0, -187.0, -96.0, 94.0, 0.0, -42.0, 3.0, 0.0, -65.0, -43.0, -6.0, -50.0, 186.0, -50.0, 58.0, 0.0, -116.0, -280.0, 166.0, -1.0, -136.0, 200.0, 157.0, -147.0, 28.0, 33.0, -198.0, 5.0, 0.0, -168.0, 114.0, -202.0, -330.0, 29.0, -216.0, 99.0, -121.0, 95.0, 124.0, 104.0, 64.0, 151.0, 5.0, 137.0, 9.0, 194.0, 181.0, 70.0, -54.0, -116.0, -260.0, 0.0, 174.0, -2.0, 52.0, -15.0, -102.0, -86.0, 27.0, 149.0, -31.0, 58.0, 90.0, 2.0, 10.0, -88.0, 8.0, -13.0, 10.0, 18.0, -72.0, 127.0, 44.0, 30.0, -8.0, -59.0, -29.0, 28.0, 68.0, 5.0, -318.0, 0.0, 95.0, 0.0, 99.0, -222.0, -23.0, -11.0, 54.0, -15.0, -287.0, -83.0, 106.0, -8.0, 0.0, 47.0, -203.0, -40.0, 11.0, 161.0, -92.0, -283.0, -88.0, 190.0, 196.0, 130.0, 192.0, 200.0, -163.0, -25.0, -52.0, -111.0, 69.0, -195.0, 0.0, 2.0, -54.0, 83.0, 78.0, 38.0, 64.0, -24.0, -42.0, -88.0, -128.0, -148.0, -16.0], "policy_predator_policy_reward": [0.0, 40.0, 0.0, 86.0, 1.0, 66.0, 27.0, 13.0, 7.0, 10.0, 0.0, 40.0, 9.0, 0.0, 18.0, 92.0, 0.0, 58.0, 77.0, 72.0, 0.0, 0.0, 12.0, 0.0, 0.0, 2.0, 0.0, 27.0, 5.0, 33.0, 52.0, 50.0, 77.0, 5.0, 0.0, 60.0, 0.0, 55.0, 0.0, 101.0, 0.0, 95.0, 1.0, 55.0, 0.0, 18.0, 0.0, 0.0, 131.0, 0.0, 0.0, 38.0, 27.0, 0.0, 0.0, 100.0, 69.0, 0.0, 0.0, 0.0, 0.0, 0.0, 38.0, 0.0, 16.0, 0.0, 35.0, 73.0, 0.0, 0.0, 30.0, 0.0, 119.0, 2.0, 78.0, 78.0, 0.0, 0.0, 51.0, 2.0, 0.0, 33.0, 17.0, 67.0, 25.0, 0.0, 25.0, 33.0, 98.0, 5.0, 54.0, 109.0, 0.0, 69.0, 0.0, 0.0, 22.0, 54.0, 17.0, 92.0, 0.0, 0.0, 0.0, 121.0, 169.0, 12.0, 40.0, 92.0, 19.0, 54.0, 0.0, 0.0, 44.0, 4.0, 15.0, 2.0, 0.0, 0.0, 0.0, 6.0, 77.0, 0.0, 0.0, 143.0, 0.0, 5.0, 0.0, 66.0, 32.0, 27.0, 0.0, 49.0, 44.0, 36.0, 0.0, 0.0, 4.0, 0.0, 99.0, 3.0, 34.0, 9.0, 40.0, 16.0, 11.0, 0.0, 0.0, 66.0, 39.0, 34.0, 31.0, 20.0, 126.0, 86.0, 0.0, 0.0, 0.0, 14.0, 5.0, 127.0, 0.0, 7.0, 168.0, 0.0, 3.0, 57.0, 0.0, 37.0, 105.0, 0.0, 58.0, 31.0, 0.0, 77.0, 62.0, 143.0, 0.0, 0.0, 0.0, 0.0, 54.0, 39.0, 6.0, 85.0, 49.0, 66.0, 55.0, 73.0, 27.0, 59.0, 20.0, 29.0, 21.0, 30.0, 1.0, 26.0, 139.0, 0.0, 126.0, 27.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2866425916625104, "mean_inference_ms": 4.3403876213741, "mean_action_processing_ms": 0.6208089903384074, "mean_env_wait_ms": 0.5698876766758193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005770564079284668, "StateBufferConnector_ms": 0.005392909049987793, "ViewRequirementAgentConnector_ms": 0.15847456455230713}, "num_episodes": 18, "episode_return_max": 386.0, "episode_return_min": -351.0, "episode_return_mean": 64.8, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 226.8087215151509, "num_env_steps_trained_throughput_per_sec": 226.8087215151509, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 15704.502, "restore_workers_time_ms": 0.017, "training_step_time_ms": 15704.448, "sample_time_ms": 2314.936, "learn_time_ms": 13366.061, "learn_throughput": 299.265, "synch_weights_time_ms": 20.655}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "45bed_00000", "date": "2024-08-13_01-18-09", "timestamp": 1723526289, "time_this_iter_s": 17.725575923919678, "time_total_s": 479.7555639743805, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33071d1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 479.7555639743805, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 72.332, "ram_util_percent": 82.81200000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5529731015364329, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.912550831850243, "policy_loss": -0.0026691207745994524, "vf_loss": 5.9148717521990415, "vf_explained_var": 0.003309757526589449, "kl": 0.013927444666416955, "entropy": 1.205936263982581, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.659392012561124, "cur_kl_coeff": 0.0001953125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.85006213112483, "policy_loss": -0.002284981876552578, "vf_loss": 8.852345404801545, "vf_explained_var": 0.0018400746678549145, "kl": 0.00849323601433393, "entropy": 1.225085416609648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 386.0, "episode_reward_min": -351.0, "episode_reward_mean": 57.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -330.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 182.0}, "policy_reward_mean": {"prey_policy": -7.66, "predator_policy": 36.5}, "custom_metrics": {}, "hist_stats": {"episode_reward": [159.0, -139.0, -16.0, 176.0, 356.0, 88.0, -104.0, 60.0, 174.0, 82.0, 70.0, 15.0, 122.0, 51.0, 62.0, 14.0, 0.0, -30.0, 23.0, -127.0, 94.0, 14.0, -32.0, 35.0, 161.0, 66.0, -13.0, 49.0, -68.0, 357.0, -43.0, -56.0, 5.0, 67.0, -351.0, -55.0, 51.0, 219.0, 216.0, 173.0, 146.0, 381.0, 93.0, -233.0, 179.0, 116.0, -58.0, -10.0, 198.0, 148.0, 16.0, 22.0, 40.0, 2.0, 182.0, 88.0, -15.0, 147.0, -101.0, 95.0, 113.0, -113.0, 50.0, -134.0, 83.0, 29.0, -51.0, 60.0, 146.0, -166.0, 386.0, 322.0, 130.0, 14.0, 73.0, -67.0, 34.0, 210.0, 153.0, -39.0, -77.0, -11.0, 226.0, -78.0, 153.0, 33.0, -176.0, -82.0, 182.0, 118.0, -50.0, 240.0, 1.0, 51.0, 77.0, 338.0, 282.0, 42.0, 136.0, -231.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [188.0, -84.0, -56.0, -184.0, 53.0, -164.0, -29.0, 149.0, 150.0, 188.0, 68.0, 20.0, 27.0, -262.0, 22.0, 0.0, 165.0, -18.0, 182.0, -200.0, -21.0, 22.0, 9.0, 6.0, 1.0, 121.0, 13.0, 0.0, 48.0, -2.0, -139.0, 45.0, 0.0, 0.0, -60.0, 0.0, 138.0, -236.0, -187.0, -96.0, 94.0, 0.0, -42.0, 3.0, 0.0, -65.0, -43.0, -6.0, -50.0, 186.0, -50.0, 58.0, 0.0, -116.0, -280.0, 166.0, -1.0, -136.0, 200.0, 157.0, -147.0, 28.0, 33.0, -198.0, 5.0, 0.0, -168.0, 114.0, -202.0, -330.0, 29.0, -216.0, 99.0, -121.0, 95.0, 124.0, 104.0, 64.0, 151.0, 5.0, 137.0, 9.0, 194.0, 181.0, 70.0, -54.0, -116.0, -260.0, 0.0, 174.0, -2.0, 52.0, -15.0, -102.0, -86.0, 27.0, 149.0, -31.0, 58.0, 90.0, 2.0, 10.0, -88.0, 8.0, -13.0, 10.0, 18.0, -72.0, 127.0, 44.0, 30.0, -8.0, -59.0, -29.0, 28.0, 68.0, 5.0, -318.0, 0.0, 95.0, 0.0, 99.0, -222.0, -23.0, -11.0, 54.0, -15.0, -287.0, -83.0, 106.0, -8.0, 0.0, 47.0, -203.0, -40.0, 11.0, 161.0, -92.0, -283.0, -88.0, 190.0, 196.0, 130.0, 192.0, 200.0, -163.0, -25.0, -52.0, -111.0, 69.0, -195.0, 0.0, 2.0, -54.0, 83.0, 78.0, 38.0, 64.0, -24.0, -42.0, -88.0, -128.0, -148.0, -16.0, 105.0, 98.0, -196.0, -34.0, 107.0, 4.0, -107.0, 1.0, -175.0, -248.0, -328.0, 31.0, 83.0, 66.0, 160.0, -84.0, -108.0, -68.0, 22.0, 166.0, 0.0, 1.0, -208.0, 139.0, -76.0, 60.0, 189.0, 120.0, 128.0, 119.0, 117.0, -292.0, 134.0, -100.0, -147.0, -284.0], "policy_predator_policy_reward": [0.0, 55.0, 0.0, 101.0, 0.0, 95.0, 1.0, 55.0, 0.0, 18.0, 0.0, 0.0, 131.0, 0.0, 0.0, 38.0, 27.0, 0.0, 0.0, 100.0, 69.0, 0.0, 0.0, 0.0, 0.0, 0.0, 38.0, 0.0, 16.0, 0.0, 35.0, 73.0, 0.0, 0.0, 30.0, 0.0, 119.0, 2.0, 78.0, 78.0, 0.0, 0.0, 51.0, 2.0, 0.0, 33.0, 17.0, 67.0, 25.0, 0.0, 25.0, 33.0, 98.0, 5.0, 54.0, 109.0, 0.0, 69.0, 0.0, 0.0, 22.0, 54.0, 17.0, 92.0, 0.0, 0.0, 0.0, 121.0, 169.0, 12.0, 40.0, 92.0, 19.0, 54.0, 0.0, 0.0, 44.0, 4.0, 15.0, 2.0, 0.0, 0.0, 0.0, 6.0, 77.0, 0.0, 0.0, 143.0, 0.0, 5.0, 0.0, 66.0, 32.0, 27.0, 0.0, 49.0, 44.0, 36.0, 0.0, 0.0, 4.0, 0.0, 99.0, 3.0, 34.0, 9.0, 40.0, 16.0, 11.0, 0.0, 0.0, 66.0, 39.0, 34.0, 31.0, 20.0, 126.0, 86.0, 0.0, 0.0, 0.0, 14.0, 5.0, 127.0, 0.0, 7.0, 168.0, 0.0, 3.0, 57.0, 0.0, 37.0, 105.0, 0.0, 58.0, 31.0, 0.0, 77.0, 62.0, 143.0, 0.0, 0.0, 0.0, 0.0, 54.0, 39.0, 6.0, 85.0, 49.0, 66.0, 55.0, 73.0, 27.0, 59.0, 20.0, 29.0, 21.0, 30.0, 1.0, 26.0, 139.0, 0.0, 126.0, 27.0, 21.0, 2.0, 31.0, 121.0, 12.0, 30.0, 0.0, 139.0, 114.0, 133.0, 92.0, 123.0, 0.0, 33.0, 42.0, 0.0, 97.0, 29.0, 50.0, 2.0, 0.0, 0.0, 104.0, 16.0, 4.0, 89.0, 23.0, 6.0, 22.0, 13.0, 142.0, 75.0, 89.0, 13.0, 18.0, 182.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2842554662074277, "mean_inference_ms": 4.302898944604157, "mean_action_processing_ms": 0.6140630966527477, "mean_env_wait_ms": 0.5624317107159468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058214664459228516, "StateBufferConnector_ms": 0.007286787033081055, "ViewRequirementAgentConnector_ms": 0.19802165031433105}, "num_episodes": 18, "episode_return_max": 386.0, "episode_return_min": -351.0, "episode_return_mean": 57.68, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 173.25842797114473, "num_env_steps_trained_throughput_per_sec": 173.25842797114473, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 16500.423, "restore_workers_time_ms": 0.018, "training_step_time_ms": 16500.367, "sample_time_ms": 2373.799, "learn_time_ms": 14097.644, "learn_throughput": 283.735, "synch_weights_time_ms": 26.001}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "45bed_00000", "date": "2024-08-13_01-18-32", "timestamp": 1723526312, "time_this_iter_s": 23.43283200263977, "time_total_s": 503.18839597702026, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x330744d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 503.18839597702026, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 85.85151515151516, "ram_util_percent": 83.6969696969697}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5018648796650783, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.121450786994248, "policy_loss": -0.0018046086828998, "vf_loss": 5.12275979973021, "vf_explained_var": 0.00785822590822896, "kl": 0.01982423377298564, "entropy": 1.1660001017429211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.462715727768878, "cur_kl_coeff": 0.0001953125, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.9572055322152595, "policy_loss": -0.0021672025053126234, "vf_loss": 7.95937096555397, "vf_explained_var": -0.004643009831665685, "kl": 0.009240629422928569, "entropy": 1.2532263463767117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 386.0, "episode_reward_min": -351.0, "episode_reward_mean": 51.63, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -335.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -17.43, "predator_policy": 43.245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.0, -68.0, 357.0, -43.0, -56.0, 5.0, 67.0, -351.0, -55.0, 51.0, 219.0, 216.0, 173.0, 146.0, 381.0, 93.0, -233.0, 179.0, 116.0, -58.0, -10.0, 198.0, 148.0, 16.0, 22.0, 40.0, 2.0, 182.0, 88.0, -15.0, 147.0, -101.0, 95.0, 113.0, -113.0, 50.0, -134.0, 83.0, 29.0, -51.0, 60.0, 146.0, -166.0, 386.0, 322.0, 130.0, 14.0, 73.0, -67.0, 34.0, 210.0, 153.0, -39.0, -77.0, -11.0, 226.0, -78.0, 153.0, 33.0, -176.0, -82.0, 182.0, 118.0, -50.0, 240.0, 1.0, 51.0, 77.0, 338.0, 282.0, 42.0, 136.0, -231.0, 55.0, -48.0, 161.0, 82.0, -20.0, 58.0, 52.0, -256.0, -72.0, -70.0, 18.0, 31.0, 3.0, -13.0, -25.0, -251.0, 110.0, 37.0, 192.0, -17.0, 338.0, -72.0, 290.0, 70.0, 225.0, -287.0, 165.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-280.0, 166.0, -1.0, -136.0, 200.0, 157.0, -147.0, 28.0, 33.0, -198.0, 5.0, 0.0, -168.0, 114.0, -202.0, -330.0, 29.0, -216.0, 99.0, -121.0, 95.0, 124.0, 104.0, 64.0, 151.0, 5.0, 137.0, 9.0, 194.0, 181.0, 70.0, -54.0, -116.0, -260.0, 0.0, 174.0, -2.0, 52.0, -15.0, -102.0, -86.0, 27.0, 149.0, -31.0, 58.0, 90.0, 2.0, 10.0, -88.0, 8.0, -13.0, 10.0, 18.0, -72.0, 127.0, 44.0, 30.0, -8.0, -59.0, -29.0, 28.0, 68.0, 5.0, -318.0, 0.0, 95.0, 0.0, 99.0, -222.0, -23.0, -11.0, 54.0, -15.0, -287.0, -83.0, 106.0, -8.0, 0.0, 47.0, -203.0, -40.0, 11.0, 161.0, -92.0, -283.0, -88.0, 190.0, 196.0, 130.0, 192.0, 200.0, -163.0, -25.0, -52.0, -111.0, 69.0, -195.0, 0.0, 2.0, -54.0, 83.0, 78.0, 38.0, 64.0, -24.0, -42.0, -88.0, -128.0, -148.0, -16.0, 105.0, 98.0, -196.0, -34.0, 107.0, 4.0, -107.0, 1.0, -175.0, -248.0, -328.0, 31.0, 83.0, 66.0, 160.0, -84.0, -108.0, -68.0, 22.0, 166.0, 0.0, 1.0, -208.0, 139.0, -76.0, 60.0, 189.0, 120.0, 128.0, 119.0, 117.0, -292.0, 134.0, -100.0, -147.0, -284.0, -11.0, -14.0, -335.0, 2.0, 0.0, 149.0, -61.0, 49.0, -105.0, -106.0, 0.0, -13.0, -28.0, 6.0, -306.0, -145.0, -220.0, -22.0, -196.0, -16.0, -134.0, 73.0, -24.0, 13.0, -274.0, 39.0, 13.0, -112.0, -110.0, 16.0, -194.0, -286.0, 63.0, -22.0, 4.0, -41.0, -1.0, 113.0, -251.0, 60.0, 140.0, 167.0, -65.0, -94.0, 132.0, 158.0, -16.0, 13.0, 93.0, 111.0, -229.0, -256.0, 25.0, 140.0], "policy_predator_policy_reward": [54.0, 109.0, 0.0, 69.0, 0.0, 0.0, 22.0, 54.0, 17.0, 92.0, 0.0, 0.0, 0.0, 121.0, 169.0, 12.0, 40.0, 92.0, 19.0, 54.0, 0.0, 0.0, 44.0, 4.0, 15.0, 2.0, 0.0, 0.0, 0.0, 6.0, 77.0, 0.0, 0.0, 143.0, 0.0, 5.0, 0.0, 66.0, 32.0, 27.0, 0.0, 49.0, 44.0, 36.0, 0.0, 0.0, 4.0, 0.0, 99.0, 3.0, 34.0, 9.0, 40.0, 16.0, 11.0, 0.0, 0.0, 66.0, 39.0, 34.0, 31.0, 20.0, 126.0, 86.0, 0.0, 0.0, 0.0, 14.0, 5.0, 127.0, 0.0, 7.0, 168.0, 0.0, 3.0, 57.0, 0.0, 37.0, 105.0, 0.0, 58.0, 31.0, 0.0, 77.0, 62.0, 143.0, 0.0, 0.0, 0.0, 0.0, 54.0, 39.0, 6.0, 85.0, 49.0, 66.0, 55.0, 73.0, 27.0, 59.0, 20.0, 29.0, 21.0, 30.0, 1.0, 26.0, 139.0, 0.0, 126.0, 27.0, 21.0, 2.0, 31.0, 121.0, 12.0, 30.0, 0.0, 139.0, 114.0, 133.0, 92.0, 123.0, 0.0, 33.0, 42.0, 0.0, 97.0, 29.0, 50.0, 2.0, 0.0, 0.0, 104.0, 16.0, 4.0, 89.0, 23.0, 6.0, 22.0, 13.0, 142.0, 75.0, 89.0, 13.0, 18.0, 182.0, 33.0, 47.0, 139.0, 146.0, 12.0, 0.0, 6.0, 88.0, 86.0, 105.0, 0.0, 71.0, 60.0, 14.0, 195.0, 0.0, 126.0, 44.0, 111.0, 31.0, 0.0, 79.0, 30.0, 12.0, 154.0, 84.0, 59.0, 27.0, 69.0, 0.0, 90.0, 139.0, 50.0, 19.0, 70.0, 4.0, 45.0, 35.0, 59.0, 115.0, 24.0, 7.0, 40.0, 47.0, 0.0, 0.0, 1.0, 72.0, 12.0, 9.0, 198.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3543454490517908, "mean_inference_ms": 4.340319087379583, "mean_action_processing_ms": 0.640453051442335, "mean_env_wait_ms": 0.569421082654479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06149184703826904, "StateBufferConnector_ms": 0.010287642478942871, "ViewRequirementAgentConnector_ms": 0.2704371213912964}, "num_episodes": 27, "episode_return_max": 386.0, "episode_return_min": -351.0, "episode_return_mean": 51.63, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.30675066533844, "num_env_steps_trained_throughput_per_sec": 103.30675066533844, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 18929.82, "restore_workers_time_ms": 0.023, "training_step_time_ms": 18929.712, "sample_time_ms": 3229.681, "learn_time_ms": 15666.955, "learn_throughput": 255.314, "synch_weights_time_ms": 27.812}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "45bed_00000", "date": "2024-08-13_01-19-12", "timestamp": 1723526352, "time_this_iter_s": 39.32579517364502, "time_total_s": 542.5141911506653, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4449310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 542.5141911506653, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 91.64038461538462, "ram_util_percent": 84.07499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5235966426788499, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.587243406104032, "policy_loss": -0.001042598694631899, "vf_loss": 3.588099044971365, "vf_explained_var": 0.011301225802255056, "kl": 0.0074783847329026034, "entropy": 1.2410211070504769, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.267688338229895, "cur_kl_coeff": 0.0001953125, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.663862987800881, "policy_loss": -0.0027936103867697063, "vf_loss": 7.666655375717809, "vf_explained_var": -0.04474142789840698, "kl": 0.006191904340941778, "entropy": 1.2707961621738615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 386.0, "episode_reward_min": -287.0, "episode_reward_mean": 52.05, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -335.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -17.365, "predator_policy": 43.39}, "custom_metrics": {}, "hist_stats": {"episode_reward": [116.0, -58.0, -10.0, 198.0, 148.0, 16.0, 22.0, 40.0, 2.0, 182.0, 88.0, -15.0, 147.0, -101.0, 95.0, 113.0, -113.0, 50.0, -134.0, 83.0, 29.0, -51.0, 60.0, 146.0, -166.0, 386.0, 322.0, 130.0, 14.0, 73.0, -67.0, 34.0, 210.0, 153.0, -39.0, -77.0, -11.0, 226.0, -78.0, 153.0, 33.0, -176.0, -82.0, 182.0, 118.0, -50.0, 240.0, 1.0, 51.0, 77.0, 338.0, 282.0, 42.0, 136.0, -231.0, 55.0, -48.0, 161.0, 82.0, -20.0, 58.0, 52.0, -256.0, -72.0, -70.0, 18.0, 31.0, 3.0, -13.0, -25.0, -251.0, 110.0, 37.0, 192.0, -17.0, 338.0, -72.0, 290.0, 70.0, 225.0, -287.0, 165.0, 125.0, 174.0, 231.0, -12.0, 105.0, -49.0, 164.0, 27.0, 232.0, -16.0, -51.0, 162.0, 203.0, -8.0, -104.0, 60.0, 161.0, -232.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, 52.0, -15.0, -102.0, -86.0, 27.0, 149.0, -31.0, 58.0, 90.0, 2.0, 10.0, -88.0, 8.0, -13.0, 10.0, 18.0, -72.0, 127.0, 44.0, 30.0, -8.0, -59.0, -29.0, 28.0, 68.0, 5.0, -318.0, 0.0, 95.0, 0.0, 99.0, -222.0, -23.0, -11.0, 54.0, -15.0, -287.0, -83.0, 106.0, -8.0, 0.0, 47.0, -203.0, -40.0, 11.0, 161.0, -92.0, -283.0, -88.0, 190.0, 196.0, 130.0, 192.0, 200.0, -163.0, -25.0, -52.0, -111.0, 69.0, -195.0, 0.0, 2.0, -54.0, 83.0, 78.0, 38.0, 64.0, -24.0, -42.0, -88.0, -128.0, -148.0, -16.0, 105.0, 98.0, -196.0, -34.0, 107.0, 4.0, -107.0, 1.0, -175.0, -248.0, -328.0, 31.0, 83.0, 66.0, 160.0, -84.0, -108.0, -68.0, 22.0, 166.0, 0.0, 1.0, -208.0, 139.0, -76.0, 60.0, 189.0, 120.0, 128.0, 119.0, 117.0, -292.0, 134.0, -100.0, -147.0, -284.0, -11.0, -14.0, -335.0, 2.0, 0.0, 149.0, -61.0, 49.0, -105.0, -106.0, 0.0, -13.0, -28.0, 6.0, -306.0, -145.0, -220.0, -22.0, -196.0, -16.0, -134.0, 73.0, -24.0, 13.0, -274.0, 39.0, 13.0, -112.0, -110.0, 16.0, -194.0, -286.0, 63.0, -22.0, 4.0, -41.0, -1.0, 113.0, -251.0, 60.0, 140.0, 167.0, -65.0, -94.0, 132.0, 158.0, -16.0, 13.0, 93.0, 111.0, -229.0, -256.0, 25.0, 140.0, 107.0, 0.0, 50.0, 105.0, 137.0, 45.0, -54.0, -70.0, 61.0, -24.0, -68.0, -166.0, 135.0, 0.0, 0.0, 11.0, 57.0, 175.0, -52.0, 3.0, 0.0, -124.0, 56.0, 106.0, 77.0, 126.0, -186.0, 84.0, 2.0, -241.0, -139.0, 35.0, -5.0, 143.0, -222.0, -241.0], "policy_predator_policy_reward": [0.0, 66.0, 32.0, 27.0, 0.0, 49.0, 44.0, 36.0, 0.0, 0.0, 4.0, 0.0, 99.0, 3.0, 34.0, 9.0, 40.0, 16.0, 11.0, 0.0, 0.0, 66.0, 39.0, 34.0, 31.0, 20.0, 126.0, 86.0, 0.0, 0.0, 0.0, 14.0, 5.0, 127.0, 0.0, 7.0, 168.0, 0.0, 3.0, 57.0, 0.0, 37.0, 105.0, 0.0, 58.0, 31.0, 0.0, 77.0, 62.0, 143.0, 0.0, 0.0, 0.0, 0.0, 54.0, 39.0, 6.0, 85.0, 49.0, 66.0, 55.0, 73.0, 27.0, 59.0, 20.0, 29.0, 21.0, 30.0, 1.0, 26.0, 139.0, 0.0, 126.0, 27.0, 21.0, 2.0, 31.0, 121.0, 12.0, 30.0, 0.0, 139.0, 114.0, 133.0, 92.0, 123.0, 0.0, 33.0, 42.0, 0.0, 97.0, 29.0, 50.0, 2.0, 0.0, 0.0, 104.0, 16.0, 4.0, 89.0, 23.0, 6.0, 22.0, 13.0, 142.0, 75.0, 89.0, 13.0, 18.0, 182.0, 33.0, 47.0, 139.0, 146.0, 12.0, 0.0, 6.0, 88.0, 86.0, 105.0, 0.0, 71.0, 60.0, 14.0, 195.0, 0.0, 126.0, 44.0, 111.0, 31.0, 0.0, 79.0, 30.0, 12.0, 154.0, 84.0, 59.0, 27.0, 69.0, 0.0, 90.0, 139.0, 50.0, 19.0, 70.0, 4.0, 45.0, 35.0, 59.0, 115.0, 24.0, 7.0, 40.0, 47.0, 0.0, 0.0, 1.0, 72.0, 12.0, 9.0, 198.0, 0.0, 0.0, 0.0, 13.0, 5.0, 15.0, 4.0, 49.0, 0.0, 21.0, 91.0, 9.0, 59.0, 99.0, 86.0, 0.0, 29.0, 6.0, 10.0, 0.0, 0.0, 33.0, 0.0, 13.0, 60.0, 0.0, 0.0, 0.0, 0.0, 94.0, 0.0, 135.0, 0.0, 117.0, 47.0, 23.0, 0.0, 154.0, 77.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.371027881994561, "mean_inference_ms": 4.437965636542629, "mean_action_processing_ms": 0.6264081536144775, "mean_env_wait_ms": 0.5775236446528441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07682490348815918, "StateBufferConnector_ms": 0.010233879089355469, "ViewRequirementAgentConnector_ms": 0.2856065034866333}, "num_episodes": 18, "episode_return_max": 386.0, "episode_return_min": -287.0, "episode_return_mean": 52.05, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.5575420027435, "num_env_steps_trained_throughput_per_sec": 209.5575420027435, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 19246.135, "restore_workers_time_ms": 0.023, "training_step_time_ms": 19246.025, "sample_time_ms": 3291.514, "learn_time_ms": 15921.121, "learn_throughput": 251.239, "synch_weights_time_ms": 27.874}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "45bed_00000", "date": "2024-08-13_01-19-32", "timestamp": 1723526372, "time_this_iter_s": 19.155948162078857, "time_total_s": 561.6701393127441, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44498b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 561.6701393127441, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 84.04444444444445, "ram_util_percent": 83.78888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4991345082877805, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.081012546574628, "policy_loss": -0.005551713789818148, "vf_loss": 5.086238043144267, "vf_explained_var": 0.02404165094491666, "kl": 0.01304805070505212, "entropy": 1.1700550372007663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.841439062483096, "cur_kl_coeff": 0.0001953125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.356384460005179, "policy_loss": -0.0022075113032269415, "vf_loss": 8.358590367988304, "vf_explained_var": -0.0327340252815731, "kl": 0.007777023834818954, "entropy": 1.119780861574506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 386.0, "episode_reward_min": -287.0, "episode_reward_mean": 58.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -360.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -16.475, "predator_policy": 45.955}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-134.0, 83.0, 29.0, -51.0, 60.0, 146.0, -166.0, 386.0, 322.0, 130.0, 14.0, 73.0, -67.0, 34.0, 210.0, 153.0, -39.0, -77.0, -11.0, 226.0, -78.0, 153.0, 33.0, -176.0, -82.0, 182.0, 118.0, -50.0, 240.0, 1.0, 51.0, 77.0, 338.0, 282.0, 42.0, 136.0, -231.0, 55.0, -48.0, 161.0, 82.0, -20.0, 58.0, 52.0, -256.0, -72.0, -70.0, 18.0, 31.0, 3.0, -13.0, -25.0, -251.0, 110.0, 37.0, 192.0, -17.0, 338.0, -72.0, 290.0, 70.0, 225.0, -287.0, 165.0, 125.0, 174.0, 231.0, -12.0, 105.0, -49.0, 164.0, 27.0, 232.0, -16.0, -51.0, 162.0, 203.0, -8.0, -104.0, 60.0, 161.0, -232.0, 253.0, 59.0, -98.0, 155.0, 160.0, 384.0, 127.0, 29.0, 65.0, -85.0, 109.0, 1.0, -125.0, 160.0, -93.0, 3.0, 276.0, 231.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-15.0, -287.0, -83.0, 106.0, -8.0, 0.0, 47.0, -203.0, -40.0, 11.0, 161.0, -92.0, -283.0, -88.0, 190.0, 196.0, 130.0, 192.0, 200.0, -163.0, -25.0, -52.0, -111.0, 69.0, -195.0, 0.0, 2.0, -54.0, 83.0, 78.0, 38.0, 64.0, -24.0, -42.0, -88.0, -128.0, -148.0, -16.0, 105.0, 98.0, -196.0, -34.0, 107.0, 4.0, -107.0, 1.0, -175.0, -248.0, -328.0, 31.0, 83.0, 66.0, 160.0, -84.0, -108.0, -68.0, 22.0, 166.0, 0.0, 1.0, -208.0, 139.0, -76.0, 60.0, 189.0, 120.0, 128.0, 119.0, 117.0, -292.0, 134.0, -100.0, -147.0, -284.0, -11.0, -14.0, -335.0, 2.0, 0.0, 149.0, -61.0, 49.0, -105.0, -106.0, 0.0, -13.0, -28.0, 6.0, -306.0, -145.0, -220.0, -22.0, -196.0, -16.0, -134.0, 73.0, -24.0, 13.0, -274.0, 39.0, 13.0, -112.0, -110.0, 16.0, -194.0, -286.0, 63.0, -22.0, 4.0, -41.0, -1.0, 113.0, -251.0, 60.0, 140.0, 167.0, -65.0, -94.0, 132.0, 158.0, -16.0, 13.0, 93.0, 111.0, -229.0, -256.0, 25.0, 140.0, 107.0, 0.0, 50.0, 105.0, 137.0, 45.0, -54.0, -70.0, 61.0, -24.0, -68.0, -166.0, 135.0, 0.0, 0.0, 11.0, 57.0, 175.0, -52.0, 3.0, 0.0, -124.0, 56.0, 106.0, 77.0, 126.0, -186.0, 84.0, 2.0, -241.0, -139.0, 35.0, -5.0, 143.0, -222.0, -241.0, 182.0, 42.0, 8.0, -37.0, -22.0, -215.0, 99.0, 38.0, 101.0, 59.0, 200.0, 176.0, 16.0, -1.0, 0.0, -31.0, 60.0, -103.0, -25.0, -360.0, 0.0, 107.0, -95.0, -90.0, -275.0, -21.0, 88.0, 72.0, 2.0, -220.0, -69.0, -54.0, 30.0, 181.0, 74.0, 156.0], "policy_predator_policy_reward": [168.0, 0.0, 3.0, 57.0, 0.0, 37.0, 105.0, 0.0, 58.0, 31.0, 0.0, 77.0, 62.0, 143.0, 0.0, 0.0, 0.0, 0.0, 54.0, 39.0, 6.0, 85.0, 49.0, 66.0, 55.0, 73.0, 27.0, 59.0, 20.0, 29.0, 21.0, 30.0, 1.0, 26.0, 139.0, 0.0, 126.0, 27.0, 21.0, 2.0, 31.0, 121.0, 12.0, 30.0, 0.0, 139.0, 114.0, 133.0, 92.0, 123.0, 0.0, 33.0, 42.0, 0.0, 97.0, 29.0, 50.0, 2.0, 0.0, 0.0, 104.0, 16.0, 4.0, 89.0, 23.0, 6.0, 22.0, 13.0, 142.0, 75.0, 89.0, 13.0, 18.0, 182.0, 33.0, 47.0, 139.0, 146.0, 12.0, 0.0, 6.0, 88.0, 86.0, 105.0, 0.0, 71.0, 60.0, 14.0, 195.0, 0.0, 126.0, 44.0, 111.0, 31.0, 0.0, 79.0, 30.0, 12.0, 154.0, 84.0, 59.0, 27.0, 69.0, 0.0, 90.0, 139.0, 50.0, 19.0, 70.0, 4.0, 45.0, 35.0, 59.0, 115.0, 24.0, 7.0, 40.0, 47.0, 0.0, 0.0, 1.0, 72.0, 12.0, 9.0, 198.0, 0.0, 0.0, 0.0, 13.0, 5.0, 15.0, 4.0, 49.0, 0.0, 21.0, 91.0, 9.0, 59.0, 99.0, 86.0, 0.0, 29.0, 6.0, 10.0, 0.0, 0.0, 33.0, 0.0, 13.0, 60.0, 0.0, 0.0, 0.0, 0.0, 94.0, 0.0, 135.0, 0.0, 117.0, 47.0, 23.0, 0.0, 154.0, 77.0, 23.0, 6.0, 0.0, 88.0, 139.0, 0.0, 0.0, 18.0, 0.0, 0.0, 8.0, 0.0, 96.0, 16.0, 0.0, 60.0, 21.0, 87.0, 111.0, 189.0, 2.0, 0.0, 115.0, 71.0, 139.0, 32.0, 0.0, 0.0, 69.0, 56.0, 71.0, 55.0, 54.0, 11.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3997210265827635, "mean_inference_ms": 4.481949051881802, "mean_action_processing_ms": 0.6298357000624961, "mean_env_wait_ms": 0.5836971166294087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07752573490142822, "StateBufferConnector_ms": 0.009807467460632324, "ViewRequirementAgentConnector_ms": 0.2883915901184082}, "num_episodes": 18, "episode_return_max": 386.0, "episode_return_min": -287.0, "episode_return_mean": 58.96, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.195314875802927, "num_env_steps_trained_throughput_per_sec": 4.195314875802927, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 113116.497, "restore_workers_time_ms": 0.023, "training_step_time_ms": 113116.387, "sample_time_ms": 3286.139, "learn_time_ms": 109792.396, "learn_throughput": 36.432, "synch_weights_time_ms": 30.966}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "45bed_00000", "date": "2024-08-13_01-35-25", "timestamp": 1723527325, "time_this_iter_s": 953.6244239807129, "time_total_s": 1515.294563293457, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33071f160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1515.294563293457, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 89.34411764705882, "ram_util_percent": 83.71176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6721400473168287, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.122845029326343, "policy_loss": -0.001957581621944589, "vf_loss": 6.124494454217335, "vf_explained_var": 0.01552512043367618, "kl": 0.012326106757753646, "entropy": 1.0701840988542668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.579176726480009, "cur_kl_coeff": 0.0001953125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.739279837078518, "policy_loss": -7.793398219205085e-06, "vf_loss": 8.739287006791937, "vf_explained_var": -0.021866705241026702, "kl": 0.0027755730090281787, "entropy": 1.1497622283993574, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 384.0, "episode_reward_min": -287.0, "episode_reward_mean": 56.29, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -360.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -20.095, "predator_policy": 48.24}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.0, 226.0, -78.0, 153.0, 33.0, -176.0, -82.0, 182.0, 118.0, -50.0, 240.0, 1.0, 51.0, 77.0, 338.0, 282.0, 42.0, 136.0, -231.0, 55.0, -48.0, 161.0, 82.0, -20.0, 58.0, 52.0, -256.0, -72.0, -70.0, 18.0, 31.0, 3.0, -13.0, -25.0, -251.0, 110.0, 37.0, 192.0, -17.0, 338.0, -72.0, 290.0, 70.0, 225.0, -287.0, 165.0, 125.0, 174.0, 231.0, -12.0, 105.0, -49.0, 164.0, 27.0, 232.0, -16.0, -51.0, 162.0, 203.0, -8.0, -104.0, 60.0, 161.0, -232.0, 253.0, 59.0, -98.0, 155.0, 160.0, 384.0, 127.0, 29.0, 65.0, -85.0, 109.0, 1.0, -125.0, 160.0, -93.0, 3.0, 276.0, 231.0, 202.0, 235.0, -79.0, 258.0, -8.0, -113.0, -38.0, 43.0, 55.0, 154.0, 5.0, 9.0, -44.0, 108.0, 126.0, -222.0, 75.0, 73.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-148.0, -16.0, 105.0, 98.0, -196.0, -34.0, 107.0, 4.0, -107.0, 1.0, -175.0, -248.0, -328.0, 31.0, 83.0, 66.0, 160.0, -84.0, -108.0, -68.0, 22.0, 166.0, 0.0, 1.0, -208.0, 139.0, -76.0, 60.0, 189.0, 120.0, 128.0, 119.0, 117.0, -292.0, 134.0, -100.0, -147.0, -284.0, -11.0, -14.0, -335.0, 2.0, 0.0, 149.0, -61.0, 49.0, -105.0, -106.0, 0.0, -13.0, -28.0, 6.0, -306.0, -145.0, -220.0, -22.0, -196.0, -16.0, -134.0, 73.0, -24.0, 13.0, -274.0, 39.0, 13.0, -112.0, -110.0, 16.0, -194.0, -286.0, 63.0, -22.0, 4.0, -41.0, -1.0, 113.0, -251.0, 60.0, 140.0, 167.0, -65.0, -94.0, 132.0, 158.0, -16.0, 13.0, 93.0, 111.0, -229.0, -256.0, 25.0, 140.0, 107.0, 0.0, 50.0, 105.0, 137.0, 45.0, -54.0, -70.0, 61.0, -24.0, -68.0, -166.0, 135.0, 0.0, 0.0, 11.0, 57.0, 175.0, -52.0, 3.0, 0.0, -124.0, 56.0, 106.0, 77.0, 126.0, -186.0, 84.0, 2.0, -241.0, -139.0, 35.0, -5.0, 143.0, -222.0, -241.0, 182.0, 42.0, 8.0, -37.0, -22.0, -215.0, 99.0, 38.0, 101.0, 59.0, 200.0, 176.0, 16.0, -1.0, 0.0, -31.0, 60.0, -103.0, -25.0, -360.0, 0.0, 107.0, -95.0, -90.0, -275.0, -21.0, 88.0, 72.0, 2.0, -220.0, -69.0, -54.0, 30.0, 181.0, 74.0, 156.0, -9.0, 194.0, 166.0, 69.0, -65.0, -182.0, 77.0, 144.0, 12.0, -181.0, -166.0, -97.0, -169.0, -107.0, 26.0, -133.0, -211.0, 101.0, 32.0, 75.0, 31.0, -112.0, 29.0, -113.0, -112.0, -63.0, 0.0, 108.0, 148.0, -133.0, -355.0, -142.0, -20.0, 17.0, -2.0, 5.0], "policy_predator_policy_reward": [126.0, 27.0, 21.0, 2.0, 31.0, 121.0, 12.0, 30.0, 0.0, 139.0, 114.0, 133.0, 92.0, 123.0, 0.0, 33.0, 42.0, 0.0, 97.0, 29.0, 50.0, 2.0, 0.0, 0.0, 104.0, 16.0, 4.0, 89.0, 23.0, 6.0, 22.0, 13.0, 142.0, 75.0, 89.0, 13.0, 18.0, 182.0, 33.0, 47.0, 139.0, 146.0, 12.0, 0.0, 6.0, 88.0, 86.0, 105.0, 0.0, 71.0, 60.0, 14.0, 195.0, 0.0, 126.0, 44.0, 111.0, 31.0, 0.0, 79.0, 30.0, 12.0, 154.0, 84.0, 59.0, 27.0, 69.0, 0.0, 90.0, 139.0, 50.0, 19.0, 70.0, 4.0, 45.0, 35.0, 59.0, 115.0, 24.0, 7.0, 40.0, 47.0, 0.0, 0.0, 1.0, 72.0, 12.0, 9.0, 198.0, 0.0, 0.0, 0.0, 13.0, 5.0, 15.0, 4.0, 49.0, 0.0, 21.0, 91.0, 9.0, 59.0, 99.0, 86.0, 0.0, 29.0, 6.0, 10.0, 0.0, 0.0, 33.0, 0.0, 13.0, 60.0, 0.0, 0.0, 0.0, 0.0, 94.0, 0.0, 135.0, 0.0, 117.0, 47.0, 23.0, 0.0, 154.0, 77.0, 23.0, 6.0, 0.0, 88.0, 139.0, 0.0, 0.0, 18.0, 0.0, 0.0, 8.0, 0.0, 96.0, 16.0, 0.0, 60.0, 21.0, 87.0, 111.0, 189.0, 2.0, 0.0, 115.0, 71.0, 139.0, 32.0, 0.0, 0.0, 69.0, 56.0, 71.0, 55.0, 54.0, 11.0, 0.0, 1.0, 17.0, 0.0, 0.0, 0.0, 168.0, 0.0, 0.0, 37.0, 64.0, 97.0, 75.0, 75.0, 114.0, 124.0, 126.0, 24.0, 30.0, 135.0, 17.0, 30.0, 51.0, 35.0, 11.0, 82.0, 58.0, 73.0, 0.0, 0.0, 93.0, 18.0, 172.0, 103.0, 0.0, 78.0, 28.0, 42.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4388538338252215, "mean_inference_ms": 4.562065912165029, "mean_action_processing_ms": 0.6384505125937331, "mean_env_wait_ms": 0.593496822785151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10326647758483887, "StateBufferConnector_ms": 0.009495735168457031, "ViewRequirementAgentConnector_ms": 0.41487228870391846}, "num_episodes": 18, "episode_return_max": 384.0, "episode_return_min": -287.0, "episode_return_mean": 56.29, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 131.7034242865508, "num_env_steps_trained_throughput_per_sec": 131.7034242865508, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 114706.215, "restore_workers_time_ms": 0.022, "training_step_time_ms": 114706.106, "sample_time_ms": 3818.778, "learn_time_ms": 110848.964, "learn_throughput": 36.085, "synch_weights_time_ms": 31.24}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "45bed_00000", "date": "2024-08-13_01-35-56", "timestamp": 1723527356, "time_this_iter_s": 30.437103033065796, "time_total_s": 1545.7316663265228, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33062fd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1545.7316663265228, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 95.63488372093023, "ram_util_percent": 83.72790697674418}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5813933567316444, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.60840964115486, "policy_loss": -0.0031054944813832955, "vf_loss": 6.611403835639752, "vf_explained_var": 0.01090962533597593, "kl": 0.004452804833364042, "entropy": 1.1009518248063546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.693635963778648, "cur_kl_coeff": 9.765625e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.91027421219639, "policy_loss": -0.001483366547260808, "vf_loss": 8.911756811192427, "vf_explained_var": -0.046690012790538644, "kl": 0.005631720643498368, "entropy": 1.1675204787304791, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 384.0, "episode_reward_min": -287.0, "episode_reward_mean": 44.2, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -364.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -27.905, "predator_policy": 50.005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [82.0, -20.0, 58.0, 52.0, -256.0, -72.0, -70.0, 18.0, 31.0, 3.0, -13.0, -25.0, -251.0, 110.0, 37.0, 192.0, -17.0, 338.0, -72.0, 290.0, 70.0, 225.0, -287.0, 165.0, 125.0, 174.0, 231.0, -12.0, 105.0, -49.0, 164.0, 27.0, 232.0, -16.0, -51.0, 162.0, 203.0, -8.0, -104.0, 60.0, 161.0, -232.0, 253.0, 59.0, -98.0, 155.0, 160.0, 384.0, 127.0, 29.0, 65.0, -85.0, 109.0, 1.0, -125.0, 160.0, -93.0, 3.0, 276.0, 231.0, 202.0, 235.0, -79.0, 258.0, -8.0, -113.0, -38.0, 43.0, 55.0, 154.0, 5.0, 9.0, -44.0, 108.0, 126.0, -222.0, 75.0, 73.0, 74.0, -97.0, 53.0, 98.0, 47.0, -48.0, 159.0, -42.0, 56.0, 10.0, -65.0, -7.0, 68.0, -196.0, 47.0, -145.0, 302.0, 66.0, 51.0, -223.0, 62.0, -60.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-61.0, 49.0, -105.0, -106.0, 0.0, -13.0, -28.0, 6.0, -306.0, -145.0, -220.0, -22.0, -196.0, -16.0, -134.0, 73.0, -24.0, 13.0, -274.0, 39.0, 13.0, -112.0, -110.0, 16.0, -194.0, -286.0, 63.0, -22.0, 4.0, -41.0, -1.0, 113.0, -251.0, 60.0, 140.0, 167.0, -65.0, -94.0, 132.0, 158.0, -16.0, 13.0, 93.0, 111.0, -229.0, -256.0, 25.0, 140.0, 107.0, 0.0, 50.0, 105.0, 137.0, 45.0, -54.0, -70.0, 61.0, -24.0, -68.0, -166.0, 135.0, 0.0, 0.0, 11.0, 57.0, 175.0, -52.0, 3.0, 0.0, -124.0, 56.0, 106.0, 77.0, 126.0, -186.0, 84.0, 2.0, -241.0, -139.0, 35.0, -5.0, 143.0, -222.0, -241.0, 182.0, 42.0, 8.0, -37.0, -22.0, -215.0, 99.0, 38.0, 101.0, 59.0, 200.0, 176.0, 16.0, -1.0, 0.0, -31.0, 60.0, -103.0, -25.0, -360.0, 0.0, 107.0, -95.0, -90.0, -275.0, -21.0, 88.0, 72.0, 2.0, -220.0, -69.0, -54.0, 30.0, 181.0, 74.0, 156.0, -9.0, 194.0, 166.0, 69.0, -65.0, -182.0, 77.0, 144.0, 12.0, -181.0, -166.0, -97.0, -169.0, -107.0, 26.0, -133.0, -211.0, 101.0, 32.0, 75.0, 31.0, -112.0, 29.0, -113.0, -112.0, -63.0, 0.0, 108.0, 148.0, -133.0, -355.0, -142.0, -20.0, 17.0, -2.0, 5.0, 119.0, -146.0, -159.0, -98.0, -80.0, -5.0, 140.0, -201.0, 97.0, -194.0, -232.0, 11.0, 148.0, -39.0, -136.0, 0.0, -39.0, 51.0, -151.0, 27.0, -97.0, -103.0, 149.0, -364.0, -27.0, 69.0, -245.0, -186.0, -169.0, 74.0, -358.0, -106.0, 56.0, 200.0, 141.0, -150.0, 37.0, 6.0, -278.0, -84.0, 38.0, -54.0, 9.0, -211.0], "policy_predator_policy_reward": [6.0, 88.0, 86.0, 105.0, 0.0, 71.0, 60.0, 14.0, 195.0, 0.0, 126.0, 44.0, 111.0, 31.0, 0.0, 79.0, 30.0, 12.0, 154.0, 84.0, 59.0, 27.0, 69.0, 0.0, 90.0, 139.0, 50.0, 19.0, 70.0, 4.0, 45.0, 35.0, 59.0, 115.0, 24.0, 7.0, 40.0, 47.0, 0.0, 0.0, 1.0, 72.0, 12.0, 9.0, 198.0, 0.0, 0.0, 0.0, 13.0, 5.0, 15.0, 4.0, 49.0, 0.0, 21.0, 91.0, 9.0, 59.0, 99.0, 86.0, 0.0, 29.0, 6.0, 10.0, 0.0, 0.0, 33.0, 0.0, 13.0, 60.0, 0.0, 0.0, 0.0, 0.0, 94.0, 0.0, 135.0, 0.0, 117.0, 47.0, 23.0, 0.0, 154.0, 77.0, 23.0, 6.0, 0.0, 88.0, 139.0, 0.0, 0.0, 18.0, 0.0, 0.0, 8.0, 0.0, 96.0, 16.0, 0.0, 60.0, 21.0, 87.0, 111.0, 189.0, 2.0, 0.0, 115.0, 71.0, 139.0, 32.0, 0.0, 0.0, 69.0, 56.0, 71.0, 55.0, 54.0, 11.0, 0.0, 1.0, 17.0, 0.0, 0.0, 0.0, 168.0, 0.0, 0.0, 37.0, 64.0, 97.0, 75.0, 75.0, 114.0, 124.0, 126.0, 24.0, 30.0, 135.0, 17.0, 30.0, 51.0, 35.0, 11.0, 82.0, 58.0, 73.0, 0.0, 0.0, 93.0, 18.0, 172.0, 103.0, 0.0, 78.0, 28.0, 42.0, 76.0, 25.0, 37.0, 123.0, 132.0, 6.0, 83.0, 76.0, 94.0, 50.0, 144.0, 29.0, 17.0, 33.0, 2.0, 92.0, 0.0, 44.0, 118.0, 16.0, 0.0, 135.0, 40.0, 168.0, 25.0, 1.0, 124.0, 111.0, 77.0, 65.0, 165.0, 154.0, 41.0, 5.0, 75.0, 0.0, 8.0, 0.0, 139.0, 0.0, 27.0, 51.0, 8.0, 134.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4850232552065763, "mean_inference_ms": 4.626388450481034, "mean_action_processing_ms": 0.648482632297375, "mean_env_wait_ms": 0.6186345651743764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1400049924850464, "StateBufferConnector_ms": 0.007974624633789062, "ViewRequirementAgentConnector_ms": 0.40431666374206543}, "num_episodes": 22, "episode_return_max": 384.0, "episode_return_min": -287.0, "episode_return_mean": 44.2, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 194.29747664366403, "num_env_steps_trained_throughput_per_sec": 194.29747664366403, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 115506.638, "restore_workers_time_ms": 0.022, "training_step_time_ms": 115506.528, "sample_time_ms": 4008.21, "learn_time_ms": 111458.642, "learn_throughput": 35.888, "synch_weights_time_ms": 31.744}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "45bed_00000", "date": "2024-08-13_01-36-17", "timestamp": 1723527377, "time_this_iter_s": 20.64429211616516, "time_total_s": 1566.375958442688, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33071c040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1566.375958442688, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 89.1655172413793, "ram_util_percent": 83.6896551724138}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7597636968685837, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.129273392031433, "policy_loss": -0.0019500222552331194, "vf_loss": 5.131050726345607, "vf_explained_var": 0.023701386886929708, "kl": 0.01381497489179164, "entropy": 1.1663486386102344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.389477799020748, "cur_kl_coeff": 9.765625e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.725554835102546, "policy_loss": 3.533251472704467e-05, "vf_loss": 8.725519505253544, "vf_explained_var": 0.035463327200955186, "kl": 0.002696632709042187, "entropy": 1.092610330272604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 384.0, "episode_reward_min": -291.0, "episode_reward_mean": 47.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -376.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -26.295, "predator_policy": 50.075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [165.0, 125.0, 174.0, 231.0, -12.0, 105.0, -49.0, 164.0, 27.0, 232.0, -16.0, -51.0, 162.0, 203.0, -8.0, -104.0, 60.0, 161.0, -232.0, 253.0, 59.0, -98.0, 155.0, 160.0, 384.0, 127.0, 29.0, 65.0, -85.0, 109.0, 1.0, -125.0, 160.0, -93.0, 3.0, 276.0, 231.0, 202.0, 235.0, -79.0, 258.0, -8.0, -113.0, -38.0, 43.0, 55.0, 154.0, 5.0, 9.0, -44.0, 108.0, 126.0, -222.0, 75.0, 73.0, 74.0, -97.0, 53.0, 98.0, 47.0, -48.0, 159.0, -42.0, 56.0, 10.0, -65.0, -7.0, 68.0, -196.0, 47.0, -145.0, 302.0, 66.0, 51.0, -223.0, 62.0, -60.0, -291.0, -216.0, 183.0, 40.0, -111.0, 46.0, -28.0, 148.0, 64.0, 12.0, 359.0, -196.0, 301.0, -53.0, 18.0, -38.0, 326.0, -275.0, 202.0, 100.0, -27.0, 259.0, -64.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.0, 140.0, 107.0, 0.0, 50.0, 105.0, 137.0, 45.0, -54.0, -70.0, 61.0, -24.0, -68.0, -166.0, 135.0, 0.0, 0.0, 11.0, 57.0, 175.0, -52.0, 3.0, 0.0, -124.0, 56.0, 106.0, 77.0, 126.0, -186.0, 84.0, 2.0, -241.0, -139.0, 35.0, -5.0, 143.0, -222.0, -241.0, 182.0, 42.0, 8.0, -37.0, -22.0, -215.0, 99.0, 38.0, 101.0, 59.0, 200.0, 176.0, 16.0, -1.0, 0.0, -31.0, 60.0, -103.0, -25.0, -360.0, 0.0, 107.0, -95.0, -90.0, -275.0, -21.0, 88.0, 72.0, 2.0, -220.0, -69.0, -54.0, 30.0, 181.0, 74.0, 156.0, -9.0, 194.0, 166.0, 69.0, -65.0, -182.0, 77.0, 144.0, 12.0, -181.0, -166.0, -97.0, -169.0, -107.0, 26.0, -133.0, -211.0, 101.0, 32.0, 75.0, 31.0, -112.0, 29.0, -113.0, -112.0, -63.0, 0.0, 108.0, 148.0, -133.0, -355.0, -142.0, -20.0, 17.0, -2.0, 5.0, 119.0, -146.0, -159.0, -98.0, -80.0, -5.0, 140.0, -201.0, 97.0, -194.0, -232.0, 11.0, 148.0, -39.0, -136.0, 0.0, -39.0, 51.0, -151.0, 27.0, -97.0, -103.0, 149.0, -364.0, -27.0, 69.0, -245.0, -186.0, -169.0, 74.0, -358.0, -106.0, 56.0, 200.0, 141.0, -150.0, 37.0, 6.0, -278.0, -84.0, 38.0, -54.0, 9.0, -211.0, -376.0, -107.0, -208.0, -292.0, -23.0, 148.0, -68.0, 47.0, -138.0, -93.0, -37.0, 7.0, -145.0, -3.0, 138.0, 0.0, -184.0, 76.0, 80.0, -256.0, 169.0, 190.0, -182.0, -158.0, 185.0, 116.0, -269.0, -7.0, -72.0, -3.0, -122.0, 1.0, 152.0, 168.0, -318.0, -263.0, 151.0, 25.0, -131.0, 158.0, -145.0, 7.0, 101.0, 146.0, 0.0, -207.0], "policy_predator_policy_reward": [0.0, 0.0, 13.0, 5.0, 15.0, 4.0, 49.0, 0.0, 21.0, 91.0, 9.0, 59.0, 99.0, 86.0, 0.0, 29.0, 6.0, 10.0, 0.0, 0.0, 33.0, 0.0, 13.0, 60.0, 0.0, 0.0, 0.0, 0.0, 94.0, 0.0, 135.0, 0.0, 117.0, 47.0, 23.0, 0.0, 154.0, 77.0, 23.0, 6.0, 0.0, 88.0, 139.0, 0.0, 0.0, 18.0, 0.0, 0.0, 8.0, 0.0, 96.0, 16.0, 0.0, 60.0, 21.0, 87.0, 111.0, 189.0, 2.0, 0.0, 115.0, 71.0, 139.0, 32.0, 0.0, 0.0, 69.0, 56.0, 71.0, 55.0, 54.0, 11.0, 0.0, 1.0, 17.0, 0.0, 0.0, 0.0, 168.0, 0.0, 0.0, 37.0, 64.0, 97.0, 75.0, 75.0, 114.0, 124.0, 126.0, 24.0, 30.0, 135.0, 17.0, 30.0, 51.0, 35.0, 11.0, 82.0, 58.0, 73.0, 0.0, 0.0, 93.0, 18.0, 172.0, 103.0, 0.0, 78.0, 28.0, 42.0, 76.0, 25.0, 37.0, 123.0, 132.0, 6.0, 83.0, 76.0, 94.0, 50.0, 144.0, 29.0, 17.0, 33.0, 2.0, 92.0, 0.0, 44.0, 118.0, 16.0, 0.0, 135.0, 40.0, 168.0, 25.0, 1.0, 124.0, 111.0, 77.0, 65.0, 165.0, 154.0, 41.0, 5.0, 75.0, 0.0, 8.0, 0.0, 139.0, 0.0, 27.0, 51.0, 8.0, 134.0, 0.0, 192.0, 151.0, 133.0, 38.0, 20.0, 61.0, 0.0, 0.0, 120.0, 70.0, 6.0, 62.0, 58.0, 0.0, 10.0, 7.0, 165.0, 104.0, 84.0, 0.0, 0.0, 0.0, 144.0, 0.0, 0.0, 103.0, 120.0, 3.0, 90.0, 8.0, 75.0, 6.0, 0.0, 168.0, 138.0, 0.0, 26.0, 0.0, 73.0, 66.0, 45.0, 12.0, 0.0, 143.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4888104346814106, "mean_inference_ms": 4.650718845505651, "mean_action_processing_ms": 0.6867640936352879, "mean_env_wait_ms": 0.603626866296053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08781611919403076, "StateBufferConnector_ms": 0.005096793174743652, "ViewRequirementAgentConnector_ms": 0.367694616317749}, "num_episodes": 23, "episode_return_max": 384.0, "episode_return_min": -291.0, "episode_return_mean": 47.56, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 170.1817135291625, "num_env_steps_trained_throughput_per_sec": 170.1817135291625, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 116554.452, "restore_workers_time_ms": 0.022, "training_step_time_ms": 116554.343, "sample_time_ms": 4288.67, "learn_time_ms": 112224.706, "learn_throughput": 35.643, "synch_weights_time_ms": 32.333}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "45bed_00000", "date": "2024-08-13_01-36-40", "timestamp": 1723527400, "time_this_iter_s": 23.58484411239624, "time_total_s": 1589.9608025550842, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33074eb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1589.9608025550842, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 89.96363636363637, "ram_util_percent": 83.72121212121212}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7573806636232547, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.531145996013016, "policy_loss": -0.005341774588278322, "vf_loss": 5.536327442290291, "vf_explained_var": 0.025195210730587995, "kl": 0.012826149290027802, "entropy": 1.1519510989466673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.101761924085164, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.188169224552377, "policy_loss": -0.0022170291255134596, "vf_loss": 8.190386183047421, "vf_explained_var": -0.14957667535574978, "kl": 0.004677633629896187, "entropy": 1.1178589202739575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 384.0, "episode_reward_min": -291.0, "episode_reward_mean": 31.73, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -376.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -39.625, "predator_policy": 55.49}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-232.0, 253.0, 59.0, -98.0, 155.0, 160.0, 384.0, 127.0, 29.0, 65.0, -85.0, 109.0, 1.0, -125.0, 160.0, -93.0, 3.0, 276.0, 231.0, 202.0, 235.0, -79.0, 258.0, -8.0, -113.0, -38.0, 43.0, 55.0, 154.0, 5.0, 9.0, -44.0, 108.0, 126.0, -222.0, 75.0, 73.0, 74.0, -97.0, 53.0, 98.0, 47.0, -48.0, 159.0, -42.0, 56.0, 10.0, -65.0, -7.0, 68.0, -196.0, 47.0, -145.0, 302.0, 66.0, 51.0, -223.0, 62.0, -60.0, -291.0, -216.0, 183.0, 40.0, -111.0, 46.0, -28.0, 148.0, 64.0, 12.0, 359.0, -196.0, 301.0, -53.0, 18.0, -38.0, 326.0, -275.0, 202.0, 100.0, -27.0, 259.0, -64.0, -136.0, 73.0, -23.0, 110.0, -94.0, -205.0, 145.0, 232.0, -136.0, 125.0, 3.0, 83.0, -136.0, 77.0, 8.0, -20.0, -201.0, 81.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-222.0, -241.0, 182.0, 42.0, 8.0, -37.0, -22.0, -215.0, 99.0, 38.0, 101.0, 59.0, 200.0, 176.0, 16.0, -1.0, 0.0, -31.0, 60.0, -103.0, -25.0, -360.0, 0.0, 107.0, -95.0, -90.0, -275.0, -21.0, 88.0, 72.0, 2.0, -220.0, -69.0, -54.0, 30.0, 181.0, 74.0, 156.0, -9.0, 194.0, 166.0, 69.0, -65.0, -182.0, 77.0, 144.0, 12.0, -181.0, -166.0, -97.0, -169.0, -107.0, 26.0, -133.0, -211.0, 101.0, 32.0, 75.0, 31.0, -112.0, 29.0, -113.0, -112.0, -63.0, 0.0, 108.0, 148.0, -133.0, -355.0, -142.0, -20.0, 17.0, -2.0, 5.0, 119.0, -146.0, -159.0, -98.0, -80.0, -5.0, 140.0, -201.0, 97.0, -194.0, -232.0, 11.0, 148.0, -39.0, -136.0, 0.0, -39.0, 51.0, -151.0, 27.0, -97.0, -103.0, 149.0, -364.0, -27.0, 69.0, -245.0, -186.0, -169.0, 74.0, -358.0, -106.0, 56.0, 200.0, 141.0, -150.0, 37.0, 6.0, -278.0, -84.0, 38.0, -54.0, 9.0, -211.0, -376.0, -107.0, -208.0, -292.0, -23.0, 148.0, -68.0, 47.0, -138.0, -93.0, -37.0, 7.0, -145.0, -3.0, 138.0, 0.0, -184.0, 76.0, 80.0, -256.0, 169.0, 190.0, -182.0, -158.0, 185.0, 116.0, -269.0, -7.0, -72.0, -3.0, -122.0, 1.0, 152.0, 168.0, -318.0, -263.0, 151.0, 25.0, -131.0, 158.0, -145.0, 7.0, 101.0, 146.0, 0.0, -207.0, -226.0, -70.0, -53.0, 34.0, -299.0, 85.0, 38.0, 68.0, -129.0, -158.0, -160.0, -265.0, -14.0, 137.0, 59.0, 143.0, -358.0, 0.0, 127.0, -38.0, 99.0, -243.0, 25.0, 7.0, -299.0, 0.0, -5.0, 11.0, -86.0, 0.0, -116.0, -22.0, -328.0, -59.0, -38.0, 18.0], "policy_predator_policy_reward": [154.0, 77.0, 23.0, 6.0, 0.0, 88.0, 139.0, 0.0, 0.0, 18.0, 0.0, 0.0, 8.0, 0.0, 96.0, 16.0, 0.0, 60.0, 21.0, 87.0, 111.0, 189.0, 2.0, 0.0, 115.0, 71.0, 139.0, 32.0, 0.0, 0.0, 69.0, 56.0, 71.0, 55.0, 54.0, 11.0, 0.0, 1.0, 17.0, 0.0, 0.0, 0.0, 168.0, 0.0, 0.0, 37.0, 64.0, 97.0, 75.0, 75.0, 114.0, 124.0, 126.0, 24.0, 30.0, 135.0, 17.0, 30.0, 51.0, 35.0, 11.0, 82.0, 58.0, 73.0, 0.0, 0.0, 93.0, 18.0, 172.0, 103.0, 0.0, 78.0, 28.0, 42.0, 76.0, 25.0, 37.0, 123.0, 132.0, 6.0, 83.0, 76.0, 94.0, 50.0, 144.0, 29.0, 17.0, 33.0, 2.0, 92.0, 0.0, 44.0, 118.0, 16.0, 0.0, 135.0, 40.0, 168.0, 25.0, 1.0, 124.0, 111.0, 77.0, 65.0, 165.0, 154.0, 41.0, 5.0, 75.0, 0.0, 8.0, 0.0, 139.0, 0.0, 27.0, 51.0, 8.0, 134.0, 0.0, 192.0, 151.0, 133.0, 38.0, 20.0, 61.0, 0.0, 0.0, 120.0, 70.0, 6.0, 62.0, 58.0, 0.0, 10.0, 7.0, 165.0, 104.0, 84.0, 0.0, 0.0, 0.0, 144.0, 0.0, 0.0, 103.0, 120.0, 3.0, 90.0, 8.0, 75.0, 6.0, 0.0, 168.0, 138.0, 0.0, 26.0, 0.0, 73.0, 66.0, 45.0, 12.0, 0.0, 143.0, 0.0, 160.0, 0.0, 57.0, 35.0, 15.0, 176.0, 4.0, 0.0, 108.0, 85.0, 32.0, 188.0, 2.0, 20.0, 8.0, 22.0, 174.0, 48.0, 1.0, 35.0, 0.0, 147.0, 51.0, 0.0, 0.0, 163.0, 71.0, 0.0, 62.0, 32.0, 59.0, 59.0, 173.0, 13.0, 78.0, 23.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4950079873320885, "mean_inference_ms": 4.656428573457827, "mean_action_processing_ms": 0.7165136573327233, "mean_env_wait_ms": 0.6030028848721598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07337319850921631, "StateBufferConnector_ms": 0.0052127838134765625, "ViewRequirementAgentConnector_ms": 0.38163650035858154}, "num_episodes": 18, "episode_return_max": 384.0, "episode_return_min": -291.0, "episode_return_mean": 31.73, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 184.73762271385732, "num_env_steps_trained_throughput_per_sec": 184.73762271385732, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 116759.332, "restore_workers_time_ms": 0.022, "training_step_time_ms": 116759.221, "sample_time_ms": 4419.709, "learn_time_ms": 112299.617, "learn_throughput": 35.619, "synch_weights_time_ms": 31.17}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "45bed_00000", "date": "2024-08-13_01-37-02", "timestamp": 1723527422, "time_this_iter_s": 21.730952978134155, "time_total_s": 1611.6917555332184, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3307523a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1611.6917555332184, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 89.4967741935484, "ram_util_percent": 83.6935483870968}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7980965963550031, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.605482584584958, "policy_loss": -0.0037162529302159786, "vf_loss": 6.608968353776074, "vf_explained_var": 0.014582423558310856, "kl": 0.01843888553829837, "entropy": 1.010087113973325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.222595857186292, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.481746466702255, "policy_loss": -0.0026227622411199034, "vf_loss": 8.484369216394173, "vf_explained_var": -0.05539749248948678, "kl": 0.004772875296318956, "entropy": 1.0111539307410125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 363.0, "episode_reward_min": -323.0, "episode_reward_mean": 21.93, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -376.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -47.765, "predator_policy": 58.73}, "custom_metrics": {}, "hist_stats": {"episode_reward": [231.0, 202.0, 235.0, -79.0, 258.0, -8.0, -113.0, -38.0, 43.0, 55.0, 154.0, 5.0, 9.0, -44.0, 108.0, 126.0, -222.0, 75.0, 73.0, 74.0, -97.0, 53.0, 98.0, 47.0, -48.0, 159.0, -42.0, 56.0, 10.0, -65.0, -7.0, 68.0, -196.0, 47.0, -145.0, 302.0, 66.0, 51.0, -223.0, 62.0, -60.0, -291.0, -216.0, 183.0, 40.0, -111.0, 46.0, -28.0, 148.0, 64.0, 12.0, 359.0, -196.0, 301.0, -53.0, 18.0, -38.0, 326.0, -275.0, 202.0, 100.0, -27.0, 259.0, -64.0, -136.0, 73.0, -23.0, 110.0, -94.0, -205.0, 145.0, 232.0, -136.0, 125.0, 3.0, 83.0, -136.0, 77.0, 8.0, -20.0, -201.0, 81.0, -115.0, -63.0, 48.0, 257.0, -120.0, 70.0, 87.0, -314.0, 363.0, -118.0, 64.0, -54.0, -52.0, -323.0, 154.0, 189.0, -88.0, 183.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [74.0, 156.0, -9.0, 194.0, 166.0, 69.0, -65.0, -182.0, 77.0, 144.0, 12.0, -181.0, -166.0, -97.0, -169.0, -107.0, 26.0, -133.0, -211.0, 101.0, 32.0, 75.0, 31.0, -112.0, 29.0, -113.0, -112.0, -63.0, 0.0, 108.0, 148.0, -133.0, -355.0, -142.0, -20.0, 17.0, -2.0, 5.0, 119.0, -146.0, -159.0, -98.0, -80.0, -5.0, 140.0, -201.0, 97.0, -194.0, -232.0, 11.0, 148.0, -39.0, -136.0, 0.0, -39.0, 51.0, -151.0, 27.0, -97.0, -103.0, 149.0, -364.0, -27.0, 69.0, -245.0, -186.0, -169.0, 74.0, -358.0, -106.0, 56.0, 200.0, 141.0, -150.0, 37.0, 6.0, -278.0, -84.0, 38.0, -54.0, 9.0, -211.0, -376.0, -107.0, -208.0, -292.0, -23.0, 148.0, -68.0, 47.0, -138.0, -93.0, -37.0, 7.0, -145.0, -3.0, 138.0, 0.0, -184.0, 76.0, 80.0, -256.0, 169.0, 190.0, -182.0, -158.0, 185.0, 116.0, -269.0, -7.0, -72.0, -3.0, -122.0, 1.0, 152.0, 168.0, -318.0, -263.0, 151.0, 25.0, -131.0, 158.0, -145.0, 7.0, 101.0, 146.0, 0.0, -207.0, -226.0, -70.0, -53.0, 34.0, -299.0, 85.0, 38.0, 68.0, -129.0, -158.0, -160.0, -265.0, -14.0, 137.0, 59.0, 143.0, -358.0, 0.0, 127.0, -38.0, 99.0, -243.0, 25.0, 7.0, -299.0, 0.0, -5.0, 11.0, -86.0, 0.0, -116.0, -22.0, -328.0, -59.0, -38.0, 18.0, -60.0, -277.0, -127.0, -144.0, -127.0, 37.0, 180.0, -19.0, 0.0, -304.0, 0.0, -35.0, -88.0, 51.0, -262.0, -271.0, 194.0, 158.0, -167.0, -96.0, 59.0, -73.0, 88.0, -311.0, -2.0, -181.0, -316.0, -187.0, 83.0, -34.0, -6.0, 136.0, -168.0, -66.0, -89.0, 176.0], "policy_predator_policy_reward": [0.0, 1.0, 17.0, 0.0, 0.0, 0.0, 168.0, 0.0, 0.0, 37.0, 64.0, 97.0, 75.0, 75.0, 114.0, 124.0, 126.0, 24.0, 30.0, 135.0, 17.0, 30.0, 51.0, 35.0, 11.0, 82.0, 58.0, 73.0, 0.0, 0.0, 93.0, 18.0, 172.0, 103.0, 0.0, 78.0, 28.0, 42.0, 76.0, 25.0, 37.0, 123.0, 132.0, 6.0, 83.0, 76.0, 94.0, 50.0, 144.0, 29.0, 17.0, 33.0, 2.0, 92.0, 0.0, 44.0, 118.0, 16.0, 0.0, 135.0, 40.0, 168.0, 25.0, 1.0, 124.0, 111.0, 77.0, 65.0, 165.0, 154.0, 41.0, 5.0, 75.0, 0.0, 8.0, 0.0, 139.0, 0.0, 27.0, 51.0, 8.0, 134.0, 0.0, 192.0, 151.0, 133.0, 38.0, 20.0, 61.0, 0.0, 0.0, 120.0, 70.0, 6.0, 62.0, 58.0, 0.0, 10.0, 7.0, 165.0, 104.0, 84.0, 0.0, 0.0, 0.0, 144.0, 0.0, 0.0, 103.0, 120.0, 3.0, 90.0, 8.0, 75.0, 6.0, 0.0, 168.0, 138.0, 0.0, 26.0, 0.0, 73.0, 66.0, 45.0, 12.0, 0.0, 143.0, 0.0, 160.0, 0.0, 57.0, 35.0, 15.0, 176.0, 4.0, 0.0, 108.0, 85.0, 32.0, 188.0, 2.0, 20.0, 8.0, 22.0, 174.0, 48.0, 1.0, 35.0, 0.0, 147.0, 51.0, 0.0, 0.0, 163.0, 71.0, 0.0, 62.0, 32.0, 59.0, 59.0, 173.0, 13.0, 78.0, 23.0, 161.0, 61.0, 114.0, 94.0, 78.0, 60.0, 26.0, 70.0, 158.0, 26.0, 56.0, 49.0, 54.0, 70.0, 146.0, 73.0, 11.0, 0.0, 145.0, 0.0, 44.0, 34.0, 169.0, 0.0, 0.0, 131.0, 168.0, 12.0, 73.0, 32.0, 5.0, 54.0, 27.0, 119.0, 91.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5089345774914649, "mean_inference_ms": 4.683898143023491, "mean_action_processing_ms": 0.7486482694962814, "mean_env_wait_ms": 0.6047591357269552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07279205322265625, "StateBufferConnector_ms": 0.00520777702331543, "ViewRequirementAgentConnector_ms": 0.41890907287597656}, "num_episodes": 18, "episode_return_max": 363.0, "episode_return_min": -323.0, "episode_return_mean": 21.93, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 182.15502812140153, "num_env_steps_trained_throughput_per_sec": 182.15502812140153, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 117004.962, "restore_workers_time_ms": 0.021, "training_step_time_ms": 117004.855, "sample_time_ms": 4533.521, "learn_time_ms": 112430.941, "learn_throughput": 35.577, "synch_weights_time_ms": 31.592}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "45bed_00000", "date": "2024-08-13_01-37-24", "timestamp": 1723527444, "time_this_iter_s": 22.01063299179077, "time_total_s": 1633.7023885250092, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33073cd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1633.7023885250092, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 87.16451612903225, "ram_util_percent": 83.30645161290325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.698917875340376, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.72756388452318, "policy_loss": -0.0027327550974275386, "vf_loss": 5.730088479178292, "vf_explained_var": 0.007727171756603099, "kl": 0.01665259849763756, "entropy": 1.0228327632265748, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.722186198042184, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.489049918815573, "policy_loss": -0.00013334641711066955, "vf_loss": 8.489183259388756, "vf_explained_var": -0.08464380285096547, "kl": 0.0019144290979750678, "entropy": 1.0751334512990618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 363.0, "episode_reward_min": -323.0, "episode_reward_mean": 24.85, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -388.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": -48.44, "predator_policy": 60.865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.0, 74.0, -97.0, 53.0, 98.0, 47.0, -48.0, 159.0, -42.0, 56.0, 10.0, -65.0, -7.0, 68.0, -196.0, 47.0, -145.0, 302.0, 66.0, 51.0, -223.0, 62.0, -60.0, -291.0, -216.0, 183.0, 40.0, -111.0, 46.0, -28.0, 148.0, 64.0, 12.0, 359.0, -196.0, 301.0, -53.0, 18.0, -38.0, 326.0, -275.0, 202.0, 100.0, -27.0, 259.0, -64.0, -136.0, 73.0, -23.0, 110.0, -94.0, -205.0, 145.0, 232.0, -136.0, 125.0, 3.0, 83.0, -136.0, 77.0, 8.0, -20.0, -201.0, 81.0, -115.0, -63.0, 48.0, 257.0, -120.0, 70.0, 87.0, -314.0, 363.0, -118.0, 64.0, -54.0, -52.0, -323.0, 154.0, 189.0, -88.0, 183.0, -76.0, 91.0, 270.0, -111.0, -1.0, 260.0, 348.0, -9.0, -45.0, 88.0, 39.0, 0.0, 67.0, -125.0, 157.0, 110.0, -20.0, 246.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, 5.0, 119.0, -146.0, -159.0, -98.0, -80.0, -5.0, 140.0, -201.0, 97.0, -194.0, -232.0, 11.0, 148.0, -39.0, -136.0, 0.0, -39.0, 51.0, -151.0, 27.0, -97.0, -103.0, 149.0, -364.0, -27.0, 69.0, -245.0, -186.0, -169.0, 74.0, -358.0, -106.0, 56.0, 200.0, 141.0, -150.0, 37.0, 6.0, -278.0, -84.0, 38.0, -54.0, 9.0, -211.0, -376.0, -107.0, -208.0, -292.0, -23.0, 148.0, -68.0, 47.0, -138.0, -93.0, -37.0, 7.0, -145.0, -3.0, 138.0, 0.0, -184.0, 76.0, 80.0, -256.0, 169.0, 190.0, -182.0, -158.0, 185.0, 116.0, -269.0, -7.0, -72.0, -3.0, -122.0, 1.0, 152.0, 168.0, -318.0, -263.0, 151.0, 25.0, -131.0, 158.0, -145.0, 7.0, 101.0, 146.0, 0.0, -207.0, -226.0, -70.0, -53.0, 34.0, -299.0, 85.0, 38.0, 68.0, -129.0, -158.0, -160.0, -265.0, -14.0, 137.0, 59.0, 143.0, -358.0, 0.0, 127.0, -38.0, 99.0, -243.0, 25.0, 7.0, -299.0, 0.0, -5.0, 11.0, -86.0, 0.0, -116.0, -22.0, -328.0, -59.0, -38.0, 18.0, -60.0, -277.0, -127.0, -144.0, -127.0, 37.0, 180.0, -19.0, 0.0, -304.0, 0.0, -35.0, -88.0, 51.0, -262.0, -271.0, 194.0, 158.0, -167.0, -96.0, 59.0, -73.0, 88.0, -311.0, -2.0, -181.0, -316.0, -187.0, 83.0, -34.0, -6.0, 136.0, -168.0, -66.0, -89.0, 176.0, 0.0, -388.0, 145.0, -307.0, 137.0, 68.0, -210.0, -85.0, 0.0, -2.0, 26.0, 173.0, 179.0, 162.0, 0.0, -18.0, -349.0, 15.0, -30.0, 2.0, -227.0, 99.0, 0.0, 0.0, 3.0, -75.0, -69.0, -334.0, 143.0, 14.0, -219.0, 112.0, 167.0, -384.0, 8.0, 198.0], "policy_predator_policy_reward": [28.0, 42.0, 76.0, 25.0, 37.0, 123.0, 132.0, 6.0, 83.0, 76.0, 94.0, 50.0, 144.0, 29.0, 17.0, 33.0, 2.0, 92.0, 0.0, 44.0, 118.0, 16.0, 0.0, 135.0, 40.0, 168.0, 25.0, 1.0, 124.0, 111.0, 77.0, 65.0, 165.0, 154.0, 41.0, 5.0, 75.0, 0.0, 8.0, 0.0, 139.0, 0.0, 27.0, 51.0, 8.0, 134.0, 0.0, 192.0, 151.0, 133.0, 38.0, 20.0, 61.0, 0.0, 0.0, 120.0, 70.0, 6.0, 62.0, 58.0, 0.0, 10.0, 7.0, 165.0, 104.0, 84.0, 0.0, 0.0, 0.0, 144.0, 0.0, 0.0, 103.0, 120.0, 3.0, 90.0, 8.0, 75.0, 6.0, 0.0, 168.0, 138.0, 0.0, 26.0, 0.0, 73.0, 66.0, 45.0, 12.0, 0.0, 143.0, 0.0, 160.0, 0.0, 57.0, 35.0, 15.0, 176.0, 4.0, 0.0, 108.0, 85.0, 32.0, 188.0, 2.0, 20.0, 8.0, 22.0, 174.0, 48.0, 1.0, 35.0, 0.0, 147.0, 51.0, 0.0, 0.0, 163.0, 71.0, 0.0, 62.0, 32.0, 59.0, 59.0, 173.0, 13.0, 78.0, 23.0, 161.0, 61.0, 114.0, 94.0, 78.0, 60.0, 26.0, 70.0, 158.0, 26.0, 56.0, 49.0, 54.0, 70.0, 146.0, 73.0, 11.0, 0.0, 145.0, 0.0, 44.0, 34.0, 169.0, 0.0, 0.0, 131.0, 168.0, 12.0, 73.0, 32.0, 5.0, 54.0, 27.0, 119.0, 91.0, 5.0, 131.0, 181.0, 140.0, 113.0, 0.0, 65.0, 74.0, 110.0, 0.0, 1.0, 0.0, 61.0, 7.0, 0.0, 0.0, 9.0, 111.0, 178.0, 31.0, 85.0, 136.0, 31.0, 0.0, 0.0, 40.0, 99.0, 176.0, 102.0, 0.0, 0.0, 86.0, 131.0, 3.0, 194.0, 40.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5092879301578181, "mean_inference_ms": 4.671463777419805, "mean_action_processing_ms": 0.7747989737710934, "mean_env_wait_ms": 0.6018858915875981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04722738265991211, "StateBufferConnector_ms": 0.0064133405685424805, "ViewRequirementAgentConnector_ms": 0.3149557113647461}, "num_episodes": 18, "episode_return_max": 363.0, "episode_return_min": -323.0, "episode_return_mean": 24.85, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 180.71367723933807, "num_env_steps_trained_throughput_per_sec": 180.71367723933807, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 117454.808, "restore_workers_time_ms": 0.021, "training_step_time_ms": 117454.7, "sample_time_ms": 4497.583, "learn_time_ms": 112907.991, "learn_throughput": 35.427, "synch_weights_time_ms": 40.315}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "45bed_00000", "date": "2024-08-13_01-37-47", "timestamp": 1723527467, "time_this_iter_s": 22.38410186767578, "time_total_s": 1656.086490392685, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4449ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1656.086490392685, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 85.80000000000001, "ram_util_percent": 83.56129032258063}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7371875541629614, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.450204608806227, "policy_loss": -0.003089934773496771, "vf_loss": 5.453155796868461, "vf_explained_var": 0.018607111488069806, "kl": 0.011099133536655321, "entropy": 1.0445588592499022, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.325852771521244, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.052920023852556, "policy_loss": -0.001471603409727178, "vf_loss": 8.054391619768092, "vf_explained_var": 0.07813966498173103, "kl": 0.0026755227463368895, "entropy": 1.2137973762693859, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 363.0, "episode_reward_min": -323.0, "episode_reward_mean": 39.77, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -388.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": -35.865, "predator_policy": 55.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-111.0, 46.0, -28.0, 148.0, 64.0, 12.0, 359.0, -196.0, 301.0, -53.0, 18.0, -38.0, 326.0, -275.0, 202.0, 100.0, -27.0, 259.0, -64.0, -136.0, 73.0, -23.0, 110.0, -94.0, -205.0, 145.0, 232.0, -136.0, 125.0, 3.0, 83.0, -136.0, 77.0, 8.0, -20.0, -201.0, 81.0, -115.0, -63.0, 48.0, 257.0, -120.0, 70.0, 87.0, -314.0, 363.0, -118.0, 64.0, -54.0, -52.0, -323.0, 154.0, 189.0, -88.0, 183.0, -76.0, 91.0, 270.0, -111.0, -1.0, 260.0, 348.0, -9.0, -45.0, 88.0, 39.0, 0.0, 67.0, -125.0, 157.0, 110.0, -20.0, 246.0, 11.0, -86.0, 196.0, 69.0, 57.0, 65.0, 337.0, -233.0, -3.0, -6.0, -135.0, -7.0, 97.0, 283.0, 143.0, -22.0, 175.0, -202.0, -18.0, 36.0, 109.0, 67.0, 65.0, 152.0, -120.0, 211.0, 250.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-138.0, -93.0, -37.0, 7.0, -145.0, -3.0, 138.0, 0.0, -184.0, 76.0, 80.0, -256.0, 169.0, 190.0, -182.0, -158.0, 185.0, 116.0, -269.0, -7.0, -72.0, -3.0, -122.0, 1.0, 152.0, 168.0, -318.0, -263.0, 151.0, 25.0, -131.0, 158.0, -145.0, 7.0, 101.0, 146.0, 0.0, -207.0, -226.0, -70.0, -53.0, 34.0, -299.0, 85.0, 38.0, 68.0, -129.0, -158.0, -160.0, -265.0, -14.0, 137.0, 59.0, 143.0, -358.0, 0.0, 127.0, -38.0, 99.0, -243.0, 25.0, 7.0, -299.0, 0.0, -5.0, 11.0, -86.0, 0.0, -116.0, -22.0, -328.0, -59.0, -38.0, 18.0, -60.0, -277.0, -127.0, -144.0, -127.0, 37.0, 180.0, -19.0, 0.0, -304.0, 0.0, -35.0, -88.0, 51.0, -262.0, -271.0, 194.0, 158.0, -167.0, -96.0, 59.0, -73.0, 88.0, -311.0, -2.0, -181.0, -316.0, -187.0, 83.0, -34.0, -6.0, 136.0, -168.0, -66.0, -89.0, 176.0, 0.0, -388.0, 145.0, -307.0, 137.0, 68.0, -210.0, -85.0, 0.0, -2.0, 26.0, 173.0, 179.0, 162.0, 0.0, -18.0, -349.0, 15.0, -30.0, 2.0, -227.0, 99.0, 0.0, 0.0, 3.0, -75.0, -69.0, -334.0, 143.0, 14.0, -219.0, 112.0, 167.0, -384.0, 8.0, 198.0, -136.0, 64.0, 0.0, -190.0, 131.0, 42.0, 89.0, -47.0, -85.0, 91.0, 0.0, 46.0, 177.0, 150.0, -190.0, -302.0, -10.0, -49.0, -116.0, 17.0, -119.0, -154.0, 0.0, -56.0, 0.0, 61.0, 143.0, 104.0, 136.0, 0.0, 45.0, -242.0, 189.0, -109.0, -16.0, -383.0, -277.0, 42.0, 160.0, -292.0, 25.0, 0.0, -130.0, 108.0, 95.0, -134.0, 153.0, -2.0, -48.0, -305.0, -21.0, 194.0, 125.0, 125.0], "policy_predator_policy_reward": [0.0, 120.0, 70.0, 6.0, 62.0, 58.0, 0.0, 10.0, 7.0, 165.0, 104.0, 84.0, 0.0, 0.0, 0.0, 144.0, 0.0, 0.0, 103.0, 120.0, 3.0, 90.0, 8.0, 75.0, 6.0, 0.0, 168.0, 138.0, 0.0, 26.0, 0.0, 73.0, 66.0, 45.0, 12.0, 0.0, 143.0, 0.0, 160.0, 0.0, 57.0, 35.0, 15.0, 176.0, 4.0, 0.0, 108.0, 85.0, 32.0, 188.0, 2.0, 20.0, 8.0, 22.0, 174.0, 48.0, 1.0, 35.0, 0.0, 147.0, 51.0, 0.0, 0.0, 163.0, 71.0, 0.0, 62.0, 32.0, 59.0, 59.0, 173.0, 13.0, 78.0, 23.0, 161.0, 61.0, 114.0, 94.0, 78.0, 60.0, 26.0, 70.0, 158.0, 26.0, 56.0, 49.0, 54.0, 70.0, 146.0, 73.0, 11.0, 0.0, 145.0, 0.0, 44.0, 34.0, 169.0, 0.0, 0.0, 131.0, 168.0, 12.0, 73.0, 32.0, 5.0, 54.0, 27.0, 119.0, 91.0, 5.0, 131.0, 181.0, 140.0, 113.0, 0.0, 65.0, 74.0, 110.0, 0.0, 1.0, 0.0, 61.0, 7.0, 0.0, 0.0, 9.0, 111.0, 178.0, 31.0, 85.0, 136.0, 31.0, 0.0, 0.0, 40.0, 99.0, 176.0, 102.0, 0.0, 0.0, 86.0, 131.0, 3.0, 194.0, 40.0, 0.0, 33.0, 50.0, 5.0, 99.0, 23.0, 0.0, 0.0, 27.0, 51.0, 0.0, 19.0, 0.0, 3.0, 7.0, 138.0, 121.0, 14.0, 42.0, 93.0, 0.0, 126.0, 12.0, 21.0, 28.0, 4.0, 32.0, 14.0, 22.0, 7.0, 0.0, 65.0, 110.0, 43.0, 52.0, 88.0, 109.0, 36.0, 181.0, 119.0, 49.0, 38.0, 46.0, 70.0, 19.0, 46.0, 58.0, 0.0, 1.0, 103.0, 130.0, 36.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5261322367161305, "mean_inference_ms": 4.650334079483736, "mean_action_processing_ms": 0.8235670897798948, "mean_env_wait_ms": 0.5995761341580306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010670065879821777, "StateBufferConnector_ms": 0.006426334381103516, "ViewRequirementAgentConnector_ms": 0.3709765672683716}, "num_episodes": 27, "episode_return_max": 363.0, "episode_return_min": -323.0, "episode_return_mean": 39.77, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.95396683379533, "num_env_steps_trained_throughput_per_sec": 155.95396683379533, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 117710.977, "restore_workers_time_ms": 0.021, "training_step_time_ms": 117710.869, "sample_time_ms": 4654.312, "learn_time_ms": 113012.137, "learn_throughput": 35.394, "synch_weights_time_ms": 35.717}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "45bed_00000", "date": "2024-08-13_01-38-12", "timestamp": 1723527492, "time_this_iter_s": 25.699497938156128, "time_total_s": 1681.785988330841, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33074e700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1681.785988330841, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 87.64054054054054, "ram_util_percent": 83.15675675675676}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6472574014551741, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.037466857294557, "policy_loss": -0.0027481218206168957, "vf_loss": 6.04003142477974, "vf_explained_var": 0.008989285382013473, "kl": 0.014684764565109235, "entropy": 1.0748444600080056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.958909199950556, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.781142063241788, "policy_loss": -0.0015985767280673065, "vf_loss": 8.782740628277814, "vf_explained_var": 0.08047618809200469, "kl": 0.0038166201931180356, "entropy": 1.1789470624671412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 363.0, "episode_reward_min": -323.0, "episode_reward_mean": 36.7, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": -41.715, "predator_policy": 60.065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-64.0, -136.0, 73.0, -23.0, 110.0, -94.0, -205.0, 145.0, 232.0, -136.0, 125.0, 3.0, 83.0, -136.0, 77.0, 8.0, -20.0, -201.0, 81.0, -115.0, -63.0, 48.0, 257.0, -120.0, 70.0, 87.0, -314.0, 363.0, -118.0, 64.0, -54.0, -52.0, -323.0, 154.0, 189.0, -88.0, 183.0, -76.0, 91.0, 270.0, -111.0, -1.0, 260.0, 348.0, -9.0, -45.0, 88.0, 39.0, 0.0, 67.0, -125.0, 157.0, 110.0, -20.0, 246.0, 11.0, -86.0, 196.0, 69.0, 57.0, 65.0, 337.0, -233.0, -3.0, -6.0, -135.0, -7.0, 97.0, 283.0, 143.0, -22.0, 175.0, -202.0, -18.0, 36.0, 109.0, 67.0, 65.0, 152.0, -120.0, 211.0, 250.0, 342.0, 323.0, 44.0, -80.0, -241.0, 109.0, -128.0, 177.0, 17.0, 70.0, 104.0, 341.0, -122.0, 102.0, 76.0, 45.0, -277.0, -102.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -207.0, -226.0, -70.0, -53.0, 34.0, -299.0, 85.0, 38.0, 68.0, -129.0, -158.0, -160.0, -265.0, -14.0, 137.0, 59.0, 143.0, -358.0, 0.0, 127.0, -38.0, 99.0, -243.0, 25.0, 7.0, -299.0, 0.0, -5.0, 11.0, -86.0, 0.0, -116.0, -22.0, -328.0, -59.0, -38.0, 18.0, -60.0, -277.0, -127.0, -144.0, -127.0, 37.0, 180.0, -19.0, 0.0, -304.0, 0.0, -35.0, -88.0, 51.0, -262.0, -271.0, 194.0, 158.0, -167.0, -96.0, 59.0, -73.0, 88.0, -311.0, -2.0, -181.0, -316.0, -187.0, 83.0, -34.0, -6.0, 136.0, -168.0, -66.0, -89.0, 176.0, 0.0, -388.0, 145.0, -307.0, 137.0, 68.0, -210.0, -85.0, 0.0, -2.0, 26.0, 173.0, 179.0, 162.0, 0.0, -18.0, -349.0, 15.0, -30.0, 2.0, -227.0, 99.0, 0.0, 0.0, 3.0, -75.0, -69.0, -334.0, 143.0, 14.0, -219.0, 112.0, 167.0, -384.0, 8.0, 198.0, -136.0, 64.0, 0.0, -190.0, 131.0, 42.0, 89.0, -47.0, -85.0, 91.0, 0.0, 46.0, 177.0, 150.0, -190.0, -302.0, -10.0, -49.0, -116.0, 17.0, -119.0, -154.0, 0.0, -56.0, 0.0, 61.0, 143.0, 104.0, 136.0, 0.0, 45.0, -242.0, 189.0, -109.0, -16.0, -383.0, -277.0, 42.0, 160.0, -292.0, 25.0, 0.0, -130.0, 108.0, 95.0, -134.0, 153.0, -2.0, -48.0, -305.0, -21.0, 194.0, 125.0, 125.0, 200.0, 98.0, 161.0, 143.0, -58.0, -13.0, -400.0, -11.0, -322.0, -215.0, 152.0, -220.0, 63.0, -382.0, 0.0, 177.0, 145.0, -270.0, 18.0, 52.0, 176.0, -211.0, 146.0, 192.0, -68.0, -174.0, -303.0, 132.0, -296.0, 164.0, 1.0, 43.0, -266.0, -330.0, 0.0, -350.0], "policy_predator_policy_reward": [143.0, 0.0, 160.0, 0.0, 57.0, 35.0, 15.0, 176.0, 4.0, 0.0, 108.0, 85.0, 32.0, 188.0, 2.0, 20.0, 8.0, 22.0, 174.0, 48.0, 1.0, 35.0, 0.0, 147.0, 51.0, 0.0, 0.0, 163.0, 71.0, 0.0, 62.0, 32.0, 59.0, 59.0, 173.0, 13.0, 78.0, 23.0, 161.0, 61.0, 114.0, 94.0, 78.0, 60.0, 26.0, 70.0, 158.0, 26.0, 56.0, 49.0, 54.0, 70.0, 146.0, 73.0, 11.0, 0.0, 145.0, 0.0, 44.0, 34.0, 169.0, 0.0, 0.0, 131.0, 168.0, 12.0, 73.0, 32.0, 5.0, 54.0, 27.0, 119.0, 91.0, 5.0, 131.0, 181.0, 140.0, 113.0, 0.0, 65.0, 74.0, 110.0, 0.0, 1.0, 0.0, 61.0, 7.0, 0.0, 0.0, 9.0, 111.0, 178.0, 31.0, 85.0, 136.0, 31.0, 0.0, 0.0, 40.0, 99.0, 176.0, 102.0, 0.0, 0.0, 86.0, 131.0, 3.0, 194.0, 40.0, 0.0, 33.0, 50.0, 5.0, 99.0, 23.0, 0.0, 0.0, 27.0, 51.0, 0.0, 19.0, 0.0, 3.0, 7.0, 138.0, 121.0, 14.0, 42.0, 93.0, 0.0, 126.0, 12.0, 21.0, 28.0, 4.0, 32.0, 14.0, 22.0, 7.0, 0.0, 65.0, 110.0, 43.0, 52.0, 88.0, 109.0, 36.0, 181.0, 119.0, 49.0, 38.0, 46.0, 70.0, 19.0, 46.0, 58.0, 0.0, 1.0, 103.0, 130.0, 36.0, 2.0, 0.0, 0.0, 16.0, 28.0, 0.0, 19.0, 89.0, 26.0, 137.0, 194.0, 120.0, 176.0, 70.0, 107.0, 191.0, 0.0, 0.0, 0.0, 142.0, 0.0, 0.0, 0.0, 79.0, 60.0, 3.0, 0.0, 0.0, 120.0, 143.0, 130.0, 111.0, 97.0, 1.0, 0.0, 148.0, 171.0, 157.0, 91.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5207674548302987, "mean_inference_ms": 4.680370840728408, "mean_action_processing_ms": 0.8045768211502886, "mean_env_wait_ms": 0.5989106630362118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008138656616210938, "StateBufferConnector_ms": 0.006475090980529785, "ViewRequirementAgentConnector_ms": 0.36140990257263184}, "num_episodes": 18, "episode_return_max": 363.0, "episode_return_min": -323.0, "episode_return_mean": 36.7, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 164.68150641560538, "num_env_steps_trained_throughput_per_sec": 164.68150641560538, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 116267.903, "restore_workers_time_ms": 0.016, "training_step_time_ms": 116267.782, "sample_time_ms": 3902.474, "learn_time_ms": 112323.353, "learn_throughput": 35.611, "synch_weights_time_ms": 35.214}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "45bed_00000", "date": "2024-08-13_01-38-37", "timestamp": 1723527517, "time_this_iter_s": 24.375624895095825, "time_total_s": 1706.161613225937, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33074e1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1706.161613225937, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 85.68823529411765, "ram_util_percent": 83.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6552313771039721, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.265866388593401, "policy_loss": -0.0024605277464996096, "vf_loss": 5.268181494934849, "vf_explained_var": 0.008242461321845888, "kl": 0.01163446233462615, "entropy": 1.131176954034775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.106169758082698, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.960379777888141, "policy_loss": -0.0027146793265023796, "vf_loss": 8.96309445850433, "vf_explained_var": 0.14528574530409757, "kl": 0.005581247851230173, "entropy": 1.0948800778893566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 363.0, "episode_reward_min": -323.0, "episode_reward_mean": 52.14, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": -34.015, "predator_policy": 60.085}, "custom_metrics": {}, "hist_stats": {"episode_reward": [81.0, -115.0, -63.0, 48.0, 257.0, -120.0, 70.0, 87.0, -314.0, 363.0, -118.0, 64.0, -54.0, -52.0, -323.0, 154.0, 189.0, -88.0, 183.0, -76.0, 91.0, 270.0, -111.0, -1.0, 260.0, 348.0, -9.0, -45.0, 88.0, 39.0, 0.0, 67.0, -125.0, 157.0, 110.0, -20.0, 246.0, 11.0, -86.0, 196.0, 69.0, 57.0, 65.0, 337.0, -233.0, -3.0, -6.0, -135.0, -7.0, 97.0, 283.0, 143.0, -22.0, 175.0, -202.0, -18.0, 36.0, 109.0, 67.0, 65.0, 152.0, -120.0, 211.0, 250.0, 342.0, 323.0, 44.0, -80.0, -241.0, 109.0, -128.0, 177.0, 17.0, 70.0, 104.0, 341.0, -122.0, 102.0, 76.0, 45.0, -277.0, -102.0, 135.0, -30.0, -10.0, 271.0, 278.0, -122.0, -59.0, -1.0, 89.0, 57.0, 194.0, 98.0, -145.0, 119.0, 328.0, -267.0, 148.0, 302.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-38.0, 18.0, -60.0, -277.0, -127.0, -144.0, -127.0, 37.0, 180.0, -19.0, 0.0, -304.0, 0.0, -35.0, -88.0, 51.0, -262.0, -271.0, 194.0, 158.0, -167.0, -96.0, 59.0, -73.0, 88.0, -311.0, -2.0, -181.0, -316.0, -187.0, 83.0, -34.0, -6.0, 136.0, -168.0, -66.0, -89.0, 176.0, 0.0, -388.0, 145.0, -307.0, 137.0, 68.0, -210.0, -85.0, 0.0, -2.0, 26.0, 173.0, 179.0, 162.0, 0.0, -18.0, -349.0, 15.0, -30.0, 2.0, -227.0, 99.0, 0.0, 0.0, 3.0, -75.0, -69.0, -334.0, 143.0, 14.0, -219.0, 112.0, 167.0, -384.0, 8.0, 198.0, -136.0, 64.0, 0.0, -190.0, 131.0, 42.0, 89.0, -47.0, -85.0, 91.0, 0.0, 46.0, 177.0, 150.0, -190.0, -302.0, -10.0, -49.0, -116.0, 17.0, -119.0, -154.0, 0.0, -56.0, 0.0, 61.0, 143.0, 104.0, 136.0, 0.0, 45.0, -242.0, 189.0, -109.0, -16.0, -383.0, -277.0, 42.0, 160.0, -292.0, 25.0, 0.0, -130.0, 108.0, 95.0, -134.0, 153.0, -2.0, -48.0, -305.0, -21.0, 194.0, 125.0, 125.0, 200.0, 98.0, 161.0, 143.0, -58.0, -13.0, -400.0, -11.0, -322.0, -215.0, 152.0, -220.0, 63.0, -382.0, 0.0, 177.0, 145.0, -270.0, 18.0, 52.0, 176.0, -211.0, 146.0, 192.0, -68.0, -174.0, -303.0, 132.0, -296.0, 164.0, 1.0, 43.0, -266.0, -330.0, 0.0, -350.0, -130.0, 200.0, -274.0, 41.0, -115.0, -112.0, 91.0, 122.0, 166.0, 89.0, -217.0, -57.0, -55.0, -196.0, -219.0, 80.0, -18.0, 7.0, -17.0, -34.0, 52.0, 127.0, 138.0, -178.0, 0.0, -303.0, 49.0, 1.0, 138.0, 190.0, -324.0, -295.0, 139.0, -123.0, 136.0, 139.0], "policy_predator_policy_reward": [78.0, 23.0, 161.0, 61.0, 114.0, 94.0, 78.0, 60.0, 26.0, 70.0, 158.0, 26.0, 56.0, 49.0, 54.0, 70.0, 146.0, 73.0, 11.0, 0.0, 145.0, 0.0, 44.0, 34.0, 169.0, 0.0, 0.0, 131.0, 168.0, 12.0, 73.0, 32.0, 5.0, 54.0, 27.0, 119.0, 91.0, 5.0, 131.0, 181.0, 140.0, 113.0, 0.0, 65.0, 74.0, 110.0, 0.0, 1.0, 0.0, 61.0, 7.0, 0.0, 0.0, 9.0, 111.0, 178.0, 31.0, 85.0, 136.0, 31.0, 0.0, 0.0, 40.0, 99.0, 176.0, 102.0, 0.0, 0.0, 86.0, 131.0, 3.0, 194.0, 40.0, 0.0, 33.0, 50.0, 5.0, 99.0, 23.0, 0.0, 0.0, 27.0, 51.0, 0.0, 19.0, 0.0, 3.0, 7.0, 138.0, 121.0, 14.0, 42.0, 93.0, 0.0, 126.0, 12.0, 21.0, 28.0, 4.0, 32.0, 14.0, 22.0, 7.0, 0.0, 65.0, 110.0, 43.0, 52.0, 88.0, 109.0, 36.0, 181.0, 119.0, 49.0, 38.0, 46.0, 70.0, 19.0, 46.0, 58.0, 0.0, 1.0, 103.0, 130.0, 36.0, 2.0, 0.0, 0.0, 16.0, 28.0, 0.0, 19.0, 89.0, 26.0, 137.0, 194.0, 120.0, 176.0, 70.0, 107.0, 191.0, 0.0, 0.0, 0.0, 142.0, 0.0, 0.0, 0.0, 79.0, 60.0, 3.0, 0.0, 0.0, 120.0, 143.0, 130.0, 111.0, 97.0, 1.0, 0.0, 148.0, 171.0, 157.0, 91.0, 0.0, 65.0, 117.0, 86.0, 106.0, 111.0, 0.0, 58.0, 16.0, 7.0, 2.0, 150.0, 66.0, 126.0, 0.0, 138.0, 53.0, 47.0, 44.0, 64.0, 4.0, 11.0, 18.0, 120.0, 155.0, 3.0, 53.0, 16.0, 0.0, 0.0, 162.0, 190.0, 60.0, 72.0, 4.0, 23.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5338222882271288, "mean_inference_ms": 4.706328322691323, "mean_action_processing_ms": 0.804728379212315, "mean_env_wait_ms": 0.6007730069318147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008179903030395508, "StateBufferConnector_ms": 0.0067331790924072266, "ViewRequirementAgentConnector_ms": 0.3851679563522339}, "num_episodes": 18, "episode_return_max": 363.0, "episode_return_min": -323.0, "episode_return_mean": 52.14, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 139.5309098902489, "num_env_steps_trained_throughput_per_sec": 139.5309098902489, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 117225.867, "restore_workers_time_ms": 0.018, "training_step_time_ms": 117225.73, "sample_time_ms": 4178.68, "learn_time_ms": 113004.792, "learn_throughput": 35.397, "synch_weights_time_ms": 35.806}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "45bed_00000", "date": "2024-08-13_01-39-06", "timestamp": 1723527546, "time_this_iter_s": 28.719163179397583, "time_total_s": 1734.8807764053345, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4449700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1734.8807764053345, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 87.73170731707317, "ram_util_percent": 83.6170731707317}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6917564208703066, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0215120523694963, "policy_loss": -0.0029239573910162246, "vf_loss": 3.0243341811119566, "vf_explained_var": 0.0028240223410268307, "kl": 0.008146010645378668, "entropy": 1.0453082299421703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.497162747067748, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.030013940952442, "policy_loss": -0.00252981779138464, "vf_loss": 8.032543765678607, "vf_explained_var": 0.32283512205673903, "kl": 0.004111317353239662, "entropy": 1.1769486095539476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 348.0, "episode_reward_min": -277.0, "episode_reward_mean": 80.21, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": -12.5, "predator_policy": 52.605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [183.0, -76.0, 91.0, 270.0, -111.0, -1.0, 260.0, 348.0, -9.0, -45.0, 88.0, 39.0, 0.0, 67.0, -125.0, 157.0, 110.0, -20.0, 246.0, 11.0, -86.0, 196.0, 69.0, 57.0, 65.0, 337.0, -233.0, -3.0, -6.0, -135.0, -7.0, 97.0, 283.0, 143.0, -22.0, 175.0, -202.0, -18.0, 36.0, 109.0, 67.0, 65.0, 152.0, -120.0, 211.0, 250.0, 342.0, 323.0, 44.0, -80.0, -241.0, 109.0, -128.0, 177.0, 17.0, 70.0, 104.0, 341.0, -122.0, 102.0, 76.0, 45.0, -277.0, -102.0, 135.0, -30.0, -10.0, 271.0, 278.0, -122.0, -59.0, -1.0, 89.0, 57.0, 194.0, 98.0, -145.0, 119.0, 328.0, -267.0, 148.0, 302.0, -41.0, 267.0, 266.0, 294.0, 203.0, 232.0, 295.0, 253.0, 257.0, 46.0, -174.0, 145.0, 182.0, 3.0, 253.0, 27.0, 136.0, 229.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-89.0, 176.0, 0.0, -388.0, 145.0, -307.0, 137.0, 68.0, -210.0, -85.0, 0.0, -2.0, 26.0, 173.0, 179.0, 162.0, 0.0, -18.0, -349.0, 15.0, -30.0, 2.0, -227.0, 99.0, 0.0, 0.0, 3.0, -75.0, -69.0, -334.0, 143.0, 14.0, -219.0, 112.0, 167.0, -384.0, 8.0, 198.0, -136.0, 64.0, 0.0, -190.0, 131.0, 42.0, 89.0, -47.0, -85.0, 91.0, 0.0, 46.0, 177.0, 150.0, -190.0, -302.0, -10.0, -49.0, -116.0, 17.0, -119.0, -154.0, 0.0, -56.0, 0.0, 61.0, 143.0, 104.0, 136.0, 0.0, 45.0, -242.0, 189.0, -109.0, -16.0, -383.0, -277.0, 42.0, 160.0, -292.0, 25.0, 0.0, -130.0, 108.0, 95.0, -134.0, 153.0, -2.0, -48.0, -305.0, -21.0, 194.0, 125.0, 125.0, 200.0, 98.0, 161.0, 143.0, -58.0, -13.0, -400.0, -11.0, -322.0, -215.0, 152.0, -220.0, 63.0, -382.0, 0.0, 177.0, 145.0, -270.0, 18.0, 52.0, 176.0, -211.0, 146.0, 192.0, -68.0, -174.0, -303.0, 132.0, -296.0, 164.0, 1.0, 43.0, -266.0, -330.0, 0.0, -350.0, -130.0, 200.0, -274.0, 41.0, -115.0, -112.0, 91.0, 122.0, 166.0, 89.0, -217.0, -57.0, -55.0, -196.0, -219.0, 80.0, -18.0, 7.0, -17.0, -34.0, 52.0, 127.0, 138.0, -178.0, 0.0, -303.0, 49.0, 1.0, 138.0, 190.0, -324.0, -295.0, 139.0, -123.0, 136.0, 139.0, -128.0, -28.0, 196.0, 26.0, 92.0, 172.0, 194.0, 100.0, 191.0, -158.0, 42.0, 190.0, 73.0, 187.0, 190.0, 32.0, 200.0, -9.0, -116.0, 67.0, -118.0, -148.0, 194.0, -120.0, 0.0, 175.0, 0.0, -3.0, 163.0, 90.0, -54.0, 9.0, 153.0, -88.0, 174.0, 8.0], "policy_predator_policy_reward": [91.0, 5.0, 131.0, 181.0, 140.0, 113.0, 0.0, 65.0, 74.0, 110.0, 0.0, 1.0, 0.0, 61.0, 7.0, 0.0, 0.0, 9.0, 111.0, 178.0, 31.0, 85.0, 136.0, 31.0, 0.0, 0.0, 40.0, 99.0, 176.0, 102.0, 0.0, 0.0, 86.0, 131.0, 3.0, 194.0, 40.0, 0.0, 33.0, 50.0, 5.0, 99.0, 23.0, 0.0, 0.0, 27.0, 51.0, 0.0, 19.0, 0.0, 3.0, 7.0, 138.0, 121.0, 14.0, 42.0, 93.0, 0.0, 126.0, 12.0, 21.0, 28.0, 4.0, 32.0, 14.0, 22.0, 7.0, 0.0, 65.0, 110.0, 43.0, 52.0, 88.0, 109.0, 36.0, 181.0, 119.0, 49.0, 38.0, 46.0, 70.0, 19.0, 46.0, 58.0, 0.0, 1.0, 103.0, 130.0, 36.0, 2.0, 0.0, 0.0, 16.0, 28.0, 0.0, 19.0, 89.0, 26.0, 137.0, 194.0, 120.0, 176.0, 70.0, 107.0, 191.0, 0.0, 0.0, 0.0, 142.0, 0.0, 0.0, 0.0, 79.0, 60.0, 3.0, 0.0, 0.0, 120.0, 143.0, 130.0, 111.0, 97.0, 1.0, 0.0, 148.0, 171.0, 157.0, 91.0, 0.0, 65.0, 117.0, 86.0, 106.0, 111.0, 0.0, 58.0, 16.0, 7.0, 2.0, 150.0, 66.0, 126.0, 0.0, 138.0, 53.0, 47.0, 44.0, 64.0, 4.0, 11.0, 18.0, 120.0, 155.0, 3.0, 53.0, 16.0, 0.0, 0.0, 162.0, 190.0, 60.0, 72.0, 4.0, 23.0, 92.0, 23.0, 14.0, 31.0, 0.0, 2.0, 0.0, 0.0, 89.0, 81.0, 0.0, 0.0, 0.0, 35.0, 2.0, 29.0, 52.0, 14.0, 19.0, 76.0, 91.0, 1.0, 0.0, 71.0, 7.0, 0.0, 0.0, 6.0, 0.0, 0.0, 72.0, 0.0, 71.0, 0.0, 47.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.543535763913997, "mean_inference_ms": 4.724596649608765, "mean_action_processing_ms": 0.8038882005734758, "mean_env_wait_ms": 0.6017966715116874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00845956802368164, "StateBufferConnector_ms": 0.006943225860595703, "ViewRequirementAgentConnector_ms": 0.3549680709838867}, "num_episodes": 18, "episode_return_max": 348.0, "episode_return_min": -277.0, "episode_return_mean": 80.21, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 164.12158712541077, "num_env_steps_trained_throughput_per_sec": 164.12158712541077, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 24318.632, "restore_workers_time_ms": 0.019, "training_step_time_ms": 24318.494, "sample_time_ms": 4323.428, "learn_time_ms": 19955.912, "learn_throughput": 200.442, "synch_weights_time_ms": 33.793}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "45bed_00000", "date": "2024-08-13_01-39-30", "timestamp": 1723527570, "time_this_iter_s": 24.425631999969482, "time_total_s": 1759.306408405304, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3306b7ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1759.306408405304, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 84.56764705882354, "ram_util_percent": 83.51176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6428065026287364, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9617799509770024, "policy_loss": -0.004654767975536368, "vf_loss": 1.9662339395631558, "vf_explained_var": 0.0052065766362286115, "kl": 0.01606236655989151, "entropy": 0.9629524511004252, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.614889124713876, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.378051207557558, "policy_loss": -0.0029254331486299632, "vf_loss": 8.380976618913115, "vf_explained_var": 0.32636665755478794, "kl": 0.007365014921397192, "entropy": 1.0752765816986245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 347.0, "episode_reward_min": -277.0, "episode_reward_mean": 105.29, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": 9.865, "predator_policy": 42.78}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.0, 57.0, 65.0, 337.0, -233.0, -3.0, -6.0, -135.0, -7.0, 97.0, 283.0, 143.0, -22.0, 175.0, -202.0, -18.0, 36.0, 109.0, 67.0, 65.0, 152.0, -120.0, 211.0, 250.0, 342.0, 323.0, 44.0, -80.0, -241.0, 109.0, -128.0, 177.0, 17.0, 70.0, 104.0, 341.0, -122.0, 102.0, 76.0, 45.0, -277.0, -102.0, 135.0, -30.0, -10.0, 271.0, 278.0, -122.0, -59.0, -1.0, 89.0, 57.0, 194.0, 98.0, -145.0, 119.0, 328.0, -267.0, 148.0, 302.0, -41.0, 267.0, 266.0, 294.0, 203.0, 232.0, 295.0, 253.0, 257.0, 46.0, -174.0, 145.0, 182.0, 3.0, 253.0, 27.0, 136.0, 229.0, 274.0, 138.0, 86.0, 190.0, -64.0, 335.0, 249.0, 347.0, 205.0, 166.0, 333.0, 185.0, 210.0, 110.0, 323.0, 81.0, 134.0, 170.0, 93.0, 200.0, 3.0, 333.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [89.0, -47.0, -85.0, 91.0, 0.0, 46.0, 177.0, 150.0, -190.0, -302.0, -10.0, -49.0, -116.0, 17.0, -119.0, -154.0, 0.0, -56.0, 0.0, 61.0, 143.0, 104.0, 136.0, 0.0, 45.0, -242.0, 189.0, -109.0, -16.0, -383.0, -277.0, 42.0, 160.0, -292.0, 25.0, 0.0, -130.0, 108.0, 95.0, -134.0, 153.0, -2.0, -48.0, -305.0, -21.0, 194.0, 125.0, 125.0, 200.0, 98.0, 161.0, 143.0, -58.0, -13.0, -400.0, -11.0, -322.0, -215.0, 152.0, -220.0, 63.0, -382.0, 0.0, 177.0, 145.0, -270.0, 18.0, 52.0, 176.0, -211.0, 146.0, 192.0, -68.0, -174.0, -303.0, 132.0, -296.0, 164.0, 1.0, 43.0, -266.0, -330.0, 0.0, -350.0, -130.0, 200.0, -274.0, 41.0, -115.0, -112.0, 91.0, 122.0, 166.0, 89.0, -217.0, -57.0, -55.0, -196.0, -219.0, 80.0, -18.0, 7.0, -17.0, -34.0, 52.0, 127.0, 138.0, -178.0, 0.0, -303.0, 49.0, 1.0, 138.0, 190.0, -324.0, -295.0, 139.0, -123.0, 136.0, 139.0, -128.0, -28.0, 196.0, 26.0, 92.0, 172.0, 194.0, 100.0, 191.0, -158.0, 42.0, 190.0, 73.0, 187.0, 190.0, 32.0, 200.0, -9.0, -116.0, 67.0, -118.0, -148.0, 194.0, -120.0, 0.0, 175.0, 0.0, -3.0, 163.0, 90.0, -54.0, 9.0, 153.0, -88.0, 174.0, 8.0, 91.0, 183.0, 83.0, 55.0, 135.0, -98.0, 185.0, 0.0, -33.0, -107.0, 170.0, 157.0, 58.0, 165.0, 142.0, 198.0, 62.0, 106.0, 0.0, 166.0, 143.0, 190.0, 0.0, 185.0, 187.0, 23.0, 86.0, 0.0, 176.0, 147.0, -216.0, 163.0, 56.0, 63.0, 188.0, -73.0, 147.0, -154.0, 0.0, 200.0, 0.0, -120.0, 146.0, 170.0], "policy_predator_policy_reward": [0.0, 27.0, 51.0, 0.0, 19.0, 0.0, 3.0, 7.0, 138.0, 121.0, 14.0, 42.0, 93.0, 0.0, 126.0, 12.0, 21.0, 28.0, 4.0, 32.0, 14.0, 22.0, 7.0, 0.0, 65.0, 110.0, 43.0, 52.0, 88.0, 109.0, 36.0, 181.0, 119.0, 49.0, 38.0, 46.0, 70.0, 19.0, 46.0, 58.0, 0.0, 1.0, 103.0, 130.0, 36.0, 2.0, 0.0, 0.0, 16.0, 28.0, 0.0, 19.0, 89.0, 26.0, 137.0, 194.0, 120.0, 176.0, 70.0, 107.0, 191.0, 0.0, 0.0, 0.0, 142.0, 0.0, 0.0, 0.0, 79.0, 60.0, 3.0, 0.0, 0.0, 120.0, 143.0, 130.0, 111.0, 97.0, 1.0, 0.0, 148.0, 171.0, 157.0, 91.0, 0.0, 65.0, 117.0, 86.0, 106.0, 111.0, 0.0, 58.0, 16.0, 7.0, 2.0, 150.0, 66.0, 126.0, 0.0, 138.0, 53.0, 47.0, 44.0, 64.0, 4.0, 11.0, 18.0, 120.0, 155.0, 3.0, 53.0, 16.0, 0.0, 0.0, 162.0, 190.0, 60.0, 72.0, 4.0, 23.0, 92.0, 23.0, 14.0, 31.0, 0.0, 2.0, 0.0, 0.0, 89.0, 81.0, 0.0, 0.0, 0.0, 35.0, 2.0, 29.0, 52.0, 14.0, 19.0, 76.0, 91.0, 1.0, 0.0, 71.0, 7.0, 0.0, 0.0, 6.0, 0.0, 0.0, 72.0, 0.0, 71.0, 0.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 49.0, 5.0, 0.0, 67.0, 9.0, 8.0, 0.0, 14.0, 12.0, 7.0, 0.0, 37.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 134.0, 15.0, 0.0, 48.0, 7.0, 64.0, 36.0, 0.0, 0.0, 105.0, 18.0, 9.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5561212045137216, "mean_inference_ms": 4.730535123070179, "mean_action_processing_ms": 0.8026965503675123, "mean_env_wait_ms": 0.6134887036471828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008573293685913086, "StateBufferConnector_ms": 0.005733966827392578, "ViewRequirementAgentConnector_ms": 0.33424699306488037}, "num_episodes": 22, "episode_return_max": 347.0, "episode_return_min": -277.0, "episode_return_mean": 105.29, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 163.20340948223824, "num_env_steps_trained_throughput_per_sec": 163.20340948223824, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 23732.434, "restore_workers_time_ms": 0.019, "training_step_time_ms": 23732.296, "sample_time_ms": 3861.934, "learn_time_ms": 19830.829, "learn_throughput": 201.706, "synch_weights_time_ms": 33.968}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "45bed_00000", "date": "2024-08-13_01-39-55", "timestamp": 1723527595, "time_this_iter_s": 24.605490922927856, "time_total_s": 1783.9118993282318, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33073c670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1783.9118993282318, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 84.31142857142858, "ram_util_percent": 83.50857142857141}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7465068457894539, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.589259031840733, "policy_loss": -0.006143319281926822, "vf_loss": 5.595171744482858, "vf_explained_var": 0.017819637690902387, "kl": 0.018448807505181936, "entropy": 0.9566595602918554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.307449776249587, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.802897054430039, "policy_loss": -0.003547489524587358, "vf_loss": 8.806444548551367, "vf_explained_var": -0.018806697956468693, "kl": 0.0070044837583301805, "entropy": 1.016156398493146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 375.0, "episode_reward_min": -279.0, "episode_reward_mean": 120.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": 15.535, "predator_policy": 44.87}, "custom_metrics": {}, "hist_stats": {"episode_reward": [250.0, 342.0, 323.0, 44.0, -80.0, -241.0, 109.0, -128.0, 177.0, 17.0, 70.0, 104.0, 341.0, -122.0, 102.0, 76.0, 45.0, -277.0, -102.0, 135.0, -30.0, -10.0, 271.0, 278.0, -122.0, -59.0, -1.0, 89.0, 57.0, 194.0, 98.0, -145.0, 119.0, 328.0, -267.0, 148.0, 302.0, -41.0, 267.0, 266.0, 294.0, 203.0, 232.0, 295.0, 253.0, 257.0, 46.0, -174.0, 145.0, 182.0, 3.0, 253.0, 27.0, 136.0, 229.0, 274.0, 138.0, 86.0, 190.0, -64.0, 335.0, 249.0, 347.0, 205.0, 166.0, 333.0, 185.0, 210.0, 110.0, 323.0, 81.0, 134.0, 170.0, 93.0, 200.0, 3.0, 333.0, 169.0, 50.0, 123.0, 73.0, -84.0, -79.0, 190.0, 318.0, 304.0, 42.0, 152.0, 196.0, -198.0, 275.0, 281.0, -121.0, -279.0, 375.0, 261.0, 42.0, 294.0, 167.0, 121.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [125.0, 125.0, 200.0, 98.0, 161.0, 143.0, -58.0, -13.0, -400.0, -11.0, -322.0, -215.0, 152.0, -220.0, 63.0, -382.0, 0.0, 177.0, 145.0, -270.0, 18.0, 52.0, 176.0, -211.0, 146.0, 192.0, -68.0, -174.0, -303.0, 132.0, -296.0, 164.0, 1.0, 43.0, -266.0, -330.0, 0.0, -350.0, -130.0, 200.0, -274.0, 41.0, -115.0, -112.0, 91.0, 122.0, 166.0, 89.0, -217.0, -57.0, -55.0, -196.0, -219.0, 80.0, -18.0, 7.0, -17.0, -34.0, 52.0, 127.0, 138.0, -178.0, 0.0, -303.0, 49.0, 1.0, 138.0, 190.0, -324.0, -295.0, 139.0, -123.0, 136.0, 139.0, -128.0, -28.0, 196.0, 26.0, 92.0, 172.0, 194.0, 100.0, 191.0, -158.0, 42.0, 190.0, 73.0, 187.0, 190.0, 32.0, 200.0, -9.0, -116.0, 67.0, -118.0, -148.0, 194.0, -120.0, 0.0, 175.0, 0.0, -3.0, 163.0, 90.0, -54.0, 9.0, 153.0, -88.0, 174.0, 8.0, 91.0, 183.0, 83.0, 55.0, 135.0, -98.0, 185.0, 0.0, -33.0, -107.0, 170.0, 157.0, 58.0, 165.0, 142.0, 198.0, 62.0, 106.0, 0.0, 166.0, 143.0, 190.0, 0.0, 185.0, 187.0, 23.0, 86.0, 0.0, 176.0, 147.0, -216.0, 163.0, 56.0, 63.0, 188.0, -73.0, 147.0, -154.0, 0.0, 200.0, 0.0, -120.0, 146.0, 170.0, 104.0, 33.0, 177.0, -280.0, 49.0, -44.0, 184.0, -274.0, -222.0, 0.0, -271.0, -131.0, 60.0, 88.0, 147.0, 171.0, 167.0, 126.0, 62.0, -166.0, -153.0, 185.0, 194.0, -91.0, -315.0, -189.0, 200.0, 75.0, 81.0, 200.0, -157.0, -196.0, -367.0, -196.0, 183.0, 192.0, 136.0, 66.0, 0.0, -84.0, 132.0, 149.0, -95.0, 167.0, -130.0, 105.0], "policy_predator_policy_reward": [0.0, 0.0, 16.0, 28.0, 0.0, 19.0, 89.0, 26.0, 137.0, 194.0, 120.0, 176.0, 70.0, 107.0, 191.0, 0.0, 0.0, 0.0, 142.0, 0.0, 0.0, 0.0, 79.0, 60.0, 3.0, 0.0, 0.0, 120.0, 143.0, 130.0, 111.0, 97.0, 1.0, 0.0, 148.0, 171.0, 157.0, 91.0, 0.0, 65.0, 117.0, 86.0, 106.0, 111.0, 0.0, 58.0, 16.0, 7.0, 2.0, 150.0, 66.0, 126.0, 0.0, 138.0, 53.0, 47.0, 44.0, 64.0, 4.0, 11.0, 18.0, 120.0, 155.0, 3.0, 53.0, 16.0, 0.0, 0.0, 162.0, 190.0, 60.0, 72.0, 4.0, 23.0, 92.0, 23.0, 14.0, 31.0, 0.0, 2.0, 0.0, 0.0, 89.0, 81.0, 0.0, 0.0, 0.0, 35.0, 2.0, 29.0, 52.0, 14.0, 19.0, 76.0, 91.0, 1.0, 0.0, 71.0, 7.0, 0.0, 0.0, 6.0, 0.0, 0.0, 72.0, 0.0, 71.0, 0.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 49.0, 5.0, 0.0, 67.0, 9.0, 8.0, 0.0, 14.0, 12.0, 7.0, 0.0, 37.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 134.0, 15.0, 0.0, 48.0, 7.0, 64.0, 36.0, 0.0, 0.0, 105.0, 18.0, 9.0, 8.0, 0.0, 32.0, 153.0, 0.0, 32.0, 86.0, 163.0, 0.0, 0.0, 138.0, 160.0, 163.0, 0.0, 42.0, 0.0, 0.0, 11.0, 0.0, 24.0, 122.0, 120.0, 0.0, 0.0, 93.0, 164.0, 142.0, 0.0, 0.0, 0.0, 0.0, 100.0, 132.0, 186.0, 98.0, 0.0, 0.0, 45.0, 14.0, 63.0, 63.0, 0.0, 13.0, 8.0, 87.0, 66.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.559269571261046, "mean_inference_ms": 4.746204119346385, "mean_action_processing_ms": 0.7992687274166922, "mean_env_wait_ms": 0.6023017840275073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008351445198059082, "StateBufferConnector_ms": 0.005682110786437988, "ViewRequirementAgentConnector_ms": 0.298537015914917}, "num_episodes": 23, "episode_return_max": 375.0, "episode_return_min": -279.0, "episode_return_mean": 120.81, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.82091752334208, "num_env_steps_trained_throughput_per_sec": 159.82091752334208, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 24176.537, "restore_workers_time_ms": 0.019, "training_step_time_ms": 24176.398, "sample_time_ms": 3829.818, "learn_time_ms": 20307.2, "learn_throughput": 196.974, "synch_weights_time_ms": 33.921}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "45bed_00000", "date": "2024-08-13_01-40-20", "timestamp": 1723527620, "time_this_iter_s": 25.100430250167847, "time_total_s": 1809.0123295783997, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x330751700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1809.0123295783997, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 84.09722222222223, "ram_util_percent": 83.52499999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7341052850954747, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.119392034237977, "policy_loss": -0.0025283765354533754, "vf_loss": 4.1217547503728715, "vf_explained_var": 0.017919442735651814, "kl": 0.013252729845114344, "entropy": 0.8708630995460288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.282521255811055, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.456296712380869, "policy_loss": -0.0013940671037527778, "vf_loss": 8.457690767510227, "vf_explained_var": 0.01930737504883418, "kl": 0.005588321207826187, "entropy": 1.1214036636882359, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 397.0, "episode_reward_min": -313.0, "episode_reward_mean": 135.76, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -367.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 190.0}, "policy_reward_mean": {"prey_policy": 26.515, "predator_policy": 41.365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-102.0, 135.0, -30.0, -10.0, 271.0, 278.0, -122.0, -59.0, -1.0, 89.0, 57.0, 194.0, 98.0, -145.0, 119.0, 328.0, -267.0, 148.0, 302.0, -41.0, 267.0, 266.0, 294.0, 203.0, 232.0, 295.0, 253.0, 257.0, 46.0, -174.0, 145.0, 182.0, 3.0, 253.0, 27.0, 136.0, 229.0, 274.0, 138.0, 86.0, 190.0, -64.0, 335.0, 249.0, 347.0, 205.0, 166.0, 333.0, 185.0, 210.0, 110.0, 323.0, 81.0, 134.0, 170.0, 93.0, 200.0, 3.0, 333.0, 169.0, 50.0, 123.0, 73.0, -84.0, -79.0, 190.0, 318.0, 304.0, 42.0, 152.0, 196.0, -198.0, 275.0, 281.0, -121.0, -279.0, 375.0, 261.0, 42.0, 294.0, 167.0, 121.0, 89.0, 381.0, -313.0, 206.0, 397.0, 158.0, 187.0, 380.0, -106.0, 215.0, 287.0, -71.0, 25.0, 131.0, 74.0, 65.0, 230.0, 312.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -350.0, -130.0, 200.0, -274.0, 41.0, -115.0, -112.0, 91.0, 122.0, 166.0, 89.0, -217.0, -57.0, -55.0, -196.0, -219.0, 80.0, -18.0, 7.0, -17.0, -34.0, 52.0, 127.0, 138.0, -178.0, 0.0, -303.0, 49.0, 1.0, 138.0, 190.0, -324.0, -295.0, 139.0, -123.0, 136.0, 139.0, -128.0, -28.0, 196.0, 26.0, 92.0, 172.0, 194.0, 100.0, 191.0, -158.0, 42.0, 190.0, 73.0, 187.0, 190.0, 32.0, 200.0, -9.0, -116.0, 67.0, -118.0, -148.0, 194.0, -120.0, 0.0, 175.0, 0.0, -3.0, 163.0, 90.0, -54.0, 9.0, 153.0, -88.0, 174.0, 8.0, 91.0, 183.0, 83.0, 55.0, 135.0, -98.0, 185.0, 0.0, -33.0, -107.0, 170.0, 157.0, 58.0, 165.0, 142.0, 198.0, 62.0, 106.0, 0.0, 166.0, 143.0, 190.0, 0.0, 185.0, 187.0, 23.0, 86.0, 0.0, 176.0, 147.0, -216.0, 163.0, 56.0, 63.0, 188.0, -73.0, 147.0, -154.0, 0.0, 200.0, 0.0, -120.0, 146.0, 170.0, 104.0, 33.0, 177.0, -280.0, 49.0, -44.0, 184.0, -274.0, -222.0, 0.0, -271.0, -131.0, 60.0, 88.0, 147.0, 171.0, 167.0, 126.0, 62.0, -166.0, -153.0, 185.0, 194.0, -91.0, -315.0, -189.0, 200.0, 75.0, 81.0, 200.0, -157.0, -196.0, -367.0, -196.0, 183.0, 192.0, 136.0, 66.0, 0.0, -84.0, 132.0, 149.0, -95.0, 167.0, -130.0, 105.0, 106.0, -178.0, 179.0, 198.0, -320.0, -262.0, 7.0, 162.0, 200.0, 197.0, -304.0, 173.0, 0.0, 182.0, 180.0, 200.0, 3.0, -265.0, 57.0, 135.0, 189.0, 20.0, -153.0, -82.0, 3.0, 20.0, -14.0, 125.0, 108.0, -351.0, -22.0, 26.0, 163.0, -15.0, 120.0, 183.0], "policy_predator_policy_reward": [157.0, 91.0, 0.0, 65.0, 117.0, 86.0, 106.0, 111.0, 0.0, 58.0, 16.0, 7.0, 2.0, 150.0, 66.0, 126.0, 0.0, 138.0, 53.0, 47.0, 44.0, 64.0, 4.0, 11.0, 18.0, 120.0, 155.0, 3.0, 53.0, 16.0, 0.0, 0.0, 162.0, 190.0, 60.0, 72.0, 4.0, 23.0, 92.0, 23.0, 14.0, 31.0, 0.0, 2.0, 0.0, 0.0, 89.0, 81.0, 0.0, 0.0, 0.0, 35.0, 2.0, 29.0, 52.0, 14.0, 19.0, 76.0, 91.0, 1.0, 0.0, 71.0, 7.0, 0.0, 0.0, 6.0, 0.0, 0.0, 72.0, 0.0, 71.0, 0.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 49.0, 5.0, 0.0, 67.0, 9.0, 8.0, 0.0, 14.0, 12.0, 7.0, 0.0, 37.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 134.0, 15.0, 0.0, 48.0, 7.0, 64.0, 36.0, 0.0, 0.0, 105.0, 18.0, 9.0, 8.0, 0.0, 32.0, 153.0, 0.0, 32.0, 86.0, 163.0, 0.0, 0.0, 138.0, 160.0, 163.0, 0.0, 42.0, 0.0, 0.0, 11.0, 0.0, 24.0, 122.0, 120.0, 0.0, 0.0, 93.0, 164.0, 142.0, 0.0, 0.0, 0.0, 0.0, 100.0, 132.0, 186.0, 98.0, 0.0, 0.0, 45.0, 14.0, 63.0, 63.0, 0.0, 13.0, 8.0, 87.0, 66.0, 80.0, 121.0, 40.0, 4.0, 0.0, 162.0, 107.0, 0.0, 37.0, 0.0, 0.0, 151.0, 138.0, 3.0, 2.0, 0.0, 0.0, 7.0, 149.0, 0.0, 23.0, 45.0, 33.0, 55.0, 109.0, 0.0, 2.0, 0.0, 20.0, 137.0, 180.0, 60.0, 1.0, 57.0, 25.0, 9.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5663680251450278, "mean_inference_ms": 4.7528149617558615, "mean_action_processing_ms": 0.7978417461108205, "mean_env_wait_ms": 0.602298619922402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008506417274475098, "StateBufferConnector_ms": 0.006182193756103516, "ViewRequirementAgentConnector_ms": 0.3247826099395752}, "num_episodes": 18, "episode_return_max": 397.0, "episode_return_min": -313.0, "episode_return_mean": 135.76, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.988871090703004, "num_env_steps_trained_throughput_per_sec": 3.988871090703004, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 122105.108, "restore_workers_time_ms": 0.02, "training_step_time_ms": 122104.938, "sample_time_ms": 3782.62, "learn_time_ms": 118282.245, "learn_throughput": 33.817, "synch_weights_time_ms": 34.203}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "45bed_00000", "date": "2024-08-13_01-57-03", "timestamp": 1723528623, "time_this_iter_s": 1003.0326447486877, "time_total_s": 2812.0449743270874, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33073c5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2812.0449743270874, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 87.87380952380951, "ram_util_percent": 83.4404761904762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7692946582874923, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7959426394215336, "policy_loss": -0.0035673472154442044, "vf_loss": 3.7993805007329065, "vf_explained_var": 0.005588322247146929, "kl": 0.010359277979199156, "entropy": 0.8568495199478493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.50046827515597, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.149703411324314, "policy_loss": -0.0002850976501586576, "vf_loss": 8.149988504944655, "vf_explained_var": 0.04291062039673013, "kl": 0.00637351865803772, "entropy": 1.1693619616447932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 397.0, "episode_reward_min": -313.0, "episode_reward_mean": 142.47, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -367.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 186.0}, "policy_reward_mean": {"prey_policy": 34.165, "predator_policy": 37.07}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.0, -41.0, 267.0, 266.0, 294.0, 203.0, 232.0, 295.0, 253.0, 257.0, 46.0, -174.0, 145.0, 182.0, 3.0, 253.0, 27.0, 136.0, 229.0, 274.0, 138.0, 86.0, 190.0, -64.0, 335.0, 249.0, 347.0, 205.0, 166.0, 333.0, 185.0, 210.0, 110.0, 323.0, 81.0, 134.0, 170.0, 93.0, 200.0, 3.0, 333.0, 169.0, 50.0, 123.0, 73.0, -84.0, -79.0, 190.0, 318.0, 304.0, 42.0, 152.0, 196.0, -198.0, 275.0, 281.0, -121.0, -279.0, 375.0, 261.0, 42.0, 294.0, 167.0, 121.0, 89.0, 381.0, -313.0, 206.0, 397.0, 158.0, 187.0, 380.0, -106.0, 215.0, 287.0, -71.0, 25.0, 131.0, 74.0, 65.0, 230.0, 312.0, -105.0, 29.0, 214.0, 86.0, 255.0, 268.0, 54.0, 279.0, 32.0, 208.0, 13.0, 4.0, 150.0, 2.0, 31.0, -46.0, 30.0, 148.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [136.0, 139.0, -128.0, -28.0, 196.0, 26.0, 92.0, 172.0, 194.0, 100.0, 191.0, -158.0, 42.0, 190.0, 73.0, 187.0, 190.0, 32.0, 200.0, -9.0, -116.0, 67.0, -118.0, -148.0, 194.0, -120.0, 0.0, 175.0, 0.0, -3.0, 163.0, 90.0, -54.0, 9.0, 153.0, -88.0, 174.0, 8.0, 91.0, 183.0, 83.0, 55.0, 135.0, -98.0, 185.0, 0.0, -33.0, -107.0, 170.0, 157.0, 58.0, 165.0, 142.0, 198.0, 62.0, 106.0, 0.0, 166.0, 143.0, 190.0, 0.0, 185.0, 187.0, 23.0, 86.0, 0.0, 176.0, 147.0, -216.0, 163.0, 56.0, 63.0, 188.0, -73.0, 147.0, -154.0, 0.0, 200.0, 0.0, -120.0, 146.0, 170.0, 104.0, 33.0, 177.0, -280.0, 49.0, -44.0, 184.0, -274.0, -222.0, 0.0, -271.0, -131.0, 60.0, 88.0, 147.0, 171.0, 167.0, 126.0, 62.0, -166.0, -153.0, 185.0, 194.0, -91.0, -315.0, -189.0, 200.0, 75.0, 81.0, 200.0, -157.0, -196.0, -367.0, -196.0, 183.0, 192.0, 136.0, 66.0, 0.0, -84.0, 132.0, 149.0, -95.0, 167.0, -130.0, 105.0, 106.0, -178.0, 179.0, 198.0, -320.0, -262.0, 7.0, 162.0, 200.0, 197.0, -304.0, 173.0, 0.0, 182.0, 180.0, 200.0, 3.0, -265.0, 57.0, 135.0, 189.0, 20.0, -153.0, -82.0, 3.0, 20.0, -14.0, 125.0, 108.0, -351.0, -22.0, 26.0, 163.0, -15.0, 120.0, 183.0, -201.0, -30.0, -19.0, 37.0, 184.0, -134.0, 135.0, -164.0, 91.0, 164.0, 181.0, 81.0, 158.0, -254.0, 123.0, 156.0, 34.0, -127.0, 68.0, 140.0, 13.0, 0.0, -26.0, -262.0, 143.0, -171.0, -10.0, 7.0, -88.0, 24.0, -151.0, 5.0, -6.0, 5.0, 171.0, -134.0], "policy_predator_policy_reward": [4.0, 23.0, 92.0, 23.0, 14.0, 31.0, 0.0, 2.0, 0.0, 0.0, 89.0, 81.0, 0.0, 0.0, 0.0, 35.0, 2.0, 29.0, 52.0, 14.0, 19.0, 76.0, 91.0, 1.0, 0.0, 71.0, 7.0, 0.0, 0.0, 6.0, 0.0, 0.0, 72.0, 0.0, 71.0, 0.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 49.0, 5.0, 0.0, 67.0, 9.0, 8.0, 0.0, 14.0, 12.0, 7.0, 0.0, 37.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 134.0, 15.0, 0.0, 48.0, 7.0, 64.0, 36.0, 0.0, 0.0, 105.0, 18.0, 9.0, 8.0, 0.0, 32.0, 153.0, 0.0, 32.0, 86.0, 163.0, 0.0, 0.0, 138.0, 160.0, 163.0, 0.0, 42.0, 0.0, 0.0, 11.0, 0.0, 24.0, 122.0, 120.0, 0.0, 0.0, 93.0, 164.0, 142.0, 0.0, 0.0, 0.0, 0.0, 100.0, 132.0, 186.0, 98.0, 0.0, 0.0, 45.0, 14.0, 63.0, 63.0, 0.0, 13.0, 8.0, 87.0, 66.0, 80.0, 121.0, 40.0, 4.0, 0.0, 162.0, 107.0, 0.0, 37.0, 0.0, 0.0, 151.0, 138.0, 3.0, 2.0, 0.0, 0.0, 7.0, 149.0, 0.0, 23.0, 45.0, 33.0, 55.0, 109.0, 0.0, 2.0, 0.0, 20.0, 137.0, 180.0, 60.0, 1.0, 57.0, 25.0, 9.0, 0.0, 12.0, 114.0, 11.0, 0.0, 58.0, 106.0, 36.0, 79.0, 0.0, 0.0, 0.0, 6.0, 14.0, 136.0, 0.0, 0.0, 18.0, 107.0, 0.0, 0.0, 0.0, 0.0, 166.0, 126.0, 80.0, 98.0, 5.0, 0.0, 79.0, 16.0, 100.0, 0.0, 30.0, 1.0, 111.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5718434778268964, "mean_inference_ms": 4.763909026592075, "mean_action_processing_ms": 0.7956886476117845, "mean_env_wait_ms": 0.6022595408870104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006160378456115723, "StateBufferConnector_ms": 0.006122589111328125, "ViewRequirementAgentConnector_ms": 0.36700141429901123}, "num_episodes": 18, "episode_return_max": 397.0, "episode_return_min": -313.0, "episode_return_mean": 142.47, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.85322082521313, "num_env_steps_trained_throughput_per_sec": 157.85322082521313, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 122473.875, "restore_workers_time_ms": 0.02, "training_step_time_ms": 122473.705, "sample_time_ms": 4085.126, "learn_time_ms": 118348.912, "learn_throughput": 33.798, "synch_weights_time_ms": 33.81}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "45bed_00000", "date": "2024-08-13_01-57-29", "timestamp": 1723528649, "time_this_iter_s": 25.405747413635254, "time_total_s": 2837.4507217407227, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33074eee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2837.4507217407227, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 91.74444444444445, "ram_util_percent": 83.63888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7076871509629267, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3563919865895833, "policy_loss": -0.0016210425415978072, "vf_loss": 3.3579354781953117, "vf_explained_var": 0.0026893694249410477, "kl": 0.006203864514675036, "entropy": 0.8084946079859658, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.018474507552607, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.165131123860677, "policy_loss": -0.002006604614243818, "vf_loss": 8.167137745448521, "vf_explained_var": -0.05882207457981412, "kl": 0.004232585110064293, "entropy": 1.1617951172369498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 397.0, "episode_reward_min": -313.0, "episode_reward_mean": 127.92, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -398.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": 22.7, "predator_policy": 41.26}, "custom_metrics": {}, "hist_stats": {"episode_reward": [190.0, -64.0, 335.0, 249.0, 347.0, 205.0, 166.0, 333.0, 185.0, 210.0, 110.0, 323.0, 81.0, 134.0, 170.0, 93.0, 200.0, 3.0, 333.0, 169.0, 50.0, 123.0, 73.0, -84.0, -79.0, 190.0, 318.0, 304.0, 42.0, 152.0, 196.0, -198.0, 275.0, 281.0, -121.0, -279.0, 375.0, 261.0, 42.0, 294.0, 167.0, 121.0, 89.0, 381.0, -313.0, 206.0, 397.0, 158.0, 187.0, 380.0, -106.0, 215.0, 287.0, -71.0, 25.0, 131.0, 74.0, 65.0, 230.0, 312.0, -105.0, 29.0, 214.0, 86.0, 255.0, 268.0, 54.0, 279.0, 32.0, 208.0, 13.0, 4.0, 150.0, 2.0, 31.0, -46.0, 30.0, 148.0, 31.0, 379.0, 86.0, 202.0, 299.0, 173.0, 268.0, 159.0, 252.0, 127.0, 0.0, 98.0, 4.0, 73.0, 38.0, -117.0, -95.0, -120.0, -163.0, 317.0, -16.0, 223.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [185.0, 0.0, -33.0, -107.0, 170.0, 157.0, 58.0, 165.0, 142.0, 198.0, 62.0, 106.0, 0.0, 166.0, 143.0, 190.0, 0.0, 185.0, 187.0, 23.0, 86.0, 0.0, 176.0, 147.0, -216.0, 163.0, 56.0, 63.0, 188.0, -73.0, 147.0, -154.0, 0.0, 200.0, 0.0, -120.0, 146.0, 170.0, 104.0, 33.0, 177.0, -280.0, 49.0, -44.0, 184.0, -274.0, -222.0, 0.0, -271.0, -131.0, 60.0, 88.0, 147.0, 171.0, 167.0, 126.0, 62.0, -166.0, -153.0, 185.0, 194.0, -91.0, -315.0, -189.0, 200.0, 75.0, 81.0, 200.0, -157.0, -196.0, -367.0, -196.0, 183.0, 192.0, 136.0, 66.0, 0.0, -84.0, 132.0, 149.0, -95.0, 167.0, -130.0, 105.0, 106.0, -178.0, 179.0, 198.0, -320.0, -262.0, 7.0, 162.0, 200.0, 197.0, -304.0, 173.0, 0.0, 182.0, 180.0, 200.0, 3.0, -265.0, 57.0, 135.0, 189.0, 20.0, -153.0, -82.0, 3.0, 20.0, -14.0, 125.0, 108.0, -351.0, -22.0, 26.0, 163.0, -15.0, 120.0, 183.0, -201.0, -30.0, -19.0, 37.0, 184.0, -134.0, 135.0, -164.0, 91.0, 164.0, 181.0, 81.0, 158.0, -254.0, 123.0, 156.0, 34.0, -127.0, 68.0, 140.0, 13.0, 0.0, -26.0, -262.0, 143.0, -171.0, -10.0, 7.0, -88.0, 24.0, -151.0, 5.0, -6.0, 5.0, 171.0, -134.0, -268.0, 121.0, 186.0, 193.0, 0.0, 34.0, 86.0, 60.0, 63.0, 185.0, 173.0, 0.0, 108.0, 135.0, 47.0, 97.0, 149.0, 103.0, 126.0, -196.0, 0.0, 0.0, 98.0, 0.0, 0.0, 4.0, -398.0, 93.0, -49.0, 62.0, 0.0, -280.0, -40.0, -234.0, 3.0, -319.0, 4.0, -345.0, 111.0, 200.0, -46.0, -52.0, 143.0, 22.0], "policy_predator_policy_reward": [5.0, 0.0, 67.0, 9.0, 8.0, 0.0, 14.0, 12.0, 7.0, 0.0, 37.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 134.0, 15.0, 0.0, 48.0, 7.0, 64.0, 36.0, 0.0, 0.0, 105.0, 18.0, 9.0, 8.0, 0.0, 32.0, 153.0, 0.0, 32.0, 86.0, 163.0, 0.0, 0.0, 138.0, 160.0, 163.0, 0.0, 42.0, 0.0, 0.0, 11.0, 0.0, 24.0, 122.0, 120.0, 0.0, 0.0, 93.0, 164.0, 142.0, 0.0, 0.0, 0.0, 0.0, 100.0, 132.0, 186.0, 98.0, 0.0, 0.0, 45.0, 14.0, 63.0, 63.0, 0.0, 13.0, 8.0, 87.0, 66.0, 80.0, 121.0, 40.0, 4.0, 0.0, 162.0, 107.0, 0.0, 37.0, 0.0, 0.0, 151.0, 138.0, 3.0, 2.0, 0.0, 0.0, 7.0, 149.0, 0.0, 23.0, 45.0, 33.0, 55.0, 109.0, 0.0, 2.0, 0.0, 20.0, 137.0, 180.0, 60.0, 1.0, 57.0, 25.0, 9.0, 0.0, 12.0, 114.0, 11.0, 0.0, 58.0, 106.0, 36.0, 79.0, 0.0, 0.0, 0.0, 6.0, 14.0, 136.0, 0.0, 0.0, 18.0, 107.0, 0.0, 0.0, 0.0, 0.0, 166.0, 126.0, 80.0, 98.0, 5.0, 0.0, 79.0, 16.0, 100.0, 0.0, 30.0, 1.0, 111.0, 0.0, 52.0, 126.0, 0.0, 0.0, 25.0, 27.0, 34.0, 22.0, 45.0, 6.0, 0.0, 0.0, 25.0, 0.0, 15.0, 0.0, 0.0, 0.0, 65.0, 132.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 180.0, 198.0, 0.0, 25.0, 23.0, 140.0, 120.0, 59.0, 173.0, 23.0, 0.0, 178.0, 6.0, 0.0, 8.0, 74.0, 58.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5761868128247525, "mean_inference_ms": 4.756261725375169, "mean_action_processing_ms": 0.7919808334658012, "mean_env_wait_ms": 0.610394934424448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006264209747314453, "StateBufferConnector_ms": 0.0056116580963134766, "ViewRequirementAgentConnector_ms": 0.33391010761260986}, "num_episodes": 22, "episode_return_max": 397.0, "episode_return_min": -313.0, "episode_return_mean": 127.92, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.232896800586604, "num_env_steps_trained_throughput_per_sec": 4.232896800586604, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 214775.877, "restore_workers_time_ms": 0.019, "training_step_time_ms": 214775.707, "sample_time_ms": 3837.676, "learn_time_ms": 210894.013, "learn_throughput": 18.967, "synch_weights_time_ms": 37.841}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "45bed_00000", "date": "2024-08-13_02-13-14", "timestamp": 1723529594, "time_this_iter_s": 945.2565987110138, "time_total_s": 3782.7073204517365, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33074e9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3782.7073204517365, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 87.21842105263157, "ram_util_percent": 83.41578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7147313585830113, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.920875931353796, "policy_loss": -0.0008810354623371962, "vf_loss": 2.921719202856538, "vf_explained_var": 0.001037485227383003, "kl": 0.003021783571123709, "entropy": 0.7761171957172414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.611143381128866, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.451691672158619, "policy_loss": -0.002331608977592575, "vf_loss": 8.454023279462541, "vf_explained_var": -0.15773837068093516, "kl": 0.0059073126117989636, "entropy": 1.184011331247905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 397.0, "episode_reward_min": -313.0, "episode_reward_mean": 101.98, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -398.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": 6.72, "predator_policy": 44.27}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-84.0, -79.0, 190.0, 318.0, 304.0, 42.0, 152.0, 196.0, -198.0, 275.0, 281.0, -121.0, -279.0, 375.0, 261.0, 42.0, 294.0, 167.0, 121.0, 89.0, 381.0, -313.0, 206.0, 397.0, 158.0, 187.0, 380.0, -106.0, 215.0, 287.0, -71.0, 25.0, 131.0, 74.0, 65.0, 230.0, 312.0, -105.0, 29.0, 214.0, 86.0, 255.0, 268.0, 54.0, 279.0, 32.0, 208.0, 13.0, 4.0, 150.0, 2.0, 31.0, -46.0, 30.0, 148.0, 31.0, 379.0, 86.0, 202.0, 299.0, 173.0, 268.0, 159.0, 252.0, 127.0, 0.0, 98.0, 4.0, 73.0, 38.0, -117.0, -95.0, -120.0, -163.0, 317.0, -16.0, 223.0, 29.0, 233.0, 199.0, 166.0, 137.0, 159.0, 91.0, 278.0, -246.0, -9.0, -46.0, -1.0, -19.0, 65.0, 170.0, -177.0, 189.0, -215.0, 242.0, 6.0, 41.0, 33.0, 99.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-222.0, 0.0, -271.0, -131.0, 60.0, 88.0, 147.0, 171.0, 167.0, 126.0, 62.0, -166.0, -153.0, 185.0, 194.0, -91.0, -315.0, -189.0, 200.0, 75.0, 81.0, 200.0, -157.0, -196.0, -367.0, -196.0, 183.0, 192.0, 136.0, 66.0, 0.0, -84.0, 132.0, 149.0, -95.0, 167.0, -130.0, 105.0, 106.0, -178.0, 179.0, 198.0, -320.0, -262.0, 7.0, 162.0, 200.0, 197.0, -304.0, 173.0, 0.0, 182.0, 180.0, 200.0, 3.0, -265.0, 57.0, 135.0, 189.0, 20.0, -153.0, -82.0, 3.0, 20.0, -14.0, 125.0, 108.0, -351.0, -22.0, 26.0, 163.0, -15.0, 120.0, 183.0, -201.0, -30.0, -19.0, 37.0, 184.0, -134.0, 135.0, -164.0, 91.0, 164.0, 181.0, 81.0, 158.0, -254.0, 123.0, 156.0, 34.0, -127.0, 68.0, 140.0, 13.0, 0.0, -26.0, -262.0, 143.0, -171.0, -10.0, 7.0, -88.0, 24.0, -151.0, 5.0, -6.0, 5.0, 171.0, -134.0, -268.0, 121.0, 186.0, 193.0, 0.0, 34.0, 86.0, 60.0, 63.0, 185.0, 173.0, 0.0, 108.0, 135.0, 47.0, 97.0, 149.0, 103.0, 126.0, -196.0, 0.0, 0.0, 98.0, 0.0, 0.0, 4.0, -398.0, 93.0, -49.0, 62.0, 0.0, -280.0, -40.0, -234.0, 3.0, -319.0, 4.0, -345.0, 111.0, 200.0, -46.0, -52.0, 143.0, 22.0, 7.0, 22.0, 164.0, 63.0, 185.0, 13.0, 56.0, 110.0, -8.0, 131.0, 89.0, 70.0, 91.0, 0.0, 125.0, 153.0, -186.0, -259.0, -159.0, 9.0, 23.0, -287.0, 0.0, -85.0, 18.0, -74.0, 37.0, -5.0, 162.0, 8.0, -144.0, -227.0, 129.0, -90.0, -220.0, -227.0, 92.0, 150.0, -338.0, 135.0, 41.0, 0.0, 6.0, 27.0, 131.0, -209.0], "policy_predator_policy_reward": [0.0, 138.0, 160.0, 163.0, 0.0, 42.0, 0.0, 0.0, 11.0, 0.0, 24.0, 122.0, 120.0, 0.0, 0.0, 93.0, 164.0, 142.0, 0.0, 0.0, 0.0, 0.0, 100.0, 132.0, 186.0, 98.0, 0.0, 0.0, 45.0, 14.0, 63.0, 63.0, 0.0, 13.0, 8.0, 87.0, 66.0, 80.0, 121.0, 40.0, 4.0, 0.0, 162.0, 107.0, 0.0, 37.0, 0.0, 0.0, 151.0, 138.0, 3.0, 2.0, 0.0, 0.0, 7.0, 149.0, 0.0, 23.0, 45.0, 33.0, 55.0, 109.0, 0.0, 2.0, 0.0, 20.0, 137.0, 180.0, 60.0, 1.0, 57.0, 25.0, 9.0, 0.0, 12.0, 114.0, 11.0, 0.0, 58.0, 106.0, 36.0, 79.0, 0.0, 0.0, 0.0, 6.0, 14.0, 136.0, 0.0, 0.0, 18.0, 107.0, 0.0, 0.0, 0.0, 0.0, 166.0, 126.0, 80.0, 98.0, 5.0, 0.0, 79.0, 16.0, 100.0, 0.0, 30.0, 1.0, 111.0, 0.0, 52.0, 126.0, 0.0, 0.0, 25.0, 27.0, 34.0, 22.0, 45.0, 6.0, 0.0, 0.0, 25.0, 0.0, 15.0, 0.0, 0.0, 0.0, 65.0, 132.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 180.0, 198.0, 0.0, 25.0, 23.0, 140.0, 120.0, 59.0, 173.0, 23.0, 0.0, 178.0, 6.0, 0.0, 8.0, 74.0, 58.0, 0.0, 0.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 160.0, 39.0, 64.0, 77.0, 111.0, 107.0, 8.0, 76.0, 37.0, 0.0, 3.0, 30.0, 0.0, 0.0, 150.0, 44.0, 77.0, 73.0, 129.0, 103.0, 0.0, 0.0, 44.0, 165.0, 0.0, 0.0, 0.0, 0.0, 49.0, 128.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.593742483909044, "mean_inference_ms": 4.772871370815359, "mean_action_processing_ms": 0.8027815974826983, "mean_env_wait_ms": 0.6026483891280162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006387829780578613, "StateBufferConnector_ms": 0.005299210548400879, "ViewRequirementAgentConnector_ms": 0.386224627494812}, "num_episodes": 23, "episode_return_max": 397.0, "episode_return_min": -313.0, "episode_return_mean": 101.98, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 167.28779825468933, "num_env_steps_trained_throughput_per_sec": 167.28779825468933, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 214953.52, "restore_workers_time_ms": 0.019, "training_step_time_ms": 214953.35, "sample_time_ms": 4114.943, "learn_time_ms": 210803.943, "learn_throughput": 18.975, "synch_weights_time_ms": 27.305}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "45bed_00000", "date": "2024-08-13_02-13-38", "timestamp": 1723529618, "time_this_iter_s": 24.08436393737793, "time_total_s": 3806.7916843891144, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x330761700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3806.7916843891144, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 91.72727272727273, "ram_util_percent": 83.71515151515153}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8047461932219525, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.137088883995379, "policy_loss": -0.003067917132838851, "vf_loss": 4.140075518340661, "vf_explained_var": 0.0068188317553706905, "kl": 0.013004631504365679, "entropy": 0.8385353925051513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.290754689552166, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.721953910746903, "policy_loss": -0.001910796180791246, "vf_loss": 8.723864701437572, "vf_explained_var": -0.032657558955843484, "kl": 0.0057038529385121635, "entropy": 1.1103212744155257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 397.0, "episode_reward_min": -313.0, "episode_reward_mean": 104.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -398.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": 10.425, "predator_policy": 41.835}, "custom_metrics": {}, "hist_stats": {"episode_reward": [121.0, 89.0, 381.0, -313.0, 206.0, 397.0, 158.0, 187.0, 380.0, -106.0, 215.0, 287.0, -71.0, 25.0, 131.0, 74.0, 65.0, 230.0, 312.0, -105.0, 29.0, 214.0, 86.0, 255.0, 268.0, 54.0, 279.0, 32.0, 208.0, 13.0, 4.0, 150.0, 2.0, 31.0, -46.0, 30.0, 148.0, 31.0, 379.0, 86.0, 202.0, 299.0, 173.0, 268.0, 159.0, 252.0, 127.0, 0.0, 98.0, 4.0, 73.0, 38.0, -117.0, -95.0, -120.0, -163.0, 317.0, -16.0, 223.0, 29.0, 233.0, 199.0, 166.0, 137.0, 159.0, 91.0, 278.0, -246.0, -9.0, -46.0, -1.0, -19.0, 65.0, 170.0, -177.0, 189.0, -215.0, 242.0, 6.0, 41.0, 33.0, 99.0, 160.0, 9.0, 297.0, -88.0, 264.0, 220.0, 332.0, -62.0, -13.0, 146.0, -50.0, 117.0, 159.0, 71.0, 220.0, 16.0, 266.0, 326.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-130.0, 105.0, 106.0, -178.0, 179.0, 198.0, -320.0, -262.0, 7.0, 162.0, 200.0, 197.0, -304.0, 173.0, 0.0, 182.0, 180.0, 200.0, 3.0, -265.0, 57.0, 135.0, 189.0, 20.0, -153.0, -82.0, 3.0, 20.0, -14.0, 125.0, 108.0, -351.0, -22.0, 26.0, 163.0, -15.0, 120.0, 183.0, -201.0, -30.0, -19.0, 37.0, 184.0, -134.0, 135.0, -164.0, 91.0, 164.0, 181.0, 81.0, 158.0, -254.0, 123.0, 156.0, 34.0, -127.0, 68.0, 140.0, 13.0, 0.0, -26.0, -262.0, 143.0, -171.0, -10.0, 7.0, -88.0, 24.0, -151.0, 5.0, -6.0, 5.0, 171.0, -134.0, -268.0, 121.0, 186.0, 193.0, 0.0, 34.0, 86.0, 60.0, 63.0, 185.0, 173.0, 0.0, 108.0, 135.0, 47.0, 97.0, 149.0, 103.0, 126.0, -196.0, 0.0, 0.0, 98.0, 0.0, 0.0, 4.0, -398.0, 93.0, -49.0, 62.0, 0.0, -280.0, -40.0, -234.0, 3.0, -319.0, 4.0, -345.0, 111.0, 200.0, -46.0, -52.0, 143.0, 22.0, 7.0, 22.0, 164.0, 63.0, 185.0, 13.0, 56.0, 110.0, -8.0, 131.0, 89.0, 70.0, 91.0, 0.0, 125.0, 153.0, -186.0, -259.0, -159.0, 9.0, 23.0, -287.0, 0.0, -85.0, 18.0, -74.0, 37.0, -5.0, 162.0, 8.0, -144.0, -227.0, 129.0, -90.0, -220.0, -227.0, 92.0, 150.0, -338.0, 135.0, 41.0, 0.0, 6.0, 27.0, 131.0, -209.0, -110.0, 166.0, -184.0, 69.0, 173.0, 117.0, 42.0, -327.0, 132.0, 128.0, 154.0, 57.0, 200.0, 103.0, -230.0, 14.0, -336.0, 144.0, 32.0, 100.0, 0.0, -100.0, 165.0, -255.0, -109.0, 170.0, 86.0, -122.0, 166.0, 54.0, -198.0, 15.0, 167.0, 99.0, 187.0, 120.0], "policy_predator_policy_reward": [66.0, 80.0, 121.0, 40.0, 4.0, 0.0, 162.0, 107.0, 0.0, 37.0, 0.0, 0.0, 151.0, 138.0, 3.0, 2.0, 0.0, 0.0, 7.0, 149.0, 0.0, 23.0, 45.0, 33.0, 55.0, 109.0, 0.0, 2.0, 0.0, 20.0, 137.0, 180.0, 60.0, 1.0, 57.0, 25.0, 9.0, 0.0, 12.0, 114.0, 11.0, 0.0, 58.0, 106.0, 36.0, 79.0, 0.0, 0.0, 0.0, 6.0, 14.0, 136.0, 0.0, 0.0, 18.0, 107.0, 0.0, 0.0, 0.0, 0.0, 166.0, 126.0, 80.0, 98.0, 5.0, 0.0, 79.0, 16.0, 100.0, 0.0, 30.0, 1.0, 111.0, 0.0, 52.0, 126.0, 0.0, 0.0, 25.0, 27.0, 34.0, 22.0, 45.0, 6.0, 0.0, 0.0, 25.0, 0.0, 15.0, 0.0, 0.0, 0.0, 65.0, 132.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 180.0, 198.0, 0.0, 25.0, 23.0, 140.0, 120.0, 59.0, 173.0, 23.0, 0.0, 178.0, 6.0, 0.0, 8.0, 74.0, 58.0, 0.0, 0.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 160.0, 39.0, 64.0, 77.0, 111.0, 107.0, 8.0, 76.0, 37.0, 0.0, 3.0, 30.0, 0.0, 0.0, 150.0, 44.0, 77.0, 73.0, 129.0, 103.0, 0.0, 0.0, 44.0, 165.0, 0.0, 0.0, 0.0, 0.0, 49.0, 128.0, 28.0, 76.0, 102.0, 22.0, 0.0, 7.0, 168.0, 29.0, 0.0, 4.0, 9.0, 0.0, 0.0, 29.0, 18.0, 136.0, 168.0, 11.0, 11.0, 3.0, 0.0, 50.0, 74.0, 133.0, 98.0, 0.0, 102.0, 5.0, 0.0, 0.0, 110.0, 89.0, 0.0, 0.0, 5.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5930556493105816, "mean_inference_ms": 4.81007517635407, "mean_action_processing_ms": 0.7904925276363471, "mean_env_wait_ms": 0.6036263107890103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013672232627868652, "StateBufferConnector_ms": 0.005377531051635742, "ViewRequirementAgentConnector_ms": 0.3795809745788574}, "num_episodes": 18, "episode_return_max": 397.0, "episode_return_min": -313.0, "episode_return_mean": 104.52, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.846570587532, "num_env_steps_trained_throughput_per_sec": 204.846570587532, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 214341.341, "restore_workers_time_ms": 0.019, "training_step_time_ms": 214341.172, "sample_time_ms": 3984.312, "learn_time_ms": 210322.094, "learn_throughput": 19.018, "synch_weights_time_ms": 27.383}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "45bed_00000", "date": "2024-08-13_02-13-58", "timestamp": 1723529638, "time_this_iter_s": 19.593860864639282, "time_total_s": 3826.3855452537537, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33074e160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3826.3855452537537, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 88.64642857142857, "ram_util_percent": 83.53928571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7185565074363713, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.700786927768162, "policy_loss": -0.0022502060521334883, "vf_loss": 3.703006695565723, "vf_explained_var": 0.0093829110816673, "kl": 0.0048703840124104435, "entropy": 0.8214077394475382, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.4854614537229, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.723551710572822, "policy_loss": -0.00043622385303948135, "vf_loss": 8.723987942650204, "vf_explained_var": -0.0472464728923071, "kl": 0.002557487942589872, "entropy": 1.1118915075347537, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 379.0, "episode_reward_min": -298.0, "episode_reward_mean": 96.55, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -398.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": 6.885, "predator_policy": 41.39}, "custom_metrics": {}, "hist_stats": {"episode_reward": [312.0, -105.0, 29.0, 214.0, 86.0, 255.0, 268.0, 54.0, 279.0, 32.0, 208.0, 13.0, 4.0, 150.0, 2.0, 31.0, -46.0, 30.0, 148.0, 31.0, 379.0, 86.0, 202.0, 299.0, 173.0, 268.0, 159.0, 252.0, 127.0, 0.0, 98.0, 4.0, 73.0, 38.0, -117.0, -95.0, -120.0, -163.0, 317.0, -16.0, 223.0, 29.0, 233.0, 199.0, 166.0, 137.0, 159.0, 91.0, 278.0, -246.0, -9.0, -46.0, -1.0, -19.0, 65.0, 170.0, -177.0, 189.0, -215.0, 242.0, 6.0, 41.0, 33.0, 99.0, 160.0, 9.0, 297.0, -88.0, 264.0, 220.0, 332.0, -62.0, -13.0, 146.0, -50.0, 117.0, 159.0, 71.0, 220.0, 16.0, 266.0, 326.0, 302.0, 13.0, 0.0, 155.0, 316.0, 28.0, 91.0, 9.0, -55.0, 248.0, 162.0, 212.0, 201.0, 28.0, -89.0, 283.0, 53.0, -298.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [120.0, 183.0, -201.0, -30.0, -19.0, 37.0, 184.0, -134.0, 135.0, -164.0, 91.0, 164.0, 181.0, 81.0, 158.0, -254.0, 123.0, 156.0, 34.0, -127.0, 68.0, 140.0, 13.0, 0.0, -26.0, -262.0, 143.0, -171.0, -10.0, 7.0, -88.0, 24.0, -151.0, 5.0, -6.0, 5.0, 171.0, -134.0, -268.0, 121.0, 186.0, 193.0, 0.0, 34.0, 86.0, 60.0, 63.0, 185.0, 173.0, 0.0, 108.0, 135.0, 47.0, 97.0, 149.0, 103.0, 126.0, -196.0, 0.0, 0.0, 98.0, 0.0, 0.0, 4.0, -398.0, 93.0, -49.0, 62.0, 0.0, -280.0, -40.0, -234.0, 3.0, -319.0, 4.0, -345.0, 111.0, 200.0, -46.0, -52.0, 143.0, 22.0, 7.0, 22.0, 164.0, 63.0, 185.0, 13.0, 56.0, 110.0, -8.0, 131.0, 89.0, 70.0, 91.0, 0.0, 125.0, 153.0, -186.0, -259.0, -159.0, 9.0, 23.0, -287.0, 0.0, -85.0, 18.0, -74.0, 37.0, -5.0, 162.0, 8.0, -144.0, -227.0, 129.0, -90.0, -220.0, -227.0, 92.0, 150.0, -338.0, 135.0, 41.0, 0.0, 6.0, 27.0, 131.0, -209.0, -110.0, 166.0, -184.0, 69.0, 173.0, 117.0, 42.0, -327.0, 132.0, 128.0, 154.0, 57.0, 200.0, 103.0, -230.0, 14.0, -336.0, 144.0, 32.0, 100.0, 0.0, -100.0, 165.0, -255.0, -109.0, 170.0, 86.0, -122.0, 166.0, 54.0, -198.0, 15.0, 167.0, 99.0, 187.0, 120.0, 134.0, 168.0, 41.0, -124.0, 0.0, -106.0, 13.0, 69.0, 146.0, 164.0, -132.0, 84.0, 75.0, -35.0, -299.0, 156.0, -260.0, -47.0, 120.0, 128.0, 3.0, 155.0, 179.0, -79.0, 103.0, 69.0, -62.0, -107.0, -320.0, 67.0, 147.0, 99.0, -168.0, 111.0, -384.0, -174.0], "policy_predator_policy_reward": [9.0, 0.0, 12.0, 114.0, 11.0, 0.0, 58.0, 106.0, 36.0, 79.0, 0.0, 0.0, 0.0, 6.0, 14.0, 136.0, 0.0, 0.0, 18.0, 107.0, 0.0, 0.0, 0.0, 0.0, 166.0, 126.0, 80.0, 98.0, 5.0, 0.0, 79.0, 16.0, 100.0, 0.0, 30.0, 1.0, 111.0, 0.0, 52.0, 126.0, 0.0, 0.0, 25.0, 27.0, 34.0, 22.0, 45.0, 6.0, 0.0, 0.0, 25.0, 0.0, 15.0, 0.0, 0.0, 0.0, 65.0, 132.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 180.0, 198.0, 0.0, 25.0, 23.0, 140.0, 120.0, 59.0, 173.0, 23.0, 0.0, 178.0, 6.0, 0.0, 8.0, 74.0, 58.0, 0.0, 0.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 160.0, 39.0, 64.0, 77.0, 111.0, 107.0, 8.0, 76.0, 37.0, 0.0, 3.0, 30.0, 0.0, 0.0, 150.0, 44.0, 77.0, 73.0, 129.0, 103.0, 0.0, 0.0, 44.0, 165.0, 0.0, 0.0, 0.0, 0.0, 49.0, 128.0, 28.0, 76.0, 102.0, 22.0, 0.0, 7.0, 168.0, 29.0, 0.0, 4.0, 9.0, 0.0, 0.0, 29.0, 18.0, 136.0, 168.0, 11.0, 11.0, 3.0, 0.0, 50.0, 74.0, 133.0, 98.0, 0.0, 102.0, 5.0, 0.0, 0.0, 110.0, 89.0, 0.0, 0.0, 5.0, 14.0, 0.0, 0.0, 96.0, 0.0, 35.0, 71.0, 28.0, 45.0, 6.0, 0.0, 15.0, 61.0, 20.0, 31.0, 0.0, 152.0, 116.0, 136.0, 0.0, 0.0, 0.0, 4.0, 68.0, 44.0, 14.0, 15.0, 92.0, 105.0, 3.0, 161.0, 24.0, 13.0, 0.0, 110.0, 126.0, 134.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5978773750615087, "mean_inference_ms": 4.823747423913092, "mean_action_processing_ms": 0.7890687074783537, "mean_env_wait_ms": 0.6042624624017371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013177871704101562, "StateBufferConnector_ms": 0.004738450050354004, "ViewRequirementAgentConnector_ms": 0.34785473346710205}, "num_episodes": 18, "episode_return_max": 379.0, "episode_return_min": -298.0, "episode_return_mean": 96.55, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.5570861894929, "num_env_steps_trained_throughput_per_sec": 210.5570861894929, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 213812.132, "restore_workers_time_ms": 0.019, "training_step_time_ms": 213812.025, "sample_time_ms": 3931.61, "learn_time_ms": 209848.429, "learn_throughput": 19.061, "synch_weights_time_ms": 24.984}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "45bed_00000", "date": "2024-08-13_02-14-17", "timestamp": 1723529657, "time_this_iter_s": 19.066277980804443, "time_total_s": 3845.451823234558, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3306b7a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3845.451823234558, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 90.6148148148148, "ram_util_percent": 83.7148148148148}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7077159092027359, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.71353657825914, "policy_loss": -0.00235403989707785, "vf_loss": 3.715872076957945, "vf_explained_var": 0.0071187405359177365, "kl": 0.005932889545632134, "entropy": 0.8355238106200304, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.229322677913796, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.780453936006657, "policy_loss": -0.000811531210919379, "vf_loss": 8.781265466175382, "vf_explained_var": -0.17225629015574379, "kl": 0.005746255130984103, "entropy": 1.2458990956740406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 379.0, "episode_reward_min": -298.0, "episode_reward_mean": 99.14, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -398.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": 8.985, "predator_policy": 40.585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [148.0, 31.0, 379.0, 86.0, 202.0, 299.0, 173.0, 268.0, 159.0, 252.0, 127.0, 0.0, 98.0, 4.0, 73.0, 38.0, -117.0, -95.0, -120.0, -163.0, 317.0, -16.0, 223.0, 29.0, 233.0, 199.0, 166.0, 137.0, 159.0, 91.0, 278.0, -246.0, -9.0, -46.0, -1.0, -19.0, 65.0, 170.0, -177.0, 189.0, -215.0, 242.0, 6.0, 41.0, 33.0, 99.0, 160.0, 9.0, 297.0, -88.0, 264.0, 220.0, 332.0, -62.0, -13.0, 146.0, -50.0, 117.0, 159.0, 71.0, 220.0, 16.0, 266.0, 326.0, 302.0, 13.0, 0.0, 155.0, 316.0, 28.0, 91.0, 9.0, -55.0, 248.0, 162.0, 212.0, 201.0, 28.0, -89.0, 283.0, 53.0, -298.0, 143.0, 107.0, 195.0, 182.0, 198.0, 164.0, 187.0, 12.0, 235.0, -52.0, 56.0, 239.0, 208.0, 179.0, 38.0, -147.0, 194.0, -63.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [171.0, -134.0, -268.0, 121.0, 186.0, 193.0, 0.0, 34.0, 86.0, 60.0, 63.0, 185.0, 173.0, 0.0, 108.0, 135.0, 47.0, 97.0, 149.0, 103.0, 126.0, -196.0, 0.0, 0.0, 98.0, 0.0, 0.0, 4.0, -398.0, 93.0, -49.0, 62.0, 0.0, -280.0, -40.0, -234.0, 3.0, -319.0, 4.0, -345.0, 111.0, 200.0, -46.0, -52.0, 143.0, 22.0, 7.0, 22.0, 164.0, 63.0, 185.0, 13.0, 56.0, 110.0, -8.0, 131.0, 89.0, 70.0, 91.0, 0.0, 125.0, 153.0, -186.0, -259.0, -159.0, 9.0, 23.0, -287.0, 0.0, -85.0, 18.0, -74.0, 37.0, -5.0, 162.0, 8.0, -144.0, -227.0, 129.0, -90.0, -220.0, -227.0, 92.0, 150.0, -338.0, 135.0, 41.0, 0.0, 6.0, 27.0, 131.0, -209.0, -110.0, 166.0, -184.0, 69.0, 173.0, 117.0, 42.0, -327.0, 132.0, 128.0, 154.0, 57.0, 200.0, 103.0, -230.0, 14.0, -336.0, 144.0, 32.0, 100.0, 0.0, -100.0, 165.0, -255.0, -109.0, 170.0, 86.0, -122.0, 166.0, 54.0, -198.0, 15.0, 167.0, 99.0, 187.0, 120.0, 134.0, 168.0, 41.0, -124.0, 0.0, -106.0, 13.0, 69.0, 146.0, 164.0, -132.0, 84.0, 75.0, -35.0, -299.0, 156.0, -260.0, -47.0, 120.0, 128.0, 3.0, 155.0, 179.0, -79.0, 103.0, 69.0, -62.0, -107.0, -320.0, 67.0, 147.0, 99.0, -168.0, 111.0, -384.0, -174.0, -116.0, 169.0, 60.0, 6.0, 162.0, 28.0, 55.0, 105.0, 132.0, 60.0, 94.0, -19.0, 124.0, 63.0, 85.0, -188.0, 141.0, 83.0, 0.0, -332.0, 131.0, -171.0, 182.0, 15.0, 116.0, 9.0, 13.0, 99.0, 10.0, 28.0, -132.0, -199.0, 65.0, 126.0, 47.0, -222.0], "policy_predator_policy_reward": [111.0, 0.0, 52.0, 126.0, 0.0, 0.0, 25.0, 27.0, 34.0, 22.0, 45.0, 6.0, 0.0, 0.0, 25.0, 0.0, 15.0, 0.0, 0.0, 0.0, 65.0, 132.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 180.0, 198.0, 0.0, 25.0, 23.0, 140.0, 120.0, 59.0, 173.0, 23.0, 0.0, 178.0, 6.0, 0.0, 8.0, 74.0, 58.0, 0.0, 0.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 160.0, 39.0, 64.0, 77.0, 111.0, 107.0, 8.0, 76.0, 37.0, 0.0, 3.0, 30.0, 0.0, 0.0, 150.0, 44.0, 77.0, 73.0, 129.0, 103.0, 0.0, 0.0, 44.0, 165.0, 0.0, 0.0, 0.0, 0.0, 49.0, 128.0, 28.0, 76.0, 102.0, 22.0, 0.0, 7.0, 168.0, 29.0, 0.0, 4.0, 9.0, 0.0, 0.0, 29.0, 18.0, 136.0, 168.0, 11.0, 11.0, 3.0, 0.0, 50.0, 74.0, 133.0, 98.0, 0.0, 102.0, 5.0, 0.0, 0.0, 110.0, 89.0, 0.0, 0.0, 5.0, 14.0, 0.0, 0.0, 96.0, 0.0, 35.0, 71.0, 28.0, 45.0, 6.0, 0.0, 15.0, 61.0, 20.0, 31.0, 0.0, 152.0, 116.0, 136.0, 0.0, 0.0, 0.0, 4.0, 68.0, 44.0, 14.0, 15.0, 92.0, 105.0, 3.0, 161.0, 24.0, 13.0, 0.0, 110.0, 126.0, 134.0, 90.0, 0.0, 37.0, 4.0, 0.0, 5.0, 22.0, 0.0, 0.0, 6.0, 41.0, 48.0, 0.0, 0.0, 1.0, 114.0, 11.0, 0.0, 156.0, 124.0, 5.0, 91.0, 0.0, 42.0, 40.0, 43.0, 31.0, 36.0, 0.0, 0.0, 179.0, 5.0, 0.0, 3.0, 112.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5964081763149671, "mean_inference_ms": 4.8142394758065885, "mean_action_processing_ms": 0.7855835121450823, "mean_env_wait_ms": 0.6024807707692412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013240218162536621, "StateBufferConnector_ms": 0.005228519439697266, "ViewRequirementAgentConnector_ms": 0.2796255350112915}, "num_episodes": 18, "episode_return_max": 379.0, "episode_return_min": -298.0, "episode_return_mean": 99.14, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 188.31425687814945, "num_env_steps_trained_throughput_per_sec": 188.31425687814945, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 213069.492, "restore_workers_time_ms": 0.017, "training_step_time_ms": 213069.402, "sample_time_ms": 3618.667, "learn_time_ms": 209418.601, "learn_throughput": 19.101, "synch_weights_time_ms": 25.054}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "45bed_00000", "date": "2024-08-13_02-14-38", "timestamp": 1723529678, "time_this_iter_s": 21.31911611557007, "time_total_s": 3866.770939350128, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33071ce50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3866.770939350128, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 92.51333333333332, "ram_util_percent": 83.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6557224976440902, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6509831164249036, "policy_loss": -0.0021316608092525886, "vf_loss": 2.6531059759003774, "vf_explained_var": -0.0009592527750307921, "kl": 0.0028172114297599386, "entropy": 0.8632574673367556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.436708027881288, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.365179336890973, "policy_loss": -0.0029330219115036977, "vf_loss": 8.368112347113392, "vf_explained_var": 0.1631149811404092, "kl": 0.005693877420240628, "entropy": 1.2275461394320089, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 332.0, "episode_reward_min": -298.0, "episode_reward_mean": 103.43, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -384.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 179.0}, "policy_reward_mean": {"prey_policy": 13.34, "predator_policy": 38.375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [223.0, 29.0, 233.0, 199.0, 166.0, 137.0, 159.0, 91.0, 278.0, -246.0, -9.0, -46.0, -1.0, -19.0, 65.0, 170.0, -177.0, 189.0, -215.0, 242.0, 6.0, 41.0, 33.0, 99.0, 160.0, 9.0, 297.0, -88.0, 264.0, 220.0, 332.0, -62.0, -13.0, 146.0, -50.0, 117.0, 159.0, 71.0, 220.0, 16.0, 266.0, 326.0, 302.0, 13.0, 0.0, 155.0, 316.0, 28.0, 91.0, 9.0, -55.0, 248.0, 162.0, 212.0, 201.0, 28.0, -89.0, 283.0, 53.0, -298.0, 143.0, 107.0, 195.0, 182.0, 198.0, 164.0, 187.0, 12.0, 235.0, -52.0, 56.0, 239.0, 208.0, 179.0, 38.0, -147.0, 194.0, -63.0, 98.0, 139.0, -22.0, 189.0, -25.0, 272.0, 59.0, 146.0, 81.0, 172.0, 266.0, 275.0, 73.0, 112.0, 235.0, 64.0, 58.0, 242.0, 154.0, -131.0, -7.0, 122.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [143.0, 22.0, 7.0, 22.0, 164.0, 63.0, 185.0, 13.0, 56.0, 110.0, -8.0, 131.0, 89.0, 70.0, 91.0, 0.0, 125.0, 153.0, -186.0, -259.0, -159.0, 9.0, 23.0, -287.0, 0.0, -85.0, 18.0, -74.0, 37.0, -5.0, 162.0, 8.0, -144.0, -227.0, 129.0, -90.0, -220.0, -227.0, 92.0, 150.0, -338.0, 135.0, 41.0, 0.0, 6.0, 27.0, 131.0, -209.0, -110.0, 166.0, -184.0, 69.0, 173.0, 117.0, 42.0, -327.0, 132.0, 128.0, 154.0, 57.0, 200.0, 103.0, -230.0, 14.0, -336.0, 144.0, 32.0, 100.0, 0.0, -100.0, 165.0, -255.0, -109.0, 170.0, 86.0, -122.0, 166.0, 54.0, -198.0, 15.0, 167.0, 99.0, 187.0, 120.0, 134.0, 168.0, 41.0, -124.0, 0.0, -106.0, 13.0, 69.0, 146.0, 164.0, -132.0, 84.0, 75.0, -35.0, -299.0, 156.0, -260.0, -47.0, 120.0, 128.0, 3.0, 155.0, 179.0, -79.0, 103.0, 69.0, -62.0, -107.0, -320.0, 67.0, 147.0, 99.0, -168.0, 111.0, -384.0, -174.0, -116.0, 169.0, 60.0, 6.0, 162.0, 28.0, 55.0, 105.0, 132.0, 60.0, 94.0, -19.0, 124.0, 63.0, 85.0, -188.0, 141.0, 83.0, 0.0, -332.0, 131.0, -171.0, 182.0, 15.0, 116.0, 9.0, 13.0, 99.0, 10.0, 28.0, -132.0, -199.0, 65.0, 126.0, 47.0, -222.0, 0.0, 98.0, 30.0, 79.0, 62.0, -220.0, 108.0, 29.0, -123.0, 11.0, 179.0, 93.0, 66.0, -100.0, 151.0, -10.0, 54.0, 27.0, -6.0, 107.0, 112.0, 130.0, 82.0, 157.0, 131.0, -291.0, -56.0, 50.0, 95.0, 140.0, 147.0, -178.0, 65.0, -57.0, 128.0, 114.0, 77.0, 77.0, -222.0, -134.0, -202.0, 0.0, 113.0, 9.0], "policy_predator_policy_reward": [58.0, 0.0, 0.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 160.0, 39.0, 64.0, 77.0, 111.0, 107.0, 8.0, 76.0, 37.0, 0.0, 3.0, 30.0, 0.0, 0.0, 150.0, 44.0, 77.0, 73.0, 129.0, 103.0, 0.0, 0.0, 44.0, 165.0, 0.0, 0.0, 0.0, 0.0, 49.0, 128.0, 28.0, 76.0, 102.0, 22.0, 0.0, 7.0, 168.0, 29.0, 0.0, 4.0, 9.0, 0.0, 0.0, 29.0, 18.0, 136.0, 168.0, 11.0, 11.0, 3.0, 0.0, 50.0, 74.0, 133.0, 98.0, 0.0, 102.0, 5.0, 0.0, 0.0, 110.0, 89.0, 0.0, 0.0, 5.0, 14.0, 0.0, 0.0, 96.0, 0.0, 35.0, 71.0, 28.0, 45.0, 6.0, 0.0, 15.0, 61.0, 20.0, 31.0, 0.0, 152.0, 116.0, 136.0, 0.0, 0.0, 0.0, 4.0, 68.0, 44.0, 14.0, 15.0, 92.0, 105.0, 3.0, 161.0, 24.0, 13.0, 0.0, 110.0, 126.0, 134.0, 90.0, 0.0, 37.0, 4.0, 0.0, 5.0, 22.0, 0.0, 0.0, 6.0, 41.0, 48.0, 0.0, 0.0, 1.0, 114.0, 11.0, 0.0, 156.0, 124.0, 5.0, 91.0, 0.0, 42.0, 40.0, 43.0, 31.0, 36.0, 0.0, 0.0, 179.0, 5.0, 0.0, 3.0, 112.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 136.0, 52.0, 0.0, 11.0, 76.0, 0.0, 0.0, 6.0, 87.0, 0.0, 5.0, 0.0, 0.0, 49.0, 22.0, 24.0, 0.0, 0.0, 36.0, 95.0, 138.0, 57.0, 61.0, 0.0, 0.0, 0.0, 95.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 96.0, 129.0, 100.0, 95.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.596672690291648, "mean_inference_ms": 4.805979114052343, "mean_action_processing_ms": 0.7825788784077033, "mean_env_wait_ms": 0.6005895207084706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016921281814575195, "StateBufferConnector_ms": 0.005472898483276367, "ViewRequirementAgentConnector_ms": 0.2898622751235962}, "num_episodes": 22, "episode_return_max": 332.0, "episode_return_min": -298.0, "episode_return_mean": 103.43, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 201.49151038335066, "num_env_steps_trained_throughput_per_sec": 201.49151038335066, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 212617.472, "restore_workers_time_ms": 0.022, "training_step_time_ms": 212617.373, "sample_time_ms": 3552.131, "learn_time_ms": 209034.239, "learn_throughput": 19.136, "synch_weights_time_ms": 24.353}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "45bed_00000", "date": "2024-08-13_02-14-58", "timestamp": 1723529698, "time_this_iter_s": 19.89785599708557, "time_total_s": 3886.6687953472137, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33073f940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3886.6687953472137, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 88.20714285714287, "ram_util_percent": 83.43928571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6742270318091547, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.7872429301499055, "policy_loss": -0.001611994129541532, "vf_loss": 4.7888416770904785, "vf_explained_var": 0.0010858746432753467, "kl": 0.008481808904146883, "entropy": 0.8246014943198552, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.067353121975742, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.00871026881788, "policy_loss": -0.0021365992075063917, "vf_loss": 9.01084686713244, "vf_explained_var": -0.035283673629558907, "kl": 0.006695893233159485, "entropy": 1.1186792646135604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 332.0, "episode_reward_min": -298.0, "episode_reward_mean": 110.3, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -384.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 179.0}, "policy_reward_mean": {"prey_policy": 15.095, "predator_policy": 40.055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [99.0, 160.0, 9.0, 297.0, -88.0, 264.0, 220.0, 332.0, -62.0, -13.0, 146.0, -50.0, 117.0, 159.0, 71.0, 220.0, 16.0, 266.0, 326.0, 302.0, 13.0, 0.0, 155.0, 316.0, 28.0, 91.0, 9.0, -55.0, 248.0, 162.0, 212.0, 201.0, 28.0, -89.0, 283.0, 53.0, -298.0, 143.0, 107.0, 195.0, 182.0, 198.0, 164.0, 187.0, 12.0, 235.0, -52.0, 56.0, 239.0, 208.0, 179.0, 38.0, -147.0, 194.0, -63.0, 98.0, 139.0, -22.0, 189.0, -25.0, 272.0, 59.0, 146.0, 81.0, 172.0, 266.0, 275.0, 73.0, 112.0, 235.0, 64.0, 58.0, 242.0, 154.0, -131.0, -7.0, 122.0, 38.0, 237.0, 249.0, 155.0, 192.0, 142.0, 94.0, -48.0, 169.0, 32.0, 220.0, 55.0, -256.0, 225.0, 101.0, 261.0, -87.0, 8.0, 130.0, 116.0, 143.0, -25.0, 84.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [131.0, -209.0, -110.0, 166.0, -184.0, 69.0, 173.0, 117.0, 42.0, -327.0, 132.0, 128.0, 154.0, 57.0, 200.0, 103.0, -230.0, 14.0, -336.0, 144.0, 32.0, 100.0, 0.0, -100.0, 165.0, -255.0, -109.0, 170.0, 86.0, -122.0, 166.0, 54.0, -198.0, 15.0, 167.0, 99.0, 187.0, 120.0, 134.0, 168.0, 41.0, -124.0, 0.0, -106.0, 13.0, 69.0, 146.0, 164.0, -132.0, 84.0, 75.0, -35.0, -299.0, 156.0, -260.0, -47.0, 120.0, 128.0, 3.0, 155.0, 179.0, -79.0, 103.0, 69.0, -62.0, -107.0, -320.0, 67.0, 147.0, 99.0, -168.0, 111.0, -384.0, -174.0, -116.0, 169.0, 60.0, 6.0, 162.0, 28.0, 55.0, 105.0, 132.0, 60.0, 94.0, -19.0, 124.0, 63.0, 85.0, -188.0, 141.0, 83.0, 0.0, -332.0, 131.0, -171.0, 182.0, 15.0, 116.0, 9.0, 13.0, 99.0, 10.0, 28.0, -132.0, -199.0, 65.0, 126.0, 47.0, -222.0, 0.0, 98.0, 30.0, 79.0, 62.0, -220.0, 108.0, 29.0, -123.0, 11.0, 179.0, 93.0, 66.0, -100.0, 151.0, -10.0, 54.0, 27.0, -6.0, 107.0, 112.0, 130.0, 82.0, 157.0, 131.0, -291.0, -56.0, 50.0, 95.0, 140.0, 147.0, -178.0, 65.0, -57.0, 128.0, 114.0, 77.0, 77.0, -222.0, -134.0, -202.0, 0.0, 113.0, 9.0, 122.0, -204.0, 100.0, 111.0, 93.0, 132.0, 79.0, 59.0, -55.0, 169.0, -95.0, 155.0, 124.0, -117.0, -4.0, -183.0, 42.0, 74.0, 138.0, -212.0, 50.0, 169.0, 61.0, -61.0, -333.0, -197.0, 128.0, 70.0, -40.0, 105.0, 146.0, 105.0, -250.0, -85.0, -1.0, 0.0, 132.0, -215.0, -26.0, 92.0, 8.0, 135.0, -6.0, -178.0, 81.0, -95.0], "policy_predator_policy_reward": [49.0, 128.0, 28.0, 76.0, 102.0, 22.0, 0.0, 7.0, 168.0, 29.0, 0.0, 4.0, 9.0, 0.0, 0.0, 29.0, 18.0, 136.0, 168.0, 11.0, 11.0, 3.0, 0.0, 50.0, 74.0, 133.0, 98.0, 0.0, 102.0, 5.0, 0.0, 0.0, 110.0, 89.0, 0.0, 0.0, 5.0, 14.0, 0.0, 0.0, 96.0, 0.0, 35.0, 71.0, 28.0, 45.0, 6.0, 0.0, 15.0, 61.0, 20.0, 31.0, 0.0, 152.0, 116.0, 136.0, 0.0, 0.0, 0.0, 4.0, 68.0, 44.0, 14.0, 15.0, 92.0, 105.0, 3.0, 161.0, 24.0, 13.0, 0.0, 110.0, 126.0, 134.0, 90.0, 0.0, 37.0, 4.0, 0.0, 5.0, 22.0, 0.0, 0.0, 6.0, 41.0, 48.0, 0.0, 0.0, 1.0, 114.0, 11.0, 0.0, 156.0, 124.0, 5.0, 91.0, 0.0, 42.0, 40.0, 43.0, 31.0, 36.0, 0.0, 0.0, 179.0, 5.0, 0.0, 3.0, 112.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 136.0, 52.0, 0.0, 11.0, 76.0, 0.0, 0.0, 6.0, 87.0, 0.0, 5.0, 0.0, 0.0, 49.0, 22.0, 24.0, 0.0, 0.0, 36.0, 95.0, 138.0, 57.0, 61.0, 0.0, 0.0, 0.0, 95.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 96.0, 129.0, 100.0, 95.0, 0.0, 0.0, 16.0, 104.0, 14.0, 12.0, 4.0, 20.0, 17.0, 0.0, 0.0, 78.0, 82.0, 0.0, 87.0, 0.0, 35.0, 104.0, 36.0, 17.0, 0.0, 106.0, 1.0, 0.0, 54.0, 1.0, 162.0, 112.0, 1.0, 26.0, 20.0, 16.0, 0.0, 10.0, 134.0, 114.0, 0.0, 9.0, 108.0, 105.0, 31.0, 19.0, 0.0, 0.0, 99.0, 60.0, 87.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5871764836606885, "mean_inference_ms": 4.775200047142753, "mean_action_processing_ms": 0.7752288599073498, "mean_env_wait_ms": 0.5967743653739226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0171586275100708, "StateBufferConnector_ms": 0.005540013313293457, "ViewRequirementAgentConnector_ms": 0.22022879123687744}, "num_episodes": 23, "episode_return_max": 332.0, "episode_return_min": -298.0, "episode_return_mean": 110.3, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 185.15924649003753, "num_env_steps_trained_throughput_per_sec": 185.15924649003753, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 212326.845, "restore_workers_time_ms": 0.021, "training_step_time_ms": 212326.748, "sample_time_ms": 3501.94, "learn_time_ms": 208793.979, "learn_throughput": 19.158, "synch_weights_time_ms": 24.641}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "45bed_00000", "date": "2024-08-13_02-15-20", "timestamp": 1723529720, "time_this_iter_s": 21.659472227096558, "time_total_s": 3908.3282675743103, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44f1550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3908.3282675743103, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 87.52999999999999, "ram_util_percent": 83.61666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7156841404341832, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.811399422246943, "policy_loss": -0.003983642939335258, "vf_loss": 3.815370163211116, "vf_explained_var": 0.0018776025721635769, "kl": 0.008258981954138767, "entropy": 0.7502662479246734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.929168861631364, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.766259819868381, "policy_loss": -0.004688521563543608, "vf_loss": 8.770948354529326, "vf_explained_var": 0.0008612738715277778, "kl": 0.007390079837861288, "entropy": 1.1798612790763694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 326.0, "episode_reward_min": -298.0, "episode_reward_mean": 105.65, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -384.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.0, "predator_policy": 179.0}, "policy_reward_mean": {"prey_policy": 13.02, "predator_policy": 39.805}, "custom_metrics": {}, "hist_stats": {"episode_reward": [326.0, 302.0, 13.0, 0.0, 155.0, 316.0, 28.0, 91.0, 9.0, -55.0, 248.0, 162.0, 212.0, 201.0, 28.0, -89.0, 283.0, 53.0, -298.0, 143.0, 107.0, 195.0, 182.0, 198.0, 164.0, 187.0, 12.0, 235.0, -52.0, 56.0, 239.0, 208.0, 179.0, 38.0, -147.0, 194.0, -63.0, 98.0, 139.0, -22.0, 189.0, -25.0, 272.0, 59.0, 146.0, 81.0, 172.0, 266.0, 275.0, 73.0, 112.0, 235.0, 64.0, 58.0, 242.0, 154.0, -131.0, -7.0, 122.0, 38.0, 237.0, 249.0, 155.0, 192.0, 142.0, 94.0, -48.0, 169.0, 32.0, 220.0, 55.0, -256.0, 225.0, 101.0, 261.0, -87.0, 8.0, 130.0, 116.0, 143.0, -25.0, 84.0, 3.0, -205.0, 7.0, 252.0, 133.0, 179.0, 33.0, 52.0, 98.0, 123.0, -46.0, -52.0, 190.0, 224.0, 9.0, 232.0, 240.0, 226.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [187.0, 120.0, 134.0, 168.0, 41.0, -124.0, 0.0, -106.0, 13.0, 69.0, 146.0, 164.0, -132.0, 84.0, 75.0, -35.0, -299.0, 156.0, -260.0, -47.0, 120.0, 128.0, 3.0, 155.0, 179.0, -79.0, 103.0, 69.0, -62.0, -107.0, -320.0, 67.0, 147.0, 99.0, -168.0, 111.0, -384.0, -174.0, -116.0, 169.0, 60.0, 6.0, 162.0, 28.0, 55.0, 105.0, 132.0, 60.0, 94.0, -19.0, 124.0, 63.0, 85.0, -188.0, 141.0, 83.0, 0.0, -332.0, 131.0, -171.0, 182.0, 15.0, 116.0, 9.0, 13.0, 99.0, 10.0, 28.0, -132.0, -199.0, 65.0, 126.0, 47.0, -222.0, 0.0, 98.0, 30.0, 79.0, 62.0, -220.0, 108.0, 29.0, -123.0, 11.0, 179.0, 93.0, 66.0, -100.0, 151.0, -10.0, 54.0, 27.0, -6.0, 107.0, 112.0, 130.0, 82.0, 157.0, 131.0, -291.0, -56.0, 50.0, 95.0, 140.0, 147.0, -178.0, 65.0, -57.0, 128.0, 114.0, 77.0, 77.0, -222.0, -134.0, -202.0, 0.0, 113.0, 9.0, 122.0, -204.0, 100.0, 111.0, 93.0, 132.0, 79.0, 59.0, -55.0, 169.0, -95.0, 155.0, 124.0, -117.0, -4.0, -183.0, 42.0, 74.0, 138.0, -212.0, 50.0, 169.0, 61.0, -61.0, -333.0, -197.0, 128.0, 70.0, -40.0, 105.0, 146.0, 105.0, -250.0, -85.0, -1.0, 0.0, 132.0, -215.0, -26.0, 92.0, 8.0, 135.0, -6.0, -178.0, 81.0, -95.0, -174.0, 23.0, -309.0, -66.0, 0.0, -120.0, 142.0, 85.0, 103.0, -148.0, 106.0, 48.0, 13.0, -133.0, 75.0, -283.0, 0.0, 75.0, -2.0, 124.0, -248.0, 52.0, -335.0, 53.0, 94.0, 81.0, 69.0, 155.0, -34.0, -21.0, 120.0, 111.0, 156.0, 76.0, 89.0, 112.0], "policy_predator_policy_reward": [5.0, 14.0, 0.0, 0.0, 96.0, 0.0, 35.0, 71.0, 28.0, 45.0, 6.0, 0.0, 15.0, 61.0, 20.0, 31.0, 0.0, 152.0, 116.0, 136.0, 0.0, 0.0, 0.0, 4.0, 68.0, 44.0, 14.0, 15.0, 92.0, 105.0, 3.0, 161.0, 24.0, 13.0, 0.0, 110.0, 126.0, 134.0, 90.0, 0.0, 37.0, 4.0, 0.0, 5.0, 22.0, 0.0, 0.0, 6.0, 41.0, 48.0, 0.0, 0.0, 1.0, 114.0, 11.0, 0.0, 156.0, 124.0, 5.0, 91.0, 0.0, 42.0, 40.0, 43.0, 31.0, 36.0, 0.0, 0.0, 179.0, 5.0, 0.0, 3.0, 112.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 136.0, 52.0, 0.0, 11.0, 76.0, 0.0, 0.0, 6.0, 87.0, 0.0, 5.0, 0.0, 0.0, 49.0, 22.0, 24.0, 0.0, 0.0, 36.0, 95.0, 138.0, 57.0, 61.0, 0.0, 0.0, 0.0, 95.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 96.0, 129.0, 100.0, 95.0, 0.0, 0.0, 16.0, 104.0, 14.0, 12.0, 4.0, 20.0, 17.0, 0.0, 0.0, 78.0, 82.0, 0.0, 87.0, 0.0, 35.0, 104.0, 36.0, 17.0, 0.0, 106.0, 1.0, 0.0, 54.0, 1.0, 162.0, 112.0, 1.0, 26.0, 20.0, 16.0, 0.0, 10.0, 134.0, 114.0, 0.0, 9.0, 108.0, 105.0, 31.0, 19.0, 0.0, 0.0, 99.0, 60.0, 87.0, 11.0, 87.0, 67.0, 170.0, 0.0, 50.0, 77.0, 4.0, 21.0, 104.0, 74.0, 0.0, 25.0, 57.0, 96.0, 138.0, 122.0, 23.0, 0.0, 1.0, 0.0, 72.0, 78.0, 53.0, 177.0, 15.0, 0.0, 0.0, 0.0, 1.0, 63.0, 1.0, 0.0, 6.0, 2.0, 9.0, 16.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5804267568481105, "mean_inference_ms": 4.752157464672049, "mean_action_processing_ms": 0.7697983777057115, "mean_env_wait_ms": 0.5935766333601333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010618329048156738, "StateBufferConnector_ms": 0.005420565605163574, "ViewRequirementAgentConnector_ms": 0.21774530410766602}, "num_episodes": 18, "episode_return_max": 326.0, "episode_return_min": -298.0, "episode_return_mean": 105.65, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 176.3650867766657, "num_env_steps_trained_throughput_per_sec": 176.3650867766657, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 212092.066, "restore_workers_time_ms": 0.021, "training_step_time_ms": 212091.969, "sample_time_ms": 3555.094, "learn_time_ms": 208504.858, "learn_throughput": 19.184, "synch_weights_time_ms": 26.215}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "45bed_00000", "date": "2024-08-13_02-15-43", "timestamp": 1723529743, "time_this_iter_s": 22.753782033920288, "time_total_s": 3931.0820496082306, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33073f040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3931.0820496082306, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 87.128125, "ram_util_percent": 83.6125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7364609329118615, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2284040572151307, "policy_loss": -0.0022628573293024036, "vf_loss": 2.2306543103601566, "vf_explained_var": 0.0005120174594657131, "kl": 0.008067197697655454, "entropy": 0.7873022883342057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.81469506410064, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.471427994682676, "policy_loss": -0.002246394430819367, "vf_loss": 8.473674393204785, "vf_explained_var": -0.023454643904216706, "kl": 0.005904722717413283, "entropy": 1.2368216633165956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 275.0, "episode_reward_min": -298.0, "episode_reward_mean": 101.43, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -384.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 182.0, "predator_policy": 179.0}, "policy_reward_mean": {"prey_policy": 13.055, "predator_policy": 37.66}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-298.0, 143.0, 107.0, 195.0, 182.0, 198.0, 164.0, 187.0, 12.0, 235.0, -52.0, 56.0, 239.0, 208.0, 179.0, 38.0, -147.0, 194.0, -63.0, 98.0, 139.0, -22.0, 189.0, -25.0, 272.0, 59.0, 146.0, 81.0, 172.0, 266.0, 275.0, 73.0, 112.0, 235.0, 64.0, 58.0, 242.0, 154.0, -131.0, -7.0, 122.0, 38.0, 237.0, 249.0, 155.0, 192.0, 142.0, 94.0, -48.0, 169.0, 32.0, 220.0, 55.0, -256.0, 225.0, 101.0, 261.0, -87.0, 8.0, 130.0, 116.0, 143.0, -25.0, 84.0, 3.0, -205.0, 7.0, 252.0, 133.0, 179.0, 33.0, 52.0, 98.0, 123.0, -46.0, -52.0, 190.0, 224.0, 9.0, 232.0, 240.0, 226.0, 13.0, 202.0, 19.0, 114.0, 127.0, 179.0, -165.0, 149.0, -48.0, 118.0, 196.0, 220.0, 25.0, 219.0, 154.0, 94.0, 170.0, 75.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-384.0, -174.0, -116.0, 169.0, 60.0, 6.0, 162.0, 28.0, 55.0, 105.0, 132.0, 60.0, 94.0, -19.0, 124.0, 63.0, 85.0, -188.0, 141.0, 83.0, 0.0, -332.0, 131.0, -171.0, 182.0, 15.0, 116.0, 9.0, 13.0, 99.0, 10.0, 28.0, -132.0, -199.0, 65.0, 126.0, 47.0, -222.0, 0.0, 98.0, 30.0, 79.0, 62.0, -220.0, 108.0, 29.0, -123.0, 11.0, 179.0, 93.0, 66.0, -100.0, 151.0, -10.0, 54.0, 27.0, -6.0, 107.0, 112.0, 130.0, 82.0, 157.0, 131.0, -291.0, -56.0, 50.0, 95.0, 140.0, 147.0, -178.0, 65.0, -57.0, 128.0, 114.0, 77.0, 77.0, -222.0, -134.0, -202.0, 0.0, 113.0, 9.0, 122.0, -204.0, 100.0, 111.0, 93.0, 132.0, 79.0, 59.0, -55.0, 169.0, -95.0, 155.0, 124.0, -117.0, -4.0, -183.0, 42.0, 74.0, 138.0, -212.0, 50.0, 169.0, 61.0, -61.0, -333.0, -197.0, 128.0, 70.0, -40.0, 105.0, 146.0, 105.0, -250.0, -85.0, -1.0, 0.0, 132.0, -215.0, -26.0, 92.0, 8.0, 135.0, -6.0, -178.0, 81.0, -95.0, -174.0, 23.0, -309.0, -66.0, 0.0, -120.0, 142.0, 85.0, 103.0, -148.0, 106.0, 48.0, 13.0, -133.0, 75.0, -283.0, 0.0, 75.0, -2.0, 124.0, -248.0, 52.0, -335.0, 53.0, 94.0, 81.0, 69.0, 155.0, -34.0, -21.0, 120.0, 111.0, 156.0, 76.0, 89.0, 112.0, -32.0, -5.0, 100.0, 90.0, -155.0, 93.0, 34.0, 38.0, -5.0, 39.0, 103.0, 68.0, -30.0, -293.0, 62.0, -63.0, -96.0, 0.0, 124.0, -18.0, -2.0, 134.0, 46.0, 142.0, -106.0, 9.0, 107.0, 103.0, 102.0, -16.0, -73.0, 92.0, 11.0, 158.0, 74.0, -29.0], "policy_predator_policy_reward": [126.0, 134.0, 90.0, 0.0, 37.0, 4.0, 0.0, 5.0, 22.0, 0.0, 0.0, 6.0, 41.0, 48.0, 0.0, 0.0, 1.0, 114.0, 11.0, 0.0, 156.0, 124.0, 5.0, 91.0, 0.0, 42.0, 40.0, 43.0, 31.0, 36.0, 0.0, 0.0, 179.0, 5.0, 0.0, 3.0, 112.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 136.0, 52.0, 0.0, 11.0, 76.0, 0.0, 0.0, 6.0, 87.0, 0.0, 5.0, 0.0, 0.0, 49.0, 22.0, 24.0, 0.0, 0.0, 36.0, 95.0, 138.0, 57.0, 61.0, 0.0, 0.0, 0.0, 95.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 96.0, 129.0, 100.0, 95.0, 0.0, 0.0, 16.0, 104.0, 14.0, 12.0, 4.0, 20.0, 17.0, 0.0, 0.0, 78.0, 82.0, 0.0, 87.0, 0.0, 35.0, 104.0, 36.0, 17.0, 0.0, 106.0, 1.0, 0.0, 54.0, 1.0, 162.0, 112.0, 1.0, 26.0, 20.0, 16.0, 0.0, 10.0, 134.0, 114.0, 0.0, 9.0, 108.0, 105.0, 31.0, 19.0, 0.0, 0.0, 99.0, 60.0, 87.0, 11.0, 87.0, 67.0, 170.0, 0.0, 50.0, 77.0, 4.0, 21.0, 104.0, 74.0, 0.0, 25.0, 57.0, 96.0, 138.0, 122.0, 23.0, 0.0, 1.0, 0.0, 72.0, 78.0, 53.0, 177.0, 15.0, 0.0, 0.0, 0.0, 1.0, 63.0, 1.0, 0.0, 6.0, 2.0, 9.0, 16.0, 50.0, 0.0, 12.0, 0.0, 78.0, 3.0, 24.0, 18.0, 0.0, 93.0, 7.0, 1.0, 0.0, 158.0, 72.0, 78.0, 48.0, 0.0, 4.0, 8.0, 13.0, 51.0, 0.0, 32.0, 25.0, 97.0, 0.0, 9.0, 0.0, 68.0, 73.0, 2.0, 0.0, 1.0, 8.0, 22.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.575301151088041, "mean_inference_ms": 4.73387950630624, "mean_action_processing_ms": 0.7652165978818379, "mean_env_wait_ms": 0.590650291252654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011463284492492676, "StateBufferConnector_ms": 0.005745887756347656, "ViewRequirementAgentConnector_ms": 0.22540485858917236}, "num_episodes": 18, "episode_return_max": 275.0, "episode_return_min": -298.0, "episode_return_mean": 101.43, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 183.0017045979729, "num_env_steps_trained_throughput_per_sec": 183.0017045979729, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 113998.839, "restore_workers_time_ms": 0.021, "training_step_time_ms": 113998.772, "sample_time_ms": 3480.02, "learn_time_ms": 110488.036, "learn_throughput": 36.203, "synch_weights_time_ms": 25.254}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "45bed_00000", "date": "2024-08-13_02-16-05", "timestamp": 1723529765, "time_this_iter_s": 21.90657901763916, "time_total_s": 3952.9886286258698, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33071c9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3952.9886286258698, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 86.43225806451612, "ram_util_percent": 83.42580645161293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7568314152538146, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.312873327038275, "policy_loss": -0.003242235510270037, "vf_loss": 4.3161005667277745, "vf_explained_var": 0.004176922859968963, "kl": 0.009605101423783605, "entropy": 0.7907278978004657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.89273814877505, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.901615183946317, "policy_loss": -0.0012277813882089008, "vf_loss": 8.902842952082397, "vf_explained_var": -0.07374137365628802, "kl": 0.004897976005187659, "entropy": 1.0713682636382087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 329.0, "episode_reward_min": -256.0, "episode_reward_mean": 112.9, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -335.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.0, "predator_policy": 177.0}, "policy_reward_mean": {"prey_policy": 18.925, "predator_policy": 37.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [189.0, -25.0, 272.0, 59.0, 146.0, 81.0, 172.0, 266.0, 275.0, 73.0, 112.0, 235.0, 64.0, 58.0, 242.0, 154.0, -131.0, -7.0, 122.0, 38.0, 237.0, 249.0, 155.0, 192.0, 142.0, 94.0, -48.0, 169.0, 32.0, 220.0, 55.0, -256.0, 225.0, 101.0, 261.0, -87.0, 8.0, 130.0, 116.0, 143.0, -25.0, 84.0, 3.0, -205.0, 7.0, 252.0, 133.0, 179.0, 33.0, 52.0, 98.0, 123.0, -46.0, -52.0, 190.0, 224.0, 9.0, 232.0, 240.0, 226.0, 13.0, 202.0, 19.0, 114.0, 127.0, 179.0, -165.0, 149.0, -48.0, 118.0, 196.0, 220.0, 25.0, 219.0, 154.0, 94.0, 170.0, 75.0, 220.0, 47.0, 293.0, 195.0, 181.0, -40.0, 137.0, 329.0, 56.0, 250.0, 242.0, 105.0, 86.0, -173.0, 271.0, 155.0, 266.0, 315.0, 31.0, 220.0, 57.0, -104.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [108.0, 29.0, -123.0, 11.0, 179.0, 93.0, 66.0, -100.0, 151.0, -10.0, 54.0, 27.0, -6.0, 107.0, 112.0, 130.0, 82.0, 157.0, 131.0, -291.0, -56.0, 50.0, 95.0, 140.0, 147.0, -178.0, 65.0, -57.0, 128.0, 114.0, 77.0, 77.0, -222.0, -134.0, -202.0, 0.0, 113.0, 9.0, 122.0, -204.0, 100.0, 111.0, 93.0, 132.0, 79.0, 59.0, -55.0, 169.0, -95.0, 155.0, 124.0, -117.0, -4.0, -183.0, 42.0, 74.0, 138.0, -212.0, 50.0, 169.0, 61.0, -61.0, -333.0, -197.0, 128.0, 70.0, -40.0, 105.0, 146.0, 105.0, -250.0, -85.0, -1.0, 0.0, 132.0, -215.0, -26.0, 92.0, 8.0, 135.0, -6.0, -178.0, 81.0, -95.0, -174.0, 23.0, -309.0, -66.0, 0.0, -120.0, 142.0, 85.0, 103.0, -148.0, 106.0, 48.0, 13.0, -133.0, 75.0, -283.0, 0.0, 75.0, -2.0, 124.0, -248.0, 52.0, -335.0, 53.0, 94.0, 81.0, 69.0, 155.0, -34.0, -21.0, 120.0, 111.0, 156.0, 76.0, 89.0, 112.0, -32.0, -5.0, 100.0, 90.0, -155.0, 93.0, 34.0, 38.0, -5.0, 39.0, 103.0, 68.0, -30.0, -293.0, 62.0, -63.0, -96.0, 0.0, 124.0, -18.0, -2.0, 134.0, 46.0, 142.0, -106.0, 9.0, 107.0, 103.0, 102.0, -16.0, -73.0, 92.0, 11.0, 158.0, 74.0, -29.0, 177.0, 43.0, -256.0, 150.0, 137.0, 145.0, 105.0, 90.0, 178.0, -67.0, 49.0, -256.0, -63.0, 148.0, 162.0, 167.0, 47.0, -79.0, 142.0, 108.0, 14.0, 173.0, 184.0, -268.0, 0.0, 41.0, -184.0, -190.0, 187.0, 84.0, 102.0, -26.0, 180.0, 86.0, 133.0, 182.0, -92.0, 46.0, -36.0, 148.0, 143.0, -295.0, -176.0, -69.0], "policy_predator_policy_reward": [52.0, 0.0, 11.0, 76.0, 0.0, 0.0, 6.0, 87.0, 0.0, 5.0, 0.0, 0.0, 49.0, 22.0, 24.0, 0.0, 0.0, 36.0, 95.0, 138.0, 57.0, 61.0, 0.0, 0.0, 0.0, 95.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 96.0, 129.0, 100.0, 95.0, 0.0, 0.0, 16.0, 104.0, 14.0, 12.0, 4.0, 20.0, 17.0, 0.0, 0.0, 78.0, 82.0, 0.0, 87.0, 0.0, 35.0, 104.0, 36.0, 17.0, 0.0, 106.0, 1.0, 0.0, 54.0, 1.0, 162.0, 112.0, 1.0, 26.0, 20.0, 16.0, 0.0, 10.0, 134.0, 114.0, 0.0, 9.0, 108.0, 105.0, 31.0, 19.0, 0.0, 0.0, 99.0, 60.0, 87.0, 11.0, 87.0, 67.0, 170.0, 0.0, 50.0, 77.0, 4.0, 21.0, 104.0, 74.0, 0.0, 25.0, 57.0, 96.0, 138.0, 122.0, 23.0, 0.0, 1.0, 0.0, 72.0, 78.0, 53.0, 177.0, 15.0, 0.0, 0.0, 0.0, 1.0, 63.0, 1.0, 0.0, 6.0, 2.0, 9.0, 16.0, 50.0, 0.0, 12.0, 0.0, 78.0, 3.0, 24.0, 18.0, 0.0, 93.0, 7.0, 1.0, 0.0, 158.0, 72.0, 78.0, 48.0, 0.0, 4.0, 8.0, 13.0, 51.0, 0.0, 32.0, 25.0, 97.0, 0.0, 9.0, 0.0, 68.0, 73.0, 2.0, 0.0, 1.0, 8.0, 22.0, 0.0, 0.0, 46.0, 107.0, 11.0, 0.0, 0.0, 0.0, 0.0, 70.0, 0.0, 167.0, 52.0, 0.0, 0.0, 0.0, 74.0, 14.0, 0.0, 0.0, 0.0, 55.0, 141.0, 48.0, 45.0, 0.0, 63.0, 138.0, 0.0, 0.0, 76.0, 3.0, 0.0, 0.0, 0.0, 0.0, 46.0, 31.0, 55.0, 53.0, 67.0, 142.0, 0.0, 141.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5737342917764385, "mean_inference_ms": 4.712544389256447, "mean_action_processing_ms": 0.7610574778125647, "mean_env_wait_ms": 0.5966592337803985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014310598373413086, "StateBufferConnector_ms": 0.004863142967224121, "ViewRequirementAgentConnector_ms": 0.23023366928100586}, "num_episodes": 22, "episode_return_max": 329.0, "episode_return_min": -256.0, "episode_return_mean": 112.9, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 181.96430788450402, "num_env_steps_trained_throughput_per_sec": 181.96430788450402, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 113663.072, "restore_workers_time_ms": 0.022, "training_step_time_ms": 113663.005, "sample_time_ms": 3230.115, "learn_time_ms": 110399.828, "learn_throughput": 36.232, "synch_weights_time_ms": 27.048}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "45bed_00000", "date": "2024-08-13_02-16-27", "timestamp": 1723529787, "time_this_iter_s": 22.065032958984375, "time_total_s": 3975.053661584854, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4449d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3975.053661584854, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 84.27096774193548, "ram_util_percent": 83.59354838709677}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.708295905168252, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.180395956392641, "policy_loss": -0.0012721308658549947, "vf_loss": 4.181662552697318, "vf_explained_var": 0.0004818863969631296, "kl": 0.003536115251578791, "entropy": 0.8001488249453287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.95695880683011, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.58124051245432, "policy_loss": -0.0007241727872973397, "vf_loss": 8.58196468958779, "vf_explained_var": 0.06470686172051404, "kl": 0.0033014444116021445, "entropy": 1.1960894810459601, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 329.0, "episode_reward_min": -256.0, "episode_reward_mean": 109.61, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -362.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.0, "predator_policy": 177.0}, "policy_reward_mean": {"prey_policy": 14.23, "predator_policy": 40.575}, "custom_metrics": {}, "hist_stats": {"episode_reward": [192.0, 142.0, 94.0, -48.0, 169.0, 32.0, 220.0, 55.0, -256.0, 225.0, 101.0, 261.0, -87.0, 8.0, 130.0, 116.0, 143.0, -25.0, 84.0, 3.0, -205.0, 7.0, 252.0, 133.0, 179.0, 33.0, 52.0, 98.0, 123.0, -46.0, -52.0, 190.0, 224.0, 9.0, 232.0, 240.0, 226.0, 13.0, 202.0, 19.0, 114.0, 127.0, 179.0, -165.0, 149.0, -48.0, 118.0, 196.0, 220.0, 25.0, 219.0, 154.0, 94.0, 170.0, 75.0, 220.0, 47.0, 293.0, 195.0, 181.0, -40.0, 137.0, 329.0, 56.0, 250.0, 242.0, 105.0, 86.0, -173.0, 271.0, 155.0, 266.0, 315.0, 31.0, 220.0, 57.0, -104.0, 111.0, 251.0, 81.0, -157.0, 74.0, -1.0, 18.0, 173.0, -38.0, 303.0, 151.0, 134.0, 26.0, 206.0, 69.0, 198.0, -39.0, 209.0, 103.0, 276.0, 104.0, 276.0, 179.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-55.0, 169.0, -95.0, 155.0, 124.0, -117.0, -4.0, -183.0, 42.0, 74.0, 138.0, -212.0, 50.0, 169.0, 61.0, -61.0, -333.0, -197.0, 128.0, 70.0, -40.0, 105.0, 146.0, 105.0, -250.0, -85.0, -1.0, 0.0, 132.0, -215.0, -26.0, 92.0, 8.0, 135.0, -6.0, -178.0, 81.0, -95.0, -174.0, 23.0, -309.0, -66.0, 0.0, -120.0, 142.0, 85.0, 103.0, -148.0, 106.0, 48.0, 13.0, -133.0, 75.0, -283.0, 0.0, 75.0, -2.0, 124.0, -248.0, 52.0, -335.0, 53.0, 94.0, 81.0, 69.0, 155.0, -34.0, -21.0, 120.0, 111.0, 156.0, 76.0, 89.0, 112.0, -32.0, -5.0, 100.0, 90.0, -155.0, 93.0, 34.0, 38.0, -5.0, 39.0, 103.0, 68.0, -30.0, -293.0, 62.0, -63.0, -96.0, 0.0, 124.0, -18.0, -2.0, 134.0, 46.0, 142.0, -106.0, 9.0, 107.0, 103.0, 102.0, -16.0, -73.0, 92.0, 11.0, 158.0, 74.0, -29.0, 177.0, 43.0, -256.0, 150.0, 137.0, 145.0, 105.0, 90.0, 178.0, -67.0, 49.0, -256.0, -63.0, 148.0, 162.0, 167.0, 47.0, -79.0, 142.0, 108.0, 14.0, 173.0, 184.0, -268.0, 0.0, 41.0, -184.0, -190.0, 187.0, 84.0, 102.0, -26.0, 180.0, 86.0, 133.0, 182.0, -92.0, 46.0, -36.0, 148.0, 143.0, -295.0, -176.0, -69.0, 134.0, -344.0, 101.0, 136.0, 117.0, -164.0, -129.0, -270.0, 114.0, -231.0, -273.0, 129.0, 101.0, -215.0, 69.0, 104.0, -362.0, 135.0, 161.0, 142.0, 121.0, -103.0, -64.0, 148.0, -76.0, 57.0, 87.0, 119.0, 80.0, -102.0, 85.0, 113.0, 0.0, -151.0, 176.0, -39.0, 103.0, 0.0, 179.0, 41.0, 82.0, -88.0, 58.0, 174.0, 60.0, 111.0], "policy_predator_policy_reward": [0.0, 78.0, 82.0, 0.0, 87.0, 0.0, 35.0, 104.0, 36.0, 17.0, 0.0, 106.0, 1.0, 0.0, 54.0, 1.0, 162.0, 112.0, 1.0, 26.0, 20.0, 16.0, 0.0, 10.0, 134.0, 114.0, 0.0, 9.0, 108.0, 105.0, 31.0, 19.0, 0.0, 0.0, 99.0, 60.0, 87.0, 11.0, 87.0, 67.0, 170.0, 0.0, 50.0, 77.0, 4.0, 21.0, 104.0, 74.0, 0.0, 25.0, 57.0, 96.0, 138.0, 122.0, 23.0, 0.0, 1.0, 0.0, 72.0, 78.0, 53.0, 177.0, 15.0, 0.0, 0.0, 0.0, 1.0, 63.0, 1.0, 0.0, 6.0, 2.0, 9.0, 16.0, 50.0, 0.0, 12.0, 0.0, 78.0, 3.0, 24.0, 18.0, 0.0, 93.0, 7.0, 1.0, 0.0, 158.0, 72.0, 78.0, 48.0, 0.0, 4.0, 8.0, 13.0, 51.0, 0.0, 32.0, 25.0, 97.0, 0.0, 9.0, 0.0, 68.0, 73.0, 2.0, 0.0, 1.0, 8.0, 22.0, 0.0, 0.0, 46.0, 107.0, 11.0, 0.0, 0.0, 0.0, 0.0, 70.0, 0.0, 167.0, 52.0, 0.0, 0.0, 0.0, 74.0, 14.0, 0.0, 0.0, 0.0, 55.0, 141.0, 48.0, 45.0, 0.0, 63.0, 138.0, 0.0, 0.0, 76.0, 3.0, 0.0, 0.0, 0.0, 0.0, 46.0, 31.0, 55.0, 53.0, 67.0, 142.0, 0.0, 141.0, 162.0, 159.0, 0.0, 14.0, 19.0, 109.0, 158.0, 84.0, 105.0, 86.0, 0.0, 143.0, 10.0, 122.0, 0.0, 0.0, 177.0, 12.0, 0.0, 0.0, 54.0, 79.0, 0.0, 50.0, 13.0, 32.0, 0.0, 0.0, 1.0, 90.0, 0.0, 0.0, 98.0, 14.0, 67.0, 5.0, 0.0, 0.0, 0.0, 56.0, 16.0, 94.0, 0.0, 44.0, 8.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5778393062874867, "mean_inference_ms": 4.698243777184054, "mean_action_processing_ms": 0.7670542352719562, "mean_env_wait_ms": 0.5874930831259259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010921835899353027, "StateBufferConnector_ms": 0.005583047866821289, "ViewRequirementAgentConnector_ms": 0.21923232078552246}, "num_episodes": 23, "episode_return_max": 329.0, "episode_return_min": -256.0, "episode_return_mean": 109.61, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 174.62488217760097, "num_env_steps_trained_throughput_per_sec": 174.62488217760097, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 21455.763, "restore_workers_time_ms": 0.022, "training_step_time_ms": 21455.695, "sample_time_ms": 3349.662, "learn_time_ms": 18074.529, "learn_throughput": 221.306, "synch_weights_time_ms": 25.178}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "45bed_00000", "date": "2024-08-13_02-16-50", "timestamp": 1723529810, "time_this_iter_s": 23.13330888748169, "time_total_s": 3998.186970472336, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44f1a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3998.186970472336, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 84.23636363636365, "ram_util_percent": 83.55757575757576}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7235612623748325, "cur_kl_coeff": 0.00078125, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.780749113597567, "policy_loss": -0.0032402875116242778, "vf_loss": 2.783983209524205, "vf_explained_var": 0.001856438855014781, "kl": 0.00792454206953688, "entropy": 0.7644480561453199, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.45319558864548, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.578940094084967, "policy_loss": -0.00092124246386072, "vf_loss": 8.579861333382823, "vf_explained_var": -0.05117456288564773, "kl": 0.006698325739804665, "entropy": 1.196725943353441, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 329.0, "episode_reward_min": -205.0, "episode_reward_mean": 128.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -362.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.0, "predator_policy": 177.0}, "policy_reward_mean": {"prey_policy": 26.37, "predator_policy": 37.705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [84.0, 3.0, -205.0, 7.0, 252.0, 133.0, 179.0, 33.0, 52.0, 98.0, 123.0, -46.0, -52.0, 190.0, 224.0, 9.0, 232.0, 240.0, 226.0, 13.0, 202.0, 19.0, 114.0, 127.0, 179.0, -165.0, 149.0, -48.0, 118.0, 196.0, 220.0, 25.0, 219.0, 154.0, 94.0, 170.0, 75.0, 220.0, 47.0, 293.0, 195.0, 181.0, -40.0, 137.0, 329.0, 56.0, 250.0, 242.0, 105.0, 86.0, -173.0, 271.0, 155.0, 266.0, 315.0, 31.0, 220.0, 57.0, -104.0, 111.0, 251.0, 81.0, -157.0, 74.0, -1.0, 18.0, 173.0, -38.0, 303.0, 151.0, 134.0, 26.0, 206.0, 69.0, 198.0, -39.0, 209.0, 103.0, 276.0, 104.0, 276.0, 179.0, 144.0, 184.0, 250.0, 110.0, 197.0, 246.0, 226.0, 246.0, 203.0, 146.0, 274.0, 169.0, 126.0, 123.0, 178.0, 223.0, 93.0, 188.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [81.0, -95.0, -174.0, 23.0, -309.0, -66.0, 0.0, -120.0, 142.0, 85.0, 103.0, -148.0, 106.0, 48.0, 13.0, -133.0, 75.0, -283.0, 0.0, 75.0, -2.0, 124.0, -248.0, 52.0, -335.0, 53.0, 94.0, 81.0, 69.0, 155.0, -34.0, -21.0, 120.0, 111.0, 156.0, 76.0, 89.0, 112.0, -32.0, -5.0, 100.0, 90.0, -155.0, 93.0, 34.0, 38.0, -5.0, 39.0, 103.0, 68.0, -30.0, -293.0, 62.0, -63.0, -96.0, 0.0, 124.0, -18.0, -2.0, 134.0, 46.0, 142.0, -106.0, 9.0, 107.0, 103.0, 102.0, -16.0, -73.0, 92.0, 11.0, 158.0, 74.0, -29.0, 177.0, 43.0, -256.0, 150.0, 137.0, 145.0, 105.0, 90.0, 178.0, -67.0, 49.0, -256.0, -63.0, 148.0, 162.0, 167.0, 47.0, -79.0, 142.0, 108.0, 14.0, 173.0, 184.0, -268.0, 0.0, 41.0, -184.0, -190.0, 187.0, 84.0, 102.0, -26.0, 180.0, 86.0, 133.0, 182.0, -92.0, 46.0, -36.0, 148.0, 143.0, -295.0, -176.0, -69.0, 134.0, -344.0, 101.0, 136.0, 117.0, -164.0, -129.0, -270.0, 114.0, -231.0, -273.0, 129.0, 101.0, -215.0, 69.0, 104.0, -362.0, 135.0, 161.0, 142.0, 121.0, -103.0, -64.0, 148.0, -76.0, 57.0, 87.0, 119.0, 80.0, -102.0, 85.0, 113.0, 0.0, -151.0, 176.0, -39.0, 103.0, 0.0, 179.0, 41.0, 82.0, -88.0, 58.0, 174.0, 60.0, 111.0, 128.0, 1.0, 128.0, -25.0, 185.0, 24.0, 111.0, -2.0, 113.0, 5.0, 160.0, 86.0, 87.0, 139.0, 60.0, 134.0, 121.0, 62.0, -62.0, 62.0, 140.0, 118.0, 106.0, -32.0, -139.0, 118.0, 26.0, 78.0, 81.0, 89.0, 187.0, -128.0, -175.0, 133.0, 15.0, 139.0], "policy_predator_policy_reward": [87.0, 11.0, 87.0, 67.0, 170.0, 0.0, 50.0, 77.0, 4.0, 21.0, 104.0, 74.0, 0.0, 25.0, 57.0, 96.0, 138.0, 122.0, 23.0, 0.0, 1.0, 0.0, 72.0, 78.0, 53.0, 177.0, 15.0, 0.0, 0.0, 0.0, 1.0, 63.0, 1.0, 0.0, 6.0, 2.0, 9.0, 16.0, 50.0, 0.0, 12.0, 0.0, 78.0, 3.0, 24.0, 18.0, 0.0, 93.0, 7.0, 1.0, 0.0, 158.0, 72.0, 78.0, 48.0, 0.0, 4.0, 8.0, 13.0, 51.0, 0.0, 32.0, 25.0, 97.0, 0.0, 9.0, 0.0, 68.0, 73.0, 2.0, 0.0, 1.0, 8.0, 22.0, 0.0, 0.0, 46.0, 107.0, 11.0, 0.0, 0.0, 0.0, 0.0, 70.0, 0.0, 167.0, 52.0, 0.0, 0.0, 0.0, 74.0, 14.0, 0.0, 0.0, 0.0, 55.0, 141.0, 48.0, 45.0, 0.0, 63.0, 138.0, 0.0, 0.0, 76.0, 3.0, 0.0, 0.0, 0.0, 0.0, 46.0, 31.0, 55.0, 53.0, 67.0, 142.0, 0.0, 141.0, 162.0, 159.0, 0.0, 14.0, 19.0, 109.0, 158.0, 84.0, 105.0, 86.0, 0.0, 143.0, 10.0, 122.0, 0.0, 0.0, 177.0, 12.0, 0.0, 0.0, 54.0, 79.0, 0.0, 50.0, 13.0, 32.0, 0.0, 0.0, 1.0, 90.0, 0.0, 0.0, 98.0, 14.0, 67.0, 5.0, 0.0, 0.0, 0.0, 56.0, 16.0, 94.0, 0.0, 44.0, 8.0, 0.0, 15.0, 0.0, 0.0, 81.0, 7.0, 34.0, 1.0, 0.0, 30.0, 49.0, 0.0, 0.0, 0.0, 0.0, 40.0, 12.0, 0.0, 20.0, 75.0, 71.0, 4.0, 12.0, 35.0, 60.0, 67.0, 80.0, 8.0, 11.0, 8.0, 0.0, 94.0, 70.0, 7.0, 128.0, 0.0, 34.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.389829181978742, "mean_inference_ms": 10.146497792696321, "mean_action_processing_ms": 0.7574258786642925, "mean_env_wait_ms": 1.4916024619123056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012554168701171875, "StateBufferConnector_ms": 0.006073951721191406, "ViewRequirementAgentConnector_ms": 0.3314920663833618}, "num_episodes": 18, "episode_return_max": 329.0, "episode_return_min": -205.0, "episode_return_mean": 128.15, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.785456901763082, "num_env_steps_trained_throughput_per_sec": 3.785456901763082, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 124732.236, "restore_workers_time_ms": 0.023, "training_step_time_ms": 124732.165, "sample_time_ms": 105884.326, "learn_time_ms": 18817.91, "learn_throughput": 212.563, "synch_weights_time_ms": 24.457}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "45bed_00000", "date": "2024-08-13_02-34-27", "timestamp": 1723530867, "time_this_iter_s": 1056.7408361434937, "time_total_s": 5054.9278066158295, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44f1af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5054.9278066158295, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 94.5909090909091, "ram_util_percent": 83.4909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7169554646920275, "cur_kl_coeff": 0.00078125, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.665490803642879, "policy_loss": -0.0022019206097832434, "vf_loss": 5.667685620242326, "vf_explained_var": 0.0008402769527738056, "kl": 0.009091441381067891, "entropy": 0.7703245721166097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.00978741566971, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.378279029250775, "policy_loss": -0.0016179735242591177, "vf_loss": 8.379897008623395, "vf_explained_var": 0.04291899314633122, "kl": 0.006736788754666235, "entropy": 1.153697227485596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 352.0, "episode_reward_min": -197.0, "episode_reward_mean": 132.64, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -362.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 188.0, "predator_policy": 177.0}, "policy_reward_mean": {"prey_policy": 26.75, "predator_policy": 39.57}, "custom_metrics": {}, "hist_stats": {"episode_reward": [226.0, 13.0, 202.0, 19.0, 114.0, 127.0, 179.0, -165.0, 149.0, -48.0, 118.0, 196.0, 220.0, 25.0, 219.0, 154.0, 94.0, 170.0, 75.0, 220.0, 47.0, 293.0, 195.0, 181.0, -40.0, 137.0, 329.0, 56.0, 250.0, 242.0, 105.0, 86.0, -173.0, 271.0, 155.0, 266.0, 315.0, 31.0, 220.0, 57.0, -104.0, 111.0, 251.0, 81.0, -157.0, 74.0, -1.0, 18.0, 173.0, -38.0, 303.0, 151.0, 134.0, 26.0, 206.0, 69.0, 198.0, -39.0, 209.0, 103.0, 276.0, 104.0, 276.0, 179.0, 144.0, 184.0, 250.0, 110.0, 197.0, 246.0, 226.0, 246.0, 203.0, 146.0, 274.0, 169.0, 126.0, 123.0, 178.0, 223.0, 93.0, 188.0, 170.0, 62.0, 315.0, 6.0, 145.0, 51.0, 246.0, 120.0, 209.0, 98.0, 111.0, -77.0, 209.0, 352.0, 71.0, 170.0, -56.0, -197.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [89.0, 112.0, -32.0, -5.0, 100.0, 90.0, -155.0, 93.0, 34.0, 38.0, -5.0, 39.0, 103.0, 68.0, -30.0, -293.0, 62.0, -63.0, -96.0, 0.0, 124.0, -18.0, -2.0, 134.0, 46.0, 142.0, -106.0, 9.0, 107.0, 103.0, 102.0, -16.0, -73.0, 92.0, 11.0, 158.0, 74.0, -29.0, 177.0, 43.0, -256.0, 150.0, 137.0, 145.0, 105.0, 90.0, 178.0, -67.0, 49.0, -256.0, -63.0, 148.0, 162.0, 167.0, 47.0, -79.0, 142.0, 108.0, 14.0, 173.0, 184.0, -268.0, 0.0, 41.0, -184.0, -190.0, 187.0, 84.0, 102.0, -26.0, 180.0, 86.0, 133.0, 182.0, -92.0, 46.0, -36.0, 148.0, 143.0, -295.0, -176.0, -69.0, 134.0, -344.0, 101.0, 136.0, 117.0, -164.0, -129.0, -270.0, 114.0, -231.0, -273.0, 129.0, 101.0, -215.0, 69.0, 104.0, -362.0, 135.0, 161.0, 142.0, 121.0, -103.0, -64.0, 148.0, -76.0, 57.0, 87.0, 119.0, 80.0, -102.0, 85.0, 113.0, 0.0, -151.0, 176.0, -39.0, 103.0, 0.0, 179.0, 41.0, 82.0, -88.0, 58.0, 174.0, 60.0, 111.0, 128.0, 1.0, 128.0, -25.0, 185.0, 24.0, 111.0, -2.0, 113.0, 5.0, 160.0, 86.0, 87.0, 139.0, 60.0, 134.0, 121.0, 62.0, -62.0, 62.0, 140.0, 118.0, 106.0, -32.0, -139.0, 118.0, 26.0, 78.0, 81.0, 89.0, 187.0, -128.0, -175.0, 133.0, 15.0, 139.0, 160.0, 10.0, 131.0, -215.0, 175.0, 57.0, 32.0, -137.0, 147.0, -26.0, 1.0, -11.0, 88.0, 155.0, 164.0, -289.0, 162.0, 12.0, 151.0, -176.0, 131.0, -258.0, -138.0, -157.0, 97.0, 112.0, 164.0, 188.0, 124.0, -196.0, -233.0, 188.0, -93.0, -177.0, -92.0, -301.0], "policy_predator_policy_reward": [9.0, 16.0, 50.0, 0.0, 12.0, 0.0, 78.0, 3.0, 24.0, 18.0, 0.0, 93.0, 7.0, 1.0, 0.0, 158.0, 72.0, 78.0, 48.0, 0.0, 4.0, 8.0, 13.0, 51.0, 0.0, 32.0, 25.0, 97.0, 0.0, 9.0, 0.0, 68.0, 73.0, 2.0, 0.0, 1.0, 8.0, 22.0, 0.0, 0.0, 46.0, 107.0, 11.0, 0.0, 0.0, 0.0, 0.0, 70.0, 0.0, 167.0, 52.0, 0.0, 0.0, 0.0, 74.0, 14.0, 0.0, 0.0, 0.0, 55.0, 141.0, 48.0, 45.0, 0.0, 63.0, 138.0, 0.0, 0.0, 76.0, 3.0, 0.0, 0.0, 0.0, 0.0, 46.0, 31.0, 55.0, 53.0, 67.0, 142.0, 0.0, 141.0, 162.0, 159.0, 0.0, 14.0, 19.0, 109.0, 158.0, 84.0, 105.0, 86.0, 0.0, 143.0, 10.0, 122.0, 0.0, 0.0, 177.0, 12.0, 0.0, 0.0, 54.0, 79.0, 0.0, 50.0, 13.0, 32.0, 0.0, 0.0, 1.0, 90.0, 0.0, 0.0, 98.0, 14.0, 67.0, 5.0, 0.0, 0.0, 0.0, 56.0, 16.0, 94.0, 0.0, 44.0, 8.0, 0.0, 15.0, 0.0, 0.0, 81.0, 7.0, 34.0, 1.0, 0.0, 30.0, 49.0, 0.0, 0.0, 0.0, 0.0, 40.0, 12.0, 0.0, 20.0, 75.0, 71.0, 4.0, 12.0, 35.0, 60.0, 67.0, 80.0, 8.0, 11.0, 8.0, 0.0, 94.0, 70.0, 7.0, 128.0, 0.0, 34.0, 0.0, 0.0, 12.0, 134.0, 42.0, 41.0, 27.0, 84.0, 16.0, 8.0, 1.0, 60.0, 3.0, 0.0, 144.0, 101.0, 35.0, 0.0, 31.0, 92.0, 138.0, 100.0, 127.0, 91.0, 0.0, 0.0, 0.0, 0.0, 42.0, 101.0, 99.0, 116.0, 98.0, 116.0, 51.0, 145.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.172903388341839, "mean_inference_ms": 15.472961919332738, "mean_action_processing_ms": 0.7564663975326166, "mean_env_wait_ms": 2.3785298881383903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01154792308807373, "StateBufferConnector_ms": 0.010037899017333984, "ViewRequirementAgentConnector_ms": 0.31542301177978516}, "num_episodes": 18, "episode_return_max": 352.0, "episode_return_min": -197.0, "episode_return_mean": 132.64, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 12.473478966461508, "num_env_steps_trained_throughput_per_sec": 12.473478966461508, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 154847.593, "restore_workers_time_ms": 0.023, "training_step_time_ms": 154847.523, "sample_time_ms": 105828.642, "learn_time_ms": 48988.209, "learn_throughput": 81.652, "synch_weights_time_ms": 25.498}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "45bed_00000", "date": "2024-08-13_02-39-48", "timestamp": 1723531188, "time_this_iter_s": 321.06496810913086, "time_total_s": 5375.99277472496, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3307514c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5375.99277472496, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 82.70800000000001, "ram_util_percent": 83.23200000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.724115099209957, "cur_kl_coeff": 0.00078125, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7815893043285955, "policy_loss": -0.003415758198092657, "vf_loss": 2.784996619111016, "vf_explained_var": -0.0009952213713731715, "kl": 0.0108085857660544, "entropy": 0.826443569117753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.43232533162233, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.110898408687934, "policy_loss": -0.002057004449568768, "vf_loss": 8.112955417078009, "vf_explained_var": -0.05428669799572576, "kl": 0.0064149547429741514, "entropy": 1.1838730314421275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 352.0, "episode_reward_min": -197.0, "episode_reward_mean": 145.39, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -374.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 177.0}, "policy_reward_mean": {"prey_policy": 30.1, "predator_policy": 42.595}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.0, 220.0, 47.0, 293.0, 195.0, 181.0, -40.0, 137.0, 329.0, 56.0, 250.0, 242.0, 105.0, 86.0, -173.0, 271.0, 155.0, 266.0, 315.0, 31.0, 220.0, 57.0, -104.0, 111.0, 251.0, 81.0, -157.0, 74.0, -1.0, 18.0, 173.0, -38.0, 303.0, 151.0, 134.0, 26.0, 206.0, 69.0, 198.0, -39.0, 209.0, 103.0, 276.0, 104.0, 276.0, 179.0, 144.0, 184.0, 250.0, 110.0, 197.0, 246.0, 226.0, 246.0, 203.0, 146.0, 274.0, 169.0, 126.0, 123.0, 178.0, 223.0, 93.0, 188.0, 170.0, 62.0, 315.0, 6.0, 145.0, 51.0, 246.0, 120.0, 209.0, 98.0, 111.0, -77.0, 209.0, 352.0, 71.0, 170.0, -56.0, -197.0, 313.0, 294.0, 35.0, 240.0, 132.0, 300.0, 83.0, 237.0, 92.0, 213.0, 243.0, 186.0, 124.0, 352.0, 22.0, 20.0, 81.0, 320.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [74.0, -29.0, 177.0, 43.0, -256.0, 150.0, 137.0, 145.0, 105.0, 90.0, 178.0, -67.0, 49.0, -256.0, -63.0, 148.0, 162.0, 167.0, 47.0, -79.0, 142.0, 108.0, 14.0, 173.0, 184.0, -268.0, 0.0, 41.0, -184.0, -190.0, 187.0, 84.0, 102.0, -26.0, 180.0, 86.0, 133.0, 182.0, -92.0, 46.0, -36.0, 148.0, 143.0, -295.0, -176.0, -69.0, 134.0, -344.0, 101.0, 136.0, 117.0, -164.0, -129.0, -270.0, 114.0, -231.0, -273.0, 129.0, 101.0, -215.0, 69.0, 104.0, -362.0, 135.0, 161.0, 142.0, 121.0, -103.0, -64.0, 148.0, -76.0, 57.0, 87.0, 119.0, 80.0, -102.0, 85.0, 113.0, 0.0, -151.0, 176.0, -39.0, 103.0, 0.0, 179.0, 41.0, 82.0, -88.0, 58.0, 174.0, 60.0, 111.0, 128.0, 1.0, 128.0, -25.0, 185.0, 24.0, 111.0, -2.0, 113.0, 5.0, 160.0, 86.0, 87.0, 139.0, 60.0, 134.0, 121.0, 62.0, -62.0, 62.0, 140.0, 118.0, 106.0, -32.0, -139.0, 118.0, 26.0, 78.0, 81.0, 89.0, 187.0, -128.0, -175.0, 133.0, 15.0, 139.0, 160.0, 10.0, 131.0, -215.0, 175.0, 57.0, 32.0, -137.0, 147.0, -26.0, 1.0, -11.0, 88.0, 155.0, 164.0, -289.0, 162.0, 12.0, 151.0, -176.0, 131.0, -258.0, -138.0, -157.0, 97.0, 112.0, 164.0, 188.0, 124.0, -196.0, -233.0, 188.0, -93.0, -177.0, -92.0, -301.0, 158.0, 134.0, 129.0, 165.0, 147.0, -337.0, 98.0, 142.0, -48.0, 134.0, 170.0, 130.0, -95.0, 62.0, -139.0, 189.0, -374.0, 145.0, 97.0, 77.0, 186.0, -133.0, 128.0, -11.0, 0.0, 124.0, 178.0, 174.0, -111.0, -31.0, -269.0, 135.0, 0.0, -40.0, 160.0, 158.0], "policy_predator_policy_reward": [8.0, 22.0, 0.0, 0.0, 46.0, 107.0, 11.0, 0.0, 0.0, 0.0, 0.0, 70.0, 0.0, 167.0, 52.0, 0.0, 0.0, 0.0, 74.0, 14.0, 0.0, 0.0, 0.0, 55.0, 141.0, 48.0, 45.0, 0.0, 63.0, 138.0, 0.0, 0.0, 76.0, 3.0, 0.0, 0.0, 0.0, 0.0, 46.0, 31.0, 55.0, 53.0, 67.0, 142.0, 0.0, 141.0, 162.0, 159.0, 0.0, 14.0, 19.0, 109.0, 158.0, 84.0, 105.0, 86.0, 0.0, 143.0, 10.0, 122.0, 0.0, 0.0, 177.0, 12.0, 0.0, 0.0, 54.0, 79.0, 0.0, 50.0, 13.0, 32.0, 0.0, 0.0, 1.0, 90.0, 0.0, 0.0, 98.0, 14.0, 67.0, 5.0, 0.0, 0.0, 0.0, 56.0, 16.0, 94.0, 0.0, 44.0, 8.0, 0.0, 15.0, 0.0, 0.0, 81.0, 7.0, 34.0, 1.0, 0.0, 30.0, 49.0, 0.0, 0.0, 0.0, 0.0, 40.0, 12.0, 0.0, 20.0, 75.0, 71.0, 4.0, 12.0, 35.0, 60.0, 67.0, 80.0, 8.0, 11.0, 8.0, 0.0, 94.0, 70.0, 7.0, 128.0, 0.0, 34.0, 0.0, 0.0, 12.0, 134.0, 42.0, 41.0, 27.0, 84.0, 16.0, 8.0, 1.0, 60.0, 3.0, 0.0, 144.0, 101.0, 35.0, 0.0, 31.0, 92.0, 138.0, 100.0, 127.0, 91.0, 0.0, 0.0, 0.0, 0.0, 42.0, 101.0, 99.0, 116.0, 98.0, 116.0, 51.0, 145.0, 3.0, 18.0, 0.0, 0.0, 177.0, 48.0, 0.0, 0.0, 24.0, 22.0, 0.0, 0.0, 114.0, 2.0, 86.0, 101.0, 165.0, 156.0, 29.0, 10.0, 87.0, 103.0, 0.0, 69.0, 0.0, 0.0, 0.0, 0.0, 88.0, 76.0, 154.0, 0.0, 49.0, 72.0, 2.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.936229034893684, "mean_inference_ms": 20.739382207256455, "mean_action_processing_ms": 0.7561904149225468, "mean_env_wait_ms": 3.2548975083322067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013152241706848145, "StateBufferConnector_ms": 0.01116645336151123, "ViewRequirementAgentConnector_ms": 0.3919062614440918}, "num_episodes": 18, "episode_return_max": 352.0, "episode_return_min": -197.0, "episode_return_mean": 145.39, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 143.65944137567612, "num_env_steps_trained_throughput_per_sec": 143.65944137567612, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 155732.362, "restore_workers_time_ms": 0.086, "training_step_time_ms": 155732.075, "sample_time_ms": 106703.833, "learn_time_ms": 48995.688, "learn_throughput": 81.64, "synch_weights_time_ms": 27.116}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "45bed_00000", "date": "2024-08-13_02-40-16", "timestamp": 1723531216, "time_this_iter_s": 27.937999963760376, "time_total_s": 5403.930774688721, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44f19d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5403.930774688721, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 87.06176470588235, "ram_util_percent": 83.71764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7591694281766654, "cur_kl_coeff": 0.00078125, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8084058164919496, "policy_loss": -0.0018610307484835623, "vf_loss": 3.810264201139016, "vf_explained_var": 0.00108499391369088, "kl": 0.0034019541726654705, "entropy": 0.7990199082427555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.02944254685962, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.481780735903946, "policy_loss": -0.005369386707540976, "vf_loss": 8.487150124141149, "vf_explained_var": 0.07400728653347681, "kl": 0.009328177181012646, "entropy": 1.2285685449680954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 352.0, "episode_reward_min": -197.0, "episode_reward_mean": 147.71, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -374.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 177.0}, "policy_reward_mean": {"prey_policy": 32.665, "predator_policy": 41.19}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-104.0, 111.0, 251.0, 81.0, -157.0, 74.0, -1.0, 18.0, 173.0, -38.0, 303.0, 151.0, 134.0, 26.0, 206.0, 69.0, 198.0, -39.0, 209.0, 103.0, 276.0, 104.0, 276.0, 179.0, 144.0, 184.0, 250.0, 110.0, 197.0, 246.0, 226.0, 246.0, 203.0, 146.0, 274.0, 169.0, 126.0, 123.0, 178.0, 223.0, 93.0, 188.0, 170.0, 62.0, 315.0, 6.0, 145.0, 51.0, 246.0, 120.0, 209.0, 98.0, 111.0, -77.0, 209.0, 352.0, 71.0, 170.0, -56.0, -197.0, 313.0, 294.0, 35.0, 240.0, 132.0, 300.0, 83.0, 237.0, 92.0, 213.0, 243.0, 186.0, 124.0, 352.0, 22.0, 20.0, 81.0, 320.0, 109.0, 138.0, 238.0, 221.0, 247.0, 197.0, 202.0, 86.0, 207.0, 227.0, 244.0, 310.0, 244.0, -32.0, 182.0, 74.0, 107.0, 117.0, 200.0, 133.0, 26.0, 73.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-176.0, -69.0, 134.0, -344.0, 101.0, 136.0, 117.0, -164.0, -129.0, -270.0, 114.0, -231.0, -273.0, 129.0, 101.0, -215.0, 69.0, 104.0, -362.0, 135.0, 161.0, 142.0, 121.0, -103.0, -64.0, 148.0, -76.0, 57.0, 87.0, 119.0, 80.0, -102.0, 85.0, 113.0, 0.0, -151.0, 176.0, -39.0, 103.0, 0.0, 179.0, 41.0, 82.0, -88.0, 58.0, 174.0, 60.0, 111.0, 128.0, 1.0, 128.0, -25.0, 185.0, 24.0, 111.0, -2.0, 113.0, 5.0, 160.0, 86.0, 87.0, 139.0, 60.0, 134.0, 121.0, 62.0, -62.0, 62.0, 140.0, 118.0, 106.0, -32.0, -139.0, 118.0, 26.0, 78.0, 81.0, 89.0, 187.0, -128.0, -175.0, 133.0, 15.0, 139.0, 160.0, 10.0, 131.0, -215.0, 175.0, 57.0, 32.0, -137.0, 147.0, -26.0, 1.0, -11.0, 88.0, 155.0, 164.0, -289.0, 162.0, 12.0, 151.0, -176.0, 131.0, -258.0, -138.0, -157.0, 97.0, 112.0, 164.0, 188.0, 124.0, -196.0, -233.0, 188.0, -93.0, -177.0, -92.0, -301.0, 158.0, 134.0, 129.0, 165.0, 147.0, -337.0, 98.0, 142.0, -48.0, 134.0, 170.0, 130.0, -95.0, 62.0, -139.0, 189.0, -374.0, 145.0, 97.0, 77.0, 186.0, -133.0, 128.0, -11.0, 0.0, 124.0, 178.0, 174.0, -111.0, -31.0, -269.0, 135.0, 0.0, -40.0, 160.0, 158.0, -10.0, 73.0, -69.0, 91.0, 112.0, 80.0, 128.0, 80.0, 117.0, 121.0, 79.0, 91.0, 19.0, 96.0, 97.0, -98.0, 91.0, 103.0, 59.0, 149.0, 126.0, 8.0, 122.0, 176.0, 184.0, 57.0, -2.0, -146.0, 0.0, 182.0, -46.0, 7.0, 56.0, 0.0, -48.0, 136.0, 42.0, 116.0, 143.0, -106.0, -200.0, 98.0, 60.0, -77.0], "policy_predator_policy_reward": [0.0, 141.0, 162.0, 159.0, 0.0, 14.0, 19.0, 109.0, 158.0, 84.0, 105.0, 86.0, 0.0, 143.0, 10.0, 122.0, 0.0, 0.0, 177.0, 12.0, 0.0, 0.0, 54.0, 79.0, 0.0, 50.0, 13.0, 32.0, 0.0, 0.0, 1.0, 90.0, 0.0, 0.0, 98.0, 14.0, 67.0, 5.0, 0.0, 0.0, 0.0, 56.0, 16.0, 94.0, 0.0, 44.0, 8.0, 0.0, 15.0, 0.0, 0.0, 81.0, 7.0, 34.0, 1.0, 0.0, 30.0, 49.0, 0.0, 0.0, 0.0, 0.0, 40.0, 12.0, 0.0, 20.0, 75.0, 71.0, 4.0, 12.0, 35.0, 60.0, 67.0, 80.0, 8.0, 11.0, 8.0, 0.0, 94.0, 70.0, 7.0, 128.0, 0.0, 34.0, 0.0, 0.0, 12.0, 134.0, 42.0, 41.0, 27.0, 84.0, 16.0, 8.0, 1.0, 60.0, 3.0, 0.0, 144.0, 101.0, 35.0, 0.0, 31.0, 92.0, 138.0, 100.0, 127.0, 91.0, 0.0, 0.0, 0.0, 0.0, 42.0, 101.0, 99.0, 116.0, 98.0, 116.0, 51.0, 145.0, 3.0, 18.0, 0.0, 0.0, 177.0, 48.0, 0.0, 0.0, 24.0, 22.0, 0.0, 0.0, 114.0, 2.0, 86.0, 101.0, 165.0, 156.0, 29.0, 10.0, 87.0, 103.0, 0.0, 69.0, 0.0, 0.0, 0.0, 0.0, 88.0, 76.0, 154.0, 0.0, 49.0, 72.0, 2.0, 0.0, 0.0, 46.0, 69.0, 47.0, 26.0, 20.0, 7.0, 6.0, 1.0, 8.0, 0.0, 27.0, 53.0, 34.0, 31.0, 56.0, 13.0, 0.0, 16.0, 3.0, 54.0, 56.0, 7.0, 5.0, 3.0, 0.0, 17.0, 99.0, 0.0, 0.0, 59.0, 54.0, 21.0, 30.0, 29.0, 0.0, 0.0, 42.0, 43.0, 53.0, 117.0, 11.0, 72.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.66898063862803, "mean_inference_ms": 27.196724454326354, "mean_action_processing_ms": 0.7555473294278288, "mean_env_wait_ms": 4.541163426082854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013114094734191895, "StateBufferConnector_ms": 0.012291431427001953, "ViewRequirementAgentConnector_ms": 0.45758140087127686}, "num_episodes": 22, "episode_return_max": 352.0, "episode_return_min": -197.0, "episode_return_mean": 147.71, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.09276623736213, "num_env_steps_trained_throughput_per_sec": 234.09276623736213, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 155316.977, "restore_workers_time_ms": 0.087, "training_step_time_ms": 155316.69, "sample_time_ms": 106752.254, "learn_time_ms": 48532.423, "learn_throughput": 82.419, "synch_weights_time_ms": 26.625}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "45bed_00000", "date": "2024-08-13_02-40-34", "timestamp": 1723531234, "time_this_iter_s": 17.154148817062378, "time_total_s": 5421.084923505783, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4449f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5421.084923505783, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 86.48750000000001, "ram_util_percent": 83.64999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7204242078005952, "cur_kl_coeff": 0.000390625, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.0007106904630305, "policy_loss": -0.0011319916138533878, "vf_loss": 4.001841649555025, "vf_explained_var": -0.0005731445140939541, "kl": 0.002622306811609493, "entropy": 0.8308570995217278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.505724780994747, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.158857974804267, "policy_loss": -0.002966764528629562, "vf_loss": 8.161824729455212, "vf_explained_var": -0.021617820149376278, "kl": 0.008605650337327946, "entropy": 1.076409293545617, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 360.0, "episode_reward_min": -197.0, "episode_reward_mean": 158.99, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -374.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 177.0}, "policy_reward_mean": {"prey_policy": 39.715, "predator_policy": 39.78}, "custom_metrics": {}, "hist_stats": {"episode_reward": [179.0, 144.0, 184.0, 250.0, 110.0, 197.0, 246.0, 226.0, 246.0, 203.0, 146.0, 274.0, 169.0, 126.0, 123.0, 178.0, 223.0, 93.0, 188.0, 170.0, 62.0, 315.0, 6.0, 145.0, 51.0, 246.0, 120.0, 209.0, 98.0, 111.0, -77.0, 209.0, 352.0, 71.0, 170.0, -56.0, -197.0, 313.0, 294.0, 35.0, 240.0, 132.0, 300.0, 83.0, 237.0, 92.0, 213.0, 243.0, 186.0, 124.0, 352.0, 22.0, 20.0, 81.0, 320.0, 109.0, 138.0, 238.0, 221.0, 247.0, 197.0, 202.0, 86.0, 207.0, 227.0, 244.0, 310.0, 244.0, -32.0, 182.0, 74.0, 107.0, 117.0, 200.0, 133.0, 26.0, 73.0, 198.0, 208.0, 62.0, -158.0, 217.0, 115.0, 360.0, 273.0, 254.0, 89.0, 46.0, 61.0, 14.0, 189.0, 201.0, 263.0, 99.0, 250.0, 31.0, 207.0, 217.0, 146.0, 210.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [60.0, 111.0, 128.0, 1.0, 128.0, -25.0, 185.0, 24.0, 111.0, -2.0, 113.0, 5.0, 160.0, 86.0, 87.0, 139.0, 60.0, 134.0, 121.0, 62.0, -62.0, 62.0, 140.0, 118.0, 106.0, -32.0, -139.0, 118.0, 26.0, 78.0, 81.0, 89.0, 187.0, -128.0, -175.0, 133.0, 15.0, 139.0, 160.0, 10.0, 131.0, -215.0, 175.0, 57.0, 32.0, -137.0, 147.0, -26.0, 1.0, -11.0, 88.0, 155.0, 164.0, -289.0, 162.0, 12.0, 151.0, -176.0, 131.0, -258.0, -138.0, -157.0, 97.0, 112.0, 164.0, 188.0, 124.0, -196.0, -233.0, 188.0, -93.0, -177.0, -92.0, -301.0, 158.0, 134.0, 129.0, 165.0, 147.0, -337.0, 98.0, 142.0, -48.0, 134.0, 170.0, 130.0, -95.0, 62.0, -139.0, 189.0, -374.0, 145.0, 97.0, 77.0, 186.0, -133.0, 128.0, -11.0, 0.0, 124.0, 178.0, 174.0, -111.0, -31.0, -269.0, 135.0, 0.0, -40.0, 160.0, 158.0, -10.0, 73.0, -69.0, 91.0, 112.0, 80.0, 128.0, 80.0, 117.0, 121.0, 79.0, 91.0, 19.0, 96.0, 97.0, -98.0, 91.0, 103.0, 59.0, 149.0, 126.0, 8.0, 122.0, 176.0, 184.0, 57.0, -2.0, -146.0, 0.0, 182.0, -46.0, 7.0, 56.0, 0.0, -48.0, 136.0, 42.0, 116.0, 143.0, -106.0, -200.0, 98.0, 60.0, -77.0, -84.0, 188.0, 129.0, 79.0, 38.0, -44.0, -122.0, -287.0, 56.0, 128.0, -85.0, 93.0, 188.0, 170.0, 170.0, 95.0, 142.0, 100.0, 62.0, 0.0, -266.0, 64.0, 0.0, 48.0, -221.0, 75.0, 113.0, -11.0, 132.0, 30.0, 113.0, 103.0, 164.0, -310.0, 138.0, 76.0, 158.0, -285.0, 170.0, -72.0, 105.0, 93.0, -20.0, 154.0, 151.0, -98.0], "policy_predator_policy_reward": [8.0, 0.0, 15.0, 0.0, 0.0, 81.0, 7.0, 34.0, 1.0, 0.0, 30.0, 49.0, 0.0, 0.0, 0.0, 0.0, 40.0, 12.0, 0.0, 20.0, 75.0, 71.0, 4.0, 12.0, 35.0, 60.0, 67.0, 80.0, 8.0, 11.0, 8.0, 0.0, 94.0, 70.0, 7.0, 128.0, 0.0, 34.0, 0.0, 0.0, 12.0, 134.0, 42.0, 41.0, 27.0, 84.0, 16.0, 8.0, 1.0, 60.0, 3.0, 0.0, 144.0, 101.0, 35.0, 0.0, 31.0, 92.0, 138.0, 100.0, 127.0, 91.0, 0.0, 0.0, 0.0, 0.0, 42.0, 101.0, 99.0, 116.0, 98.0, 116.0, 51.0, 145.0, 3.0, 18.0, 0.0, 0.0, 177.0, 48.0, 0.0, 0.0, 24.0, 22.0, 0.0, 0.0, 114.0, 2.0, 86.0, 101.0, 165.0, 156.0, 29.0, 10.0, 87.0, 103.0, 0.0, 69.0, 0.0, 0.0, 0.0, 0.0, 88.0, 76.0, 154.0, 0.0, 49.0, 72.0, 2.0, 0.0, 0.0, 46.0, 69.0, 47.0, 26.0, 20.0, 7.0, 6.0, 1.0, 8.0, 0.0, 27.0, 53.0, 34.0, 31.0, 56.0, 13.0, 0.0, 16.0, 3.0, 54.0, 56.0, 7.0, 5.0, 3.0, 0.0, 17.0, 99.0, 0.0, 0.0, 59.0, 54.0, 21.0, 30.0, 29.0, 0.0, 0.0, 42.0, 43.0, 53.0, 117.0, 11.0, 72.0, 18.0, 53.0, 41.0, 0.0, 0.0, 54.0, 14.0, 163.0, 88.0, 3.0, 30.0, 106.0, 1.0, 2.0, 0.0, 0.0, 8.0, 12.0, 0.0, 0.0, 27.0, 148.0, 100.0, 0.0, 13.0, 0.0, 160.0, 70.0, 17.0, 7.0, 32.0, 0.0, 47.0, 164.0, 81.0, 0.0, 36.0, 158.0, 0.0, 75.0, 34.0, 0.0, 19.0, 8.0, 4.0, 70.0, 87.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 11.2125945147203, "mean_inference_ms": 33.53546780860792, "mean_action_processing_ms": 0.7535092222433696, "mean_env_wait_ms": 5.388186187251177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01191699504852295, "StateBufferConnector_ms": 0.011264920234680176, "ViewRequirementAgentConnector_ms": 0.45535123348236084}, "num_episodes": 23, "episode_return_max": 360.0, "episode_return_min": -197.0, "episode_return_mean": 158.99, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 231.21619960571235, "num_env_steps_trained_throughput_per_sec": 231.21619960571235, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 155061.763, "restore_workers_time_ms": 0.082, "training_step_time_ms": 155061.483, "sample_time_ms": 106776.369, "learn_time_ms": 48251.623, "learn_throughput": 82.899, "synch_weights_time_ms": 27.372}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "45bed_00000", "date": "2024-08-13_02-40-51", "timestamp": 1723531251, "time_this_iter_s": 17.358285903930664, "time_total_s": 5438.443209409714, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44f1820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5438.443209409714, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 85.53200000000001, "ram_util_percent": 83.52799999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7049926464914014, "cur_kl_coeff": 0.0001953125, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6100242139170409, "policy_loss": -0.0009766008290979598, "vf_loss": 1.611000170184191, "vf_explained_var": 0.00025914014962615157, "kl": 0.0032969559738671296, "entropy": 0.8333898720917878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.085889520846976, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.268803876543801, "policy_loss": -0.0031749135867579193, "vf_loss": 8.271978793068538, "vf_explained_var": 0.06988757914967007, "kl": 0.007706939852937747, "entropy": 1.1563402469196016, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 360.0, "episode_reward_min": -197.0, "episode_reward_mean": 158.57, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -374.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 177.0}, "policy_reward_mean": {"prey_policy": 41.065, "predator_policy": 38.22}, "custom_metrics": {}, "hist_stats": {"episode_reward": [188.0, 170.0, 62.0, 315.0, 6.0, 145.0, 51.0, 246.0, 120.0, 209.0, 98.0, 111.0, -77.0, 209.0, 352.0, 71.0, 170.0, -56.0, -197.0, 313.0, 294.0, 35.0, 240.0, 132.0, 300.0, 83.0, 237.0, 92.0, 213.0, 243.0, 186.0, 124.0, 352.0, 22.0, 20.0, 81.0, 320.0, 109.0, 138.0, 238.0, 221.0, 247.0, 197.0, 202.0, 86.0, 207.0, 227.0, 244.0, 310.0, 244.0, -32.0, 182.0, 74.0, 107.0, 117.0, 200.0, 133.0, 26.0, 73.0, 198.0, 208.0, 62.0, -158.0, 217.0, 115.0, 360.0, 273.0, 254.0, 89.0, 46.0, 61.0, 14.0, 189.0, 201.0, 263.0, 99.0, 250.0, 31.0, 207.0, 217.0, 146.0, 210.0, 117.0, 263.0, 307.0, 220.0, 114.0, 163.0, 142.0, 214.0, 45.0, 208.0, 31.0, 258.0, 277.0, 268.0, -91.0, 253.0, 171.0, 315.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, 139.0, 160.0, 10.0, 131.0, -215.0, 175.0, 57.0, 32.0, -137.0, 147.0, -26.0, 1.0, -11.0, 88.0, 155.0, 164.0, -289.0, 162.0, 12.0, 151.0, -176.0, 131.0, -258.0, -138.0, -157.0, 97.0, 112.0, 164.0, 188.0, 124.0, -196.0, -233.0, 188.0, -93.0, -177.0, -92.0, -301.0, 158.0, 134.0, 129.0, 165.0, 147.0, -337.0, 98.0, 142.0, -48.0, 134.0, 170.0, 130.0, -95.0, 62.0, -139.0, 189.0, -374.0, 145.0, 97.0, 77.0, 186.0, -133.0, 128.0, -11.0, 0.0, 124.0, 178.0, 174.0, -111.0, -31.0, -269.0, 135.0, 0.0, -40.0, 160.0, 158.0, -10.0, 73.0, -69.0, 91.0, 112.0, 80.0, 128.0, 80.0, 117.0, 121.0, 79.0, 91.0, 19.0, 96.0, 97.0, -98.0, 91.0, 103.0, 59.0, 149.0, 126.0, 8.0, 122.0, 176.0, 184.0, 57.0, -2.0, -146.0, 0.0, 182.0, -46.0, 7.0, 56.0, 0.0, -48.0, 136.0, 42.0, 116.0, 143.0, -106.0, -200.0, 98.0, 60.0, -77.0, -84.0, 188.0, 129.0, 79.0, 38.0, -44.0, -122.0, -287.0, 56.0, 128.0, -85.0, 93.0, 188.0, 170.0, 170.0, 95.0, 142.0, 100.0, 62.0, 0.0, -266.0, 64.0, 0.0, 48.0, -221.0, 75.0, 113.0, -11.0, 132.0, 30.0, 113.0, 103.0, 164.0, -310.0, 138.0, 76.0, 158.0, -285.0, 170.0, -72.0, 105.0, 93.0, -20.0, 154.0, 151.0, -98.0, 32.0, -14.0, 113.0, 139.0, 185.0, 122.0, 82.0, 134.0, 126.0, -54.0, 59.0, 80.0, -2.0, 139.0, 20.0, 90.0, 45.0, 0.0, 74.0, 128.0, -257.0, 81.0, 180.0, 29.0, 127.0, 143.0, 132.0, 135.0, -10.0, -172.0, 111.0, 107.0, 70.0, 74.0, 140.0, 172.0], "policy_predator_policy_reward": [0.0, 34.0, 0.0, 0.0, 12.0, 134.0, 42.0, 41.0, 27.0, 84.0, 16.0, 8.0, 1.0, 60.0, 3.0, 0.0, 144.0, 101.0, 35.0, 0.0, 31.0, 92.0, 138.0, 100.0, 127.0, 91.0, 0.0, 0.0, 0.0, 0.0, 42.0, 101.0, 99.0, 116.0, 98.0, 116.0, 51.0, 145.0, 3.0, 18.0, 0.0, 0.0, 177.0, 48.0, 0.0, 0.0, 24.0, 22.0, 0.0, 0.0, 114.0, 2.0, 86.0, 101.0, 165.0, 156.0, 29.0, 10.0, 87.0, 103.0, 0.0, 69.0, 0.0, 0.0, 0.0, 0.0, 88.0, 76.0, 154.0, 0.0, 49.0, 72.0, 2.0, 0.0, 0.0, 46.0, 69.0, 47.0, 26.0, 20.0, 7.0, 6.0, 1.0, 8.0, 0.0, 27.0, 53.0, 34.0, 31.0, 56.0, 13.0, 0.0, 16.0, 3.0, 54.0, 56.0, 7.0, 5.0, 3.0, 0.0, 17.0, 99.0, 0.0, 0.0, 59.0, 54.0, 21.0, 30.0, 29.0, 0.0, 0.0, 42.0, 43.0, 53.0, 117.0, 11.0, 72.0, 18.0, 53.0, 41.0, 0.0, 0.0, 54.0, 14.0, 163.0, 88.0, 3.0, 30.0, 106.0, 1.0, 2.0, 0.0, 0.0, 8.0, 12.0, 0.0, 0.0, 27.0, 148.0, 100.0, 0.0, 13.0, 0.0, 160.0, 70.0, 17.0, 7.0, 32.0, 0.0, 47.0, 164.0, 81.0, 0.0, 36.0, 158.0, 0.0, 75.0, 34.0, 0.0, 19.0, 8.0, 4.0, 70.0, 87.0, 68.0, 31.0, 2.0, 9.0, 0.0, 0.0, 3.0, 1.0, 42.0, 0.0, 4.0, 20.0, 0.0, 5.0, 67.0, 37.0, 0.0, 0.0, 0.0, 6.0, 66.0, 141.0, 49.0, 0.0, 7.0, 0.0, 1.0, 0.0, 91.0, 0.0, 35.0, 0.0, 0.0, 27.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 11.059292729936406, "mean_inference_ms": 33.52568434135249, "mean_action_processing_ms": 0.7501260331047652, "mean_env_wait_ms": 5.311258964721057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010529637336730957, "StateBufferConnector_ms": 0.010605454444885254, "ViewRequirementAgentConnector_ms": 0.36780214309692383}, "num_episodes": 18, "episode_return_max": 360.0, "episode_return_min": -197.0, "episode_return_mean": 158.57, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.64552764766907, "num_env_steps_trained_throughput_per_sec": 234.64552764766907, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 154606.159, "restore_workers_time_ms": 0.081, "training_step_time_ms": 154605.877, "sample_time_ms": 106739.024, "learn_time_ms": 47811.413, "learn_throughput": 83.662, "synch_weights_time_ms": 44.195}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "45bed_00000", "date": "2024-08-13_02-41-08", "timestamp": 1723531268, "time_this_iter_s": 17.226045846939087, "time_total_s": 5455.669255256653, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33073c0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5455.669255256653, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 84.86666666666667, "ram_util_percent": 83.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.833599147894395, "cur_kl_coeff": 9.765625e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.392381850247661, "policy_loss": -0.0022885258940280114, "vf_loss": 5.394669746469568, "vf_explained_var": -0.0001109349979925408, "kl": 0.0064786629105708345, "entropy": 0.798103708091867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.54401105058887, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.431017521197203, "policy_loss": -0.0029799377676296645, "vf_loss": 8.433997455475822, "vf_explained_var": 0.12263860387146158, "kl": 0.007666703853766498, "entropy": 1.0914619655836195, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 360.0, "episode_reward_min": -197.0, "episode_reward_mean": 162.5, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -374.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 177.0}, "policy_reward_mean": {"prey_policy": 44.115, "predator_policy": 37.135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-197.0, 313.0, 294.0, 35.0, 240.0, 132.0, 300.0, 83.0, 237.0, 92.0, 213.0, 243.0, 186.0, 124.0, 352.0, 22.0, 20.0, 81.0, 320.0, 109.0, 138.0, 238.0, 221.0, 247.0, 197.0, 202.0, 86.0, 207.0, 227.0, 244.0, 310.0, 244.0, -32.0, 182.0, 74.0, 107.0, 117.0, 200.0, 133.0, 26.0, 73.0, 198.0, 208.0, 62.0, -158.0, 217.0, 115.0, 360.0, 273.0, 254.0, 89.0, 46.0, 61.0, 14.0, 189.0, 201.0, 263.0, 99.0, 250.0, 31.0, 207.0, 217.0, 146.0, 210.0, 117.0, 263.0, 307.0, 220.0, 114.0, 163.0, 142.0, 214.0, 45.0, 208.0, 31.0, 258.0, 277.0, 268.0, -91.0, 253.0, 171.0, 315.0, 284.0, 182.0, 118.0, 121.0, 229.0, -190.0, 297.0, 180.0, 119.0, 242.0, -5.0, 191.0, 232.0, 350.0, 137.0, 40.0, 177.0, 79.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-92.0, -301.0, 158.0, 134.0, 129.0, 165.0, 147.0, -337.0, 98.0, 142.0, -48.0, 134.0, 170.0, 130.0, -95.0, 62.0, -139.0, 189.0, -374.0, 145.0, 97.0, 77.0, 186.0, -133.0, 128.0, -11.0, 0.0, 124.0, 178.0, 174.0, -111.0, -31.0, -269.0, 135.0, 0.0, -40.0, 160.0, 158.0, -10.0, 73.0, -69.0, 91.0, 112.0, 80.0, 128.0, 80.0, 117.0, 121.0, 79.0, 91.0, 19.0, 96.0, 97.0, -98.0, 91.0, 103.0, 59.0, 149.0, 126.0, 8.0, 122.0, 176.0, 184.0, 57.0, -2.0, -146.0, 0.0, 182.0, -46.0, 7.0, 56.0, 0.0, -48.0, 136.0, 42.0, 116.0, 143.0, -106.0, -200.0, 98.0, 60.0, -77.0, -84.0, 188.0, 129.0, 79.0, 38.0, -44.0, -122.0, -287.0, 56.0, 128.0, -85.0, 93.0, 188.0, 170.0, 170.0, 95.0, 142.0, 100.0, 62.0, 0.0, -266.0, 64.0, 0.0, 48.0, -221.0, 75.0, 113.0, -11.0, 132.0, 30.0, 113.0, 103.0, 164.0, -310.0, 138.0, 76.0, 158.0, -285.0, 170.0, -72.0, 105.0, 93.0, -20.0, 154.0, 151.0, -98.0, 32.0, -14.0, 113.0, 139.0, 185.0, 122.0, 82.0, 134.0, 126.0, -54.0, 59.0, 80.0, -2.0, 139.0, 20.0, 90.0, 45.0, 0.0, 74.0, 128.0, -257.0, 81.0, 180.0, 29.0, 127.0, 143.0, 132.0, 135.0, -10.0, -172.0, 111.0, 107.0, 70.0, 74.0, 140.0, 172.0, 159.0, 125.0, 189.0, -16.0, 91.0, -55.0, -178.0, 143.0, 73.0, 125.0, -199.0, -259.0, 154.0, 143.0, 115.0, -63.0, 146.0, -304.0, 173.0, 22.0, 0.0, -127.0, 144.0, 15.0, 97.0, 101.0, 170.0, 170.0, 6.0, 76.0, 33.0, -90.0, 154.0, 4.0, 81.0, -311.0], "policy_predator_policy_reward": [51.0, 145.0, 3.0, 18.0, 0.0, 0.0, 177.0, 48.0, 0.0, 0.0, 24.0, 22.0, 0.0, 0.0, 114.0, 2.0, 86.0, 101.0, 165.0, 156.0, 29.0, 10.0, 87.0, 103.0, 0.0, 69.0, 0.0, 0.0, 0.0, 0.0, 88.0, 76.0, 154.0, 0.0, 49.0, 72.0, 2.0, 0.0, 0.0, 46.0, 69.0, 47.0, 26.0, 20.0, 7.0, 6.0, 1.0, 8.0, 0.0, 27.0, 53.0, 34.0, 31.0, 56.0, 13.0, 0.0, 16.0, 3.0, 54.0, 56.0, 7.0, 5.0, 3.0, 0.0, 17.0, 99.0, 0.0, 0.0, 59.0, 54.0, 21.0, 30.0, 29.0, 0.0, 0.0, 42.0, 43.0, 53.0, 117.0, 11.0, 72.0, 18.0, 53.0, 41.0, 0.0, 0.0, 54.0, 14.0, 163.0, 88.0, 3.0, 30.0, 106.0, 1.0, 2.0, 0.0, 0.0, 8.0, 12.0, 0.0, 0.0, 27.0, 148.0, 100.0, 0.0, 13.0, 0.0, 160.0, 70.0, 17.0, 7.0, 32.0, 0.0, 47.0, 164.0, 81.0, 0.0, 36.0, 158.0, 0.0, 75.0, 34.0, 0.0, 19.0, 8.0, 4.0, 70.0, 87.0, 68.0, 31.0, 2.0, 9.0, 0.0, 0.0, 3.0, 1.0, 42.0, 0.0, 4.0, 20.0, 0.0, 5.0, 67.0, 37.0, 0.0, 0.0, 0.0, 6.0, 66.0, 141.0, 49.0, 0.0, 7.0, 0.0, 1.0, 0.0, 91.0, 0.0, 35.0, 0.0, 0.0, 27.0, 0.0, 3.0, 0.0, 0.0, 8.0, 1.0, 0.0, 82.0, 86.0, 70.0, 15.0, 16.0, 115.0, 153.0, 0.0, 0.0, 61.0, 67.0, 125.0, 152.0, 47.0, 0.0, 79.0, 43.0, 32.0, 0.0, 0.0, 34.0, 10.0, 0.0, 3.0, 52.0, 55.0, 42.0, 19.0, 0.0, 164.0, 145.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.910641191754838, "mean_inference_ms": 33.069308611553566, "mean_action_processing_ms": 0.7465429660177503, "mean_env_wait_ms": 5.236966366725288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010638713836669922, "StateBufferConnector_ms": 0.007953882217407227, "ViewRequirementAgentConnector_ms": 0.3656989336013794}, "num_episodes": 18, "episode_return_max": 360.0, "episode_return_min": -197.0, "episode_return_mean": 162.5, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.8444065382646, "num_env_steps_trained_throughput_per_sec": 212.8444065382646, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 154217.444, "restore_workers_time_ms": 0.082, "training_step_time_ms": 154217.163, "sample_time_ms": 106619.531, "learn_time_ms": 47544.096, "learn_throughput": 84.132, "synch_weights_time_ms": 42.697}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "45bed_00000", "date": "2024-08-13_02-41-27", "timestamp": 1723531287, "time_this_iter_s": 18.870352268218994, "time_total_s": 5474.539607524872, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33073f5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5474.539607524872, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 85.48148148148147, "ram_util_percent": 83.4148148148148}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8280250496649868, "cur_kl_coeff": 9.765625e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4312650264255584, "policy_loss": -0.002180463187371888, "vf_loss": 3.433444569476698, "vf_explained_var": -0.00015685009577917674, "kl": 0.009399404861841739, "entropy": 0.7774339256463227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.786318758808115, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.673592558865825, "policy_loss": -0.0024742653223848534, "vf_loss": 7.676066832063059, "vf_explained_var": 0.3441400926579874, "kl": 0.004393074974759538, "entropy": 1.1877713373729162, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 360.0, "episode_reward_min": -190.0, "episode_reward_mean": 158.89, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -311.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 165.0}, "policy_reward_mean": {"prey_policy": 44.22, "predator_policy": 35.225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [221.0, 247.0, 197.0, 202.0, 86.0, 207.0, 227.0, 244.0, 310.0, 244.0, -32.0, 182.0, 74.0, 107.0, 117.0, 200.0, 133.0, 26.0, 73.0, 198.0, 208.0, 62.0, -158.0, 217.0, 115.0, 360.0, 273.0, 254.0, 89.0, 46.0, 61.0, 14.0, 189.0, 201.0, 263.0, 99.0, 250.0, 31.0, 207.0, 217.0, 146.0, 210.0, 117.0, 263.0, 307.0, 220.0, 114.0, 163.0, 142.0, 214.0, 45.0, 208.0, 31.0, 258.0, 277.0, 268.0, -91.0, 253.0, 171.0, 315.0, 284.0, 182.0, 118.0, 121.0, 229.0, -190.0, 297.0, 180.0, 119.0, 242.0, -5.0, 191.0, 232.0, 350.0, 137.0, 40.0, 177.0, 79.0, 54.0, 75.0, 196.0, 201.0, -68.0, 50.0, 79.0, 244.0, 294.0, 147.0, 209.0, 101.0, 188.0, 199.0, 285.0, 153.0, 218.0, 144.0, 90.0, 201.0, 38.0, 116.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [128.0, 80.0, 117.0, 121.0, 79.0, 91.0, 19.0, 96.0, 97.0, -98.0, 91.0, 103.0, 59.0, 149.0, 126.0, 8.0, 122.0, 176.0, 184.0, 57.0, -2.0, -146.0, 0.0, 182.0, -46.0, 7.0, 56.0, 0.0, -48.0, 136.0, 42.0, 116.0, 143.0, -106.0, -200.0, 98.0, 60.0, -77.0, -84.0, 188.0, 129.0, 79.0, 38.0, -44.0, -122.0, -287.0, 56.0, 128.0, -85.0, 93.0, 188.0, 170.0, 170.0, 95.0, 142.0, 100.0, 62.0, 0.0, -266.0, 64.0, 0.0, 48.0, -221.0, 75.0, 113.0, -11.0, 132.0, 30.0, 113.0, 103.0, 164.0, -310.0, 138.0, 76.0, 158.0, -285.0, 170.0, -72.0, 105.0, 93.0, -20.0, 154.0, 151.0, -98.0, 32.0, -14.0, 113.0, 139.0, 185.0, 122.0, 82.0, 134.0, 126.0, -54.0, 59.0, 80.0, -2.0, 139.0, 20.0, 90.0, 45.0, 0.0, 74.0, 128.0, -257.0, 81.0, 180.0, 29.0, 127.0, 143.0, 132.0, 135.0, -10.0, -172.0, 111.0, 107.0, 70.0, 74.0, 140.0, 172.0, 159.0, 125.0, 189.0, -16.0, 91.0, -55.0, -178.0, 143.0, 73.0, 125.0, -199.0, -259.0, 154.0, 143.0, 115.0, -63.0, 146.0, -304.0, 173.0, 22.0, 0.0, -127.0, 144.0, 15.0, 97.0, 101.0, 170.0, 170.0, 6.0, 76.0, 33.0, -90.0, 154.0, 4.0, 81.0, -311.0, -134.0, -106.0, 58.0, -109.0, 194.0, 0.0, 19.0, 177.0, -198.0, -48.0, 29.0, 0.0, 113.0, -293.0, 91.0, 123.0, 172.0, 117.0, -30.0, 149.0, 97.0, 83.0, 137.0, -102.0, -103.0, 128.0, 147.0, 41.0, 141.0, 144.0, 8.0, 67.0, 113.0, 91.0, 169.0, -56.0, 36.0, -26.0, 17.0, 114.0, -40.0, -52.0, 141.0, -82.0], "policy_predator_policy_reward": [7.0, 6.0, 1.0, 8.0, 0.0, 27.0, 53.0, 34.0, 31.0, 56.0, 13.0, 0.0, 16.0, 3.0, 54.0, 56.0, 7.0, 5.0, 3.0, 0.0, 17.0, 99.0, 0.0, 0.0, 59.0, 54.0, 21.0, 30.0, 29.0, 0.0, 0.0, 42.0, 43.0, 53.0, 117.0, 11.0, 72.0, 18.0, 53.0, 41.0, 0.0, 0.0, 54.0, 14.0, 163.0, 88.0, 3.0, 30.0, 106.0, 1.0, 2.0, 0.0, 0.0, 8.0, 12.0, 0.0, 0.0, 27.0, 148.0, 100.0, 0.0, 13.0, 0.0, 160.0, 70.0, 17.0, 7.0, 32.0, 0.0, 47.0, 164.0, 81.0, 0.0, 36.0, 158.0, 0.0, 75.0, 34.0, 0.0, 19.0, 8.0, 4.0, 70.0, 87.0, 68.0, 31.0, 2.0, 9.0, 0.0, 0.0, 3.0, 1.0, 42.0, 0.0, 4.0, 20.0, 0.0, 5.0, 67.0, 37.0, 0.0, 0.0, 0.0, 6.0, 66.0, 141.0, 49.0, 0.0, 7.0, 0.0, 1.0, 0.0, 91.0, 0.0, 35.0, 0.0, 0.0, 27.0, 0.0, 3.0, 0.0, 0.0, 8.0, 1.0, 0.0, 82.0, 86.0, 70.0, 15.0, 16.0, 115.0, 153.0, 0.0, 0.0, 61.0, 67.0, 125.0, 152.0, 47.0, 0.0, 79.0, 43.0, 32.0, 0.0, 0.0, 34.0, 10.0, 0.0, 3.0, 52.0, 55.0, 42.0, 19.0, 0.0, 164.0, 145.0, 165.0, 129.0, 81.0, 45.0, 2.0, 0.0, 1.0, 4.0, 121.0, 57.0, 16.0, 5.0, 159.0, 100.0, 0.0, 30.0, 0.0, 5.0, 15.0, 13.0, 4.0, 25.0, 15.0, 51.0, 82.0, 81.0, 8.0, 3.0, 0.0, 0.0, 0.0, 78.0, 8.0, 6.0, 24.0, 7.0, 48.0, 32.0, 9.0, 61.0, 85.0, 45.0, 22.0, 35.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.753693821752764, "mean_inference_ms": 32.05620068541161, "mean_action_processing_ms": 0.7413136275615618, "mean_env_wait_ms": 5.563218990067769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008327245712280273, "StateBufferConnector_ms": 0.006701469421386719, "ViewRequirementAgentConnector_ms": 0.339868426322937}, "num_episodes": 22, "episode_return_max": 360.0, "episode_return_min": -190.0, "episode_return_mean": 158.89, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 203.08059012133197, "num_env_steps_trained_throughput_per_sec": 203.08059012133197, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 154001.333, "restore_workers_time_ms": 0.082, "training_step_time_ms": 154001.051, "sample_time_ms": 106591.953, "learn_time_ms": 47355.577, "learn_throughput": 84.467, "synch_weights_time_ms": 42.581}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "45bed_00000", "date": "2024-08-13_02-41-47", "timestamp": 1723531307, "time_this_iter_s": 19.73762798309326, "time_total_s": 5494.277235507965, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3306bd310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5494.277235507965, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 85.98214285714288, "ram_util_percent": 83.23571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8016160266266928, "cur_kl_coeff": 9.765625e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2112450910623744, "policy_loss": -0.0040299778749979046, "vf_loss": 3.215273998654078, "vf_explained_var": 0.00020594202652179374, "kl": 0.01096265401580641, "entropy": 0.7793337998566804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.161289251481413, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.85455122649985, "policy_loss": -0.0017993256736734005, "vf_loss": 7.8563505720209195, "vf_explained_var": 0.16649381840039815, "kl": 0.00538529060637056, "entropy": 1.184494527307137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 360.0, "episode_reward_min": -190.0, "episode_reward_mean": 158.78, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -329.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 165.0}, "policy_reward_mean": {"prey_policy": 40.86, "predator_policy": 38.53}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.0, 198.0, 208.0, 62.0, -158.0, 217.0, 115.0, 360.0, 273.0, 254.0, 89.0, 46.0, 61.0, 14.0, 189.0, 201.0, 263.0, 99.0, 250.0, 31.0, 207.0, 217.0, 146.0, 210.0, 117.0, 263.0, 307.0, 220.0, 114.0, 163.0, 142.0, 214.0, 45.0, 208.0, 31.0, 258.0, 277.0, 268.0, -91.0, 253.0, 171.0, 315.0, 284.0, 182.0, 118.0, 121.0, 229.0, -190.0, 297.0, 180.0, 119.0, 242.0, -5.0, 191.0, 232.0, 350.0, 137.0, 40.0, 177.0, 79.0, 54.0, 75.0, 196.0, 201.0, -68.0, 50.0, 79.0, 244.0, 294.0, 147.0, 209.0, 101.0, 188.0, 199.0, 285.0, 153.0, 218.0, 144.0, 90.0, 201.0, 38.0, 116.0, 118.0, 158.0, 341.0, 334.0, 225.0, 126.0, 143.0, 182.0, 138.0, 166.0, 46.0, 294.0, 108.0, 109.0, 5.0, 152.0, 172.0, 164.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [60.0, -77.0, -84.0, 188.0, 129.0, 79.0, 38.0, -44.0, -122.0, -287.0, 56.0, 128.0, -85.0, 93.0, 188.0, 170.0, 170.0, 95.0, 142.0, 100.0, 62.0, 0.0, -266.0, 64.0, 0.0, 48.0, -221.0, 75.0, 113.0, -11.0, 132.0, 30.0, 113.0, 103.0, 164.0, -310.0, 138.0, 76.0, 158.0, -285.0, 170.0, -72.0, 105.0, 93.0, -20.0, 154.0, 151.0, -98.0, 32.0, -14.0, 113.0, 139.0, 185.0, 122.0, 82.0, 134.0, 126.0, -54.0, 59.0, 80.0, -2.0, 139.0, 20.0, 90.0, 45.0, 0.0, 74.0, 128.0, -257.0, 81.0, 180.0, 29.0, 127.0, 143.0, 132.0, 135.0, -10.0, -172.0, 111.0, 107.0, 70.0, 74.0, 140.0, 172.0, 159.0, 125.0, 189.0, -16.0, 91.0, -55.0, -178.0, 143.0, 73.0, 125.0, -199.0, -259.0, 154.0, 143.0, 115.0, -63.0, 146.0, -304.0, 173.0, 22.0, 0.0, -127.0, 144.0, 15.0, 97.0, 101.0, 170.0, 170.0, 6.0, 76.0, 33.0, -90.0, 154.0, 4.0, 81.0, -311.0, -134.0, -106.0, 58.0, -109.0, 194.0, 0.0, 19.0, 177.0, -198.0, -48.0, 29.0, 0.0, 113.0, -293.0, 91.0, 123.0, 172.0, 117.0, -30.0, 149.0, 97.0, 83.0, 137.0, -102.0, -103.0, 128.0, 147.0, 41.0, 141.0, 144.0, 8.0, 67.0, 113.0, 91.0, 169.0, -56.0, 36.0, -26.0, 17.0, 114.0, -40.0, -52.0, 141.0, -82.0, -68.0, 0.0, 176.0, -128.0, 141.0, 200.0, 173.0, 161.0, 111.0, 97.0, 117.0, -136.0, -329.0, 188.0, 105.0, 77.0, -22.0, 149.0, 162.0, 0.0, 46.0, 0.0, 148.0, 126.0, 133.0, -325.0, 109.0, 0.0, -187.0, -2.0, -141.0, 105.0, -57.0, 149.0, 115.0, -28.0], "policy_predator_policy_reward": [72.0, 18.0, 53.0, 41.0, 0.0, 0.0, 54.0, 14.0, 163.0, 88.0, 3.0, 30.0, 106.0, 1.0, 2.0, 0.0, 0.0, 8.0, 12.0, 0.0, 0.0, 27.0, 148.0, 100.0, 0.0, 13.0, 0.0, 160.0, 70.0, 17.0, 7.0, 32.0, 0.0, 47.0, 164.0, 81.0, 0.0, 36.0, 158.0, 0.0, 75.0, 34.0, 0.0, 19.0, 8.0, 4.0, 70.0, 87.0, 68.0, 31.0, 2.0, 9.0, 0.0, 0.0, 3.0, 1.0, 42.0, 0.0, 4.0, 20.0, 0.0, 5.0, 67.0, 37.0, 0.0, 0.0, 0.0, 6.0, 66.0, 141.0, 49.0, 0.0, 7.0, 0.0, 1.0, 0.0, 91.0, 0.0, 35.0, 0.0, 0.0, 27.0, 0.0, 3.0, 0.0, 0.0, 8.0, 1.0, 0.0, 82.0, 86.0, 70.0, 15.0, 16.0, 115.0, 153.0, 0.0, 0.0, 61.0, 67.0, 125.0, 152.0, 47.0, 0.0, 79.0, 43.0, 32.0, 0.0, 0.0, 34.0, 10.0, 0.0, 3.0, 52.0, 55.0, 42.0, 19.0, 0.0, 164.0, 145.0, 165.0, 129.0, 81.0, 45.0, 2.0, 0.0, 1.0, 4.0, 121.0, 57.0, 16.0, 5.0, 159.0, 100.0, 0.0, 30.0, 0.0, 5.0, 15.0, 13.0, 4.0, 25.0, 15.0, 51.0, 82.0, 81.0, 8.0, 3.0, 0.0, 0.0, 0.0, 78.0, 8.0, 6.0, 24.0, 7.0, 48.0, 32.0, 9.0, 61.0, 85.0, 45.0, 22.0, 35.0, 86.0, 100.0, 102.0, 8.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 112.0, 33.0, 145.0, 139.0, 0.0, 0.0, 0.0, 11.0, 4.0, 0.0, 0.0, 0.0, 8.0, 12.0, 140.0, 160.0, 0.0, 0.0, 96.0, 98.0, 85.0, 103.0, 0.0, 80.0, 37.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.60259097517155, "mean_inference_ms": 32.029821144705934, "mean_action_processing_ms": 0.73721303357163, "mean_env_wait_ms": 5.053931276146967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062149763107299805, "StateBufferConnector_ms": 0.005637526512145996, "ViewRequirementAgentConnector_ms": 0.25773000717163086}, "num_episodes": 18, "episode_return_max": 360.0, "episode_return_min": -190.0, "episode_return_mean": 158.78, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 205.2875077117951, "num_env_steps_trained_throughput_per_sec": 205.2875077117951, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 153751.587, "restore_workers_time_ms": 0.082, "training_step_time_ms": 153751.304, "sample_time_ms": 106488.813, "learn_time_ms": 47210.98, "learn_throughput": 84.726, "synch_weights_time_ms": 40.971}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "45bed_00000", "date": "2024-08-13_02-42-07", "timestamp": 1723531327, "time_this_iter_s": 19.52671527862549, "time_total_s": 5513.803950786591, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4463310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5513.803950786591, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 85.58888888888887, "ram_util_percent": 83.27037037037037}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8448330006981022, "cur_kl_coeff": 9.765625e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6416065255170147, "policy_loss": -0.004110291778854041, "vf_loss": 2.6457157705195997, "vf_explained_var": 0.0006687224857390873, "kl": 0.010835583590331547, "entropy": 0.7370276094429077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.636053067761125, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.157930784629135, "policy_loss": -0.004503750231205707, "vf_loss": 8.162434519157207, "vf_explained_var": 0.2719149060980984, "kl": 0.010435006140296967, "entropy": 1.1910308281580606, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 350.0, "episode_reward_min": -190.0, "episode_reward_mean": 164.61, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -329.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 165.0}, "policy_reward_mean": {"prey_policy": 45.94, "predator_policy": 36.365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.0, 117.0, 263.0, 307.0, 220.0, 114.0, 163.0, 142.0, 214.0, 45.0, 208.0, 31.0, 258.0, 277.0, 268.0, -91.0, 253.0, 171.0, 315.0, 284.0, 182.0, 118.0, 121.0, 229.0, -190.0, 297.0, 180.0, 119.0, 242.0, -5.0, 191.0, 232.0, 350.0, 137.0, 40.0, 177.0, 79.0, 54.0, 75.0, 196.0, 201.0, -68.0, 50.0, 79.0, 244.0, 294.0, 147.0, 209.0, 101.0, 188.0, 199.0, 285.0, 153.0, 218.0, 144.0, 90.0, 201.0, 38.0, 116.0, 118.0, 158.0, 341.0, 334.0, 225.0, 126.0, 143.0, 182.0, 138.0, 166.0, 46.0, 294.0, 108.0, 109.0, 5.0, 152.0, 172.0, 164.0, 127.0, 255.0, 145.0, 101.0, 289.0, 257.0, 320.0, 42.0, 4.0, 333.0, 136.0, 130.0, 11.0, 143.0, 282.0, 57.0, 100.0, 240.0, 164.0, 133.0, 272.0, 148.0, 309.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [151.0, -98.0, 32.0, -14.0, 113.0, 139.0, 185.0, 122.0, 82.0, 134.0, 126.0, -54.0, 59.0, 80.0, -2.0, 139.0, 20.0, 90.0, 45.0, 0.0, 74.0, 128.0, -257.0, 81.0, 180.0, 29.0, 127.0, 143.0, 132.0, 135.0, -10.0, -172.0, 111.0, 107.0, 70.0, 74.0, 140.0, 172.0, 159.0, 125.0, 189.0, -16.0, 91.0, -55.0, -178.0, 143.0, 73.0, 125.0, -199.0, -259.0, 154.0, 143.0, 115.0, -63.0, 146.0, -304.0, 173.0, 22.0, 0.0, -127.0, 144.0, 15.0, 97.0, 101.0, 170.0, 170.0, 6.0, 76.0, 33.0, -90.0, 154.0, 4.0, 81.0, -311.0, -134.0, -106.0, 58.0, -109.0, 194.0, 0.0, 19.0, 177.0, -198.0, -48.0, 29.0, 0.0, 113.0, -293.0, 91.0, 123.0, 172.0, 117.0, -30.0, 149.0, 97.0, 83.0, 137.0, -102.0, -103.0, 128.0, 147.0, 41.0, 141.0, 144.0, 8.0, 67.0, 113.0, 91.0, 169.0, -56.0, 36.0, -26.0, 17.0, 114.0, -40.0, -52.0, 141.0, -82.0, -68.0, 0.0, 176.0, -128.0, 141.0, 200.0, 173.0, 161.0, 111.0, 97.0, 117.0, -136.0, -329.0, 188.0, 105.0, 77.0, -22.0, 149.0, 162.0, 0.0, 46.0, 0.0, 148.0, 126.0, 133.0, -325.0, 109.0, 0.0, -187.0, -2.0, -141.0, 105.0, -57.0, 149.0, 115.0, -28.0, -141.0, 104.0, 165.0, 82.0, 16.0, 30.0, 101.0, 0.0, 155.0, 110.0, 108.0, 140.0, 161.0, 159.0, 50.0, -137.0, -89.0, -135.0, 148.0, 185.0, 98.0, -75.0, -2.0, 58.0, -129.0, -138.0, -173.0, 138.0, 146.0, 136.0, 28.0, 0.0, 100.0, 0.0, 157.0, 49.0, 91.0, 73.0, 123.0, -8.0, 135.0, 137.0, 55.0, 59.0, 163.0, 133.0], "policy_predator_policy_reward": [70.0, 87.0, 68.0, 31.0, 2.0, 9.0, 0.0, 0.0, 3.0, 1.0, 42.0, 0.0, 4.0, 20.0, 0.0, 5.0, 67.0, 37.0, 0.0, 0.0, 0.0, 6.0, 66.0, 141.0, 49.0, 0.0, 7.0, 0.0, 1.0, 0.0, 91.0, 0.0, 35.0, 0.0, 0.0, 27.0, 0.0, 3.0, 0.0, 0.0, 8.0, 1.0, 0.0, 82.0, 86.0, 70.0, 15.0, 16.0, 115.0, 153.0, 0.0, 0.0, 61.0, 67.0, 125.0, 152.0, 47.0, 0.0, 79.0, 43.0, 32.0, 0.0, 0.0, 34.0, 10.0, 0.0, 3.0, 52.0, 55.0, 42.0, 19.0, 0.0, 164.0, 145.0, 165.0, 129.0, 81.0, 45.0, 2.0, 0.0, 1.0, 4.0, 121.0, 57.0, 16.0, 5.0, 159.0, 100.0, 0.0, 30.0, 0.0, 5.0, 15.0, 13.0, 4.0, 25.0, 15.0, 51.0, 82.0, 81.0, 8.0, 3.0, 0.0, 0.0, 0.0, 78.0, 8.0, 6.0, 24.0, 7.0, 48.0, 32.0, 9.0, 61.0, 85.0, 45.0, 22.0, 35.0, 86.0, 100.0, 102.0, 8.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 112.0, 33.0, 145.0, 139.0, 0.0, 0.0, 0.0, 11.0, 4.0, 0.0, 0.0, 0.0, 8.0, 12.0, 140.0, 160.0, 0.0, 0.0, 96.0, 98.0, 85.0, 103.0, 0.0, 80.0, 37.0, 40.0, 100.0, 64.0, 8.0, 0.0, 39.0, 60.0, 0.0, 0.0, 11.0, 13.0, 9.0, 0.0, 0.0, 0.0, 68.0, 61.0, 124.0, 104.0, 0.0, 0.0, 70.0, 43.0, 26.0, 48.0, 147.0, 131.0, 107.0, 71.0, 0.0, 0.0, 1.0, 28.0, 0.0, 0.0, 17.0, 17.0, 0.0, 0.0, 14.0, 4.0, 0.0, 0.0, 17.0, 17.0, 5.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.384107265068213, "mean_inference_ms": 31.4690905350311, "mean_action_processing_ms": 0.7317218226512598, "mean_env_wait_ms": 4.980445185830505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075637102127075195, "StateBufferConnector_ms": 0.006060957908630371, "ViewRequirementAgentConnector_ms": 0.27984750270843506}, "num_episodes": 23, "episode_return_max": 350.0, "episode_return_min": -190.0, "episode_return_mean": 164.61, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 185.2971186188581, "num_env_steps_trained_throughput_per_sec": 185.2971186188581, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 153619.786, "restore_workers_time_ms": 0.082, "training_step_time_ms": 153619.376, "sample_time_ms": 106470.184, "learn_time_ms": 47100.181, "learn_throughput": 84.925, "synch_weights_time_ms": 38.94}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "45bed_00000", "date": "2024-08-13_02-42-28", "timestamp": 1723531348, "time_this_iter_s": 21.624172925949097, "time_total_s": 5535.42812371254, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4463ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5535.42812371254, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 86.59354838709677, "ram_util_percent": 83.50967741935484}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9046987168727413, "cur_kl_coeff": 9.765625e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.232095115083866, "policy_loss": -0.0033305745889684038, "vf_loss": 3.2354252289211938, "vf_explained_var": -0.00047372191671341186, "kl": 0.004697435455319036, "entropy": 0.7217654638504856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.930782696242055, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.760365764173881, "policy_loss": -0.0014039307044296668, "vf_loss": 7.761769691598478, "vf_explained_var": 0.41011909306364713, "kl": 0.006688952540154923, "entropy": 1.1228772702671233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 357.0, "episode_reward_min": -190.0, "episode_reward_mean": 165.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -329.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 165.0}, "policy_reward_mean": {"prey_policy": 46.625, "predator_policy": 36.015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [315.0, 284.0, 182.0, 118.0, 121.0, 229.0, -190.0, 297.0, 180.0, 119.0, 242.0, -5.0, 191.0, 232.0, 350.0, 137.0, 40.0, 177.0, 79.0, 54.0, 75.0, 196.0, 201.0, -68.0, 50.0, 79.0, 244.0, 294.0, 147.0, 209.0, 101.0, 188.0, 199.0, 285.0, 153.0, 218.0, 144.0, 90.0, 201.0, 38.0, 116.0, 118.0, 158.0, 341.0, 334.0, 225.0, 126.0, 143.0, 182.0, 138.0, 166.0, 46.0, 294.0, 108.0, 109.0, 5.0, 152.0, 172.0, 164.0, 127.0, 255.0, 145.0, 101.0, 289.0, 257.0, 320.0, 42.0, 4.0, 333.0, 136.0, 130.0, 11.0, 143.0, 282.0, 57.0, 100.0, 240.0, 164.0, 133.0, 272.0, 148.0, 309.0, 106.0, 149.0, 154.0, 202.0, 149.0, 311.0, 139.0, -18.0, 119.0, -1.0, 276.0, 231.0, 231.0, 160.0, 357.0, 228.0, 119.0, 325.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [140.0, 172.0, 159.0, 125.0, 189.0, -16.0, 91.0, -55.0, -178.0, 143.0, 73.0, 125.0, -199.0, -259.0, 154.0, 143.0, 115.0, -63.0, 146.0, -304.0, 173.0, 22.0, 0.0, -127.0, 144.0, 15.0, 97.0, 101.0, 170.0, 170.0, 6.0, 76.0, 33.0, -90.0, 154.0, 4.0, 81.0, -311.0, -134.0, -106.0, 58.0, -109.0, 194.0, 0.0, 19.0, 177.0, -198.0, -48.0, 29.0, 0.0, 113.0, -293.0, 91.0, 123.0, 172.0, 117.0, -30.0, 149.0, 97.0, 83.0, 137.0, -102.0, -103.0, 128.0, 147.0, 41.0, 141.0, 144.0, 8.0, 67.0, 113.0, 91.0, 169.0, -56.0, 36.0, -26.0, 17.0, 114.0, -40.0, -52.0, 141.0, -82.0, -68.0, 0.0, 176.0, -128.0, 141.0, 200.0, 173.0, 161.0, 111.0, 97.0, 117.0, -136.0, -329.0, 188.0, 105.0, 77.0, -22.0, 149.0, 162.0, 0.0, 46.0, 0.0, 148.0, 126.0, 133.0, -325.0, 109.0, 0.0, -187.0, -2.0, -141.0, 105.0, -57.0, 149.0, 115.0, -28.0, -141.0, 104.0, 165.0, 82.0, 16.0, 30.0, 101.0, 0.0, 155.0, 110.0, 108.0, 140.0, 161.0, 159.0, 50.0, -137.0, -89.0, -135.0, 148.0, 185.0, 98.0, -75.0, -2.0, 58.0, -129.0, -138.0, -173.0, 138.0, 146.0, 136.0, 28.0, 0.0, 100.0, 0.0, 157.0, 49.0, 91.0, 73.0, 123.0, -8.0, 135.0, 137.0, 55.0, 59.0, 163.0, 133.0, 60.0, -2.0, 0.0, 149.0, 146.0, 0.0, -97.0, 99.0, 155.0, -16.0, 141.0, 170.0, 142.0, -6.0, -22.0, -56.0, 162.0, -324.0, -2.0, 0.0, 137.0, 139.0, 65.0, 128.0, 86.0, 126.0, 163.0, -40.0, 186.0, 171.0, 50.0, 88.0, -2.0, 119.0, 146.0, 177.0], "policy_predator_policy_reward": [0.0, 3.0, 0.0, 0.0, 8.0, 1.0, 0.0, 82.0, 86.0, 70.0, 15.0, 16.0, 115.0, 153.0, 0.0, 0.0, 61.0, 67.0, 125.0, 152.0, 47.0, 0.0, 79.0, 43.0, 32.0, 0.0, 0.0, 34.0, 10.0, 0.0, 3.0, 52.0, 55.0, 42.0, 19.0, 0.0, 164.0, 145.0, 165.0, 129.0, 81.0, 45.0, 2.0, 0.0, 1.0, 4.0, 121.0, 57.0, 16.0, 5.0, 159.0, 100.0, 0.0, 30.0, 0.0, 5.0, 15.0, 13.0, 4.0, 25.0, 15.0, 51.0, 82.0, 81.0, 8.0, 3.0, 0.0, 0.0, 0.0, 78.0, 8.0, 6.0, 24.0, 7.0, 48.0, 32.0, 9.0, 61.0, 85.0, 45.0, 22.0, 35.0, 86.0, 100.0, 102.0, 8.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 112.0, 33.0, 145.0, 139.0, 0.0, 0.0, 0.0, 11.0, 4.0, 0.0, 0.0, 0.0, 8.0, 12.0, 140.0, 160.0, 0.0, 0.0, 96.0, 98.0, 85.0, 103.0, 0.0, 80.0, 37.0, 40.0, 100.0, 64.0, 8.0, 0.0, 39.0, 60.0, 0.0, 0.0, 11.0, 13.0, 9.0, 0.0, 0.0, 0.0, 68.0, 61.0, 124.0, 104.0, 0.0, 0.0, 70.0, 43.0, 26.0, 48.0, 147.0, 131.0, 107.0, 71.0, 0.0, 0.0, 1.0, 28.0, 0.0, 0.0, 17.0, 17.0, 0.0, 0.0, 14.0, 4.0, 0.0, 0.0, 17.0, 17.0, 5.0, 8.0, 25.0, 23.0, 0.0, 0.0, 8.0, 0.0, 96.0, 104.0, 8.0, 2.0, 0.0, 0.0, 0.0, 3.0, 28.0, 32.0, 118.0, 163.0, 0.0, 1.0, 0.0, 0.0, 38.0, 0.0, 0.0, 19.0, 20.0, 17.0, 0.0, 0.0, 72.0, 18.0, 1.0, 1.0, 0.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.243317676830646, "mean_inference_ms": 31.03662655348837, "mean_action_processing_ms": 0.728130067651536, "mean_env_wait_ms": 4.910366920546735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006980180740356445, "StateBufferConnector_ms": 0.006344795227050781, "ViewRequirementAgentConnector_ms": 0.2681159973144531}, "num_episodes": 18, "episode_return_max": 357.0, "episode_return_min": -190.0, "episode_return_mean": 165.28, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 192.06616781469478, "num_env_steps_trained_throughput_per_sec": 192.06616781469478, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 50034.839, "restore_workers_time_ms": 0.08, "training_step_time_ms": 50034.432, "sample_time_ms": 3588.263, "learn_time_ms": 46397.402, "learn_throughput": 86.212, "synch_weights_time_ms": 38.947}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "45bed_00000", "date": "2024-08-13_02-42-49", "timestamp": 1723531369, "time_this_iter_s": 20.877382040023804, "time_total_s": 5556.3055057525635, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4463f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5556.3055057525635, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 85.50344827586208, "ram_util_percent": 83.16896551724136}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8743225305089874, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9971777997950397, "policy_loss": -0.0022453864851582146, "vf_loss": 3.999422812335706, "vf_explained_var": -0.00029500946796760357, "kl": 0.007401410732632033, "entropy": 0.7304462097624622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.866749639359732, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.934986776775784, "policy_loss": -0.0013238781544493226, "vf_loss": 6.936310662415924, "vf_explained_var": 0.2743137409447362, "kl": 0.004264140458895546, "entropy": 1.0260988893016936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 357.0, "episode_reward_min": -134.0, "episode_reward_mean": 167.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -393.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 180.0}, "policy_reward_mean": {"prey_policy": 46.22, "predator_policy": 37.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.0, 54.0, 75.0, 196.0, 201.0, -68.0, 50.0, 79.0, 244.0, 294.0, 147.0, 209.0, 101.0, 188.0, 199.0, 285.0, 153.0, 218.0, 144.0, 90.0, 201.0, 38.0, 116.0, 118.0, 158.0, 341.0, 334.0, 225.0, 126.0, 143.0, 182.0, 138.0, 166.0, 46.0, 294.0, 108.0, 109.0, 5.0, 152.0, 172.0, 164.0, 127.0, 255.0, 145.0, 101.0, 289.0, 257.0, 320.0, 42.0, 4.0, 333.0, 136.0, 130.0, 11.0, 143.0, 282.0, 57.0, 100.0, 240.0, 164.0, 133.0, 272.0, 148.0, 309.0, 106.0, 149.0, 154.0, 202.0, 149.0, 311.0, 139.0, -18.0, 119.0, -1.0, 276.0, 231.0, 231.0, 160.0, 357.0, 228.0, 119.0, 325.0, 217.0, 333.0, 131.0, 314.0, 154.0, 93.0, 131.0, 343.0, 337.0, 118.0, 317.0, 333.0, 293.0, -134.0, 248.0, -85.0, 175.0, -78.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [81.0, -311.0, -134.0, -106.0, 58.0, -109.0, 194.0, 0.0, 19.0, 177.0, -198.0, -48.0, 29.0, 0.0, 113.0, -293.0, 91.0, 123.0, 172.0, 117.0, -30.0, 149.0, 97.0, 83.0, 137.0, -102.0, -103.0, 128.0, 147.0, 41.0, 141.0, 144.0, 8.0, 67.0, 113.0, 91.0, 169.0, -56.0, 36.0, -26.0, 17.0, 114.0, -40.0, -52.0, 141.0, -82.0, -68.0, 0.0, 176.0, -128.0, 141.0, 200.0, 173.0, 161.0, 111.0, 97.0, 117.0, -136.0, -329.0, 188.0, 105.0, 77.0, -22.0, 149.0, 162.0, 0.0, 46.0, 0.0, 148.0, 126.0, 133.0, -325.0, 109.0, 0.0, -187.0, -2.0, -141.0, 105.0, -57.0, 149.0, 115.0, -28.0, -141.0, 104.0, 165.0, 82.0, 16.0, 30.0, 101.0, 0.0, 155.0, 110.0, 108.0, 140.0, 161.0, 159.0, 50.0, -137.0, -89.0, -135.0, 148.0, 185.0, 98.0, -75.0, -2.0, 58.0, -129.0, -138.0, -173.0, 138.0, 146.0, 136.0, 28.0, 0.0, 100.0, 0.0, 157.0, 49.0, 91.0, 73.0, 123.0, -8.0, 135.0, 137.0, 55.0, 59.0, 163.0, 133.0, 60.0, -2.0, 0.0, 149.0, 146.0, 0.0, -97.0, 99.0, 155.0, -16.0, 141.0, 170.0, 142.0, -6.0, -22.0, -56.0, 162.0, -324.0, -2.0, 0.0, 137.0, 139.0, 65.0, 128.0, 86.0, 126.0, 163.0, -40.0, 186.0, 171.0, 50.0, 88.0, -2.0, 119.0, 146.0, 177.0, 151.0, 24.0, 174.0, 153.0, 138.0, -134.0, 164.0, 113.0, 0.0, 150.0, 0.0, -22.0, 168.0, -292.0, 136.0, 184.0, 100.0, 195.0, 200.0, -225.0, 160.0, 151.0, 144.0, 187.0, 113.0, 131.0, -84.0, -293.0, -19.0, 139.0, -2.0, -393.0, 0.0, 168.0, -201.0, -10.0], "policy_predator_policy_reward": [164.0, 145.0, 165.0, 129.0, 81.0, 45.0, 2.0, 0.0, 1.0, 4.0, 121.0, 57.0, 16.0, 5.0, 159.0, 100.0, 0.0, 30.0, 0.0, 5.0, 15.0, 13.0, 4.0, 25.0, 15.0, 51.0, 82.0, 81.0, 8.0, 3.0, 0.0, 0.0, 0.0, 78.0, 8.0, 6.0, 24.0, 7.0, 48.0, 32.0, 9.0, 61.0, 85.0, 45.0, 22.0, 35.0, 86.0, 100.0, 102.0, 8.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 112.0, 33.0, 145.0, 139.0, 0.0, 0.0, 0.0, 11.0, 4.0, 0.0, 0.0, 0.0, 8.0, 12.0, 140.0, 160.0, 0.0, 0.0, 96.0, 98.0, 85.0, 103.0, 0.0, 80.0, 37.0, 40.0, 100.0, 64.0, 8.0, 0.0, 39.0, 60.0, 0.0, 0.0, 11.0, 13.0, 9.0, 0.0, 0.0, 0.0, 68.0, 61.0, 124.0, 104.0, 0.0, 0.0, 70.0, 43.0, 26.0, 48.0, 147.0, 131.0, 107.0, 71.0, 0.0, 0.0, 1.0, 28.0, 0.0, 0.0, 17.0, 17.0, 0.0, 0.0, 14.0, 4.0, 0.0, 0.0, 17.0, 17.0, 5.0, 8.0, 25.0, 23.0, 0.0, 0.0, 8.0, 0.0, 96.0, 104.0, 8.0, 2.0, 0.0, 0.0, 0.0, 3.0, 28.0, 32.0, 118.0, 163.0, 0.0, 1.0, 0.0, 0.0, 38.0, 0.0, 0.0, 19.0, 20.0, 17.0, 0.0, 0.0, 72.0, 18.0, 1.0, 1.0, 0.0, 2.0, 42.0, 0.0, 0.0, 6.0, 67.0, 60.0, 25.0, 12.0, 4.0, 0.0, 67.0, 48.0, 126.0, 129.0, 5.0, 18.0, 26.0, 16.0, 28.0, 115.0, 2.0, 4.0, 2.0, 0.0, 17.0, 32.0, 142.0, 101.0, 55.0, 73.0, 180.0, 130.0, 7.0, 0.0, 131.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.108163606135097, "mean_inference_ms": 30.620898994201056, "mean_action_processing_ms": 0.7249893048395367, "mean_env_wait_ms": 4.842825971750493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007090926170349121, "StateBufferConnector_ms": 0.008873820304870605, "ViewRequirementAgentConnector_ms": 0.25951075553894043}, "num_episodes": 18, "episode_return_max": 357.0, "episode_return_min": -134.0, "episode_return_mean": 167.49, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 181.74382564256777, "num_env_steps_trained_throughput_per_sec": 181.74382564256777, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 20167.701, "restore_workers_time_ms": 0.081, "training_step_time_ms": 20167.293, "sample_time_ms": 3582.75, "learn_time_ms": 16535.464, "learn_throughput": 241.904, "synch_weights_time_ms": 39.014}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "45bed_00000", "date": "2024-08-13_02-43-11", "timestamp": 1723531391, "time_this_iter_s": 22.065836906433105, "time_total_s": 5578.371342658997, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3306bdee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5578.371342658997, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 86.82580645161292, "ram_util_percent": 83.45483870967743}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8008778591950735, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.783911088723985, "policy_loss": -0.004134120855101005, "vf_loss": 2.7880447395894894, "vf_explained_var": -0.000681703525876242, "kl": 0.009542868357704298, "entropy": 0.7407213852203712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.301076404505938, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.722552558606264, "policy_loss": -0.0030688791785872093, "vf_loss": 6.725621437900281, "vf_explained_var": 0.24303148423553145, "kl": 0.0073049502188480605, "entropy": 1.1461411156351604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 376.0, "episode_reward_min": -228.0, "episode_reward_mean": 180.92, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -393.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": 54.49, "predator_policy": 35.97}, "custom_metrics": {}, "hist_stats": {"episode_reward": [116.0, 118.0, 158.0, 341.0, 334.0, 225.0, 126.0, 143.0, 182.0, 138.0, 166.0, 46.0, 294.0, 108.0, 109.0, 5.0, 152.0, 172.0, 164.0, 127.0, 255.0, 145.0, 101.0, 289.0, 257.0, 320.0, 42.0, 4.0, 333.0, 136.0, 130.0, 11.0, 143.0, 282.0, 57.0, 100.0, 240.0, 164.0, 133.0, 272.0, 148.0, 309.0, 106.0, 149.0, 154.0, 202.0, 149.0, 311.0, 139.0, -18.0, 119.0, -1.0, 276.0, 231.0, 231.0, 160.0, 357.0, 228.0, 119.0, 325.0, 217.0, 333.0, 131.0, 314.0, 154.0, 93.0, 131.0, 343.0, 337.0, 118.0, 317.0, 333.0, 293.0, -134.0, 248.0, -85.0, 175.0, -78.0, 321.0, 142.0, 194.0, -71.0, 372.0, 125.0, 375.0, 145.0, -38.0, 160.0, 376.0, 326.0, -228.0, 304.0, 375.0, 277.0, 153.0, 126.0, 284.0, 162.0, 352.0, 288.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [141.0, -82.0, -68.0, 0.0, 176.0, -128.0, 141.0, 200.0, 173.0, 161.0, 111.0, 97.0, 117.0, -136.0, -329.0, 188.0, 105.0, 77.0, -22.0, 149.0, 162.0, 0.0, 46.0, 0.0, 148.0, 126.0, 133.0, -325.0, 109.0, 0.0, -187.0, -2.0, -141.0, 105.0, -57.0, 149.0, 115.0, -28.0, -141.0, 104.0, 165.0, 82.0, 16.0, 30.0, 101.0, 0.0, 155.0, 110.0, 108.0, 140.0, 161.0, 159.0, 50.0, -137.0, -89.0, -135.0, 148.0, 185.0, 98.0, -75.0, -2.0, 58.0, -129.0, -138.0, -173.0, 138.0, 146.0, 136.0, 28.0, 0.0, 100.0, 0.0, 157.0, 49.0, 91.0, 73.0, 123.0, -8.0, 135.0, 137.0, 55.0, 59.0, 163.0, 133.0, 60.0, -2.0, 0.0, 149.0, 146.0, 0.0, -97.0, 99.0, 155.0, -16.0, 141.0, 170.0, 142.0, -6.0, -22.0, -56.0, 162.0, -324.0, -2.0, 0.0, 137.0, 139.0, 65.0, 128.0, 86.0, 126.0, 163.0, -40.0, 186.0, 171.0, 50.0, 88.0, -2.0, 119.0, 146.0, 177.0, 151.0, 24.0, 174.0, 153.0, 138.0, -134.0, 164.0, 113.0, 0.0, 150.0, 0.0, -22.0, 168.0, -292.0, 136.0, 184.0, 100.0, 195.0, 200.0, -225.0, 160.0, 151.0, 144.0, 187.0, 113.0, 131.0, -84.0, -293.0, -19.0, 139.0, -2.0, -393.0, 0.0, 168.0, -201.0, -10.0, 158.0, 140.0, -78.0, 166.0, 194.0, 0.0, -194.0, -102.0, 187.0, 185.0, -94.0, 170.0, 167.0, 200.0, -131.0, 54.0, 0.0, -375.0, 0.0, 160.0, 193.0, 183.0, 138.0, 175.0, -298.0, -193.0, 161.0, 117.0, 190.0, 185.0, 130.0, 112.0, 172.0, -38.0, -285.0, 162.0, 50.0, 184.0, -24.0, 174.0, 188.0, 149.0, 112.0, 158.0], "policy_predator_policy_reward": [22.0, 35.0, 86.0, 100.0, 102.0, 8.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 112.0, 33.0, 145.0, 139.0, 0.0, 0.0, 0.0, 11.0, 4.0, 0.0, 0.0, 0.0, 8.0, 12.0, 140.0, 160.0, 0.0, 0.0, 96.0, 98.0, 85.0, 103.0, 0.0, 80.0, 37.0, 40.0, 100.0, 64.0, 8.0, 0.0, 39.0, 60.0, 0.0, 0.0, 11.0, 13.0, 9.0, 0.0, 0.0, 0.0, 68.0, 61.0, 124.0, 104.0, 0.0, 0.0, 70.0, 43.0, 26.0, 48.0, 147.0, 131.0, 107.0, 71.0, 0.0, 0.0, 1.0, 28.0, 0.0, 0.0, 17.0, 17.0, 0.0, 0.0, 14.0, 4.0, 0.0, 0.0, 17.0, 17.0, 5.0, 8.0, 25.0, 23.0, 0.0, 0.0, 8.0, 0.0, 96.0, 104.0, 8.0, 2.0, 0.0, 0.0, 0.0, 3.0, 28.0, 32.0, 118.0, 163.0, 0.0, 1.0, 0.0, 0.0, 38.0, 0.0, 0.0, 19.0, 20.0, 17.0, 0.0, 0.0, 72.0, 18.0, 1.0, 1.0, 0.0, 2.0, 42.0, 0.0, 0.0, 6.0, 67.0, 60.0, 25.0, 12.0, 4.0, 0.0, 67.0, 48.0, 126.0, 129.0, 5.0, 18.0, 26.0, 16.0, 28.0, 115.0, 2.0, 4.0, 2.0, 0.0, 17.0, 32.0, 142.0, 101.0, 55.0, 73.0, 180.0, 130.0, 7.0, 0.0, 131.0, 2.0, 23.0, 0.0, 16.0, 38.0, 0.0, 0.0, 93.0, 132.0, 0.0, 0.0, 47.0, 2.0, 5.0, 3.0, 108.0, 114.0, 188.0, 149.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 115.0, 148.0, 5.0, 21.0, 0.0, 0.0, 0.0, 35.0, 0.0, 19.0, 160.0, 89.0, 0.0, 50.0, 12.0, 0.0, 4.0, 11.0, 18.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.977591140929606, "mean_inference_ms": 30.1207343381182, "mean_action_processing_ms": 0.7215472012558354, "mean_env_wait_ms": 4.745405434462562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007462501525878906, "StateBufferConnector_ms": 0.009246826171875, "ViewRequirementAgentConnector_ms": 0.22092962265014648}, "num_episodes": 22, "episode_return_max": 376.0, "episode_return_min": -228.0, "episode_return_mean": 180.92, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 179.0036891975177, "num_env_steps_trained_throughput_per_sec": 179.0036891975177, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 19617.801, "restore_workers_time_ms": 0.017, "training_step_time_ms": 19617.608, "sample_time_ms": 2785.412, "learn_time_ms": 16781.584, "learn_throughput": 238.357, "synch_weights_time_ms": 40.497}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "45bed_00000", "date": "2024-08-13_02-43-34", "timestamp": 1723531414, "time_this_iter_s": 22.438751935958862, "time_total_s": 5600.810094594955, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x330751a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5600.810094594955, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 86.296875, "ram_util_percent": 83.34375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.88178443722624, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8844126582145693, "policy_loss": -0.002556157130846586, "vf_loss": 2.8869685335764808, "vf_explained_var": 0.0012812133503969385, "kl": 0.005946338782742792, "entropy": 0.7504096477120011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.717943238802057, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.6986546185912275, "policy_loss": -0.0019238373875696824, "vf_loss": 7.700578447876784, "vf_explained_var": 0.2555266868185114, "kl": 0.009297967505965494, "entropy": 1.0628071613728054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 376.0, "episode_reward_min": -228.0, "episode_reward_mean": 194.65, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -393.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": 65.455, "predator_policy": 31.87}, "custom_metrics": {}, "hist_stats": {"episode_reward": [289.0, 257.0, 320.0, 42.0, 4.0, 333.0, 136.0, 130.0, 11.0, 143.0, 282.0, 57.0, 100.0, 240.0, 164.0, 133.0, 272.0, 148.0, 309.0, 106.0, 149.0, 154.0, 202.0, 149.0, 311.0, 139.0, -18.0, 119.0, -1.0, 276.0, 231.0, 231.0, 160.0, 357.0, 228.0, 119.0, 325.0, 217.0, 333.0, 131.0, 314.0, 154.0, 93.0, 131.0, 343.0, 337.0, 118.0, 317.0, 333.0, 293.0, -134.0, 248.0, -85.0, 175.0, -78.0, 321.0, 142.0, 194.0, -71.0, 372.0, 125.0, 375.0, 145.0, -38.0, 160.0, 376.0, 326.0, -228.0, 304.0, 375.0, 277.0, 153.0, 126.0, 284.0, 162.0, 352.0, 288.0, 175.0, 298.0, 296.0, 64.0, -3.0, 315.0, 167.0, 117.0, 301.0, 287.0, 176.0, 173.0, 84.0, 355.0, 171.0, 196.0, 325.0, 147.0, 336.0, 281.0, 225.0, 261.0, 351.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [155.0, 110.0, 108.0, 140.0, 161.0, 159.0, 50.0, -137.0, -89.0, -135.0, 148.0, 185.0, 98.0, -75.0, -2.0, 58.0, -129.0, -138.0, -173.0, 138.0, 146.0, 136.0, 28.0, 0.0, 100.0, 0.0, 157.0, 49.0, 91.0, 73.0, 123.0, -8.0, 135.0, 137.0, 55.0, 59.0, 163.0, 133.0, 60.0, -2.0, 0.0, 149.0, 146.0, 0.0, -97.0, 99.0, 155.0, -16.0, 141.0, 170.0, 142.0, -6.0, -22.0, -56.0, 162.0, -324.0, -2.0, 0.0, 137.0, 139.0, 65.0, 128.0, 86.0, 126.0, 163.0, -40.0, 186.0, 171.0, 50.0, 88.0, -2.0, 119.0, 146.0, 177.0, 151.0, 24.0, 174.0, 153.0, 138.0, -134.0, 164.0, 113.0, 0.0, 150.0, 0.0, -22.0, 168.0, -292.0, 136.0, 184.0, 100.0, 195.0, 200.0, -225.0, 160.0, 151.0, 144.0, 187.0, 113.0, 131.0, -84.0, -293.0, -19.0, 139.0, -2.0, -393.0, 0.0, 168.0, -201.0, -10.0, 158.0, 140.0, -78.0, 166.0, 194.0, 0.0, -194.0, -102.0, 187.0, 185.0, -94.0, 170.0, 167.0, 200.0, -131.0, 54.0, 0.0, -375.0, 0.0, 160.0, 193.0, 183.0, 138.0, 175.0, -298.0, -193.0, 161.0, 117.0, 190.0, 185.0, 130.0, 112.0, 172.0, -38.0, -285.0, 162.0, 50.0, 184.0, -24.0, 174.0, 188.0, 149.0, 112.0, 158.0, 0.0, 163.0, 181.0, 117.0, 145.0, 150.0, 57.0, -246.0, -8.0, -4.0, 171.0, 138.0, 0.0, 154.0, 128.0, -217.0, 142.0, 159.0, 93.0, 170.0, 42.0, 115.0, 107.0, -135.0, -219.0, 105.0, 176.0, 177.0, 0.0, 171.0, 173.0, -61.0, 157.0, 156.0, -2.0, 132.0, 158.0, 175.0, 168.0, 78.0, 86.0, 110.0, 92.0, 169.0, 166.0, 185.0], "policy_predator_policy_reward": [11.0, 13.0, 9.0, 0.0, 0.0, 0.0, 68.0, 61.0, 124.0, 104.0, 0.0, 0.0, 70.0, 43.0, 26.0, 48.0, 147.0, 131.0, 107.0, 71.0, 0.0, 0.0, 1.0, 28.0, 0.0, 0.0, 17.0, 17.0, 0.0, 0.0, 14.0, 4.0, 0.0, 0.0, 17.0, 17.0, 5.0, 8.0, 25.0, 23.0, 0.0, 0.0, 8.0, 0.0, 96.0, 104.0, 8.0, 2.0, 0.0, 0.0, 0.0, 3.0, 28.0, 32.0, 118.0, 163.0, 0.0, 1.0, 0.0, 0.0, 38.0, 0.0, 0.0, 19.0, 20.0, 17.0, 0.0, 0.0, 72.0, 18.0, 1.0, 1.0, 0.0, 2.0, 42.0, 0.0, 0.0, 6.0, 67.0, 60.0, 25.0, 12.0, 4.0, 0.0, 67.0, 48.0, 126.0, 129.0, 5.0, 18.0, 26.0, 16.0, 28.0, 115.0, 2.0, 4.0, 2.0, 0.0, 17.0, 32.0, 142.0, 101.0, 55.0, 73.0, 180.0, 130.0, 7.0, 0.0, 131.0, 2.0, 23.0, 0.0, 16.0, 38.0, 0.0, 0.0, 93.0, 132.0, 0.0, 0.0, 47.0, 2.0, 5.0, 3.0, 108.0, 114.0, 188.0, 149.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 115.0, 148.0, 5.0, 21.0, 0.0, 0.0, 0.0, 35.0, 0.0, 19.0, 160.0, 89.0, 0.0, 50.0, 12.0, 0.0, 4.0, 11.0, 18.0, 0.0, 12.0, 0.0, 0.0, 0.0, 1.0, 0.0, 127.0, 126.0, 6.0, 3.0, 6.0, 0.0, 2.0, 11.0, 94.0, 112.0, 0.0, 0.0, 16.0, 8.0, 19.0, 0.0, 113.0, 88.0, 89.0, 109.0, 0.0, 2.0, 0.0, 0.0, 46.0, 38.0, 0.0, 12.0, 11.0, 6.0, 2.0, 1.0, 18.0, 17.0, 21.0, 8.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.581778451016543, "mean_inference_ms": 28.88131567464656, "mean_action_processing_ms": 0.7265931893805758, "mean_env_wait_ms": 4.686427311523125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01061713695526123, "StateBufferConnector_ms": 0.009332060813903809, "ViewRequirementAgentConnector_ms": 0.2721223831176758}, "num_episodes": 23, "episode_return_max": 376.0, "episode_return_min": -228.0, "episode_return_mean": 194.65, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.96244272605261, "num_env_steps_trained_throughput_per_sec": 157.96244272605261, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 20441.325, "restore_workers_time_ms": 0.02, "training_step_time_ms": 20441.128, "sample_time_ms": 2948.155, "learn_time_ms": 17441.32, "learn_throughput": 229.34, "synch_weights_time_ms": 41.307}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "45bed_00000", "date": "2024-08-13_02-43-59", "timestamp": 1723531439, "time_this_iter_s": 25.371503114700317, "time_total_s": 5626.181597709656, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x330751040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5626.181597709656, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 87.90000000000002, "ram_util_percent": 83.29722222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9012584293960895, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8641065586180914, "policy_loss": -0.0028717347061034864, "vf_loss": 3.866977899352079, "vf_explained_var": 1.0947764865935796e-05, "kl": 0.007929102262338773, "entropy": 0.6679475255428798, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.9486127818703, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.3610880493487, "policy_loss": -0.0021768023843862236, "vf_loss": 7.363264865723867, "vf_explained_var": 0.13858788145913017, "kl": 0.005362293321328965, "entropy": 1.1469418505512217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 376.0, "episode_reward_min": -228.0, "episode_reward_mean": 190.55, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -393.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": 60.83, "predator_policy": 34.445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [309.0, 106.0, 149.0, 154.0, 202.0, 149.0, 311.0, 139.0, -18.0, 119.0, -1.0, 276.0, 231.0, 231.0, 160.0, 357.0, 228.0, 119.0, 325.0, 217.0, 333.0, 131.0, 314.0, 154.0, 93.0, 131.0, 343.0, 337.0, 118.0, 317.0, 333.0, 293.0, -134.0, 248.0, -85.0, 175.0, -78.0, 321.0, 142.0, 194.0, -71.0, 372.0, 125.0, 375.0, 145.0, -38.0, 160.0, 376.0, 326.0, -228.0, 304.0, 375.0, 277.0, 153.0, 126.0, 284.0, 162.0, 352.0, 288.0, 175.0, 298.0, 296.0, 64.0, -3.0, 315.0, 167.0, 117.0, 301.0, 287.0, 176.0, 173.0, 84.0, 355.0, 171.0, 196.0, 325.0, 147.0, 336.0, 281.0, 225.0, 261.0, 351.0, 181.0, 35.0, 164.0, -1.0, 335.0, 141.0, 361.0, 67.0, 235.0, 106.0, 113.0, 341.0, -88.0, 273.0, 259.0, 39.0, -24.0, 114.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [163.0, 133.0, 60.0, -2.0, 0.0, 149.0, 146.0, 0.0, -97.0, 99.0, 155.0, -16.0, 141.0, 170.0, 142.0, -6.0, -22.0, -56.0, 162.0, -324.0, -2.0, 0.0, 137.0, 139.0, 65.0, 128.0, 86.0, 126.0, 163.0, -40.0, 186.0, 171.0, 50.0, 88.0, -2.0, 119.0, 146.0, 177.0, 151.0, 24.0, 174.0, 153.0, 138.0, -134.0, 164.0, 113.0, 0.0, 150.0, 0.0, -22.0, 168.0, -292.0, 136.0, 184.0, 100.0, 195.0, 200.0, -225.0, 160.0, 151.0, 144.0, 187.0, 113.0, 131.0, -84.0, -293.0, -19.0, 139.0, -2.0, -393.0, 0.0, 168.0, -201.0, -10.0, 158.0, 140.0, -78.0, 166.0, 194.0, 0.0, -194.0, -102.0, 187.0, 185.0, -94.0, 170.0, 167.0, 200.0, -131.0, 54.0, 0.0, -375.0, 0.0, 160.0, 193.0, 183.0, 138.0, 175.0, -298.0, -193.0, 161.0, 117.0, 190.0, 185.0, 130.0, 112.0, 172.0, -38.0, -285.0, 162.0, 50.0, 184.0, -24.0, 174.0, 188.0, 149.0, 112.0, 158.0, 0.0, 163.0, 181.0, 117.0, 145.0, 150.0, 57.0, -246.0, -8.0, -4.0, 171.0, 138.0, 0.0, 154.0, 128.0, -217.0, 142.0, 159.0, 93.0, 170.0, 42.0, 115.0, 107.0, -135.0, -219.0, 105.0, 176.0, 177.0, 0.0, 171.0, 173.0, -61.0, 157.0, 156.0, -2.0, 132.0, 158.0, 175.0, 168.0, 78.0, 86.0, 110.0, 92.0, 169.0, 166.0, 185.0, -2.0, 182.0, -208.0, 117.0, -163.0, 165.0, 0.0, -2.0, 188.0, 141.0, 141.0, 0.0, 180.0, 176.0, 0.0, 39.0, 11.0, 167.0, 151.0, -310.0, -112.0, 169.0, 149.0, 188.0, -73.0, -387.0, 73.0, 200.0, 91.0, 168.0, 155.0, -339.0, -329.0, -16.0, 96.0, -18.0], "policy_predator_policy_reward": [5.0, 8.0, 25.0, 23.0, 0.0, 0.0, 8.0, 0.0, 96.0, 104.0, 8.0, 2.0, 0.0, 0.0, 0.0, 3.0, 28.0, 32.0, 118.0, 163.0, 0.0, 1.0, 0.0, 0.0, 38.0, 0.0, 0.0, 19.0, 20.0, 17.0, 0.0, 0.0, 72.0, 18.0, 1.0, 1.0, 0.0, 2.0, 42.0, 0.0, 0.0, 6.0, 67.0, 60.0, 25.0, 12.0, 4.0, 0.0, 67.0, 48.0, 126.0, 129.0, 5.0, 18.0, 26.0, 16.0, 28.0, 115.0, 2.0, 4.0, 2.0, 0.0, 17.0, 32.0, 142.0, 101.0, 55.0, 73.0, 180.0, 130.0, 7.0, 0.0, 131.0, 2.0, 23.0, 0.0, 16.0, 38.0, 0.0, 0.0, 93.0, 132.0, 0.0, 0.0, 47.0, 2.0, 5.0, 3.0, 108.0, 114.0, 188.0, 149.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 115.0, 148.0, 5.0, 21.0, 0.0, 0.0, 0.0, 35.0, 0.0, 19.0, 160.0, 89.0, 0.0, 50.0, 12.0, 0.0, 4.0, 11.0, 18.0, 0.0, 12.0, 0.0, 0.0, 0.0, 1.0, 0.0, 127.0, 126.0, 6.0, 3.0, 6.0, 0.0, 2.0, 11.0, 94.0, 112.0, 0.0, 0.0, 16.0, 8.0, 19.0, 0.0, 113.0, 88.0, 89.0, 109.0, 0.0, 2.0, 0.0, 0.0, 46.0, 38.0, 0.0, 12.0, 11.0, 6.0, 2.0, 1.0, 18.0, 17.0, 21.0, 8.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 23.0, 103.0, 48.0, 114.0, 0.0, 1.0, 6.0, 0.0, 0.0, 0.0, 1.0, 4.0, 26.0, 2.0, 51.0, 6.0, 107.0, 158.0, 56.0, 0.0, 2.0, 2.0, 192.0, 180.0, 0.0, 0.0, 0.0, 0.0, 55.0, 168.0, 170.0, 151.0, 7.0, 29.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.689565400939351, "mean_inference_ms": 29.307435054238418, "mean_action_processing_ms": 0.7195692679383688, "mean_env_wait_ms": 4.62473697934199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010171651840209961, "StateBufferConnector_ms": 0.009537935256958008, "ViewRequirementAgentConnector_ms": 0.3142799139022827}, "num_episodes": 18, "episode_return_max": 376.0, "episode_return_min": -228.0, "episode_return_mean": 190.55, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.93467005073128, "num_env_steps_trained_throughput_per_sec": 150.93467005073128, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 21361.496, "restore_workers_time_ms": 0.02, "training_step_time_ms": 21361.299, "sample_time_ms": 3225.852, "learn_time_ms": 18075.084, "learn_throughput": 221.299, "synch_weights_time_ms": 50.808}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "45bed_00000", "date": "2024-08-13_02-44-26", "timestamp": 1723531466, "time_this_iter_s": 26.5250301361084, "time_total_s": 5652.706627845764, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4449dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5652.706627845764, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 87.91351351351351, "ram_util_percent": 83.2918918918919}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9082352385161415, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.001443453377517, "policy_loss": -0.0010644677072940837, "vf_loss": 3.0025077057893945, "vf_explained_var": 0.0007402565428819606, "kl": 0.004422384133052897, "entropy": 0.623070560592823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.56579367994632, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.692745721907842, "policy_loss": -0.0076801302767649455, "vf_loss": 7.700425869573361, "vf_explained_var": 0.48793977792300874, "kl": 0.008815243978404212, "entropy": 1.1536424336610016, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 376.0, "episode_reward_min": -228.0, "episode_reward_mean": 192.53, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -393.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": 61.655, "predator_policy": 34.61}, "custom_metrics": {}, "hist_stats": {"episode_reward": [325.0, 217.0, 333.0, 131.0, 314.0, 154.0, 93.0, 131.0, 343.0, 337.0, 118.0, 317.0, 333.0, 293.0, -134.0, 248.0, -85.0, 175.0, -78.0, 321.0, 142.0, 194.0, -71.0, 372.0, 125.0, 375.0, 145.0, -38.0, 160.0, 376.0, 326.0, -228.0, 304.0, 375.0, 277.0, 153.0, 126.0, 284.0, 162.0, 352.0, 288.0, 175.0, 298.0, 296.0, 64.0, -3.0, 315.0, 167.0, 117.0, 301.0, 287.0, 176.0, 173.0, 84.0, 355.0, 171.0, 196.0, 325.0, 147.0, 336.0, 281.0, 225.0, 261.0, 351.0, 181.0, 35.0, 164.0, -1.0, 335.0, 141.0, 361.0, 67.0, 235.0, 106.0, 113.0, 341.0, -88.0, 273.0, 259.0, 39.0, -24.0, 114.0, 180.0, 279.0, 192.0, 209.0, 240.0, 103.0, 305.0, 7.0, 228.0, 163.0, 174.0, 108.0, 220.0, 81.0, 287.0, 283.0, 272.0, 88.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [146.0, 177.0, 151.0, 24.0, 174.0, 153.0, 138.0, -134.0, 164.0, 113.0, 0.0, 150.0, 0.0, -22.0, 168.0, -292.0, 136.0, 184.0, 100.0, 195.0, 200.0, -225.0, 160.0, 151.0, 144.0, 187.0, 113.0, 131.0, -84.0, -293.0, -19.0, 139.0, -2.0, -393.0, 0.0, 168.0, -201.0, -10.0, 158.0, 140.0, -78.0, 166.0, 194.0, 0.0, -194.0, -102.0, 187.0, 185.0, -94.0, 170.0, 167.0, 200.0, -131.0, 54.0, 0.0, -375.0, 0.0, 160.0, 193.0, 183.0, 138.0, 175.0, -298.0, -193.0, 161.0, 117.0, 190.0, 185.0, 130.0, 112.0, 172.0, -38.0, -285.0, 162.0, 50.0, 184.0, -24.0, 174.0, 188.0, 149.0, 112.0, 158.0, 0.0, 163.0, 181.0, 117.0, 145.0, 150.0, 57.0, -246.0, -8.0, -4.0, 171.0, 138.0, 0.0, 154.0, 128.0, -217.0, 142.0, 159.0, 93.0, 170.0, 42.0, 115.0, 107.0, -135.0, -219.0, 105.0, 176.0, 177.0, 0.0, 171.0, 173.0, -61.0, 157.0, 156.0, -2.0, 132.0, 158.0, 175.0, 168.0, 78.0, 86.0, 110.0, 92.0, 169.0, 166.0, 185.0, -2.0, 182.0, -208.0, 117.0, -163.0, 165.0, 0.0, -2.0, 188.0, 141.0, 141.0, 0.0, 180.0, 176.0, 0.0, 39.0, 11.0, 167.0, 151.0, -310.0, -112.0, 169.0, 149.0, 188.0, -73.0, -387.0, 73.0, 200.0, 91.0, 168.0, 155.0, -339.0, -329.0, -16.0, 96.0, -18.0, 176.0, -8.0, 114.0, 151.0, 55.0, 22.0, 61.0, 124.0, 18.0, 161.0, 0.0, 88.0, 117.0, 162.0, -82.0, 0.0, 35.0, 140.0, 127.0, -165.0, 95.0, 59.0, 54.0, -4.0, 139.0, 81.0, -91.0, 97.0, 133.0, 142.0, 134.0, 113.0, 123.0, 135.0, 70.0, 0.0], "policy_predator_policy_reward": [0.0, 2.0, 42.0, 0.0, 0.0, 6.0, 67.0, 60.0, 25.0, 12.0, 4.0, 0.0, 67.0, 48.0, 126.0, 129.0, 5.0, 18.0, 26.0, 16.0, 28.0, 115.0, 2.0, 4.0, 2.0, 0.0, 17.0, 32.0, 142.0, 101.0, 55.0, 73.0, 180.0, 130.0, 7.0, 0.0, 131.0, 2.0, 23.0, 0.0, 16.0, 38.0, 0.0, 0.0, 93.0, 132.0, 0.0, 0.0, 47.0, 2.0, 5.0, 3.0, 108.0, 114.0, 188.0, 149.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 115.0, 148.0, 5.0, 21.0, 0.0, 0.0, 0.0, 35.0, 0.0, 19.0, 160.0, 89.0, 0.0, 50.0, 12.0, 0.0, 4.0, 11.0, 18.0, 0.0, 12.0, 0.0, 0.0, 0.0, 1.0, 0.0, 127.0, 126.0, 6.0, 3.0, 6.0, 0.0, 2.0, 11.0, 94.0, 112.0, 0.0, 0.0, 16.0, 8.0, 19.0, 0.0, 113.0, 88.0, 89.0, 109.0, 0.0, 2.0, 0.0, 0.0, 46.0, 38.0, 0.0, 12.0, 11.0, 6.0, 2.0, 1.0, 18.0, 17.0, 21.0, 8.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 23.0, 103.0, 48.0, 114.0, 0.0, 1.0, 6.0, 0.0, 0.0, 0.0, 1.0, 4.0, 26.0, 2.0, 51.0, 6.0, 107.0, 158.0, 56.0, 0.0, 2.0, 2.0, 192.0, 180.0, 0.0, 0.0, 0.0, 0.0, 55.0, 168.0, 170.0, 151.0, 7.0, 29.0, 4.0, 8.0, 6.0, 8.0, 80.0, 35.0, 7.0, 17.0, 34.0, 27.0, 0.0, 15.0, 26.0, 0.0, 46.0, 43.0, 8.0, 45.0, 87.0, 114.0, 9.0, 11.0, 32.0, 26.0, 0.0, 0.0, 37.0, 38.0, 12.0, 0.0, 19.0, 17.0, 13.0, 1.0, 0.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.580202906094417, "mean_inference_ms": 28.967394139051212, "mean_action_processing_ms": 0.721007320314227, "mean_env_wait_ms": 4.568822942510937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010191798210144043, "StateBufferConnector_ms": 0.009493589401245117, "ViewRequirementAgentConnector_ms": 0.34643566608428955}, "num_episodes": 18, "episode_return_max": 376.0, "episode_return_min": -228.0, "episode_return_mean": 192.53, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.68958279500487, "num_env_steps_trained_throughput_per_sec": 148.68958279500487, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 22346.966, "restore_workers_time_ms": 0.021, "training_step_time_ms": 22346.771, "sample_time_ms": 3488.351, "learn_time_ms": 18820.296, "learn_throughput": 212.537, "synch_weights_time_ms": 33.677}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "45bed_00000", "date": "2024-08-13_02-44-53", "timestamp": 1723531493, "time_this_iter_s": 26.94832181930542, "time_total_s": 5679.65494966507, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x330744160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5679.65494966507, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 87.67631578947368, "ram_util_percent": 83.1157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.924155502998955, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.082131848007283, "policy_loss": -0.002100378272700168, "vf_loss": 4.084232149300752, "vf_explained_var": 0.00012380944357977974, "kl": 0.005459966992358048, "entropy": 0.6605430527023537, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.8082387939332, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.801388278083196, "policy_loss": -0.0020476865775577685, "vf_loss": 6.80343597477706, "vf_explained_var": 0.3853718939597014, "kl": 0.005083474322662731, "entropy": 1.124359149466116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 376.0, "episode_reward_min": -228.0, "episode_reward_mean": 183.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -387.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": 58.48, "predator_policy": 33.19}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-71.0, 372.0, 125.0, 375.0, 145.0, -38.0, 160.0, 376.0, 326.0, -228.0, 304.0, 375.0, 277.0, 153.0, 126.0, 284.0, 162.0, 352.0, 288.0, 175.0, 298.0, 296.0, 64.0, -3.0, 315.0, 167.0, 117.0, 301.0, 287.0, 176.0, 173.0, 84.0, 355.0, 171.0, 196.0, 325.0, 147.0, 336.0, 281.0, 225.0, 261.0, 351.0, 181.0, 35.0, 164.0, -1.0, 335.0, 141.0, 361.0, 67.0, 235.0, 106.0, 113.0, 341.0, -88.0, 273.0, 259.0, 39.0, -24.0, 114.0, 180.0, 279.0, 192.0, 209.0, 240.0, 103.0, 305.0, 7.0, 228.0, 163.0, 174.0, 108.0, 220.0, 81.0, 287.0, 283.0, 272.0, 88.0, 83.0, 324.0, 232.0, 128.0, 173.0, 174.0, 283.0, -57.0, 106.0, 180.0, -51.0, 194.0, 44.0, 159.0, 152.0, 151.0, 58.0, 332.0, 151.0, 327.0, 160.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-194.0, -102.0, 187.0, 185.0, -94.0, 170.0, 167.0, 200.0, -131.0, 54.0, 0.0, -375.0, 0.0, 160.0, 193.0, 183.0, 138.0, 175.0, -298.0, -193.0, 161.0, 117.0, 190.0, 185.0, 130.0, 112.0, 172.0, -38.0, -285.0, 162.0, 50.0, 184.0, -24.0, 174.0, 188.0, 149.0, 112.0, 158.0, 0.0, 163.0, 181.0, 117.0, 145.0, 150.0, 57.0, -246.0, -8.0, -4.0, 171.0, 138.0, 0.0, 154.0, 128.0, -217.0, 142.0, 159.0, 93.0, 170.0, 42.0, 115.0, 107.0, -135.0, -219.0, 105.0, 176.0, 177.0, 0.0, 171.0, 173.0, -61.0, 157.0, 156.0, -2.0, 132.0, 158.0, 175.0, 168.0, 78.0, 86.0, 110.0, 92.0, 169.0, 166.0, 185.0, -2.0, 182.0, -208.0, 117.0, -163.0, 165.0, 0.0, -2.0, 188.0, 141.0, 141.0, 0.0, 180.0, 176.0, 0.0, 39.0, 11.0, 167.0, 151.0, -310.0, -112.0, 169.0, 149.0, 188.0, -73.0, -387.0, 73.0, 200.0, 91.0, 168.0, 155.0, -339.0, -329.0, -16.0, 96.0, -18.0, 176.0, -8.0, 114.0, 151.0, 55.0, 22.0, 61.0, 124.0, 18.0, 161.0, 0.0, 88.0, 117.0, 162.0, -82.0, 0.0, 35.0, 140.0, 127.0, -165.0, 95.0, 59.0, 54.0, -4.0, 139.0, 81.0, -91.0, 97.0, 133.0, 142.0, 134.0, 113.0, 123.0, 135.0, 70.0, 0.0, -45.0, 0.0, 144.0, 178.0, -96.0, 195.0, 100.0, -8.0, 178.0, -216.0, 181.0, -14.0, 148.0, 87.0, -174.0, 0.0, 148.0, -202.0, 126.0, 40.0, -178.0, -40.0, 163.0, -104.0, -2.0, 45.0, 137.0, 1.0, 146.0, 0.0, -68.0, 158.0, -118.0, 111.0, 173.0, 159.0, -166.0, 170.0, 164.0, 155.0, 0.0, 160.0, 0.0, 0.0], "policy_predator_policy_reward": [93.0, 132.0, 0.0, 0.0, 47.0, 2.0, 5.0, 3.0, 108.0, 114.0, 188.0, 149.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 115.0, 148.0, 5.0, 21.0, 0.0, 0.0, 0.0, 35.0, 0.0, 19.0, 160.0, 89.0, 0.0, 50.0, 12.0, 0.0, 4.0, 11.0, 18.0, 0.0, 12.0, 0.0, 0.0, 0.0, 1.0, 0.0, 127.0, 126.0, 6.0, 3.0, 6.0, 0.0, 2.0, 11.0, 94.0, 112.0, 0.0, 0.0, 16.0, 8.0, 19.0, 0.0, 113.0, 88.0, 89.0, 109.0, 0.0, 2.0, 0.0, 0.0, 46.0, 38.0, 0.0, 12.0, 11.0, 6.0, 2.0, 1.0, 18.0, 17.0, 21.0, 8.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 23.0, 103.0, 48.0, 114.0, 0.0, 1.0, 6.0, 0.0, 0.0, 0.0, 1.0, 4.0, 26.0, 2.0, 51.0, 6.0, 107.0, 158.0, 56.0, 0.0, 2.0, 2.0, 192.0, 180.0, 0.0, 0.0, 0.0, 0.0, 55.0, 168.0, 170.0, 151.0, 7.0, 29.0, 4.0, 8.0, 6.0, 8.0, 80.0, 35.0, 7.0, 17.0, 34.0, 27.0, 0.0, 15.0, 26.0, 0.0, 46.0, 43.0, 8.0, 45.0, 87.0, 114.0, 9.0, 11.0, 32.0, 26.0, 0.0, 0.0, 37.0, 38.0, 12.0, 0.0, 19.0, 17.0, 13.0, 1.0, 0.0, 18.0, 63.0, 65.0, 0.0, 2.0, 64.0, 69.0, 24.0, 12.0, 103.0, 108.0, 7.0, 0.0, 21.0, 27.0, 39.0, 78.0, 127.0, 33.0, 0.0, 14.0, 43.0, 124.0, 83.0, 52.0, 0.0, 1.0, 18.0, 3.0, 0.0, 6.0, 28.0, 33.0, 16.0, 49.0, 0.0, 0.0, 64.0, 83.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.476428509730587, "mean_inference_ms": 28.202161647364292, "mean_action_processing_ms": 0.7231474182238239, "mean_env_wait_ms": 4.865098401380128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010813593864440918, "StateBufferConnector_ms": 0.012038230895996094, "ViewRequirementAgentConnector_ms": 0.3983112573623657}, "num_episodes": 22, "episode_return_max": 376.0, "episode_return_min": -228.0, "episode_return_mean": 183.34, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.1830143123794, "num_env_steps_trained_throughput_per_sec": 153.1830143123794, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 23078.914, "restore_workers_time_ms": 0.02, "training_step_time_ms": 23078.719, "sample_time_ms": 3610.576, "learn_time_ms": 19429.509, "learn_throughput": 205.872, "synch_weights_time_ms": 33.663}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "45bed_00000", "date": "2024-08-13_02-45-19", "timestamp": 1723531519, "time_this_iter_s": 26.17500400543213, "time_total_s": 5705.829953670502, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33073f9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5705.829953670502, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 87.14999999999999, "ram_util_percent": 83.51666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9559038052640895, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6032108790029294, "policy_loss": -0.003164540213488397, "vf_loss": 2.6063752489115197, "vf_explained_var": -0.00019921291442144486, "kl": 0.007257369224371818, "entropy": 0.6230980538186572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.36012219531195, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.072341741077484, "policy_loss": -0.000960819772075093, "vf_loss": 6.073302552308986, "vf_explained_var": 0.647759524728886, "kl": 0.007396200870750274, "entropy": 1.0871538029145942, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 361.0, "episode_reward_min": -88.0, "episode_reward_mean": 179.2, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -387.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": 60.98, "predator_policy": 28.62}, "custom_metrics": {}, "hist_stats": {"episode_reward": [288.0, 175.0, 298.0, 296.0, 64.0, -3.0, 315.0, 167.0, 117.0, 301.0, 287.0, 176.0, 173.0, 84.0, 355.0, 171.0, 196.0, 325.0, 147.0, 336.0, 281.0, 225.0, 261.0, 351.0, 181.0, 35.0, 164.0, -1.0, 335.0, 141.0, 361.0, 67.0, 235.0, 106.0, 113.0, 341.0, -88.0, 273.0, 259.0, 39.0, -24.0, 114.0, 180.0, 279.0, 192.0, 209.0, 240.0, 103.0, 305.0, 7.0, 228.0, 163.0, 174.0, 108.0, 220.0, 81.0, 287.0, 283.0, 272.0, 88.0, 83.0, 324.0, 232.0, 128.0, 173.0, 174.0, 283.0, -57.0, 106.0, 180.0, -51.0, 194.0, 44.0, 159.0, 152.0, 151.0, 58.0, 332.0, 151.0, 327.0, 160.0, 0.0, 97.0, 125.0, 300.0, -43.0, 187.0, 337.0, -8.0, 330.0, 84.0, 165.0, 325.0, 329.0, 340.0, 253.0, 182.0, 0.0, 28.0, 130.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [112.0, 158.0, 0.0, 163.0, 181.0, 117.0, 145.0, 150.0, 57.0, -246.0, -8.0, -4.0, 171.0, 138.0, 0.0, 154.0, 128.0, -217.0, 142.0, 159.0, 93.0, 170.0, 42.0, 115.0, 107.0, -135.0, -219.0, 105.0, 176.0, 177.0, 0.0, 171.0, 173.0, -61.0, 157.0, 156.0, -2.0, 132.0, 158.0, 175.0, 168.0, 78.0, 86.0, 110.0, 92.0, 169.0, 166.0, 185.0, -2.0, 182.0, -208.0, 117.0, -163.0, 165.0, 0.0, -2.0, 188.0, 141.0, 141.0, 0.0, 180.0, 176.0, 0.0, 39.0, 11.0, 167.0, 151.0, -310.0, -112.0, 169.0, 149.0, 188.0, -73.0, -387.0, 73.0, 200.0, 91.0, 168.0, 155.0, -339.0, -329.0, -16.0, 96.0, -18.0, 176.0, -8.0, 114.0, 151.0, 55.0, 22.0, 61.0, 124.0, 18.0, 161.0, 0.0, 88.0, 117.0, 162.0, -82.0, 0.0, 35.0, 140.0, 127.0, -165.0, 95.0, 59.0, 54.0, -4.0, 139.0, 81.0, -91.0, 97.0, 133.0, 142.0, 134.0, 113.0, 123.0, 135.0, 70.0, 0.0, -45.0, 0.0, 144.0, 178.0, -96.0, 195.0, 100.0, -8.0, 178.0, -216.0, 181.0, -14.0, 148.0, 87.0, -174.0, 0.0, 148.0, -202.0, 126.0, 40.0, -178.0, -40.0, 163.0, -104.0, -2.0, 45.0, 137.0, 1.0, 146.0, 0.0, -68.0, 158.0, -118.0, 111.0, 173.0, 159.0, -166.0, 170.0, 164.0, 155.0, 0.0, 160.0, 0.0, 0.0, 113.0, -56.0, 0.0, 96.0, 166.0, 134.0, -82.0, -2.0, -59.0, 200.0, 165.0, 172.0, -14.0, -2.0, 163.0, 167.0, 27.0, 0.0, 0.0, 165.0, 197.0, 44.0, 153.0, 159.0, 173.0, 154.0, 143.0, 110.0, 184.0, -4.0, 0.0, 0.0, 96.0, -294.0, 176.0, -92.0], "policy_predator_policy_reward": [18.0, 0.0, 12.0, 0.0, 0.0, 0.0, 1.0, 0.0, 127.0, 126.0, 6.0, 3.0, 6.0, 0.0, 2.0, 11.0, 94.0, 112.0, 0.0, 0.0, 16.0, 8.0, 19.0, 0.0, 113.0, 88.0, 89.0, 109.0, 0.0, 2.0, 0.0, 0.0, 46.0, 38.0, 0.0, 12.0, 11.0, 6.0, 2.0, 1.0, 18.0, 17.0, 21.0, 8.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 23.0, 103.0, 48.0, 114.0, 0.0, 1.0, 6.0, 0.0, 0.0, 0.0, 1.0, 4.0, 26.0, 2.0, 51.0, 6.0, 107.0, 158.0, 56.0, 0.0, 2.0, 2.0, 192.0, 180.0, 0.0, 0.0, 0.0, 0.0, 55.0, 168.0, 170.0, 151.0, 7.0, 29.0, 4.0, 8.0, 6.0, 8.0, 80.0, 35.0, 7.0, 17.0, 34.0, 27.0, 0.0, 15.0, 26.0, 0.0, 46.0, 43.0, 8.0, 45.0, 87.0, 114.0, 9.0, 11.0, 32.0, 26.0, 0.0, 0.0, 37.0, 38.0, 12.0, 0.0, 19.0, 17.0, 13.0, 1.0, 0.0, 18.0, 63.0, 65.0, 0.0, 2.0, 64.0, 69.0, 24.0, 12.0, 103.0, 108.0, 7.0, 0.0, 21.0, 27.0, 39.0, 78.0, 127.0, 33.0, 0.0, 14.0, 43.0, 124.0, 83.0, 52.0, 0.0, 1.0, 18.0, 3.0, 0.0, 6.0, 28.0, 33.0, 16.0, 49.0, 0.0, 0.0, 64.0, 83.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 29.0, 0.0, 0.0, 41.0, 0.0, 32.0, 14.0, 0.0, 0.0, 7.0, 1.0, 0.0, 0.0, 39.0, 18.0, 0.0, 0.0, 44.0, 40.0, 17.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 130.0, 96.0, 35.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.376664379659646, "mean_inference_ms": 28.26201124196408, "mean_action_processing_ms": 0.7250837401536552, "mean_env_wait_ms": 4.440631310729872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010914206504821777, "StateBufferConnector_ms": 0.012048840522766113, "ViewRequirementAgentConnector_ms": 0.3846782445907593}, "num_episodes": 18, "episode_return_max": 361.0, "episode_return_min": -88.0, "episode_return_mean": 179.2, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.92394516588604, "num_env_steps_trained_throughput_per_sec": 159.92394516588604, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 23610.442, "restore_workers_time_ms": 0.02, "training_step_time_ms": 23610.248, "sample_time_ms": 3646.455, "learn_time_ms": 19924.998, "learn_throughput": 200.753, "synch_weights_time_ms": 34.137}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "45bed_00000", "date": "2024-08-13_02-45-44", "timestamp": 1723531544, "time_this_iter_s": 25.064386129379272, "time_total_s": 5730.894339799881, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44631f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5730.894339799881, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 86.25833333333333, "ram_util_percent": 83.26944444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0130065594873732, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.0398616397191605, "policy_loss": -0.002090153176948507, "vf_loss": 4.041951721938199, "vf_explained_var": -0.0007716822876501335, "kl": 0.005102667078574212, "entropy": 0.624818410223754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.1480932195666, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.85509564409811, "policy_loss": -0.0019399535177009447, "vf_loss": 6.85703561293385, "vf_explained_var": 0.21401288972960578, "kl": 0.0036913899145955206, "entropy": 1.1316076838780964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 361.0, "episode_reward_min": -265.0, "episode_reward_mean": 154.08, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -387.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": 44.075, "predator_policy": 32.965}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.0, 181.0, 35.0, 164.0, -1.0, 335.0, 141.0, 361.0, 67.0, 235.0, 106.0, 113.0, 341.0, -88.0, 273.0, 259.0, 39.0, -24.0, 114.0, 180.0, 279.0, 192.0, 209.0, 240.0, 103.0, 305.0, 7.0, 228.0, 163.0, 174.0, 108.0, 220.0, 81.0, 287.0, 283.0, 272.0, 88.0, 83.0, 324.0, 232.0, 128.0, 173.0, 174.0, 283.0, -57.0, 106.0, 180.0, -51.0, 194.0, 44.0, 159.0, 152.0, 151.0, 58.0, 332.0, 151.0, 327.0, 160.0, 0.0, 97.0, 125.0, 300.0, -43.0, 187.0, 337.0, -8.0, 330.0, 84.0, 165.0, 325.0, 329.0, 340.0, 253.0, 182.0, 0.0, 28.0, 130.0, 29.0, 175.0, 236.0, 226.0, 96.0, 44.0, 158.0, 172.0, 326.0, 112.0, 326.0, -86.0, -2.0, 136.0, 178.0, 124.0, -18.0, -58.0, 240.0, -265.0, 299.0, -34.0, 109.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [166.0, 185.0, -2.0, 182.0, -208.0, 117.0, -163.0, 165.0, 0.0, -2.0, 188.0, 141.0, 141.0, 0.0, 180.0, 176.0, 0.0, 39.0, 11.0, 167.0, 151.0, -310.0, -112.0, 169.0, 149.0, 188.0, -73.0, -387.0, 73.0, 200.0, 91.0, 168.0, 155.0, -339.0, -329.0, -16.0, 96.0, -18.0, 176.0, -8.0, 114.0, 151.0, 55.0, 22.0, 61.0, 124.0, 18.0, 161.0, 0.0, 88.0, 117.0, 162.0, -82.0, 0.0, 35.0, 140.0, 127.0, -165.0, 95.0, 59.0, 54.0, -4.0, 139.0, 81.0, -91.0, 97.0, 133.0, 142.0, 134.0, 113.0, 123.0, 135.0, 70.0, 0.0, -45.0, 0.0, 144.0, 178.0, -96.0, 195.0, 100.0, -8.0, 178.0, -216.0, 181.0, -14.0, 148.0, 87.0, -174.0, 0.0, 148.0, -202.0, 126.0, 40.0, -178.0, -40.0, 163.0, -104.0, -2.0, 45.0, 137.0, 1.0, 146.0, 0.0, -68.0, 158.0, -118.0, 111.0, 173.0, 159.0, -166.0, 170.0, 164.0, 155.0, 0.0, 160.0, 0.0, 0.0, 113.0, -56.0, 0.0, 96.0, 166.0, 134.0, -82.0, -2.0, -59.0, 200.0, 165.0, 172.0, -14.0, -2.0, 163.0, 167.0, 27.0, 0.0, 0.0, 165.0, 197.0, 44.0, 153.0, 159.0, 173.0, 154.0, 143.0, 110.0, 184.0, -4.0, 0.0, 0.0, 96.0, -294.0, 176.0, -92.0, 0.0, 16.0, -178.0, 128.0, 146.0, 35.0, 38.0, 126.0, -148.0, 151.0, -58.0, 69.0, 137.0, 0.0, 181.0, -18.0, 115.0, 183.0, -136.0, 167.0, 163.0, 156.0, -94.0, -166.0, -6.0, 0.0, -4.0, 138.0, -171.0, 188.0, 84.0, -33.0, -91.0, -76.0, 0.0, -257.0, 36.0, 140.0, -244.0, -373.0, 174.0, 125.0, -100.0, -104.0, -72.0, 145.0], "policy_predator_policy_reward": [0.0, 0.0, 1.0, 0.0, 23.0, 103.0, 48.0, 114.0, 0.0, 1.0, 6.0, 0.0, 0.0, 0.0, 1.0, 4.0, 26.0, 2.0, 51.0, 6.0, 107.0, 158.0, 56.0, 0.0, 2.0, 2.0, 192.0, 180.0, 0.0, 0.0, 0.0, 0.0, 55.0, 168.0, 170.0, 151.0, 7.0, 29.0, 4.0, 8.0, 6.0, 8.0, 80.0, 35.0, 7.0, 17.0, 34.0, 27.0, 0.0, 15.0, 26.0, 0.0, 46.0, 43.0, 8.0, 45.0, 87.0, 114.0, 9.0, 11.0, 32.0, 26.0, 0.0, 0.0, 37.0, 38.0, 12.0, 0.0, 19.0, 17.0, 13.0, 1.0, 0.0, 18.0, 63.0, 65.0, 0.0, 2.0, 64.0, 69.0, 24.0, 12.0, 103.0, 108.0, 7.0, 0.0, 21.0, 27.0, 39.0, 78.0, 127.0, 33.0, 0.0, 14.0, 43.0, 124.0, 83.0, 52.0, 0.0, 1.0, 18.0, 3.0, 0.0, 6.0, 28.0, 33.0, 16.0, 49.0, 0.0, 0.0, 64.0, 83.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 29.0, 0.0, 0.0, 41.0, 0.0, 32.0, 14.0, 0.0, 0.0, 7.0, 1.0, 0.0, 0.0, 39.0, 18.0, 0.0, 0.0, 44.0, 40.0, 17.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 130.0, 96.0, 35.0, 11.0, 5.0, 8.0, 102.0, 123.0, 0.0, 55.0, 11.0, 51.0, 13.0, 80.0, 7.0, 26.0, 0.0, 21.0, 0.0, 9.0, 28.0, 0.0, 68.0, 13.0, 0.0, 7.0, 91.0, 83.0, 1.0, 3.0, 2.0, 0.0, 75.0, 86.0, 0.0, 73.0, 65.0, 84.0, 51.0, 148.0, 24.0, 40.0, 185.0, 167.0, 0.0, 0.0, 50.0, 120.0, 0.0, 36.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.226848167325455, "mean_inference_ms": 27.877950457328605, "mean_action_processing_ms": 0.7264601400279314, "mean_env_wait_ms": 4.38950209621231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011757731437683105, "StateBufferConnector_ms": 0.012298822402954102, "ViewRequirementAgentConnector_ms": 0.3337712287902832}, "num_episodes": 23, "episode_return_max": 361.0, "episode_return_min": -265.0, "episode_return_mean": 154.08, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.62459588489259, "num_env_steps_trained_throughput_per_sec": 157.62459588489259, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 24199.629, "restore_workers_time_ms": 0.02, "training_step_time_ms": 24199.436, "sample_time_ms": 3757.235, "learn_time_ms": 20403.139, "learn_throughput": 196.048, "synch_weights_time_ms": 34.655}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "45bed_00000", "date": "2024-08-13_02-46-10", "timestamp": 1723531570, "time_this_iter_s": 25.439103841781616, "time_total_s": 5756.333443641663, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4463280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5756.333443641663, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 86.16944444444444, "ram_util_percent": 82.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0557431028002784, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5419787910880234, "policy_loss": -0.003567546121184788, "vf_loss": 2.545546161182343, "vf_explained_var": 0.00030814835003444127, "kl": 0.00612593613344292, "entropy": 0.5929468595792377, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.584967446705654, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.036778923569533, "policy_loss": -0.0017420352917046301, "vf_loss": 7.038520979250549, "vf_explained_var": 0.4645939124324334, "kl": 0.007555610577695062, "entropy": 1.0490076672147821, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 340.0, "episode_reward_min": -265.0, "episode_reward_mean": 158.19, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -373.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 185.0}, "policy_reward_mean": {"prey_policy": 50.18, "predator_policy": 28.915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [114.0, 180.0, 279.0, 192.0, 209.0, 240.0, 103.0, 305.0, 7.0, 228.0, 163.0, 174.0, 108.0, 220.0, 81.0, 287.0, 283.0, 272.0, 88.0, 83.0, 324.0, 232.0, 128.0, 173.0, 174.0, 283.0, -57.0, 106.0, 180.0, -51.0, 194.0, 44.0, 159.0, 152.0, 151.0, 58.0, 332.0, 151.0, 327.0, 160.0, 0.0, 97.0, 125.0, 300.0, -43.0, 187.0, 337.0, -8.0, 330.0, 84.0, 165.0, 325.0, 329.0, 340.0, 253.0, 182.0, 0.0, 28.0, 130.0, 29.0, 175.0, 236.0, 226.0, 96.0, 44.0, 158.0, 172.0, 326.0, 112.0, 326.0, -86.0, -2.0, 136.0, 178.0, 124.0, -18.0, -58.0, 240.0, -265.0, 299.0, -34.0, 109.0, 268.0, 303.0, -1.0, 281.0, 109.0, 64.0, 310.0, 135.0, 163.0, 0.0, 170.0, 254.0, 224.0, 312.0, 267.0, 64.0, 147.0, 229.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [96.0, -18.0, 176.0, -8.0, 114.0, 151.0, 55.0, 22.0, 61.0, 124.0, 18.0, 161.0, 0.0, 88.0, 117.0, 162.0, -82.0, 0.0, 35.0, 140.0, 127.0, -165.0, 95.0, 59.0, 54.0, -4.0, 139.0, 81.0, -91.0, 97.0, 133.0, 142.0, 134.0, 113.0, 123.0, 135.0, 70.0, 0.0, -45.0, 0.0, 144.0, 178.0, -96.0, 195.0, 100.0, -8.0, 178.0, -216.0, 181.0, -14.0, 148.0, 87.0, -174.0, 0.0, 148.0, -202.0, 126.0, 40.0, -178.0, -40.0, 163.0, -104.0, -2.0, 45.0, 137.0, 1.0, 146.0, 0.0, -68.0, 158.0, -118.0, 111.0, 173.0, 159.0, -166.0, 170.0, 164.0, 155.0, 0.0, 160.0, 0.0, 0.0, 113.0, -56.0, 0.0, 96.0, 166.0, 134.0, -82.0, -2.0, -59.0, 200.0, 165.0, 172.0, -14.0, -2.0, 163.0, 167.0, 27.0, 0.0, 0.0, 165.0, 197.0, 44.0, 153.0, 159.0, 173.0, 154.0, 143.0, 110.0, 184.0, -4.0, 0.0, 0.0, 96.0, -294.0, 176.0, -92.0, 0.0, 16.0, -178.0, 128.0, 146.0, 35.0, 38.0, 126.0, -148.0, 151.0, -58.0, 69.0, 137.0, 0.0, 181.0, -18.0, 115.0, 183.0, -136.0, 167.0, 163.0, 156.0, -94.0, -166.0, -6.0, 0.0, -4.0, 138.0, -171.0, 188.0, 84.0, -33.0, -91.0, -76.0, 0.0, -257.0, 36.0, 140.0, -244.0, -373.0, 174.0, 125.0, -100.0, -104.0, -72.0, 145.0, 108.0, 140.0, 139.0, 161.0, -175.0, -2.0, 143.0, 129.0, 0.0, 109.0, -10.0, 60.0, 173.0, 137.0, -2.0, 124.0, -128.0, 188.0, 0.0, 0.0, -21.0, 78.0, 102.0, 121.0, 80.0, 144.0, 144.0, 168.0, 130.0, 111.0, -346.0, 165.0, 0.0, 147.0, -6.0, 171.0], "policy_predator_policy_reward": [7.0, 29.0, 4.0, 8.0, 6.0, 8.0, 80.0, 35.0, 7.0, 17.0, 34.0, 27.0, 0.0, 15.0, 26.0, 0.0, 46.0, 43.0, 8.0, 45.0, 87.0, 114.0, 9.0, 11.0, 32.0, 26.0, 0.0, 0.0, 37.0, 38.0, 12.0, 0.0, 19.0, 17.0, 13.0, 1.0, 0.0, 18.0, 63.0, 65.0, 0.0, 2.0, 64.0, 69.0, 24.0, 12.0, 103.0, 108.0, 7.0, 0.0, 21.0, 27.0, 39.0, 78.0, 127.0, 33.0, 0.0, 14.0, 43.0, 124.0, 83.0, 52.0, 0.0, 1.0, 18.0, 3.0, 0.0, 6.0, 28.0, 33.0, 16.0, 49.0, 0.0, 0.0, 64.0, 83.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 29.0, 0.0, 0.0, 41.0, 0.0, 32.0, 14.0, 0.0, 0.0, 7.0, 1.0, 0.0, 0.0, 39.0, 18.0, 0.0, 0.0, 44.0, 40.0, 17.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 130.0, 96.0, 35.0, 11.0, 5.0, 8.0, 102.0, 123.0, 0.0, 55.0, 11.0, 51.0, 13.0, 80.0, 7.0, 26.0, 0.0, 21.0, 0.0, 9.0, 28.0, 0.0, 68.0, 13.0, 0.0, 7.0, 91.0, 83.0, 1.0, 3.0, 2.0, 0.0, 75.0, 86.0, 0.0, 73.0, 65.0, 84.0, 51.0, 148.0, 24.0, 40.0, 185.0, 167.0, 0.0, 0.0, 50.0, 120.0, 0.0, 36.0, 9.0, 11.0, 0.0, 3.0, 117.0, 59.0, 9.0, 0.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 0.0, 13.0, 60.0, 43.0, 0.0, 0.0, 58.0, 55.0, 0.0, 31.0, 0.0, 0.0, 0.0, 0.0, 12.0, 14.0, 175.0, 70.0, 0.0, 0.0, 8.0, 56.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.127644988291607, "mean_inference_ms": 27.570261138448686, "mean_action_processing_ms": 0.7265427818830567, "mean_env_wait_ms": 4.338527535323436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010518074035644531, "StateBufferConnector_ms": 0.012433171272277832, "ViewRequirementAgentConnector_ms": 0.3130847215652466}, "num_episodes": 18, "episode_return_max": 340.0, "episode_return_min": -265.0, "episode_return_mean": 158.19, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.21723489508994, "num_env_steps_trained_throughput_per_sec": 161.21723489508994, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 24521.931, "restore_workers_time_ms": 0.02, "training_step_time_ms": 24521.864, "sample_time_ms": 3776.545, "learn_time_ms": 20704.722, "learn_throughput": 193.193, "synch_weights_time_ms": 35.444}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "45bed_00000", "date": "2024-08-13_02-46-35", "timestamp": 1723531595, "time_this_iter_s": 24.897315979003906, "time_total_s": 5781.2307596206665, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33073fd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5781.2307596206665, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 86.13714285714285, "ram_util_percent": 83.27714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0294016308491192, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.271583932480484, "policy_loss": -0.001974035989340375, "vf_loss": 2.273557905419163, "vf_explained_var": 0.0019882362670999355, "kl": 0.0039481549469520235, "entropy": 0.5632552421439893, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.10471389262134, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.417574879479787, "policy_loss": -0.0019079120924558352, "vf_loss": 6.4194827902253975, "vf_explained_var": 0.35706881161720033, "kl": 0.004551410116825563, "entropy": 1.0700996189205736, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 340.0, "episode_reward_min": -265.0, "episode_reward_mean": 148.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -373.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 185.0}, "policy_reward_mean": {"prey_policy": 43.465, "predator_policy": 30.815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [88.0, 83.0, 324.0, 232.0, 128.0, 173.0, 174.0, 283.0, -57.0, 106.0, 180.0, -51.0, 194.0, 44.0, 159.0, 152.0, 151.0, 58.0, 332.0, 151.0, 327.0, 160.0, 0.0, 97.0, 125.0, 300.0, -43.0, 187.0, 337.0, -8.0, 330.0, 84.0, 165.0, 325.0, 329.0, 340.0, 253.0, 182.0, 0.0, 28.0, 130.0, 29.0, 175.0, 236.0, 226.0, 96.0, 44.0, 158.0, 172.0, 326.0, 112.0, 326.0, -86.0, -2.0, 136.0, 178.0, 124.0, -18.0, -58.0, 240.0, -265.0, 299.0, -34.0, 109.0, 268.0, 303.0, -1.0, 281.0, 109.0, 64.0, 310.0, 135.0, 163.0, 0.0, 170.0, 254.0, 224.0, 312.0, 267.0, 64.0, 147.0, 229.0, 217.0, 258.0, -82.0, 279.0, 99.0, 38.0, 268.0, 260.0, 207.0, -3.0, 100.0, 162.0, 193.0, 55.0, 179.0, 260.0, 48.0, -56.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [70.0, 0.0, -45.0, 0.0, 144.0, 178.0, -96.0, 195.0, 100.0, -8.0, 178.0, -216.0, 181.0, -14.0, 148.0, 87.0, -174.0, 0.0, 148.0, -202.0, 126.0, 40.0, -178.0, -40.0, 163.0, -104.0, -2.0, 45.0, 137.0, 1.0, 146.0, 0.0, -68.0, 158.0, -118.0, 111.0, 173.0, 159.0, -166.0, 170.0, 164.0, 155.0, 0.0, 160.0, 0.0, 0.0, 113.0, -56.0, 0.0, 96.0, 166.0, 134.0, -82.0, -2.0, -59.0, 200.0, 165.0, 172.0, -14.0, -2.0, 163.0, 167.0, 27.0, 0.0, 0.0, 165.0, 197.0, 44.0, 153.0, 159.0, 173.0, 154.0, 143.0, 110.0, 184.0, -4.0, 0.0, 0.0, 96.0, -294.0, 176.0, -92.0, 0.0, 16.0, -178.0, 128.0, 146.0, 35.0, 38.0, 126.0, -148.0, 151.0, -58.0, 69.0, 137.0, 0.0, 181.0, -18.0, 115.0, 183.0, -136.0, 167.0, 163.0, 156.0, -94.0, -166.0, -6.0, 0.0, -4.0, 138.0, -171.0, 188.0, 84.0, -33.0, -91.0, -76.0, 0.0, -257.0, 36.0, 140.0, -244.0, -373.0, 174.0, 125.0, -100.0, -104.0, -72.0, 145.0, 108.0, 140.0, 139.0, 161.0, -175.0, -2.0, 143.0, 129.0, 0.0, 109.0, -10.0, 60.0, 173.0, 137.0, -2.0, 124.0, -128.0, 188.0, 0.0, 0.0, -21.0, 78.0, 102.0, 121.0, 80.0, 144.0, 144.0, 168.0, 130.0, 111.0, -346.0, 165.0, 0.0, 147.0, -6.0, 171.0, 138.0, -29.0, 101.0, 143.0, -126.0, -22.0, 27.0, 158.0, 65.0, -112.0, 54.0, -145.0, 150.0, 81.0, 144.0, 102.0, 59.0, -4.0, -6.0, 0.0, -14.0, -29.0, 105.0, -13.0, 22.0, 115.0, 72.0, -70.0, 182.0, -6.0, 132.0, 116.0, 62.0, -28.0, 0.0, -183.0], "policy_predator_policy_reward": [0.0, 18.0, 63.0, 65.0, 0.0, 2.0, 64.0, 69.0, 24.0, 12.0, 103.0, 108.0, 7.0, 0.0, 21.0, 27.0, 39.0, 78.0, 127.0, 33.0, 0.0, 14.0, 43.0, 124.0, 83.0, 52.0, 0.0, 1.0, 18.0, 3.0, 0.0, 6.0, 28.0, 33.0, 16.0, 49.0, 0.0, 0.0, 64.0, 83.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 29.0, 0.0, 0.0, 41.0, 0.0, 32.0, 14.0, 0.0, 0.0, 7.0, 1.0, 0.0, 0.0, 39.0, 18.0, 0.0, 0.0, 44.0, 40.0, 17.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 130.0, 96.0, 35.0, 11.0, 5.0, 8.0, 102.0, 123.0, 0.0, 55.0, 11.0, 51.0, 13.0, 80.0, 7.0, 26.0, 0.0, 21.0, 0.0, 9.0, 28.0, 0.0, 68.0, 13.0, 0.0, 7.0, 91.0, 83.0, 1.0, 3.0, 2.0, 0.0, 75.0, 86.0, 0.0, 73.0, 65.0, 84.0, 51.0, 148.0, 24.0, 40.0, 185.0, 167.0, 0.0, 0.0, 50.0, 120.0, 0.0, 36.0, 9.0, 11.0, 0.0, 3.0, 117.0, 59.0, 9.0, 0.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 0.0, 13.0, 60.0, 43.0, 0.0, 0.0, 58.0, 55.0, 0.0, 31.0, 0.0, 0.0, 0.0, 0.0, 12.0, 14.0, 175.0, 70.0, 0.0, 0.0, 8.0, 56.0, 45.0, 63.0, 14.0, 0.0, 63.0, 3.0, 50.0, 44.0, 61.0, 85.0, 129.0, 0.0, 13.0, 24.0, 0.0, 14.0, 78.0, 74.0, 2.0, 1.0, 73.0, 70.0, 70.0, 0.0, 5.0, 51.0, 18.0, 35.0, 0.0, 3.0, 12.0, 0.0, 1.0, 13.0, 6.0, 121.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.029292731363734, "mean_inference_ms": 27.265911650753406, "mean_action_processing_ms": 0.7256055057703135, "mean_env_wait_ms": 4.288357592647916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012184739112854004, "StateBufferConnector_ms": 0.013147711753845215, "ViewRequirementAgentConnector_ms": 0.2890772819519043}, "num_episodes": 18, "episode_return_max": 340.0, "episode_return_min": -265.0, "episode_return_mean": 148.56, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.67642835242845, "num_env_steps_trained_throughput_per_sec": 161.67642835242845, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 24913.393, "restore_workers_time_ms": 0.021, "training_step_time_ms": 24913.325, "sample_time_ms": 3838.99, "learn_time_ms": 21032.567, "learn_throughput": 190.181, "synch_weights_time_ms": 36.44}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "45bed_00000", "date": "2024-08-13_02-47-00", "timestamp": 1723531620, "time_this_iter_s": 24.82050108909607, "time_total_s": 5806.051260709763, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x330744dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5806.051260709763, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 85.50000000000001, "ram_util_percent": 83.28}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0757617624506117, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.195926244927462, "policy_loss": -0.00314890971880347, "vf_loss": 2.199075091957415, "vf_explained_var": 0.005110057573469859, "kl": 0.0075143752878945765, "entropy": 0.5734651105744498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.06313355369543, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.165078016563698, "policy_loss": -0.0013141757508040104, "vf_loss": 7.166392202982827, "vf_explained_var": 0.5243473624741589, "kl": 0.005118005915389452, "entropy": 1.1095297143572853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 340.0, "episode_reward_min": -265.0, "episode_reward_mean": 139.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -373.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 185.0}, "policy_reward_mean": {"prey_policy": 41.055, "predator_policy": 28.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 97.0, 125.0, 300.0, -43.0, 187.0, 337.0, -8.0, 330.0, 84.0, 165.0, 325.0, 329.0, 340.0, 253.0, 182.0, 0.0, 28.0, 130.0, 29.0, 175.0, 236.0, 226.0, 96.0, 44.0, 158.0, 172.0, 326.0, 112.0, 326.0, -86.0, -2.0, 136.0, 178.0, 124.0, -18.0, -58.0, 240.0, -265.0, 299.0, -34.0, 109.0, 268.0, 303.0, -1.0, 281.0, 109.0, 64.0, 310.0, 135.0, 163.0, 0.0, 170.0, 254.0, 224.0, 312.0, 267.0, 64.0, 147.0, 229.0, 217.0, 258.0, -82.0, 279.0, 99.0, 38.0, 268.0, 260.0, 207.0, -3.0, 100.0, 162.0, 193.0, 55.0, 179.0, 260.0, 48.0, -56.0, 251.0, -138.0, -5.0, 120.0, 70.0, 2.0, 1.0, 214.0, 174.0, 34.0, 147.0, 197.0, 22.0, 128.0, 93.0, 268.0, 208.0, 152.0, 107.0, 234.0, 0.0, 252.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 113.0, -56.0, 0.0, 96.0, 166.0, 134.0, -82.0, -2.0, -59.0, 200.0, 165.0, 172.0, -14.0, -2.0, 163.0, 167.0, 27.0, 0.0, 0.0, 165.0, 197.0, 44.0, 153.0, 159.0, 173.0, 154.0, 143.0, 110.0, 184.0, -4.0, 0.0, 0.0, 96.0, -294.0, 176.0, -92.0, 0.0, 16.0, -178.0, 128.0, 146.0, 35.0, 38.0, 126.0, -148.0, 151.0, -58.0, 69.0, 137.0, 0.0, 181.0, -18.0, 115.0, 183.0, -136.0, 167.0, 163.0, 156.0, -94.0, -166.0, -6.0, 0.0, -4.0, 138.0, -171.0, 188.0, 84.0, -33.0, -91.0, -76.0, 0.0, -257.0, 36.0, 140.0, -244.0, -373.0, 174.0, 125.0, -100.0, -104.0, -72.0, 145.0, 108.0, 140.0, 139.0, 161.0, -175.0, -2.0, 143.0, 129.0, 0.0, 109.0, -10.0, 60.0, 173.0, 137.0, -2.0, 124.0, -128.0, 188.0, 0.0, 0.0, -21.0, 78.0, 102.0, 121.0, 80.0, 144.0, 144.0, 168.0, 130.0, 111.0, -346.0, 165.0, 0.0, 147.0, -6.0, 171.0, 138.0, -29.0, 101.0, 143.0, -126.0, -22.0, 27.0, 158.0, 65.0, -112.0, 54.0, -145.0, 150.0, 81.0, 144.0, 102.0, 59.0, -4.0, -6.0, 0.0, -14.0, -29.0, 105.0, -13.0, 22.0, 115.0, 72.0, -70.0, 182.0, -6.0, 132.0, 116.0, 62.0, -28.0, 0.0, -183.0, 162.0, 83.0, -82.0, -160.0, -10.0, 0.0, -7.0, 56.0, 0.0, 39.0, 98.0, -192.0, 24.0, -46.0, 136.0, 61.0, -4.0, 176.0, -40.0, -37.0, -6.0, 150.0, 60.0, 137.0, -84.0, -6.0, -2.0, 127.0, -6.0, -1.0, 97.0, 171.0, 121.0, 25.0, -181.0, 110.0, -4.0, 20.0, 63.0, 135.0, 0.0, 0.0, 150.0, 91.0], "policy_predator_policy_reward": [0.0, 0.0, 20.0, 20.0, 0.0, 29.0, 0.0, 0.0, 41.0, 0.0, 32.0, 14.0, 0.0, 0.0, 7.0, 1.0, 0.0, 0.0, 39.0, 18.0, 0.0, 0.0, 44.0, 40.0, 17.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 130.0, 96.0, 35.0, 11.0, 5.0, 8.0, 102.0, 123.0, 0.0, 55.0, 11.0, 51.0, 13.0, 80.0, 7.0, 26.0, 0.0, 21.0, 0.0, 9.0, 28.0, 0.0, 68.0, 13.0, 0.0, 7.0, 91.0, 83.0, 1.0, 3.0, 2.0, 0.0, 75.0, 86.0, 0.0, 73.0, 65.0, 84.0, 51.0, 148.0, 24.0, 40.0, 185.0, 167.0, 0.0, 0.0, 50.0, 120.0, 0.0, 36.0, 9.0, 11.0, 0.0, 3.0, 117.0, 59.0, 9.0, 0.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 0.0, 13.0, 60.0, 43.0, 0.0, 0.0, 58.0, 55.0, 0.0, 31.0, 0.0, 0.0, 0.0, 0.0, 12.0, 14.0, 175.0, 70.0, 0.0, 0.0, 8.0, 56.0, 45.0, 63.0, 14.0, 0.0, 63.0, 3.0, 50.0, 44.0, 61.0, 85.0, 129.0, 0.0, 13.0, 24.0, 0.0, 14.0, 78.0, 74.0, 2.0, 1.0, 73.0, 70.0, 70.0, 0.0, 5.0, 51.0, 18.0, 35.0, 0.0, 3.0, 12.0, 0.0, 1.0, 13.0, 6.0, 121.0, 6.0, 0.0, 94.0, 10.0, 5.0, 0.0, 62.0, 9.0, 31.0, 0.0, 96.0, 0.0, 23.0, 0.0, 17.0, 0.0, 2.0, 0.0, 5.0, 106.0, 0.0, 3.0, 0.0, 0.0, 45.0, 67.0, 2.0, 1.0, 50.0, 50.0, 0.0, 0.0, 11.0, 51.0, 105.0, 118.0, 53.0, 38.0, 6.0, 30.0, 0.0, 0.0, 0.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.932494227373384, "mean_inference_ms": 26.894670931478057, "mean_action_processing_ms": 0.7246463817544593, "mean_env_wait_ms": 4.215159018088104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020457744598388672, "StateBufferConnector_ms": 0.007000565528869629, "ViewRequirementAgentConnector_ms": 0.27385568618774414}, "num_episodes": 22, "episode_return_max": 340.0, "episode_return_min": -265.0, "episode_return_mean": 139.96, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 138.28653606965432, "num_env_steps_trained_throughput_per_sec": 138.28653606965432, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 25605.037, "restore_workers_time_ms": 0.02, "training_step_time_ms": 25604.969, "sample_time_ms": 3851.029, "learn_time_ms": 21712.822, "learn_throughput": 184.223, "synch_weights_time_ms": 35.557}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "45bed_00000", "date": "2024-08-13_02-47-29", "timestamp": 1723531649, "time_this_iter_s": 29.02284288406372, "time_total_s": 5835.074103593826, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44f6550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5835.074103593826, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 88.51951219512196, "ram_util_percent": 83.30975609756098}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9541267351222732, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3143581887401603, "policy_loss": -0.0004736569374996834, "vf_loss": 2.3148318310263294, "vf_explained_var": 0.0022295971711476644, "kl": 0.003566914828127511, "entropy": 0.5994844625866602, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.644698672445994, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.648202005517546, "policy_loss": -0.0031951099719172197, "vf_loss": 7.651397116978964, "vf_explained_var": 0.3400200625260671, "kl": 0.0063706143667347, "entropy": 1.1173645841381536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 326.0, "episode_reward_min": -265.0, "episode_reward_mean": 133.9, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -373.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 188.0, "predator_policy": 185.0}, "policy_reward_mean": {"prey_policy": 36.23, "predator_policy": 30.72}, "custom_metrics": {}, "hist_stats": {"episode_reward": [96.0, 44.0, 158.0, 172.0, 326.0, 112.0, 326.0, -86.0, -2.0, 136.0, 178.0, 124.0, -18.0, -58.0, 240.0, -265.0, 299.0, -34.0, 109.0, 268.0, 303.0, -1.0, 281.0, 109.0, 64.0, 310.0, 135.0, 163.0, 0.0, 170.0, 254.0, 224.0, 312.0, 267.0, 64.0, 147.0, 229.0, 217.0, 258.0, -82.0, 279.0, 99.0, 38.0, 268.0, 260.0, 207.0, -3.0, 100.0, 162.0, 193.0, 55.0, 179.0, 260.0, 48.0, -56.0, 251.0, -138.0, -5.0, 120.0, 70.0, 2.0, 1.0, 214.0, 174.0, 34.0, 147.0, 197.0, 22.0, 128.0, 93.0, 268.0, 208.0, 152.0, 107.0, 234.0, 0.0, 252.0, 63.0, 27.0, 33.0, 270.0, 69.0, 15.0, 278.0, 196.0, 58.0, 89.0, 0.0, 248.0, 272.0, 126.0, 139.0, 249.0, 189.0, 42.0, 171.0, 189.0, 76.0, 287.0, 135.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-148.0, 151.0, -58.0, 69.0, 137.0, 0.0, 181.0, -18.0, 115.0, 183.0, -136.0, 167.0, 163.0, 156.0, -94.0, -166.0, -6.0, 0.0, -4.0, 138.0, -171.0, 188.0, 84.0, -33.0, -91.0, -76.0, 0.0, -257.0, 36.0, 140.0, -244.0, -373.0, 174.0, 125.0, -100.0, -104.0, -72.0, 145.0, 108.0, 140.0, 139.0, 161.0, -175.0, -2.0, 143.0, 129.0, 0.0, 109.0, -10.0, 60.0, 173.0, 137.0, -2.0, 124.0, -128.0, 188.0, 0.0, 0.0, -21.0, 78.0, 102.0, 121.0, 80.0, 144.0, 144.0, 168.0, 130.0, 111.0, -346.0, 165.0, 0.0, 147.0, -6.0, 171.0, 138.0, -29.0, 101.0, 143.0, -126.0, -22.0, 27.0, 158.0, 65.0, -112.0, 54.0, -145.0, 150.0, 81.0, 144.0, 102.0, 59.0, -4.0, -6.0, 0.0, -14.0, -29.0, 105.0, -13.0, 22.0, 115.0, 72.0, -70.0, 182.0, -6.0, 132.0, 116.0, 62.0, -28.0, 0.0, -183.0, 162.0, 83.0, -82.0, -160.0, -10.0, 0.0, -7.0, 56.0, 0.0, 39.0, 98.0, -192.0, 24.0, -46.0, 136.0, 61.0, -4.0, 176.0, -40.0, -37.0, -6.0, 150.0, 60.0, 137.0, -84.0, -6.0, -2.0, 127.0, -6.0, -1.0, 97.0, 171.0, 121.0, 25.0, -181.0, 110.0, -4.0, 20.0, 63.0, 135.0, 0.0, 0.0, 150.0, 91.0, -26.0, 0.0, 0.0, -35.0, 31.0, -74.0, 143.0, 106.0, -233.0, 66.0, 66.0, -140.0, 148.0, 122.0, -121.0, 184.0, 38.0, 0.0, 0.0, 89.0, 0.0, 0.0, 141.0, -52.0, 95.0, 147.0, -16.0, 83.0, 0.0, 95.0, 76.0, 166.0, 113.0, 67.0, -3.0, -87.0, 114.0, -4.0, 81.0, 98.0, -104.0, 128.0, 103.0, 158.0, 135.0, 0.0], "policy_predator_policy_reward": [13.0, 80.0, 7.0, 26.0, 0.0, 21.0, 0.0, 9.0, 28.0, 0.0, 68.0, 13.0, 0.0, 7.0, 91.0, 83.0, 1.0, 3.0, 2.0, 0.0, 75.0, 86.0, 0.0, 73.0, 65.0, 84.0, 51.0, 148.0, 24.0, 40.0, 185.0, 167.0, 0.0, 0.0, 50.0, 120.0, 0.0, 36.0, 9.0, 11.0, 0.0, 3.0, 117.0, 59.0, 9.0, 0.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 0.0, 13.0, 60.0, 43.0, 0.0, 0.0, 58.0, 55.0, 0.0, 31.0, 0.0, 0.0, 0.0, 0.0, 12.0, 14.0, 175.0, 70.0, 0.0, 0.0, 8.0, 56.0, 45.0, 63.0, 14.0, 0.0, 63.0, 3.0, 50.0, 44.0, 61.0, 85.0, 129.0, 0.0, 13.0, 24.0, 0.0, 14.0, 78.0, 74.0, 2.0, 1.0, 73.0, 70.0, 70.0, 0.0, 5.0, 51.0, 18.0, 35.0, 0.0, 3.0, 12.0, 0.0, 1.0, 13.0, 6.0, 121.0, 6.0, 0.0, 94.0, 10.0, 5.0, 0.0, 62.0, 9.0, 31.0, 0.0, 96.0, 0.0, 23.0, 0.0, 17.0, 0.0, 2.0, 0.0, 5.0, 106.0, 0.0, 3.0, 0.0, 0.0, 45.0, 67.0, 2.0, 1.0, 50.0, 50.0, 0.0, 0.0, 11.0, 51.0, 105.0, 118.0, 53.0, 38.0, 6.0, 30.0, 0.0, 0.0, 0.0, 11.0, 34.0, 55.0, 0.0, 62.0, 34.0, 42.0, 0.0, 21.0, 127.0, 109.0, 70.0, 19.0, 0.0, 8.0, 26.0, 107.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 77.0, 82.0, 30.0, 0.0, 0.0, 59.0, 29.0, 15.0, 0.0, 7.0, 0.0, 9.0, 90.0, 42.0, 0.0, 61.0, 10.0, 0.0, 0.0, 52.0, 10.0, 16.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.479579666443248, "mean_inference_ms": 25.87640310477435, "mean_action_processing_ms": 0.7306300573004892, "mean_env_wait_ms": 4.171202477635938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022500991821289062, "StateBufferConnector_ms": 0.007222294807434082, "ViewRequirementAgentConnector_ms": 0.3048597574234009}, "num_episodes": 23, "episode_return_max": 326.0, "episode_return_min": -265.0, "episode_return_mean": 133.9, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 139.2849166090762, "num_env_steps_trained_throughput_per_sec": 139.2849166090762, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 26242.258, "restore_workers_time_ms": 0.02, "training_step_time_ms": 26242.189, "sample_time_ms": 4069.103, "learn_time_ms": 22134.264, "learn_throughput": 180.715, "synch_weights_time_ms": 33.294}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "45bed_00000", "date": "2024-08-13_02-47-58", "timestamp": 1723531678, "time_this_iter_s": 28.78911304473877, "time_total_s": 5863.863216638565, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3306a4280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5863.863216638565, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 88.185, "ram_util_percent": 83.57}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1084975502636067, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.801125822054646, "policy_loss": -0.004674358434960365, "vf_loss": 2.8058001838663897, "vf_explained_var": 0.0012972203512040396, "kl": 0.00710572571688654, "entropy": 0.5987181073774106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.116671231625574, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.302884617053643, "policy_loss": -0.0036735133984909644, "vf_loss": 7.30655814579555, "vf_explained_var": 0.37614773209132846, "kl": 0.007411708193342381, "entropy": 1.1306243442353747, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 312.0, "episode_reward_min": -149.0, "episode_reward_mean": 135.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -346.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 188.0, "predator_policy": 175.0}, "policy_reward_mean": {"prey_policy": 39.13, "predator_policy": 28.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [109.0, 268.0, 303.0, -1.0, 281.0, 109.0, 64.0, 310.0, 135.0, 163.0, 0.0, 170.0, 254.0, 224.0, 312.0, 267.0, 64.0, 147.0, 229.0, 217.0, 258.0, -82.0, 279.0, 99.0, 38.0, 268.0, 260.0, 207.0, -3.0, 100.0, 162.0, 193.0, 55.0, 179.0, 260.0, 48.0, -56.0, 251.0, -138.0, -5.0, 120.0, 70.0, 2.0, 1.0, 214.0, 174.0, 34.0, 147.0, 197.0, 22.0, 128.0, 93.0, 268.0, 208.0, 152.0, 107.0, 234.0, 0.0, 252.0, 63.0, 27.0, 33.0, 270.0, 69.0, 15.0, 278.0, 196.0, 58.0, 89.0, 0.0, 248.0, 272.0, 126.0, 139.0, 249.0, 189.0, 42.0, 171.0, 189.0, 76.0, 287.0, 135.0, -149.0, -13.0, 182.0, 177.0, 112.0, -60.0, 186.0, 279.0, 222.0, -34.0, 164.0, 42.0, 235.0, 13.0, 165.0, 253.0, 28.0, 112.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-72.0, 145.0, 108.0, 140.0, 139.0, 161.0, -175.0, -2.0, 143.0, 129.0, 0.0, 109.0, -10.0, 60.0, 173.0, 137.0, -2.0, 124.0, -128.0, 188.0, 0.0, 0.0, -21.0, 78.0, 102.0, 121.0, 80.0, 144.0, 144.0, 168.0, 130.0, 111.0, -346.0, 165.0, 0.0, 147.0, -6.0, 171.0, 138.0, -29.0, 101.0, 143.0, -126.0, -22.0, 27.0, 158.0, 65.0, -112.0, 54.0, -145.0, 150.0, 81.0, 144.0, 102.0, 59.0, -4.0, -6.0, 0.0, -14.0, -29.0, 105.0, -13.0, 22.0, 115.0, 72.0, -70.0, 182.0, -6.0, 132.0, 116.0, 62.0, -28.0, 0.0, -183.0, 162.0, 83.0, -82.0, -160.0, -10.0, 0.0, -7.0, 56.0, 0.0, 39.0, 98.0, -192.0, 24.0, -46.0, 136.0, 61.0, -4.0, 176.0, -40.0, -37.0, -6.0, 150.0, 60.0, 137.0, -84.0, -6.0, -2.0, 127.0, -6.0, -1.0, 97.0, 171.0, 121.0, 25.0, -181.0, 110.0, -4.0, 20.0, 63.0, 135.0, 0.0, 0.0, 150.0, 91.0, -26.0, 0.0, 0.0, -35.0, 31.0, -74.0, 143.0, 106.0, -233.0, 66.0, 66.0, -140.0, 148.0, 122.0, -121.0, 184.0, 38.0, 0.0, 0.0, 89.0, 0.0, 0.0, 141.0, -52.0, 95.0, 147.0, -16.0, 83.0, 0.0, 95.0, 76.0, 166.0, 113.0, 67.0, -3.0, -87.0, 114.0, -4.0, 81.0, 98.0, -104.0, 128.0, 103.0, 158.0, 135.0, 0.0, -276.0, -75.0, -43.0, 0.0, 7.0, 166.0, -49.0, 157.0, 61.0, 30.0, -8.0, -154.0, 141.0, -52.0, 64.0, 173.0, 112.0, -12.0, -68.0, 0.0, 164.0, 0.0, -72.0, -49.0, 142.0, 93.0, -70.0, -35.0, 42.0, 123.0, 186.0, 4.0, -103.0, -3.0, 0.0, 112.0], "policy_predator_policy_reward": [0.0, 36.0, 9.0, 11.0, 0.0, 3.0, 117.0, 59.0, 9.0, 0.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 0.0, 13.0, 60.0, 43.0, 0.0, 0.0, 58.0, 55.0, 0.0, 31.0, 0.0, 0.0, 0.0, 0.0, 12.0, 14.0, 175.0, 70.0, 0.0, 0.0, 8.0, 56.0, 45.0, 63.0, 14.0, 0.0, 63.0, 3.0, 50.0, 44.0, 61.0, 85.0, 129.0, 0.0, 13.0, 24.0, 0.0, 14.0, 78.0, 74.0, 2.0, 1.0, 73.0, 70.0, 70.0, 0.0, 5.0, 51.0, 18.0, 35.0, 0.0, 3.0, 12.0, 0.0, 1.0, 13.0, 6.0, 121.0, 6.0, 0.0, 94.0, 10.0, 5.0, 0.0, 62.0, 9.0, 31.0, 0.0, 96.0, 0.0, 23.0, 0.0, 17.0, 0.0, 2.0, 0.0, 5.0, 106.0, 0.0, 3.0, 0.0, 0.0, 45.0, 67.0, 2.0, 1.0, 50.0, 50.0, 0.0, 0.0, 11.0, 51.0, 105.0, 118.0, 53.0, 38.0, 6.0, 30.0, 0.0, 0.0, 0.0, 11.0, 34.0, 55.0, 0.0, 62.0, 34.0, 42.0, 0.0, 21.0, 127.0, 109.0, 70.0, 19.0, 0.0, 8.0, 26.0, 107.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 77.0, 82.0, 30.0, 0.0, 0.0, 59.0, 29.0, 15.0, 0.0, 7.0, 0.0, 9.0, 90.0, 42.0, 0.0, 61.0, 10.0, 0.0, 0.0, 52.0, 10.0, 16.0, 0.0, 0.0, 64.0, 138.0, 0.0, 30.0, 0.0, 9.0, 44.0, 25.0, 21.0, 0.0, 4.0, 98.0, 52.0, 45.0, 42.0, 0.0, 57.0, 65.0, 0.0, 34.0, 0.0, 0.0, 79.0, 84.0, 0.0, 0.0, 48.0, 70.0, 0.0, 0.0, 18.0, 45.0, 13.0, 121.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.718730378546736, "mean_inference_ms": 26.28812138358545, "mean_action_processing_ms": 0.7250513564971104, "mean_env_wait_ms": 4.12400529001514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020928025245666504, "StateBufferConnector_ms": 0.012745261192321777, "ViewRequirementAgentConnector_ms": 0.3514927625656128}, "num_episodes": 18, "episode_return_max": 312.0, "episode_return_min": -149.0, "episode_return_mean": 135.56, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 120.40244082036432, "num_env_steps_trained_throughput_per_sec": 120.40244082036432, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 27032.202, "restore_workers_time_ms": 0.018, "training_step_time_ms": 27032.136, "sample_time_ms": 4186.247, "learn_time_ms": 22807.067, "learn_throughput": 175.384, "synch_weights_time_ms": 33.21}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "45bed_00000", "date": "2024-08-13_02-48-31", "timestamp": 1723531711, "time_this_iter_s": 33.30197787284851, "time_total_s": 5897.165194511414, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44e53a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5897.165194511414, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 89.32553191489365, "ram_util_percent": 83.59361702127659}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.009164898830747, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.606115490481967, "policy_loss": -0.0033955094707568013, "vf_loss": 2.609511001778658, "vf_explained_var": 0.0015373190874775882, "kl": 0.0086704280454875, "entropy": 0.5585723251892776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.37857531315435, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.316736750375657, "policy_loss": -0.0011097167107330822, "vf_loss": 7.317846465993811, "vf_explained_var": 0.2695634785152617, "kl": 0.0062748813521341104, "entropy": 1.0001195840103916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 315.0, "episode_reward_min": -149.0, "episode_reward_mean": 134.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -289.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 149.0}, "policy_reward_mean": {"prey_policy": 36.16, "predator_policy": 30.87}, "custom_metrics": {}, "hist_stats": {"episode_reward": [229.0, 217.0, 258.0, -82.0, 279.0, 99.0, 38.0, 268.0, 260.0, 207.0, -3.0, 100.0, 162.0, 193.0, 55.0, 179.0, 260.0, 48.0, -56.0, 251.0, -138.0, -5.0, 120.0, 70.0, 2.0, 1.0, 214.0, 174.0, 34.0, 147.0, 197.0, 22.0, 128.0, 93.0, 268.0, 208.0, 152.0, 107.0, 234.0, 0.0, 252.0, 63.0, 27.0, 33.0, 270.0, 69.0, 15.0, 278.0, 196.0, 58.0, 89.0, 0.0, 248.0, 272.0, 126.0, 139.0, 249.0, 189.0, 42.0, 171.0, 189.0, 76.0, 287.0, 135.0, -149.0, -13.0, 182.0, 177.0, 112.0, -60.0, 186.0, 279.0, 222.0, -34.0, 164.0, 42.0, 235.0, 13.0, 165.0, 253.0, 28.0, 112.0, 111.0, 308.0, 57.0, 235.0, 142.0, 313.0, 143.0, 2.0, 229.0, 106.0, 78.0, 221.0, 249.0, 17.0, 145.0, 120.0, 315.0, 238.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, 171.0, 138.0, -29.0, 101.0, 143.0, -126.0, -22.0, 27.0, 158.0, 65.0, -112.0, 54.0, -145.0, 150.0, 81.0, 144.0, 102.0, 59.0, -4.0, -6.0, 0.0, -14.0, -29.0, 105.0, -13.0, 22.0, 115.0, 72.0, -70.0, 182.0, -6.0, 132.0, 116.0, 62.0, -28.0, 0.0, -183.0, 162.0, 83.0, -82.0, -160.0, -10.0, 0.0, -7.0, 56.0, 0.0, 39.0, 98.0, -192.0, 24.0, -46.0, 136.0, 61.0, -4.0, 176.0, -40.0, -37.0, -6.0, 150.0, 60.0, 137.0, -84.0, -6.0, -2.0, 127.0, -6.0, -1.0, 97.0, 171.0, 121.0, 25.0, -181.0, 110.0, -4.0, 20.0, 63.0, 135.0, 0.0, 0.0, 150.0, 91.0, -26.0, 0.0, 0.0, -35.0, 31.0, -74.0, 143.0, 106.0, -233.0, 66.0, 66.0, -140.0, 148.0, 122.0, -121.0, 184.0, 38.0, 0.0, 0.0, 89.0, 0.0, 0.0, 141.0, -52.0, 95.0, 147.0, -16.0, 83.0, 0.0, 95.0, 76.0, 166.0, 113.0, 67.0, -3.0, -87.0, 114.0, -4.0, 81.0, 98.0, -104.0, 128.0, 103.0, 158.0, 135.0, 0.0, -276.0, -75.0, -43.0, 0.0, 7.0, 166.0, -49.0, 157.0, 61.0, 30.0, -8.0, -154.0, 141.0, -52.0, 64.0, 173.0, 112.0, -12.0, -68.0, 0.0, 164.0, 0.0, -72.0, -49.0, 142.0, 93.0, -70.0, -35.0, 42.0, 123.0, 186.0, 4.0, -103.0, -3.0, 0.0, 112.0, -58.0, 116.0, 151.0, 156.0, 74.0, -106.0, 119.0, 104.0, 102.0, -60.0, 179.0, 134.0, -18.0, 152.0, -289.0, 0.0, 56.0, 165.0, 106.0, 0.0, 113.0, -160.0, 155.0, -112.0, -107.0, 200.0, -4.0, -133.0, 155.0, -20.0, 50.0, 23.0, 187.0, 128.0, 145.0, 93.0], "policy_predator_policy_reward": [8.0, 56.0, 45.0, 63.0, 14.0, 0.0, 63.0, 3.0, 50.0, 44.0, 61.0, 85.0, 129.0, 0.0, 13.0, 24.0, 0.0, 14.0, 78.0, 74.0, 2.0, 1.0, 73.0, 70.0, 70.0, 0.0, 5.0, 51.0, 18.0, 35.0, 0.0, 3.0, 12.0, 0.0, 1.0, 13.0, 6.0, 121.0, 6.0, 0.0, 94.0, 10.0, 5.0, 0.0, 62.0, 9.0, 31.0, 0.0, 96.0, 0.0, 23.0, 0.0, 17.0, 0.0, 2.0, 0.0, 5.0, 106.0, 0.0, 3.0, 0.0, 0.0, 45.0, 67.0, 2.0, 1.0, 50.0, 50.0, 0.0, 0.0, 11.0, 51.0, 105.0, 118.0, 53.0, 38.0, 6.0, 30.0, 0.0, 0.0, 0.0, 11.0, 34.0, 55.0, 0.0, 62.0, 34.0, 42.0, 0.0, 21.0, 127.0, 109.0, 70.0, 19.0, 0.0, 8.0, 26.0, 107.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 77.0, 82.0, 30.0, 0.0, 0.0, 59.0, 29.0, 15.0, 0.0, 7.0, 0.0, 9.0, 90.0, 42.0, 0.0, 61.0, 10.0, 0.0, 0.0, 52.0, 10.0, 16.0, 0.0, 0.0, 64.0, 138.0, 0.0, 30.0, 0.0, 9.0, 44.0, 25.0, 21.0, 0.0, 4.0, 98.0, 52.0, 45.0, 42.0, 0.0, 57.0, 65.0, 0.0, 34.0, 0.0, 0.0, 79.0, 84.0, 0.0, 0.0, 48.0, 70.0, 0.0, 0.0, 18.0, 45.0, 13.0, 121.0, 0.0, 0.0, 29.0, 24.0, 0.0, 1.0, 36.0, 53.0, 4.0, 8.0, 16.0, 84.0, 0.0, 0.0, 0.0, 9.0, 142.0, 149.0, 8.0, 0.0, 0.0, 0.0, 7.0, 118.0, 104.0, 74.0, 70.0, 86.0, 80.0, 74.0, 0.0, 10.0, 17.0, 30.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.636938935661068, "mean_inference_ms": 26.03094229871192, "mean_action_processing_ms": 0.726102211144532, "mean_env_wait_ms": 4.081304476521007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019691944122314453, "StateBufferConnector_ms": 0.012725830078125, "ViewRequirementAgentConnector_ms": 0.38650763034820557}, "num_episodes": 18, "episode_return_max": 315.0, "episode_return_min": -149.0, "episode_return_mean": 134.06, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 142.0023694631649, "num_env_steps_trained_throughput_per_sec": 142.0023694631649, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 27198.903, "restore_workers_time_ms": 0.02, "training_step_time_ms": 27198.835, "sample_time_ms": 4086.316, "learn_time_ms": 23073.965, "learn_throughput": 173.356, "synch_weights_time_ms": 32.4}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "45bed_00000", "date": "2024-08-13_02-48-59", "timestamp": 1723531739, "time_this_iter_s": 28.235371112823486, "time_total_s": 5925.400565624237, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33073f9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5925.400565624237, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 88.02564102564101, "ram_util_percent": 83.40769230769232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9944978288320637, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5021662240305904, "policy_loss": -0.0016303043268009942, "vf_loss": 2.5037965309682977, "vf_explained_var": 0.0005306124687194825, "kl": 0.004949621383698309, "entropy": 0.5514292108634161, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.26828272144, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.196903396031214, "policy_loss": -0.0009352638577135704, "vf_loss": 8.197838642483665, "vf_explained_var": 0.2751802821007986, "kl": 0.005078554837516176, "entropy": 0.9494960524102367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 371.0, "episode_reward_min": -149.0, "episode_reward_mean": 141.03, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -380.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": 39.235, "predator_policy": 31.28}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 70.0, 2.0, 1.0, 214.0, 174.0, 34.0, 147.0, 197.0, 22.0, 128.0, 93.0, 268.0, 208.0, 152.0, 107.0, 234.0, 0.0, 252.0, 63.0, 27.0, 33.0, 270.0, 69.0, 15.0, 278.0, 196.0, 58.0, 89.0, 0.0, 248.0, 272.0, 126.0, 139.0, 249.0, 189.0, 42.0, 171.0, 189.0, 76.0, 287.0, 135.0, -149.0, -13.0, 182.0, 177.0, 112.0, -60.0, 186.0, 279.0, 222.0, -34.0, 164.0, 42.0, 235.0, 13.0, 165.0, 253.0, 28.0, 112.0, 111.0, 308.0, 57.0, 235.0, 142.0, 313.0, 143.0, 2.0, 229.0, 106.0, 78.0, 221.0, 249.0, 17.0, 145.0, 120.0, 315.0, 238.0, 297.0, 57.0, -45.0, 208.0, 239.0, 199.0, 74.0, 371.0, 96.0, 235.0, 177.0, 213.0, 182.0, 91.0, 139.0, 3.0, 255.0, 311.0, 45.0, 262.0, 158.0, -51.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-7.0, 56.0, 0.0, 39.0, 98.0, -192.0, 24.0, -46.0, 136.0, 61.0, -4.0, 176.0, -40.0, -37.0, -6.0, 150.0, 60.0, 137.0, -84.0, -6.0, -2.0, 127.0, -6.0, -1.0, 97.0, 171.0, 121.0, 25.0, -181.0, 110.0, -4.0, 20.0, 63.0, 135.0, 0.0, 0.0, 150.0, 91.0, -26.0, 0.0, 0.0, -35.0, 31.0, -74.0, 143.0, 106.0, -233.0, 66.0, 66.0, -140.0, 148.0, 122.0, -121.0, 184.0, 38.0, 0.0, 0.0, 89.0, 0.0, 0.0, 141.0, -52.0, 95.0, 147.0, -16.0, 83.0, 0.0, 95.0, 76.0, 166.0, 113.0, 67.0, -3.0, -87.0, 114.0, -4.0, 81.0, 98.0, -104.0, 128.0, 103.0, 158.0, 135.0, 0.0, -276.0, -75.0, -43.0, 0.0, 7.0, 166.0, -49.0, 157.0, 61.0, 30.0, -8.0, -154.0, 141.0, -52.0, 64.0, 173.0, 112.0, -12.0, -68.0, 0.0, 164.0, 0.0, -72.0, -49.0, 142.0, 93.0, -70.0, -35.0, 42.0, 123.0, 186.0, 4.0, -103.0, -3.0, 0.0, 112.0, -58.0, 116.0, 151.0, 156.0, 74.0, -106.0, 119.0, 104.0, 102.0, -60.0, 179.0, 134.0, -18.0, 152.0, -289.0, 0.0, 56.0, 165.0, 106.0, 0.0, 113.0, -160.0, 155.0, -112.0, -107.0, 200.0, -4.0, -133.0, 155.0, -20.0, 50.0, 23.0, 187.0, 128.0, 145.0, 93.0, 142.0, 136.0, 0.0, -159.0, -160.0, -187.0, 151.0, 57.0, 69.0, 170.0, 97.0, 102.0, -380.0, 158.0, 175.0, 196.0, -1.0, 35.0, 30.0, 179.0, 122.0, 55.0, 71.0, 132.0, 154.0, 28.0, -110.0, 123.0, 57.0, 70.0, -264.0, 135.0, 61.0, 128.0, 103.0, 181.0, -78.0, 84.0, 131.0, 114.0, -4.0, 147.0, -355.0, 119.0], "policy_predator_policy_reward": [62.0, 9.0, 31.0, 0.0, 96.0, 0.0, 23.0, 0.0, 17.0, 0.0, 2.0, 0.0, 5.0, 106.0, 0.0, 3.0, 0.0, 0.0, 45.0, 67.0, 2.0, 1.0, 50.0, 50.0, 0.0, 0.0, 11.0, 51.0, 105.0, 118.0, 53.0, 38.0, 6.0, 30.0, 0.0, 0.0, 0.0, 11.0, 34.0, 55.0, 0.0, 62.0, 34.0, 42.0, 0.0, 21.0, 127.0, 109.0, 70.0, 19.0, 0.0, 8.0, 26.0, 107.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 77.0, 82.0, 30.0, 0.0, 0.0, 59.0, 29.0, 15.0, 0.0, 7.0, 0.0, 9.0, 90.0, 42.0, 0.0, 61.0, 10.0, 0.0, 0.0, 52.0, 10.0, 16.0, 0.0, 0.0, 64.0, 138.0, 0.0, 30.0, 0.0, 9.0, 44.0, 25.0, 21.0, 0.0, 4.0, 98.0, 52.0, 45.0, 42.0, 0.0, 57.0, 65.0, 0.0, 34.0, 0.0, 0.0, 79.0, 84.0, 0.0, 0.0, 48.0, 70.0, 0.0, 0.0, 18.0, 45.0, 13.0, 121.0, 0.0, 0.0, 29.0, 24.0, 0.0, 1.0, 36.0, 53.0, 4.0, 8.0, 16.0, 84.0, 0.0, 0.0, 0.0, 9.0, 142.0, 149.0, 8.0, 0.0, 0.0, 0.0, 7.0, 118.0, 104.0, 74.0, 70.0, 86.0, 80.0, 74.0, 0.0, 10.0, 17.0, 30.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 115.0, 101.0, 194.0, 108.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 122.0, 174.0, 0.0, 0.0, 0.0, 62.0, 0.0, 26.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 54.0, 24.0, 12.0, 0.0, 132.0, 0.0, 39.0, 27.0, 27.0, 0.0, 0.0, 39.0, 7.0, 10.0, 2.0, 13.0, 0.0, 185.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.569889798907898, "mean_inference_ms": 25.43903108047242, "mean_action_processing_ms": 0.7328769891050984, "mean_env_wait_ms": 4.352994625817279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01927769184112549, "StateBufferConnector_ms": 0.013643383979797363, "ViewRequirementAgentConnector_ms": 0.4267929792404175}, "num_episodes": 22, "episode_return_max": 371.0, "episode_return_min": -149.0, "episode_return_mean": 141.03, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 98.64695828869058, "num_env_steps_trained_throughput_per_sec": 98.64695828869058, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 28563.599, "restore_workers_time_ms": 0.02, "training_step_time_ms": 28563.529, "sample_time_ms": 4832.369, "learn_time_ms": 23687.24, "learn_throughput": 168.867, "synch_weights_time_ms": 37.386}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "45bed_00000", "date": "2024-08-13_02-49-40", "timestamp": 1723531780, "time_this_iter_s": 40.61107015609741, "time_total_s": 5966.0116357803345, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x330761430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5966.0116357803345, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 94.7157894736842, "ram_util_percent": 83.69298245614037}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1232119876556295, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.691715330043167, "policy_loss": -0.002678415404938201, "vf_loss": 3.6943937415168397, "vf_explained_var": -0.000253878636334939, "kl": 0.0043795487394421686, "entropy": 0.5503705786176459, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.330500014244564, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.85368143566071, "policy_loss": -0.0021853063492074847, "vf_loss": 7.855866754370392, "vf_explained_var": 0.34068656901203137, "kl": 0.004695095769145838, "entropy": 0.9667800142966881, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 371.0, "episode_reward_min": -360.0, "episode_reward_mean": 136.25, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 34.365, "predator_policy": 33.76}, "custom_metrics": {}, "hist_stats": {"episode_reward": [252.0, 63.0, 27.0, 33.0, 270.0, 69.0, 15.0, 278.0, 196.0, 58.0, 89.0, 0.0, 248.0, 272.0, 126.0, 139.0, 249.0, 189.0, 42.0, 171.0, 189.0, 76.0, 287.0, 135.0, -149.0, -13.0, 182.0, 177.0, 112.0, -60.0, 186.0, 279.0, 222.0, -34.0, 164.0, 42.0, 235.0, 13.0, 165.0, 253.0, 28.0, 112.0, 111.0, 308.0, 57.0, 235.0, 142.0, 313.0, 143.0, 2.0, 229.0, 106.0, 78.0, 221.0, 249.0, 17.0, 145.0, 120.0, 315.0, 238.0, 297.0, 57.0, -45.0, 208.0, 239.0, 199.0, 74.0, 371.0, 96.0, 235.0, 177.0, 213.0, 182.0, 91.0, 139.0, 3.0, 255.0, 311.0, 45.0, 262.0, 158.0, -51.0, 89.0, 14.0, 42.0, 100.0, 98.0, 170.0, -4.0, 91.0, 190.0, 215.0, 139.0, 135.0, 247.0, 132.0, 223.0, -360.0, 174.0, -2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [150.0, 91.0, -26.0, 0.0, 0.0, -35.0, 31.0, -74.0, 143.0, 106.0, -233.0, 66.0, 66.0, -140.0, 148.0, 122.0, -121.0, 184.0, 38.0, 0.0, 0.0, 89.0, 0.0, 0.0, 141.0, -52.0, 95.0, 147.0, -16.0, 83.0, 0.0, 95.0, 76.0, 166.0, 113.0, 67.0, -3.0, -87.0, 114.0, -4.0, 81.0, 98.0, -104.0, 128.0, 103.0, 158.0, 135.0, 0.0, -276.0, -75.0, -43.0, 0.0, 7.0, 166.0, -49.0, 157.0, 61.0, 30.0, -8.0, -154.0, 141.0, -52.0, 64.0, 173.0, 112.0, -12.0, -68.0, 0.0, 164.0, 0.0, -72.0, -49.0, 142.0, 93.0, -70.0, -35.0, 42.0, 123.0, 186.0, 4.0, -103.0, -3.0, 0.0, 112.0, -58.0, 116.0, 151.0, 156.0, 74.0, -106.0, 119.0, 104.0, 102.0, -60.0, 179.0, 134.0, -18.0, 152.0, -289.0, 0.0, 56.0, 165.0, 106.0, 0.0, 113.0, -160.0, 155.0, -112.0, -107.0, 200.0, -4.0, -133.0, 155.0, -20.0, 50.0, 23.0, 187.0, 128.0, 145.0, 93.0, 142.0, 136.0, 0.0, -159.0, -160.0, -187.0, 151.0, 57.0, 69.0, 170.0, 97.0, 102.0, -380.0, 158.0, 175.0, 196.0, -1.0, 35.0, 30.0, 179.0, 122.0, 55.0, 71.0, 132.0, 154.0, 28.0, -110.0, 123.0, 57.0, 70.0, -264.0, 135.0, 61.0, 128.0, 103.0, 181.0, -78.0, 84.0, 131.0, 114.0, -4.0, 147.0, -355.0, 119.0, 0.0, 38.0, -88.0, 58.0, 105.0, -195.0, 31.0, 69.0, -191.0, 148.0, -16.0, 124.0, 55.0, -118.0, -176.0, 179.0, 182.0, -86.0, 150.0, 49.0, 0.0, 139.0, 68.0, 30.0, 142.0, 82.0, 121.0, -127.0, 13.0, 153.0, -400.0, -320.0, 124.0, 46.0, -125.0, -48.0], "policy_predator_policy_reward": [0.0, 11.0, 34.0, 55.0, 0.0, 62.0, 34.0, 42.0, 0.0, 21.0, 127.0, 109.0, 70.0, 19.0, 0.0, 8.0, 26.0, 107.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 77.0, 82.0, 30.0, 0.0, 0.0, 59.0, 29.0, 15.0, 0.0, 7.0, 0.0, 9.0, 90.0, 42.0, 0.0, 61.0, 10.0, 0.0, 0.0, 52.0, 10.0, 16.0, 0.0, 0.0, 64.0, 138.0, 0.0, 30.0, 0.0, 9.0, 44.0, 25.0, 21.0, 0.0, 4.0, 98.0, 52.0, 45.0, 42.0, 0.0, 57.0, 65.0, 0.0, 34.0, 0.0, 0.0, 79.0, 84.0, 0.0, 0.0, 48.0, 70.0, 0.0, 0.0, 18.0, 45.0, 13.0, 121.0, 0.0, 0.0, 29.0, 24.0, 0.0, 1.0, 36.0, 53.0, 4.0, 8.0, 16.0, 84.0, 0.0, 0.0, 0.0, 9.0, 142.0, 149.0, 8.0, 0.0, 0.0, 0.0, 7.0, 118.0, 104.0, 74.0, 70.0, 86.0, 80.0, 74.0, 0.0, 10.0, 17.0, 30.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 115.0, 101.0, 194.0, 108.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 122.0, 174.0, 0.0, 0.0, 0.0, 62.0, 0.0, 26.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 54.0, 24.0, 12.0, 0.0, 132.0, 0.0, 39.0, 27.0, 27.0, 0.0, 0.0, 39.0, 7.0, 10.0, 2.0, 13.0, 0.0, 185.0, 51.0, 0.0, 0.0, 44.0, 110.0, 22.0, 0.0, 0.0, 126.0, 15.0, 0.0, 62.0, 59.0, 0.0, 0.0, 88.0, 0.0, 94.0, 0.0, 16.0, 0.0, 0.0, 6.0, 31.0, 23.0, 0.0, 109.0, 29.0, 0.0, 57.0, 160.0, 200.0, 0.0, 4.0, 76.0, 95.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.503284260852608, "mean_inference_ms": 25.55296948765039, "mean_action_processing_ms": 0.7386122791557458, "mean_env_wait_ms": 3.990822534429997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011318445205688477, "StateBufferConnector_ms": 0.013591885566711426, "ViewRequirementAgentConnector_ms": 0.40179550647735596}, "num_episodes": 18, "episode_return_max": 371.0, "episode_return_min": -360.0, "episode_return_mean": 136.25, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.36655719459227, "num_env_steps_trained_throughput_per_sec": 152.36655719459227, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 28577.592, "restore_workers_time_ms": 0.02, "training_step_time_ms": 28577.521, "sample_time_ms": 4827.232, "learn_time_ms": 23705.647, "learn_throughput": 168.736, "synch_weights_time_ms": 37.291}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "45bed_00000", "date": "2024-08-13_02-50-06", "timestamp": 1723531806, "time_this_iter_s": 26.310845851898193, "time_total_s": 5992.322481632233, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3306d0280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5992.322481632233, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 86.98108108108109, "ram_util_percent": 83.41621621621621}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0172683891165193, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.743839371898187, "policy_loss": -0.0007333712245795934, "vf_loss": 3.744572744798408, "vf_explained_var": 0.0005314542187584772, "kl": 0.004152578824537093, "entropy": 0.5170343875096588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.800952465855886, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.794540516535441, "policy_loss": -0.00015142051559730024, "vf_loss": 6.7946919433654305, "vf_explained_var": 0.3196170161010096, "kl": 0.0022946680475298613, "entropy": 1.0042980423995427, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 371.0, "episode_reward_min": -360.0, "episode_reward_mean": 126.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 26.81, "predator_policy": 36.67}, "custom_metrics": {}, "hist_stats": {"episode_reward": [135.0, -149.0, -13.0, 182.0, 177.0, 112.0, -60.0, 186.0, 279.0, 222.0, -34.0, 164.0, 42.0, 235.0, 13.0, 165.0, 253.0, 28.0, 112.0, 111.0, 308.0, 57.0, 235.0, 142.0, 313.0, 143.0, 2.0, 229.0, 106.0, 78.0, 221.0, 249.0, 17.0, 145.0, 120.0, 315.0, 238.0, 297.0, 57.0, -45.0, 208.0, 239.0, 199.0, 74.0, 371.0, 96.0, 235.0, 177.0, 213.0, 182.0, 91.0, 139.0, 3.0, 255.0, 311.0, 45.0, 262.0, 158.0, -51.0, 89.0, 14.0, 42.0, 100.0, 98.0, 170.0, -4.0, 91.0, 190.0, 215.0, 139.0, 135.0, 247.0, 132.0, 223.0, -360.0, 174.0, -2.0, 137.0, 0.0, -145.0, -83.0, -137.0, 220.0, -347.0, 216.0, 154.0, 162.0, 250.0, 305.0, 110.0, 228.0, 196.0, 37.0, 233.0, 231.0, -45.0, -21.0, 277.0, 300.0, 131.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [135.0, 0.0, -276.0, -75.0, -43.0, 0.0, 7.0, 166.0, -49.0, 157.0, 61.0, 30.0, -8.0, -154.0, 141.0, -52.0, 64.0, 173.0, 112.0, -12.0, -68.0, 0.0, 164.0, 0.0, -72.0, -49.0, 142.0, 93.0, -70.0, -35.0, 42.0, 123.0, 186.0, 4.0, -103.0, -3.0, 0.0, 112.0, -58.0, 116.0, 151.0, 156.0, 74.0, -106.0, 119.0, 104.0, 102.0, -60.0, 179.0, 134.0, -18.0, 152.0, -289.0, 0.0, 56.0, 165.0, 106.0, 0.0, 113.0, -160.0, 155.0, -112.0, -107.0, 200.0, -4.0, -133.0, 155.0, -20.0, 50.0, 23.0, 187.0, 128.0, 145.0, 93.0, 142.0, 136.0, 0.0, -159.0, -160.0, -187.0, 151.0, 57.0, 69.0, 170.0, 97.0, 102.0, -380.0, 158.0, 175.0, 196.0, -1.0, 35.0, 30.0, 179.0, 122.0, 55.0, 71.0, 132.0, 154.0, 28.0, -110.0, 123.0, 57.0, 70.0, -264.0, 135.0, 61.0, 128.0, 103.0, 181.0, -78.0, 84.0, 131.0, 114.0, -4.0, 147.0, -355.0, 119.0, 0.0, 38.0, -88.0, 58.0, 105.0, -195.0, 31.0, 69.0, -191.0, 148.0, -16.0, 124.0, 55.0, -118.0, -176.0, 179.0, 182.0, -86.0, 150.0, 49.0, 0.0, 139.0, 68.0, 30.0, 142.0, 82.0, 121.0, -127.0, 13.0, 153.0, -400.0, -320.0, 124.0, 46.0, -125.0, -48.0, 8.0, 122.0, 0.0, 0.0, -328.0, -2.0, 91.0, -348.0, -77.0, -294.0, 190.0, -35.0, -300.0, -246.0, -44.0, 180.0, -34.0, 163.0, 0.0, 162.0, 71.0, 169.0, 134.0, 170.0, -122.0, 84.0, 197.0, 30.0, 67.0, 129.0, -362.0, 141.0, 191.0, -19.0, 99.0, 72.0, -256.0, 0.0, -296.0, 119.0, 102.0, 166.0, 94.0, 175.0, 0.0, 130.0], "policy_predator_policy_reward": [0.0, 0.0, 64.0, 138.0, 0.0, 30.0, 0.0, 9.0, 44.0, 25.0, 21.0, 0.0, 4.0, 98.0, 52.0, 45.0, 42.0, 0.0, 57.0, 65.0, 0.0, 34.0, 0.0, 0.0, 79.0, 84.0, 0.0, 0.0, 48.0, 70.0, 0.0, 0.0, 18.0, 45.0, 13.0, 121.0, 0.0, 0.0, 29.0, 24.0, 0.0, 1.0, 36.0, 53.0, 4.0, 8.0, 16.0, 84.0, 0.0, 0.0, 0.0, 9.0, 142.0, 149.0, 8.0, 0.0, 0.0, 0.0, 7.0, 118.0, 104.0, 74.0, 70.0, 86.0, 80.0, 74.0, 0.0, 10.0, 17.0, 30.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 115.0, 101.0, 194.0, 108.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 122.0, 174.0, 0.0, 0.0, 0.0, 62.0, 0.0, 26.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 54.0, 24.0, 12.0, 0.0, 132.0, 0.0, 39.0, 27.0, 27.0, 0.0, 0.0, 39.0, 7.0, 10.0, 2.0, 13.0, 0.0, 185.0, 51.0, 0.0, 0.0, 44.0, 110.0, 22.0, 0.0, 0.0, 126.0, 15.0, 0.0, 62.0, 59.0, 0.0, 0.0, 88.0, 0.0, 94.0, 0.0, 16.0, 0.0, 0.0, 6.0, 31.0, 23.0, 0.0, 109.0, 29.0, 0.0, 57.0, 160.0, 200.0, 0.0, 4.0, 76.0, 95.0, 7.0, 0.0, 0.0, 0.0, 160.0, 25.0, 174.0, 0.0, 156.0, 78.0, 0.0, 65.0, 193.0, 6.0, 45.0, 35.0, 17.0, 8.0, 0.0, 0.0, 0.0, 10.0, 0.0, 1.0, 78.0, 70.0, 1.0, 0.0, 0.0, 0.0, 181.0, 77.0, 61.0, 0.0, 0.0, 60.0, 139.0, 72.0, 136.0, 20.0, 0.0, 9.0, 31.0, 0.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.399893839667623, "mean_inference_ms": 25.28968803172326, "mean_action_processing_ms": 0.7446332973301886, "mean_env_wait_ms": 3.9559240664910273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00944530963897705, "StateBufferConnector_ms": 0.01333773136138916, "ViewRequirementAgentConnector_ms": 0.4153614044189453}, "num_episodes": 23, "episode_return_max": 371.0, "episode_return_min": -360.0, "episode_return_mean": 126.96, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 145.1832329085073, "num_env_steps_trained_throughput_per_sec": 145.1832329085073, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 28831.542, "restore_workers_time_ms": 0.02, "training_step_time_ms": 28831.471, "sample_time_ms": 4896.781, "learn_time_ms": 23890.351, "learn_throughput": 167.432, "synch_weights_time_ms": 37.672}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "45bed_00000", "date": "2024-08-13_02-50-34", "timestamp": 1723531834, "time_this_iter_s": 27.637041091918945, "time_total_s": 6019.959522724152, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3307610d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6019.959522724152, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 87.14358974358976, "ram_util_percent": 83.54102564102564}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9874518262488502, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.121151566316211, "policy_loss": -0.0012396535703114101, "vf_loss": 3.1223912196184593, "vf_explained_var": -0.0004130503487965417, "kl": 0.00272400842132448, "entropy": 0.4715839222467766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.46307877299016, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.043881553064579, "policy_loss": -0.0025882045819704967, "vf_loss": 7.046469747704804, "vf_explained_var": 0.2115064216353906, "kl": 0.0038009606098626776, "entropy": 0.9797065955305856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 371.0, "episode_reward_min": -360.0, "episode_reward_mean": 137.75, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 32.72, "predator_policy": 36.155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [112.0, 111.0, 308.0, 57.0, 235.0, 142.0, 313.0, 143.0, 2.0, 229.0, 106.0, 78.0, 221.0, 249.0, 17.0, 145.0, 120.0, 315.0, 238.0, 297.0, 57.0, -45.0, 208.0, 239.0, 199.0, 74.0, 371.0, 96.0, 235.0, 177.0, 213.0, 182.0, 91.0, 139.0, 3.0, 255.0, 311.0, 45.0, 262.0, 158.0, -51.0, 89.0, 14.0, 42.0, 100.0, 98.0, 170.0, -4.0, 91.0, 190.0, 215.0, 139.0, 135.0, 247.0, 132.0, 223.0, -360.0, 174.0, -2.0, 137.0, 0.0, -145.0, -83.0, -137.0, 220.0, -347.0, 216.0, 154.0, 162.0, 250.0, 305.0, 110.0, 228.0, 196.0, 37.0, 233.0, 231.0, -45.0, -21.0, 277.0, 300.0, 131.0, 269.0, 286.0, 291.0, 151.0, 250.0, 6.0, 177.0, -100.0, 346.0, -15.0, 128.0, 151.0, 301.0, 177.0, 194.0, 173.0, 34.0, 197.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 112.0, -58.0, 116.0, 151.0, 156.0, 74.0, -106.0, 119.0, 104.0, 102.0, -60.0, 179.0, 134.0, -18.0, 152.0, -289.0, 0.0, 56.0, 165.0, 106.0, 0.0, 113.0, -160.0, 155.0, -112.0, -107.0, 200.0, -4.0, -133.0, 155.0, -20.0, 50.0, 23.0, 187.0, 128.0, 145.0, 93.0, 142.0, 136.0, 0.0, -159.0, -160.0, -187.0, 151.0, 57.0, 69.0, 170.0, 97.0, 102.0, -380.0, 158.0, 175.0, 196.0, -1.0, 35.0, 30.0, 179.0, 122.0, 55.0, 71.0, 132.0, 154.0, 28.0, -110.0, 123.0, 57.0, 70.0, -264.0, 135.0, 61.0, 128.0, 103.0, 181.0, -78.0, 84.0, 131.0, 114.0, -4.0, 147.0, -355.0, 119.0, 0.0, 38.0, -88.0, 58.0, 105.0, -195.0, 31.0, 69.0, -191.0, 148.0, -16.0, 124.0, 55.0, -118.0, -176.0, 179.0, 182.0, -86.0, 150.0, 49.0, 0.0, 139.0, 68.0, 30.0, 142.0, 82.0, 121.0, -127.0, 13.0, 153.0, -400.0, -320.0, 124.0, 46.0, -125.0, -48.0, 8.0, 122.0, 0.0, 0.0, -328.0, -2.0, 91.0, -348.0, -77.0, -294.0, 190.0, -35.0, -300.0, -246.0, -44.0, 180.0, -34.0, 163.0, 0.0, 162.0, 71.0, 169.0, 134.0, 170.0, -122.0, 84.0, 197.0, 30.0, 67.0, 129.0, -362.0, 141.0, 191.0, -19.0, 99.0, 72.0, -256.0, 0.0, -296.0, 119.0, 102.0, 166.0, 94.0, 175.0, 0.0, 130.0, 141.0, 110.0, 114.0, 172.0, 148.0, 133.0, -6.0, 154.0, -53.0, 146.0, -364.0, 182.0, 0.0, 173.0, -317.0, -38.0, 154.0, 188.0, 0.0, -354.0, 132.0, -8.0, 103.0, 48.0, 190.0, 111.0, -4.0, 179.0, 198.0, -8.0, 68.0, 68.0, -72.0, 28.0, 197.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 29.0, 24.0, 0.0, 1.0, 36.0, 53.0, 4.0, 8.0, 16.0, 84.0, 0.0, 0.0, 0.0, 9.0, 142.0, 149.0, 8.0, 0.0, 0.0, 0.0, 7.0, 118.0, 104.0, 74.0, 70.0, 86.0, 80.0, 74.0, 0.0, 10.0, 17.0, 30.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 115.0, 101.0, 194.0, 108.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 122.0, 174.0, 0.0, 0.0, 0.0, 62.0, 0.0, 26.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 54.0, 24.0, 12.0, 0.0, 132.0, 0.0, 39.0, 27.0, 27.0, 0.0, 0.0, 39.0, 7.0, 10.0, 2.0, 13.0, 0.0, 185.0, 51.0, 0.0, 0.0, 44.0, 110.0, 22.0, 0.0, 0.0, 126.0, 15.0, 0.0, 62.0, 59.0, 0.0, 0.0, 88.0, 0.0, 94.0, 0.0, 16.0, 0.0, 0.0, 6.0, 31.0, 23.0, 0.0, 109.0, 29.0, 0.0, 57.0, 160.0, 200.0, 0.0, 4.0, 76.0, 95.0, 7.0, 0.0, 0.0, 0.0, 160.0, 25.0, 174.0, 0.0, 156.0, 78.0, 0.0, 65.0, 193.0, 6.0, 45.0, 35.0, 17.0, 8.0, 0.0, 0.0, 0.0, 10.0, 0.0, 1.0, 78.0, 70.0, 1.0, 0.0, 0.0, 0.0, 181.0, 77.0, 61.0, 0.0, 0.0, 60.0, 139.0, 72.0, 136.0, 20.0, 0.0, 9.0, 31.0, 0.0, 0.0, 1.0, 11.0, 7.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 78.0, 79.0, 188.0, 0.0, 4.0, 0.0, 146.0, 109.0, 4.0, 0.0, 176.0, 163.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 4.0, 8.0, 29.0, 51.0, 27.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.332541334139783, "mean_inference_ms": 25.076927396940686, "mean_action_processing_ms": 0.7487237825460474, "mean_env_wait_ms": 3.919951164423079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009480714797973633, "StateBufferConnector_ms": 0.007711172103881836, "ViewRequirementAgentConnector_ms": 0.3704341650009155}, "num_episodes": 18, "episode_return_max": 371.0, "episode_return_min": -360.0, "episode_return_mean": 137.75, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 144.86178113007605, "num_env_steps_trained_throughput_per_sec": 144.86178113007605, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 29055.12, "restore_workers_time_ms": 0.021, "training_step_time_ms": 29055.048, "sample_time_ms": 4891.986, "learn_time_ms": 24118.565, "learn_throughput": 165.847, "synch_weights_time_ms": 37.539}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "45bed_00000", "date": "2024-08-13_02-51-02", "timestamp": 1723531862, "time_this_iter_s": 27.68040704727173, "time_total_s": 6047.639929771423, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33073f4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6047.639929771423, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 87.33589743589745, "ram_util_percent": 83.60769230769232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0612129485599262, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.539911650097559, "policy_loss": -0.0028903028395559104, "vf_loss": 4.5428019392427315, "vf_explained_var": -0.0006142704890518592, "kl": 0.005643387471775794, "entropy": 0.45695724884668987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.37778449736575, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.852009423069222, "policy_loss": -0.0014482112796040912, "vf_loss": 7.85345763933091, "vf_explained_var": 0.24932036585908718, "kl": 0.0035830774859712026, "entropy": 0.9888269092355456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 371.0, "episode_reward_min": -360.0, "episode_reward_mean": 125.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 20.675, "predator_policy": 41.965}, "custom_metrics": {}, "hist_stats": {"episode_reward": [208.0, 239.0, 199.0, 74.0, 371.0, 96.0, 235.0, 177.0, 213.0, 182.0, 91.0, 139.0, 3.0, 255.0, 311.0, 45.0, 262.0, 158.0, -51.0, 89.0, 14.0, 42.0, 100.0, 98.0, 170.0, -4.0, 91.0, 190.0, 215.0, 139.0, 135.0, 247.0, 132.0, 223.0, -360.0, 174.0, -2.0, 137.0, 0.0, -145.0, -83.0, -137.0, 220.0, -347.0, 216.0, 154.0, 162.0, 250.0, 305.0, 110.0, 228.0, 196.0, 37.0, 233.0, 231.0, -45.0, -21.0, 277.0, 300.0, 131.0, 269.0, 286.0, 291.0, 151.0, 250.0, 6.0, 177.0, -100.0, 346.0, -15.0, 128.0, 151.0, 301.0, 177.0, 194.0, 173.0, 34.0, 197.0, 77.0, 41.0, 149.0, 167.0, 43.0, 355.0, -13.0, -52.0, 139.0, 115.0, 152.0, 23.0, 231.0, 77.0, 96.0, 309.0, 238.0, 31.0, -105.0, -130.0, 169.0, 91.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [151.0, 57.0, 69.0, 170.0, 97.0, 102.0, -380.0, 158.0, 175.0, 196.0, -1.0, 35.0, 30.0, 179.0, 122.0, 55.0, 71.0, 132.0, 154.0, 28.0, -110.0, 123.0, 57.0, 70.0, -264.0, 135.0, 61.0, 128.0, 103.0, 181.0, -78.0, 84.0, 131.0, 114.0, -4.0, 147.0, -355.0, 119.0, 0.0, 38.0, -88.0, 58.0, 105.0, -195.0, 31.0, 69.0, -191.0, 148.0, -16.0, 124.0, 55.0, -118.0, -176.0, 179.0, 182.0, -86.0, 150.0, 49.0, 0.0, 139.0, 68.0, 30.0, 142.0, 82.0, 121.0, -127.0, 13.0, 153.0, -400.0, -320.0, 124.0, 46.0, -125.0, -48.0, 8.0, 122.0, 0.0, 0.0, -328.0, -2.0, 91.0, -348.0, -77.0, -294.0, 190.0, -35.0, -300.0, -246.0, -44.0, 180.0, -34.0, 163.0, 0.0, 162.0, 71.0, 169.0, 134.0, 170.0, -122.0, 84.0, 197.0, 30.0, 67.0, 129.0, -362.0, 141.0, 191.0, -19.0, 99.0, 72.0, -256.0, 0.0, -296.0, 119.0, 102.0, 166.0, 94.0, 175.0, 0.0, 130.0, 141.0, 110.0, 114.0, 172.0, 148.0, 133.0, -6.0, 154.0, -53.0, 146.0, -364.0, 182.0, 0.0, 173.0, -317.0, -38.0, 154.0, 188.0, 0.0, -354.0, 132.0, -8.0, 103.0, 48.0, 190.0, 111.0, -4.0, 179.0, 198.0, -8.0, 68.0, 68.0, -72.0, 28.0, 197.0, 0.0, 163.0, -174.0, -320.0, 47.0, 59.0, 43.0, 91.0, 76.0, 165.0, -244.0, 175.0, 180.0, -238.0, -8.0, -162.0, -132.0, 0.0, 139.0, -141.0, -17.0, 137.0, -4.0, 23.0, 0.0, 200.0, -179.0, -70.0, 22.0, 108.0, -26.0, 123.0, 186.0, 142.0, 53.0, 37.0, -236.0, -114.0, -186.0, -294.0, -211.0, 133.0, -160.0, 129.0, -244.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 122.0, 174.0, 0.0, 0.0, 0.0, 62.0, 0.0, 26.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 54.0, 24.0, 12.0, 0.0, 132.0, 0.0, 39.0, 27.0, 27.0, 0.0, 0.0, 39.0, 7.0, 10.0, 2.0, 13.0, 0.0, 185.0, 51.0, 0.0, 0.0, 44.0, 110.0, 22.0, 0.0, 0.0, 126.0, 15.0, 0.0, 62.0, 59.0, 0.0, 0.0, 88.0, 0.0, 94.0, 0.0, 16.0, 0.0, 0.0, 6.0, 31.0, 23.0, 0.0, 109.0, 29.0, 0.0, 57.0, 160.0, 200.0, 0.0, 4.0, 76.0, 95.0, 7.0, 0.0, 0.0, 0.0, 160.0, 25.0, 174.0, 0.0, 156.0, 78.0, 0.0, 65.0, 193.0, 6.0, 45.0, 35.0, 17.0, 8.0, 0.0, 0.0, 0.0, 10.0, 0.0, 1.0, 78.0, 70.0, 1.0, 0.0, 0.0, 0.0, 181.0, 77.0, 61.0, 0.0, 0.0, 60.0, 139.0, 72.0, 136.0, 20.0, 0.0, 9.0, 31.0, 0.0, 0.0, 1.0, 11.0, 7.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 78.0, 79.0, 188.0, 0.0, 4.0, 0.0, 146.0, 109.0, 4.0, 0.0, 176.0, 163.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 4.0, 8.0, 29.0, 51.0, 27.0, 0.0, 0.0, 87.0, 1.0, 152.0, 162.0, 31.0, 16.0, 0.0, 0.0, 0.0, 122.0, 0.0, 0.0, 112.0, 121.0, 126.0, 116.0, 0.0, 0.0, 121.0, 152.0, 17.0, 2.0, 0.0, 0.0, 100.0, 110.0, 87.0, 38.0, 1.0, 13.0, 0.0, 0.0, 0.0, 43.0, 103.0, 127.0, 135.0, 60.0, 191.0, 184.0, 98.0, 98.0, 86.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.26495976432789, "mean_inference_ms": 24.512334718742277, "mean_action_processing_ms": 0.752320549416352, "mean_env_wait_ms": 4.177522408764535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00938105583190918, "StateBufferConnector_ms": 0.0076715946197509766, "ViewRequirementAgentConnector_ms": 0.31620240211486816}, "num_episodes": 22, "episode_return_max": 371.0, "episode_return_min": -360.0, "episode_return_mean": 125.28, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 143.55851310446366, "num_env_steps_trained_throughput_per_sec": 143.55851310446366, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 29360.319, "restore_workers_time_ms": 0.021, "training_step_time_ms": 29360.244, "sample_time_ms": 4906.363, "learn_time_ms": 24410.27, "learn_throughput": 163.865, "synch_weights_time_ms": 37.165}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "45bed_00000", "date": "2024-08-13_02-51-30", "timestamp": 1723531890, "time_this_iter_s": 27.937093019485474, "time_total_s": 6075.577022790909, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44f6700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6075.577022790909, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 87.19487179487179, "ram_util_percent": 83.46153846153845}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1393383888025133, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.026081305206137, "policy_loss": -0.001816542011503347, "vf_loss": 4.027897842725118, "vf_explained_var": -0.0008881294222735854, "kl": 0.003823970126753213, "entropy": 0.4888711560340155, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.18224812342376, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.08648320783383, "policy_loss": -0.002321176982617804, "vf_loss": 8.088804400661004, "vf_explained_var": 0.20271653655975583, "kl": 0.0063516860150291225, "entropy": 1.1141184396844692, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 355.0, "episode_reward_min": -360.0, "episode_reward_mean": 108.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 5.78, "predator_policy": 48.295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.0, 89.0, 14.0, 42.0, 100.0, 98.0, 170.0, -4.0, 91.0, 190.0, 215.0, 139.0, 135.0, 247.0, 132.0, 223.0, -360.0, 174.0, -2.0, 137.0, 0.0, -145.0, -83.0, -137.0, 220.0, -347.0, 216.0, 154.0, 162.0, 250.0, 305.0, 110.0, 228.0, 196.0, 37.0, 233.0, 231.0, -45.0, -21.0, 277.0, 300.0, 131.0, 269.0, 286.0, 291.0, 151.0, 250.0, 6.0, 177.0, -100.0, 346.0, -15.0, 128.0, 151.0, 301.0, 177.0, 194.0, 173.0, 34.0, 197.0, 77.0, 41.0, 149.0, 167.0, 43.0, 355.0, -13.0, -52.0, 139.0, 115.0, 152.0, 23.0, 231.0, 77.0, 96.0, 309.0, 238.0, 31.0, -105.0, -130.0, 169.0, 91.0, 168.0, -8.0, 205.0, 155.0, 47.0, 28.0, 308.0, 63.0, 80.0, -83.0, 84.0, -65.0, 229.0, 45.0, 277.0, -2.0, -12.0, 26.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-355.0, 119.0, 0.0, 38.0, -88.0, 58.0, 105.0, -195.0, 31.0, 69.0, -191.0, 148.0, -16.0, 124.0, 55.0, -118.0, -176.0, 179.0, 182.0, -86.0, 150.0, 49.0, 0.0, 139.0, 68.0, 30.0, 142.0, 82.0, 121.0, -127.0, 13.0, 153.0, -400.0, -320.0, 124.0, 46.0, -125.0, -48.0, 8.0, 122.0, 0.0, 0.0, -328.0, -2.0, 91.0, -348.0, -77.0, -294.0, 190.0, -35.0, -300.0, -246.0, -44.0, 180.0, -34.0, 163.0, 0.0, 162.0, 71.0, 169.0, 134.0, 170.0, -122.0, 84.0, 197.0, 30.0, 67.0, 129.0, -362.0, 141.0, 191.0, -19.0, 99.0, 72.0, -256.0, 0.0, -296.0, 119.0, 102.0, 166.0, 94.0, 175.0, 0.0, 130.0, 141.0, 110.0, 114.0, 172.0, 148.0, 133.0, -6.0, 154.0, -53.0, 146.0, -364.0, 182.0, 0.0, 173.0, -317.0, -38.0, 154.0, 188.0, 0.0, -354.0, 132.0, -8.0, 103.0, 48.0, 190.0, 111.0, -4.0, 179.0, 198.0, -8.0, 68.0, 68.0, -72.0, 28.0, 197.0, 0.0, 163.0, -174.0, -320.0, 47.0, 59.0, 43.0, 91.0, 76.0, 165.0, -244.0, 175.0, 180.0, -238.0, -8.0, -162.0, -132.0, 0.0, 139.0, -141.0, -17.0, 137.0, -4.0, 23.0, 0.0, 200.0, -179.0, -70.0, 22.0, 108.0, -26.0, 123.0, 186.0, 142.0, 53.0, 37.0, -236.0, -114.0, -186.0, -294.0, -211.0, 133.0, -160.0, 129.0, -244.0, 71.0, 72.0, 16.0, -226.0, 59.0, 107.0, 180.0, -110.0, -223.0, 95.0, -121.0, 7.0, 126.0, 173.0, 62.0, 0.0, -87.0, 0.0, -157.0, -144.0, -160.0, 77.0, -204.0, -32.0, 163.0, 66.0, 0.0, -120.0, 59.0, 169.0, -198.0, 76.0, 0.0, -272.0, -82.0, 57.0], "policy_predator_policy_reward": [0.0, 185.0, 51.0, 0.0, 0.0, 44.0, 110.0, 22.0, 0.0, 0.0, 126.0, 15.0, 0.0, 62.0, 59.0, 0.0, 0.0, 88.0, 0.0, 94.0, 0.0, 16.0, 0.0, 0.0, 6.0, 31.0, 23.0, 0.0, 109.0, 29.0, 0.0, 57.0, 160.0, 200.0, 0.0, 4.0, 76.0, 95.0, 7.0, 0.0, 0.0, 0.0, 160.0, 25.0, 174.0, 0.0, 156.0, 78.0, 0.0, 65.0, 193.0, 6.0, 45.0, 35.0, 17.0, 8.0, 0.0, 0.0, 0.0, 10.0, 0.0, 1.0, 78.0, 70.0, 1.0, 0.0, 0.0, 0.0, 181.0, 77.0, 61.0, 0.0, 0.0, 60.0, 139.0, 72.0, 136.0, 20.0, 0.0, 9.0, 31.0, 0.0, 0.0, 1.0, 11.0, 7.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 78.0, 79.0, 188.0, 0.0, 4.0, 0.0, 146.0, 109.0, 4.0, 0.0, 176.0, 163.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 4.0, 8.0, 29.0, 51.0, 27.0, 0.0, 0.0, 87.0, 1.0, 152.0, 162.0, 31.0, 16.0, 0.0, 0.0, 0.0, 122.0, 0.0, 0.0, 112.0, 121.0, 126.0, 116.0, 0.0, 0.0, 121.0, 152.0, 17.0, 2.0, 0.0, 0.0, 100.0, 110.0, 87.0, 38.0, 1.0, 13.0, 0.0, 0.0, 0.0, 43.0, 103.0, 127.0, 135.0, 60.0, 191.0, 184.0, 98.0, 98.0, 86.0, 120.0, 25.0, 0.0, 131.0, 71.0, 8.0, 31.0, 41.0, 44.0, 88.0, 87.0, 85.0, 57.0, 9.0, 0.0, 1.0, 0.0, 87.0, 80.0, 103.0, 115.0, 92.0, 75.0, 102.0, 69.0, 0.0, 0.0, 69.0, 96.0, 42.0, 7.0, 99.0, 21.0, 130.0, 130.0, 51.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.190226077403985, "mean_inference_ms": 24.590495393517358, "mean_action_processing_ms": 0.7514650327582095, "mean_env_wait_ms": 3.8311724805833887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010691285133361816, "StateBufferConnector_ms": 0.007071375846862793, "ViewRequirementAgentConnector_ms": 0.2895582914352417}, "num_episodes": 18, "episode_return_max": 355.0, "episode_return_min": -360.0, "episode_return_mean": 108.15, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 144.54304476860983, "num_env_steps_trained_throughput_per_sec": 144.54304476860983, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 29653.584, "restore_workers_time_ms": 0.021, "training_step_time_ms": 29653.504, "sample_time_ms": 4917.946, "learn_time_ms": 24691.0, "learn_throughput": 162.002, "synch_weights_time_ms": 37.825}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "45bed_00000", "date": "2024-08-13_02-51-58", "timestamp": 1723531918, "time_this_iter_s": 27.741153240203857, "time_total_s": 6103.318176031113, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3306a4940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6103.318176031113, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 86.72564102564102, "ram_util_percent": 83.44358974358974}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9943597164616067, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.671694493546057, "policy_loss": -0.0020600444398248797, "vf_loss": 2.6737545362856023, "vf_explained_var": -0.0011360508108895922, "kl": 0.0022959292511831025, "entropy": 0.43361600221149504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.721216976957976, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.622463112533408, "policy_loss": -0.003351140927730335, "vf_loss": 8.62581426151215, "vf_explained_var": 0.30214565144014105, "kl": 0.007609999340179904, "entropy": 1.1726492222654756, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 355.0, "episode_reward_min": -347.0, "episode_reward_mean": 122.57, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -364.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 193.0}, "policy_reward_mean": {"prey_policy": 15.66, "predator_policy": 45.625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-137.0, 220.0, -347.0, 216.0, 154.0, 162.0, 250.0, 305.0, 110.0, 228.0, 196.0, 37.0, 233.0, 231.0, -45.0, -21.0, 277.0, 300.0, 131.0, 269.0, 286.0, 291.0, 151.0, 250.0, 6.0, 177.0, -100.0, 346.0, -15.0, 128.0, 151.0, 301.0, 177.0, 194.0, 173.0, 34.0, 197.0, 77.0, 41.0, 149.0, 167.0, 43.0, 355.0, -13.0, -52.0, 139.0, 115.0, 152.0, 23.0, 231.0, 77.0, 96.0, 309.0, 238.0, 31.0, -105.0, -130.0, 169.0, 91.0, 168.0, -8.0, 205.0, 155.0, 47.0, 28.0, 308.0, 63.0, 80.0, -83.0, 84.0, -65.0, 229.0, 45.0, 277.0, -2.0, -12.0, 26.0, 206.0, 0.0, 263.0, 101.0, 129.0, 163.0, 184.0, 201.0, 234.0, 76.0, 233.0, 159.0, -63.0, 297.0, 45.0, 65.0, 234.0, 112.0, 52.0, 16.0, 13.0, 186.0, 87.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-77.0, -294.0, 190.0, -35.0, -300.0, -246.0, -44.0, 180.0, -34.0, 163.0, 0.0, 162.0, 71.0, 169.0, 134.0, 170.0, -122.0, 84.0, 197.0, 30.0, 67.0, 129.0, -362.0, 141.0, 191.0, -19.0, 99.0, 72.0, -256.0, 0.0, -296.0, 119.0, 102.0, 166.0, 94.0, 175.0, 0.0, 130.0, 141.0, 110.0, 114.0, 172.0, 148.0, 133.0, -6.0, 154.0, -53.0, 146.0, -364.0, 182.0, 0.0, 173.0, -317.0, -38.0, 154.0, 188.0, 0.0, -354.0, 132.0, -8.0, 103.0, 48.0, 190.0, 111.0, -4.0, 179.0, 198.0, -8.0, 68.0, 68.0, -72.0, 28.0, 197.0, 0.0, 163.0, -174.0, -320.0, 47.0, 59.0, 43.0, 91.0, 76.0, 165.0, -244.0, 175.0, 180.0, -238.0, -8.0, -162.0, -132.0, 0.0, 139.0, -141.0, -17.0, 137.0, -4.0, 23.0, 0.0, 200.0, -179.0, -70.0, 22.0, 108.0, -26.0, 123.0, 186.0, 142.0, 53.0, 37.0, -236.0, -114.0, -186.0, -294.0, -211.0, 133.0, -160.0, 129.0, -244.0, 71.0, 72.0, 16.0, -226.0, 59.0, 107.0, 180.0, -110.0, -223.0, 95.0, -121.0, 7.0, 126.0, 173.0, 62.0, 0.0, -87.0, 0.0, -157.0, -144.0, -160.0, 77.0, -204.0, -32.0, 163.0, 66.0, 0.0, -120.0, 59.0, 169.0, -198.0, 76.0, 0.0, -272.0, -82.0, 57.0, 106.0, 32.0, 0.0, 0.0, 162.0, 69.0, 106.0, -206.0, -30.0, 34.0, 77.0, 76.0, 127.0, -4.0, 120.0, 59.0, 99.0, 124.0, -12.0, 75.0, 85.0, 125.0, 42.0, 83.0, 103.0, -332.0, 137.0, 158.0, -54.0, 13.0, 0.0, -93.0, 130.0, 104.0, 66.0, -46.0, 73.0, -159.0, -109.0, 0.0, 80.0, -136.0, 53.0, 75.0, 0.0, 87.0], "policy_predator_policy_reward": [156.0, 78.0, 0.0, 65.0, 193.0, 6.0, 45.0, 35.0, 17.0, 8.0, 0.0, 0.0, 0.0, 10.0, 0.0, 1.0, 78.0, 70.0, 1.0, 0.0, 0.0, 0.0, 181.0, 77.0, 61.0, 0.0, 0.0, 60.0, 139.0, 72.0, 136.0, 20.0, 0.0, 9.0, 31.0, 0.0, 0.0, 1.0, 11.0, 7.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 78.0, 79.0, 188.0, 0.0, 4.0, 0.0, 146.0, 109.0, 4.0, 0.0, 176.0, 163.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 4.0, 8.0, 29.0, 51.0, 27.0, 0.0, 0.0, 87.0, 1.0, 152.0, 162.0, 31.0, 16.0, 0.0, 0.0, 0.0, 122.0, 0.0, 0.0, 112.0, 121.0, 126.0, 116.0, 0.0, 0.0, 121.0, 152.0, 17.0, 2.0, 0.0, 0.0, 100.0, 110.0, 87.0, 38.0, 1.0, 13.0, 0.0, 0.0, 0.0, 43.0, 103.0, 127.0, 135.0, 60.0, 191.0, 184.0, 98.0, 98.0, 86.0, 120.0, 25.0, 0.0, 131.0, 71.0, 8.0, 31.0, 41.0, 44.0, 88.0, 87.0, 85.0, 57.0, 9.0, 0.0, 1.0, 0.0, 87.0, 80.0, 103.0, 115.0, 92.0, 75.0, 102.0, 69.0, 0.0, 0.0, 69.0, 96.0, 42.0, 7.0, 99.0, 21.0, 130.0, 130.0, 51.0, 0.0, 68.0, 0.0, 0.0, 0.0, 11.0, 21.0, 116.0, 85.0, 57.0, 68.0, 0.0, 10.0, 0.0, 61.0, 0.0, 22.0, 11.0, 0.0, 0.0, 13.0, 8.0, 15.0, 34.0, 0.0, 165.0, 1.0, 0.0, 2.0, 0.0, 86.0, 75.0, 83.0, 0.0, 0.0, 55.0, 37.0, 44.0, 94.0, 40.0, 85.0, 69.0, 0.0, 21.0, 37.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.689215169273831, "mean_inference_ms": 23.72845246769625, "mean_action_processing_ms": 0.757210657924867, "mean_env_wait_ms": 3.7973798047784744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012623786926269531, "StateBufferConnector_ms": 0.0069419145584106445, "ViewRequirementAgentConnector_ms": 0.3880937099456787}, "num_episodes": 23, "episode_return_max": 355.0, "episode_return_min": -347.0, "episode_return_mean": 122.57, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 128.98250855333222, "num_env_steps_trained_throughput_per_sec": 128.98250855333222, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 29862.235, "restore_workers_time_ms": 0.021, "training_step_time_ms": 29862.155, "sample_time_ms": 5230.518, "learn_time_ms": 24580.784, "learn_throughput": 162.729, "synch_weights_time_ms": 44.507}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "45bed_00000", "date": "2024-08-13_02-52-29", "timestamp": 1723531949, "time_this_iter_s": 31.066983222961426, "time_total_s": 6134.385159254074, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x330744160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6134.385159254074, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 87.49545454545455, "ram_util_percent": 83.39772727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2160917964798432, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.923078988342689, "policy_loss": -0.002150720933688775, "vf_loss": 2.9252297106243317, "vf_explained_var": 0.0009006451992761522, "kl": 0.005247393371638489, "entropy": 0.4320648602076939, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.13495489901336, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.730888668443791, "policy_loss": -0.0022239884676993208, "vf_loss": 7.733112660917656, "vf_explained_var": 0.3650890156390175, "kl": 0.008989874407243184, "entropy": 1.0487117033156137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 355.0, "episode_reward_min": -130.0, "episode_reward_mean": 128.75, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -364.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 191.0}, "policy_reward_mean": {"prey_policy": 21.155, "predator_policy": 43.22}, "custom_metrics": {}, "hist_stats": {"episode_reward": [131.0, 269.0, 286.0, 291.0, 151.0, 250.0, 6.0, 177.0, -100.0, 346.0, -15.0, 128.0, 151.0, 301.0, 177.0, 194.0, 173.0, 34.0, 197.0, 77.0, 41.0, 149.0, 167.0, 43.0, 355.0, -13.0, -52.0, 139.0, 115.0, 152.0, 23.0, 231.0, 77.0, 96.0, 309.0, 238.0, 31.0, -105.0, -130.0, 169.0, 91.0, 168.0, -8.0, 205.0, 155.0, 47.0, 28.0, 308.0, 63.0, 80.0, -83.0, 84.0, -65.0, 229.0, 45.0, 277.0, -2.0, -12.0, 26.0, 206.0, 0.0, 263.0, 101.0, 129.0, 163.0, 184.0, 201.0, 234.0, 76.0, 233.0, 159.0, -63.0, 297.0, 45.0, 65.0, 234.0, 112.0, 52.0, 16.0, 13.0, 186.0, 87.0, 143.0, 346.0, 269.0, 241.0, 178.0, 39.0, -29.0, 176.0, 154.0, 172.0, 245.0, 126.0, 77.0, 250.0, 224.0, 99.0, 103.0, 174.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 130.0, 141.0, 110.0, 114.0, 172.0, 148.0, 133.0, -6.0, 154.0, -53.0, 146.0, -364.0, 182.0, 0.0, 173.0, -317.0, -38.0, 154.0, 188.0, 0.0, -354.0, 132.0, -8.0, 103.0, 48.0, 190.0, 111.0, -4.0, 179.0, 198.0, -8.0, 68.0, 68.0, -72.0, 28.0, 197.0, 0.0, 163.0, -174.0, -320.0, 47.0, 59.0, 43.0, 91.0, 76.0, 165.0, -244.0, 175.0, 180.0, -238.0, -8.0, -162.0, -132.0, 0.0, 139.0, -141.0, -17.0, 137.0, -4.0, 23.0, 0.0, 200.0, -179.0, -70.0, 22.0, 108.0, -26.0, 123.0, 186.0, 142.0, 53.0, 37.0, -236.0, -114.0, -186.0, -294.0, -211.0, 133.0, -160.0, 129.0, -244.0, 71.0, 72.0, 16.0, -226.0, 59.0, 107.0, 180.0, -110.0, -223.0, 95.0, -121.0, 7.0, 126.0, 173.0, 62.0, 0.0, -87.0, 0.0, -157.0, -144.0, -160.0, 77.0, -204.0, -32.0, 163.0, 66.0, 0.0, -120.0, 59.0, 169.0, -198.0, 76.0, 0.0, -272.0, -82.0, 57.0, 106.0, 32.0, 0.0, 0.0, 162.0, 69.0, 106.0, -206.0, -30.0, 34.0, 77.0, 76.0, 127.0, -4.0, 120.0, 59.0, 99.0, 124.0, -12.0, 75.0, 85.0, 125.0, 42.0, 83.0, 103.0, -332.0, 137.0, 158.0, -54.0, 13.0, 0.0, -93.0, 130.0, 104.0, 66.0, -46.0, 73.0, -159.0, -109.0, 0.0, 80.0, -136.0, 53.0, 75.0, 0.0, 87.0, 64.0, -115.0, 141.0, 192.0, 104.0, 165.0, 117.0, 100.0, 39.0, 90.0, -131.0, -7.0, 72.0, -202.0, -17.0, 105.0, 143.0, 0.0, 177.0, -224.0, 129.0, 89.0, 109.0, 0.0, -41.0, 48.0, 108.0, 142.0, 114.0, 98.0, 0.0, 55.0, 125.0, -44.0, 0.0, 174.0], "policy_predator_policy_reward": [0.0, 1.0, 11.0, 7.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 78.0, 79.0, 188.0, 0.0, 4.0, 0.0, 146.0, 109.0, 4.0, 0.0, 176.0, 163.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 4.0, 8.0, 29.0, 51.0, 27.0, 0.0, 0.0, 87.0, 1.0, 152.0, 162.0, 31.0, 16.0, 0.0, 0.0, 0.0, 122.0, 0.0, 0.0, 112.0, 121.0, 126.0, 116.0, 0.0, 0.0, 121.0, 152.0, 17.0, 2.0, 0.0, 0.0, 100.0, 110.0, 87.0, 38.0, 1.0, 13.0, 0.0, 0.0, 0.0, 43.0, 103.0, 127.0, 135.0, 60.0, 191.0, 184.0, 98.0, 98.0, 86.0, 120.0, 25.0, 0.0, 131.0, 71.0, 8.0, 31.0, 41.0, 44.0, 88.0, 87.0, 85.0, 57.0, 9.0, 0.0, 1.0, 0.0, 87.0, 80.0, 103.0, 115.0, 92.0, 75.0, 102.0, 69.0, 0.0, 0.0, 69.0, 96.0, 42.0, 7.0, 99.0, 21.0, 130.0, 130.0, 51.0, 0.0, 68.0, 0.0, 0.0, 0.0, 11.0, 21.0, 116.0, 85.0, 57.0, 68.0, 0.0, 10.0, 0.0, 61.0, 0.0, 22.0, 11.0, 0.0, 0.0, 13.0, 8.0, 15.0, 34.0, 0.0, 165.0, 1.0, 0.0, 2.0, 0.0, 86.0, 75.0, 83.0, 0.0, 0.0, 55.0, 37.0, 44.0, 94.0, 40.0, 85.0, 69.0, 0.0, 21.0, 37.0, 0.0, 0.0, 103.0, 91.0, 13.0, 0.0, 0.0, 0.0, 24.0, 0.0, 36.0, 13.0, 76.0, 101.0, 101.0, 0.0, 55.0, 33.0, 2.0, 9.0, 107.0, 112.0, 0.0, 27.0, 17.0, 0.0, 70.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 44.0, 22.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.024197628121165, "mean_inference_ms": 24.121669551946027, "mean_action_processing_ms": 0.7530114975365687, "mean_env_wait_ms": 3.7606384329085074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012237787246704102, "StateBufferConnector_ms": 0.00702512264251709, "ViewRequirementAgentConnector_ms": 0.38975250720977783}, "num_episodes": 18, "episode_return_max": 355.0, "episode_return_min": -130.0, "episode_return_mean": 128.75, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 129.51355929371994, "num_env_steps_trained_throughput_per_sec": 129.51355929371994, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 30078.906, "restore_workers_time_ms": 0.026, "training_step_time_ms": 30078.818, "sample_time_ms": 5278.59, "learn_time_ms": 24749.276, "learn_throughput": 161.621, "synch_weights_time_ms": 44.607}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "45bed_00000", "date": "2024-08-13_02-53-00", "timestamp": 1723531980, "time_this_iter_s": 30.975875854492188, "time_total_s": 6165.361035108566, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x330761160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6165.361035108566, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 88.46136363636363, "ram_util_percent": 83.4159090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3746632830727668, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2791164419638417, "policy_loss": -0.0035541741186063047, "vf_loss": 3.282670609093217, "vf_explained_var": 0.0002838755095446551, "kl": 0.007563991858533083, "entropy": 0.5052734052851087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.835462824535117, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.735016575313749, "policy_loss": -0.0008946180119420643, "vf_loss": 7.73591118085952, "vf_explained_var": 0.4770959843718816, "kl": 0.005614717738315751, "entropy": 0.9963629768954383, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 355.0, "episode_reward_min": -416.0, "episode_reward_mean": 124.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -426.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 366.0}, "policy_reward_mean": {"prey_policy": 15.83, "predator_policy": 46.175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [197.0, 77.0, 41.0, 149.0, 167.0, 43.0, 355.0, -13.0, -52.0, 139.0, 115.0, 152.0, 23.0, 231.0, 77.0, 96.0, 309.0, 238.0, 31.0, -105.0, -130.0, 169.0, 91.0, 168.0, -8.0, 205.0, 155.0, 47.0, 28.0, 308.0, 63.0, 80.0, -83.0, 84.0, -65.0, 229.0, 45.0, 277.0, -2.0, -12.0, 26.0, 206.0, 0.0, 263.0, 101.0, 129.0, 163.0, 184.0, 201.0, 234.0, 76.0, 233.0, 159.0, -63.0, 297.0, 45.0, 65.0, 234.0, 112.0, 52.0, 16.0, 13.0, 186.0, 87.0, 143.0, 346.0, 269.0, 241.0, 178.0, 39.0, -29.0, 176.0, 154.0, 172.0, 245.0, 126.0, 77.0, 250.0, 224.0, 99.0, 103.0, 174.0, 24.0, 240.0, 147.0, 112.0, 215.0, 95.0, 19.0, 322.0, 238.0, -416.0, -65.0, 258.0, 305.0, 178.0, 34.0, 335.0, 322.0, 113.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [197.0, 0.0, 163.0, -174.0, -320.0, 47.0, 59.0, 43.0, 91.0, 76.0, 165.0, -244.0, 175.0, 180.0, -238.0, -8.0, -162.0, -132.0, 0.0, 139.0, -141.0, -17.0, 137.0, -4.0, 23.0, 0.0, 200.0, -179.0, -70.0, 22.0, 108.0, -26.0, 123.0, 186.0, 142.0, 53.0, 37.0, -236.0, -114.0, -186.0, -294.0, -211.0, 133.0, -160.0, 129.0, -244.0, 71.0, 72.0, 16.0, -226.0, 59.0, 107.0, 180.0, -110.0, -223.0, 95.0, -121.0, 7.0, 126.0, 173.0, 62.0, 0.0, -87.0, 0.0, -157.0, -144.0, -160.0, 77.0, -204.0, -32.0, 163.0, 66.0, 0.0, -120.0, 59.0, 169.0, -198.0, 76.0, 0.0, -272.0, -82.0, 57.0, 106.0, 32.0, 0.0, 0.0, 162.0, 69.0, 106.0, -206.0, -30.0, 34.0, 77.0, 76.0, 127.0, -4.0, 120.0, 59.0, 99.0, 124.0, -12.0, 75.0, 85.0, 125.0, 42.0, 83.0, 103.0, -332.0, 137.0, 158.0, -54.0, 13.0, 0.0, -93.0, 130.0, 104.0, 66.0, -46.0, 73.0, -159.0, -109.0, 0.0, 80.0, -136.0, 53.0, 75.0, 0.0, 87.0, 64.0, -115.0, 141.0, 192.0, 104.0, 165.0, 117.0, 100.0, 39.0, 90.0, -131.0, -7.0, 72.0, -202.0, -17.0, 105.0, 143.0, 0.0, 177.0, -224.0, 129.0, 89.0, 109.0, 0.0, -41.0, 48.0, 108.0, 142.0, 114.0, 98.0, 0.0, 55.0, 125.0, -44.0, 0.0, 174.0, -181.0, 0.0, 79.0, 161.0, 151.0, -8.0, 123.0, -28.0, -66.0, 111.0, -286.0, 138.0, -236.0, 137.0, 186.0, 136.0, 156.0, 65.0, -356.0, -426.0, -326.0, 58.0, 140.0, 118.0, 145.0, 143.0, -27.0, 143.0, -20.0, -80.0, 181.0, 154.0, 193.0, 129.0, 174.0, -200.0], "policy_predator_policy_reward": [0.0, 0.0, 87.0, 1.0, 152.0, 162.0, 31.0, 16.0, 0.0, 0.0, 0.0, 122.0, 0.0, 0.0, 112.0, 121.0, 126.0, 116.0, 0.0, 0.0, 121.0, 152.0, 17.0, 2.0, 0.0, 0.0, 100.0, 110.0, 87.0, 38.0, 1.0, 13.0, 0.0, 0.0, 0.0, 43.0, 103.0, 127.0, 135.0, 60.0, 191.0, 184.0, 98.0, 98.0, 86.0, 120.0, 25.0, 0.0, 131.0, 71.0, 8.0, 31.0, 41.0, 44.0, 88.0, 87.0, 85.0, 57.0, 9.0, 0.0, 1.0, 0.0, 87.0, 80.0, 103.0, 115.0, 92.0, 75.0, 102.0, 69.0, 0.0, 0.0, 69.0, 96.0, 42.0, 7.0, 99.0, 21.0, 130.0, 130.0, 51.0, 0.0, 68.0, 0.0, 0.0, 0.0, 11.0, 21.0, 116.0, 85.0, 57.0, 68.0, 0.0, 10.0, 0.0, 61.0, 0.0, 22.0, 11.0, 0.0, 0.0, 13.0, 8.0, 15.0, 34.0, 0.0, 165.0, 1.0, 0.0, 2.0, 0.0, 86.0, 75.0, 83.0, 0.0, 0.0, 55.0, 37.0, 44.0, 94.0, 40.0, 85.0, 69.0, 0.0, 21.0, 37.0, 0.0, 0.0, 103.0, 91.0, 13.0, 0.0, 0.0, 0.0, 24.0, 0.0, 36.0, 13.0, 76.0, 101.0, 101.0, 0.0, 55.0, 33.0, 2.0, 9.0, 107.0, 112.0, 0.0, 27.0, 17.0, 0.0, 70.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 44.0, 22.0, 0.0, 0.0, 0.0, 101.0, 104.0, 0.0, 0.0, 4.0, 0.0, 7.0, 10.0, 84.0, 86.0, 138.0, 105.0, 0.0, 118.0, 0.0, 0.0, 0.0, 17.0, 0.0, 366.0, 40.0, 163.0, 0.0, 0.0, 8.0, 9.0, 59.0, 3.0, 66.0, 68.0, 0.0, 0.0, 0.0, 0.0, 91.0, 48.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.959909405998592, "mean_inference_ms": 23.92218176798697, "mean_action_processing_ms": 0.7544942510697904, "mean_env_wait_ms": 3.7274792064486872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013330698013305664, "StateBufferConnector_ms": 0.021483898162841797, "ViewRequirementAgentConnector_ms": 0.4486887454986572}, "num_episodes": 18, "episode_return_max": 355.0, "episode_return_min": -416.0, "episode_return_mean": 124.01, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 130.8448206800942, "num_env_steps_trained_throughput_per_sec": 130.8448206800942, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 29813.77, "restore_workers_time_ms": 0.026, "training_step_time_ms": 29813.682, "sample_time_ms": 5178.352, "learn_time_ms": 24583.301, "learn_throughput": 162.712, "synch_weights_time_ms": 44.541}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "45bed_00000", "date": "2024-08-13_02-53-31", "timestamp": 1723532011, "time_this_iter_s": 30.61031198501587, "time_total_s": 6195.971347093582, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3306a4790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6195.971347093582, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 88.41395348837209, "ram_util_percent": 83.65813953488373}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3585352474025318, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.123769893217339, "policy_loss": -0.004301377823613288, "vf_loss": 5.12807127306701, "vf_explained_var": 0.0006196954262950433, "kl": 0.006496503521770405, "entropy": 0.4548989266630203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.086324366659085, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.359808208071996, "policy_loss": -0.0026754926980064107, "vf_loss": 7.362483719417027, "vf_explained_var": 0.34417051531019666, "kl": 0.004973694188538021, "entropy": 0.9532131806883232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 350.0, "episode_reward_min": -416.0, "episode_reward_mean": 122.43, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -498.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 366.0}, "policy_reward_mean": {"prey_policy": 13.38, "predator_policy": 47.835}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.0, 168.0, -8.0, 205.0, 155.0, 47.0, 28.0, 308.0, 63.0, 80.0, -83.0, 84.0, -65.0, 229.0, 45.0, 277.0, -2.0, -12.0, 26.0, 206.0, 0.0, 263.0, 101.0, 129.0, 163.0, 184.0, 201.0, 234.0, 76.0, 233.0, 159.0, -63.0, 297.0, 45.0, 65.0, 234.0, 112.0, 52.0, 16.0, 13.0, 186.0, 87.0, 143.0, 346.0, 269.0, 241.0, 178.0, 39.0, -29.0, 176.0, 154.0, 172.0, 245.0, 126.0, 77.0, 250.0, 224.0, 99.0, 103.0, 174.0, 24.0, 240.0, 147.0, 112.0, 215.0, 95.0, 19.0, 322.0, 238.0, -416.0, -65.0, 258.0, 305.0, 178.0, 34.0, 335.0, 322.0, 113.0, 0.0, 14.0, 73.0, 242.0, 165.0, 146.0, -181.0, 105.0, -101.0, 63.0, 271.0, 65.0, 244.0, -201.0, 159.0, -5.0, 262.0, 39.0, 271.0, 350.0, 296.0, -126.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [129.0, -244.0, 71.0, 72.0, 16.0, -226.0, 59.0, 107.0, 180.0, -110.0, -223.0, 95.0, -121.0, 7.0, 126.0, 173.0, 62.0, 0.0, -87.0, 0.0, -157.0, -144.0, -160.0, 77.0, -204.0, -32.0, 163.0, 66.0, 0.0, -120.0, 59.0, 169.0, -198.0, 76.0, 0.0, -272.0, -82.0, 57.0, 106.0, 32.0, 0.0, 0.0, 162.0, 69.0, 106.0, -206.0, -30.0, 34.0, 77.0, 76.0, 127.0, -4.0, 120.0, 59.0, 99.0, 124.0, -12.0, 75.0, 85.0, 125.0, 42.0, 83.0, 103.0, -332.0, 137.0, 158.0, -54.0, 13.0, 0.0, -93.0, 130.0, 104.0, 66.0, -46.0, 73.0, -159.0, -109.0, 0.0, 80.0, -136.0, 53.0, 75.0, 0.0, 87.0, 64.0, -115.0, 141.0, 192.0, 104.0, 165.0, 117.0, 100.0, 39.0, 90.0, -131.0, -7.0, 72.0, -202.0, -17.0, 105.0, 143.0, 0.0, 177.0, -224.0, 129.0, 89.0, 109.0, 0.0, -41.0, 48.0, 108.0, 142.0, 114.0, 98.0, 0.0, 55.0, 125.0, -44.0, 0.0, 174.0, -181.0, 0.0, 79.0, 161.0, 151.0, -8.0, 123.0, -28.0, -66.0, 111.0, -286.0, 138.0, -236.0, 137.0, 186.0, 136.0, 156.0, 65.0, -356.0, -426.0, -326.0, 58.0, 140.0, 118.0, 145.0, 143.0, -27.0, 143.0, -20.0, -80.0, 181.0, 154.0, 193.0, 129.0, 174.0, -200.0, 0.0, 0.0, -326.0, -19.0, 181.0, -216.0, 154.0, 88.0, 174.0, -498.0, 0.0, 146.0, -314.0, -184.0, -237.0, 200.0, -391.0, -43.0, 151.0, -226.0, 70.0, 164.0, 33.0, -63.0, 9.0, 174.0, -168.0, -244.0, 0.0, 157.0, 183.0, -426.0, 166.0, 94.0, 0.0, -35.0, 56.0, 171.0, 196.0, 154.0, 98.0, 153.0, -19.0, -470.0], "policy_predator_policy_reward": [86.0, 120.0, 25.0, 0.0, 131.0, 71.0, 8.0, 31.0, 41.0, 44.0, 88.0, 87.0, 85.0, 57.0, 9.0, 0.0, 1.0, 0.0, 87.0, 80.0, 103.0, 115.0, 92.0, 75.0, 102.0, 69.0, 0.0, 0.0, 69.0, 96.0, 42.0, 7.0, 99.0, 21.0, 130.0, 130.0, 51.0, 0.0, 68.0, 0.0, 0.0, 0.0, 11.0, 21.0, 116.0, 85.0, 57.0, 68.0, 0.0, 10.0, 0.0, 61.0, 0.0, 22.0, 11.0, 0.0, 0.0, 13.0, 8.0, 15.0, 34.0, 0.0, 165.0, 1.0, 0.0, 2.0, 0.0, 86.0, 75.0, 83.0, 0.0, 0.0, 55.0, 37.0, 44.0, 94.0, 40.0, 85.0, 69.0, 0.0, 21.0, 37.0, 0.0, 0.0, 103.0, 91.0, 13.0, 0.0, 0.0, 0.0, 24.0, 0.0, 36.0, 13.0, 76.0, 101.0, 101.0, 0.0, 55.0, 33.0, 2.0, 9.0, 107.0, 112.0, 0.0, 27.0, 17.0, 0.0, 70.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 44.0, 22.0, 0.0, 0.0, 0.0, 101.0, 104.0, 0.0, 0.0, 4.0, 0.0, 7.0, 10.0, 84.0, 86.0, 138.0, 105.0, 0.0, 118.0, 0.0, 0.0, 0.0, 17.0, 0.0, 366.0, 40.0, 163.0, 0.0, 0.0, 8.0, 9.0, 59.0, 3.0, 66.0, 68.0, 0.0, 0.0, 0.0, 0.0, 91.0, 48.0, 0.0, 0.0, 194.0, 165.0, 108.0, 0.0, 0.0, 0.0, 181.0, 308.0, 0.0, 0.0, 131.0, 186.0, 0.0, 142.0, 153.0, 180.0, 138.0, 0.0, 37.0, 0.0, 16.0, 79.0, 0.0, 61.0, 88.0, 123.0, 0.0, 2.0, 0.0, 238.0, 2.0, 0.0, 0.0, 74.0, 44.0, 0.0, 0.0, 0.0, 27.0, 18.0, 73.0, 290.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.898699320789142, "mean_inference_ms": 23.680162990277086, "mean_action_processing_ms": 0.7565724195632916, "mean_env_wait_ms": 3.678401316447667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015422224998474121, "StateBufferConnector_ms": 0.022859692573547363, "ViewRequirementAgentConnector_ms": 0.46200132369995117}, "num_episodes": 22, "episode_return_max": 350.0, "episode_return_min": -416.0, "episode_return_mean": 122.43, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 142.91320537985948, "num_env_steps_trained_throughput_per_sec": 142.91320537985948, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 29795.816, "restore_workers_time_ms": 0.025, "training_step_time_ms": 29795.732, "sample_time_ms": 5056.43, "learn_time_ms": 24696.585, "learn_throughput": 161.966, "synch_weights_time_ms": 35.662}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "45bed_00000", "date": "2024-08-13_02-53-59", "timestamp": 1723532039, "time_this_iter_s": 28.046305894851685, "time_total_s": 6224.017652988434, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b479e8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6224.017652988434, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 87.0, "ram_util_percent": 83.43}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2636525385357715, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.390108126685733, "policy_loss": -0.0014930581611152442, "vf_loss": 4.391601178507326, "vf_explained_var": 0.00021935423845967288, "kl": 0.004083412126339464, "entropy": 0.44556468621132866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.93608720520186, "cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.874106964989314, "policy_loss": -0.0017275977842805405, "vf_loss": 7.87583456316953, "vf_explained_var": 0.3704098237254632, "kl": 0.0037675077076296916, "entropy": 0.9970421809683401, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 353.0, "episode_reward_min": -416.0, "episode_reward_mean": 119.45, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -498.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 366.0}, "policy_reward_mean": {"prey_policy": 10.78, "predator_policy": 48.945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.0, 206.0, 0.0, 263.0, 101.0, 129.0, 163.0, 184.0, 201.0, 234.0, 76.0, 233.0, 159.0, -63.0, 297.0, 45.0, 65.0, 234.0, 112.0, 52.0, 16.0, 13.0, 186.0, 87.0, 143.0, 346.0, 269.0, 241.0, 178.0, 39.0, -29.0, 176.0, 154.0, 172.0, 245.0, 126.0, 77.0, 250.0, 224.0, 99.0, 103.0, 174.0, 24.0, 240.0, 147.0, 112.0, 215.0, 95.0, 19.0, 322.0, 238.0, -416.0, -65.0, 258.0, 305.0, 178.0, 34.0, 335.0, 322.0, 113.0, 0.0, 14.0, 73.0, 242.0, 165.0, 146.0, -181.0, 105.0, -101.0, 63.0, 271.0, 65.0, 244.0, -201.0, 159.0, -5.0, 262.0, 39.0, 271.0, 350.0, 296.0, -126.0, 113.0, 226.0, 291.0, 118.0, -59.0, 69.0, 185.0, -163.0, 112.0, 353.0, 152.0, 116.0, 12.0, 280.0, 82.0, 149.0, -308.0, -416.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-82.0, 57.0, 106.0, 32.0, 0.0, 0.0, 162.0, 69.0, 106.0, -206.0, -30.0, 34.0, 77.0, 76.0, 127.0, -4.0, 120.0, 59.0, 99.0, 124.0, -12.0, 75.0, 85.0, 125.0, 42.0, 83.0, 103.0, -332.0, 137.0, 158.0, -54.0, 13.0, 0.0, -93.0, 130.0, 104.0, 66.0, -46.0, 73.0, -159.0, -109.0, 0.0, 80.0, -136.0, 53.0, 75.0, 0.0, 87.0, 64.0, -115.0, 141.0, 192.0, 104.0, 165.0, 117.0, 100.0, 39.0, 90.0, -131.0, -7.0, 72.0, -202.0, -17.0, 105.0, 143.0, 0.0, 177.0, -224.0, 129.0, 89.0, 109.0, 0.0, -41.0, 48.0, 108.0, 142.0, 114.0, 98.0, 0.0, 55.0, 125.0, -44.0, 0.0, 174.0, -181.0, 0.0, 79.0, 161.0, 151.0, -8.0, 123.0, -28.0, -66.0, 111.0, -286.0, 138.0, -236.0, 137.0, 186.0, 136.0, 156.0, 65.0, -356.0, -426.0, -326.0, 58.0, 140.0, 118.0, 145.0, 143.0, -27.0, 143.0, -20.0, -80.0, 181.0, 154.0, 193.0, 129.0, 174.0, -200.0, 0.0, 0.0, -326.0, -19.0, 181.0, -216.0, 154.0, 88.0, 174.0, -498.0, 0.0, 146.0, -314.0, -184.0, -237.0, 200.0, -391.0, -43.0, 151.0, -226.0, 70.0, 164.0, 33.0, -63.0, 9.0, 174.0, -168.0, -244.0, 0.0, 157.0, 183.0, -426.0, 166.0, 94.0, 0.0, -35.0, 56.0, 171.0, 196.0, 154.0, 98.0, 153.0, -19.0, -470.0, -83.0, 120.0, 125.0, 101.0, 150.0, 141.0, -139.0, 144.0, 31.0, -284.0, 0.0, 27.0, -51.0, 154.0, -390.0, -59.0, 0.0, 112.0, 165.0, 176.0, -90.0, 108.0, 147.0, -72.0, 17.0, -390.0, 9.0, 200.0, -24.0, -63.0, -282.0, 162.0, -310.0, -310.0, -327.0, -326.0], "policy_predator_policy_reward": [51.0, 0.0, 68.0, 0.0, 0.0, 0.0, 11.0, 21.0, 116.0, 85.0, 57.0, 68.0, 0.0, 10.0, 0.0, 61.0, 0.0, 22.0, 11.0, 0.0, 0.0, 13.0, 8.0, 15.0, 34.0, 0.0, 165.0, 1.0, 0.0, 2.0, 0.0, 86.0, 75.0, 83.0, 0.0, 0.0, 55.0, 37.0, 44.0, 94.0, 40.0, 85.0, 69.0, 0.0, 21.0, 37.0, 0.0, 0.0, 103.0, 91.0, 13.0, 0.0, 0.0, 0.0, 24.0, 0.0, 36.0, 13.0, 76.0, 101.0, 101.0, 0.0, 55.0, 33.0, 2.0, 9.0, 107.0, 112.0, 0.0, 27.0, 17.0, 0.0, 70.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 44.0, 22.0, 0.0, 0.0, 0.0, 101.0, 104.0, 0.0, 0.0, 4.0, 0.0, 7.0, 10.0, 84.0, 86.0, 138.0, 105.0, 0.0, 118.0, 0.0, 0.0, 0.0, 17.0, 0.0, 366.0, 40.0, 163.0, 0.0, 0.0, 8.0, 9.0, 59.0, 3.0, 66.0, 68.0, 0.0, 0.0, 0.0, 0.0, 91.0, 48.0, 0.0, 0.0, 194.0, 165.0, 108.0, 0.0, 0.0, 0.0, 181.0, 308.0, 0.0, 0.0, 131.0, 186.0, 0.0, 142.0, 153.0, 180.0, 138.0, 0.0, 37.0, 0.0, 16.0, 79.0, 0.0, 61.0, 88.0, 123.0, 0.0, 2.0, 0.0, 238.0, 2.0, 0.0, 0.0, 74.0, 44.0, 0.0, 0.0, 0.0, 27.0, 18.0, 73.0, 290.0, 45.0, 31.0, 0.0, 0.0, 0.0, 0.0, 0.0, 113.0, 157.0, 37.0, 0.0, 42.0, 0.0, 82.0, 210.0, 76.0, 0.0, 0.0, 7.0, 5.0, 40.0, 94.0, 5.0, 36.0, 189.0, 196.0, 32.0, 39.0, 83.0, 86.0, 148.0, 121.0, 151.0, 161.0, 200.0, 37.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.837839369403471, "mean_inference_ms": 23.491375543944855, "mean_action_processing_ms": 0.7582765233985675, "mean_env_wait_ms": 3.64690274507981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012462615966796875, "StateBufferConnector_ms": 0.029510140419006348, "ViewRequirementAgentConnector_ms": 0.49501359462738037}, "num_episodes": 18, "episode_return_max": 353.0, "episode_return_min": -416.0, "episode_return_mean": 119.45, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.478640546822, "num_env_steps_trained_throughput_per_sec": 148.478640546822, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 28434.943, "restore_workers_time_ms": 0.024, "training_step_time_ms": 28434.859, "sample_time_ms": 4187.797, "learn_time_ms": 24205.343, "learn_throughput": 165.253, "synch_weights_time_ms": 35.15}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "45bed_00000", "date": "2024-08-13_02-54-26", "timestamp": 1723532066, "time_this_iter_s": 26.98451805114746, "time_total_s": 6251.002171039581, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x330761790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6251.002171039581, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 87.4921052631579, "ram_util_percent": 83.43947368421054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3492536795833123, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.487313658976681, "policy_loss": -0.0035793284139048957, "vf_loss": 2.490892990430196, "vf_explained_var": 0.00010371025277193261, "kl": 0.004700735492697805, "entropy": 0.38635620736571213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.39449375968761, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.140103015697822, "policy_loss": -0.0009936206040302754, "vf_loss": 8.141096642913011, "vf_explained_var": 0.3772266551300331, "kl": 0.004206674439538127, "entropy": 1.0481653456334714, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 378.0, "episode_reward_min": -416.0, "episode_reward_mean": 126.19, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -498.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 366.0}, "policy_reward_mean": {"prey_policy": 13.04, "predator_policy": 50.055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [87.0, 143.0, 346.0, 269.0, 241.0, 178.0, 39.0, -29.0, 176.0, 154.0, 172.0, 245.0, 126.0, 77.0, 250.0, 224.0, 99.0, 103.0, 174.0, 24.0, 240.0, 147.0, 112.0, 215.0, 95.0, 19.0, 322.0, 238.0, -416.0, -65.0, 258.0, 305.0, 178.0, 34.0, 335.0, 322.0, 113.0, 0.0, 14.0, 73.0, 242.0, 165.0, 146.0, -181.0, 105.0, -101.0, 63.0, 271.0, 65.0, 244.0, -201.0, 159.0, -5.0, 262.0, 39.0, 271.0, 350.0, 296.0, -126.0, 113.0, 226.0, 291.0, 118.0, -59.0, 69.0, 185.0, -163.0, 112.0, 353.0, 152.0, 116.0, 12.0, 280.0, 82.0, 149.0, -308.0, -416.0, 280.0, 89.0, 66.0, 287.0, 137.0, 237.0, 204.0, 185.0, 230.0, 305.0, 295.0, 378.0, 318.0, 164.0, -210.0, -336.0, -77.0, 210.0, 279.0, 266.0, -112.0, 281.0, 130.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 87.0, 64.0, -115.0, 141.0, 192.0, 104.0, 165.0, 117.0, 100.0, 39.0, 90.0, -131.0, -7.0, 72.0, -202.0, -17.0, 105.0, 143.0, 0.0, 177.0, -224.0, 129.0, 89.0, 109.0, 0.0, -41.0, 48.0, 108.0, 142.0, 114.0, 98.0, 0.0, 55.0, 125.0, -44.0, 0.0, 174.0, -181.0, 0.0, 79.0, 161.0, 151.0, -8.0, 123.0, -28.0, -66.0, 111.0, -286.0, 138.0, -236.0, 137.0, 186.0, 136.0, 156.0, 65.0, -356.0, -426.0, -326.0, 58.0, 140.0, 118.0, 145.0, 143.0, -27.0, 143.0, -20.0, -80.0, 181.0, 154.0, 193.0, 129.0, 174.0, -200.0, 0.0, 0.0, -326.0, -19.0, 181.0, -216.0, 154.0, 88.0, 174.0, -498.0, 0.0, 146.0, -314.0, -184.0, -237.0, 200.0, -391.0, -43.0, 151.0, -226.0, 70.0, 164.0, 33.0, -63.0, 9.0, 174.0, -168.0, -244.0, 0.0, 157.0, 183.0, -426.0, 166.0, 94.0, 0.0, -35.0, 56.0, 171.0, 196.0, 154.0, 98.0, 153.0, -19.0, -470.0, -83.0, 120.0, 125.0, 101.0, 150.0, 141.0, -139.0, 144.0, 31.0, -284.0, 0.0, 27.0, -51.0, 154.0, -390.0, -59.0, 0.0, 112.0, 165.0, 176.0, -90.0, 108.0, 147.0, -72.0, 17.0, -390.0, 9.0, 200.0, -24.0, -63.0, -282.0, 162.0, -310.0, -310.0, -327.0, -326.0, 160.0, 71.0, -372.0, 162.0, -145.0, 0.0, 131.0, 156.0, 0.0, 137.0, 135.0, 102.0, 112.0, 51.0, 131.0, -1.0, -15.0, 130.0, 143.0, 162.0, 123.0, 172.0, 188.0, 190.0, 119.0, 181.0, 0.0, 164.0, -319.0, -122.0, -302.0, -244.0, 109.0, -412.0, 129.0, 81.0, 107.0, 132.0, 140.0, 126.0, -104.0, -233.0, 182.0, 62.0, 140.0, -20.0], "policy_predator_policy_reward": [0.0, 0.0, 103.0, 91.0, 13.0, 0.0, 0.0, 0.0, 24.0, 0.0, 36.0, 13.0, 76.0, 101.0, 101.0, 0.0, 55.0, 33.0, 2.0, 9.0, 107.0, 112.0, 0.0, 27.0, 17.0, 0.0, 70.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 44.0, 22.0, 0.0, 0.0, 0.0, 101.0, 104.0, 0.0, 0.0, 4.0, 0.0, 7.0, 10.0, 84.0, 86.0, 138.0, 105.0, 0.0, 118.0, 0.0, 0.0, 0.0, 17.0, 0.0, 366.0, 40.0, 163.0, 0.0, 0.0, 8.0, 9.0, 59.0, 3.0, 66.0, 68.0, 0.0, 0.0, 0.0, 0.0, 91.0, 48.0, 0.0, 0.0, 194.0, 165.0, 108.0, 0.0, 0.0, 0.0, 181.0, 308.0, 0.0, 0.0, 131.0, 186.0, 0.0, 142.0, 153.0, 180.0, 138.0, 0.0, 37.0, 0.0, 16.0, 79.0, 0.0, 61.0, 88.0, 123.0, 0.0, 2.0, 0.0, 238.0, 2.0, 0.0, 0.0, 74.0, 44.0, 0.0, 0.0, 0.0, 27.0, 18.0, 73.0, 290.0, 45.0, 31.0, 0.0, 0.0, 0.0, 0.0, 0.0, 113.0, 157.0, 37.0, 0.0, 42.0, 0.0, 82.0, 210.0, 76.0, 0.0, 0.0, 7.0, 5.0, 40.0, 94.0, 5.0, 36.0, 189.0, 196.0, 32.0, 39.0, 83.0, 86.0, 148.0, 121.0, 151.0, 161.0, 200.0, 37.0, 6.0, 43.0, 126.0, 173.0, 99.0, 112.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 41.0, 0.0, 0.0, 55.0, 60.0, 55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 9.0, 0.0, 0.0, 170.0, 61.0, 210.0, 0.0, 0.0, 226.0, 0.0, 0.0, 25.0, 15.0, 0.0, 0.0, 108.0, 117.0, 0.0, 37.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.744275291819702, "mean_inference_ms": 23.255193908724934, "mean_action_processing_ms": 0.758915094458614, "mean_env_wait_ms": 3.6158208506078604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010398030281066895, "StateBufferConnector_ms": 0.029508352279663086, "ViewRequirementAgentConnector_ms": 0.4079645872116089}, "num_episodes": 23, "episode_return_max": 378.0, "episode_return_min": -416.0, "episode_return_mean": 126.19, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 146.7661068523458, "num_env_steps_trained_throughput_per_sec": 146.7661068523458, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 28535.12, "restore_workers_time_ms": 0.026, "training_step_time_ms": 28535.034, "sample_time_ms": 4204.047, "learn_time_ms": 24288.394, "learn_throughput": 164.688, "synch_weights_time_ms": 36.573}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "45bed_00000", "date": "2024-08-13_02-54-53", "timestamp": 1723532093, "time_this_iter_s": 27.34675693511963, "time_total_s": 6278.348927974701, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33073f5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6278.348927974701, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 87.34871794871795, "ram_util_percent": 83.37948717948719}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5832033645539056, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1503027572202935, "policy_loss": -0.0011602210151967864, "vf_loss": 1.1514629797960716, "vf_explained_var": 0.00010654131571451823, "kl": 0.004218451631274749, "entropy": 0.33318515222854717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 38.70999485181753, "cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.49786583784396, "policy_loss": -0.0035949218614155024, "vf_loss": 7.50146075506059, "vf_explained_var": 0.5460558771140992, "kl": 0.006935647721938404, "entropy": 1.0179734627090433, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 378.0, "episode_reward_min": -488.0, "episode_reward_mean": 119.59, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -498.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 366.0}, "policy_reward_mean": {"prey_policy": 11.255, "predator_policy": 48.54}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.0, 24.0, 240.0, 147.0, 112.0, 215.0, 95.0, 19.0, 322.0, 238.0, -416.0, -65.0, 258.0, 305.0, 178.0, 34.0, 335.0, 322.0, 113.0, 0.0, 14.0, 73.0, 242.0, 165.0, 146.0, -181.0, 105.0, -101.0, 63.0, 271.0, 65.0, 244.0, -201.0, 159.0, -5.0, 262.0, 39.0, 271.0, 350.0, 296.0, -126.0, 113.0, 226.0, 291.0, 118.0, -59.0, 69.0, 185.0, -163.0, 112.0, 353.0, 152.0, 116.0, 12.0, 280.0, 82.0, 149.0, -308.0, -416.0, 280.0, 89.0, 66.0, 287.0, 137.0, 237.0, 204.0, 185.0, 230.0, 305.0, 295.0, 378.0, 318.0, 164.0, -210.0, -336.0, -77.0, 210.0, 279.0, 266.0, -112.0, 281.0, 130.0, 116.0, 136.0, -3.0, 209.0, -488.0, 106.0, 109.0, 238.0, 145.0, 269.0, 260.0, 322.0, 85.0, 165.0, 289.0, 129.0, 37.0, 116.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 174.0, -181.0, 0.0, 79.0, 161.0, 151.0, -8.0, 123.0, -28.0, -66.0, 111.0, -286.0, 138.0, -236.0, 137.0, 186.0, 136.0, 156.0, 65.0, -356.0, -426.0, -326.0, 58.0, 140.0, 118.0, 145.0, 143.0, -27.0, 143.0, -20.0, -80.0, 181.0, 154.0, 193.0, 129.0, 174.0, -200.0, 0.0, 0.0, -326.0, -19.0, 181.0, -216.0, 154.0, 88.0, 174.0, -498.0, 0.0, 146.0, -314.0, -184.0, -237.0, 200.0, -391.0, -43.0, 151.0, -226.0, 70.0, 164.0, 33.0, -63.0, 9.0, 174.0, -168.0, -244.0, 0.0, 157.0, 183.0, -426.0, 166.0, 94.0, 0.0, -35.0, 56.0, 171.0, 196.0, 154.0, 98.0, 153.0, -19.0, -470.0, -83.0, 120.0, 125.0, 101.0, 150.0, 141.0, -139.0, 144.0, 31.0, -284.0, 0.0, 27.0, -51.0, 154.0, -390.0, -59.0, 0.0, 112.0, 165.0, 176.0, -90.0, 108.0, 147.0, -72.0, 17.0, -390.0, 9.0, 200.0, -24.0, -63.0, -282.0, 162.0, -310.0, -310.0, -327.0, -326.0, 160.0, 71.0, -372.0, 162.0, -145.0, 0.0, 131.0, 156.0, 0.0, 137.0, 135.0, 102.0, 112.0, 51.0, 131.0, -1.0, -15.0, 130.0, 143.0, 162.0, 123.0, 172.0, 188.0, 190.0, 119.0, 181.0, 0.0, 164.0, -319.0, -122.0, -302.0, -244.0, 109.0, -412.0, 129.0, 81.0, 107.0, 132.0, 140.0, 126.0, -104.0, -233.0, 182.0, 62.0, 140.0, -20.0, -132.0, 102.0, 74.0, -35.0, -6.0, 0.0, 88.0, 104.0, -398.0, -424.0, 106.0, 0.0, 104.0, 0.0, 98.0, 132.0, 145.0, 0.0, 112.0, 155.0, 132.0, 93.0, 146.0, 170.0, 40.0, 0.0, 0.0, 165.0, 158.0, 130.0, 129.0, 0.0, 26.0, -46.0, -18.0, 125.0], "policy_predator_policy_reward": [0.0, 0.0, 101.0, 104.0, 0.0, 0.0, 4.0, 0.0, 7.0, 10.0, 84.0, 86.0, 138.0, 105.0, 0.0, 118.0, 0.0, 0.0, 0.0, 17.0, 0.0, 366.0, 40.0, 163.0, 0.0, 0.0, 8.0, 9.0, 59.0, 3.0, 66.0, 68.0, 0.0, 0.0, 0.0, 0.0, 91.0, 48.0, 0.0, 0.0, 194.0, 165.0, 108.0, 0.0, 0.0, 0.0, 181.0, 308.0, 0.0, 0.0, 131.0, 186.0, 0.0, 142.0, 153.0, 180.0, 138.0, 0.0, 37.0, 0.0, 16.0, 79.0, 0.0, 61.0, 88.0, 123.0, 0.0, 2.0, 0.0, 238.0, 2.0, 0.0, 0.0, 74.0, 44.0, 0.0, 0.0, 0.0, 27.0, 18.0, 73.0, 290.0, 45.0, 31.0, 0.0, 0.0, 0.0, 0.0, 0.0, 113.0, 157.0, 37.0, 0.0, 42.0, 0.0, 82.0, 210.0, 76.0, 0.0, 0.0, 7.0, 5.0, 40.0, 94.0, 5.0, 36.0, 189.0, 196.0, 32.0, 39.0, 83.0, 86.0, 148.0, 121.0, 151.0, 161.0, 200.0, 37.0, 6.0, 43.0, 126.0, 173.0, 99.0, 112.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 41.0, 0.0, 0.0, 55.0, 60.0, 55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 9.0, 0.0, 0.0, 170.0, 61.0, 210.0, 0.0, 0.0, 226.0, 0.0, 0.0, 25.0, 15.0, 0.0, 0.0, 108.0, 117.0, 0.0, 37.0, 0.0, 10.0, 101.0, 45.0, 43.0, 54.0, 3.0, 0.0, 0.0, 17.0, 307.0, 27.0, 0.0, 0.0, 5.0, 0.0, 0.0, 8.0, 0.0, 0.0, 1.0, 1.0, 17.0, 18.0, 0.0, 6.0, 45.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 57.0, 0.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.681858879989295, "mean_inference_ms": 23.063656585197933, "mean_action_processing_ms": 0.7587712360056801, "mean_env_wait_ms": 3.584217476882102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012185335159301758, "StateBufferConnector_ms": 0.029926419258117676, "ViewRequirementAgentConnector_ms": 0.3612830638885498}, "num_episodes": 18, "episode_return_max": 378.0, "episode_return_min": -488.0, "episode_return_mean": 119.59, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 139.1426463469322, "num_env_steps_trained_throughput_per_sec": 139.1426463469322, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 28654.73, "restore_workers_time_ms": 0.028, "training_step_time_ms": 28654.639, "sample_time_ms": 4185.628, "learn_time_ms": 24425.704, "learn_throughput": 163.762, "synch_weights_time_ms": 36.801}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "45bed_00000", "date": "2024-08-13_02-55-22", "timestamp": 1723532122, "time_this_iter_s": 28.804949045181274, "time_total_s": 6307.153877019882, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b479e8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6307.153877019882, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 89.4825, "ram_util_percent": 83.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5548560595110295, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9289771864653895, "policy_loss": -0.0009724690225320282, "vf_loss": 3.929949644381407, "vf_explained_var": 6.361136991510946e-05, "kl": 0.0025615971620661605, "entropy": 0.4179058751101216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.156312924245047, "cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.339294650314978, "policy_loss": -0.002308242785542336, "vf_loss": 8.341602916566153, "vf_explained_var": 0.2488571735916945, "kl": 0.005201354033375974, "entropy": 0.9821007148929374, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 378.0, "episode_reward_min": -488.0, "episode_reward_mean": 121.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -832.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 493.0}, "policy_reward_mean": {"prey_policy": 6.36, "predator_policy": 54.385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [242.0, 165.0, 146.0, -181.0, 105.0, -101.0, 63.0, 271.0, 65.0, 244.0, -201.0, 159.0, -5.0, 262.0, 39.0, 271.0, 350.0, 296.0, -126.0, 113.0, 226.0, 291.0, 118.0, -59.0, 69.0, 185.0, -163.0, 112.0, 353.0, 152.0, 116.0, 12.0, 280.0, 82.0, 149.0, -308.0, -416.0, 280.0, 89.0, 66.0, 287.0, 137.0, 237.0, 204.0, 185.0, 230.0, 305.0, 295.0, 378.0, 318.0, 164.0, -210.0, -336.0, -77.0, 210.0, 279.0, 266.0, -112.0, 281.0, 130.0, 116.0, 136.0, -3.0, 209.0, -488.0, 106.0, 109.0, 238.0, 145.0, 269.0, 260.0, 322.0, 85.0, 165.0, 289.0, 129.0, 37.0, 116.0, 229.0, 259.0, -60.0, 202.0, 28.0, 133.0, 248.0, 146.0, -141.0, -2.0, 29.0, 236.0, 192.0, 59.0, 298.0, 262.0, 305.0, -93.0, 0.0, 149.0, 144.0, 304.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [154.0, 88.0, 174.0, -498.0, 0.0, 146.0, -314.0, -184.0, -237.0, 200.0, -391.0, -43.0, 151.0, -226.0, 70.0, 164.0, 33.0, -63.0, 9.0, 174.0, -168.0, -244.0, 0.0, 157.0, 183.0, -426.0, 166.0, 94.0, 0.0, -35.0, 56.0, 171.0, 196.0, 154.0, 98.0, 153.0, -19.0, -470.0, -83.0, 120.0, 125.0, 101.0, 150.0, 141.0, -139.0, 144.0, 31.0, -284.0, 0.0, 27.0, -51.0, 154.0, -390.0, -59.0, 0.0, 112.0, 165.0, 176.0, -90.0, 108.0, 147.0, -72.0, 17.0, -390.0, 9.0, 200.0, -24.0, -63.0, -282.0, 162.0, -310.0, -310.0, -327.0, -326.0, 160.0, 71.0, -372.0, 162.0, -145.0, 0.0, 131.0, 156.0, 0.0, 137.0, 135.0, 102.0, 112.0, 51.0, 131.0, -1.0, -15.0, 130.0, 143.0, 162.0, 123.0, 172.0, 188.0, 190.0, 119.0, 181.0, 0.0, 164.0, -319.0, -122.0, -302.0, -244.0, 109.0, -412.0, 129.0, 81.0, 107.0, 132.0, 140.0, 126.0, -104.0, -233.0, 182.0, 62.0, 140.0, -20.0, -132.0, 102.0, 74.0, -35.0, -6.0, 0.0, 88.0, 104.0, -398.0, -424.0, 106.0, 0.0, 104.0, 0.0, 98.0, 132.0, 145.0, 0.0, 112.0, 155.0, 132.0, 93.0, 146.0, 170.0, 40.0, 0.0, 0.0, 165.0, 158.0, 130.0, 129.0, 0.0, 26.0, -46.0, -18.0, 125.0, 109.0, 56.0, 159.0, 88.0, -284.0, 68.0, 77.0, 123.0, -192.0, 118.0, -271.0, 144.0, 162.0, 86.0, 0.0, 146.0, -97.0, -506.0, 145.0, -390.0, -313.0, 114.0, 101.0, 135.0, 38.0, 101.0, 141.0, -174.0, 122.0, 173.0, -3.0, 165.0, 147.0, 158.0, -388.0, 101.0, 0.0, 0.0, 159.0, -343.0, 0.0, 74.0, -832.0, 179.0], "policy_predator_policy_reward": [0.0, 0.0, 181.0, 308.0, 0.0, 0.0, 131.0, 186.0, 0.0, 142.0, 153.0, 180.0, 138.0, 0.0, 37.0, 0.0, 16.0, 79.0, 0.0, 61.0, 88.0, 123.0, 0.0, 2.0, 0.0, 238.0, 2.0, 0.0, 0.0, 74.0, 44.0, 0.0, 0.0, 0.0, 27.0, 18.0, 73.0, 290.0, 45.0, 31.0, 0.0, 0.0, 0.0, 0.0, 0.0, 113.0, 157.0, 37.0, 0.0, 42.0, 0.0, 82.0, 210.0, 76.0, 0.0, 0.0, 7.0, 5.0, 40.0, 94.0, 5.0, 36.0, 189.0, 196.0, 32.0, 39.0, 83.0, 86.0, 148.0, 121.0, 151.0, 161.0, 200.0, 37.0, 6.0, 43.0, 126.0, 173.0, 99.0, 112.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 41.0, 0.0, 0.0, 55.0, 60.0, 55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 9.0, 0.0, 0.0, 170.0, 61.0, 210.0, 0.0, 0.0, 226.0, 0.0, 0.0, 25.0, 15.0, 0.0, 0.0, 108.0, 117.0, 0.0, 37.0, 0.0, 10.0, 101.0, 45.0, 43.0, 54.0, 3.0, 0.0, 0.0, 17.0, 307.0, 27.0, 0.0, 0.0, 5.0, 0.0, 0.0, 8.0, 0.0, 0.0, 1.0, 1.0, 17.0, 18.0, 0.0, 6.0, 45.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 57.0, 0.0, 9.0, 43.0, 21.0, 12.0, 0.0, 9.0, 147.0, 2.0, 0.0, 9.0, 93.0, 145.0, 115.0, 0.0, 0.0, 0.0, 0.0, 94.0, 368.0, 240.0, 3.0, 97.0, 131.0, 0.0, 0.0, 28.0, 25.0, 92.0, 0.0, 3.0, 0.0, 65.0, 35.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 164.0, 169.0, 36.0, 34.0, 464.0, 493.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.618532138153621, "mean_inference_ms": 22.56112788994676, "mean_action_processing_ms": 0.7586245738279718, "mean_env_wait_ms": 3.816093949631098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011665582656860352, "StateBufferConnector_ms": 0.015659332275390625, "ViewRequirementAgentConnector_ms": 0.30656754970550537}, "num_episodes": 22, "episode_return_max": 378.0, "episode_return_min": -488.0, "episode_return_mean": 121.49, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.2198926511168, "num_env_steps_trained_throughput_per_sec": 156.2198926511168, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 28453.97, "restore_workers_time_ms": 0.027, "training_step_time_ms": 28453.881, "sample_time_ms": 4191.266, "learn_time_ms": 24213.023, "learn_throughput": 165.2, "synch_weights_time_ms": 43.498}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "45bed_00000", "date": "2024-08-13_02-55-48", "timestamp": 1723532148, "time_this_iter_s": 25.68809700012207, "time_total_s": 6332.841974020004, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3306aa1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6332.841974020004, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 87.25405405405405, "ram_util_percent": 83.10810810810813}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5649748947688196, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2857785453872075, "policy_loss": -0.002415090336873339, "vf_loss": 2.2881936412008983, "vf_explained_var": 0.0002056899209501882, "kl": 0.003774034293012333, "entropy": 0.3746645823042229, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.841543515018685, "cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.496551023463093, "policy_loss": -0.0015209315467882094, "vf_loss": 7.498071957391406, "vf_explained_var": 0.37732052150226775, "kl": 0.004554898177939212, "entropy": 1.0564341333808092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 378.0, "episode_reward_min": -488.0, "episode_reward_mean": 122.11, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -832.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 493.0}, "policy_reward_mean": {"prey_policy": 10.95, "predator_policy": 50.105}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-126.0, 113.0, 226.0, 291.0, 118.0, -59.0, 69.0, 185.0, -163.0, 112.0, 353.0, 152.0, 116.0, 12.0, 280.0, 82.0, 149.0, -308.0, -416.0, 280.0, 89.0, 66.0, 287.0, 137.0, 237.0, 204.0, 185.0, 230.0, 305.0, 295.0, 378.0, 318.0, 164.0, -210.0, -336.0, -77.0, 210.0, 279.0, 266.0, -112.0, 281.0, 130.0, 116.0, 136.0, -3.0, 209.0, -488.0, 106.0, 109.0, 238.0, 145.0, 269.0, 260.0, 322.0, 85.0, 165.0, 289.0, 129.0, 37.0, 116.0, 229.0, 259.0, -60.0, 202.0, 28.0, 133.0, 248.0, 146.0, -141.0, -2.0, 29.0, 236.0, 192.0, 59.0, 298.0, 262.0, 305.0, -93.0, 0.0, 149.0, 144.0, 304.0, 86.0, 114.0, 143.0, 227.0, 184.0, 21.0, 20.0, 47.0, 276.0, -1.0, 151.0, 294.0, -26.0, 135.0, 285.0, 0.0, 205.0, 91.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-19.0, -470.0, -83.0, 120.0, 125.0, 101.0, 150.0, 141.0, -139.0, 144.0, 31.0, -284.0, 0.0, 27.0, -51.0, 154.0, -390.0, -59.0, 0.0, 112.0, 165.0, 176.0, -90.0, 108.0, 147.0, -72.0, 17.0, -390.0, 9.0, 200.0, -24.0, -63.0, -282.0, 162.0, -310.0, -310.0, -327.0, -326.0, 160.0, 71.0, -372.0, 162.0, -145.0, 0.0, 131.0, 156.0, 0.0, 137.0, 135.0, 102.0, 112.0, 51.0, 131.0, -1.0, -15.0, 130.0, 143.0, 162.0, 123.0, 172.0, 188.0, 190.0, 119.0, 181.0, 0.0, 164.0, -319.0, -122.0, -302.0, -244.0, 109.0, -412.0, 129.0, 81.0, 107.0, 132.0, 140.0, 126.0, -104.0, -233.0, 182.0, 62.0, 140.0, -20.0, -132.0, 102.0, 74.0, -35.0, -6.0, 0.0, 88.0, 104.0, -398.0, -424.0, 106.0, 0.0, 104.0, 0.0, 98.0, 132.0, 145.0, 0.0, 112.0, 155.0, 132.0, 93.0, 146.0, 170.0, 40.0, 0.0, 0.0, 165.0, 158.0, 130.0, 129.0, 0.0, 26.0, -46.0, -18.0, 125.0, 109.0, 56.0, 159.0, 88.0, -284.0, 68.0, 77.0, 123.0, -192.0, 118.0, -271.0, 144.0, 162.0, 86.0, 0.0, 146.0, -97.0, -506.0, 145.0, -390.0, -313.0, 114.0, 101.0, 135.0, 38.0, 101.0, 141.0, -174.0, 122.0, 173.0, -3.0, 165.0, 147.0, 158.0, -388.0, 101.0, 0.0, 0.0, 159.0, -343.0, 0.0, 74.0, -832.0, 179.0, 0.0, 22.0, 114.0, 0.0, 0.0, 136.0, 110.0, 103.0, 130.0, -9.0, 0.0, -153.0, 162.0, -474.0, -235.0, 137.0, 161.0, 114.0, -2.0, 0.0, -177.0, 122.0, 118.0, 151.0, 139.0, -480.0, 135.0, 0.0, 170.0, 114.0, 0.0, 0.0, 143.0, 38.0, 0.0, 91.0], "policy_predator_policy_reward": [73.0, 290.0, 45.0, 31.0, 0.0, 0.0, 0.0, 0.0, 0.0, 113.0, 157.0, 37.0, 0.0, 42.0, 0.0, 82.0, 210.0, 76.0, 0.0, 0.0, 7.0, 5.0, 40.0, 94.0, 5.0, 36.0, 189.0, 196.0, 32.0, 39.0, 83.0, 86.0, 148.0, 121.0, 151.0, 161.0, 200.0, 37.0, 6.0, 43.0, 126.0, 173.0, 99.0, 112.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 41.0, 0.0, 0.0, 55.0, 60.0, 55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 9.0, 0.0, 0.0, 170.0, 61.0, 210.0, 0.0, 0.0, 226.0, 0.0, 0.0, 25.0, 15.0, 0.0, 0.0, 108.0, 117.0, 0.0, 37.0, 0.0, 10.0, 101.0, 45.0, 43.0, 54.0, 3.0, 0.0, 0.0, 17.0, 307.0, 27.0, 0.0, 0.0, 5.0, 0.0, 0.0, 8.0, 0.0, 0.0, 1.0, 1.0, 17.0, 18.0, 0.0, 6.0, 45.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 57.0, 0.0, 9.0, 43.0, 21.0, 12.0, 0.0, 9.0, 147.0, 2.0, 0.0, 9.0, 93.0, 145.0, 115.0, 0.0, 0.0, 0.0, 0.0, 94.0, 368.0, 240.0, 3.0, 97.0, 131.0, 0.0, 0.0, 28.0, 25.0, 92.0, 0.0, 3.0, 0.0, 65.0, 35.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 164.0, 169.0, 36.0, 34.0, 464.0, 493.0, 38.0, 26.0, 0.0, 0.0, 0.0, 7.0, 14.0, 0.0, 63.0, 0.0, 81.0, 93.0, 0.0, 332.0, 0.0, 145.0, 1.0, 0.0, 1.0, 0.0, 92.0, 114.0, 0.0, 25.0, 0.0, 315.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.560087408468166, "mean_inference_ms": 22.65397288437147, "mean_action_processing_ms": 0.7585914674454141, "mean_env_wait_ms": 3.5104359869612836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013675212860107422, "StateBufferConnector_ms": 0.01576089859008789, "ViewRequirementAgentConnector_ms": 0.31893956661224365}, "num_episodes": 18, "episode_return_max": 378.0, "episode_return_min": -488.0, "episode_return_mean": 122.11, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.10887861772792, "num_env_steps_trained_throughput_per_sec": 149.10887861772792, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 28350.251, "restore_workers_time_ms": 0.028, "training_step_time_ms": 28350.162, "sample_time_ms": 4338.637, "learn_time_ms": 23950.326, "learn_throughput": 167.012, "synch_weights_time_ms": 55.324}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "45bed_00000", "date": "2024-08-13_02-56-15", "timestamp": 1723532175, "time_this_iter_s": 26.913844108581543, "time_total_s": 6359.755818128586, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4449dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6359.755818128586, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 85.82105263157894, "ram_util_percent": 83.2184210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.62702476532844, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1012452950553286, "policy_loss": -0.002199909842213389, "vf_loss": 3.1034451977916495, "vf_explained_var": -0.0003969968942107347, "kl": 0.005808829428088467, "entropy": 0.4492332145019814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.690708640517382, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.472354884879299, "policy_loss": -0.0017852419299916142, "vf_loss": 7.474140124598508, "vf_explained_var": 0.46020158412595275, "kl": 0.003887047680708524, "entropy": 0.8877739217230882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 378.0, "episode_reward_min": -488.0, "episode_reward_mean": 130.98, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -832.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 612.0}, "policy_reward_mean": {"prey_policy": 17.375, "predator_policy": 48.115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.0, 237.0, 204.0, 185.0, 230.0, 305.0, 295.0, 378.0, 318.0, 164.0, -210.0, -336.0, -77.0, 210.0, 279.0, 266.0, -112.0, 281.0, 130.0, 116.0, 136.0, -3.0, 209.0, -488.0, 106.0, 109.0, 238.0, 145.0, 269.0, 260.0, 322.0, 85.0, 165.0, 289.0, 129.0, 37.0, 116.0, 229.0, 259.0, -60.0, 202.0, 28.0, 133.0, 248.0, 146.0, -141.0, -2.0, 29.0, 236.0, 192.0, 59.0, 298.0, 262.0, 305.0, -93.0, 0.0, 149.0, 144.0, 304.0, 86.0, 114.0, 143.0, 227.0, 184.0, 21.0, 20.0, 47.0, 276.0, -1.0, 151.0, 294.0, -26.0, 135.0, 285.0, 0.0, 205.0, 91.0, 152.0, 171.0, 136.0, 239.0, 345.0, 207.0, 87.0, 261.0, 113.0, -114.0, -291.0, 287.0, 316.0, 134.0, 71.0, 66.0, -332.0, 189.0, 188.0, 306.0, -158.0, 71.0, 351.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 137.0, 135.0, 102.0, 112.0, 51.0, 131.0, -1.0, -15.0, 130.0, 143.0, 162.0, 123.0, 172.0, 188.0, 190.0, 119.0, 181.0, 0.0, 164.0, -319.0, -122.0, -302.0, -244.0, 109.0, -412.0, 129.0, 81.0, 107.0, 132.0, 140.0, 126.0, -104.0, -233.0, 182.0, 62.0, 140.0, -20.0, -132.0, 102.0, 74.0, -35.0, -6.0, 0.0, 88.0, 104.0, -398.0, -424.0, 106.0, 0.0, 104.0, 0.0, 98.0, 132.0, 145.0, 0.0, 112.0, 155.0, 132.0, 93.0, 146.0, 170.0, 40.0, 0.0, 0.0, 165.0, 158.0, 130.0, 129.0, 0.0, 26.0, -46.0, -18.0, 125.0, 109.0, 56.0, 159.0, 88.0, -284.0, 68.0, 77.0, 123.0, -192.0, 118.0, -271.0, 144.0, 162.0, 86.0, 0.0, 146.0, -97.0, -506.0, 145.0, -390.0, -313.0, 114.0, 101.0, 135.0, 38.0, 101.0, 141.0, -174.0, 122.0, 173.0, -3.0, 165.0, 147.0, 158.0, -388.0, 101.0, 0.0, 0.0, 159.0, -343.0, 0.0, 74.0, -832.0, 179.0, 0.0, 22.0, 114.0, 0.0, 0.0, 136.0, 110.0, 103.0, 130.0, -9.0, 0.0, -153.0, 162.0, -474.0, -235.0, 137.0, 161.0, 114.0, -2.0, 0.0, -177.0, 122.0, 118.0, 151.0, 139.0, -480.0, 135.0, 0.0, 170.0, 114.0, 0.0, 0.0, 143.0, 38.0, 0.0, 91.0, 123.0, -79.0, 24.0, 92.0, 132.0, 0.0, 128.0, 105.0, 145.0, 200.0, 163.0, -34.0, 134.0, -313.0, 91.0, 124.0, -43.0, 88.0, -368.0, -85.0, -150.0, -512.0, 88.0, 180.0, 110.0, 155.0, -78.0, 173.0, -75.0, 95.0, 159.0, -186.0, -312.0, -632.0, 145.0, -25.0, 32.0, 134.0, 158.0, 125.0, -436.0, -25.0, -448.0, 195.0, 153.0, 198.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 41.0, 0.0, 0.0, 55.0, 60.0, 55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 9.0, 0.0, 0.0, 170.0, 61.0, 210.0, 0.0, 0.0, 226.0, 0.0, 0.0, 25.0, 15.0, 0.0, 0.0, 108.0, 117.0, 0.0, 37.0, 0.0, 10.0, 101.0, 45.0, 43.0, 54.0, 3.0, 0.0, 0.0, 17.0, 307.0, 27.0, 0.0, 0.0, 5.0, 0.0, 0.0, 8.0, 0.0, 0.0, 1.0, 1.0, 17.0, 18.0, 0.0, 6.0, 45.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 57.0, 0.0, 9.0, 43.0, 21.0, 12.0, 0.0, 9.0, 147.0, 2.0, 0.0, 9.0, 93.0, 145.0, 115.0, 0.0, 0.0, 0.0, 0.0, 94.0, 368.0, 240.0, 3.0, 97.0, 131.0, 0.0, 0.0, 28.0, 25.0, 92.0, 0.0, 3.0, 0.0, 65.0, 35.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 164.0, 169.0, 36.0, 34.0, 464.0, 493.0, 38.0, 26.0, 0.0, 0.0, 0.0, 7.0, 14.0, 0.0, 63.0, 0.0, 81.0, 93.0, 0.0, 332.0, 0.0, 145.0, 1.0, 0.0, 1.0, 0.0, 92.0, 114.0, 0.0, 25.0, 0.0, 315.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 108.0, 0.0, 0.0, 55.0, 4.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 78.0, 98.0, 168.0, 46.0, 0.0, 68.0, 0.0, 95.0, 244.0, 40.0, 331.0, 11.0, 8.0, 21.0, 30.0, 39.0, 0.0, 13.0, 38.0, 93.0, 0.0, 0.0, 612.0, 0.0, 69.0, 11.0, 11.0, 15.0, 8.0, 15.0, 288.0, 0.0, 324.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.018667219527595, "mean_inference_ms": 21.912387218892228, "mean_action_processing_ms": 0.7644243451351487, "mean_env_wait_ms": 3.4842187145246184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019578933715820312, "StateBufferConnector_ms": 0.0087050199508667, "ViewRequirementAgentConnector_ms": 0.36498022079467773}, "num_episodes": 23, "episode_return_max": 378.0, "episode_return_min": -488.0, "episode_return_mean": 130.98, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.19403214278555, "num_env_steps_trained_throughput_per_sec": 156.19403214278555, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 28143.826, "restore_workers_time_ms": 0.029, "training_step_time_ms": 28143.74, "sample_time_ms": 4641.186, "learn_time_ms": 23437.444, "learn_throughput": 170.667, "synch_weights_time_ms": 59.523}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "45bed_00000", "date": "2024-08-13_02-56-41", "timestamp": 1723532201, "time_this_iter_s": 25.648144960403442, "time_total_s": 6385.403963088989, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x330761790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6385.403963088989, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 84.34166666666665, "ram_util_percent": 83.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.414067703453952, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2237114501377895, "policy_loss": -0.002782141175318174, "vf_loss": 2.226493587191143, "vf_explained_var": 0.00013110773273245998, "kl": 0.004568099899114436, "entropy": 0.48562496772834235, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.28945463643503, "cur_kl_coeff": 5.820766091346741e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.71272520918064, "policy_loss": -0.00207822273680004, "vf_loss": 6.7148034194159125, "vf_explained_var": 0.5275089839463512, "kl": 0.00403014591781777, "entropy": 0.8602110419639204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 392.0, "episode_reward_min": -488.0, "episode_reward_mean": 140.16, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -832.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 612.0}, "policy_reward_mean": {"prey_policy": 24.495, "predator_policy": 45.585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.0, 116.0, 136.0, -3.0, 209.0, -488.0, 106.0, 109.0, 238.0, 145.0, 269.0, 260.0, 322.0, 85.0, 165.0, 289.0, 129.0, 37.0, 116.0, 229.0, 259.0, -60.0, 202.0, 28.0, 133.0, 248.0, 146.0, -141.0, -2.0, 29.0, 236.0, 192.0, 59.0, 298.0, 262.0, 305.0, -93.0, 0.0, 149.0, 144.0, 304.0, 86.0, 114.0, 143.0, 227.0, 184.0, 21.0, 20.0, 47.0, 276.0, -1.0, 151.0, 294.0, -26.0, 135.0, 285.0, 0.0, 205.0, 91.0, 152.0, 171.0, 136.0, 239.0, 345.0, 207.0, 87.0, 261.0, 113.0, -114.0, -291.0, 287.0, 316.0, 134.0, 71.0, 66.0, -332.0, 189.0, 188.0, 306.0, -158.0, 71.0, 351.0, 279.0, 15.0, 326.0, 70.0, 334.0, 276.0, 198.0, 322.0, 133.0, 243.0, 166.0, 189.0, 392.0, 38.0, 10.0, 171.0, 160.0, 350.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [140.0, -20.0, -132.0, 102.0, 74.0, -35.0, -6.0, 0.0, 88.0, 104.0, -398.0, -424.0, 106.0, 0.0, 104.0, 0.0, 98.0, 132.0, 145.0, 0.0, 112.0, 155.0, 132.0, 93.0, 146.0, 170.0, 40.0, 0.0, 0.0, 165.0, 158.0, 130.0, 129.0, 0.0, 26.0, -46.0, -18.0, 125.0, 109.0, 56.0, 159.0, 88.0, -284.0, 68.0, 77.0, 123.0, -192.0, 118.0, -271.0, 144.0, 162.0, 86.0, 0.0, 146.0, -97.0, -506.0, 145.0, -390.0, -313.0, 114.0, 101.0, 135.0, 38.0, 101.0, 141.0, -174.0, 122.0, 173.0, -3.0, 165.0, 147.0, 158.0, -388.0, 101.0, 0.0, 0.0, 159.0, -343.0, 0.0, 74.0, -832.0, 179.0, 0.0, 22.0, 114.0, 0.0, 0.0, 136.0, 110.0, 103.0, 130.0, -9.0, 0.0, -153.0, 162.0, -474.0, -235.0, 137.0, 161.0, 114.0, -2.0, 0.0, -177.0, 122.0, 118.0, 151.0, 139.0, -480.0, 135.0, 0.0, 170.0, 114.0, 0.0, 0.0, 143.0, 38.0, 0.0, 91.0, 123.0, -79.0, 24.0, 92.0, 132.0, 0.0, 128.0, 105.0, 145.0, 200.0, 163.0, -34.0, 134.0, -313.0, 91.0, 124.0, -43.0, 88.0, -368.0, -85.0, -150.0, -512.0, 88.0, 180.0, 110.0, 155.0, -78.0, 173.0, -75.0, 95.0, 159.0, -186.0, -312.0, -632.0, 145.0, -25.0, 32.0, 134.0, 158.0, 125.0, -436.0, -25.0, -448.0, 195.0, 153.0, 198.0, 161.0, 104.0, -8.0, -72.0, 169.0, 157.0, 100.0, -66.0, 193.0, 71.0, 188.0, 88.0, 121.0, 60.0, 155.0, 167.0, 144.0, -122.0, 153.0, 52.0, 174.0, -78.0, -44.0, 104.0, 200.0, 192.0, -88.0, 52.0, 8.0, 0.0, 0.0, 171.0, 140.0, 0.0, 176.0, 158.0], "policy_predator_policy_reward": [0.0, 10.0, 101.0, 45.0, 43.0, 54.0, 3.0, 0.0, 0.0, 17.0, 307.0, 27.0, 0.0, 0.0, 5.0, 0.0, 0.0, 8.0, 0.0, 0.0, 1.0, 1.0, 17.0, 18.0, 0.0, 6.0, 45.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 57.0, 0.0, 9.0, 43.0, 21.0, 12.0, 0.0, 9.0, 147.0, 2.0, 0.0, 9.0, 93.0, 145.0, 115.0, 0.0, 0.0, 0.0, 0.0, 94.0, 368.0, 240.0, 3.0, 97.0, 131.0, 0.0, 0.0, 28.0, 25.0, 92.0, 0.0, 3.0, 0.0, 65.0, 35.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 164.0, 169.0, 36.0, 34.0, 464.0, 493.0, 38.0, 26.0, 0.0, 0.0, 0.0, 7.0, 14.0, 0.0, 63.0, 0.0, 81.0, 93.0, 0.0, 332.0, 0.0, 145.0, 1.0, 0.0, 1.0, 0.0, 92.0, 114.0, 0.0, 25.0, 0.0, 315.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 108.0, 0.0, 0.0, 55.0, 4.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 78.0, 98.0, 168.0, 46.0, 0.0, 68.0, 0.0, 95.0, 244.0, 40.0, 331.0, 11.0, 8.0, 21.0, 30.0, 39.0, 0.0, 13.0, 38.0, 93.0, 0.0, 0.0, 612.0, 0.0, 69.0, 11.0, 11.0, 15.0, 8.0, 15.0, 288.0, 0.0, 324.0, 0.0, 0.0, 0.0, 14.0, 8.0, 87.0, 0.0, 0.0, 36.0, 0.0, 39.0, 31.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 83.0, 28.0, 38.0, 0.0, 0.0, 70.0, 40.0, 89.0, 0.0, 0.0, 35.0, 39.0, 0.0, 2.0, 0.0, 0.0, 20.0, 0.0, 4.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.432168465589818, "mean_inference_ms": 22.290915595334933, "mean_action_processing_ms": 0.7620526255699843, "mean_env_wait_ms": 3.455301548878294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020443439483642578, "StateBufferConnector_ms": 0.008723258972167969, "ViewRequirementAgentConnector_ms": 0.4493894577026367}, "num_episodes": 18, "episode_return_max": 392.0, "episode_return_min": -488.0, "episode_return_mean": 140.16, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.87567621011544, "num_env_steps_trained_throughput_per_sec": 151.87567621011544, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 27676.364, "restore_workers_time_ms": 0.029, "training_step_time_ms": 27676.278, "sample_time_ms": 4758.799, "learn_time_ms": 22857.868, "learn_throughput": 174.994, "synch_weights_time_ms": 53.326}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "45bed_00000", "date": "2024-08-13_02-57-07", "timestamp": 1723532227, "time_this_iter_s": 26.472568035125732, "time_total_s": 6411.876531124115, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3307618b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6411.876531124115, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 84.10540540540539, "ram_util_percent": 82.93243243243244}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4515105990150934, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8471915940759045, "policy_loss": -0.005612314566132174, "vf_loss": 2.852803908264826, "vf_explained_var": -0.0002229172085958814, "kl": 0.008659584290809196, "entropy": 0.3770061851966949, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 44.87427666821177, "cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.191524504101466, "policy_loss": -0.0005292629425182307, "vf_loss": 7.192053762567106, "vf_explained_var": 0.3109995842295349, "kl": 0.0047144318903427915, "entropy": 0.8891031199662143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 392.0, "episode_reward_min": -332.0, "episode_reward_mean": 143.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -832.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 612.0}, "policy_reward_mean": {"prey_policy": 23.035, "predator_policy": 48.71}, "custom_metrics": {}, "hist_stats": {"episode_reward": [116.0, 229.0, 259.0, -60.0, 202.0, 28.0, 133.0, 248.0, 146.0, -141.0, -2.0, 29.0, 236.0, 192.0, 59.0, 298.0, 262.0, 305.0, -93.0, 0.0, 149.0, 144.0, 304.0, 86.0, 114.0, 143.0, 227.0, 184.0, 21.0, 20.0, 47.0, 276.0, -1.0, 151.0, 294.0, -26.0, 135.0, 285.0, 0.0, 205.0, 91.0, 152.0, 171.0, 136.0, 239.0, 345.0, 207.0, 87.0, 261.0, 113.0, -114.0, -291.0, 287.0, 316.0, 134.0, 71.0, 66.0, -332.0, 189.0, 188.0, 306.0, -158.0, 71.0, 351.0, 279.0, 15.0, 326.0, 70.0, 334.0, 276.0, 198.0, 322.0, 133.0, 243.0, 166.0, 189.0, 392.0, 38.0, 10.0, 171.0, 160.0, 350.0, 202.0, 326.0, 301.0, 310.0, 189.0, -30.0, 7.0, 284.0, -6.0, -37.0, -86.0, 265.0, 328.0, 319.0, 174.0, -33.0, 339.0, -265.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.0, 125.0, 109.0, 56.0, 159.0, 88.0, -284.0, 68.0, 77.0, 123.0, -192.0, 118.0, -271.0, 144.0, 162.0, 86.0, 0.0, 146.0, -97.0, -506.0, 145.0, -390.0, -313.0, 114.0, 101.0, 135.0, 38.0, 101.0, 141.0, -174.0, 122.0, 173.0, -3.0, 165.0, 147.0, 158.0, -388.0, 101.0, 0.0, 0.0, 159.0, -343.0, 0.0, 74.0, -832.0, 179.0, 0.0, 22.0, 114.0, 0.0, 0.0, 136.0, 110.0, 103.0, 130.0, -9.0, 0.0, -153.0, 162.0, -474.0, -235.0, 137.0, 161.0, 114.0, -2.0, 0.0, -177.0, 122.0, 118.0, 151.0, 139.0, -480.0, 135.0, 0.0, 170.0, 114.0, 0.0, 0.0, 143.0, 38.0, 0.0, 91.0, 123.0, -79.0, 24.0, 92.0, 132.0, 0.0, 128.0, 105.0, 145.0, 200.0, 163.0, -34.0, 134.0, -313.0, 91.0, 124.0, -43.0, 88.0, -368.0, -85.0, -150.0, -512.0, 88.0, 180.0, 110.0, 155.0, -78.0, 173.0, -75.0, 95.0, 159.0, -186.0, -312.0, -632.0, 145.0, -25.0, 32.0, 134.0, 158.0, 125.0, -436.0, -25.0, -448.0, 195.0, 153.0, 198.0, 161.0, 104.0, -8.0, -72.0, 169.0, 157.0, 100.0, -66.0, 193.0, 71.0, 188.0, 88.0, 121.0, 60.0, 155.0, 167.0, 144.0, -122.0, 153.0, 52.0, 174.0, -78.0, -44.0, 104.0, 200.0, 192.0, -88.0, 52.0, 8.0, 0.0, 0.0, 171.0, 140.0, 0.0, 176.0, 158.0, 52.0, 130.0, 95.0, 197.0, 145.0, 152.0, 133.0, 177.0, 15.0, 167.0, -370.0, -26.0, 143.0, -321.0, 164.0, 110.0, -10.0, -2.0, -242.0, 84.0, -516.0, 66.0, 141.0, 124.0, 174.0, 132.0, 176.0, 143.0, 174.0, 0.0, -26.0, -58.0, 154.0, 168.0, -359.0, -90.0], "policy_predator_policy_reward": [0.0, 9.0, 43.0, 21.0, 12.0, 0.0, 9.0, 147.0, 2.0, 0.0, 9.0, 93.0, 145.0, 115.0, 0.0, 0.0, 0.0, 0.0, 94.0, 368.0, 240.0, 3.0, 97.0, 131.0, 0.0, 0.0, 28.0, 25.0, 92.0, 0.0, 3.0, 0.0, 65.0, 35.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 164.0, 169.0, 36.0, 34.0, 464.0, 493.0, 38.0, 26.0, 0.0, 0.0, 0.0, 7.0, 14.0, 0.0, 63.0, 0.0, 81.0, 93.0, 0.0, 332.0, 0.0, 145.0, 1.0, 0.0, 1.0, 0.0, 92.0, 114.0, 0.0, 25.0, 0.0, 315.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 108.0, 0.0, 0.0, 55.0, 4.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 78.0, 98.0, 168.0, 46.0, 0.0, 68.0, 0.0, 95.0, 244.0, 40.0, 331.0, 11.0, 8.0, 21.0, 30.0, 39.0, 0.0, 13.0, 38.0, 93.0, 0.0, 0.0, 612.0, 0.0, 69.0, 11.0, 11.0, 15.0, 8.0, 15.0, 288.0, 0.0, 324.0, 0.0, 0.0, 0.0, 14.0, 8.0, 87.0, 0.0, 0.0, 36.0, 0.0, 39.0, 31.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 83.0, 28.0, 38.0, 0.0, 0.0, 70.0, 40.0, 89.0, 0.0, 0.0, 35.0, 39.0, 0.0, 2.0, 0.0, 0.0, 20.0, 0.0, 4.0, 12.0, 16.0, 4.0, 0.0, 34.0, 4.0, 0.0, 0.0, 0.0, 0.0, 7.0, 186.0, 180.0, 177.0, 8.0, 9.0, 1.0, 1.0, 5.0, 121.0, 0.0, 0.0, 364.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 21.0, 8.0, 9.0, 162.0, 22.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.387419688244015, "mean_inference_ms": 22.149707407947343, "mean_action_processing_ms": 0.7663230411257551, "mean_env_wait_ms": 3.430858190778082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03967618942260742, "StateBufferConnector_ms": 0.03750884532928467, "ViewRequirementAgentConnector_ms": 0.5995789766311646}, "num_episodes": 18, "episode_return_max": 392.0, "episode_return_min": -332.0, "episode_return_mean": 143.49, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 138.80197755647993, "num_env_steps_trained_throughput_per_sec": 138.80197755647993, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 27469.686, "restore_workers_time_ms": 0.026, "training_step_time_ms": 27469.606, "sample_time_ms": 5086.006, "learn_time_ms": 22320.161, "learn_throughput": 179.21, "synch_weights_time_ms": 56.997}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "45bed_00000", "date": "2024-08-13_02-57-36", "timestamp": 1723532256, "time_this_iter_s": 28.9921658039093, "time_total_s": 6440.868696928024, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44b38b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6440.868696928024, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 85.0, "ram_util_percent": 83.41219512195121}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4647404736627347, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8753053857535913, "policy_loss": -0.0035070016999881734, "vf_loss": 2.8788123853622922, "vf_explained_var": -0.00012959491008173222, "kl": 0.00862469366662229, "entropy": 0.4540554473009059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.547205924735497, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.276195485503585, "policy_loss": -0.004401463673514112, "vf_loss": 7.280596941741055, "vf_explained_var": 0.42853688654445465, "kl": 0.005171341934709346, "entropy": 0.848047747056951, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 392.0, "episode_reward_min": -332.0, "episode_reward_mean": 145.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -832.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 612.0}, "policy_reward_mean": {"prey_policy": 21.69, "predator_policy": 50.94}, "custom_metrics": {}, "hist_stats": {"episode_reward": [304.0, 86.0, 114.0, 143.0, 227.0, 184.0, 21.0, 20.0, 47.0, 276.0, -1.0, 151.0, 294.0, -26.0, 135.0, 285.0, 0.0, 205.0, 91.0, 152.0, 171.0, 136.0, 239.0, 345.0, 207.0, 87.0, 261.0, 113.0, -114.0, -291.0, 287.0, 316.0, 134.0, 71.0, 66.0, -332.0, 189.0, 188.0, 306.0, -158.0, 71.0, 351.0, 279.0, 15.0, 326.0, 70.0, 334.0, 276.0, 198.0, 322.0, 133.0, 243.0, 166.0, 189.0, 392.0, 38.0, 10.0, 171.0, 160.0, 350.0, 202.0, 326.0, 301.0, 310.0, 189.0, -30.0, 7.0, 284.0, -6.0, -37.0, -86.0, 265.0, 328.0, 319.0, 174.0, -33.0, 339.0, -265.0, 67.0, 100.0, 350.0, 171.0, 272.0, 137.0, -180.0, -17.0, 285.0, 225.0, 227.0, 151.0, 145.0, -6.0, 154.0, -67.0, 301.0, 140.0, 55.0, -136.0, 259.0, 283.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-832.0, 179.0, 0.0, 22.0, 114.0, 0.0, 0.0, 136.0, 110.0, 103.0, 130.0, -9.0, 0.0, -153.0, 162.0, -474.0, -235.0, 137.0, 161.0, 114.0, -2.0, 0.0, -177.0, 122.0, 118.0, 151.0, 139.0, -480.0, 135.0, 0.0, 170.0, 114.0, 0.0, 0.0, 143.0, 38.0, 0.0, 91.0, 123.0, -79.0, 24.0, 92.0, 132.0, 0.0, 128.0, 105.0, 145.0, 200.0, 163.0, -34.0, 134.0, -313.0, 91.0, 124.0, -43.0, 88.0, -368.0, -85.0, -150.0, -512.0, 88.0, 180.0, 110.0, 155.0, -78.0, 173.0, -75.0, 95.0, 159.0, -186.0, -312.0, -632.0, 145.0, -25.0, 32.0, 134.0, 158.0, 125.0, -436.0, -25.0, -448.0, 195.0, 153.0, 198.0, 161.0, 104.0, -8.0, -72.0, 169.0, 157.0, 100.0, -66.0, 193.0, 71.0, 188.0, 88.0, 121.0, 60.0, 155.0, 167.0, 144.0, -122.0, 153.0, 52.0, 174.0, -78.0, -44.0, 104.0, 200.0, 192.0, -88.0, 52.0, 8.0, 0.0, 0.0, 171.0, 140.0, 0.0, 176.0, 158.0, 52.0, 130.0, 95.0, 197.0, 145.0, 152.0, 133.0, 177.0, 15.0, 167.0, -370.0, -26.0, 143.0, -321.0, 164.0, 110.0, -10.0, -2.0, -242.0, 84.0, -516.0, 66.0, 141.0, 124.0, 174.0, 132.0, 176.0, 143.0, 174.0, 0.0, -26.0, -58.0, 154.0, 168.0, -359.0, -90.0, -412.0, 169.0, 123.0, -120.0, 169.0, 181.0, 0.0, 171.0, 125.0, 147.0, -470.0, 55.0, -8.0, -363.0, 139.0, -332.0, 136.0, 149.0, -31.0, 178.0, 173.0, 54.0, -271.0, 187.0, 145.0, 0.0, -154.0, -81.0, -8.0, 158.0, -470.0, 59.0, 147.0, 154.0, 125.0, 0.0, 32.0, -163.0, -44.0, -460.0, 98.0, 119.0, 170.0, 111.0], "policy_predator_policy_reward": [464.0, 493.0, 38.0, 26.0, 0.0, 0.0, 0.0, 7.0, 14.0, 0.0, 63.0, 0.0, 81.0, 93.0, 0.0, 332.0, 0.0, 145.0, 1.0, 0.0, 1.0, 0.0, 92.0, 114.0, 0.0, 25.0, 0.0, 315.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 108.0, 0.0, 0.0, 55.0, 4.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 78.0, 98.0, 168.0, 46.0, 0.0, 68.0, 0.0, 95.0, 244.0, 40.0, 331.0, 11.0, 8.0, 21.0, 30.0, 39.0, 0.0, 13.0, 38.0, 93.0, 0.0, 0.0, 612.0, 0.0, 69.0, 11.0, 11.0, 15.0, 8.0, 15.0, 288.0, 0.0, 324.0, 0.0, 0.0, 0.0, 14.0, 8.0, 87.0, 0.0, 0.0, 36.0, 0.0, 39.0, 31.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 83.0, 28.0, 38.0, 0.0, 0.0, 70.0, 40.0, 89.0, 0.0, 0.0, 35.0, 39.0, 0.0, 2.0, 0.0, 0.0, 20.0, 0.0, 4.0, 12.0, 16.0, 4.0, 0.0, 34.0, 4.0, 0.0, 0.0, 0.0, 0.0, 7.0, 186.0, 180.0, 177.0, 8.0, 9.0, 1.0, 1.0, 5.0, 121.0, 0.0, 0.0, 364.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 21.0, 8.0, 9.0, 162.0, 22.0, 9.0, 301.0, 97.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 278.0, 274.0, 187.0, 4.0, 0.0, 176.0, 0.0, 0.0, 77.0, 1.0, 0.0, 0.0, 104.0, 131.0, 0.0, 0.0, 114.0, 115.0, 0.0, 4.0, 34.0, 310.0, 0.0, 0.0, 15.0, 0.0, 53.0, 133.0, 290.0, 78.0, 25.0, 17.0, 0.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.351099248127632, "mean_inference_ms": 21.991703575634283, "mean_action_processing_ms": 0.7734919036833422, "mean_env_wait_ms": 3.3954390127725946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04762840270996094, "StateBufferConnector_ms": 0.037952423095703125, "ViewRequirementAgentConnector_ms": 0.6908828020095825}, "num_episodes": 22, "episode_return_max": 392.0, "episode_return_min": -332.0, "episode_return_mean": 145.26, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 142.11065616296344, "num_env_steps_trained_throughput_per_sec": 142.11065616296344, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 27227.338, "restore_workers_time_ms": 0.027, "training_step_time_ms": 27227.254, "sample_time_ms": 5431.133, "learn_time_ms": 21731.548, "learn_throughput": 184.064, "synch_weights_time_ms": 59.264}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "45bed_00000", "date": "2024-08-13_02-58-05", "timestamp": 1723532285, "time_this_iter_s": 28.209481954574585, "time_total_s": 6469.078178882599, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3307618b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6469.078178882599, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 86.11, "ram_util_percent": 83.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1577262360464644, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.430114070069853, "policy_loss": -0.0027294939610535505, "vf_loss": 3.4328435597596347, "vf_explained_var": 0.0007534510244137395, "kl": 0.00618331519021832, "entropy": 0.410205415301222, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.51126731457534, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.6225501100853, "policy_loss": -0.0018905807148527215, "vf_loss": 7.624440705334699, "vf_explained_var": -0.007454281225406304, "kl": 0.00372297312970573, "entropy": 0.7967659938272345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 392.0, "episode_reward_min": -413.0, "episode_reward_mean": 140.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -632.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 612.0}, "policy_reward_mean": {"prey_policy": 23.195, "predator_policy": 47.035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.0, 152.0, 171.0, 136.0, 239.0, 345.0, 207.0, 87.0, 261.0, 113.0, -114.0, -291.0, 287.0, 316.0, 134.0, 71.0, 66.0, -332.0, 189.0, 188.0, 306.0, -158.0, 71.0, 351.0, 279.0, 15.0, 326.0, 70.0, 334.0, 276.0, 198.0, 322.0, 133.0, 243.0, 166.0, 189.0, 392.0, 38.0, 10.0, 171.0, 160.0, 350.0, 202.0, 326.0, 301.0, 310.0, 189.0, -30.0, 7.0, 284.0, -6.0, -37.0, -86.0, 265.0, 328.0, 319.0, 174.0, -33.0, 339.0, -265.0, 67.0, 100.0, 350.0, 171.0, 272.0, 137.0, -180.0, -17.0, 285.0, 225.0, 227.0, 151.0, 145.0, -6.0, 154.0, -67.0, 301.0, 140.0, 55.0, -136.0, 259.0, 283.0, 360.0, 23.0, -91.0, -43.0, 335.0, 29.0, 83.0, -413.0, 295.0, 0.0, 138.0, 255.0, 200.0, 137.0, 120.0, -80.0, 292.0, 345.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 91.0, 123.0, -79.0, 24.0, 92.0, 132.0, 0.0, 128.0, 105.0, 145.0, 200.0, 163.0, -34.0, 134.0, -313.0, 91.0, 124.0, -43.0, 88.0, -368.0, -85.0, -150.0, -512.0, 88.0, 180.0, 110.0, 155.0, -78.0, 173.0, -75.0, 95.0, 159.0, -186.0, -312.0, -632.0, 145.0, -25.0, 32.0, 134.0, 158.0, 125.0, -436.0, -25.0, -448.0, 195.0, 153.0, 198.0, 161.0, 104.0, -8.0, -72.0, 169.0, 157.0, 100.0, -66.0, 193.0, 71.0, 188.0, 88.0, 121.0, 60.0, 155.0, 167.0, 144.0, -122.0, 153.0, 52.0, 174.0, -78.0, -44.0, 104.0, 200.0, 192.0, -88.0, 52.0, 8.0, 0.0, 0.0, 171.0, 140.0, 0.0, 176.0, 158.0, 52.0, 130.0, 95.0, 197.0, 145.0, 152.0, 133.0, 177.0, 15.0, 167.0, -370.0, -26.0, 143.0, -321.0, 164.0, 110.0, -10.0, -2.0, -242.0, 84.0, -516.0, 66.0, 141.0, 124.0, 174.0, 132.0, 176.0, 143.0, 174.0, 0.0, -26.0, -58.0, 154.0, 168.0, -359.0, -90.0, -412.0, 169.0, 123.0, -120.0, 169.0, 181.0, 0.0, 171.0, 125.0, 147.0, -470.0, 55.0, -8.0, -363.0, 139.0, -332.0, 136.0, 149.0, -31.0, 178.0, 173.0, 54.0, -271.0, 187.0, 145.0, 0.0, -154.0, -81.0, -8.0, 158.0, -470.0, 59.0, 147.0, 154.0, 125.0, 0.0, 32.0, -163.0, -44.0, -460.0, 98.0, 119.0, 170.0, 111.0, 199.0, 161.0, -180.0, 89.0, -414.0, 22.0, -366.0, 140.0, 171.0, 163.0, 153.0, -264.0, 108.0, -134.0, -337.0, -370.0, 76.0, 185.0, 0.0, -78.0, 177.0, -80.0, 108.0, 147.0, 200.0, 0.0, -50.0, 162.0, 130.0, -20.0, 93.0, -370.0, 137.0, 134.0, 192.0, 153.0], "policy_predator_policy_reward": [0.0, 0.0, 108.0, 0.0, 0.0, 55.0, 4.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 78.0, 98.0, 168.0, 46.0, 0.0, 68.0, 0.0, 95.0, 244.0, 40.0, 331.0, 11.0, 8.0, 21.0, 30.0, 39.0, 0.0, 13.0, 38.0, 93.0, 0.0, 0.0, 612.0, 0.0, 69.0, 11.0, 11.0, 15.0, 8.0, 15.0, 288.0, 0.0, 324.0, 0.0, 0.0, 0.0, 14.0, 8.0, 87.0, 0.0, 0.0, 36.0, 0.0, 39.0, 31.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 83.0, 28.0, 38.0, 0.0, 0.0, 70.0, 40.0, 89.0, 0.0, 0.0, 35.0, 39.0, 0.0, 2.0, 0.0, 0.0, 20.0, 0.0, 4.0, 12.0, 16.0, 4.0, 0.0, 34.0, 4.0, 0.0, 0.0, 0.0, 0.0, 7.0, 186.0, 180.0, 177.0, 8.0, 9.0, 1.0, 1.0, 5.0, 121.0, 0.0, 0.0, 364.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 21.0, 8.0, 9.0, 162.0, 22.0, 9.0, 301.0, 97.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 278.0, 274.0, 187.0, 4.0, 0.0, 176.0, 0.0, 0.0, 77.0, 1.0, 0.0, 0.0, 104.0, 131.0, 0.0, 0.0, 114.0, 115.0, 0.0, 4.0, 34.0, 310.0, 0.0, 0.0, 15.0, 0.0, 53.0, 133.0, 290.0, 78.0, 25.0, 17.0, 0.0, 2.0, 0.0, 0.0, 0.0, 114.0, 24.0, 277.0, 183.0, 0.0, 1.0, 0.0, 18.0, 122.0, 0.0, 109.0, 106.0, 188.0, 34.0, 0.0, 0.0, 78.0, 0.0, 41.0, 0.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 10.0, 189.0, 8.0, 21.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.315304913215482, "mean_inference_ms": 21.876749876554037, "mean_action_processing_ms": 0.7803661949039257, "mean_env_wait_ms": 3.3742676000254543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050845980644226074, "StateBufferConnector_ms": 0.03688180446624756, "ViewRequirementAgentConnector_ms": 0.7516897916793823}, "num_episodes": 18, "episode_return_max": 392.0, "episode_return_min": -413.0, "episode_return_mean": 140.46, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 137.90175235304525, "num_env_steps_trained_throughput_per_sec": 137.90175235304525, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 27329.053, "restore_workers_time_ms": 0.029, "training_step_time_ms": 27328.966, "sample_time_ms": 5884.915, "learn_time_ms": 21374.768, "learn_throughput": 187.137, "synch_weights_time_ms": 63.224}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "45bed_00000", "date": "2024-08-13_02-58-34", "timestamp": 1723532314, "time_this_iter_s": 29.066804885864258, "time_total_s": 6498.144983768463, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44f6280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6498.144983768463, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 86.78780487804879, "ram_util_percent": 83.2560975609756}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8431576514015438, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.160703034691079, "policy_loss": -0.0018836842837531573, "vf_loss": 2.1625867155493883, "vf_explained_var": 0.0009284090743493782, "kl": 0.003919863394074577, "entropy": 0.3722103224702613, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.77749999424137, "cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.7733698037566334, "policy_loss": -0.0009000850311682495, "vf_loss": 6.774269899489387, "vf_explained_var": 0.2547444476021661, "kl": 0.004566306246510181, "entropy": 0.7483170462663842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 392.0, "episode_reward_min": -413.0, "episode_reward_mean": 163.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -516.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 364.0}, "policy_reward_mean": {"prey_policy": 44.11, "predator_policy": 37.41}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.0, 279.0, 15.0, 326.0, 70.0, 334.0, 276.0, 198.0, 322.0, 133.0, 243.0, 166.0, 189.0, 392.0, 38.0, 10.0, 171.0, 160.0, 350.0, 202.0, 326.0, 301.0, 310.0, 189.0, -30.0, 7.0, 284.0, -6.0, -37.0, -86.0, 265.0, 328.0, 319.0, 174.0, -33.0, 339.0, -265.0, 67.0, 100.0, 350.0, 171.0, 272.0, 137.0, -180.0, -17.0, 285.0, 225.0, 227.0, 151.0, 145.0, -6.0, 154.0, -67.0, 301.0, 140.0, 55.0, -136.0, 259.0, 283.0, 360.0, 23.0, -91.0, -43.0, 335.0, 29.0, 83.0, -413.0, 295.0, 0.0, 138.0, 255.0, 200.0, 137.0, 120.0, -80.0, 292.0, 345.0, -81.0, 352.0, 323.0, 7.0, 299.0, 283.0, 199.0, 284.0, 282.0, 45.0, 296.0, 186.0, 178.0, 237.0, 209.0, 150.0, 314.0, 15.0, 244.0, 323.0, 116.0, 353.0, 179.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [153.0, 198.0, 161.0, 104.0, -8.0, -72.0, 169.0, 157.0, 100.0, -66.0, 193.0, 71.0, 188.0, 88.0, 121.0, 60.0, 155.0, 167.0, 144.0, -122.0, 153.0, 52.0, 174.0, -78.0, -44.0, 104.0, 200.0, 192.0, -88.0, 52.0, 8.0, 0.0, 0.0, 171.0, 140.0, 0.0, 176.0, 158.0, 52.0, 130.0, 95.0, 197.0, 145.0, 152.0, 133.0, 177.0, 15.0, 167.0, -370.0, -26.0, 143.0, -321.0, 164.0, 110.0, -10.0, -2.0, -242.0, 84.0, -516.0, 66.0, 141.0, 124.0, 174.0, 132.0, 176.0, 143.0, 174.0, 0.0, -26.0, -58.0, 154.0, 168.0, -359.0, -90.0, -412.0, 169.0, 123.0, -120.0, 169.0, 181.0, 0.0, 171.0, 125.0, 147.0, -470.0, 55.0, -8.0, -363.0, 139.0, -332.0, 136.0, 149.0, -31.0, 178.0, 173.0, 54.0, -271.0, 187.0, 145.0, 0.0, -154.0, -81.0, -8.0, 158.0, -470.0, 59.0, 147.0, 154.0, 125.0, 0.0, 32.0, -163.0, -44.0, -460.0, 98.0, 119.0, 170.0, 111.0, 199.0, 161.0, -180.0, 89.0, -414.0, 22.0, -366.0, 140.0, 171.0, 163.0, 153.0, -264.0, 108.0, -134.0, -337.0, -370.0, 76.0, 185.0, 0.0, -78.0, 177.0, -80.0, 108.0, 147.0, 200.0, 0.0, -50.0, 162.0, 130.0, -20.0, 93.0, -370.0, 137.0, 134.0, 192.0, 153.0, -9.0, -236.0, 181.0, 171.0, 197.0, 126.0, 14.0, -88.0, 132.0, 161.0, 164.0, 105.0, -75.0, 176.0, 161.0, 122.0, 160.0, 89.0, -163.0, -117.0, 158.0, 138.0, 134.0, 23.0, 98.0, 56.0, 113.0, 88.0, 51.0, 158.0, 104.0, 46.0, 187.0, 127.0, 3.0, -118.0, 83.0, 145.0, 164.0, 156.0, 145.0, -70.0, 162.0, 191.0, 154.0, 4.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 14.0, 8.0, 87.0, 0.0, 0.0, 36.0, 0.0, 39.0, 31.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 83.0, 28.0, 38.0, 0.0, 0.0, 70.0, 40.0, 89.0, 0.0, 0.0, 35.0, 39.0, 0.0, 2.0, 0.0, 0.0, 20.0, 0.0, 4.0, 12.0, 16.0, 4.0, 0.0, 34.0, 4.0, 0.0, 0.0, 0.0, 0.0, 7.0, 186.0, 180.0, 177.0, 8.0, 9.0, 1.0, 1.0, 5.0, 121.0, 0.0, 0.0, 364.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 21.0, 8.0, 9.0, 162.0, 22.0, 9.0, 301.0, 97.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 278.0, 274.0, 187.0, 4.0, 0.0, 176.0, 0.0, 0.0, 77.0, 1.0, 0.0, 0.0, 104.0, 131.0, 0.0, 0.0, 114.0, 115.0, 0.0, 4.0, 34.0, 310.0, 0.0, 0.0, 15.0, 0.0, 53.0, 133.0, 290.0, 78.0, 25.0, 17.0, 0.0, 2.0, 0.0, 0.0, 0.0, 114.0, 24.0, 277.0, 183.0, 0.0, 1.0, 0.0, 18.0, 122.0, 0.0, 109.0, 106.0, 188.0, 34.0, 0.0, 0.0, 78.0, 0.0, 41.0, 0.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 10.0, 189.0, 8.0, 21.0, 0.0, 0.0, 0.0, 0.0, 164.0, 0.0, 0.0, 0.0, 0.0, 37.0, 44.0, 0.0, 6.0, 12.0, 2.0, 8.0, 90.0, 0.0, 1.0, 20.0, 13.0, 157.0, 168.0, 0.0, 0.0, 12.0, 17.0, 18.0, 6.0, 28.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 90.0, 10.0, 6.0, 0.0, 3.0, 0.0, 41.0, 0.0, 0.0, 0.0, 21.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.258553699304235, "mean_inference_ms": 21.737175121488303, "mean_action_processing_ms": 0.7889811473663104, "mean_env_wait_ms": 3.355261675424381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04548954963684082, "StateBufferConnector_ms": 0.037165164947509766, "ViewRequirementAgentConnector_ms": 0.7270137071609497}, "num_episodes": 23, "episode_return_max": 392.0, "episode_return_min": -413.0, "episode_return_mean": 163.04, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.0211678510663, "num_env_steps_trained_throughput_per_sec": 150.0211678510663, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 27301.354, "restore_workers_time_ms": 0.029, "training_step_time_ms": 27301.265, "sample_time_ms": 6145.377, "learn_time_ms": 21085.621, "learn_throughput": 189.703, "synch_weights_time_ms": 63.944}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "45bed_00000", "date": "2024-08-13_02-59-01", "timestamp": 1723532341, "time_this_iter_s": 26.760483741760254, "time_total_s": 6524.905467510223, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44b3790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6524.905467510223, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 86.3, "ram_util_percent": 83.20526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1199800328839393, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2307348136548644, "policy_loss": -0.0029843204717580523, "vf_loss": 3.233719139061277, "vf_explained_var": 0.004550533477591459, "kl": 0.005355352197194108, "entropy": 0.41612461805343626, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.26437742315903, "cur_kl_coeff": 3.637978807091713e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.3068148126047126, "policy_loss": -0.0013623534836042573, "vf_loss": 7.308177162604357, "vf_explained_var": 0.0870180766103129, "kl": 0.0045040899263198006, "entropy": 0.793767968466673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 360.0, "episode_reward_min": -413.0, "episode_reward_mean": 151.2, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -516.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 364.0}, "policy_reward_mean": {"prey_policy": 33.2, "predator_policy": 42.4}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.0, 202.0, 326.0, 301.0, 310.0, 189.0, -30.0, 7.0, 284.0, -6.0, -37.0, -86.0, 265.0, 328.0, 319.0, 174.0, -33.0, 339.0, -265.0, 67.0, 100.0, 350.0, 171.0, 272.0, 137.0, -180.0, -17.0, 285.0, 225.0, 227.0, 151.0, 145.0, -6.0, 154.0, -67.0, 301.0, 140.0, 55.0, -136.0, 259.0, 283.0, 360.0, 23.0, -91.0, -43.0, 335.0, 29.0, 83.0, -413.0, 295.0, 0.0, 138.0, 255.0, 200.0, 137.0, 120.0, -80.0, 292.0, 345.0, -81.0, 352.0, 323.0, 7.0, 299.0, 283.0, 199.0, 284.0, 282.0, 45.0, 296.0, 186.0, 178.0, 237.0, 209.0, 150.0, 314.0, 15.0, 244.0, 323.0, 116.0, 353.0, 179.0, 279.0, 284.0, 172.0, 165.0, 333.0, 278.0, 98.0, 227.0, 341.0, 281.0, 184.0, -259.0, -75.0, 176.0, -198.0, 191.0, 231.0, -219.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [176.0, 158.0, 52.0, 130.0, 95.0, 197.0, 145.0, 152.0, 133.0, 177.0, 15.0, 167.0, -370.0, -26.0, 143.0, -321.0, 164.0, 110.0, -10.0, -2.0, -242.0, 84.0, -516.0, 66.0, 141.0, 124.0, 174.0, 132.0, 176.0, 143.0, 174.0, 0.0, -26.0, -58.0, 154.0, 168.0, -359.0, -90.0, -412.0, 169.0, 123.0, -120.0, 169.0, 181.0, 0.0, 171.0, 125.0, 147.0, -470.0, 55.0, -8.0, -363.0, 139.0, -332.0, 136.0, 149.0, -31.0, 178.0, 173.0, 54.0, -271.0, 187.0, 145.0, 0.0, -154.0, -81.0, -8.0, 158.0, -470.0, 59.0, 147.0, 154.0, 125.0, 0.0, 32.0, -163.0, -44.0, -460.0, 98.0, 119.0, 170.0, 111.0, 199.0, 161.0, -180.0, 89.0, -414.0, 22.0, -366.0, 140.0, 171.0, 163.0, 153.0, -264.0, 108.0, -134.0, -337.0, -370.0, 76.0, 185.0, 0.0, -78.0, 177.0, -80.0, 108.0, 147.0, 200.0, 0.0, -50.0, 162.0, 130.0, -20.0, 93.0, -370.0, 137.0, 134.0, 192.0, 153.0, -9.0, -236.0, 181.0, 171.0, 197.0, 126.0, 14.0, -88.0, 132.0, 161.0, 164.0, 105.0, -75.0, 176.0, 161.0, 122.0, 160.0, 89.0, -163.0, -117.0, 158.0, 138.0, 134.0, 23.0, 98.0, 56.0, 113.0, 88.0, 51.0, 158.0, 104.0, 46.0, 187.0, 127.0, 3.0, -118.0, 83.0, 145.0, 164.0, 156.0, 145.0, -70.0, 162.0, 191.0, 154.0, 4.0, 104.0, 165.0, 167.0, 116.0, 147.0, 18.0, -40.0, 173.0, 154.0, 179.0, 124.0, 145.0, -190.0, 109.0, 75.0, 107.0, 155.0, 186.0, 92.0, 180.0, 177.0, -101.0, -382.0, -188.0, -394.0, 121.0, 22.0, 101.0, -152.0, -273.0, 175.0, -60.0, 125.0, 80.0, -240.0, -362.0], "policy_predator_policy_reward": [4.0, 12.0, 16.0, 4.0, 0.0, 34.0, 4.0, 0.0, 0.0, 0.0, 0.0, 7.0, 186.0, 180.0, 177.0, 8.0, 9.0, 1.0, 1.0, 5.0, 121.0, 0.0, 0.0, 364.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 21.0, 8.0, 9.0, 162.0, 22.0, 9.0, 301.0, 97.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 278.0, 274.0, 187.0, 4.0, 0.0, 176.0, 0.0, 0.0, 77.0, 1.0, 0.0, 0.0, 104.0, 131.0, 0.0, 0.0, 114.0, 115.0, 0.0, 4.0, 34.0, 310.0, 0.0, 0.0, 15.0, 0.0, 53.0, 133.0, 290.0, 78.0, 25.0, 17.0, 0.0, 2.0, 0.0, 0.0, 0.0, 114.0, 24.0, 277.0, 183.0, 0.0, 1.0, 0.0, 18.0, 122.0, 0.0, 109.0, 106.0, 188.0, 34.0, 0.0, 0.0, 78.0, 0.0, 41.0, 0.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 10.0, 189.0, 8.0, 21.0, 0.0, 0.0, 0.0, 0.0, 164.0, 0.0, 0.0, 0.0, 0.0, 37.0, 44.0, 0.0, 6.0, 12.0, 2.0, 8.0, 90.0, 0.0, 1.0, 20.0, 13.0, 157.0, 168.0, 0.0, 0.0, 12.0, 17.0, 18.0, 6.0, 28.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 90.0, 10.0, 6.0, 0.0, 3.0, 0.0, 41.0, 0.0, 0.0, 0.0, 21.0, 10.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 32.0, 0.0, 0.0, 9.0, 0.0, 92.0, 87.0, 0.0, 45.0, 0.0, 0.0, 0.0, 9.0, 8.0, 100.0, 120.0, 191.0, 198.0, 0.0, 0.0, 53.0, 85.0, 142.0, 76.0, 0.0, 26.0, 0.0, 187.0, 196.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.222257437875141, "mean_inference_ms": 21.62102465697598, "mean_action_processing_ms": 0.7949424520981745, "mean_env_wait_ms": 3.334148453100957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046586036682128906, "StateBufferConnector_ms": 0.03715217113494873, "ViewRequirementAgentConnector_ms": 0.6696815490722656}, "num_episodes": 18, "episode_return_max": 360.0, "episode_return_min": -413.0, "episode_return_mean": 151.2, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 137.59833526611246, "num_env_steps_trained_throughput_per_sec": 137.59833526611246, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 27482.94, "restore_workers_time_ms": 0.028, "training_step_time_ms": 27482.852, "sample_time_ms": 6278.849, "learn_time_ms": 21133.314, "learn_throughput": 189.275, "synch_weights_time_ms": 63.036}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "45bed_00000", "date": "2024-08-13_02-59-30", "timestamp": 1723532370, "time_this_iter_s": 29.463446855545044, "time_total_s": 6554.368914365768, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b51fb940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6554.368914365768, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 87.24634146341462, "ram_util_percent": 83.12439024390245}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9793812522851916, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.629987905958973, "policy_loss": -0.0009448076967918683, "vf_loss": 2.630932715140953, "vf_explained_var": 0.007169237559434598, "kl": 0.0066282333740972895, "entropy": 0.36787896459064784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.11565599955579, "cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.294969650551125, "policy_loss": 0.0005499646313385004, "vf_loss": 6.29441968902709, "vf_explained_var": 0.020904975025742144, "kl": 0.006564379171662686, "entropy": 0.7125758032950144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 360.0, "episode_reward_min": -413.0, "episode_reward_mean": 148.16, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -470.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 310.0}, "policy_reward_mean": {"prey_policy": 32.74, "predator_policy": 41.34}, "custom_metrics": {}, "hist_stats": {"episode_reward": [171.0, 272.0, 137.0, -180.0, -17.0, 285.0, 225.0, 227.0, 151.0, 145.0, -6.0, 154.0, -67.0, 301.0, 140.0, 55.0, -136.0, 259.0, 283.0, 360.0, 23.0, -91.0, -43.0, 335.0, 29.0, 83.0, -413.0, 295.0, 0.0, 138.0, 255.0, 200.0, 137.0, 120.0, -80.0, 292.0, 345.0, -81.0, 352.0, 323.0, 7.0, 299.0, 283.0, 199.0, 284.0, 282.0, 45.0, 296.0, 186.0, 178.0, 237.0, 209.0, 150.0, 314.0, 15.0, 244.0, 323.0, 116.0, 353.0, 179.0, 279.0, 284.0, 172.0, 165.0, 333.0, 278.0, 98.0, 227.0, 341.0, 281.0, 184.0, -259.0, -75.0, 176.0, -198.0, 191.0, 231.0, -219.0, 169.0, -21.0, 228.0, 65.0, 198.0, -9.0, 269.0, 138.0, 215.0, 212.0, -357.0, 244.0, 296.0, 284.0, 270.0, 38.0, 194.0, 261.0, 252.0, 211.0, 231.0, -238.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 171.0, 125.0, 147.0, -470.0, 55.0, -8.0, -363.0, 139.0, -332.0, 136.0, 149.0, -31.0, 178.0, 173.0, 54.0, -271.0, 187.0, 145.0, 0.0, -154.0, -81.0, -8.0, 158.0, -470.0, 59.0, 147.0, 154.0, 125.0, 0.0, 32.0, -163.0, -44.0, -460.0, 98.0, 119.0, 170.0, 111.0, 199.0, 161.0, -180.0, 89.0, -414.0, 22.0, -366.0, 140.0, 171.0, 163.0, 153.0, -264.0, 108.0, -134.0, -337.0, -370.0, 76.0, 185.0, 0.0, -78.0, 177.0, -80.0, 108.0, 147.0, 200.0, 0.0, -50.0, 162.0, 130.0, -20.0, 93.0, -370.0, 137.0, 134.0, 192.0, 153.0, -9.0, -236.0, 181.0, 171.0, 197.0, 126.0, 14.0, -88.0, 132.0, 161.0, 164.0, 105.0, -75.0, 176.0, 161.0, 122.0, 160.0, 89.0, -163.0, -117.0, 158.0, 138.0, 134.0, 23.0, 98.0, 56.0, 113.0, 88.0, 51.0, 158.0, 104.0, 46.0, 187.0, 127.0, 3.0, -118.0, 83.0, 145.0, 164.0, 156.0, 145.0, -70.0, 162.0, 191.0, 154.0, 4.0, 104.0, 165.0, 167.0, 116.0, 147.0, 18.0, -40.0, 173.0, 154.0, 179.0, 124.0, 145.0, -190.0, 109.0, 75.0, 107.0, 155.0, 186.0, 92.0, 180.0, 177.0, -101.0, -382.0, -188.0, -394.0, 121.0, 22.0, 101.0, -152.0, -273.0, 175.0, -60.0, 125.0, 80.0, -240.0, -362.0, 164.0, -68.0, -243.0, 100.0, 61.0, 144.0, -139.0, 91.0, 160.0, -43.0, 107.0, -362.0, 170.0, 99.0, 139.0, -274.0, 4.0, 147.0, 92.0, 120.0, -364.0, -190.0, 129.0, 111.0, 165.0, 129.0, 154.0, 124.0, 165.0, 105.0, 156.0, -265.0, 59.0, 115.0, 156.0, 97.0, 200.0, 15.0, 102.0, 105.0, 84.0, 125.0, -286.0, -112.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 278.0, 274.0, 187.0, 4.0, 0.0, 176.0, 0.0, 0.0, 77.0, 1.0, 0.0, 0.0, 104.0, 131.0, 0.0, 0.0, 114.0, 115.0, 0.0, 4.0, 34.0, 310.0, 0.0, 0.0, 15.0, 0.0, 53.0, 133.0, 290.0, 78.0, 25.0, 17.0, 0.0, 2.0, 0.0, 0.0, 0.0, 114.0, 24.0, 277.0, 183.0, 0.0, 1.0, 0.0, 18.0, 122.0, 0.0, 109.0, 106.0, 188.0, 34.0, 0.0, 0.0, 78.0, 0.0, 41.0, 0.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 10.0, 189.0, 8.0, 21.0, 0.0, 0.0, 0.0, 0.0, 164.0, 0.0, 0.0, 0.0, 0.0, 37.0, 44.0, 0.0, 6.0, 12.0, 2.0, 8.0, 90.0, 0.0, 1.0, 20.0, 13.0, 157.0, 168.0, 0.0, 0.0, 12.0, 17.0, 18.0, 6.0, 28.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 90.0, 10.0, 6.0, 0.0, 3.0, 0.0, 41.0, 0.0, 0.0, 0.0, 21.0, 10.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 32.0, 0.0, 0.0, 9.0, 0.0, 92.0, 87.0, 0.0, 45.0, 0.0, 0.0, 0.0, 9.0, 8.0, 100.0, 120.0, 191.0, 198.0, 0.0, 0.0, 53.0, 85.0, 142.0, 76.0, 0.0, 26.0, 0.0, 187.0, 196.0, 0.0, 73.0, 122.0, 0.0, 16.0, 7.0, 0.0, 113.0, 0.0, 81.0, 63.0, 183.0, 0.0, 0.0, 137.0, 136.0, 64.0, 0.0, 0.0, 0.0, 0.0, 197.0, 2.0, 2.0, 0.0, 2.0, 6.0, 0.0, 0.0, 0.0, 0.0, 147.0, 5.0, 15.0, 0.0, 8.0, 0.0, 37.0, 4.0, 0.0, 2.0, 20.0, 0.0, 160.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.184886489075086, "mean_inference_ms": 21.224309211705584, "mean_action_processing_ms": 0.8006985828944341, "mean_env_wait_ms": 3.5517877017499804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02324044704437256, "StateBufferConnector_ms": 0.007643580436706543, "ViewRequirementAgentConnector_ms": 0.5482901334762573}, "num_episodes": 22, "episode_return_max": 360.0, "episode_return_min": -413.0, "episode_return_mean": 148.16, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 130.0723089457988, "num_env_steps_trained_throughput_per_sec": 130.0723089457988, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 27683.404, "restore_workers_time_ms": 0.026, "training_step_time_ms": 27683.319, "sample_time_ms": 6433.639, "learn_time_ms": 21176.384, "learn_throughput": 188.89, "synch_weights_time_ms": 65.4}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "45bed_00000", "date": "2024-08-13_03-00-01", "timestamp": 1723532401, "time_this_iter_s": 30.845035076141357, "time_total_s": 6585.21394944191, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b479eee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6585.21394944191, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 88.46818181818183, "ram_util_percent": 83.13409090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9908395888273993, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.026221538220764, "policy_loss": -0.0014801824349594652, "vf_loss": 3.027701728621488, "vf_explained_var": 0.00601800800000549, "kl": 0.005366036945822016, "entropy": 0.34818845390485076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.496222416181414, "cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.366472471832599, "policy_loss": -0.001011430658892822, "vf_loss": 7.367483893147221, "vf_explained_var": -0.07987329887334632, "kl": 0.0038677629435195614, "entropy": 0.7554052145392807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 360.0, "episode_reward_min": -413.0, "episode_reward_mean": 153.05, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -414.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 277.0}, "policy_reward_mean": {"prey_policy": 39.885, "predator_policy": 36.64}, "custom_metrics": {}, "hist_stats": {"episode_reward": [283.0, 360.0, 23.0, -91.0, -43.0, 335.0, 29.0, 83.0, -413.0, 295.0, 0.0, 138.0, 255.0, 200.0, 137.0, 120.0, -80.0, 292.0, 345.0, -81.0, 352.0, 323.0, 7.0, 299.0, 283.0, 199.0, 284.0, 282.0, 45.0, 296.0, 186.0, 178.0, 237.0, 209.0, 150.0, 314.0, 15.0, 244.0, 323.0, 116.0, 353.0, 179.0, 279.0, 284.0, 172.0, 165.0, 333.0, 278.0, 98.0, 227.0, 341.0, 281.0, 184.0, -259.0, -75.0, 176.0, -198.0, 191.0, 231.0, -219.0, 169.0, -21.0, 228.0, 65.0, 198.0, -9.0, 269.0, 138.0, 215.0, 212.0, -357.0, 244.0, 296.0, 284.0, 270.0, 38.0, 194.0, 261.0, 252.0, 211.0, 231.0, -238.0, 57.0, -20.0, 178.0, -56.0, 100.0, -60.0, -224.0, 281.0, 296.0, 278.0, 133.0, 172.0, 275.0, 356.0, 155.0, 215.0, 304.0, 165.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [170.0, 111.0, 199.0, 161.0, -180.0, 89.0, -414.0, 22.0, -366.0, 140.0, 171.0, 163.0, 153.0, -264.0, 108.0, -134.0, -337.0, -370.0, 76.0, 185.0, 0.0, -78.0, 177.0, -80.0, 108.0, 147.0, 200.0, 0.0, -50.0, 162.0, 130.0, -20.0, 93.0, -370.0, 137.0, 134.0, 192.0, 153.0, -9.0, -236.0, 181.0, 171.0, 197.0, 126.0, 14.0, -88.0, 132.0, 161.0, 164.0, 105.0, -75.0, 176.0, 161.0, 122.0, 160.0, 89.0, -163.0, -117.0, 158.0, 138.0, 134.0, 23.0, 98.0, 56.0, 113.0, 88.0, 51.0, 158.0, 104.0, 46.0, 187.0, 127.0, 3.0, -118.0, 83.0, 145.0, 164.0, 156.0, 145.0, -70.0, 162.0, 191.0, 154.0, 4.0, 104.0, 165.0, 167.0, 116.0, 147.0, 18.0, -40.0, 173.0, 154.0, 179.0, 124.0, 145.0, -190.0, 109.0, 75.0, 107.0, 155.0, 186.0, 92.0, 180.0, 177.0, -101.0, -382.0, -188.0, -394.0, 121.0, 22.0, 101.0, -152.0, -273.0, 175.0, -60.0, 125.0, 80.0, -240.0, -362.0, 164.0, -68.0, -243.0, 100.0, 61.0, 144.0, -139.0, 91.0, 160.0, -43.0, 107.0, -362.0, 170.0, 99.0, 139.0, -274.0, 4.0, 147.0, 92.0, 120.0, -364.0, -190.0, 129.0, 111.0, 165.0, 129.0, 154.0, 124.0, 165.0, 105.0, 156.0, -265.0, 59.0, 115.0, 156.0, 97.0, 200.0, 15.0, 102.0, 105.0, 84.0, 125.0, -286.0, -112.0, 16.0, 12.0, 5.0, -88.0, -24.0, 142.0, -400.0, 137.0, 92.0, -298.0, 90.0, -317.0, -256.0, -235.0, 141.0, 138.0, 198.0, 97.0, 114.0, 161.0, 130.0, 3.0, 71.0, 97.0, 159.0, 116.0, 176.0, 180.0, 124.0, -47.0, -64.0, 145.0, 104.0, 200.0, -87.0, 93.0], "policy_predator_policy_reward": [0.0, 2.0, 0.0, 0.0, 0.0, 114.0, 24.0, 277.0, 183.0, 0.0, 1.0, 0.0, 18.0, 122.0, 0.0, 109.0, 106.0, 188.0, 34.0, 0.0, 0.0, 78.0, 0.0, 41.0, 0.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 10.0, 189.0, 8.0, 21.0, 0.0, 0.0, 0.0, 0.0, 164.0, 0.0, 0.0, 0.0, 0.0, 37.0, 44.0, 0.0, 6.0, 12.0, 2.0, 8.0, 90.0, 0.0, 1.0, 20.0, 13.0, 157.0, 168.0, 0.0, 0.0, 12.0, 17.0, 18.0, 6.0, 28.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 90.0, 10.0, 6.0, 0.0, 3.0, 0.0, 41.0, 0.0, 0.0, 0.0, 21.0, 10.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 32.0, 0.0, 0.0, 9.0, 0.0, 92.0, 87.0, 0.0, 45.0, 0.0, 0.0, 0.0, 9.0, 8.0, 100.0, 120.0, 191.0, 198.0, 0.0, 0.0, 53.0, 85.0, 142.0, 76.0, 0.0, 26.0, 0.0, 187.0, 196.0, 0.0, 73.0, 122.0, 0.0, 16.0, 7.0, 0.0, 113.0, 0.0, 81.0, 63.0, 183.0, 0.0, 0.0, 137.0, 136.0, 64.0, 0.0, 0.0, 0.0, 0.0, 197.0, 2.0, 2.0, 0.0, 2.0, 6.0, 0.0, 0.0, 0.0, 0.0, 147.0, 5.0, 15.0, 0.0, 8.0, 0.0, 37.0, 4.0, 0.0, 2.0, 20.0, 0.0, 160.0, 12.0, 17.0, 0.0, 63.0, 60.0, 0.0, 200.0, 7.0, 143.0, 163.0, 0.0, 167.0, 102.0, 165.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 68.0, 55.0, 79.0, 0.0, 0.0, 71.0, 88.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.144899029299171, "mean_inference_ms": 21.34173964209, "mean_action_processing_ms": 0.8035764191627713, "mean_env_wait_ms": 3.280221135105399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017499685287475586, "StateBufferConnector_ms": 0.007550597190856934, "ViewRequirementAgentConnector_ms": 0.4791679382324219}, "num_episodes": 18, "episode_return_max": 360.0, "episode_return_min": -413.0, "episode_return_mean": 153.05, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 128.89761505450673, "num_env_steps_trained_throughput_per_sec": 128.89761505450673, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 28226.15, "restore_workers_time_ms": 0.028, "training_step_time_ms": 28226.061, "sample_time_ms": 6510.953, "learn_time_ms": 21647.677, "learn_throughput": 184.777, "synch_weights_time_ms": 59.456}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "45bed_00000", "date": "2024-08-13_03-00-32", "timestamp": 1723532432, "time_this_iter_s": 31.13271975517273, "time_total_s": 6616.3466691970825, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x330761310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6616.3466691970825, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 88.39772727272728, "ram_util_percent": 83.08863636363638}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0725072743755484, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2426846803811493, "policy_loss": -0.0007203986997612649, "vf_loss": 2.243405078138624, "vf_explained_var": 0.002203100982797209, "kl": 0.0017545481689649756, "entropy": 0.2799165767336649, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.762110592511597, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.258223488469604, "policy_loss": -0.002643421314232958, "vf_loss": 8.260866934912546, "vf_explained_var": 0.02903259112721398, "kl": 0.005178340745087507, "entropy": 0.8271919997280868, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 356.0, "episode_reward_min": -357.0, "episode_reward_mean": 150.17, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 39.8, "predator_policy": 35.285}, "custom_metrics": {}, "hist_stats": {"episode_reward": [299.0, 283.0, 199.0, 284.0, 282.0, 45.0, 296.0, 186.0, 178.0, 237.0, 209.0, 150.0, 314.0, 15.0, 244.0, 323.0, 116.0, 353.0, 179.0, 279.0, 284.0, 172.0, 165.0, 333.0, 278.0, 98.0, 227.0, 341.0, 281.0, 184.0, -259.0, -75.0, 176.0, -198.0, 191.0, 231.0, -219.0, 169.0, -21.0, 228.0, 65.0, 198.0, -9.0, 269.0, 138.0, 215.0, 212.0, -357.0, 244.0, 296.0, 284.0, 270.0, 38.0, 194.0, 261.0, 252.0, 211.0, 231.0, -238.0, 57.0, -20.0, 178.0, -56.0, 100.0, -60.0, -224.0, 281.0, 296.0, 278.0, 133.0, 172.0, 275.0, 356.0, 155.0, 215.0, 304.0, 165.0, 236.0, 93.0, 91.0, 118.0, 111.0, 229.0, -57.0, 93.0, 232.0, -3.0, 73.0, 27.0, 98.0, 27.0, 222.0, 97.0, 68.0, 294.0, 200.0, 73.0, 56.0, 176.0, 27.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [132.0, 161.0, 164.0, 105.0, -75.0, 176.0, 161.0, 122.0, 160.0, 89.0, -163.0, -117.0, 158.0, 138.0, 134.0, 23.0, 98.0, 56.0, 113.0, 88.0, 51.0, 158.0, 104.0, 46.0, 187.0, 127.0, 3.0, -118.0, 83.0, 145.0, 164.0, 156.0, 145.0, -70.0, 162.0, 191.0, 154.0, 4.0, 104.0, 165.0, 167.0, 116.0, 147.0, 18.0, -40.0, 173.0, 154.0, 179.0, 124.0, 145.0, -190.0, 109.0, 75.0, 107.0, 155.0, 186.0, 92.0, 180.0, 177.0, -101.0, -382.0, -188.0, -394.0, 121.0, 22.0, 101.0, -152.0, -273.0, 175.0, -60.0, 125.0, 80.0, -240.0, -362.0, 164.0, -68.0, -243.0, 100.0, 61.0, 144.0, -139.0, 91.0, 160.0, -43.0, 107.0, -362.0, 170.0, 99.0, 139.0, -274.0, 4.0, 147.0, 92.0, 120.0, -364.0, -190.0, 129.0, 111.0, 165.0, 129.0, 154.0, 124.0, 165.0, 105.0, 156.0, -265.0, 59.0, 115.0, 156.0, 97.0, 200.0, 15.0, 102.0, 105.0, 84.0, 125.0, -286.0, -112.0, 16.0, 12.0, 5.0, -88.0, -24.0, 142.0, -400.0, 137.0, 92.0, -298.0, 90.0, -317.0, -256.0, -235.0, 141.0, 138.0, 198.0, 97.0, 114.0, 161.0, 130.0, 3.0, 71.0, 97.0, 159.0, 116.0, 176.0, 180.0, 124.0, -47.0, -64.0, 145.0, 104.0, 200.0, -87.0, 93.0, 130.0, 59.0, 15.0, 24.0, 14.0, 77.0, 67.0, -29.0, -25.0, 67.0, 52.0, 177.0, -202.0, 11.0, -105.0, 105.0, 74.0, 128.0, 0.0, -64.0, -135.0, 100.0, -245.0, 106.0, 33.0, 55.0, -8.0, -96.0, 109.0, 95.0, -185.0, 38.0, 43.0, 15.0, 190.0, 104.0, 3.0, 161.0, 0.0, 73.0, 33.0, -39.0, 91.0, 85.0, -106.0, -38.0], "policy_predator_policy_reward": [0.0, 6.0, 12.0, 2.0, 8.0, 90.0, 0.0, 1.0, 20.0, 13.0, 157.0, 168.0, 0.0, 0.0, 12.0, 17.0, 18.0, 6.0, 28.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 90.0, 10.0, 6.0, 0.0, 3.0, 0.0, 41.0, 0.0, 0.0, 0.0, 21.0, 10.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 32.0, 0.0, 0.0, 9.0, 0.0, 92.0, 87.0, 0.0, 45.0, 0.0, 0.0, 0.0, 9.0, 8.0, 100.0, 120.0, 191.0, 198.0, 0.0, 0.0, 53.0, 85.0, 142.0, 76.0, 0.0, 26.0, 0.0, 187.0, 196.0, 0.0, 73.0, 122.0, 0.0, 16.0, 7.0, 0.0, 113.0, 0.0, 81.0, 63.0, 183.0, 0.0, 0.0, 137.0, 136.0, 64.0, 0.0, 0.0, 0.0, 0.0, 197.0, 2.0, 2.0, 0.0, 2.0, 6.0, 0.0, 0.0, 0.0, 0.0, 147.0, 5.0, 15.0, 0.0, 8.0, 0.0, 37.0, 4.0, 0.0, 2.0, 20.0, 0.0, 160.0, 12.0, 17.0, 0.0, 63.0, 60.0, 0.0, 200.0, 7.0, 143.0, 163.0, 0.0, 167.0, 102.0, 165.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 68.0, 55.0, 79.0, 0.0, 0.0, 71.0, 88.0, 47.0, 0.0, 0.0, 54.0, 0.0, 0.0, 80.0, 0.0, 0.0, 69.0, 0.0, 0.0, 0.0, 134.0, 0.0, 93.0, 30.0, 0.0, 0.0, 61.0, 99.0, 9.0, 143.0, 23.0, 6.0, 4.0, 131.0, 0.0, 18.0, 0.0, 121.0, 123.0, 0.0, 10.0, 0.0, 0.0, 35.0, 1.0, 0.0, 0.0, 0.0, 62.0, 0.0, 0.0, 77.0, 94.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.569099288818291, "mean_inference_ms": 20.69261641251599, "mean_action_processing_ms": 0.8099994501833517, "mean_env_wait_ms": 3.2597412121957383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011195063591003418, "StateBufferConnector_ms": 0.013341307640075684, "ViewRequirementAgentConnector_ms": 0.40504002571105957}, "num_episodes": 23, "episode_return_max": 356.0, "episode_return_min": -357.0, "episode_return_mean": 150.17, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 129.13825948898824, "num_env_steps_trained_throughput_per_sec": 129.13825948898824, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 28641.001, "restore_workers_time_ms": 0.028, "training_step_time_ms": 28640.914, "sample_time_ms": 6477.336, "learn_time_ms": 22108.377, "learn_throughput": 180.927, "synch_weights_time_ms": 47.048}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": false, "training_iteration": 100, "trial_id": "45bed_00000", "date": "2024-08-13_03-01-04", "timestamp": 1723532464, "time_this_iter_s": 31.025635957717896, "time_total_s": 6647.3723051548, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b51fb8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6647.3723051548, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 88.11363636363636, "ram_util_percent": 83.2090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9553771438855658, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.440748962018856, "policy_loss": -0.0013939825505037944, "vf_loss": 3.442142936413881, "vf_explained_var": 0.0026880532976180788, "kl": 0.005809627058033052, "entropy": 0.3359625727174774, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 189945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.179934654853962, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.5978456418980995, "policy_loss": -0.0027673433786110273, "vf_loss": 7.600612970887038, "vf_explained_var": 0.01516968185308749, "kl": 0.003960167608202427, "entropy": 0.7665305779724525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 189945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 1616000}, "env_runners": {"episode_reward_max": 356.0, "episode_reward_min": -524.0, "episode_reward_mean": 122.14, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 18.83, "predator_policy": 42.24}, "custom_metrics": {}, "hist_stats": {"episode_reward": [179.0, 279.0, 284.0, 172.0, 165.0, 333.0, 278.0, 98.0, 227.0, 341.0, 281.0, 184.0, -259.0, -75.0, 176.0, -198.0, 191.0, 231.0, -219.0, 169.0, -21.0, 228.0, 65.0, 198.0, -9.0, 269.0, 138.0, 215.0, 212.0, -357.0, 244.0, 296.0, 284.0, 270.0, 38.0, 194.0, 261.0, 252.0, 211.0, 231.0, -238.0, 57.0, -20.0, 178.0, -56.0, 100.0, -60.0, -224.0, 281.0, 296.0, 278.0, 133.0, 172.0, 275.0, 356.0, 155.0, 215.0, 304.0, 165.0, 236.0, 93.0, 91.0, 118.0, 111.0, 229.0, -57.0, 93.0, 232.0, -3.0, 73.0, 27.0, 98.0, 27.0, 222.0, 97.0, 68.0, 294.0, 200.0, 73.0, 56.0, 176.0, 27.0, 190.0, -27.0, -93.0, 53.0, 299.0, 219.0, 143.0, 4.0, -24.0, -73.0, 163.0, -47.0, 254.0, 249.0, -64.0, -524.0, 252.0, 236.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [154.0, 4.0, 104.0, 165.0, 167.0, 116.0, 147.0, 18.0, -40.0, 173.0, 154.0, 179.0, 124.0, 145.0, -190.0, 109.0, 75.0, 107.0, 155.0, 186.0, 92.0, 180.0, 177.0, -101.0, -382.0, -188.0, -394.0, 121.0, 22.0, 101.0, -152.0, -273.0, 175.0, -60.0, 125.0, 80.0, -240.0, -362.0, 164.0, -68.0, -243.0, 100.0, 61.0, 144.0, -139.0, 91.0, 160.0, -43.0, 107.0, -362.0, 170.0, 99.0, 139.0, -274.0, 4.0, 147.0, 92.0, 120.0, -364.0, -190.0, 129.0, 111.0, 165.0, 129.0, 154.0, 124.0, 165.0, 105.0, 156.0, -265.0, 59.0, 115.0, 156.0, 97.0, 200.0, 15.0, 102.0, 105.0, 84.0, 125.0, -286.0, -112.0, 16.0, 12.0, 5.0, -88.0, -24.0, 142.0, -400.0, 137.0, 92.0, -298.0, 90.0, -317.0, -256.0, -235.0, 141.0, 138.0, 198.0, 97.0, 114.0, 161.0, 130.0, 3.0, 71.0, 97.0, 159.0, 116.0, 176.0, 180.0, 124.0, -47.0, -64.0, 145.0, 104.0, 200.0, -87.0, 93.0, 130.0, 59.0, 15.0, 24.0, 14.0, 77.0, 67.0, -29.0, -25.0, 67.0, 52.0, 177.0, -202.0, 11.0, -105.0, 105.0, 74.0, 128.0, 0.0, -64.0, -135.0, 100.0, -245.0, 106.0, 33.0, 55.0, -8.0, -96.0, 109.0, 95.0, -185.0, 38.0, 43.0, 15.0, 190.0, 104.0, 3.0, 161.0, 0.0, 73.0, 33.0, -39.0, 91.0, 85.0, -106.0, -38.0, -6.0, 40.0, 125.0, -333.0, 14.0, -284.0, -103.0, 67.0, 133.0, 148.0, 62.0, 71.0, 48.0, 95.0, -319.0, 156.0, -36.0, -109.0, 127.0, -400.0, -158.0, 103.0, -278.0, -70.0, 165.0, 69.0, 49.0, 200.0, -370.0, 119.0, -340.0, -377.0, 153.0, 99.0, 63.0, 140.0], "policy_predator_policy_reward": [0.0, 21.0, 10.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 32.0, 0.0, 0.0, 9.0, 0.0, 92.0, 87.0, 0.0, 45.0, 0.0, 0.0, 0.0, 9.0, 8.0, 100.0, 120.0, 191.0, 198.0, 0.0, 0.0, 53.0, 85.0, 142.0, 76.0, 0.0, 26.0, 0.0, 187.0, 196.0, 0.0, 73.0, 122.0, 0.0, 16.0, 7.0, 0.0, 113.0, 0.0, 81.0, 63.0, 183.0, 0.0, 0.0, 137.0, 136.0, 64.0, 0.0, 0.0, 0.0, 0.0, 197.0, 2.0, 2.0, 0.0, 2.0, 6.0, 0.0, 0.0, 0.0, 0.0, 147.0, 5.0, 15.0, 0.0, 8.0, 0.0, 37.0, 4.0, 0.0, 2.0, 20.0, 0.0, 160.0, 12.0, 17.0, 0.0, 63.0, 60.0, 0.0, 200.0, 7.0, 143.0, 163.0, 0.0, 167.0, 102.0, 165.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 68.0, 55.0, 79.0, 0.0, 0.0, 71.0, 88.0, 47.0, 0.0, 0.0, 54.0, 0.0, 0.0, 80.0, 0.0, 0.0, 69.0, 0.0, 0.0, 0.0, 134.0, 0.0, 93.0, 30.0, 0.0, 0.0, 61.0, 99.0, 9.0, 143.0, 23.0, 6.0, 4.0, 131.0, 0.0, 18.0, 0.0, 121.0, 123.0, 0.0, 10.0, 0.0, 0.0, 35.0, 1.0, 0.0, 0.0, 0.0, 62.0, 0.0, 0.0, 77.0, 94.0, 74.0, 82.0, 181.0, 0.0, 177.0, 0.0, 89.0, 0.0, 18.0, 0.0, 40.0, 46.0, 0.0, 0.0, 167.0, 0.0, 103.0, 18.0, 0.0, 200.0, 103.0, 115.0, 159.0, 142.0, 9.0, 11.0, 0.0, 0.0, 0.0, 187.0, 0.0, 193.0, 0.0, 0.0, 0.0, 33.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.037942696880801, "mean_inference_ms": 21.042169276569506, "mean_action_processing_ms": 0.8067711993872098, "mean_env_wait_ms": 3.2343561593125827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010906338691711426, "StateBufferConnector_ms": 0.01525270938873291, "ViewRequirementAgentConnector_ms": 0.39309442043304443}, "num_episodes": 18, "episode_return_max": 356.0, "episode_return_min": -524.0, "episode_return_mean": 122.14, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 1616000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 128.15643215741957, "num_env_steps_trained_throughput_per_sec": 128.15643215741957, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 1616000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1616000, "timers": {"training_iteration_time_ms": 29201.27, "restore_workers_time_ms": 0.027, "training_step_time_ms": 29201.184, "sample_time_ms": 6241.832, "learn_time_ms": 22908.488, "learn_throughput": 174.608, "synch_weights_time_ms": 42.873}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 1616000}, "done": false, "training_iteration": 101, "trial_id": "45bed_00000", "date": "2024-08-13_03-01-35", "timestamp": 1723532495, "time_this_iter_s": 31.296091318130493, "time_total_s": 6678.668396472931, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b52113a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6678.668396472931, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 87.10227272727273, "ram_util_percent": 83.12954545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2000892847855256, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9563548076720463, "policy_loss": -0.0015620129961500724, "vf_loss": 2.957916828438088, "vf_explained_var": 0.003282286281938906, "kl": 0.004520485241184283, "entropy": 0.34155013784371985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 191835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.572636895236514, "cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.601206700259415, "policy_loss": -0.0010260989638193258, "vf_loss": 7.602232799832783, "vf_explained_var": 0.06885572605662876, "kl": 0.003387339986608739, "entropy": 0.7959340638584561, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 191835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "env_runners": {"episode_reward_max": 356.0, "episode_reward_min": -524.0, "episode_reward_mean": 116.21, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 15.015, "predator_policy": 43.09}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-219.0, 169.0, -21.0, 228.0, 65.0, 198.0, -9.0, 269.0, 138.0, 215.0, 212.0, -357.0, 244.0, 296.0, 284.0, 270.0, 38.0, 194.0, 261.0, 252.0, 211.0, 231.0, -238.0, 57.0, -20.0, 178.0, -56.0, 100.0, -60.0, -224.0, 281.0, 296.0, 278.0, 133.0, 172.0, 275.0, 356.0, 155.0, 215.0, 304.0, 165.0, 236.0, 93.0, 91.0, 118.0, 111.0, 229.0, -57.0, 93.0, 232.0, -3.0, 73.0, 27.0, 98.0, 27.0, 222.0, 97.0, 68.0, 294.0, 200.0, 73.0, 56.0, 176.0, 27.0, 190.0, -27.0, -93.0, 53.0, 299.0, 219.0, 143.0, 4.0, -24.0, -73.0, 163.0, -47.0, 254.0, 249.0, -64.0, -524.0, 252.0, 236.0, 224.0, 127.0, 335.0, 29.0, 13.0, 140.0, 189.0, 308.0, 305.0, -187.0, 11.0, 197.0, 204.0, 158.0, 108.0, -114.0, 174.0, 73.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-240.0, -362.0, 164.0, -68.0, -243.0, 100.0, 61.0, 144.0, -139.0, 91.0, 160.0, -43.0, 107.0, -362.0, 170.0, 99.0, 139.0, -274.0, 4.0, 147.0, 92.0, 120.0, -364.0, -190.0, 129.0, 111.0, 165.0, 129.0, 154.0, 124.0, 165.0, 105.0, 156.0, -265.0, 59.0, 115.0, 156.0, 97.0, 200.0, 15.0, 102.0, 105.0, 84.0, 125.0, -286.0, -112.0, 16.0, 12.0, 5.0, -88.0, -24.0, 142.0, -400.0, 137.0, 92.0, -298.0, 90.0, -317.0, -256.0, -235.0, 141.0, 138.0, 198.0, 97.0, 114.0, 161.0, 130.0, 3.0, 71.0, 97.0, 159.0, 116.0, 176.0, 180.0, 124.0, -47.0, -64.0, 145.0, 104.0, 200.0, -87.0, 93.0, 130.0, 59.0, 15.0, 24.0, 14.0, 77.0, 67.0, -29.0, -25.0, 67.0, 52.0, 177.0, -202.0, 11.0, -105.0, 105.0, 74.0, 128.0, 0.0, -64.0, -135.0, 100.0, -245.0, 106.0, 33.0, 55.0, -8.0, -96.0, 109.0, 95.0, -185.0, 38.0, 43.0, 15.0, 190.0, 104.0, 3.0, 161.0, 0.0, 73.0, 33.0, -39.0, 91.0, 85.0, -106.0, -38.0, -6.0, 40.0, 125.0, -333.0, 14.0, -284.0, -103.0, 67.0, 133.0, 148.0, 62.0, 71.0, 48.0, 95.0, -319.0, 156.0, -36.0, -109.0, 127.0, -400.0, -158.0, 103.0, -278.0, -70.0, 165.0, 69.0, 49.0, 200.0, -370.0, 119.0, -340.0, -377.0, 153.0, 99.0, 63.0, 140.0, 127.0, 67.0, 45.0, 42.0, 185.0, 147.0, 23.0, -266.0, -215.0, 91.0, 41.0, 38.0, 99.0, 72.0, 116.0, 192.0, 134.0, 171.0, 0.0, -374.0, 132.0, -270.0, 157.0, -243.0, 97.0, 107.0, 122.0, 36.0, 50.0, 18.0, -182.0, -153.0, 69.0, 64.0, 73.0, 0.0], "policy_predator_policy_reward": [187.0, 196.0, 0.0, 73.0, 122.0, 0.0, 16.0, 7.0, 0.0, 113.0, 0.0, 81.0, 63.0, 183.0, 0.0, 0.0, 137.0, 136.0, 64.0, 0.0, 0.0, 0.0, 0.0, 197.0, 2.0, 2.0, 0.0, 2.0, 6.0, 0.0, 0.0, 0.0, 0.0, 147.0, 5.0, 15.0, 0.0, 8.0, 0.0, 37.0, 4.0, 0.0, 2.0, 20.0, 0.0, 160.0, 12.0, 17.0, 0.0, 63.0, 60.0, 0.0, 200.0, 7.0, 143.0, 163.0, 0.0, 167.0, 102.0, 165.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 68.0, 55.0, 79.0, 0.0, 0.0, 71.0, 88.0, 47.0, 0.0, 0.0, 54.0, 0.0, 0.0, 80.0, 0.0, 0.0, 69.0, 0.0, 0.0, 0.0, 134.0, 0.0, 93.0, 30.0, 0.0, 0.0, 61.0, 99.0, 9.0, 143.0, 23.0, 6.0, 4.0, 131.0, 0.0, 18.0, 0.0, 121.0, 123.0, 0.0, 10.0, 0.0, 0.0, 35.0, 1.0, 0.0, 0.0, 0.0, 62.0, 0.0, 0.0, 77.0, 94.0, 74.0, 82.0, 181.0, 0.0, 177.0, 0.0, 89.0, 0.0, 18.0, 0.0, 40.0, 46.0, 0.0, 0.0, 167.0, 0.0, 103.0, 18.0, 0.0, 200.0, 103.0, 115.0, 159.0, 142.0, 9.0, 11.0, 0.0, 0.0, 0.0, 187.0, 0.0, 193.0, 0.0, 0.0, 0.0, 33.0, 30.0, 0.0, 17.0, 23.0, 3.0, 0.0, 138.0, 134.0, 137.0, 0.0, 10.0, 51.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 187.0, 149.0, 0.0, 142.0, 141.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 104.0, 117.0, 0.0, 41.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.993456842254364, "mean_inference_ms": 20.90595324926348, "mean_action_processing_ms": 0.8076387322132643, "mean_env_wait_ms": 3.211574952837275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009160876274108887, "StateBufferConnector_ms": 0.015476226806640625, "ViewRequirementAgentConnector_ms": 0.36974143981933594}, "num_episodes": 18, "episode_return_max": 356.0, "episode_return_min": -524.0, "episode_return_mean": 116.21, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 131.64715200821664, "num_env_steps_trained_throughput_per_sec": 131.64715200821664, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 1632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1632000, "timers": {"training_iteration_time_ms": 29605.962, "restore_workers_time_ms": 0.029, "training_step_time_ms": 29605.85, "sample_time_ms": 5938.22, "learn_time_ms": 23617.264, "learn_throughput": 169.368, "synch_weights_time_ms": 42.995}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "done": false, "training_iteration": 102, "trial_id": "45bed_00000", "date": "2024-08-13_03-02-05", "timestamp": 1723532525, "time_this_iter_s": 30.43996000289917, "time_total_s": 6709.10835647583, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3306a4670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6709.10835647583, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 87.77674418604653, "ram_util_percent": 83.0139534883721}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1631332933232583, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0648775593944326, "policy_loss": -0.003042236714816046, "vf_loss": 2.067919793299266, "vf_explained_var": 0.0010000309616169602, "kl": 0.004640930040680077, "entropy": 0.33017735275484267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 193725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.828223555901694, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.56580413788084, "policy_loss": -0.003063051252891975, "vf_loss": 8.568867201779886, "vf_explained_var": -0.012380139600662959, "kl": 0.006680429199469351, "entropy": 0.9138074364296342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 193725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 1648000}, "env_runners": {"episode_reward_max": 356.0, "episode_reward_min": -524.0, "episode_reward_mean": 108.41, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 11.675, "predator_policy": 42.53}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-238.0, 57.0, -20.0, 178.0, -56.0, 100.0, -60.0, -224.0, 281.0, 296.0, 278.0, 133.0, 172.0, 275.0, 356.0, 155.0, 215.0, 304.0, 165.0, 236.0, 93.0, 91.0, 118.0, 111.0, 229.0, -57.0, 93.0, 232.0, -3.0, 73.0, 27.0, 98.0, 27.0, 222.0, 97.0, 68.0, 294.0, 200.0, 73.0, 56.0, 176.0, 27.0, 190.0, -27.0, -93.0, 53.0, 299.0, 219.0, 143.0, 4.0, -24.0, -73.0, 163.0, -47.0, 254.0, 249.0, -64.0, -524.0, 252.0, 236.0, 224.0, 127.0, 335.0, 29.0, 13.0, 140.0, 189.0, 308.0, 305.0, -187.0, 11.0, 197.0, 204.0, 158.0, 108.0, -114.0, 174.0, 73.0, 340.0, 155.0, 172.0, 31.0, -25.0, 40.0, 165.0, 261.0, 69.0, 74.0, -70.0, 48.0, 95.0, 189.0, 178.0, 126.0, -17.0, -48.0, 167.0, 303.0, 122.0, 14.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-286.0, -112.0, 16.0, 12.0, 5.0, -88.0, -24.0, 142.0, -400.0, 137.0, 92.0, -298.0, 90.0, -317.0, -256.0, -235.0, 141.0, 138.0, 198.0, 97.0, 114.0, 161.0, 130.0, 3.0, 71.0, 97.0, 159.0, 116.0, 176.0, 180.0, 124.0, -47.0, -64.0, 145.0, 104.0, 200.0, -87.0, 93.0, 130.0, 59.0, 15.0, 24.0, 14.0, 77.0, 67.0, -29.0, -25.0, 67.0, 52.0, 177.0, -202.0, 11.0, -105.0, 105.0, 74.0, 128.0, 0.0, -64.0, -135.0, 100.0, -245.0, 106.0, 33.0, 55.0, -8.0, -96.0, 109.0, 95.0, -185.0, 38.0, 43.0, 15.0, 190.0, 104.0, 3.0, 161.0, 0.0, 73.0, 33.0, -39.0, 91.0, 85.0, -106.0, -38.0, -6.0, 40.0, 125.0, -333.0, 14.0, -284.0, -103.0, 67.0, 133.0, 148.0, 62.0, 71.0, 48.0, 95.0, -319.0, 156.0, -36.0, -109.0, 127.0, -400.0, -158.0, 103.0, -278.0, -70.0, 165.0, 69.0, 49.0, 200.0, -370.0, 119.0, -340.0, -377.0, 153.0, 99.0, 63.0, 140.0, 127.0, 67.0, 45.0, 42.0, 185.0, 147.0, 23.0, -266.0, -215.0, 91.0, 41.0, 38.0, 99.0, 72.0, 116.0, 192.0, 134.0, 171.0, 0.0, -374.0, 132.0, -270.0, 157.0, -243.0, 97.0, 107.0, 122.0, 36.0, 50.0, 18.0, -182.0, -153.0, 69.0, 64.0, 73.0, 0.0, 183.0, 157.0, 50.0, 105.0, 105.0, 67.0, -307.0, 157.0, 140.0, -330.0, -68.0, 20.0, 24.0, 132.0, 161.0, 51.0, 38.0, 31.0, 0.0, -103.0, -319.0, 70.0, -84.0, -21.0, 37.0, 42.0, 102.0, 50.0, 46.0, 101.0, -11.0, 116.0, 87.0, -257.0, -320.0, 105.0, 68.0, 73.0, 154.0, 140.0, -137.0, 67.0, 17.0, -63.0], "policy_predator_policy_reward": [0.0, 160.0, 12.0, 17.0, 0.0, 63.0, 60.0, 0.0, 200.0, 7.0, 143.0, 163.0, 0.0, 167.0, 102.0, 165.0, 2.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 68.0, 55.0, 79.0, 0.0, 0.0, 71.0, 88.0, 47.0, 0.0, 0.0, 54.0, 0.0, 0.0, 80.0, 0.0, 0.0, 69.0, 0.0, 0.0, 0.0, 134.0, 0.0, 93.0, 30.0, 0.0, 0.0, 61.0, 99.0, 9.0, 143.0, 23.0, 6.0, 4.0, 131.0, 0.0, 18.0, 0.0, 121.0, 123.0, 0.0, 10.0, 0.0, 0.0, 35.0, 1.0, 0.0, 0.0, 0.0, 62.0, 0.0, 0.0, 77.0, 94.0, 74.0, 82.0, 181.0, 0.0, 177.0, 0.0, 89.0, 0.0, 18.0, 0.0, 40.0, 46.0, 0.0, 0.0, 167.0, 0.0, 103.0, 18.0, 0.0, 200.0, 103.0, 115.0, 159.0, 142.0, 9.0, 11.0, 0.0, 0.0, 0.0, 187.0, 0.0, 193.0, 0.0, 0.0, 0.0, 33.0, 30.0, 0.0, 17.0, 23.0, 3.0, 0.0, 138.0, 134.0, 137.0, 0.0, 10.0, 51.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 187.0, 149.0, 0.0, 142.0, 141.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 104.0, 117.0, 0.0, 41.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 141.0, 0.0, 165.0, 0.0, 88.0, 0.0, 9.0, 0.0, 49.0, 0.0, 0.0, 83.0, 94.0, 161.0, 18.0, 77.0, 76.0, 0.0, 16.0, 37.0, 0.0, 31.0, 0.0, 21.0, 0.0, 145.0, 8.0, 167.0, 0.0, 26.0, 0.0, 9.0, 0.0, 90.0, 102.0, 60.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.948915520822275, "mean_inference_ms": 20.737318557391568, "mean_action_processing_ms": 0.8083593502295033, "mean_env_wait_ms": 3.1774432442957705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009228944778442383, "StateBufferConnector_ms": 0.01625955104827881, "ViewRequirementAgentConnector_ms": 0.35173332691192627}, "num_episodes": 22, "episode_return_max": 356.0, "episode_return_min": -524.0, "episode_return_mean": 108.41, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 1648000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 127.10264689577885, "num_env_steps_trained_throughput_per_sec": 127.10264689577885, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 1648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1648000, "timers": {"training_iteration_time_ms": 29871.22, "restore_workers_time_ms": 0.028, "training_step_time_ms": 29871.112, "sample_time_ms": 5466.115, "learn_time_ms": 24358.418, "learn_throughput": 164.214, "synch_weights_time_ms": 39.551}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 1648000}, "done": false, "training_iteration": 103, "trial_id": "45bed_00000", "date": "2024-08-13_03-02-37", "timestamp": 1723532557, "time_this_iter_s": 31.53333306312561, "time_total_s": 6740.641689538956, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44b35e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6740.641689538956, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 87.97272727272727, "ram_util_percent": 83.23636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7446888804396309, "cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.352719348069852, "policy_loss": -0.0003492435620279697, "vf_loss": 1.3530685922140797, "vf_explained_var": 0.0016534833050278759, "kl": 0.002332577536722615, "entropy": 0.34564750699139146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 195615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.68366527115857, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.755054383050828, "policy_loss": -0.005571938502705759, "vf_loss": 8.760626312286135, "vf_explained_var": -0.16969661198595845, "kl": 0.008688068175109186, "entropy": 0.8733892282796285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 195615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000}, "env_runners": {"episode_reward_max": 340.0, "episode_reward_min": -524.0, "episode_reward_mean": 111.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 17.26, "predator_policy": 38.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [165.0, 236.0, 93.0, 91.0, 118.0, 111.0, 229.0, -57.0, 93.0, 232.0, -3.0, 73.0, 27.0, 98.0, 27.0, 222.0, 97.0, 68.0, 294.0, 200.0, 73.0, 56.0, 176.0, 27.0, 190.0, -27.0, -93.0, 53.0, 299.0, 219.0, 143.0, 4.0, -24.0, -73.0, 163.0, -47.0, 254.0, 249.0, -64.0, -524.0, 252.0, 236.0, 224.0, 127.0, 335.0, 29.0, 13.0, 140.0, 189.0, 308.0, 305.0, -187.0, 11.0, 197.0, 204.0, 158.0, 108.0, -114.0, 174.0, 73.0, 340.0, 155.0, 172.0, 31.0, -25.0, 40.0, 165.0, 261.0, 69.0, 74.0, -70.0, 48.0, 95.0, 189.0, 178.0, 126.0, -17.0, -48.0, 167.0, 303.0, 122.0, 14.0, 85.0, 131.0, 137.0, 153.0, 135.0, 293.0, 207.0, 163.0, -64.0, 203.0, 116.0, 153.0, 179.0, -102.0, 254.0, 199.0, 145.0, 96.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-87.0, 93.0, 130.0, 59.0, 15.0, 24.0, 14.0, 77.0, 67.0, -29.0, -25.0, 67.0, 52.0, 177.0, -202.0, 11.0, -105.0, 105.0, 74.0, 128.0, 0.0, -64.0, -135.0, 100.0, -245.0, 106.0, 33.0, 55.0, -8.0, -96.0, 109.0, 95.0, -185.0, 38.0, 43.0, 15.0, 190.0, 104.0, 3.0, 161.0, 0.0, 73.0, 33.0, -39.0, 91.0, 85.0, -106.0, -38.0, -6.0, 40.0, 125.0, -333.0, 14.0, -284.0, -103.0, 67.0, 133.0, 148.0, 62.0, 71.0, 48.0, 95.0, -319.0, 156.0, -36.0, -109.0, 127.0, -400.0, -158.0, 103.0, -278.0, -70.0, 165.0, 69.0, 49.0, 200.0, -370.0, 119.0, -340.0, -377.0, 153.0, 99.0, 63.0, 140.0, 127.0, 67.0, 45.0, 42.0, 185.0, 147.0, 23.0, -266.0, -215.0, 91.0, 41.0, 38.0, 99.0, 72.0, 116.0, 192.0, 134.0, 171.0, 0.0, -374.0, 132.0, -270.0, 157.0, -243.0, 97.0, 107.0, 122.0, 36.0, 50.0, 18.0, -182.0, -153.0, 69.0, 64.0, 73.0, 0.0, 183.0, 157.0, 50.0, 105.0, 105.0, 67.0, -307.0, 157.0, 140.0, -330.0, -68.0, 20.0, 24.0, 132.0, 161.0, 51.0, 38.0, 31.0, 0.0, -103.0, -319.0, 70.0, -84.0, -21.0, 37.0, 42.0, 102.0, 50.0, 46.0, 101.0, -11.0, 116.0, 87.0, -257.0, -320.0, 105.0, 68.0, 73.0, 154.0, 140.0, -137.0, 67.0, 17.0, -63.0, 0.0, 85.0, 90.0, -7.0, 73.0, -25.0, 71.0, -33.0, 133.0, 0.0, 172.0, 121.0, 56.0, 148.0, 82.0, 81.0, -130.0, -19.0, 80.0, 123.0, 31.0, 79.0, 143.0, 10.0, 55.0, 124.0, 67.0, -338.0, 95.0, 159.0, 133.0, 23.0, 93.0, 48.0, 83.0, -68.0], "policy_predator_policy_reward": [71.0, 88.0, 47.0, 0.0, 0.0, 54.0, 0.0, 0.0, 80.0, 0.0, 0.0, 69.0, 0.0, 0.0, 0.0, 134.0, 0.0, 93.0, 30.0, 0.0, 0.0, 61.0, 99.0, 9.0, 143.0, 23.0, 6.0, 4.0, 131.0, 0.0, 18.0, 0.0, 121.0, 123.0, 0.0, 10.0, 0.0, 0.0, 35.0, 1.0, 0.0, 0.0, 0.0, 62.0, 0.0, 0.0, 77.0, 94.0, 74.0, 82.0, 181.0, 0.0, 177.0, 0.0, 89.0, 0.0, 18.0, 0.0, 40.0, 46.0, 0.0, 0.0, 167.0, 0.0, 103.0, 18.0, 0.0, 200.0, 103.0, 115.0, 159.0, 142.0, 9.0, 11.0, 0.0, 0.0, 0.0, 187.0, 0.0, 193.0, 0.0, 0.0, 0.0, 33.0, 30.0, 0.0, 17.0, 23.0, 3.0, 0.0, 138.0, 134.0, 137.0, 0.0, 10.0, 51.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 187.0, 149.0, 0.0, 142.0, 141.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 104.0, 117.0, 0.0, 41.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 141.0, 0.0, 165.0, 0.0, 88.0, 0.0, 9.0, 0.0, 49.0, 0.0, 0.0, 83.0, 94.0, 161.0, 18.0, 77.0, 76.0, 0.0, 16.0, 37.0, 0.0, 31.0, 0.0, 21.0, 0.0, 145.0, 8.0, 167.0, 0.0, 26.0, 0.0, 9.0, 0.0, 90.0, 102.0, 60.0, 0.0, 0.0, 0.0, 48.0, 0.0, 62.0, 27.0, 59.0, 56.0, 0.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 169.0, 0.0, 0.0, 0.0, 0.0, 43.0, 4.0, 0.0, 71.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.904962126783604, "mean_inference_ms": 20.604322283815613, "mean_action_processing_ms": 0.8086939609878024, "mean_env_wait_ms": 3.1550372737342287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009141921997070312, "StateBufferConnector_ms": 0.016228795051574707, "ViewRequirementAgentConnector_ms": 0.3646843433380127}, "num_episodes": 18, "episode_return_max": 340.0, "episode_return_min": -524.0, "episode_return_mean": 111.22, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 128.14733149698338, "num_env_steps_trained_throughput_per_sec": 128.14733149698338, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 1664000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1664000, "timers": {"training_iteration_time_ms": 30177.919, "restore_workers_time_ms": 0.027, "training_step_time_ms": 30177.815, "sample_time_ms": 5071.341, "learn_time_ms": 25057.254, "learn_throughput": 159.634, "synch_weights_time_ms": 42.593}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000}, "done": false, "training_iteration": 104, "trial_id": "45bed_00000", "date": "2024-08-13_03-03-08", "timestamp": 1723532588, "time_this_iter_s": 31.361136198043823, "time_total_s": 6772.0028257369995, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44e5d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6772.0028257369995, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 87.07727272727273, "ram_util_percent": 83.23863636363635}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9517137603903258, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9391107338446159, "policy_loss": -0.0009905582897503068, "vf_loss": 1.9401012909790827, "vf_explained_var": 0.0005154726366517406, "kl": 0.006308928669448786, "entropy": 0.3330885692405953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 197505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.869070441035365, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.890036214848675, "policy_loss": -0.0026346492765855693, "vf_loss": 7.892670860744658, "vf_explained_var": -0.06882235761041995, "kl": 0.006857547569636452, "entropy": 0.9194152721021541, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 197505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": 354.0, "episode_reward_min": -524.0, "episode_reward_mean": 112.88, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 18.48, "predator_policy": 37.96}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, 190.0, -27.0, -93.0, 53.0, 299.0, 219.0, 143.0, 4.0, -24.0, -73.0, 163.0, -47.0, 254.0, 249.0, -64.0, -524.0, 252.0, 236.0, 224.0, 127.0, 335.0, 29.0, 13.0, 140.0, 189.0, 308.0, 305.0, -187.0, 11.0, 197.0, 204.0, 158.0, 108.0, -114.0, 174.0, 73.0, 340.0, 155.0, 172.0, 31.0, -25.0, 40.0, 165.0, 261.0, 69.0, 74.0, -70.0, 48.0, 95.0, 189.0, 178.0, 126.0, -17.0, -48.0, 167.0, 303.0, 122.0, 14.0, 85.0, 131.0, 137.0, 153.0, 135.0, 293.0, 207.0, 163.0, -64.0, 203.0, 116.0, 153.0, 179.0, -102.0, 254.0, 199.0, 145.0, 96.0, 257.0, 218.0, 17.0, 231.0, 309.0, -99.0, -39.0, 161.0, 216.0, 246.0, 111.0, 210.0, 185.0, 354.0, 184.0, 185.0, 92.0, 130.0, 8.0, -342.0, -46.0, 84.0, 213.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-106.0, -38.0, -6.0, 40.0, 125.0, -333.0, 14.0, -284.0, -103.0, 67.0, 133.0, 148.0, 62.0, 71.0, 48.0, 95.0, -319.0, 156.0, -36.0, -109.0, 127.0, -400.0, -158.0, 103.0, -278.0, -70.0, 165.0, 69.0, 49.0, 200.0, -370.0, 119.0, -340.0, -377.0, 153.0, 99.0, 63.0, 140.0, 127.0, 67.0, 45.0, 42.0, 185.0, 147.0, 23.0, -266.0, -215.0, 91.0, 41.0, 38.0, 99.0, 72.0, 116.0, 192.0, 134.0, 171.0, 0.0, -374.0, 132.0, -270.0, 157.0, -243.0, 97.0, 107.0, 122.0, 36.0, 50.0, 18.0, -182.0, -153.0, 69.0, 64.0, 73.0, 0.0, 183.0, 157.0, 50.0, 105.0, 105.0, 67.0, -307.0, 157.0, 140.0, -330.0, -68.0, 20.0, 24.0, 132.0, 161.0, 51.0, 38.0, 31.0, 0.0, -103.0, -319.0, 70.0, -84.0, -21.0, 37.0, 42.0, 102.0, 50.0, 46.0, 101.0, -11.0, 116.0, 87.0, -257.0, -320.0, 105.0, 68.0, 73.0, 154.0, 140.0, -137.0, 67.0, 17.0, -63.0, 0.0, 85.0, 90.0, -7.0, 73.0, -25.0, 71.0, -33.0, 133.0, 0.0, 172.0, 121.0, 56.0, 148.0, 82.0, 81.0, -130.0, -19.0, 80.0, 123.0, 31.0, 79.0, 143.0, 10.0, 55.0, 124.0, 67.0, -338.0, 95.0, 159.0, 133.0, 23.0, 93.0, 48.0, 83.0, -68.0, 105.0, 152.0, 94.0, 124.0, 75.0, -180.0, 147.0, 74.0, 162.0, 147.0, -31.0, -282.0, -242.0, 81.0, 93.0, 68.0, 55.0, 161.0, 155.0, 91.0, -106.0, 128.0, 56.0, 154.0, 103.0, 64.0, 200.0, 154.0, 93.0, 79.0, 72.0, 82.0, 101.0, -107.0, -44.0, 105.0, -142.0, 66.0, -296.0, -396.0, -196.0, 36.0, 52.0, -52.0, 62.0, 134.0], "policy_predator_policy_reward": [77.0, 94.0, 74.0, 82.0, 181.0, 0.0, 177.0, 0.0, 89.0, 0.0, 18.0, 0.0, 40.0, 46.0, 0.0, 0.0, 167.0, 0.0, 103.0, 18.0, 0.0, 200.0, 103.0, 115.0, 159.0, 142.0, 9.0, 11.0, 0.0, 0.0, 0.0, 187.0, 0.0, 193.0, 0.0, 0.0, 0.0, 33.0, 30.0, 0.0, 17.0, 23.0, 3.0, 0.0, 138.0, 134.0, 137.0, 0.0, 10.0, 51.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 187.0, 149.0, 0.0, 142.0, 141.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 104.0, 117.0, 0.0, 41.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 141.0, 0.0, 165.0, 0.0, 88.0, 0.0, 9.0, 0.0, 49.0, 0.0, 0.0, 83.0, 94.0, 161.0, 18.0, 77.0, 76.0, 0.0, 16.0, 37.0, 0.0, 31.0, 0.0, 21.0, 0.0, 145.0, 8.0, 167.0, 0.0, 26.0, 0.0, 9.0, 0.0, 90.0, 102.0, 60.0, 0.0, 0.0, 0.0, 48.0, 0.0, 62.0, 27.0, 59.0, 56.0, 0.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 169.0, 0.0, 0.0, 0.0, 0.0, 43.0, 4.0, 0.0, 71.0, 10.0, 0.0, 0.0, 0.0, 0.0, 99.0, 23.0, 10.0, 0.0, 0.0, 0.0, 141.0, 73.0, 122.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 89.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 12.0, 0.0, 31.0, 0.0, 8.0, 90.0, 55.0, 14.0, 0.0, 84.0, 152.0, 198.0, 16.0, 98.0, 84.0, 0.0, 17.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.839648182328943, "mean_inference_ms": 20.440277309088774, "mean_action_processing_ms": 0.8088626584382184, "mean_env_wait_ms": 3.133128166537729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008606314659118652, "StateBufferConnector_ms": 0.010089397430419922, "ViewRequirementAgentConnector_ms": 0.40140700340270996}, "num_episodes": 23, "episode_return_max": 354.0, "episode_return_min": -524.0, "episode_return_mean": 112.88, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 132.86497442356432, "num_env_steps_trained_throughput_per_sec": 132.86497442356432, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 30287.878, "restore_workers_time_ms": 0.025, "training_step_time_ms": 30287.776, "sample_time_ms": 4670.899, "learn_time_ms": 25571.85, "learn_throughput": 156.422, "synch_weights_time_ms": 38.811}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 105, "trial_id": "45bed_00000", "date": "2024-08-13_03-03-39", "timestamp": 1723532619, "time_this_iter_s": 30.17877697944641, "time_total_s": 6802.181602716446, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5211ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6802.181602716446, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 86.91162790697673, "ram_util_percent": 83.28837209302326}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0907098065963183, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.280359161720074, "policy_loss": -0.0011608464802275338, "vf_loss": 2.2815200097346433, "vf_explained_var": 0.0024636039973566773, "kl": 0.0070330424128101626, "entropy": 0.4386142854495023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 199395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.372523267795799, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.492047725657306, "policy_loss": -0.000938589271975967, "vf_loss": 8.492986310474457, "vf_explained_var": -0.13260308299115095, "kl": 0.0044708491817908045, "entropy": 0.941802290570799, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 199395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000}, "env_runners": {"episode_reward_max": 359.0, "episode_reward_min": -342.0, "episode_reward_mean": 138.89, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -396.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": 39.95, "predator_policy": 29.495}, "custom_metrics": {}, "hist_stats": {"episode_reward": [236.0, 224.0, 127.0, 335.0, 29.0, 13.0, 140.0, 189.0, 308.0, 305.0, -187.0, 11.0, 197.0, 204.0, 158.0, 108.0, -114.0, 174.0, 73.0, 340.0, 155.0, 172.0, 31.0, -25.0, 40.0, 165.0, 261.0, 69.0, 74.0, -70.0, 48.0, 95.0, 189.0, 178.0, 126.0, -17.0, -48.0, 167.0, 303.0, 122.0, 14.0, 85.0, 131.0, 137.0, 153.0, 135.0, 293.0, 207.0, 163.0, -64.0, 203.0, 116.0, 153.0, 179.0, -102.0, 254.0, 199.0, 145.0, 96.0, 257.0, 218.0, 17.0, 231.0, 309.0, -99.0, -39.0, 161.0, 216.0, 246.0, 111.0, 210.0, 185.0, 354.0, 184.0, 185.0, 92.0, 130.0, 8.0, -342.0, -46.0, 84.0, 213.0, 359.0, 250.0, 100.0, 233.0, 238.0, -12.0, 233.0, 203.0, 269.0, 214.0, 177.0, 193.0, 114.0, 192.0, 261.0, 102.0, 234.0, 242.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [63.0, 140.0, 127.0, 67.0, 45.0, 42.0, 185.0, 147.0, 23.0, -266.0, -215.0, 91.0, 41.0, 38.0, 99.0, 72.0, 116.0, 192.0, 134.0, 171.0, 0.0, -374.0, 132.0, -270.0, 157.0, -243.0, 97.0, 107.0, 122.0, 36.0, 50.0, 18.0, -182.0, -153.0, 69.0, 64.0, 73.0, 0.0, 183.0, 157.0, 50.0, 105.0, 105.0, 67.0, -307.0, 157.0, 140.0, -330.0, -68.0, 20.0, 24.0, 132.0, 161.0, 51.0, 38.0, 31.0, 0.0, -103.0, -319.0, 70.0, -84.0, -21.0, 37.0, 42.0, 102.0, 50.0, 46.0, 101.0, -11.0, 116.0, 87.0, -257.0, -320.0, 105.0, 68.0, 73.0, 154.0, 140.0, -137.0, 67.0, 17.0, -63.0, 0.0, 85.0, 90.0, -7.0, 73.0, -25.0, 71.0, -33.0, 133.0, 0.0, 172.0, 121.0, 56.0, 148.0, 82.0, 81.0, -130.0, -19.0, 80.0, 123.0, 31.0, 79.0, 143.0, 10.0, 55.0, 124.0, 67.0, -338.0, 95.0, 159.0, 133.0, 23.0, 93.0, 48.0, 83.0, -68.0, 105.0, 152.0, 94.0, 124.0, 75.0, -180.0, 147.0, 74.0, 162.0, 147.0, -31.0, -282.0, -242.0, 81.0, 93.0, 68.0, 55.0, 161.0, 155.0, 91.0, -106.0, 128.0, 56.0, 154.0, 103.0, 64.0, 200.0, 154.0, 93.0, 79.0, 72.0, 82.0, 101.0, -107.0, -44.0, 105.0, -142.0, 66.0, -296.0, -396.0, -196.0, 36.0, 52.0, -52.0, 62.0, 134.0, 168.0, 190.0, 136.0, 114.0, 48.0, 33.0, 140.0, 61.0, 111.0, 127.0, -201.0, 72.0, 130.0, 103.0, 116.0, 78.0, 129.0, 140.0, 77.0, 115.0, 31.0, 93.0, 13.0, 136.0, -73.0, 74.0, 113.0, 79.0, 139.0, 122.0, -141.0, 61.0, 91.0, 143.0, 133.0, 109.0], "policy_predator_policy_reward": [0.0, 33.0, 30.0, 0.0, 17.0, 23.0, 3.0, 0.0, 138.0, 134.0, 137.0, 0.0, 10.0, 51.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 187.0, 149.0, 0.0, 142.0, 141.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 104.0, 117.0, 0.0, 41.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 141.0, 0.0, 165.0, 0.0, 88.0, 0.0, 9.0, 0.0, 49.0, 0.0, 0.0, 83.0, 94.0, 161.0, 18.0, 77.0, 76.0, 0.0, 16.0, 37.0, 0.0, 31.0, 0.0, 21.0, 0.0, 145.0, 8.0, 167.0, 0.0, 26.0, 0.0, 9.0, 0.0, 90.0, 102.0, 60.0, 0.0, 0.0, 0.0, 48.0, 0.0, 62.0, 27.0, 59.0, 56.0, 0.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 169.0, 0.0, 0.0, 0.0, 0.0, 43.0, 4.0, 0.0, 71.0, 10.0, 0.0, 0.0, 0.0, 0.0, 99.0, 23.0, 10.0, 0.0, 0.0, 0.0, 141.0, 73.0, 122.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 89.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 12.0, 0.0, 31.0, 0.0, 8.0, 90.0, 55.0, 14.0, 0.0, 84.0, 152.0, 198.0, 16.0, 98.0, 84.0, 0.0, 17.0, 0.0, 1.0, 0.0, 0.0, 0.0, 19.0, 0.0, 32.0, 0.0, 0.0, 0.0, 117.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 8.0, 14.0, 21.0, 32.0, 36.0, 8.0, 38.0, 75.0, 0.0, 0.0, 0.0, 0.0, 91.0, 91.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.797382267715465, "mean_inference_ms": 20.311056719027903, "mean_action_processing_ms": 0.8091272772420891, "mean_env_wait_ms": 3.1116677978002856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008640289306640625, "StateBufferConnector_ms": 0.01055896282196045, "ViewRequirementAgentConnector_ms": 0.39101243019104004}, "num_episodes": 18, "episode_return_max": 359.0, "episode_return_min": -342.0, "episode_return_mean": 138.89, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 89.9907858388585, "num_env_steps_trained_throughput_per_sec": 89.9907858388585, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 1696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1696000, "timers": {"training_iteration_time_ms": 32066.487, "restore_workers_time_ms": 0.025, "training_step_time_ms": 32066.384, "sample_time_ms": 4480.277, "learn_time_ms": 27543.377, "learn_throughput": 145.225, "synch_weights_time_ms": 35.908}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000}, "done": false, "training_iteration": 106, "trial_id": "45bed_00000", "date": "2024-08-13_03-04-23", "timestamp": 1723532663, "time_this_iter_s": 44.61671710014343, "time_total_s": 6846.798319816589, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44b39d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6846.798319816589, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 93.45322580645158, "ram_util_percent": 82.9951612903226}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8954187865176845, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5155653652375338, "policy_loss": -0.001460660057556298, "vf_loss": 1.517026026917513, "vf_explained_var": 0.0035860012132654744, "kl": 0.004125840121017102, "entropy": 0.33786260574740706, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 201285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.347149030272924, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.793508139867631, "policy_loss": -0.0032521837851692916, "vf_loss": 8.796760326718527, "vf_explained_var": -0.20701907702854702, "kl": 0.008413605920375157, "entropy": 0.9546162697688613, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 201285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 1712000}, "env_runners": {"episode_reward_max": 359.0, "episode_reward_min": -342.0, "episode_reward_mean": 140.21, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -396.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": 41.155, "predator_policy": 28.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.0, -25.0, 40.0, 165.0, 261.0, 69.0, 74.0, -70.0, 48.0, 95.0, 189.0, 178.0, 126.0, -17.0, -48.0, 167.0, 303.0, 122.0, 14.0, 85.0, 131.0, 137.0, 153.0, 135.0, 293.0, 207.0, 163.0, -64.0, 203.0, 116.0, 153.0, 179.0, -102.0, 254.0, 199.0, 145.0, 96.0, 257.0, 218.0, 17.0, 231.0, 309.0, -99.0, -39.0, 161.0, 216.0, 246.0, 111.0, 210.0, 185.0, 354.0, 184.0, 185.0, 92.0, 130.0, 8.0, -342.0, -46.0, 84.0, 213.0, 359.0, 250.0, 100.0, 233.0, 238.0, -12.0, 233.0, 203.0, 269.0, 214.0, 177.0, 193.0, 114.0, 192.0, 261.0, 102.0, 234.0, 242.0, -114.0, 97.0, 171.0, -28.0, 158.0, 191.0, 323.0, 142.0, 264.0, 106.0, 141.0, 256.0, 151.0, 201.0, 164.0, 237.0, 132.0, 290.0, 103.0, 234.0, -22.0, 132.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-307.0, 157.0, 140.0, -330.0, -68.0, 20.0, 24.0, 132.0, 161.0, 51.0, 38.0, 31.0, 0.0, -103.0, -319.0, 70.0, -84.0, -21.0, 37.0, 42.0, 102.0, 50.0, 46.0, 101.0, -11.0, 116.0, 87.0, -257.0, -320.0, 105.0, 68.0, 73.0, 154.0, 140.0, -137.0, 67.0, 17.0, -63.0, 0.0, 85.0, 90.0, -7.0, 73.0, -25.0, 71.0, -33.0, 133.0, 0.0, 172.0, 121.0, 56.0, 148.0, 82.0, 81.0, -130.0, -19.0, 80.0, 123.0, 31.0, 79.0, 143.0, 10.0, 55.0, 124.0, 67.0, -338.0, 95.0, 159.0, 133.0, 23.0, 93.0, 48.0, 83.0, -68.0, 105.0, 152.0, 94.0, 124.0, 75.0, -180.0, 147.0, 74.0, 162.0, 147.0, -31.0, -282.0, -242.0, 81.0, 93.0, 68.0, 55.0, 161.0, 155.0, 91.0, -106.0, 128.0, 56.0, 154.0, 103.0, 64.0, 200.0, 154.0, 93.0, 79.0, 72.0, 82.0, 101.0, -107.0, -44.0, 105.0, -142.0, 66.0, -296.0, -396.0, -196.0, 36.0, 52.0, -52.0, 62.0, 134.0, 168.0, 190.0, 136.0, 114.0, 48.0, 33.0, 140.0, 61.0, 111.0, 127.0, -201.0, 72.0, 130.0, 103.0, 116.0, 78.0, 129.0, 140.0, 77.0, 115.0, 31.0, 93.0, 13.0, 136.0, -73.0, 74.0, 113.0, 79.0, 139.0, 122.0, -141.0, 61.0, 91.0, 143.0, 133.0, 109.0, -347.0, 51.0, 24.0, 73.0, -18.0, 143.0, 80.0, -251.0, -20.0, 103.0, 99.0, 87.0, 171.0, 152.0, 71.0, -133.0, 149.0, 82.0, 69.0, -8.0, 32.0, 36.0, 130.0, 91.0, 153.0, -103.0, 20.0, 133.0, 86.0, 78.0, 42.0, 151.0, 86.0, -55.0, 101.0, 181.0, -121.0, 139.0, 87.0, 147.0, -249.0, 78.0, 69.0, 34.0], "policy_predator_policy_reward": [40.0, 141.0, 0.0, 165.0, 0.0, 88.0, 0.0, 9.0, 0.0, 49.0, 0.0, 0.0, 83.0, 94.0, 161.0, 18.0, 77.0, 76.0, 0.0, 16.0, 37.0, 0.0, 31.0, 0.0, 21.0, 0.0, 145.0, 8.0, 167.0, 0.0, 26.0, 0.0, 9.0, 0.0, 90.0, 102.0, 60.0, 0.0, 0.0, 0.0, 48.0, 0.0, 62.0, 27.0, 59.0, 56.0, 0.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 169.0, 0.0, 0.0, 0.0, 0.0, 43.0, 4.0, 0.0, 71.0, 10.0, 0.0, 0.0, 0.0, 0.0, 99.0, 23.0, 10.0, 0.0, 0.0, 0.0, 141.0, 73.0, 122.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 89.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 12.0, 0.0, 31.0, 0.0, 8.0, 90.0, 55.0, 14.0, 0.0, 84.0, 152.0, 198.0, 16.0, 98.0, 84.0, 0.0, 17.0, 0.0, 1.0, 0.0, 0.0, 0.0, 19.0, 0.0, 32.0, 0.0, 0.0, 0.0, 117.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 8.0, 14.0, 21.0, 32.0, 36.0, 8.0, 38.0, 75.0, 0.0, 0.0, 0.0, 0.0, 91.0, 91.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 46.0, 0.0, 131.0, 12.0, 63.0, 12.0, 5.0, 0.0, 0.0, 0.0, 87.0, 117.0, 33.0, 0.0, 13.0, 32.0, 29.0, 44.0, 0.0, 35.0, 101.0, 0.0, 0.0, 48.0, 0.0, 0.0, 0.0, 44.0, 74.0, 27.0, 8.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 149.0, 0.0, 29.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.757054961897652, "mean_inference_ms": 19.937983784434994, "mean_action_processing_ms": 0.8105915795682697, "mean_env_wait_ms": 3.310333521909568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01080465316772461, "StateBufferConnector_ms": 0.010939598083496094, "ViewRequirementAgentConnector_ms": 0.4006916284561157}, "num_episodes": 22, "episode_return_max": 359.0, "episode_return_min": -342.0, "episode_return_mean": 140.21, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 1712000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 108.44813753888378, "num_env_steps_trained_throughput_per_sec": 108.44813753888378, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 1712000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1712000, "timers": {"training_iteration_time_ms": 32847.877, "restore_workers_time_ms": 0.027, "training_step_time_ms": 32847.768, "sample_time_ms": 4582.115, "learn_time_ms": 28224.262, "learn_throughput": 141.722, "synch_weights_time_ms": 36.206}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 1712000}, "done": false, "training_iteration": 107, "trial_id": "45bed_00000", "date": "2024-08-13_03-05-01", "timestamp": 1723532701, "time_this_iter_s": 36.94906425476074, "time_total_s": 6883.74738407135, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x330761310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6883.74738407135, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 90.45192307692304, "ram_util_percent": 83.56153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3014703367043425, "cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4482015064153724, "policy_loss": -0.0016759223626216962, "vf_loss": 2.4498774326036847, "vf_explained_var": 0.0021965666738136738, "kl": 0.004003722998177067, "entropy": 0.41003214631761825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 203175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.329167554334358, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.71015459444157, "policy_loss": -0.0021969008783036203, "vf_loss": 7.712351509881398, "vf_explained_var": -0.10940344658478227, "kl": 0.007455824091225384, "entropy": 0.960232542999207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 203175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "env_runners": {"episode_reward_max": 359.0, "episode_reward_min": -342.0, "episode_reward_mean": 158.31, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -396.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": 53.265, "predator_policy": 25.89}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0, 85.0, 131.0, 137.0, 153.0, 135.0, 293.0, 207.0, 163.0, -64.0, 203.0, 116.0, 153.0, 179.0, -102.0, 254.0, 199.0, 145.0, 96.0, 257.0, 218.0, 17.0, 231.0, 309.0, -99.0, -39.0, 161.0, 216.0, 246.0, 111.0, 210.0, 185.0, 354.0, 184.0, 185.0, 92.0, 130.0, 8.0, -342.0, -46.0, 84.0, 213.0, 359.0, 250.0, 100.0, 233.0, 238.0, -12.0, 233.0, 203.0, 269.0, 214.0, 177.0, 193.0, 114.0, 192.0, 261.0, 102.0, 234.0, 242.0, -114.0, 97.0, 171.0, -28.0, 158.0, 191.0, 323.0, 142.0, 264.0, 106.0, 141.0, 256.0, 151.0, 201.0, 164.0, 237.0, 132.0, 290.0, 103.0, 234.0, -22.0, 132.0, 102.0, 31.0, 114.0, 270.0, 206.0, 248.0, 306.0, 253.0, 150.0, 159.0, 258.0, 111.0, 226.0, 110.0, 311.0, 168.0, 230.0, 265.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [17.0, -63.0, 0.0, 85.0, 90.0, -7.0, 73.0, -25.0, 71.0, -33.0, 133.0, 0.0, 172.0, 121.0, 56.0, 148.0, 82.0, 81.0, -130.0, -19.0, 80.0, 123.0, 31.0, 79.0, 143.0, 10.0, 55.0, 124.0, 67.0, -338.0, 95.0, 159.0, 133.0, 23.0, 93.0, 48.0, 83.0, -68.0, 105.0, 152.0, 94.0, 124.0, 75.0, -180.0, 147.0, 74.0, 162.0, 147.0, -31.0, -282.0, -242.0, 81.0, 93.0, 68.0, 55.0, 161.0, 155.0, 91.0, -106.0, 128.0, 56.0, 154.0, 103.0, 64.0, 200.0, 154.0, 93.0, 79.0, 72.0, 82.0, 101.0, -107.0, -44.0, 105.0, -142.0, 66.0, -296.0, -396.0, -196.0, 36.0, 52.0, -52.0, 62.0, 134.0, 168.0, 190.0, 136.0, 114.0, 48.0, 33.0, 140.0, 61.0, 111.0, 127.0, -201.0, 72.0, 130.0, 103.0, 116.0, 78.0, 129.0, 140.0, 77.0, 115.0, 31.0, 93.0, 13.0, 136.0, -73.0, 74.0, 113.0, 79.0, 139.0, 122.0, -141.0, 61.0, 91.0, 143.0, 133.0, 109.0, -347.0, 51.0, 24.0, 73.0, -18.0, 143.0, 80.0, -251.0, -20.0, 103.0, 99.0, 87.0, 171.0, 152.0, 71.0, -133.0, 149.0, 82.0, 69.0, -8.0, 32.0, 36.0, 130.0, 91.0, 153.0, -103.0, 20.0, 133.0, 86.0, 78.0, 42.0, 151.0, 86.0, -55.0, 101.0, 181.0, -121.0, 139.0, 87.0, 147.0, -249.0, 78.0, 69.0, 34.0, -156.0, 149.0, -253.0, 141.0, 26.0, -69.0, 132.0, 138.0, 167.0, 32.0, 107.0, 62.0, 151.0, 138.0, 149.0, 93.0, 40.0, 41.0, 97.0, 12.0, 128.0, 130.0, -150.0, 117.0, 116.0, 97.0, 108.0, -80.0, 146.0, 165.0, -55.0, 143.0, 144.0, 86.0, 109.0, 76.0], "policy_predator_policy_reward": [60.0, 0.0, 0.0, 0.0, 48.0, 0.0, 62.0, 27.0, 59.0, 56.0, 0.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 169.0, 0.0, 0.0, 0.0, 0.0, 43.0, 4.0, 0.0, 71.0, 10.0, 0.0, 0.0, 0.0, 0.0, 99.0, 23.0, 10.0, 0.0, 0.0, 0.0, 141.0, 73.0, 122.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 89.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 12.0, 0.0, 31.0, 0.0, 8.0, 90.0, 55.0, 14.0, 0.0, 84.0, 152.0, 198.0, 16.0, 98.0, 84.0, 0.0, 17.0, 0.0, 1.0, 0.0, 0.0, 0.0, 19.0, 0.0, 32.0, 0.0, 0.0, 0.0, 117.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 8.0, 14.0, 21.0, 32.0, 36.0, 8.0, 38.0, 75.0, 0.0, 0.0, 0.0, 0.0, 91.0, 91.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 46.0, 0.0, 131.0, 12.0, 63.0, 12.0, 5.0, 0.0, 0.0, 0.0, 87.0, 117.0, 33.0, 0.0, 13.0, 32.0, 29.0, 44.0, 0.0, 35.0, 101.0, 0.0, 0.0, 48.0, 0.0, 0.0, 0.0, 44.0, 74.0, 27.0, 8.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 149.0, 0.0, 29.0, 2.0, 107.0, 8.0, 135.0, 69.0, 88.0, 0.0, 0.0, 7.0, 0.0, 43.0, 36.0, 17.0, 0.0, 0.0, 11.0, 69.0, 0.0, 0.0, 50.0, 0.0, 0.0, 74.0, 70.0, 0.0, 13.0, 82.0, 0.0, 0.0, 0.0, 80.0, 0.0, 0.0, 0.0, 38.0, 42.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.718952895618511, "mean_inference_ms": 20.04462521540348, "mean_action_processing_ms": 0.8108194914859267, "mean_env_wait_ms": 3.0627407624463485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011070013046264648, "StateBufferConnector_ms": 0.010489583015441895, "ViewRequirementAgentConnector_ms": 0.4157205820083618}, "num_episodes": 18, "episode_return_max": 359.0, "episode_return_min": -342.0, "episode_return_mean": 158.31, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 118.49425510492345, "num_env_steps_trained_throughput_per_sec": 118.49425510492345, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 1728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1728000, "timers": {"training_iteration_time_ms": 33148.359, "restore_workers_time_ms": 0.027, "training_step_time_ms": 33148.244, "sample_time_ms": 4503.332, "learn_time_ms": 28606.615, "learn_throughput": 139.828, "synch_weights_time_ms": 33.52}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "done": false, "training_iteration": 108, "trial_id": "45bed_00000", "date": "2024-08-13_03-05-34", "timestamp": 1723532734, "time_this_iter_s": 33.8296320438385, "time_total_s": 6917.577016115189, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4624700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6917.577016115189, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 89.23958333333333, "ram_util_percent": 83.23750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8690683881599436, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9193526051662586, "policy_loss": -0.001306492369129229, "vf_loss": 1.9206590946073885, "vf_explained_var": 0.006042005776097535, "kl": 0.0050802508680437225, "entropy": 0.3565293806412863, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 205065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.709550742939037, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.394976784690979, "policy_loss": -0.004135867222039788, "vf_loss": 8.399112646668046, "vf_explained_var": -0.2569976272406401, "kl": 0.010349389785584587, "entropy": 0.9113994959800963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 205065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 1744000}, "env_runners": {"episode_reward_max": 359.0, "episode_reward_min": -342.0, "episode_reward_mean": 168.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -396.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": 56.23, "predator_policy": 27.91}, "custom_metrics": {}, "hist_stats": {"episode_reward": [96.0, 257.0, 218.0, 17.0, 231.0, 309.0, -99.0, -39.0, 161.0, 216.0, 246.0, 111.0, 210.0, 185.0, 354.0, 184.0, 185.0, 92.0, 130.0, 8.0, -342.0, -46.0, 84.0, 213.0, 359.0, 250.0, 100.0, 233.0, 238.0, -12.0, 233.0, 203.0, 269.0, 214.0, 177.0, 193.0, 114.0, 192.0, 261.0, 102.0, 234.0, 242.0, -114.0, 97.0, 171.0, -28.0, 158.0, 191.0, 323.0, 142.0, 264.0, 106.0, 141.0, 256.0, 151.0, 201.0, 164.0, 237.0, 132.0, 290.0, 103.0, 234.0, -22.0, 132.0, 102.0, 31.0, 114.0, 270.0, 206.0, 248.0, 306.0, 253.0, 150.0, 159.0, 258.0, 111.0, 226.0, 110.0, 311.0, 168.0, 230.0, 265.0, 215.0, 95.0, 106.0, 99.0, 65.0, 61.0, 254.0, 277.0, 287.0, 200.0, 191.0, 268.0, 322.0, 251.0, 242.0, 179.0, 59.0, 227.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [83.0, -68.0, 105.0, 152.0, 94.0, 124.0, 75.0, -180.0, 147.0, 74.0, 162.0, 147.0, -31.0, -282.0, -242.0, 81.0, 93.0, 68.0, 55.0, 161.0, 155.0, 91.0, -106.0, 128.0, 56.0, 154.0, 103.0, 64.0, 200.0, 154.0, 93.0, 79.0, 72.0, 82.0, 101.0, -107.0, -44.0, 105.0, -142.0, 66.0, -296.0, -396.0, -196.0, 36.0, 52.0, -52.0, 62.0, 134.0, 168.0, 190.0, 136.0, 114.0, 48.0, 33.0, 140.0, 61.0, 111.0, 127.0, -201.0, 72.0, 130.0, 103.0, 116.0, 78.0, 129.0, 140.0, 77.0, 115.0, 31.0, 93.0, 13.0, 136.0, -73.0, 74.0, 113.0, 79.0, 139.0, 122.0, -141.0, 61.0, 91.0, 143.0, 133.0, 109.0, -347.0, 51.0, 24.0, 73.0, -18.0, 143.0, 80.0, -251.0, -20.0, 103.0, 99.0, 87.0, 171.0, 152.0, 71.0, -133.0, 149.0, 82.0, 69.0, -8.0, 32.0, 36.0, 130.0, 91.0, 153.0, -103.0, 20.0, 133.0, 86.0, 78.0, 42.0, 151.0, 86.0, -55.0, 101.0, 181.0, -121.0, 139.0, 87.0, 147.0, -249.0, 78.0, 69.0, 34.0, -156.0, 149.0, -253.0, 141.0, 26.0, -69.0, 132.0, 138.0, 167.0, 32.0, 107.0, 62.0, 151.0, 138.0, 149.0, 93.0, 40.0, 41.0, 97.0, 12.0, 128.0, 130.0, -150.0, 117.0, 116.0, 97.0, 108.0, -80.0, 146.0, 165.0, -55.0, 143.0, 144.0, 86.0, 109.0, 76.0, 23.0, 147.0, 72.0, -18.0, 76.0, -88.0, 64.0, -41.0, 89.0, -113.0, 140.0, -212.0, 76.0, 146.0, 106.0, 171.0, 118.0, 169.0, 21.0, 149.0, 72.0, 104.0, 115.0, 126.0, 176.0, 146.0, 111.0, 129.0, 114.0, 128.0, -225.0, 146.0, 118.0, -212.0, 74.0, 153.0], "policy_predator_policy_reward": [71.0, 10.0, 0.0, 0.0, 0.0, 0.0, 99.0, 23.0, 10.0, 0.0, 0.0, 0.0, 141.0, 73.0, 122.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 89.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 12.0, 0.0, 31.0, 0.0, 8.0, 90.0, 55.0, 14.0, 0.0, 84.0, 152.0, 198.0, 16.0, 98.0, 84.0, 0.0, 17.0, 0.0, 1.0, 0.0, 0.0, 0.0, 19.0, 0.0, 32.0, 0.0, 0.0, 0.0, 117.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 8.0, 14.0, 21.0, 32.0, 36.0, 8.0, 38.0, 75.0, 0.0, 0.0, 0.0, 0.0, 91.0, 91.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 46.0, 0.0, 131.0, 12.0, 63.0, 12.0, 5.0, 0.0, 0.0, 0.0, 87.0, 117.0, 33.0, 0.0, 13.0, 32.0, 29.0, 44.0, 0.0, 35.0, 101.0, 0.0, 0.0, 48.0, 0.0, 0.0, 0.0, 44.0, 74.0, 27.0, 8.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 149.0, 0.0, 29.0, 2.0, 107.0, 8.0, 135.0, 69.0, 88.0, 0.0, 0.0, 7.0, 0.0, 43.0, 36.0, 17.0, 0.0, 0.0, 11.0, 69.0, 0.0, 0.0, 50.0, 0.0, 0.0, 74.0, 70.0, 0.0, 13.0, 82.0, 0.0, 0.0, 0.0, 80.0, 0.0, 0.0, 0.0, 38.0, 42.0, 45.0, 0.0, 0.0, 41.0, 56.0, 62.0, 0.0, 76.0, 89.0, 0.0, 86.0, 47.0, 16.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 15.0, 13.0, 14.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 136.0, 122.0, 21.0, 132.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.681126661044531, "mean_inference_ms": 19.928459052408662, "mean_action_processing_ms": 0.8118799162309409, "mean_env_wait_ms": 3.0431631431292403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011370539665222168, "StateBufferConnector_ms": 0.01095890998840332, "ViewRequirementAgentConnector_ms": 0.4156864881515503}, "num_episodes": 18, "episode_return_max": 359.0, "episode_return_min": -342.0, "episode_return_mean": 168.28, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 1744000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 121.17461900166184, "num_env_steps_trained_throughput_per_sec": 121.17461900166184, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 1744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1744000, "timers": {"training_iteration_time_ms": 33346.142, "restore_workers_time_ms": 0.026, "training_step_time_ms": 33346.028, "sample_time_ms": 4547.231, "learn_time_ms": 28760.456, "learn_throughput": 139.08, "synch_weights_time_ms": 33.436}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 1744000}, "done": false, "training_iteration": 109, "trial_id": "45bed_00000", "date": "2024-08-13_03-06-08", "timestamp": 1723532768, "time_this_iter_s": 33.064109086990356, "time_total_s": 6950.641125202179, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3307618b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6950.641125202179, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 88.1531914893617, "ram_util_percent": 83.22978723404256}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9980494900118737, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4134124118815024, "policy_loss": -0.0008843636272041492, "vf_loss": 2.4142967733756575, "vf_explained_var": 0.0027133354749629105, "kl": 0.0032732032663043468, "entropy": 0.22804333233328725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 206955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.818808260055444, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.333005618544482, "policy_loss": -0.001900898506519971, "vf_loss": 7.334906522054521, "vf_explained_var": 0.10217230572271599, "kl": 0.005823331847092828, "entropy": 0.8031723881524707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 206955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "env_runners": {"episode_reward_max": 359.0, "episode_reward_min": -114.0, "episode_reward_mean": 191.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -347.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 182.0}, "policy_reward_mean": {"prey_policy": 69.585, "predator_policy": 25.935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [213.0, 359.0, 250.0, 100.0, 233.0, 238.0, -12.0, 233.0, 203.0, 269.0, 214.0, 177.0, 193.0, 114.0, 192.0, 261.0, 102.0, 234.0, 242.0, -114.0, 97.0, 171.0, -28.0, 158.0, 191.0, 323.0, 142.0, 264.0, 106.0, 141.0, 256.0, 151.0, 201.0, 164.0, 237.0, 132.0, 290.0, 103.0, 234.0, -22.0, 132.0, 102.0, 31.0, 114.0, 270.0, 206.0, 248.0, 306.0, 253.0, 150.0, 159.0, 258.0, 111.0, 226.0, 110.0, 311.0, 168.0, 230.0, 265.0, 215.0, 95.0, 106.0, 99.0, 65.0, 61.0, 254.0, 277.0, 287.0, 200.0, 191.0, 268.0, 322.0, 251.0, 242.0, 179.0, 59.0, 227.0, 148.0, -10.0, 229.0, 278.0, 202.0, 343.0, 24.0, 245.0, 245.0, 269.0, 332.0, 229.0, 303.0, 256.0, 143.0, 259.0, 285.0, 186.0, 45.0, 230.0, 167.0, 321.0, 315.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [62.0, 134.0, 168.0, 190.0, 136.0, 114.0, 48.0, 33.0, 140.0, 61.0, 111.0, 127.0, -201.0, 72.0, 130.0, 103.0, 116.0, 78.0, 129.0, 140.0, 77.0, 115.0, 31.0, 93.0, 13.0, 136.0, -73.0, 74.0, 113.0, 79.0, 139.0, 122.0, -141.0, 61.0, 91.0, 143.0, 133.0, 109.0, -347.0, 51.0, 24.0, 73.0, -18.0, 143.0, 80.0, -251.0, -20.0, 103.0, 99.0, 87.0, 171.0, 152.0, 71.0, -133.0, 149.0, 82.0, 69.0, -8.0, 32.0, 36.0, 130.0, 91.0, 153.0, -103.0, 20.0, 133.0, 86.0, 78.0, 42.0, 151.0, 86.0, -55.0, 101.0, 181.0, -121.0, 139.0, 87.0, 147.0, -249.0, 78.0, 69.0, 34.0, -156.0, 149.0, -253.0, 141.0, 26.0, -69.0, 132.0, 138.0, 167.0, 32.0, 107.0, 62.0, 151.0, 138.0, 149.0, 93.0, 40.0, 41.0, 97.0, 12.0, 128.0, 130.0, -150.0, 117.0, 116.0, 97.0, 108.0, -80.0, 146.0, 165.0, -55.0, 143.0, 144.0, 86.0, 109.0, 76.0, 23.0, 147.0, 72.0, -18.0, 76.0, -88.0, 64.0, -41.0, 89.0, -113.0, 140.0, -212.0, 76.0, 146.0, 106.0, 171.0, 118.0, 169.0, 21.0, 149.0, 72.0, 104.0, 115.0, 126.0, 176.0, 146.0, 111.0, 129.0, 114.0, 128.0, -225.0, 146.0, 118.0, -212.0, 74.0, 153.0, -53.0, 135.0, 29.0, -226.0, 118.0, 111.0, 109.0, 162.0, 62.0, 140.0, 152.0, 191.0, -80.0, -1.0, 149.0, -67.0, 103.0, 136.0, 122.0, 143.0, 165.0, 167.0, 117.0, 101.0, 143.0, 157.0, 129.0, 90.0, 88.0, 44.0, 76.0, 138.0, 170.0, 115.0, 39.0, 94.0, 200.0, -318.0, 136.0, -82.0, -27.0, 128.0, 156.0, 165.0, 134.0, 181.0], "policy_predator_policy_reward": [17.0, 0.0, 1.0, 0.0, 0.0, 0.0, 19.0, 0.0, 32.0, 0.0, 0.0, 0.0, 117.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 8.0, 14.0, 21.0, 32.0, 36.0, 8.0, 38.0, 75.0, 0.0, 0.0, 0.0, 0.0, 91.0, 91.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 46.0, 0.0, 131.0, 12.0, 63.0, 12.0, 5.0, 0.0, 0.0, 0.0, 87.0, 117.0, 33.0, 0.0, 13.0, 32.0, 29.0, 44.0, 0.0, 35.0, 101.0, 0.0, 0.0, 48.0, 0.0, 0.0, 0.0, 44.0, 74.0, 27.0, 8.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 149.0, 0.0, 29.0, 2.0, 107.0, 8.0, 135.0, 69.0, 88.0, 0.0, 0.0, 7.0, 0.0, 43.0, 36.0, 17.0, 0.0, 0.0, 11.0, 69.0, 0.0, 0.0, 50.0, 0.0, 0.0, 74.0, 70.0, 0.0, 13.0, 82.0, 0.0, 0.0, 0.0, 80.0, 0.0, 0.0, 0.0, 38.0, 42.0, 45.0, 0.0, 0.0, 41.0, 56.0, 62.0, 0.0, 76.0, 89.0, 0.0, 86.0, 47.0, 16.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 15.0, 13.0, 14.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 136.0, 122.0, 21.0, 132.0, 0.0, 0.0, 66.0, 0.0, 79.0, 108.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 27.0, 78.0, 82.0, 81.0, 6.0, 0.0, 4.0, 0.0, 0.0, 0.0, 7.0, 4.0, 2.0, 1.0, 1.0, 36.0, 11.0, 0.0, 31.0, 14.0, 0.0, 0.0, 0.0, 53.0, 2.0, 161.0, 91.0, 85.0, 66.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.625891236284118, "mean_inference_ms": 19.79014118061264, "mean_action_processing_ms": 0.8136462511850007, "mean_env_wait_ms": 3.0246318763296602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014020562171936035, "StateBufferConnector_ms": 0.016138195991516113, "ViewRequirementAgentConnector_ms": 0.4702718257904053}, "num_episodes": 23, "episode_return_max": 359.0, "episode_return_min": -114.0, "episode_return_mean": 191.04, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 117.97891645386679, "num_env_steps_trained_throughput_per_sec": 117.97891645386679, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 1760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1760000, "timers": {"training_iteration_time_ms": 33639.123, "restore_workers_time_ms": 0.026, "training_step_time_ms": 33639.01, "sample_time_ms": 4617.707, "learn_time_ms": 28982.698, "learn_throughput": 138.013, "synch_weights_time_ms": 33.588}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "done": false, "training_iteration": 110, "trial_id": "45bed_00000", "date": "2024-08-13_03-06-42", "timestamp": 1723532802, "time_this_iter_s": 33.96027684211731, "time_total_s": 6984.601402044296, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44e53a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6984.601402044296, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 88.32708333333335, "ram_util_percent": 83.14375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9163369690733296, "cur_kl_coeff": 5.820766091346741e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9401839181859657, "policy_loss": -0.0010191180772842869, "vf_loss": 1.94120303575324, "vf_explained_var": 0.0024009407828093836, "kl": 0.0023219154920233243, "entropy": 0.2575701849643516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 208845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.03533768452034, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.481077217424987, "policy_loss": -0.0013371205181573276, "vf_loss": 8.48241432835816, "vf_explained_var": -0.11277874742866194, "kl": 0.005036465313858211, "entropy": 0.8824093015736373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 208845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "env_runners": {"episode_reward_max": 343.0, "episode_reward_min": -114.0, "episode_reward_mean": 185.11, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -347.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 182.0}, "policy_reward_mean": {"prey_policy": 62.355, "predator_policy": 30.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [242.0, -114.0, 97.0, 171.0, -28.0, 158.0, 191.0, 323.0, 142.0, 264.0, 106.0, 141.0, 256.0, 151.0, 201.0, 164.0, 237.0, 132.0, 290.0, 103.0, 234.0, -22.0, 132.0, 102.0, 31.0, 114.0, 270.0, 206.0, 248.0, 306.0, 253.0, 150.0, 159.0, 258.0, 111.0, 226.0, 110.0, 311.0, 168.0, 230.0, 265.0, 215.0, 95.0, 106.0, 99.0, 65.0, 61.0, 254.0, 277.0, 287.0, 200.0, 191.0, 268.0, 322.0, 251.0, 242.0, 179.0, 59.0, 227.0, 148.0, -10.0, 229.0, 278.0, 202.0, 343.0, 24.0, 245.0, 245.0, 269.0, 332.0, 229.0, 303.0, 256.0, 143.0, 259.0, 285.0, 186.0, 45.0, 230.0, 167.0, 321.0, 315.0, 137.0, 263.0, 211.0, 254.0, 98.0, 206.0, 36.0, 190.0, 164.0, 78.0, 263.0, 31.0, 52.0, 213.0, 90.0, 240.0, 248.0, 206.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [133.0, 109.0, -347.0, 51.0, 24.0, 73.0, -18.0, 143.0, 80.0, -251.0, -20.0, 103.0, 99.0, 87.0, 171.0, 152.0, 71.0, -133.0, 149.0, 82.0, 69.0, -8.0, 32.0, 36.0, 130.0, 91.0, 153.0, -103.0, 20.0, 133.0, 86.0, 78.0, 42.0, 151.0, 86.0, -55.0, 101.0, 181.0, -121.0, 139.0, 87.0, 147.0, -249.0, 78.0, 69.0, 34.0, -156.0, 149.0, -253.0, 141.0, 26.0, -69.0, 132.0, 138.0, 167.0, 32.0, 107.0, 62.0, 151.0, 138.0, 149.0, 93.0, 40.0, 41.0, 97.0, 12.0, 128.0, 130.0, -150.0, 117.0, 116.0, 97.0, 108.0, -80.0, 146.0, 165.0, -55.0, 143.0, 144.0, 86.0, 109.0, 76.0, 23.0, 147.0, 72.0, -18.0, 76.0, -88.0, 64.0, -41.0, 89.0, -113.0, 140.0, -212.0, 76.0, 146.0, 106.0, 171.0, 118.0, 169.0, 21.0, 149.0, 72.0, 104.0, 115.0, 126.0, 176.0, 146.0, 111.0, 129.0, 114.0, 128.0, -225.0, 146.0, 118.0, -212.0, 74.0, 153.0, -53.0, 135.0, 29.0, -226.0, 118.0, 111.0, 109.0, 162.0, 62.0, 140.0, 152.0, 191.0, -80.0, -1.0, 149.0, -67.0, 103.0, 136.0, 122.0, 143.0, 165.0, 167.0, 117.0, 101.0, 143.0, 157.0, 129.0, 90.0, 88.0, 44.0, 76.0, 138.0, 170.0, 115.0, 39.0, 94.0, 200.0, -318.0, 136.0, -82.0, -27.0, 128.0, 156.0, 165.0, 134.0, 181.0, -106.0, 130.0, 148.0, 94.0, 186.0, -207.0, 154.0, 99.0, -111.0, 113.0, 48.0, 128.0, -229.0, 131.0, 48.0, -106.0, 105.0, 51.0, -190.0, 84.0, 111.0, 151.0, 119.0, -233.0, -7.0, -102.0, 122.0, 91.0, -111.0, 123.0, 168.0, 72.0, 115.0, 130.0, 51.0, 148.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 46.0, 0.0, 131.0, 12.0, 63.0, 12.0, 5.0, 0.0, 0.0, 0.0, 87.0, 117.0, 33.0, 0.0, 13.0, 32.0, 29.0, 44.0, 0.0, 35.0, 101.0, 0.0, 0.0, 48.0, 0.0, 0.0, 0.0, 44.0, 74.0, 27.0, 8.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 149.0, 0.0, 29.0, 2.0, 107.0, 8.0, 135.0, 69.0, 88.0, 0.0, 0.0, 7.0, 0.0, 43.0, 36.0, 17.0, 0.0, 0.0, 11.0, 69.0, 0.0, 0.0, 50.0, 0.0, 0.0, 74.0, 70.0, 0.0, 13.0, 82.0, 0.0, 0.0, 0.0, 80.0, 0.0, 0.0, 0.0, 38.0, 42.0, 45.0, 0.0, 0.0, 41.0, 56.0, 62.0, 0.0, 76.0, 89.0, 0.0, 86.0, 47.0, 16.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 15.0, 13.0, 14.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 136.0, 122.0, 21.0, 132.0, 0.0, 0.0, 66.0, 0.0, 79.0, 108.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 27.0, 78.0, 82.0, 81.0, 6.0, 0.0, 4.0, 0.0, 0.0, 0.0, 7.0, 4.0, 2.0, 1.0, 1.0, 36.0, 11.0, 0.0, 31.0, 14.0, 0.0, 0.0, 0.0, 53.0, 2.0, 161.0, 91.0, 85.0, 66.0, 0.0, 0.0, 0.0, 0.0, 0.0, 56.0, 57.0, 10.0, 11.0, 115.0, 117.0, 0.0, 1.0, 0.0, 96.0, 12.0, 18.0, 134.0, 0.0, 126.0, 122.0, 0.0, 8.0, 69.0, 115.0, 0.0, 1.0, 108.0, 37.0, 64.0, 97.0, 0.0, 0.0, 0.0, 78.0, 0.0, 0.0, 0.0, 3.0, 1.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.590441905541752, "mean_inference_ms": 19.68186248389447, "mean_action_processing_ms": 0.8151479442856453, "mean_env_wait_ms": 3.006157880824081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014159440994262695, "StateBufferConnector_ms": 0.01374959945678711, "ViewRequirementAgentConnector_ms": 0.4453662633895874}, "num_episodes": 18, "episode_return_max": 343.0, "episode_return_min": -114.0, "episode_return_mean": 185.11, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 127.78756701401227, "num_env_steps_trained_throughput_per_sec": 127.78756701401227, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 1776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1776000, "timers": {"training_iteration_time_ms": 33648.131, "restore_workers_time_ms": 0.025, "training_step_time_ms": 33648.02, "sample_time_ms": 4665.445, "learn_time_ms": 28943.487, "learn_throughput": 138.2, "synch_weights_time_ms": 33.289}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "done": false, "training_iteration": 111, "trial_id": "45bed_00000", "date": "2024-08-13_03-07-13", "timestamp": 1723532833, "time_this_iter_s": 31.376397848129272, "time_total_s": 7015.9777998924255, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b521fa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7015.9777998924255, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 88.39090909090909, "ram_util_percent": 82.98636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.150146205222638, "cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5503218286251896, "policy_loss": -0.0021395515268619256, "vf_loss": 1.552461383550886, "vf_explained_var": 0.002374084506716047, "kl": 0.00534900150397555, "entropy": 0.3519940033633873, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 210735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.55867397971254, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.401399212791807, "policy_loss": -0.004379708641800024, "vf_loss": 8.405778931309937, "vf_explained_var": -0.1780566362161485, "kl": 0.010624366713153331, "entropy": 0.8625729916903077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 210735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000}, "env_runners": {"episode_reward_max": 343.0, "episode_reward_min": -10.0, "episode_reward_mean": 191.55, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -318.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 161.0}, "policy_reward_mean": {"prey_policy": 66.405, "predator_policy": 29.37}, "custom_metrics": {}, "hist_stats": {"episode_reward": [132.0, 102.0, 31.0, 114.0, 270.0, 206.0, 248.0, 306.0, 253.0, 150.0, 159.0, 258.0, 111.0, 226.0, 110.0, 311.0, 168.0, 230.0, 265.0, 215.0, 95.0, 106.0, 99.0, 65.0, 61.0, 254.0, 277.0, 287.0, 200.0, 191.0, 268.0, 322.0, 251.0, 242.0, 179.0, 59.0, 227.0, 148.0, -10.0, 229.0, 278.0, 202.0, 343.0, 24.0, 245.0, 245.0, 269.0, 332.0, 229.0, 303.0, 256.0, 143.0, 259.0, 285.0, 186.0, 45.0, 230.0, 167.0, 321.0, 315.0, 137.0, 263.0, 211.0, 254.0, 98.0, 206.0, 36.0, 190.0, 164.0, 78.0, 263.0, 31.0, 52.0, 213.0, 90.0, 240.0, 248.0, 206.0, 334.0, 203.0, 60.0, 176.0, 141.0, 291.0, 172.0, 256.0, 135.0, 239.0, 128.0, 230.0, 139.0, 295.0, 212.0, 201.0, 189.0, 31.0, 45.0, 191.0, 206.0, 209.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [69.0, 34.0, -156.0, 149.0, -253.0, 141.0, 26.0, -69.0, 132.0, 138.0, 167.0, 32.0, 107.0, 62.0, 151.0, 138.0, 149.0, 93.0, 40.0, 41.0, 97.0, 12.0, 128.0, 130.0, -150.0, 117.0, 116.0, 97.0, 108.0, -80.0, 146.0, 165.0, -55.0, 143.0, 144.0, 86.0, 109.0, 76.0, 23.0, 147.0, 72.0, -18.0, 76.0, -88.0, 64.0, -41.0, 89.0, -113.0, 140.0, -212.0, 76.0, 146.0, 106.0, 171.0, 118.0, 169.0, 21.0, 149.0, 72.0, 104.0, 115.0, 126.0, 176.0, 146.0, 111.0, 129.0, 114.0, 128.0, -225.0, 146.0, 118.0, -212.0, 74.0, 153.0, -53.0, 135.0, 29.0, -226.0, 118.0, 111.0, 109.0, 162.0, 62.0, 140.0, 152.0, 191.0, -80.0, -1.0, 149.0, -67.0, 103.0, 136.0, 122.0, 143.0, 165.0, 167.0, 117.0, 101.0, 143.0, 157.0, 129.0, 90.0, 88.0, 44.0, 76.0, 138.0, 170.0, 115.0, 39.0, 94.0, 200.0, -318.0, 136.0, -82.0, -27.0, 128.0, 156.0, 165.0, 134.0, 181.0, -106.0, 130.0, 148.0, 94.0, 186.0, -207.0, 154.0, 99.0, -111.0, 113.0, 48.0, 128.0, -229.0, 131.0, 48.0, -106.0, 105.0, 51.0, -190.0, 84.0, 111.0, 151.0, 119.0, -233.0, -7.0, -102.0, 122.0, 91.0, -111.0, 123.0, 168.0, 72.0, 115.0, 130.0, 51.0, 148.0, 180.0, 154.0, 103.0, 92.0, -3.0, -14.0, 54.0, 122.0, 135.0, -90.0, 162.0, 129.0, 48.0, 93.0, 97.0, 156.0, 140.0, -214.0, 150.0, 89.0, -55.0, 100.0, 7.0, 183.0, 99.0, 13.0, 148.0, 147.0, 94.0, 94.0, 111.0, 86.0, 167.0, -41.0, -265.0, 3.0, -144.0, 77.0, 81.0, 6.0, 103.0, 69.0, 93.0, 113.0], "policy_predator_policy_reward": [0.0, 29.0, 2.0, 107.0, 8.0, 135.0, 69.0, 88.0, 0.0, 0.0, 7.0, 0.0, 43.0, 36.0, 17.0, 0.0, 0.0, 11.0, 69.0, 0.0, 0.0, 50.0, 0.0, 0.0, 74.0, 70.0, 0.0, 13.0, 82.0, 0.0, 0.0, 0.0, 80.0, 0.0, 0.0, 0.0, 38.0, 42.0, 45.0, 0.0, 0.0, 41.0, 56.0, 62.0, 0.0, 76.0, 89.0, 0.0, 86.0, 47.0, 16.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 15.0, 13.0, 14.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 136.0, 122.0, 21.0, 132.0, 0.0, 0.0, 66.0, 0.0, 79.0, 108.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 27.0, 78.0, 82.0, 81.0, 6.0, 0.0, 4.0, 0.0, 0.0, 0.0, 7.0, 4.0, 2.0, 1.0, 1.0, 36.0, 11.0, 0.0, 31.0, 14.0, 0.0, 0.0, 0.0, 53.0, 2.0, 161.0, 91.0, 85.0, 66.0, 0.0, 0.0, 0.0, 0.0, 0.0, 56.0, 57.0, 10.0, 11.0, 115.0, 117.0, 0.0, 1.0, 0.0, 96.0, 12.0, 18.0, 134.0, 0.0, 126.0, 122.0, 0.0, 8.0, 69.0, 115.0, 0.0, 1.0, 108.0, 37.0, 64.0, 97.0, 0.0, 0.0, 0.0, 78.0, 0.0, 0.0, 0.0, 3.0, 1.0, 6.0, 0.0, 0.0, 3.0, 5.0, 0.0, 77.0, 0.0, 0.0, 96.0, 0.0, 0.0, 0.0, 31.0, 0.0, 0.0, 3.0, 118.0, 91.0, 0.0, 0.0, 83.0, 0.0, 40.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 4.0, 63.0, 0.0, 144.0, 149.0, 0.0, 112.0, 49.0, 55.0, 19.0, 15.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.554683449297273, "mean_inference_ms": 19.5436051063758, "mean_action_processing_ms": 0.8162682597342087, "mean_env_wait_ms": 2.9780444997747564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01209557056427002, "StateBufferConnector_ms": 0.013665199279785156, "ViewRequirementAgentConnector_ms": 0.44250404834747314}, "num_episodes": 22, "episode_return_max": 343.0, "episode_return_min": -10.0, "episode_return_mean": 191.55, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 132.3804713315344, "num_env_steps_trained_throughput_per_sec": 132.3804713315344, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 1792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1792000, "timers": {"training_iteration_time_ms": 33631.3, "restore_workers_time_ms": 0.022, "training_step_time_ms": 33631.209, "sample_time_ms": 4647.206, "learn_time_ms": 28942.978, "learn_throughput": 138.203, "synch_weights_time_ms": 34.877}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000}, "done": false, "training_iteration": 112, "trial_id": "45bed_00000", "date": "2024-08-13_03-07-44", "timestamp": 1723532864, "time_this_iter_s": 30.28986096382141, "time_total_s": 7046.267660856247, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b521c790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7046.267660856247, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 88.0046511627907, "ram_util_percent": 83.35581395348838}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2001680033271591, "cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.423508821467243, "policy_loss": -0.0012105815489554688, "vf_loss": 2.424719401831349, "vf_explained_var": 0.004194460091767487, "kl": 0.007321599722760905, "entropy": 0.3336190974743909, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 212625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.214778173095965, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.44753839629037, "policy_loss": -0.0015436782210907609, "vf_loss": 7.449082087208985, "vf_explained_var": 0.031072349554647213, "kl": 0.00523345068859757, "entropy": 0.8293175948990716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 212625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 1808000}, "env_runners": {"episode_reward_max": 359.0, "episode_reward_min": -137.0, "episode_reward_mean": 192.08, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -318.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 166.0}, "policy_reward_mean": {"prey_policy": 66.715, "predator_policy": 29.325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [265.0, 215.0, 95.0, 106.0, 99.0, 65.0, 61.0, 254.0, 277.0, 287.0, 200.0, 191.0, 268.0, 322.0, 251.0, 242.0, 179.0, 59.0, 227.0, 148.0, -10.0, 229.0, 278.0, 202.0, 343.0, 24.0, 245.0, 245.0, 269.0, 332.0, 229.0, 303.0, 256.0, 143.0, 259.0, 285.0, 186.0, 45.0, 230.0, 167.0, 321.0, 315.0, 137.0, 263.0, 211.0, 254.0, 98.0, 206.0, 36.0, 190.0, 164.0, 78.0, 263.0, 31.0, 52.0, 213.0, 90.0, 240.0, 248.0, 206.0, 334.0, 203.0, 60.0, 176.0, 141.0, 291.0, 172.0, 256.0, 135.0, 239.0, 128.0, 230.0, 139.0, 295.0, 212.0, 201.0, 189.0, 31.0, 45.0, 191.0, 206.0, 209.0, 359.0, 311.0, 35.0, -137.0, 271.0, 289.0, 207.0, 42.0, 239.0, 228.0, 265.0, -67.0, 307.0, 20.0, 277.0, 288.0, 312.0, 192.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [109.0, 76.0, 23.0, 147.0, 72.0, -18.0, 76.0, -88.0, 64.0, -41.0, 89.0, -113.0, 140.0, -212.0, 76.0, 146.0, 106.0, 171.0, 118.0, 169.0, 21.0, 149.0, 72.0, 104.0, 115.0, 126.0, 176.0, 146.0, 111.0, 129.0, 114.0, 128.0, -225.0, 146.0, 118.0, -212.0, 74.0, 153.0, -53.0, 135.0, 29.0, -226.0, 118.0, 111.0, 109.0, 162.0, 62.0, 140.0, 152.0, 191.0, -80.0, -1.0, 149.0, -67.0, 103.0, 136.0, 122.0, 143.0, 165.0, 167.0, 117.0, 101.0, 143.0, 157.0, 129.0, 90.0, 88.0, 44.0, 76.0, 138.0, 170.0, 115.0, 39.0, 94.0, 200.0, -318.0, 136.0, -82.0, -27.0, 128.0, 156.0, 165.0, 134.0, 181.0, -106.0, 130.0, 148.0, 94.0, 186.0, -207.0, 154.0, 99.0, -111.0, 113.0, 48.0, 128.0, -229.0, 131.0, 48.0, -106.0, 105.0, 51.0, -190.0, 84.0, 111.0, 151.0, 119.0, -233.0, -7.0, -102.0, 122.0, 91.0, -111.0, 123.0, 168.0, 72.0, 115.0, 130.0, 51.0, 148.0, 180.0, 154.0, 103.0, 92.0, -3.0, -14.0, 54.0, 122.0, 135.0, -90.0, 162.0, 129.0, 48.0, 93.0, 97.0, 156.0, 140.0, -214.0, 150.0, 89.0, -55.0, 100.0, 7.0, 183.0, 99.0, 13.0, 148.0, 147.0, 94.0, 94.0, 111.0, 86.0, 167.0, -41.0, -265.0, 3.0, -144.0, 77.0, 81.0, 6.0, 103.0, 69.0, 93.0, 113.0, 178.0, 181.0, 80.0, 195.0, -179.0, 96.0, -287.0, 0.0, 140.0, 131.0, 182.0, 101.0, 125.0, -40.0, -205.0, 138.0, 163.0, 72.0, 32.0, 155.0, 107.0, 158.0, -316.0, 67.0, 179.0, 128.0, 152.0, -298.0, 118.0, 155.0, 114.0, 157.0, 186.0, 126.0, 67.0, 99.0], "policy_predator_policy_reward": [38.0, 42.0, 45.0, 0.0, 0.0, 41.0, 56.0, 62.0, 0.0, 76.0, 89.0, 0.0, 86.0, 47.0, 16.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 15.0, 13.0, 14.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 136.0, 122.0, 21.0, 132.0, 0.0, 0.0, 66.0, 0.0, 79.0, 108.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 27.0, 78.0, 82.0, 81.0, 6.0, 0.0, 4.0, 0.0, 0.0, 0.0, 7.0, 4.0, 2.0, 1.0, 1.0, 36.0, 11.0, 0.0, 31.0, 14.0, 0.0, 0.0, 0.0, 53.0, 2.0, 161.0, 91.0, 85.0, 66.0, 0.0, 0.0, 0.0, 0.0, 0.0, 56.0, 57.0, 10.0, 11.0, 115.0, 117.0, 0.0, 1.0, 0.0, 96.0, 12.0, 18.0, 134.0, 0.0, 126.0, 122.0, 0.0, 8.0, 69.0, 115.0, 0.0, 1.0, 108.0, 37.0, 64.0, 97.0, 0.0, 0.0, 0.0, 78.0, 0.0, 0.0, 0.0, 3.0, 1.0, 6.0, 0.0, 0.0, 3.0, 5.0, 0.0, 77.0, 0.0, 0.0, 96.0, 0.0, 0.0, 0.0, 31.0, 0.0, 0.0, 3.0, 118.0, 91.0, 0.0, 0.0, 83.0, 0.0, 40.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 4.0, 63.0, 0.0, 144.0, 149.0, 0.0, 112.0, 49.0, 55.0, 19.0, 15.0, 0.0, 3.0, 0.0, 0.0, 0.0, 36.0, 118.0, 0.0, 0.0, 150.0, 0.0, 0.0, 0.0, 6.0, 45.0, 77.0, 109.0, 0.0, 4.0, 0.0, 6.0, 35.0, 0.0, 0.0, 108.0, 74.0, 0.0, 0.0, 166.0, 0.0, 4.0, 0.0, 9.0, 8.0, 0.0, 0.0, 26.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.518527549336811, "mean_inference_ms": 19.433533915864253, "mean_action_processing_ms": 0.8169155713266079, "mean_env_wait_ms": 2.9596479993089218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011867761611938477, "StateBufferConnector_ms": 0.013606905937194824, "ViewRequirementAgentConnector_ms": 0.44084298610687256}, "num_episodes": 18, "episode_return_max": 359.0, "episode_return_min": -137.0, "episode_return_mean": 192.08, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 1808000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 124.30111805256492, "num_env_steps_trained_throughput_per_sec": 124.30111805256492, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 1808000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1808000, "timers": {"training_iteration_time_ms": 33702.229, "restore_workers_time_ms": 0.022, "training_step_time_ms": 33702.138, "sample_time_ms": 4613.168, "learn_time_ms": 29048.14, "learn_throughput": 137.702, "synch_weights_time_ms": 34.783}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 1808000}, "done": false, "training_iteration": 113, "trial_id": "45bed_00000", "date": "2024-08-13_03-08-16", "timestamp": 1723532896, "time_this_iter_s": 32.243648052215576, "time_total_s": 7078.5113089084625, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5211820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7078.5113089084625, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 88.2, "ram_util_percent": 83.25434782608696}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9598072079360169, "cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9550109957891797, "policy_loss": -0.0011403344509995014, "vf_loss": 1.956151324794406, "vf_explained_var": 0.00362809385572161, "kl": 0.0029439213306730683, "entropy": 0.25109593425951304, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 214515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.57565146690954, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.131336476815441, "policy_loss": -0.004030914711223905, "vf_loss": 7.135367397278074, "vf_explained_var": 0.0928322330353752, "kl": 0.005424752839623565, "entropy": 0.8391919095049459, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 214515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "env_runners": {"episode_reward_max": 359.0, "episode_reward_min": -139.0, "episode_reward_mean": 193.19, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -318.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 166.0}, "policy_reward_mean": {"prey_policy": 68.43, "predator_policy": 28.165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [202.0, 343.0, 24.0, 245.0, 245.0, 269.0, 332.0, 229.0, 303.0, 256.0, 143.0, 259.0, 285.0, 186.0, 45.0, 230.0, 167.0, 321.0, 315.0, 137.0, 263.0, 211.0, 254.0, 98.0, 206.0, 36.0, 190.0, 164.0, 78.0, 263.0, 31.0, 52.0, 213.0, 90.0, 240.0, 248.0, 206.0, 334.0, 203.0, 60.0, 176.0, 141.0, 291.0, 172.0, 256.0, 135.0, 239.0, 128.0, 230.0, 139.0, 295.0, 212.0, 201.0, 189.0, 31.0, 45.0, 191.0, 206.0, 209.0, 359.0, 311.0, 35.0, -137.0, 271.0, 289.0, 207.0, 42.0, 239.0, 228.0, 265.0, -67.0, 307.0, 20.0, 277.0, 288.0, 312.0, 192.0, 335.0, 286.0, 254.0, 136.0, 5.0, 296.0, -139.0, 214.0, 301.0, 155.0, -7.0, -123.0, 164.0, 149.0, 227.0, 161.0, 354.0, 344.0, 329.0, 356.0, 138.0, 180.0, 304.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [62.0, 140.0, 152.0, 191.0, -80.0, -1.0, 149.0, -67.0, 103.0, 136.0, 122.0, 143.0, 165.0, 167.0, 117.0, 101.0, 143.0, 157.0, 129.0, 90.0, 88.0, 44.0, 76.0, 138.0, 170.0, 115.0, 39.0, 94.0, 200.0, -318.0, 136.0, -82.0, -27.0, 128.0, 156.0, 165.0, 134.0, 181.0, -106.0, 130.0, 148.0, 94.0, 186.0, -207.0, 154.0, 99.0, -111.0, 113.0, 48.0, 128.0, -229.0, 131.0, 48.0, -106.0, 105.0, 51.0, -190.0, 84.0, 111.0, 151.0, 119.0, -233.0, -7.0, -102.0, 122.0, 91.0, -111.0, 123.0, 168.0, 72.0, 115.0, 130.0, 51.0, 148.0, 180.0, 154.0, 103.0, 92.0, -3.0, -14.0, 54.0, 122.0, 135.0, -90.0, 162.0, 129.0, 48.0, 93.0, 97.0, 156.0, 140.0, -214.0, 150.0, 89.0, -55.0, 100.0, 7.0, 183.0, 99.0, 13.0, 148.0, 147.0, 94.0, 94.0, 111.0, 86.0, 167.0, -41.0, -265.0, 3.0, -144.0, 77.0, 81.0, 6.0, 103.0, 69.0, 93.0, 113.0, 178.0, 181.0, 80.0, 195.0, -179.0, 96.0, -287.0, 0.0, 140.0, 131.0, 182.0, 101.0, 125.0, -40.0, -205.0, 138.0, 163.0, 72.0, 32.0, 155.0, 107.0, 158.0, -316.0, 67.0, 179.0, 128.0, 152.0, -298.0, 118.0, 155.0, 114.0, 157.0, 186.0, 126.0, 67.0, 99.0, 135.0, 200.0, 136.0, 150.0, 106.0, 136.0, 118.0, -8.0, -25.0, -71.0, 145.0, 151.0, -32.0, -297.0, 62.0, 124.0, 184.0, 107.0, 145.0, -193.0, -120.0, -14.0, -163.0, -245.0, 104.0, 29.0, -105.0, 171.0, 116.0, 106.0, 78.0, 70.0, 184.0, 170.0, 161.0, 183.0, 188.0, 141.0, 169.0, 187.0, 56.0, 82.0, 138.0, 42.0, 152.0, 130.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 27.0, 78.0, 82.0, 81.0, 6.0, 0.0, 4.0, 0.0, 0.0, 0.0, 7.0, 4.0, 2.0, 1.0, 1.0, 36.0, 11.0, 0.0, 31.0, 14.0, 0.0, 0.0, 0.0, 53.0, 2.0, 161.0, 91.0, 85.0, 66.0, 0.0, 0.0, 0.0, 0.0, 0.0, 56.0, 57.0, 10.0, 11.0, 115.0, 117.0, 0.0, 1.0, 0.0, 96.0, 12.0, 18.0, 134.0, 0.0, 126.0, 122.0, 0.0, 8.0, 69.0, 115.0, 0.0, 1.0, 108.0, 37.0, 64.0, 97.0, 0.0, 0.0, 0.0, 78.0, 0.0, 0.0, 0.0, 3.0, 1.0, 6.0, 0.0, 0.0, 3.0, 5.0, 0.0, 77.0, 0.0, 0.0, 96.0, 0.0, 0.0, 0.0, 31.0, 0.0, 0.0, 3.0, 118.0, 91.0, 0.0, 0.0, 83.0, 0.0, 40.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 4.0, 63.0, 0.0, 144.0, 149.0, 0.0, 112.0, 49.0, 55.0, 19.0, 15.0, 0.0, 3.0, 0.0, 0.0, 0.0, 36.0, 118.0, 0.0, 0.0, 150.0, 0.0, 0.0, 0.0, 6.0, 45.0, 77.0, 109.0, 0.0, 4.0, 0.0, 6.0, 35.0, 0.0, 0.0, 108.0, 74.0, 0.0, 0.0, 166.0, 0.0, 4.0, 0.0, 9.0, 8.0, 0.0, 0.0, 26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 26.0, 101.0, 0.0, 0.0, 0.0, 150.0, 40.0, 3.0, 25.0, 0.0, 10.0, 122.0, 81.0, 81.0, 46.0, 129.0, 156.0, 31.0, 0.0, 61.0, 22.0, 0.0, 5.0, 7.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.8922156935006536, "mean_inference_ms": 18.878193545590072, "mean_action_processing_ms": 0.8209343697604325, "mean_env_wait_ms": 2.9434740574321046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018700242042541504, "StateBufferConnector_ms": 0.013043403625488281, "ViewRequirementAgentConnector_ms": 0.4214005470275879}, "num_episodes": 23, "episode_return_max": 359.0, "episode_return_min": -139.0, "episode_return_mean": 193.19, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 124.5296435188336, "num_env_steps_trained_throughput_per_sec": 124.5296435188336, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 1824000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1824000, "timers": {"training_iteration_time_ms": 33792.908, "restore_workers_time_ms": 0.022, "training_step_time_ms": 33792.818, "sample_time_ms": 4624.868, "learn_time_ms": 29131.167, "learn_throughput": 137.31, "synch_weights_time_ms": 29.987}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "done": false, "training_iteration": 114, "trial_id": "45bed_00000", "date": "2024-08-13_03-08-48", "timestamp": 1723532928, "time_this_iter_s": 32.22870182991028, "time_total_s": 7110.740010738373, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44b3dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7110.740010738373, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 87.22, "ram_util_percent": 83.10666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.093668385922278, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.951014999170152, "policy_loss": -0.0012654493461860708, "vf_loss": 1.9522804476281324, "vf_explained_var": 0.0012636770331670368, "kl": 0.00201106331553208, "entropy": 0.219103973969896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 216405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.162063388644704, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.44226574998684, "policy_loss": -0.002360807676804523, "vf_loss": 8.44462657428923, "vf_explained_var": 0.0528217129921787, "kl": 0.008939984397696367, "entropy": 0.9287794478671261, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 216405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "env_runners": {"episode_reward_max": 359.0, "episode_reward_min": -152.0, "episode_reward_mean": 185.61, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -319.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 166.0}, "policy_reward_mean": {"prey_policy": 63.64, "predator_policy": 29.165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [315.0, 137.0, 263.0, 211.0, 254.0, 98.0, 206.0, 36.0, 190.0, 164.0, 78.0, 263.0, 31.0, 52.0, 213.0, 90.0, 240.0, 248.0, 206.0, 334.0, 203.0, 60.0, 176.0, 141.0, 291.0, 172.0, 256.0, 135.0, 239.0, 128.0, 230.0, 139.0, 295.0, 212.0, 201.0, 189.0, 31.0, 45.0, 191.0, 206.0, 209.0, 359.0, 311.0, 35.0, -137.0, 271.0, 289.0, 207.0, 42.0, 239.0, 228.0, 265.0, -67.0, 307.0, 20.0, 277.0, 288.0, 312.0, 192.0, 335.0, 286.0, 254.0, 136.0, 5.0, 296.0, -139.0, 214.0, 301.0, 155.0, -7.0, -123.0, 164.0, 149.0, 227.0, 161.0, 354.0, 344.0, 329.0, 356.0, 138.0, 180.0, 304.0, -2.0, 257.0, 274.0, 211.0, 282.0, 279.0, 32.0, 127.0, 307.0, 247.0, -152.0, 106.0, 309.0, 55.0, 83.0, 278.0, 302.0, 331.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [134.0, 181.0, -106.0, 130.0, 148.0, 94.0, 186.0, -207.0, 154.0, 99.0, -111.0, 113.0, 48.0, 128.0, -229.0, 131.0, 48.0, -106.0, 105.0, 51.0, -190.0, 84.0, 111.0, 151.0, 119.0, -233.0, -7.0, -102.0, 122.0, 91.0, -111.0, 123.0, 168.0, 72.0, 115.0, 130.0, 51.0, 148.0, 180.0, 154.0, 103.0, 92.0, -3.0, -14.0, 54.0, 122.0, 135.0, -90.0, 162.0, 129.0, 48.0, 93.0, 97.0, 156.0, 140.0, -214.0, 150.0, 89.0, -55.0, 100.0, 7.0, 183.0, 99.0, 13.0, 148.0, 147.0, 94.0, 94.0, 111.0, 86.0, 167.0, -41.0, -265.0, 3.0, -144.0, 77.0, 81.0, 6.0, 103.0, 69.0, 93.0, 113.0, 178.0, 181.0, 80.0, 195.0, -179.0, 96.0, -287.0, 0.0, 140.0, 131.0, 182.0, 101.0, 125.0, -40.0, -205.0, 138.0, 163.0, 72.0, 32.0, 155.0, 107.0, 158.0, -316.0, 67.0, 179.0, 128.0, 152.0, -298.0, 118.0, 155.0, 114.0, 157.0, 186.0, 126.0, 67.0, 99.0, 135.0, 200.0, 136.0, 150.0, 106.0, 136.0, 118.0, -8.0, -25.0, -71.0, 145.0, 151.0, -32.0, -297.0, 62.0, 124.0, 184.0, 107.0, 145.0, -193.0, -120.0, -14.0, -163.0, -245.0, 104.0, 29.0, -105.0, 171.0, 116.0, 106.0, 78.0, 70.0, 184.0, 170.0, 161.0, 183.0, 188.0, 141.0, 169.0, 187.0, 56.0, 82.0, 138.0, 42.0, 152.0, 130.0, 0.0, -9.0, 59.0, 129.0, 108.0, 135.0, 57.0, 154.0, 150.0, 55.0, 134.0, 57.0, -173.0, 74.0, 39.0, 75.0, 162.0, 137.0, 122.0, 110.0, -151.0, -189.0, -20.0, 104.0, 133.0, 176.0, 70.0, -319.0, -101.0, 94.0, 121.0, 157.0, 139.0, 163.0, 159.0, 172.0], "policy_predator_policy_reward": [0.0, 0.0, 56.0, 57.0, 10.0, 11.0, 115.0, 117.0, 0.0, 1.0, 0.0, 96.0, 12.0, 18.0, 134.0, 0.0, 126.0, 122.0, 0.0, 8.0, 69.0, 115.0, 0.0, 1.0, 108.0, 37.0, 64.0, 97.0, 0.0, 0.0, 0.0, 78.0, 0.0, 0.0, 0.0, 3.0, 1.0, 6.0, 0.0, 0.0, 3.0, 5.0, 0.0, 77.0, 0.0, 0.0, 96.0, 0.0, 0.0, 0.0, 31.0, 0.0, 0.0, 3.0, 118.0, 91.0, 0.0, 0.0, 83.0, 0.0, 40.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 4.0, 63.0, 0.0, 144.0, 149.0, 0.0, 112.0, 49.0, 55.0, 19.0, 15.0, 0.0, 3.0, 0.0, 0.0, 0.0, 36.0, 118.0, 0.0, 0.0, 150.0, 0.0, 0.0, 0.0, 6.0, 45.0, 77.0, 109.0, 0.0, 4.0, 0.0, 6.0, 35.0, 0.0, 0.0, 108.0, 74.0, 0.0, 0.0, 166.0, 0.0, 4.0, 0.0, 9.0, 8.0, 0.0, 0.0, 26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 26.0, 101.0, 0.0, 0.0, 0.0, 150.0, 40.0, 3.0, 25.0, 0.0, 10.0, 122.0, 81.0, 81.0, 46.0, 129.0, 156.0, 31.0, 0.0, 61.0, 22.0, 0.0, 5.0, 7.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 8.0, 7.0, 0.0, 40.0, 29.0, 28.0, 3.0, 0.0, 0.0, 39.0, 38.0, 44.0, 44.0, 126.0, 5.0, 0.0, 13.0, 0.0, 8.0, 15.0, 0.0, 76.0, 112.0, 12.0, 10.0, 0.0, 0.0, 141.0, 163.0, 90.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.4322410088742235, "mean_inference_ms": 19.192968562713123, "mean_action_processing_ms": 0.8174026300768961, "mean_env_wait_ms": 2.92317299777579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018257617950439453, "StateBufferConnector_ms": 0.011929512023925781, "ViewRequirementAgentConnector_ms": 0.35503852367401123}, "num_episodes": 18, "episode_return_max": 359.0, "episode_return_min": -152.0, "episode_return_mean": 185.61, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 112.77615366462929, "num_env_steps_trained_throughput_per_sec": 112.77615366462929, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 1840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1840000, "timers": {"training_iteration_time_ms": 34329.182, "restore_workers_time_ms": 0.022, "training_step_time_ms": 34329.09, "sample_time_ms": 4661.93, "learn_time_ms": 29630.724, "learn_throughput": 134.995, "synch_weights_time_ms": 29.899}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "done": false, "training_iteration": 115, "trial_id": "45bed_00000", "date": "2024-08-13_03-09-24", "timestamp": 1723532964, "time_this_iter_s": 35.53516697883606, "time_total_s": 7146.275177717209, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b521c550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7146.275177717209, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 88.52199999999999, "ram_util_percent": 82.89}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8861479435490552, "cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2449795869607774, "policy_loss": -0.00088367503316255, "vf_loss": 1.2458632647991181, "vf_explained_var": 0.0027014985917106506, "kl": 0.0037691146336096435, "entropy": 0.21589684513589694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 218295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.265383588983898, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.509832249747383, "policy_loss": -0.004443371847823814, "vf_loss": 8.514275620475647, "vf_explained_var": 0.11352469757120445, "kl": 0.012063405828892948, "entropy": 0.8844672131790686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 218295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000}, "env_runners": {"episode_reward_max": 359.0, "episode_reward_min": -152.0, "episode_reward_mean": 188.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -319.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 166.0}, "policy_reward_mean": {"prey_policy": 67.895, "predator_policy": 26.11}, "custom_metrics": {}, "hist_stats": {"episode_reward": [176.0, 141.0, 291.0, 172.0, 256.0, 135.0, 239.0, 128.0, 230.0, 139.0, 295.0, 212.0, 201.0, 189.0, 31.0, 45.0, 191.0, 206.0, 209.0, 359.0, 311.0, 35.0, -137.0, 271.0, 289.0, 207.0, 42.0, 239.0, 228.0, 265.0, -67.0, 307.0, 20.0, 277.0, 288.0, 312.0, 192.0, 335.0, 286.0, 254.0, 136.0, 5.0, 296.0, -139.0, 214.0, 301.0, 155.0, -7.0, -123.0, 164.0, 149.0, 227.0, 161.0, 354.0, 344.0, 329.0, 356.0, 138.0, 180.0, 304.0, -2.0, 257.0, 274.0, 211.0, 282.0, 279.0, 32.0, 127.0, 307.0, 247.0, -152.0, 106.0, 309.0, 55.0, 83.0, 278.0, 302.0, 331.0, 164.0, 238.0, 229.0, 174.0, 221.0, 186.0, 264.0, 241.0, 243.0, 101.0, 150.0, 169.0, 215.0, 151.0, -31.0, 282.0, 139.0, 185.0, 214.0, 317.0, 84.0, 196.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [54.0, 122.0, 135.0, -90.0, 162.0, 129.0, 48.0, 93.0, 97.0, 156.0, 140.0, -214.0, 150.0, 89.0, -55.0, 100.0, 7.0, 183.0, 99.0, 13.0, 148.0, 147.0, 94.0, 94.0, 111.0, 86.0, 167.0, -41.0, -265.0, 3.0, -144.0, 77.0, 81.0, 6.0, 103.0, 69.0, 93.0, 113.0, 178.0, 181.0, 80.0, 195.0, -179.0, 96.0, -287.0, 0.0, 140.0, 131.0, 182.0, 101.0, 125.0, -40.0, -205.0, 138.0, 163.0, 72.0, 32.0, 155.0, 107.0, 158.0, -316.0, 67.0, 179.0, 128.0, 152.0, -298.0, 118.0, 155.0, 114.0, 157.0, 186.0, 126.0, 67.0, 99.0, 135.0, 200.0, 136.0, 150.0, 106.0, 136.0, 118.0, -8.0, -25.0, -71.0, 145.0, 151.0, -32.0, -297.0, 62.0, 124.0, 184.0, 107.0, 145.0, -193.0, -120.0, -14.0, -163.0, -245.0, 104.0, 29.0, -105.0, 171.0, 116.0, 106.0, 78.0, 70.0, 184.0, 170.0, 161.0, 183.0, 188.0, 141.0, 169.0, 187.0, 56.0, 82.0, 138.0, 42.0, 152.0, 130.0, 0.0, -9.0, 59.0, 129.0, 108.0, 135.0, 57.0, 154.0, 150.0, 55.0, 134.0, 57.0, -173.0, 74.0, 39.0, 75.0, 162.0, 137.0, 122.0, 110.0, -151.0, -189.0, -20.0, 104.0, 133.0, 176.0, 70.0, -319.0, -101.0, 94.0, 121.0, 157.0, 139.0, 163.0, 159.0, 172.0, 49.0, 115.0, 111.0, 127.0, 146.0, 83.0, 36.0, 56.0, 126.0, 87.0, 29.0, 111.0, 146.0, 118.0, 87.0, 148.0, 157.0, 60.0, -46.0, 119.0, -8.0, 123.0, -10.0, 67.0, 124.0, 25.0, 111.0, -23.0, -49.0, -67.0, 152.0, 130.0, 94.0, -59.0, 128.0, 28.0, 109.0, -17.0, 147.0, 170.0, 102.0, -64.0, 24.0, 94.0], "policy_predator_policy_reward": [0.0, 0.0, 96.0, 0.0, 0.0, 0.0, 31.0, 0.0, 0.0, 3.0, 118.0, 91.0, 0.0, 0.0, 83.0, 0.0, 40.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 4.0, 63.0, 0.0, 144.0, 149.0, 0.0, 112.0, 49.0, 55.0, 19.0, 15.0, 0.0, 3.0, 0.0, 0.0, 0.0, 36.0, 118.0, 0.0, 0.0, 150.0, 0.0, 0.0, 0.0, 6.0, 45.0, 77.0, 109.0, 0.0, 4.0, 0.0, 6.0, 35.0, 0.0, 0.0, 108.0, 74.0, 0.0, 0.0, 166.0, 0.0, 4.0, 0.0, 9.0, 8.0, 0.0, 0.0, 26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 26.0, 101.0, 0.0, 0.0, 0.0, 150.0, 40.0, 3.0, 25.0, 0.0, 10.0, 122.0, 81.0, 81.0, 46.0, 129.0, 156.0, 31.0, 0.0, 61.0, 22.0, 0.0, 5.0, 7.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 8.0, 7.0, 0.0, 40.0, 29.0, 28.0, 3.0, 0.0, 0.0, 39.0, 38.0, 44.0, 44.0, 126.0, 5.0, 0.0, 13.0, 0.0, 8.0, 15.0, 0.0, 76.0, 112.0, 12.0, 10.0, 0.0, 0.0, 141.0, 163.0, 90.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 41.0, 41.0, 0.0, 8.0, 32.0, 14.0, 0.0, 0.0, 6.0, 0.0, 26.0, 0.0, 28.0, 0.0, 20.0, 15.0, 53.0, 59.0, 9.0, 57.0, 0.0, 63.0, 85.0, 0.0, 0.0, 0.0, 24.0, 80.0, 20.0, 9.0, 68.0, 54.0, 0.0, 0.0, 46.0, 0.0, 31.0, 47.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.396530357372069, "mean_inference_ms": 18.855602578677132, "mean_action_processing_ms": 0.818025182008084, "mean_env_wait_ms": 3.1071877217271675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019464731216430664, "StateBufferConnector_ms": 0.008208036422729492, "ViewRequirementAgentConnector_ms": 0.3449363708496094}, "num_episodes": 22, "episode_return_max": 359.0, "episode_return_min": -152.0, "episode_return_mean": 188.01, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 122.68455894485355, "num_env_steps_trained_throughput_per_sec": 122.68455894485355, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 1856000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1856000, "timers": {"training_iteration_time_ms": 33144.677, "restore_workers_time_ms": 0.022, "training_step_time_ms": 33144.585, "sample_time_ms": 4662.004, "learn_time_ms": 28447.103, "learn_throughput": 140.612, "synch_weights_time_ms": 28.576}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000}, "done": false, "training_iteration": 116, "trial_id": "45bed_00000", "date": "2024-08-13_03-09-56", "timestamp": 1723532996, "time_this_iter_s": 32.68556213378906, "time_total_s": 7178.960739850998, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4624940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7178.960739850998, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 87.61276595744681, "ram_util_percent": 83.13404255319149}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7744806572854046, "cur_kl_coeff": 3.637978807091713e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0861858460953626, "policy_loss": -0.002071600551248858, "vf_loss": 1.0882574454659508, "vf_explained_var": 0.0012166578933675454, "kl": 0.0036204505363819175, "entropy": 0.21835342565620386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 220185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.754054769857852, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.458599902965404, "policy_loss": -0.00298341065509708, "vf_loss": 7.461583307054307, "vf_explained_var": 0.5498388782695488, "kl": 0.006533284140842432, "entropy": 1.02794817064805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 220185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "env_runners": {"episode_reward_max": 359.0, "episode_reward_min": -152.0, "episode_reward_mean": 193.5, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -319.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 166.0}, "policy_reward_mean": {"prey_policy": 74.605, "predator_policy": 22.145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [209.0, 359.0, 311.0, 35.0, -137.0, 271.0, 289.0, 207.0, 42.0, 239.0, 228.0, 265.0, -67.0, 307.0, 20.0, 277.0, 288.0, 312.0, 192.0, 335.0, 286.0, 254.0, 136.0, 5.0, 296.0, -139.0, 214.0, 301.0, 155.0, -7.0, -123.0, 164.0, 149.0, 227.0, 161.0, 354.0, 344.0, 329.0, 356.0, 138.0, 180.0, 304.0, -2.0, 257.0, 274.0, 211.0, 282.0, 279.0, 32.0, 127.0, 307.0, 247.0, -152.0, 106.0, 309.0, 55.0, 83.0, 278.0, 302.0, 331.0, 164.0, 238.0, 229.0, 174.0, 221.0, 186.0, 264.0, 241.0, 243.0, 101.0, 150.0, 169.0, 215.0, 151.0, -31.0, 282.0, 139.0, 185.0, 214.0, 317.0, 84.0, 196.0, 155.0, 172.0, 339.0, 298.0, 215.0, 297.0, 165.0, 179.0, 331.0, 338.0, 158.0, 169.0, 218.0, 256.0, 337.0, -14.0, 88.0, 125.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [93.0, 113.0, 178.0, 181.0, 80.0, 195.0, -179.0, 96.0, -287.0, 0.0, 140.0, 131.0, 182.0, 101.0, 125.0, -40.0, -205.0, 138.0, 163.0, 72.0, 32.0, 155.0, 107.0, 158.0, -316.0, 67.0, 179.0, 128.0, 152.0, -298.0, 118.0, 155.0, 114.0, 157.0, 186.0, 126.0, 67.0, 99.0, 135.0, 200.0, 136.0, 150.0, 106.0, 136.0, 118.0, -8.0, -25.0, -71.0, 145.0, 151.0, -32.0, -297.0, 62.0, 124.0, 184.0, 107.0, 145.0, -193.0, -120.0, -14.0, -163.0, -245.0, 104.0, 29.0, -105.0, 171.0, 116.0, 106.0, 78.0, 70.0, 184.0, 170.0, 161.0, 183.0, 188.0, 141.0, 169.0, 187.0, 56.0, 82.0, 138.0, 42.0, 152.0, 130.0, 0.0, -9.0, 59.0, 129.0, 108.0, 135.0, 57.0, 154.0, 150.0, 55.0, 134.0, 57.0, -173.0, 74.0, 39.0, 75.0, 162.0, 137.0, 122.0, 110.0, -151.0, -189.0, -20.0, 104.0, 133.0, 176.0, 70.0, -319.0, -101.0, 94.0, 121.0, 157.0, 139.0, 163.0, 159.0, 172.0, 49.0, 115.0, 111.0, 127.0, 146.0, 83.0, 36.0, 56.0, 126.0, 87.0, 29.0, 111.0, 146.0, 118.0, 87.0, 148.0, 157.0, 60.0, -46.0, 119.0, -8.0, 123.0, -10.0, 67.0, 124.0, 25.0, 111.0, -23.0, -49.0, -67.0, 152.0, 130.0, 94.0, -59.0, 128.0, 28.0, 109.0, -17.0, 147.0, 170.0, 102.0, -64.0, 24.0, 94.0, 168.0, -58.0, -20.0, 82.0, 175.0, 164.0, 124.0, 174.0, 134.0, 81.0, 152.0, 136.0, 163.0, 0.0, 179.0, 0.0, 157.0, 173.0, 159.0, 179.0, -2.0, 109.0, 0.0, 169.0, 112.0, 92.0, 107.0, 142.0, 181.0, 156.0, 0.0, -28.0, -6.0, 18.0, 124.0, 0.0], "policy_predator_policy_reward": [0.0, 3.0, 0.0, 0.0, 0.0, 36.0, 118.0, 0.0, 0.0, 150.0, 0.0, 0.0, 0.0, 6.0, 45.0, 77.0, 109.0, 0.0, 4.0, 0.0, 6.0, 35.0, 0.0, 0.0, 108.0, 74.0, 0.0, 0.0, 166.0, 0.0, 4.0, 0.0, 9.0, 8.0, 0.0, 0.0, 26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 26.0, 101.0, 0.0, 0.0, 0.0, 150.0, 40.0, 3.0, 25.0, 0.0, 10.0, 122.0, 81.0, 81.0, 46.0, 129.0, 156.0, 31.0, 0.0, 61.0, 22.0, 0.0, 5.0, 7.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 8.0, 7.0, 0.0, 40.0, 29.0, 28.0, 3.0, 0.0, 0.0, 39.0, 38.0, 44.0, 44.0, 126.0, 5.0, 0.0, 13.0, 0.0, 8.0, 15.0, 0.0, 76.0, 112.0, 12.0, 10.0, 0.0, 0.0, 141.0, 163.0, 90.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 41.0, 41.0, 0.0, 8.0, 32.0, 14.0, 0.0, 0.0, 6.0, 0.0, 26.0, 0.0, 28.0, 0.0, 20.0, 15.0, 53.0, 59.0, 9.0, 57.0, 0.0, 63.0, 85.0, 0.0, 0.0, 0.0, 24.0, 80.0, 20.0, 9.0, 68.0, 54.0, 0.0, 0.0, 46.0, 0.0, 31.0, 47.0, 29.0, 16.0, 73.0, 37.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 46.0, 5.0, 0.0, 0.0, 14.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 14.0, 76.0, 0.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.3630063339500085, "mean_inference_ms": 18.959732036222963, "mean_action_processing_ms": 0.8177142276940313, "mean_env_wait_ms": 2.880352926737862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039873719215393066, "StateBufferConnector_ms": 0.01080942153930664, "ViewRequirementAgentConnector_ms": 0.3320605754852295}, "num_episodes": 18, "episode_return_max": 359.0, "episode_return_min": -152.0, "episode_return_mean": 193.5, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 6.575089346532512, "num_env_steps_trained_throughput_per_sec": 6.575089346532512, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 1872000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1872000, "timers": {"training_iteration_time_ms": 90291.95, "restore_workers_time_ms": 0.02, "training_step_time_ms": 90291.867, "sample_time_ms": 4549.554, "learn_time_ms": 85707.676, "learn_throughput": 46.67, "synch_weights_time_ms": 28.061}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "done": false, "training_iteration": 117, "trial_id": "45bed_00000", "date": "2024-08-13_03-20-05", "timestamp": 1723533605, "time_this_iter_s": 608.4222929477692, "time_total_s": 7787.383032798767, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3307618b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7787.383032798767, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 93.7826923076923, "ram_util_percent": 83.31346153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8550734695737009, "cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4769313234185415, "policy_loss": -0.0011608892650141445, "vf_loss": 1.4780922138817096, "vf_explained_var": 0.0013855208164800412, "kl": 0.003279726545644964, "entropy": 0.26378071353075994, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 222075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.396391002841728, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.9083559321348, "policy_loss": 0.0008376377881085746, "vf_loss": 6.90751827734488, "vf_explained_var": 0.31538984510633683, "kl": 0.009322490615480858, "entropy": 0.9058970733294411, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 222075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000}, "env_runners": {"episode_reward_max": 356.0, "episode_reward_min": -152.0, "episode_reward_mean": 201.19, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -319.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 163.0}, "policy_reward_mean": {"prey_policy": 79.555, "predator_policy": 21.04}, "custom_metrics": {}, "hist_stats": {"episode_reward": [192.0, 335.0, 286.0, 254.0, 136.0, 5.0, 296.0, -139.0, 214.0, 301.0, 155.0, -7.0, -123.0, 164.0, 149.0, 227.0, 161.0, 354.0, 344.0, 329.0, 356.0, 138.0, 180.0, 304.0, -2.0, 257.0, 274.0, 211.0, 282.0, 279.0, 32.0, 127.0, 307.0, 247.0, -152.0, 106.0, 309.0, 55.0, 83.0, 278.0, 302.0, 331.0, 164.0, 238.0, 229.0, 174.0, 221.0, 186.0, 264.0, 241.0, 243.0, 101.0, 150.0, 169.0, 215.0, 151.0, -31.0, 282.0, 139.0, 185.0, 214.0, 317.0, 84.0, 196.0, 155.0, 172.0, 339.0, 298.0, 215.0, 297.0, 165.0, 179.0, 331.0, 338.0, 158.0, 169.0, 218.0, 256.0, 337.0, -14.0, 88.0, 125.0, 68.0, 192.0, 157.0, 343.0, 205.0, 333.0, 317.0, 355.0, 173.0, 294.0, 182.0, 328.0, 232.0, 213.0, 89.0, 208.0, 233.0, 302.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [67.0, 99.0, 135.0, 200.0, 136.0, 150.0, 106.0, 136.0, 118.0, -8.0, -25.0, -71.0, 145.0, 151.0, -32.0, -297.0, 62.0, 124.0, 184.0, 107.0, 145.0, -193.0, -120.0, -14.0, -163.0, -245.0, 104.0, 29.0, -105.0, 171.0, 116.0, 106.0, 78.0, 70.0, 184.0, 170.0, 161.0, 183.0, 188.0, 141.0, 169.0, 187.0, 56.0, 82.0, 138.0, 42.0, 152.0, 130.0, 0.0, -9.0, 59.0, 129.0, 108.0, 135.0, 57.0, 154.0, 150.0, 55.0, 134.0, 57.0, -173.0, 74.0, 39.0, 75.0, 162.0, 137.0, 122.0, 110.0, -151.0, -189.0, -20.0, 104.0, 133.0, 176.0, 70.0, -319.0, -101.0, 94.0, 121.0, 157.0, 139.0, 163.0, 159.0, 172.0, 49.0, 115.0, 111.0, 127.0, 146.0, 83.0, 36.0, 56.0, 126.0, 87.0, 29.0, 111.0, 146.0, 118.0, 87.0, 148.0, 157.0, 60.0, -46.0, 119.0, -8.0, 123.0, -10.0, 67.0, 124.0, 25.0, 111.0, -23.0, -49.0, -67.0, 152.0, 130.0, 94.0, -59.0, 128.0, 28.0, 109.0, -17.0, 147.0, 170.0, 102.0, -64.0, 24.0, 94.0, 168.0, -58.0, -20.0, 82.0, 175.0, 164.0, 124.0, 174.0, 134.0, 81.0, 152.0, 136.0, 163.0, 0.0, 179.0, 0.0, 157.0, 173.0, 159.0, 179.0, -2.0, 109.0, 0.0, 169.0, 112.0, 92.0, 107.0, 142.0, 181.0, 156.0, 0.0, -28.0, -6.0, 18.0, 124.0, 0.0, 0.0, 10.0, 14.0, 115.0, 133.0, -110.0, 167.0, 176.0, -145.0, 174.0, 160.0, 173.0, 143.0, 174.0, 187.0, 168.0, 175.0, -4.0, 129.0, 137.0, 185.0, -8.0, 155.0, 164.0, 20.0, 158.0, 163.0, 36.0, 102.0, -92.0, 17.0, 140.0, 49.0, 145.0, 168.0, 109.0], "policy_predator_policy_reward": [26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 26.0, 101.0, 0.0, 0.0, 0.0, 150.0, 40.0, 3.0, 25.0, 0.0, 10.0, 122.0, 81.0, 81.0, 46.0, 129.0, 156.0, 31.0, 0.0, 61.0, 22.0, 0.0, 5.0, 7.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 8.0, 7.0, 0.0, 40.0, 29.0, 28.0, 3.0, 0.0, 0.0, 39.0, 38.0, 44.0, 44.0, 126.0, 5.0, 0.0, 13.0, 0.0, 8.0, 15.0, 0.0, 76.0, 112.0, 12.0, 10.0, 0.0, 0.0, 141.0, 163.0, 90.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 41.0, 41.0, 0.0, 8.0, 32.0, 14.0, 0.0, 0.0, 6.0, 0.0, 26.0, 0.0, 28.0, 0.0, 20.0, 15.0, 53.0, 59.0, 9.0, 57.0, 0.0, 63.0, 85.0, 0.0, 0.0, 0.0, 24.0, 80.0, 20.0, 9.0, 68.0, 54.0, 0.0, 0.0, 46.0, 0.0, 31.0, 47.0, 29.0, 16.0, 73.0, 37.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 46.0, 5.0, 0.0, 0.0, 14.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 14.0, 76.0, 0.0, 0.0, 1.0, 58.0, 0.0, 0.0, 63.0, 67.0, 67.0, 0.0, 0.0, 88.0, 88.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 28.0, 0.0, 4.0, 1.0, 9.0, 0.0, 54.0, 0.0, 0.0, 14.0, 0.0, 79.0, 51.0, 0.0, 30.0, 9.0, 9.0, 16.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.328125290590984, "mean_inference_ms": 18.85324499052134, "mean_action_processing_ms": 0.8173002009076782, "mean_env_wait_ms": 2.862721941251174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04071831703186035, "StateBufferConnector_ms": 0.010019779205322266, "ViewRequirementAgentConnector_ms": 0.2990013360977173}, "num_episodes": 18, "episode_return_max": 356.0, "episode_return_min": -152.0, "episode_return_mean": 201.19, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 238.0707371607885, "num_env_steps_trained_throughput_per_sec": 238.0707371607885, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 1888000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1888000, "timers": {"training_iteration_time_ms": 88596.428, "restore_workers_time_ms": 0.02, "training_step_time_ms": 88596.352, "sample_time_ms": 4303.187, "learn_time_ms": 84259.564, "learn_throughput": 47.472, "synch_weights_time_ms": 27.193}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000}, "done": false, "training_iteration": 118, "trial_id": "45bed_00000", "date": "2024-08-13_03-20-22", "timestamp": 1723533622, "time_this_iter_s": 16.838480949401855, "time_total_s": 7804.221513748169, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5211f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7804.221513748169, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 85.68333333333334, "ram_util_percent": 83.6125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2231444295870249, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.764986709564451, "policy_loss": -0.0008105957387852921, "vf_loss": 2.7657973131174765, "vf_explained_var": 0.004632097703439218, "kl": 0.0020124789879507016, "entropy": 0.2292377777594738, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 223965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.71810021208077, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.796237413466923, "policy_loss": -0.0039030998238120916, "vf_loss": 6.800140523910523, "vf_explained_var": 0.48475568275603037, "kl": 0.008802623516845787, "entropy": 1.0054565580749006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 223965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": -152.0, "episode_reward_mean": 205.73, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -319.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 163.0}, "policy_reward_mean": {"prey_policy": 82.595, "predator_policy": 20.27}, "custom_metrics": {}, "hist_stats": {"episode_reward": [304.0, -2.0, 257.0, 274.0, 211.0, 282.0, 279.0, 32.0, 127.0, 307.0, 247.0, -152.0, 106.0, 309.0, 55.0, 83.0, 278.0, 302.0, 331.0, 164.0, 238.0, 229.0, 174.0, 221.0, 186.0, 264.0, 241.0, 243.0, 101.0, 150.0, 169.0, 215.0, 151.0, -31.0, 282.0, 139.0, 185.0, 214.0, 317.0, 84.0, 196.0, 155.0, 172.0, 339.0, 298.0, 215.0, 297.0, 165.0, 179.0, 331.0, 338.0, 158.0, 169.0, 218.0, 256.0, 337.0, -14.0, 88.0, 125.0, 68.0, 192.0, 157.0, 343.0, 205.0, 333.0, 317.0, 355.0, 173.0, 294.0, 182.0, 328.0, 232.0, 213.0, 89.0, 208.0, 233.0, 302.0, 193.0, 183.0, 324.0, 175.0, 323.0, 142.0, 373.0, 278.0, 353.0, 99.0, 328.0, 166.0, 134.0, 39.0, 213.0, 338.0, 140.0, 307.0, -64.0, 390.0, 113.0, 223.0, -9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [152.0, 130.0, 0.0, -9.0, 59.0, 129.0, 108.0, 135.0, 57.0, 154.0, 150.0, 55.0, 134.0, 57.0, -173.0, 74.0, 39.0, 75.0, 162.0, 137.0, 122.0, 110.0, -151.0, -189.0, -20.0, 104.0, 133.0, 176.0, 70.0, -319.0, -101.0, 94.0, 121.0, 157.0, 139.0, 163.0, 159.0, 172.0, 49.0, 115.0, 111.0, 127.0, 146.0, 83.0, 36.0, 56.0, 126.0, 87.0, 29.0, 111.0, 146.0, 118.0, 87.0, 148.0, 157.0, 60.0, -46.0, 119.0, -8.0, 123.0, -10.0, 67.0, 124.0, 25.0, 111.0, -23.0, -49.0, -67.0, 152.0, 130.0, 94.0, -59.0, 128.0, 28.0, 109.0, -17.0, 147.0, 170.0, 102.0, -64.0, 24.0, 94.0, 168.0, -58.0, -20.0, 82.0, 175.0, 164.0, 124.0, 174.0, 134.0, 81.0, 152.0, 136.0, 163.0, 0.0, 179.0, 0.0, 157.0, 173.0, 159.0, 179.0, -2.0, 109.0, 0.0, 169.0, 112.0, 92.0, 107.0, 142.0, 181.0, 156.0, 0.0, -28.0, -6.0, 18.0, 124.0, 0.0, 0.0, 10.0, 14.0, 115.0, 133.0, -110.0, 167.0, 176.0, -145.0, 174.0, 160.0, 173.0, 143.0, 174.0, 187.0, 168.0, 175.0, -4.0, 129.0, 137.0, 185.0, -8.0, 155.0, 164.0, 20.0, 158.0, 163.0, 36.0, 102.0, -92.0, 17.0, 140.0, 49.0, 145.0, 168.0, 109.0, 49.0, 107.0, 183.0, 0.0, 61.0, 172.0, -33.0, 120.0, 132.0, 191.0, 44.0, 0.0, 185.0, 184.0, 86.0, 136.0, 153.0, 191.0, 29.0, -40.0, 195.0, 116.0, 24.0, 100.0, 150.0, -32.0, -236.0, 126.0, 169.0, 21.0, 150.0, 176.0, 144.0, -34.0, 170.0, 112.0, 0.0, -196.0, 199.0, 191.0, 0.0, 77.0, 154.0, 69.0, -2.0, -18.0], "policy_predator_policy_reward": [14.0, 8.0, 7.0, 0.0, 40.0, 29.0, 28.0, 3.0, 0.0, 0.0, 39.0, 38.0, 44.0, 44.0, 126.0, 5.0, 0.0, 13.0, 0.0, 8.0, 15.0, 0.0, 76.0, 112.0, 12.0, 10.0, 0.0, 0.0, 141.0, 163.0, 90.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 41.0, 41.0, 0.0, 8.0, 32.0, 14.0, 0.0, 0.0, 6.0, 0.0, 26.0, 0.0, 28.0, 0.0, 20.0, 15.0, 53.0, 59.0, 9.0, 57.0, 0.0, 63.0, 85.0, 0.0, 0.0, 0.0, 24.0, 80.0, 20.0, 9.0, 68.0, 54.0, 0.0, 0.0, 46.0, 0.0, 31.0, 47.0, 29.0, 16.0, 73.0, 37.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 46.0, 5.0, 0.0, 0.0, 14.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 14.0, 76.0, 0.0, 0.0, 1.0, 58.0, 0.0, 0.0, 63.0, 67.0, 67.0, 0.0, 0.0, 88.0, 88.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 28.0, 0.0, 4.0, 1.0, 9.0, 0.0, 54.0, 0.0, 0.0, 14.0, 0.0, 79.0, 51.0, 0.0, 30.0, 9.0, 9.0, 16.0, 2.0, 35.0, 0.0, 0.0, 46.0, 45.0, 47.0, 41.0, 0.0, 0.0, 47.0, 51.0, 1.0, 3.0, 37.0, 19.0, 9.0, 0.0, 63.0, 47.0, 0.0, 17.0, 0.0, 42.0, 0.0, 16.0, 101.0, 48.0, 0.0, 23.0, 12.0, 0.0, 13.0, 17.0, 25.0, 0.0, 0.0, 132.0, 0.0, 0.0, 0.0, 36.0, 0.0, 0.0, 2.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.274417536688446, "mean_inference_ms": 18.71698983949109, "mean_action_processing_ms": 0.8157851849206921, "mean_env_wait_ms": 2.844671264173889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299880027770996, "StateBufferConnector_ms": 0.009631752967834473, "ViewRequirementAgentConnector_ms": 0.2584421634674072}, "num_episodes": 23, "episode_return_max": 390.0, "episode_return_min": -152.0, "episode_return_mean": 205.73, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.0689646830580335, "num_env_steps_trained_throughput_per_sec": 4.0689646830580335, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 1904000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1904000, "timers": {"training_iteration_time_ms": 183600.511, "restore_workers_time_ms": 0.021, "training_step_time_ms": 183600.436, "sample_time_ms": 4019.682, "learn_time_ms": 179547.695, "learn_throughput": 22.278, "synch_weights_time_ms": 26.357}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000}, "done": false, "training_iteration": 119, "trial_id": "45bed_00000", "date": "2024-08-13_03-36-45", "timestamp": 1723534605, "time_this_iter_s": 983.15070104599, "time_total_s": 8787.372214794159, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44b43a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8787.372214794159, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 94.3, "ram_util_percent": 83.05000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8757492932338248, "cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2759093191888597, "policy_loss": -0.0008651265310291102, "vf_loss": 1.2767744453968826, "vf_explained_var": 0.005217986605154774, "kl": 0.0028844628307143822, "entropy": 0.24374608055309013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 225855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.548880843573777, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.7605483140894975, "policy_loss": -0.0003802795160226721, "vf_loss": 6.760928593489228, "vf_explained_var": 0.35992823489128595, "kl": 0.006111032395431062, "entropy": 0.9469011116910864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 225855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": -64.0, "episode_reward_mean": 207.73, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -236.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 132.0}, "policy_reward_mean": {"prey_policy": 84.635, "predator_policy": 19.23}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.0, 221.0, 186.0, 264.0, 241.0, 243.0, 101.0, 150.0, 169.0, 215.0, 151.0, -31.0, 282.0, 139.0, 185.0, 214.0, 317.0, 84.0, 196.0, 155.0, 172.0, 339.0, 298.0, 215.0, 297.0, 165.0, 179.0, 331.0, 338.0, 158.0, 169.0, 218.0, 256.0, 337.0, -14.0, 88.0, 125.0, 68.0, 192.0, 157.0, 343.0, 205.0, 333.0, 317.0, 355.0, 173.0, 294.0, 182.0, 328.0, 232.0, 213.0, 89.0, 208.0, 233.0, 302.0, 193.0, 183.0, 324.0, 175.0, 323.0, 142.0, 373.0, 278.0, 353.0, 99.0, 328.0, 166.0, 134.0, 39.0, 213.0, 338.0, 140.0, 307.0, -64.0, 390.0, 113.0, 223.0, -9.0, 119.0, 325.0, 121.0, 236.0, 338.0, 62.0, -3.0, 190.0, 278.0, 216.0, 271.0, 305.0, 93.0, 295.0, 143.0, 301.0, 199.0, 150.0, 221.0, 85.0, 164.0, 352.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [36.0, 56.0, 126.0, 87.0, 29.0, 111.0, 146.0, 118.0, 87.0, 148.0, 157.0, 60.0, -46.0, 119.0, -8.0, 123.0, -10.0, 67.0, 124.0, 25.0, 111.0, -23.0, -49.0, -67.0, 152.0, 130.0, 94.0, -59.0, 128.0, 28.0, 109.0, -17.0, 147.0, 170.0, 102.0, -64.0, 24.0, 94.0, 168.0, -58.0, -20.0, 82.0, 175.0, 164.0, 124.0, 174.0, 134.0, 81.0, 152.0, 136.0, 163.0, 0.0, 179.0, 0.0, 157.0, 173.0, 159.0, 179.0, -2.0, 109.0, 0.0, 169.0, 112.0, 92.0, 107.0, 142.0, 181.0, 156.0, 0.0, -28.0, -6.0, 18.0, 124.0, 0.0, 0.0, 10.0, 14.0, 115.0, 133.0, -110.0, 167.0, 176.0, -145.0, 174.0, 160.0, 173.0, 143.0, 174.0, 187.0, 168.0, 175.0, -4.0, 129.0, 137.0, 185.0, -8.0, 155.0, 164.0, 20.0, 158.0, 163.0, 36.0, 102.0, -92.0, 17.0, 140.0, 49.0, 145.0, 168.0, 109.0, 49.0, 107.0, 183.0, 0.0, 61.0, 172.0, -33.0, 120.0, 132.0, 191.0, 44.0, 0.0, 185.0, 184.0, 86.0, 136.0, 153.0, 191.0, 29.0, -40.0, 195.0, 116.0, 24.0, 100.0, 150.0, -32.0, -236.0, 126.0, 169.0, 21.0, 150.0, 176.0, 144.0, -34.0, 170.0, 112.0, 0.0, -196.0, 199.0, 191.0, 0.0, 77.0, 154.0, 69.0, -2.0, -18.0, 108.0, -96.0, 148.0, 164.0, 30.0, 0.0, 70.0, 125.0, 181.0, 157.0, -121.0, 78.0, -6.0, 0.0, 16.0, 174.0, 168.0, 88.0, -56.0, 172.0, -94.0, 185.0, 137.0, 157.0, 71.0, -6.0, 107.0, 164.0, -17.0, 89.0, 155.0, 146.0, 77.0, 97.0, 0.0, 150.0, 117.0, 98.0, 96.0, -38.0, 0.0, 164.0, 177.0, 172.0], "policy_predator_policy_reward": [41.0, 41.0, 0.0, 8.0, 32.0, 14.0, 0.0, 0.0, 6.0, 0.0, 26.0, 0.0, 28.0, 0.0, 20.0, 15.0, 53.0, 59.0, 9.0, 57.0, 0.0, 63.0, 85.0, 0.0, 0.0, 0.0, 24.0, 80.0, 20.0, 9.0, 68.0, 54.0, 0.0, 0.0, 46.0, 0.0, 31.0, 47.0, 29.0, 16.0, 73.0, 37.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 46.0, 5.0, 0.0, 0.0, 14.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 14.0, 76.0, 0.0, 0.0, 1.0, 58.0, 0.0, 0.0, 63.0, 67.0, 67.0, 0.0, 0.0, 88.0, 88.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 28.0, 0.0, 4.0, 1.0, 9.0, 0.0, 54.0, 0.0, 0.0, 14.0, 0.0, 79.0, 51.0, 0.0, 30.0, 9.0, 9.0, 16.0, 2.0, 35.0, 0.0, 0.0, 46.0, 45.0, 47.0, 41.0, 0.0, 0.0, 47.0, 51.0, 1.0, 3.0, 37.0, 19.0, 9.0, 0.0, 63.0, 47.0, 0.0, 17.0, 0.0, 42.0, 0.0, 16.0, 101.0, 48.0, 0.0, 23.0, 12.0, 0.0, 13.0, 17.0, 25.0, 0.0, 0.0, 132.0, 0.0, 0.0, 0.0, 36.0, 0.0, 0.0, 2.0, 9.0, 107.0, 0.0, 0.0, 13.0, 0.0, 91.0, 0.0, 41.0, 0.0, 0.0, 0.0, 105.0, 0.0, 3.0, 0.0, 0.0, 17.0, 5.0, 36.0, 64.0, 87.0, 93.0, 11.0, 0.0, 28.0, 0.0, 0.0, 24.0, 0.0, 71.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 6.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.237009768798936, "mean_inference_ms": 18.384535725424286, "mean_action_processing_ms": 0.8145774190940708, "mean_env_wait_ms": 3.0221336837322013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031769394874572754, "StateBufferConnector_ms": 0.010771512985229492, "ViewRequirementAgentConnector_ms": 0.22841274738311768}, "num_episodes": 22, "episode_return_max": 390.0, "episode_return_min": -64.0, "episode_return_mean": 207.73, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 202.72753658703397, "num_env_steps_trained_throughput_per_sec": 202.72753658703397, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 182183.167, "restore_workers_time_ms": 0.02, "training_step_time_ms": 182183.093, "sample_time_ms": 3832.345, "learn_time_ms": 178318.937, "learn_throughput": 22.432, "synch_weights_time_ms": 25.676}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 120, "trial_id": "45bed_00000", "date": "2024-08-13_03-37-05", "timestamp": 1723534625, "time_this_iter_s": 19.80681276321411, "time_total_s": 8807.179027557373, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44b4e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8807.179027557373, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 88.87142857142858, "ram_util_percent": 83.61428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7627421835900614, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6402642595389532, "policy_loss": -0.0006307569184591846, "vf_loss": 1.6408950225386039, "vf_explained_var": 0.004339948312315361, "kl": 0.0029513443360277593, "entropy": 0.17964037629977736, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 227745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.062308415313247, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.851889326711181, "policy_loss": 0.001731526163756532, "vf_loss": 6.850157799544157, "vf_explained_var": 0.24039108611288526, "kl": 0.005004095937324704, "entropy": 0.9591328235530349, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 227745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 1936000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": -64.0, "episode_reward_mean": 219.83, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -236.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 132.0}, "policy_reward_mean": {"prey_policy": 92.075, "predator_policy": 17.84}, "custom_metrics": {}, "hist_stats": {"episode_reward": [196.0, 155.0, 172.0, 339.0, 298.0, 215.0, 297.0, 165.0, 179.0, 331.0, 338.0, 158.0, 169.0, 218.0, 256.0, 337.0, -14.0, 88.0, 125.0, 68.0, 192.0, 157.0, 343.0, 205.0, 333.0, 317.0, 355.0, 173.0, 294.0, 182.0, 328.0, 232.0, 213.0, 89.0, 208.0, 233.0, 302.0, 193.0, 183.0, 324.0, 175.0, 323.0, 142.0, 373.0, 278.0, 353.0, 99.0, 328.0, 166.0, 134.0, 39.0, 213.0, 338.0, 140.0, 307.0, -64.0, 390.0, 113.0, 223.0, -9.0, 119.0, 325.0, 121.0, 236.0, 338.0, 62.0, -3.0, 190.0, 278.0, 216.0, 271.0, 305.0, 93.0, 295.0, 143.0, 301.0, 199.0, 150.0, 221.0, 85.0, 164.0, 352.0, 285.0, 73.0, 318.0, 172.0, 313.0, 195.0, 316.0, 263.0, 291.0, 274.0, 315.0, 170.0, 348.0, 310.0, 180.0, 236.0, 318.0, 138.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [24.0, 94.0, 168.0, -58.0, -20.0, 82.0, 175.0, 164.0, 124.0, 174.0, 134.0, 81.0, 152.0, 136.0, 163.0, 0.0, 179.0, 0.0, 157.0, 173.0, 159.0, 179.0, -2.0, 109.0, 0.0, 169.0, 112.0, 92.0, 107.0, 142.0, 181.0, 156.0, 0.0, -28.0, -6.0, 18.0, 124.0, 0.0, 0.0, 10.0, 14.0, 115.0, 133.0, -110.0, 167.0, 176.0, -145.0, 174.0, 160.0, 173.0, 143.0, 174.0, 187.0, 168.0, 175.0, -4.0, 129.0, 137.0, 185.0, -8.0, 155.0, 164.0, 20.0, 158.0, 163.0, 36.0, 102.0, -92.0, 17.0, 140.0, 49.0, 145.0, 168.0, 109.0, 49.0, 107.0, 183.0, 0.0, 61.0, 172.0, -33.0, 120.0, 132.0, 191.0, 44.0, 0.0, 185.0, 184.0, 86.0, 136.0, 153.0, 191.0, 29.0, -40.0, 195.0, 116.0, 24.0, 100.0, 150.0, -32.0, -236.0, 126.0, 169.0, 21.0, 150.0, 176.0, 144.0, -34.0, 170.0, 112.0, 0.0, -196.0, 199.0, 191.0, 0.0, 77.0, 154.0, 69.0, -2.0, -18.0, 108.0, -96.0, 148.0, 164.0, 30.0, 0.0, 70.0, 125.0, 181.0, 157.0, -121.0, 78.0, -6.0, 0.0, 16.0, 174.0, 168.0, 88.0, -56.0, 172.0, -94.0, 185.0, 137.0, 157.0, 71.0, -6.0, 107.0, 164.0, -17.0, 89.0, 155.0, 146.0, 77.0, 97.0, 0.0, 150.0, 117.0, 98.0, 96.0, -38.0, 0.0, 164.0, 177.0, 172.0, 157.0, 125.0, 81.0, -54.0, 112.0, 175.0, 80.0, 92.0, 136.0, 172.0, -55.0, 126.0, 144.0, 172.0, 58.0, 158.0, 99.0, 176.0, 129.0, 145.0, 152.0, 158.0, -50.0, 101.0, 184.0, 164.0, 159.0, 151.0, -20.0, 121.0, -14.0, 189.0, 160.0, 152.0, 176.0, -76.0], "policy_predator_policy_reward": [31.0, 47.0, 29.0, 16.0, 73.0, 37.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 46.0, 5.0, 0.0, 0.0, 14.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 14.0, 76.0, 0.0, 0.0, 1.0, 58.0, 0.0, 0.0, 63.0, 67.0, 67.0, 0.0, 0.0, 88.0, 88.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 28.0, 0.0, 4.0, 1.0, 9.0, 0.0, 54.0, 0.0, 0.0, 14.0, 0.0, 79.0, 51.0, 0.0, 30.0, 9.0, 9.0, 16.0, 2.0, 35.0, 0.0, 0.0, 46.0, 45.0, 47.0, 41.0, 0.0, 0.0, 47.0, 51.0, 1.0, 3.0, 37.0, 19.0, 9.0, 0.0, 63.0, 47.0, 0.0, 17.0, 0.0, 42.0, 0.0, 16.0, 101.0, 48.0, 0.0, 23.0, 12.0, 0.0, 13.0, 17.0, 25.0, 0.0, 0.0, 132.0, 0.0, 0.0, 0.0, 36.0, 0.0, 0.0, 2.0, 9.0, 107.0, 0.0, 0.0, 13.0, 0.0, 91.0, 0.0, 41.0, 0.0, 0.0, 0.0, 105.0, 0.0, 3.0, 0.0, 0.0, 17.0, 5.0, 36.0, 64.0, 87.0, 93.0, 11.0, 0.0, 28.0, 0.0, 0.0, 24.0, 0.0, 71.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 6.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 46.0, 22.0, 9.0, 0.0, 0.0, 5.0, 0.0, 50.0, 74.0, 0.0, 0.0, 40.0, 7.0, 0.0, 16.0, 0.0, 0.0, 5.0, 0.0, 39.0, 80.0, 0.0, 0.0, 0.0, 0.0, 15.0, 64.0, 61.0, 0.0, 2.0, 4.0, 0.0, 38.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.199997478422414, "mean_inference_ms": 18.4730539483131, "mean_action_processing_ms": 0.8119133473293756, "mean_env_wait_ms": 2.802068734442115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02992725372314453, "StateBufferConnector_ms": 0.01009821891784668, "ViewRequirementAgentConnector_ms": 0.20144975185394287}, "num_episodes": 18, "episode_return_max": 390.0, "episode_return_min": -64.0, "episode_return_mean": 219.83, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 1936000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.94057147367628, "num_env_steps_trained_throughput_per_sec": 3.94057147367628, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 1936000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1936000, "timers": {"training_iteration_time_ms": 280561.092, "restore_workers_time_ms": 0.02, "training_step_time_ms": 280561.018, "sample_time_ms": 3569.884, "learn_time_ms": 276952.902, "learn_throughput": 14.443, "synch_weights_time_ms": 31.734}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 1936000}, "done": false, "training_iteration": 121, "trial_id": "45bed_00000", "date": "2024-08-13_03-54-00", "timestamp": 1723535640, "time_this_iter_s": 1015.3111171722412, "time_total_s": 9822.490144729614, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44b40d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9822.490144729614, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 82.78461538461539, "ram_util_percent": 83.44615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4745691657460556, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3038885449606274, "policy_loss": -0.001965228054012177, "vf_loss": 1.3058537716903384, "vf_explained_var": 0.0026776513725361496, "kl": 0.004310033453958693, "entropy": 0.21888701053996565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 229635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.036202143519013, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.071023609524682, "policy_loss": -0.004545932575547821, "vf_loss": 8.0755695565037, "vf_explained_var": 0.3438674290028829, "kl": 0.013222860298724564, "entropy": 0.9982836335109024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 229635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": -64.0, "episode_reward_mean": 226.94, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -236.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 132.0}, "policy_reward_mean": {"prey_policy": 95.325, "predator_policy": 18.145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.0, 68.0, 192.0, 157.0, 343.0, 205.0, 333.0, 317.0, 355.0, 173.0, 294.0, 182.0, 328.0, 232.0, 213.0, 89.0, 208.0, 233.0, 302.0, 193.0, 183.0, 324.0, 175.0, 323.0, 142.0, 373.0, 278.0, 353.0, 99.0, 328.0, 166.0, 134.0, 39.0, 213.0, 338.0, 140.0, 307.0, -64.0, 390.0, 113.0, 223.0, -9.0, 119.0, 325.0, 121.0, 236.0, 338.0, 62.0, -3.0, 190.0, 278.0, 216.0, 271.0, 305.0, 93.0, 295.0, 143.0, 301.0, 199.0, 150.0, 221.0, 85.0, 164.0, 352.0, 285.0, 73.0, 318.0, 172.0, 313.0, 195.0, 316.0, 263.0, 291.0, 274.0, 315.0, 170.0, 348.0, 310.0, 180.0, 236.0, 318.0, 138.0, 147.0, 259.0, 306.0, 337.0, 294.0, 221.0, 349.0, 243.0, 267.0, 340.0, 134.0, 240.0, 332.0, 140.0, 169.0, 159.0, 351.0, 320.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [124.0, 0.0, 0.0, 10.0, 14.0, 115.0, 133.0, -110.0, 167.0, 176.0, -145.0, 174.0, 160.0, 173.0, 143.0, 174.0, 187.0, 168.0, 175.0, -4.0, 129.0, 137.0, 185.0, -8.0, 155.0, 164.0, 20.0, 158.0, 163.0, 36.0, 102.0, -92.0, 17.0, 140.0, 49.0, 145.0, 168.0, 109.0, 49.0, 107.0, 183.0, 0.0, 61.0, 172.0, -33.0, 120.0, 132.0, 191.0, 44.0, 0.0, 185.0, 184.0, 86.0, 136.0, 153.0, 191.0, 29.0, -40.0, 195.0, 116.0, 24.0, 100.0, 150.0, -32.0, -236.0, 126.0, 169.0, 21.0, 150.0, 176.0, 144.0, -34.0, 170.0, 112.0, 0.0, -196.0, 199.0, 191.0, 0.0, 77.0, 154.0, 69.0, -2.0, -18.0, 108.0, -96.0, 148.0, 164.0, 30.0, 0.0, 70.0, 125.0, 181.0, 157.0, -121.0, 78.0, -6.0, 0.0, 16.0, 174.0, 168.0, 88.0, -56.0, 172.0, -94.0, 185.0, 137.0, 157.0, 71.0, -6.0, 107.0, 164.0, -17.0, 89.0, 155.0, 146.0, 77.0, 97.0, 0.0, 150.0, 117.0, 98.0, 96.0, -38.0, 0.0, 164.0, 177.0, 172.0, 157.0, 125.0, 81.0, -54.0, 112.0, 175.0, 80.0, 92.0, 136.0, 172.0, -55.0, 126.0, 144.0, 172.0, 58.0, 158.0, 99.0, 176.0, 129.0, 145.0, 152.0, 158.0, -50.0, 101.0, 184.0, 164.0, 159.0, 151.0, -20.0, 121.0, -14.0, 189.0, 160.0, 152.0, 176.0, -76.0, -71.0, 108.0, 163.0, 80.0, 164.0, 142.0, 165.0, 172.0, 144.0, 115.0, 84.0, 132.0, 161.0, 188.0, 156.0, 82.0, 153.0, 97.0, 170.0, 170.0, -206.0, 146.0, 89.0, 137.0, 150.0, 176.0, 135.0, -61.0, 169.0, 0.0, 159.0, 0.0, 180.0, 171.0, 183.0, 137.0], "policy_predator_policy_reward": [0.0, 1.0, 58.0, 0.0, 0.0, 63.0, 67.0, 67.0, 0.0, 0.0, 88.0, 88.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 28.0, 0.0, 4.0, 1.0, 9.0, 0.0, 54.0, 0.0, 0.0, 14.0, 0.0, 79.0, 51.0, 0.0, 30.0, 9.0, 9.0, 16.0, 2.0, 35.0, 0.0, 0.0, 46.0, 45.0, 47.0, 41.0, 0.0, 0.0, 47.0, 51.0, 1.0, 3.0, 37.0, 19.0, 9.0, 0.0, 63.0, 47.0, 0.0, 17.0, 0.0, 42.0, 0.0, 16.0, 101.0, 48.0, 0.0, 23.0, 12.0, 0.0, 13.0, 17.0, 25.0, 0.0, 0.0, 132.0, 0.0, 0.0, 0.0, 36.0, 0.0, 0.0, 2.0, 9.0, 107.0, 0.0, 0.0, 13.0, 0.0, 91.0, 0.0, 41.0, 0.0, 0.0, 0.0, 105.0, 0.0, 3.0, 0.0, 0.0, 17.0, 5.0, 36.0, 64.0, 87.0, 93.0, 11.0, 0.0, 28.0, 0.0, 0.0, 24.0, 0.0, 71.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 6.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 46.0, 22.0, 9.0, 0.0, 0.0, 5.0, 0.0, 50.0, 74.0, 0.0, 0.0, 40.0, 7.0, 0.0, 16.0, 0.0, 0.0, 5.0, 0.0, 39.0, 80.0, 0.0, 0.0, 0.0, 0.0, 15.0, 64.0, 61.0, 0.0, 2.0, 4.0, 0.0, 38.0, 26.0, 84.0, 7.0, 9.0, 0.0, 0.0, 0.0, 0.0, 21.0, 14.0, 1.0, 4.0, 0.0, 0.0, 0.0, 5.0, 10.0, 7.0, 0.0, 0.0, 69.0, 125.0, 14.0, 0.0, 0.0, 6.0, 0.0, 66.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.162797904458905, "mean_inference_ms": 18.36350328641062, "mean_action_processing_ms": 0.8095553998716661, "mean_env_wait_ms": 2.7844757024147255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010399341583251953, "StateBufferConnector_ms": 0.006703376770019531, "ViewRequirementAgentConnector_ms": 0.23713815212249756}, "num_episodes": 18, "episode_return_max": 390.0, "episode_return_min": -64.0, "episode_return_mean": 226.94, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 144.4677569632571, "num_env_steps_trained_throughput_per_sec": 144.4677569632571, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 1952000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1952000, "timers": {"training_iteration_time_ms": 280308.325, "restore_workers_time_ms": 0.061, "training_step_time_ms": 280308.171, "sample_time_ms": 3682.303, "learn_time_ms": 276590.325, "learn_throughput": 14.462, "synch_weights_time_ms": 29.334}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000}, "done": false, "training_iteration": 122, "trial_id": "45bed_00000", "date": "2024-08-13_03-54-28", "timestamp": 1723535668, "time_this_iter_s": 27.751524686813354, "time_total_s": 9850.241669416428, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b52118b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9850.241669416428, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 93.04615384615386, "ram_util_percent": 82.16410256410256}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8112166059553307, "cur_kl_coeff": 5.684341886080802e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5460992814371823, "policy_loss": -0.0007473250949587771, "vf_loss": 2.546846612105294, "vf_explained_var": 0.0027004487930782257, "kl": 0.0016725587092143567, "entropy": 0.1984678738686458, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 231525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.783792169951887, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.958388903532079, "policy_loss": -0.004299348631193713, "vf_loss": 6.962688262878903, "vf_explained_var": 0.12149433313854156, "kl": 0.0069561491766334345, "entropy": 1.0110566455851155, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 231525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": -291.0, "episode_reward_mean": 213.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -330.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 172.0}, "policy_reward_mean": {"prey_policy": 85.595, "predator_policy": 21.185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [323.0, 142.0, 373.0, 278.0, 353.0, 99.0, 328.0, 166.0, 134.0, 39.0, 213.0, 338.0, 140.0, 307.0, -64.0, 390.0, 113.0, 223.0, -9.0, 119.0, 325.0, 121.0, 236.0, 338.0, 62.0, -3.0, 190.0, 278.0, 216.0, 271.0, 305.0, 93.0, 295.0, 143.0, 301.0, 199.0, 150.0, 221.0, 85.0, 164.0, 352.0, 285.0, 73.0, 318.0, 172.0, 313.0, 195.0, 316.0, 263.0, 291.0, 274.0, 315.0, 170.0, 348.0, 310.0, 180.0, 236.0, 318.0, 138.0, 147.0, 259.0, 306.0, 337.0, 294.0, 221.0, 349.0, 243.0, 267.0, 340.0, 134.0, 240.0, 332.0, 140.0, 169.0, 159.0, 351.0, 320.0, 276.0, 104.0, 266.0, 12.0, 225.0, -98.0, 118.0, -291.0, 263.0, 272.0, 317.0, 60.0, 372.0, 371.0, 310.0, 215.0, 265.0, 231.0, 65.0, 65.0, 140.0, 81.0, 247.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [132.0, 191.0, 44.0, 0.0, 185.0, 184.0, 86.0, 136.0, 153.0, 191.0, 29.0, -40.0, 195.0, 116.0, 24.0, 100.0, 150.0, -32.0, -236.0, 126.0, 169.0, 21.0, 150.0, 176.0, 144.0, -34.0, 170.0, 112.0, 0.0, -196.0, 199.0, 191.0, 0.0, 77.0, 154.0, 69.0, -2.0, -18.0, 108.0, -96.0, 148.0, 164.0, 30.0, 0.0, 70.0, 125.0, 181.0, 157.0, -121.0, 78.0, -6.0, 0.0, 16.0, 174.0, 168.0, 88.0, -56.0, 172.0, -94.0, 185.0, 137.0, 157.0, 71.0, -6.0, 107.0, 164.0, -17.0, 89.0, 155.0, 146.0, 77.0, 97.0, 0.0, 150.0, 117.0, 98.0, 96.0, -38.0, 0.0, 164.0, 177.0, 172.0, 157.0, 125.0, 81.0, -54.0, 112.0, 175.0, 80.0, 92.0, 136.0, 172.0, -55.0, 126.0, 144.0, 172.0, 58.0, 158.0, 99.0, 176.0, 129.0, 145.0, 152.0, 158.0, -50.0, 101.0, 184.0, 164.0, 159.0, 151.0, -20.0, 121.0, -14.0, 189.0, 160.0, 152.0, 176.0, -76.0, -71.0, 108.0, 163.0, 80.0, 164.0, 142.0, 165.0, 172.0, 144.0, 115.0, 84.0, 132.0, 161.0, 188.0, 156.0, 82.0, 153.0, 97.0, 170.0, 170.0, -206.0, 146.0, 89.0, 137.0, 150.0, 176.0, 135.0, -61.0, 169.0, 0.0, 159.0, 0.0, 180.0, 171.0, 183.0, 137.0, 133.0, 71.0, -111.0, 120.0, 62.0, 155.0, 170.0, -330.0, 69.0, 80.0, -225.0, 0.0, 89.0, 0.0, -226.0, -248.0, 169.0, 52.0, 93.0, 172.0, 136.0, 173.0, -68.0, 75.0, 172.0, 200.0, 181.0, 190.0, 159.0, 141.0, 124.0, -119.0, 17.0, 187.0, 86.0, 92.0, 53.0, 0.0, 113.0, -137.0, 168.0, -123.0, -150.0, 115.0, 69.0, 175.0], "policy_predator_policy_reward": [0.0, 0.0, 47.0, 51.0, 1.0, 3.0, 37.0, 19.0, 9.0, 0.0, 63.0, 47.0, 0.0, 17.0, 0.0, 42.0, 0.0, 16.0, 101.0, 48.0, 0.0, 23.0, 12.0, 0.0, 13.0, 17.0, 25.0, 0.0, 0.0, 132.0, 0.0, 0.0, 0.0, 36.0, 0.0, 0.0, 2.0, 9.0, 107.0, 0.0, 0.0, 13.0, 0.0, 91.0, 0.0, 41.0, 0.0, 0.0, 0.0, 105.0, 0.0, 3.0, 0.0, 0.0, 17.0, 5.0, 36.0, 64.0, 87.0, 93.0, 11.0, 0.0, 28.0, 0.0, 0.0, 24.0, 0.0, 71.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 6.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 46.0, 22.0, 9.0, 0.0, 0.0, 5.0, 0.0, 50.0, 74.0, 0.0, 0.0, 40.0, 7.0, 0.0, 16.0, 0.0, 0.0, 5.0, 0.0, 39.0, 80.0, 0.0, 0.0, 0.0, 0.0, 15.0, 64.0, 61.0, 0.0, 2.0, 4.0, 0.0, 38.0, 26.0, 84.0, 7.0, 9.0, 0.0, 0.0, 0.0, 0.0, 21.0, 14.0, 1.0, 4.0, 0.0, 0.0, 0.0, 5.0, 10.0, 7.0, 0.0, 0.0, 69.0, 125.0, 14.0, 0.0, 0.0, 6.0, 0.0, 66.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 39.0, 12.0, 83.0, 49.0, 0.0, 0.0, 172.0, 37.0, 39.0, 127.0, 0.0, 0.0, 29.0, 149.0, 34.0, 4.0, 38.0, 0.0, 7.0, 8.0, 0.0, 25.0, 28.0, 0.0, 0.0, 0.0, 0.0, 7.0, 3.0, 112.0, 98.0, 0.0, 61.0, 31.0, 22.0, 12.0, 0.0, 0.0, 89.0, 95.0, 0.0, 0.0, 116.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.505254414660419, "mean_inference_ms": 17.84419687380288, "mean_action_processing_ms": 0.8099410513881274, "mean_env_wait_ms": 2.7688918816798513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00781559944152832, "StateBufferConnector_ms": 0.007593870162963867, "ViewRequirementAgentConnector_ms": 0.2466442584991455}, "num_episodes": 23, "episode_return_max": 390.0, "episode_return_min": -291.0, "episode_return_mean": 213.56, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.67253950786596, "num_env_steps_trained_throughput_per_sec": 234.67253950786596, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 1968000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1968000, "timers": {"training_iteration_time_ms": 278794.835, "restore_workers_time_ms": 0.061, "training_step_time_ms": 278794.683, "sample_time_ms": 3551.939, "learn_time_ms": 275208.247, "learn_throughput": 14.534, "synch_weights_time_ms": 28.358}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "done": false, "training_iteration": 123, "trial_id": "45bed_00000", "date": "2024-08-13_03-54-45", "timestamp": 1723535685, "time_this_iter_s": 17.084274768829346, "time_total_s": 9867.325944185257, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44b3c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9867.325944185257, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 83.47500000000001, "ram_util_percent": 80.50833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.473641457570293, "cur_kl_coeff": 2.842170943040401e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5002367858848875, "policy_loss": -0.0012712401964962876, "vf_loss": 1.50150802911274, "vf_explained_var": 0.0007355113824208578, "kl": 0.004031826425302403, "entropy": 0.2179447236554648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 233415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.49970864196303, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.667890717743566, "policy_loss": -0.0025564055387226363, "vf_loss": 6.670447141405136, "vf_explained_var": 0.42037798752860417, "kl": 0.007550041222078226, "entropy": 1.0279164954783424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 233415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000}, "env_runners": {"episode_reward_max": 372.0, "episode_reward_min": -291.0, "episode_reward_mean": 220.99, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -330.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 172.0}, "policy_reward_mean": {"prey_policy": 90.455, "predator_policy": 20.04}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.0, 119.0, 325.0, 121.0, 236.0, 338.0, 62.0, -3.0, 190.0, 278.0, 216.0, 271.0, 305.0, 93.0, 295.0, 143.0, 301.0, 199.0, 150.0, 221.0, 85.0, 164.0, 352.0, 285.0, 73.0, 318.0, 172.0, 313.0, 195.0, 316.0, 263.0, 291.0, 274.0, 315.0, 170.0, 348.0, 310.0, 180.0, 236.0, 318.0, 138.0, 147.0, 259.0, 306.0, 337.0, 294.0, 221.0, 349.0, 243.0, 267.0, 340.0, 134.0, 240.0, 332.0, 140.0, 169.0, 159.0, 351.0, 320.0, 276.0, 104.0, 266.0, 12.0, 225.0, -98.0, 118.0, -291.0, 263.0, 272.0, 317.0, 60.0, 372.0, 371.0, 310.0, 215.0, 265.0, 231.0, 65.0, 65.0, 140.0, 81.0, 247.0, 256.0, 282.0, 314.0, 254.0, 240.0, 164.0, 178.0, 225.0, 214.0, 328.0, 71.0, 354.0, 329.0, 289.0, 172.0, 333.0, 326.0, 309.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, -18.0, 108.0, -96.0, 148.0, 164.0, 30.0, 0.0, 70.0, 125.0, 181.0, 157.0, -121.0, 78.0, -6.0, 0.0, 16.0, 174.0, 168.0, 88.0, -56.0, 172.0, -94.0, 185.0, 137.0, 157.0, 71.0, -6.0, 107.0, 164.0, -17.0, 89.0, 155.0, 146.0, 77.0, 97.0, 0.0, 150.0, 117.0, 98.0, 96.0, -38.0, 0.0, 164.0, 177.0, 172.0, 157.0, 125.0, 81.0, -54.0, 112.0, 175.0, 80.0, 92.0, 136.0, 172.0, -55.0, 126.0, 144.0, 172.0, 58.0, 158.0, 99.0, 176.0, 129.0, 145.0, 152.0, 158.0, -50.0, 101.0, 184.0, 164.0, 159.0, 151.0, -20.0, 121.0, -14.0, 189.0, 160.0, 152.0, 176.0, -76.0, -71.0, 108.0, 163.0, 80.0, 164.0, 142.0, 165.0, 172.0, 144.0, 115.0, 84.0, 132.0, 161.0, 188.0, 156.0, 82.0, 153.0, 97.0, 170.0, 170.0, -206.0, 146.0, 89.0, 137.0, 150.0, 176.0, 135.0, -61.0, 169.0, 0.0, 159.0, 0.0, 180.0, 171.0, 183.0, 137.0, 133.0, 71.0, -111.0, 120.0, 62.0, 155.0, 170.0, -330.0, 69.0, 80.0, -225.0, 0.0, 89.0, 0.0, -226.0, -248.0, 169.0, 52.0, 93.0, 172.0, 136.0, 173.0, -68.0, 75.0, 172.0, 200.0, 181.0, 190.0, 159.0, 141.0, 124.0, -119.0, 17.0, 187.0, 86.0, 92.0, 53.0, 0.0, 113.0, -137.0, 168.0, -123.0, -150.0, 115.0, 69.0, 175.0, 150.0, 104.0, 151.0, 97.0, 152.0, 133.0, 130.0, 79.0, -49.0, 182.0, 154.0, -65.0, 174.0, -89.0, 45.0, 180.0, 140.0, 3.0, 176.0, 152.0, 0.0, 71.0, 193.0, 161.0, 145.0, 184.0, 149.0, 138.0, 180.0, -22.0, 164.0, 160.0, 144.0, 163.0, 105.0, 174.0], "policy_predator_policy_reward": [2.0, 9.0, 107.0, 0.0, 0.0, 13.0, 0.0, 91.0, 0.0, 41.0, 0.0, 0.0, 0.0, 105.0, 0.0, 3.0, 0.0, 0.0, 17.0, 5.0, 36.0, 64.0, 87.0, 93.0, 11.0, 0.0, 28.0, 0.0, 0.0, 24.0, 0.0, 71.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 6.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 46.0, 22.0, 9.0, 0.0, 0.0, 5.0, 0.0, 50.0, 74.0, 0.0, 0.0, 40.0, 7.0, 0.0, 16.0, 0.0, 0.0, 5.0, 0.0, 39.0, 80.0, 0.0, 0.0, 0.0, 0.0, 15.0, 64.0, 61.0, 0.0, 2.0, 4.0, 0.0, 38.0, 26.0, 84.0, 7.0, 9.0, 0.0, 0.0, 0.0, 0.0, 21.0, 14.0, 1.0, 4.0, 0.0, 0.0, 0.0, 5.0, 10.0, 7.0, 0.0, 0.0, 69.0, 125.0, 14.0, 0.0, 0.0, 6.0, 0.0, 66.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 39.0, 12.0, 83.0, 49.0, 0.0, 0.0, 172.0, 37.0, 39.0, 127.0, 0.0, 0.0, 29.0, 149.0, 34.0, 4.0, 38.0, 0.0, 7.0, 8.0, 0.0, 25.0, 28.0, 0.0, 0.0, 0.0, 0.0, 7.0, 3.0, 112.0, 98.0, 0.0, 61.0, 31.0, 22.0, 12.0, 0.0, 0.0, 89.0, 95.0, 0.0, 0.0, 116.0, 0.0, 3.0, 0.0, 2.0, 26.0, 8.0, 29.0, 0.0, 11.0, 34.0, 49.0, 58.0, 4.0, 71.0, 0.0, 93.0, 0.0, 0.0, 9.0, 62.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 4.0, 0.0, 9.0, 7.0, 12.0, 14.0, 16.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.077944065450624, "mean_inference_ms": 18.13250804609597, "mean_action_processing_ms": 0.8047394693365649, "mean_env_wait_ms": 2.750032149219677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007928133010864258, "StateBufferConnector_ms": 0.007196664810180664, "ViewRequirementAgentConnector_ms": 0.2705698013305664}, "num_episodes": 18, "episode_return_max": 372.0, "episode_return_min": -291.0, "episode_return_mean": 220.99, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 250.74785477861238, "num_env_steps_trained_throughput_per_sec": 250.74785477861238, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 1984000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1984000, "timers": {"training_iteration_time_ms": 277177.977, "restore_workers_time_ms": 0.062, "training_step_time_ms": 277177.823, "sample_time_ms": 3384.26, "learn_time_ms": 273760.974, "learn_throughput": 14.611, "synch_weights_time_ms": 26.787}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000}, "done": false, "training_iteration": 124, "trial_id": "45bed_00000", "date": "2024-08-13_03-55-01", "timestamp": 1723535701, "time_this_iter_s": 16.007051944732666, "time_total_s": 9883.33299612999, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b521cb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9883.33299612999, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 80.2695652173913, "ram_util_percent": 79.85217391304349}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0874936771140526, "cur_kl_coeff": 1.4210854715202005e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.504384529306775, "policy_loss": -0.0015992007144386806, "vf_loss": 0.5059837297508099, "vf_explained_var": 0.0066147990958400505, "kl": 0.003773740304049698, "entropy": 0.1796497953947259, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 235305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.75690494845153, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.137823820618725, "policy_loss": -0.0017989407387123536, "vf_loss": 7.139622761963537, "vf_explained_var": 0.3299118952776389, "kl": 0.010129866986237752, "entropy": 1.137880110488367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 235305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "env_runners": {"episode_reward_max": 372.0, "episode_reward_min": -291.0, "episode_reward_mean": 238.38, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -330.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 172.0}, "policy_reward_mean": {"prey_policy": 100.31, "predator_policy": 18.88}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.0, 285.0, 73.0, 318.0, 172.0, 313.0, 195.0, 316.0, 263.0, 291.0, 274.0, 315.0, 170.0, 348.0, 310.0, 180.0, 236.0, 318.0, 138.0, 147.0, 259.0, 306.0, 337.0, 294.0, 221.0, 349.0, 243.0, 267.0, 340.0, 134.0, 240.0, 332.0, 140.0, 169.0, 159.0, 351.0, 320.0, 276.0, 104.0, 266.0, 12.0, 225.0, -98.0, 118.0, -291.0, 263.0, 272.0, 317.0, 60.0, 372.0, 371.0, 310.0, 215.0, 265.0, 231.0, 65.0, 65.0, 140.0, 81.0, 247.0, 256.0, 282.0, 314.0, 254.0, 240.0, 164.0, 178.0, 225.0, 214.0, 328.0, 71.0, 354.0, 329.0, 289.0, 172.0, 333.0, 326.0, 309.0, 183.0, 316.0, 153.0, 331.0, 274.0, 107.0, 310.0, 299.0, 312.0, 186.0, 334.0, 339.0, 301.0, 294.0, 262.0, 347.0, 147.0, 310.0, 192.0, 245.0, 333.0, 264.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [177.0, 172.0, 157.0, 125.0, 81.0, -54.0, 112.0, 175.0, 80.0, 92.0, 136.0, 172.0, -55.0, 126.0, 144.0, 172.0, 58.0, 158.0, 99.0, 176.0, 129.0, 145.0, 152.0, 158.0, -50.0, 101.0, 184.0, 164.0, 159.0, 151.0, -20.0, 121.0, -14.0, 189.0, 160.0, 152.0, 176.0, -76.0, -71.0, 108.0, 163.0, 80.0, 164.0, 142.0, 165.0, 172.0, 144.0, 115.0, 84.0, 132.0, 161.0, 188.0, 156.0, 82.0, 153.0, 97.0, 170.0, 170.0, -206.0, 146.0, 89.0, 137.0, 150.0, 176.0, 135.0, -61.0, 169.0, 0.0, 159.0, 0.0, 180.0, 171.0, 183.0, 137.0, 133.0, 71.0, -111.0, 120.0, 62.0, 155.0, 170.0, -330.0, 69.0, 80.0, -225.0, 0.0, 89.0, 0.0, -226.0, -248.0, 169.0, 52.0, 93.0, 172.0, 136.0, 173.0, -68.0, 75.0, 172.0, 200.0, 181.0, 190.0, 159.0, 141.0, 124.0, -119.0, 17.0, 187.0, 86.0, 92.0, 53.0, 0.0, 113.0, -137.0, 168.0, -123.0, -150.0, 115.0, 69.0, 175.0, 150.0, 104.0, 151.0, 97.0, 152.0, 133.0, 130.0, 79.0, -49.0, 182.0, 154.0, -65.0, 174.0, -89.0, 45.0, 180.0, 140.0, 3.0, 176.0, 152.0, 0.0, 71.0, 193.0, 161.0, 145.0, 184.0, 149.0, 138.0, 180.0, -22.0, 164.0, 160.0, 144.0, 163.0, 105.0, 174.0, 163.0, -141.0, 170.0, 146.0, 0.0, 148.0, 180.0, 141.0, 107.0, 167.0, 0.0, 107.0, 156.0, 146.0, 168.0, 125.0, 164.0, 140.0, 95.0, -49.0, 146.0, 188.0, 166.0, 167.0, 169.0, 104.0, 125.0, 157.0, 47.0, 169.0, 174.0, 173.0, 123.0, -41.0, 167.0, 143.0, -26.0, 152.0, 58.0, 130.0, 148.0, 172.0, 82.0, 180.0], "policy_predator_policy_reward": [0.0, 3.0, 3.0, 0.0, 0.0, 46.0, 22.0, 9.0, 0.0, 0.0, 5.0, 0.0, 50.0, 74.0, 0.0, 0.0, 40.0, 7.0, 0.0, 16.0, 0.0, 0.0, 5.0, 0.0, 39.0, 80.0, 0.0, 0.0, 0.0, 0.0, 15.0, 64.0, 61.0, 0.0, 2.0, 4.0, 0.0, 38.0, 26.0, 84.0, 7.0, 9.0, 0.0, 0.0, 0.0, 0.0, 21.0, 14.0, 1.0, 4.0, 0.0, 0.0, 0.0, 5.0, 10.0, 7.0, 0.0, 0.0, 69.0, 125.0, 14.0, 0.0, 0.0, 6.0, 0.0, 66.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 39.0, 12.0, 83.0, 49.0, 0.0, 0.0, 172.0, 37.0, 39.0, 127.0, 0.0, 0.0, 29.0, 149.0, 34.0, 4.0, 38.0, 0.0, 7.0, 8.0, 0.0, 25.0, 28.0, 0.0, 0.0, 0.0, 0.0, 7.0, 3.0, 112.0, 98.0, 0.0, 61.0, 31.0, 22.0, 12.0, 0.0, 0.0, 89.0, 95.0, 0.0, 0.0, 116.0, 0.0, 3.0, 0.0, 2.0, 26.0, 8.0, 29.0, 0.0, 11.0, 34.0, 49.0, 58.0, 4.0, 71.0, 0.0, 93.0, 0.0, 0.0, 9.0, 62.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 4.0, 0.0, 9.0, 7.0, 12.0, 14.0, 16.0, 95.0, 66.0, 0.0, 0.0, 0.0, 5.0, 2.0, 8.0, 0.0, 0.0, 0.0, 0.0, 7.0, 1.0, 6.0, 0.0, 0.0, 8.0, 70.0, 70.0, 0.0, 0.0, 0.0, 6.0, 12.0, 16.0, 0.0, 12.0, 46.0, 0.0, 0.0, 0.0, 65.0, 0.0, 0.0, 0.0, 3.0, 63.0, 38.0, 19.0, 0.0, 13.0, 2.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.042102996339749, "mean_inference_ms": 18.00381686871067, "mean_action_processing_ms": 0.8021826146808144, "mean_env_wait_ms": 2.7252483768414937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005898237228393555, "StateBufferConnector_ms": 0.004820466041564941, "ViewRequirementAgentConnector_ms": 0.25937914848327637}, "num_episodes": 22, "episode_return_max": 372.0, "episode_return_min": -291.0, "episode_return_mean": 238.38, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.1425356329034, "num_env_steps_trained_throughput_per_sec": 234.1425356329034, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 2000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2000000, "timers": {"training_iteration_time_ms": 275339.488, "restore_workers_time_ms": 0.061, "training_step_time_ms": 275339.338, "sample_time_ms": 3217.027, "learn_time_ms": 272089.328, "learn_throughput": 14.701, "synch_weights_time_ms": 27.524}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "done": false, "training_iteration": 125, "trial_id": "45bed_00000", "date": "2024-08-13_03-55-19", "timestamp": 1723535719, "time_this_iter_s": 17.156261205673218, "time_total_s": 9900.489257335663, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b527f790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9900.489257335663, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 80.91250000000001, "ram_util_percent": 79.97083333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6547465971143788, "cur_kl_coeff": 7.105427357601002e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2231752825161768, "policy_loss": -0.0003631793391255159, "vf_loss": 1.2235384609333422, "vf_explained_var": 0.002816067454676149, "kl": 0.001650364742609471, "entropy": 0.18012076516946157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 237195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.765373976047707, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.830805868320364, "policy_loss": 0.004623160433891432, "vf_loss": 6.826182705006271, "vf_explained_var": -0.0017161696045487015, "kl": 0.014463493924492138, "entropy": 1.1789007801858207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 237195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "env_runners": {"episode_reward_max": 372.0, "episode_reward_min": -291.0, "episode_reward_mean": 235.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -330.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 172.0}, "policy_reward_mean": {"prey_policy": 98.41, "predator_policy": 19.11}, "custom_metrics": {}, "hist_stats": {"episode_reward": [138.0, 147.0, 259.0, 306.0, 337.0, 294.0, 221.0, 349.0, 243.0, 267.0, 340.0, 134.0, 240.0, 332.0, 140.0, 169.0, 159.0, 351.0, 320.0, 276.0, 104.0, 266.0, 12.0, 225.0, -98.0, 118.0, -291.0, 263.0, 272.0, 317.0, 60.0, 372.0, 371.0, 310.0, 215.0, 265.0, 231.0, 65.0, 65.0, 140.0, 81.0, 247.0, 256.0, 282.0, 314.0, 254.0, 240.0, 164.0, 178.0, 225.0, 214.0, 328.0, 71.0, 354.0, 329.0, 289.0, 172.0, 333.0, 326.0, 309.0, 183.0, 316.0, 153.0, 331.0, 274.0, 107.0, 310.0, 299.0, 312.0, 186.0, 334.0, 339.0, 301.0, 294.0, 262.0, 347.0, 147.0, 310.0, 192.0, 245.0, 333.0, 264.0, 343.0, 356.0, 267.0, 261.0, 174.0, 301.0, 144.0, 249.0, 124.0, 142.0, 189.0, 325.0, 308.0, 261.0, 245.0, 237.0, 217.0, 252.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [176.0, -76.0, -71.0, 108.0, 163.0, 80.0, 164.0, 142.0, 165.0, 172.0, 144.0, 115.0, 84.0, 132.0, 161.0, 188.0, 156.0, 82.0, 153.0, 97.0, 170.0, 170.0, -206.0, 146.0, 89.0, 137.0, 150.0, 176.0, 135.0, -61.0, 169.0, 0.0, 159.0, 0.0, 180.0, 171.0, 183.0, 137.0, 133.0, 71.0, -111.0, 120.0, 62.0, 155.0, 170.0, -330.0, 69.0, 80.0, -225.0, 0.0, 89.0, 0.0, -226.0, -248.0, 169.0, 52.0, 93.0, 172.0, 136.0, 173.0, -68.0, 75.0, 172.0, 200.0, 181.0, 190.0, 159.0, 141.0, 124.0, -119.0, 17.0, 187.0, 86.0, 92.0, 53.0, 0.0, 113.0, -137.0, 168.0, -123.0, -150.0, 115.0, 69.0, 175.0, 150.0, 104.0, 151.0, 97.0, 152.0, 133.0, 130.0, 79.0, -49.0, 182.0, 154.0, -65.0, 174.0, -89.0, 45.0, 180.0, 140.0, 3.0, 176.0, 152.0, 0.0, 71.0, 193.0, 161.0, 145.0, 184.0, 149.0, 138.0, 180.0, -22.0, 164.0, 160.0, 144.0, 163.0, 105.0, 174.0, 163.0, -141.0, 170.0, 146.0, 0.0, 148.0, 180.0, 141.0, 107.0, 167.0, 0.0, 107.0, 156.0, 146.0, 168.0, 125.0, 164.0, 140.0, 95.0, -49.0, 146.0, 188.0, 166.0, 167.0, 169.0, 104.0, 125.0, 157.0, 47.0, 169.0, 174.0, 173.0, 123.0, -41.0, 167.0, 143.0, -26.0, 152.0, 58.0, 130.0, 148.0, 172.0, 82.0, 180.0, 178.0, 165.0, 192.0, 164.0, 140.0, 127.0, 150.0, 74.0, 167.0, -51.0, 167.0, 131.0, -136.0, 172.0, -136.0, 177.0, 17.0, 52.0, 66.0, 71.0, 82.0, 93.0, 153.0, 164.0, 151.0, 149.0, 132.0, 106.0, 81.0, 164.0, 33.0, 178.0, 42.0, 163.0, 58.0, 168.0], "policy_predator_policy_reward": [0.0, 38.0, 26.0, 84.0, 7.0, 9.0, 0.0, 0.0, 0.0, 0.0, 21.0, 14.0, 1.0, 4.0, 0.0, 0.0, 0.0, 5.0, 10.0, 7.0, 0.0, 0.0, 69.0, 125.0, 14.0, 0.0, 0.0, 6.0, 0.0, 66.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 39.0, 12.0, 83.0, 49.0, 0.0, 0.0, 172.0, 37.0, 39.0, 127.0, 0.0, 0.0, 29.0, 149.0, 34.0, 4.0, 38.0, 0.0, 7.0, 8.0, 0.0, 25.0, 28.0, 0.0, 0.0, 0.0, 0.0, 7.0, 3.0, 112.0, 98.0, 0.0, 61.0, 31.0, 22.0, 12.0, 0.0, 0.0, 89.0, 95.0, 0.0, 0.0, 116.0, 0.0, 3.0, 0.0, 2.0, 26.0, 8.0, 29.0, 0.0, 11.0, 34.0, 49.0, 58.0, 4.0, 71.0, 0.0, 93.0, 0.0, 0.0, 9.0, 62.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 4.0, 0.0, 9.0, 7.0, 12.0, 14.0, 16.0, 95.0, 66.0, 0.0, 0.0, 0.0, 5.0, 2.0, 8.0, 0.0, 0.0, 0.0, 0.0, 7.0, 1.0, 6.0, 0.0, 0.0, 8.0, 70.0, 70.0, 0.0, 0.0, 0.0, 6.0, 12.0, 16.0, 0.0, 12.0, 46.0, 0.0, 0.0, 0.0, 65.0, 0.0, 0.0, 0.0, 3.0, 63.0, 38.0, 19.0, 0.0, 13.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 36.0, 1.0, 58.0, 0.0, 3.0, 0.0, 108.0, 0.0, 106.0, 102.0, 55.0, 0.0, 0.0, 5.0, 0.0, 14.0, 0.0, 8.0, 0.0, 8.0, 14.0, 9.0, 0.0, 0.0, 0.0, 26.0, 5.0, 7.0, 13.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.008793134344716, "mean_inference_ms": 17.90402070943883, "mean_action_processing_ms": 0.8003158678739676, "mean_env_wait_ms": 2.7089856741398846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005917549133300781, "StateBufferConnector_ms": 0.004845380783081055, "ViewRequirementAgentConnector_ms": 0.2862522602081299}, "num_episodes": 18, "episode_return_max": 372.0, "episode_return_min": -291.0, "episode_return_mean": 235.04, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.157912338978749, "num_env_steps_trained_throughput_per_sec": 4.157912338978749, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 2016000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2016000, "timers": {"training_iteration_time_ms": 368281.218, "restore_workers_time_ms": 0.061, "training_step_time_ms": 368281.071, "sample_time_ms": 3101.081, "learn_time_ms": 365145.595, "learn_throughput": 10.955, "synch_weights_time_ms": 29.665}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "done": false, "training_iteration": 126, "trial_id": "45bed_00000", "date": "2024-08-13_04-11-21", "timestamp": 1723536681, "time_this_iter_s": 962.1930317878723, "time_total_s": 10862.682289123535, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b527fa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10862.682289123535, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 89.02222222222223, "ram_util_percent": 82.92777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2629004821536087, "cur_kl_coeff": 3.552713678800501e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4225400216049617, "policy_loss": -0.0020881536948893754, "vf_loss": 1.4246281720658458, "vf_explained_var": 0.00021060673648087437, "kl": 0.0025054751006732415, "entropy": 0.15320669175692336, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 239085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.635415435830753, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.798955616623005, "policy_loss": 0.00407824806989757, "vf_loss": 7.794877359602187, "vf_explained_var": 0.09517056702306032, "kl": 0.0066801076290910165, "entropy": 1.1880170005339163, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 239085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 2032000}, "env_runners": {"episode_reward_max": 372.0, "episode_reward_min": -291.0, "episode_reward_mean": 237.93, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -330.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 172.0}, "policy_reward_mean": {"prey_policy": 100.015, "predator_policy": 18.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [320.0, 276.0, 104.0, 266.0, 12.0, 225.0, -98.0, 118.0, -291.0, 263.0, 272.0, 317.0, 60.0, 372.0, 371.0, 310.0, 215.0, 265.0, 231.0, 65.0, 65.0, 140.0, 81.0, 247.0, 256.0, 282.0, 314.0, 254.0, 240.0, 164.0, 178.0, 225.0, 214.0, 328.0, 71.0, 354.0, 329.0, 289.0, 172.0, 333.0, 326.0, 309.0, 183.0, 316.0, 153.0, 331.0, 274.0, 107.0, 310.0, 299.0, 312.0, 186.0, 334.0, 339.0, 301.0, 294.0, 262.0, 347.0, 147.0, 310.0, 192.0, 245.0, 333.0, 264.0, 343.0, 356.0, 267.0, 261.0, 174.0, 301.0, 144.0, 249.0, 124.0, 142.0, 189.0, 325.0, 308.0, 261.0, 245.0, 237.0, 217.0, 252.0, 280.0, 270.0, 319.0, 242.0, 272.0, 214.0, 250.0, 264.0, 263.0, 308.0, 248.0, 208.0, 264.0, 250.0, 232.0, 163.0, 350.0, 318.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [183.0, 137.0, 133.0, 71.0, -111.0, 120.0, 62.0, 155.0, 170.0, -330.0, 69.0, 80.0, -225.0, 0.0, 89.0, 0.0, -226.0, -248.0, 169.0, 52.0, 93.0, 172.0, 136.0, 173.0, -68.0, 75.0, 172.0, 200.0, 181.0, 190.0, 159.0, 141.0, 124.0, -119.0, 17.0, 187.0, 86.0, 92.0, 53.0, 0.0, 113.0, -137.0, 168.0, -123.0, -150.0, 115.0, 69.0, 175.0, 150.0, 104.0, 151.0, 97.0, 152.0, 133.0, 130.0, 79.0, -49.0, 182.0, 154.0, -65.0, 174.0, -89.0, 45.0, 180.0, 140.0, 3.0, 176.0, 152.0, 0.0, 71.0, 193.0, 161.0, 145.0, 184.0, 149.0, 138.0, 180.0, -22.0, 164.0, 160.0, 144.0, 163.0, 105.0, 174.0, 163.0, -141.0, 170.0, 146.0, 0.0, 148.0, 180.0, 141.0, 107.0, 167.0, 0.0, 107.0, 156.0, 146.0, 168.0, 125.0, 164.0, 140.0, 95.0, -49.0, 146.0, 188.0, 166.0, 167.0, 169.0, 104.0, 125.0, 157.0, 47.0, 169.0, 174.0, 173.0, 123.0, -41.0, 167.0, 143.0, -26.0, 152.0, 58.0, 130.0, 148.0, 172.0, 82.0, 180.0, 178.0, 165.0, 192.0, 164.0, 140.0, 127.0, 150.0, 74.0, 167.0, -51.0, 167.0, 131.0, -136.0, 172.0, -136.0, 177.0, 17.0, 52.0, 66.0, 71.0, 82.0, 93.0, 153.0, 164.0, 151.0, 149.0, 132.0, 106.0, 81.0, 164.0, 33.0, 178.0, 42.0, 163.0, 58.0, 168.0, 130.0, 137.0, 151.0, 42.0, 140.0, 179.0, 82.0, 160.0, 105.0, 135.0, 27.0, 145.0, 150.0, 78.0, 106.0, 150.0, 162.0, 50.0, 153.0, 136.0, 135.0, 113.0, 18.0, 150.0, 88.0, 132.0, 101.0, 149.0, 158.0, 24.0, 160.0, -73.0, 181.0, 169.0, 159.0, 159.0], "policy_predator_policy_reward": [0.0, 0.0, 33.0, 39.0, 12.0, 83.0, 49.0, 0.0, 0.0, 172.0, 37.0, 39.0, 127.0, 0.0, 0.0, 29.0, 149.0, 34.0, 4.0, 38.0, 0.0, 7.0, 8.0, 0.0, 25.0, 28.0, 0.0, 0.0, 0.0, 0.0, 7.0, 3.0, 112.0, 98.0, 0.0, 61.0, 31.0, 22.0, 12.0, 0.0, 0.0, 89.0, 95.0, 0.0, 0.0, 116.0, 0.0, 3.0, 0.0, 2.0, 26.0, 8.0, 29.0, 0.0, 11.0, 34.0, 49.0, 58.0, 4.0, 71.0, 0.0, 93.0, 0.0, 0.0, 9.0, 62.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 4.0, 0.0, 9.0, 7.0, 12.0, 14.0, 16.0, 95.0, 66.0, 0.0, 0.0, 0.0, 5.0, 2.0, 8.0, 0.0, 0.0, 0.0, 0.0, 7.0, 1.0, 6.0, 0.0, 0.0, 8.0, 70.0, 70.0, 0.0, 0.0, 0.0, 6.0, 12.0, 16.0, 0.0, 12.0, 46.0, 0.0, 0.0, 0.0, 65.0, 0.0, 0.0, 0.0, 3.0, 63.0, 38.0, 19.0, 0.0, 13.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 36.0, 1.0, 58.0, 0.0, 3.0, 0.0, 108.0, 0.0, 106.0, 102.0, 55.0, 0.0, 0.0, 5.0, 0.0, 14.0, 0.0, 8.0, 0.0, 8.0, 14.0, 9.0, 0.0, 0.0, 0.0, 26.0, 5.0, 7.0, 13.0, 13.0, 13.0, 0.0, 36.0, 41.0, 0.0, 0.0, 0.0, 0.0, 12.0, 20.0, 36.0, 6.0, 0.0, 22.0, 8.0, 0.0, 15.0, 36.0, 9.0, 10.0, 0.0, 0.0, 13.0, 27.0, 22.0, 22.0, 0.0, 0.0, 0.0, 50.0, 76.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.97479764568689, "mean_inference_ms": 17.80130342671544, "mean_action_processing_ms": 0.798094065804186, "mean_env_wait_ms": 2.6925059753883676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004780292510986328, "StateBufferConnector_ms": 0.006898164749145508, "ViewRequirementAgentConnector_ms": 0.2359635829925537}, "num_episodes": 18, "episode_return_max": 372.0, "episode_return_min": -291.0, "episode_return_mean": 237.93, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 2032000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.282528654385249, "num_env_steps_trained_throughput_per_sec": 4.282528654385249, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 2032000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2032000, "timers": {"training_iteration_time_ms": 400848.306, "restore_workers_time_ms": 0.081, "training_step_time_ms": 400848.134, "sample_time_ms": 2897.367, "learn_time_ms": 397911.47, "learn_throughput": 10.052, "synch_weights_time_ms": 32.872}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 2032000}, "done": false, "training_iteration": 127, "trial_id": "45bed_00000", "date": "2024-08-13_04-26-56", "timestamp": 1723537616, "time_this_iter_s": 934.5568656921387, "time_total_s": 11797.239154815674, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33071c700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11797.239154815674, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 87.88181818181818, "ram_util_percent": 85.46136363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6537714003018602, "cur_kl_coeff": 1.7763568394002506e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6822970717672319, "policy_loss": -0.0024361293602774225, "vf_loss": 1.684733197613368, "vf_explained_var": -0.00047238585810181955, "kl": 0.002779614618869873, "entropy": 0.11824321592492716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 240975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.76701114445767, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.317059536081143, "policy_loss": -0.007409397909964715, "vf_loss": 8.324468935860528, "vf_explained_var": 0.3315051943852157, "kl": 0.017220314258278264, "entropy": 1.2558341155607233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 240975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000}, "env_runners": {"episode_reward_max": 356.0, "episode_reward_min": 47.0, "episode_reward_mean": 243.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -141.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 108.0}, "policy_reward_mean": {"prey_policy": 106.13, "predator_policy": 15.63}, "custom_metrics": {}, "hist_stats": {"episode_reward": [247.0, 256.0, 282.0, 314.0, 254.0, 240.0, 164.0, 178.0, 225.0, 214.0, 328.0, 71.0, 354.0, 329.0, 289.0, 172.0, 333.0, 326.0, 309.0, 183.0, 316.0, 153.0, 331.0, 274.0, 107.0, 310.0, 299.0, 312.0, 186.0, 334.0, 339.0, 301.0, 294.0, 262.0, 347.0, 147.0, 310.0, 192.0, 245.0, 333.0, 264.0, 343.0, 356.0, 267.0, 261.0, 174.0, 301.0, 144.0, 249.0, 124.0, 142.0, 189.0, 325.0, 308.0, 261.0, 245.0, 237.0, 217.0, 252.0, 280.0, 270.0, 319.0, 242.0, 272.0, 214.0, 250.0, 264.0, 263.0, 308.0, 248.0, 208.0, 264.0, 250.0, 232.0, 163.0, 350.0, 318.0, 278.0, 242.0, 256.0, 203.0, 210.0, 210.0, 143.0, 236.0, 205.0, 171.0, 47.0, 249.0, 185.0, 96.0, 70.0, 252.0, 293.0, 240.0, 130.0, 217.0, 242.0, 128.0, 215.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [69.0, 175.0, 150.0, 104.0, 151.0, 97.0, 152.0, 133.0, 130.0, 79.0, -49.0, 182.0, 154.0, -65.0, 174.0, -89.0, 45.0, 180.0, 140.0, 3.0, 176.0, 152.0, 0.0, 71.0, 193.0, 161.0, 145.0, 184.0, 149.0, 138.0, 180.0, -22.0, 164.0, 160.0, 144.0, 163.0, 105.0, 174.0, 163.0, -141.0, 170.0, 146.0, 0.0, 148.0, 180.0, 141.0, 107.0, 167.0, 0.0, 107.0, 156.0, 146.0, 168.0, 125.0, 164.0, 140.0, 95.0, -49.0, 146.0, 188.0, 166.0, 167.0, 169.0, 104.0, 125.0, 157.0, 47.0, 169.0, 174.0, 173.0, 123.0, -41.0, 167.0, 143.0, -26.0, 152.0, 58.0, 130.0, 148.0, 172.0, 82.0, 180.0, 178.0, 165.0, 192.0, 164.0, 140.0, 127.0, 150.0, 74.0, 167.0, -51.0, 167.0, 131.0, -136.0, 172.0, -136.0, 177.0, 17.0, 52.0, 66.0, 71.0, 82.0, 93.0, 153.0, 164.0, 151.0, 149.0, 132.0, 106.0, 81.0, 164.0, 33.0, 178.0, 42.0, 163.0, 58.0, 168.0, 130.0, 137.0, 151.0, 42.0, 140.0, 179.0, 82.0, 160.0, 105.0, 135.0, 27.0, 145.0, 150.0, 78.0, 106.0, 150.0, 162.0, 50.0, 153.0, 136.0, 135.0, 113.0, 18.0, 150.0, 88.0, 132.0, 101.0, 149.0, 158.0, 24.0, 160.0, -73.0, 181.0, 169.0, 159.0, 159.0, 148.0, 130.0, 77.0, 132.0, 130.0, 126.0, 134.0, 69.0, 130.0, 47.0, 18.0, 110.0, 133.0, -72.0, 146.0, 90.0, 163.0, -31.0, 0.0, 171.0, -59.0, -29.0, 164.0, 79.0, 143.0, 32.0, 50.0, -6.0, 114.0, -128.0, 144.0, 6.0, 159.0, 134.0, 102.0, 123.0, 131.0, -94.0, 92.0, 125.0, 103.0, 139.0, -46.0, 143.0, 11.0, 140.0], "policy_predator_policy_reward": [0.0, 3.0, 0.0, 2.0, 26.0, 8.0, 29.0, 0.0, 11.0, 34.0, 49.0, 58.0, 4.0, 71.0, 0.0, 93.0, 0.0, 0.0, 9.0, 62.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 4.0, 0.0, 9.0, 7.0, 12.0, 14.0, 16.0, 95.0, 66.0, 0.0, 0.0, 0.0, 5.0, 2.0, 8.0, 0.0, 0.0, 0.0, 0.0, 7.0, 1.0, 6.0, 0.0, 0.0, 8.0, 70.0, 70.0, 0.0, 0.0, 0.0, 6.0, 12.0, 16.0, 0.0, 12.0, 46.0, 0.0, 0.0, 0.0, 65.0, 0.0, 0.0, 0.0, 3.0, 63.0, 38.0, 19.0, 0.0, 13.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 36.0, 1.0, 58.0, 0.0, 3.0, 0.0, 108.0, 0.0, 106.0, 102.0, 55.0, 0.0, 0.0, 5.0, 0.0, 14.0, 0.0, 8.0, 0.0, 8.0, 14.0, 9.0, 0.0, 0.0, 0.0, 26.0, 5.0, 7.0, 13.0, 13.0, 13.0, 0.0, 36.0, 41.0, 0.0, 0.0, 0.0, 0.0, 12.0, 20.0, 36.0, 6.0, 0.0, 22.0, 8.0, 0.0, 15.0, 36.0, 9.0, 10.0, 0.0, 0.0, 13.0, 27.0, 22.0, 22.0, 0.0, 0.0, 0.0, 50.0, 76.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 42.0, 40.0, 5.0, 77.0, 0.0, 0.0, 5.0, 68.0, 0.0, 0.0, 54.0, 81.0, 0.0, 6.0, 10.0, 0.0, 39.0, 13.0, 84.0, 0.0, 50.0, 52.0, 0.0, 0.0, 13.0, 2.0, 0.0, 93.0, 0.0, 0.0, 0.0, 0.0, 9.0, 22.0, 30.0, 34.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.929673216198353, "mean_inference_ms": 17.689425905829648, "mean_action_processing_ms": 0.7974449173807979, "mean_env_wait_ms": 2.678248144325721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006088852882385254, "StateBufferConnector_ms": 0.007629752159118652, "ViewRequirementAgentConnector_ms": 0.362363338470459}, "num_episodes": 23, "episode_return_max": 356.0, "episode_return_min": 47.0, "episode_return_mean": 243.52, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 164.32972021885885, "num_env_steps_trained_throughput_per_sec": 164.32972021885885, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 2048000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2048000, "timers": {"training_iteration_time_ms": 401602.266, "restore_workers_time_ms": 0.093, "training_step_time_ms": 401602.078, "sample_time_ms": 3580.105, "learn_time_ms": 397981.144, "learn_throughput": 10.051, "synch_weights_time_ms": 34.534}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000}, "done": false, "training_iteration": 128, "trial_id": "45bed_00000", "date": "2024-08-13_04-27-20", "timestamp": 1723537640, "time_this_iter_s": 24.433021068572998, "time_total_s": 11821.672175884247, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b527f550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11821.672175884247, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 86.31764705882354, "ram_util_percent": 83.78529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7640460968806, "cur_kl_coeff": 8.881784197001253e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4431445353245609, "policy_loss": -0.0009305252745333645, "vf_loss": 1.4440750583454414, "vf_explained_var": 0.006266128070770748, "kl": 0.0011223848075616913, "entropy": 0.12612034926614749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 242865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.72445337655683, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.745369078873327, "policy_loss": 0.001666234672641155, "vf_loss": 7.7437028468601286, "vf_explained_var": 0.5442163330221933, "kl": 0.010952531343143342, "entropy": 1.2779902849247846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 242865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "env_runners": {"episode_reward_max": 356.0, "episode_reward_min": 47.0, "episode_reward_mean": 231.5, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -136.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 192.0, "predator_policy": 108.0}, "policy_reward_mean": {"prey_policy": 100.395, "predator_policy": 15.355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [331.0, 274.0, 107.0, 310.0, 299.0, 312.0, 186.0, 334.0, 339.0, 301.0, 294.0, 262.0, 347.0, 147.0, 310.0, 192.0, 245.0, 333.0, 264.0, 343.0, 356.0, 267.0, 261.0, 174.0, 301.0, 144.0, 249.0, 124.0, 142.0, 189.0, 325.0, 308.0, 261.0, 245.0, 237.0, 217.0, 252.0, 280.0, 270.0, 319.0, 242.0, 272.0, 214.0, 250.0, 264.0, 263.0, 308.0, 248.0, 208.0, 264.0, 250.0, 232.0, 163.0, 350.0, 318.0, 278.0, 242.0, 256.0, 203.0, 210.0, 210.0, 143.0, 236.0, 205.0, 171.0, 47.0, 249.0, 185.0, 96.0, 70.0, 252.0, 293.0, 240.0, 130.0, 217.0, 242.0, 128.0, 215.0, 57.0, 210.0, 289.0, 115.0, 163.0, 305.0, 205.0, 206.0, 134.0, 262.0, 130.0, 311.0, 101.0, 172.0, 216.0, 150.0, 243.0, 269.0, 172.0, 265.0, 143.0, 217.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [180.0, 141.0, 107.0, 167.0, 0.0, 107.0, 156.0, 146.0, 168.0, 125.0, 164.0, 140.0, 95.0, -49.0, 146.0, 188.0, 166.0, 167.0, 169.0, 104.0, 125.0, 157.0, 47.0, 169.0, 174.0, 173.0, 123.0, -41.0, 167.0, 143.0, -26.0, 152.0, 58.0, 130.0, 148.0, 172.0, 82.0, 180.0, 178.0, 165.0, 192.0, 164.0, 140.0, 127.0, 150.0, 74.0, 167.0, -51.0, 167.0, 131.0, -136.0, 172.0, -136.0, 177.0, 17.0, 52.0, 66.0, 71.0, 82.0, 93.0, 153.0, 164.0, 151.0, 149.0, 132.0, 106.0, 81.0, 164.0, 33.0, 178.0, 42.0, 163.0, 58.0, 168.0, 130.0, 137.0, 151.0, 42.0, 140.0, 179.0, 82.0, 160.0, 105.0, 135.0, 27.0, 145.0, 150.0, 78.0, 106.0, 150.0, 162.0, 50.0, 153.0, 136.0, 135.0, 113.0, 18.0, 150.0, 88.0, 132.0, 101.0, 149.0, 158.0, 24.0, 160.0, -73.0, 181.0, 169.0, 159.0, 159.0, 148.0, 130.0, 77.0, 132.0, 130.0, 126.0, 134.0, 69.0, 130.0, 47.0, 18.0, 110.0, 133.0, -72.0, 146.0, 90.0, 163.0, -31.0, 0.0, 171.0, -59.0, -29.0, 164.0, 79.0, 143.0, 32.0, 50.0, -6.0, 114.0, -128.0, 144.0, 6.0, 159.0, 134.0, 102.0, 123.0, 131.0, -94.0, 92.0, 125.0, 103.0, 139.0, -46.0, 143.0, 11.0, 140.0, 61.0, -32.0, 100.0, 85.0, 150.0, 130.0, -32.0, 41.0, 122.0, -5.0, 147.0, 158.0, 162.0, 16.0, 73.0, 120.0, -7.0, 86.0, 168.0, 94.0, 130.0, 0.0, 144.0, 167.0, -44.0, 122.0, 54.0, 46.0, -1.0, 163.0, -4.0, 151.0, 176.0, 14.0, 145.0, 113.0, 166.0, -23.0, 137.0, 122.0, 24.0, 62.0, 131.0, 59.0], "policy_predator_policy_reward": [2.0, 8.0, 0.0, 0.0, 0.0, 0.0, 7.0, 1.0, 6.0, 0.0, 0.0, 8.0, 70.0, 70.0, 0.0, 0.0, 0.0, 6.0, 12.0, 16.0, 0.0, 12.0, 46.0, 0.0, 0.0, 0.0, 65.0, 0.0, 0.0, 0.0, 3.0, 63.0, 38.0, 19.0, 0.0, 13.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 36.0, 1.0, 58.0, 0.0, 3.0, 0.0, 108.0, 0.0, 106.0, 102.0, 55.0, 0.0, 0.0, 5.0, 0.0, 14.0, 0.0, 8.0, 0.0, 8.0, 14.0, 9.0, 0.0, 0.0, 0.0, 26.0, 5.0, 7.0, 13.0, 13.0, 13.0, 0.0, 36.0, 41.0, 0.0, 0.0, 0.0, 0.0, 12.0, 20.0, 36.0, 6.0, 0.0, 22.0, 8.0, 0.0, 15.0, 36.0, 9.0, 10.0, 0.0, 0.0, 13.0, 27.0, 22.0, 22.0, 0.0, 0.0, 0.0, 50.0, 76.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 42.0, 40.0, 5.0, 77.0, 0.0, 0.0, 5.0, 68.0, 0.0, 0.0, 54.0, 81.0, 0.0, 6.0, 10.0, 0.0, 39.0, 13.0, 84.0, 0.0, 50.0, 52.0, 0.0, 0.0, 13.0, 2.0, 0.0, 93.0, 0.0, 0.0, 0.0, 0.0, 9.0, 22.0, 30.0, 34.0, 12.0, 16.0, 25.0, 0.0, 0.0, 9.0, 36.0, 70.0, 0.0, 46.0, 0.0, 0.0, 0.0, 27.0, 12.0, 1.0, 28.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 22.0, 36.0, 36.0, 54.0, 0.0, 2.0, 1.0, 8.0, 45.0, 5.0, 6.0, 29.0, 0.0, 6.0, 0.0, 48.0, 9.0, 0.0, 27.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.901381366716563, "mean_inference_ms": 17.40358686020212, "mean_action_processing_ms": 0.7983061601199511, "mean_env_wait_ms": 2.8466426545070633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005814909934997559, "StateBufferConnector_ms": 0.0076122283935546875, "ViewRequirementAgentConnector_ms": 0.4069911241531372}, "num_episodes": 22, "episode_return_max": 356.0, "episode_return_min": 47.0, "episode_return_mean": 231.5, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.161626702174411, "num_env_steps_trained_throughput_per_sec": 4.161626702174411, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 2064000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2064000, "timers": {"training_iteration_time_ms": 399413.427, "restore_workers_time_ms": 0.096, "training_step_time_ms": 399413.23, "sample_time_ms": 3865.773, "learn_time_ms": 395495.861, "learn_throughput": 10.114, "synch_weights_time_ms": 43.153}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "done": false, "training_iteration": 129, "trial_id": "45bed_00000", "date": "2024-08-13_04-43-22", "timestamp": 1723538602, "time_this_iter_s": 961.2937150001526, "time_total_s": 12782.9658908844, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44e50d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12782.9658908844, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 88.75142857142858, "ram_util_percent": 83.46285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5903464323550305, "cur_kl_coeff": 4.4408920985006264e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.529842001042038, "policy_loss": -0.0025839882742652977, "vf_loss": 2.532425982043857, "vf_explained_var": 0.0007127822706939051, "kl": 0.0023386080366693536, "entropy": 0.16369110286708863, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 244755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.864130717831314, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.654742921344818, "policy_loss": -0.003943020261444703, "vf_loss": 7.658685949870518, "vf_explained_var": 0.2589772484289906, "kl": 0.015415250921225341, "entropy": 1.336201838652293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 244755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "env_runners": {"episode_reward_max": 356.0, "episode_reward_min": 47.0, "episode_reward_mean": 216.45, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -243.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 192.0, "predator_policy": 133.0}, "policy_reward_mean": {"prey_policy": 89.24, "predator_policy": 18.985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [264.0, 343.0, 356.0, 267.0, 261.0, 174.0, 301.0, 144.0, 249.0, 124.0, 142.0, 189.0, 325.0, 308.0, 261.0, 245.0, 237.0, 217.0, 252.0, 280.0, 270.0, 319.0, 242.0, 272.0, 214.0, 250.0, 264.0, 263.0, 308.0, 248.0, 208.0, 264.0, 250.0, 232.0, 163.0, 350.0, 318.0, 278.0, 242.0, 256.0, 203.0, 210.0, 210.0, 143.0, 236.0, 205.0, 171.0, 47.0, 249.0, 185.0, 96.0, 70.0, 252.0, 293.0, 240.0, 130.0, 217.0, 242.0, 128.0, 215.0, 57.0, 210.0, 289.0, 115.0, 163.0, 305.0, 205.0, 206.0, 134.0, 262.0, 130.0, 311.0, 101.0, 172.0, 216.0, 150.0, 243.0, 269.0, 172.0, 265.0, 143.0, 217.0, 308.0, 160.0, 341.0, 126.0, 97.0, 135.0, 60.0, 222.0, 92.0, 318.0, 291.0, 241.0, 245.0, 55.0, 257.0, 110.0, 184.0, 176.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [82.0, 180.0, 178.0, 165.0, 192.0, 164.0, 140.0, 127.0, 150.0, 74.0, 167.0, -51.0, 167.0, 131.0, -136.0, 172.0, -136.0, 177.0, 17.0, 52.0, 66.0, 71.0, 82.0, 93.0, 153.0, 164.0, 151.0, 149.0, 132.0, 106.0, 81.0, 164.0, 33.0, 178.0, 42.0, 163.0, 58.0, 168.0, 130.0, 137.0, 151.0, 42.0, 140.0, 179.0, 82.0, 160.0, 105.0, 135.0, 27.0, 145.0, 150.0, 78.0, 106.0, 150.0, 162.0, 50.0, 153.0, 136.0, 135.0, 113.0, 18.0, 150.0, 88.0, 132.0, 101.0, 149.0, 158.0, 24.0, 160.0, -73.0, 181.0, 169.0, 159.0, 159.0, 148.0, 130.0, 77.0, 132.0, 130.0, 126.0, 134.0, 69.0, 130.0, 47.0, 18.0, 110.0, 133.0, -72.0, 146.0, 90.0, 163.0, -31.0, 0.0, 171.0, -59.0, -29.0, 164.0, 79.0, 143.0, 32.0, 50.0, -6.0, 114.0, -128.0, 144.0, 6.0, 159.0, 134.0, 102.0, 123.0, 131.0, -94.0, 92.0, 125.0, 103.0, 139.0, -46.0, 143.0, 11.0, 140.0, 61.0, -32.0, 100.0, 85.0, 150.0, 130.0, -32.0, 41.0, 122.0, -5.0, 147.0, 158.0, 162.0, 16.0, 73.0, 120.0, -7.0, 86.0, 168.0, 94.0, 130.0, 0.0, 144.0, 167.0, -44.0, 122.0, 54.0, 46.0, -1.0, 163.0, -4.0, 151.0, 176.0, 14.0, 145.0, 113.0, 166.0, -23.0, 137.0, 122.0, 24.0, 62.0, 131.0, 59.0, 145.0, 151.0, 120.0, -31.0, 178.0, 144.0, 78.0, -117.0, 22.0, -41.0, 34.0, -7.0, -12.0, 62.0, 143.0, 62.0, 135.0, -141.0, 155.0, 161.0, 167.0, 28.0, 110.0, 131.0, 68.0, 137.0, -80.0, 34.0, 122.0, 106.0, 128.0, -243.0, 0.0, 184.0, -36.0, 130.0], "policy_predator_policy_reward": [2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 36.0, 1.0, 58.0, 0.0, 3.0, 0.0, 108.0, 0.0, 106.0, 102.0, 55.0, 0.0, 0.0, 5.0, 0.0, 14.0, 0.0, 8.0, 0.0, 8.0, 14.0, 9.0, 0.0, 0.0, 0.0, 26.0, 5.0, 7.0, 13.0, 13.0, 13.0, 0.0, 36.0, 41.0, 0.0, 0.0, 0.0, 0.0, 12.0, 20.0, 36.0, 6.0, 0.0, 22.0, 8.0, 0.0, 15.0, 36.0, 9.0, 10.0, 0.0, 0.0, 13.0, 27.0, 22.0, 22.0, 0.0, 0.0, 0.0, 50.0, 76.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 42.0, 40.0, 5.0, 77.0, 0.0, 0.0, 5.0, 68.0, 0.0, 0.0, 54.0, 81.0, 0.0, 6.0, 10.0, 0.0, 39.0, 13.0, 84.0, 0.0, 50.0, 52.0, 0.0, 0.0, 13.0, 2.0, 0.0, 93.0, 0.0, 0.0, 0.0, 0.0, 9.0, 22.0, 30.0, 34.0, 12.0, 16.0, 25.0, 0.0, 0.0, 9.0, 36.0, 70.0, 0.0, 46.0, 0.0, 0.0, 0.0, 27.0, 12.0, 1.0, 28.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 22.0, 36.0, 36.0, 54.0, 0.0, 2.0, 1.0, 8.0, 45.0, 5.0, 6.0, 29.0, 0.0, 6.0, 0.0, 48.0, 9.0, 0.0, 27.0, 12.0, 0.0, 71.0, 0.0, 6.0, 13.0, 74.0, 91.0, 41.0, 75.0, 30.0, 78.0, 0.0, 10.0, 0.0, 17.0, 0.0, 98.0, 2.0, 0.0, 49.0, 47.0, 0.0, 0.0, 34.0, 6.0, 15.0, 86.0, 29.0, 0.0, 92.0, 133.0, 0.0, 0.0, 16.0, 66.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.877667386848492, "mean_inference_ms": 17.519471431262815, "mean_action_processing_ms": 0.7996212961719871, "mean_env_wait_ms": 2.647228198980676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005861520767211914, "StateBufferConnector_ms": 0.008015990257263184, "ViewRequirementAgentConnector_ms": 0.44057655334472656}, "num_episodes": 18, "episode_return_max": 356.0, "episode_return_min": 47.0, "episode_return_mean": 216.45, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.4041880080875, "num_env_steps_trained_throughput_per_sec": 149.4041880080875, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 2080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2080000, "timers": {"training_iteration_time_ms": 400117.637, "restore_workers_time_ms": 0.098, "training_step_time_ms": 400117.436, "sample_time_ms": 4410.596, "learn_time_ms": 395653.254, "learn_throughput": 10.11, "synch_weights_time_ms": 44.804}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "done": false, "training_iteration": 130, "trial_id": "45bed_00000", "date": "2024-08-13_04-43-49", "timestamp": 1723538629, "time_this_iter_s": 26.95139980316162, "time_total_s": 12809.917290687561, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b526a790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12809.917290687561, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 92.48157894736842, "ram_util_percent": 83.7684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1832509970972462, "cur_kl_coeff": 2.2204460492503132e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0173998364380428, "policy_loss": -0.0022198012081423293, "vf_loss": 1.019619639083822, "vf_explained_var": 0.0074038596695693085, "kl": 0.0019375582193435481, "entropy": 0.14600444334761176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 246645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.829762373840998, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.5040915024974355, "policy_loss": -0.005800407442816154, "vf_loss": 7.509891909392422, "vf_explained_var": 0.19048638722253225, "kl": 0.023659451211414426, "entropy": 1.2060332172131412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 246645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 2096000}, "env_runners": {"episode_reward_max": 350.0, "episode_reward_min": 47.0, "episode_reward_mean": 217.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -243.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.0, "predator_policy": 133.0}, "policy_reward_mean": {"prey_policy": 90.175, "predator_policy": 18.585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [252.0, 280.0, 270.0, 319.0, 242.0, 272.0, 214.0, 250.0, 264.0, 263.0, 308.0, 248.0, 208.0, 264.0, 250.0, 232.0, 163.0, 350.0, 318.0, 278.0, 242.0, 256.0, 203.0, 210.0, 210.0, 143.0, 236.0, 205.0, 171.0, 47.0, 249.0, 185.0, 96.0, 70.0, 252.0, 293.0, 240.0, 130.0, 217.0, 242.0, 128.0, 215.0, 57.0, 210.0, 289.0, 115.0, 163.0, 305.0, 205.0, 206.0, 134.0, 262.0, 130.0, 311.0, 101.0, 172.0, 216.0, 150.0, 243.0, 269.0, 172.0, 265.0, 143.0, 217.0, 308.0, 160.0, 341.0, 126.0, 97.0, 135.0, 60.0, 222.0, 92.0, 318.0, 291.0, 241.0, 245.0, 55.0, 257.0, 110.0, 184.0, 176.0, 233.0, 281.0, 264.0, 238.0, 223.0, 235.0, 310.0, 270.0, 186.0, 298.0, 252.0, 264.0, 256.0, 215.0, 196.0, 295.0, 194.0, 304.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [58.0, 168.0, 130.0, 137.0, 151.0, 42.0, 140.0, 179.0, 82.0, 160.0, 105.0, 135.0, 27.0, 145.0, 150.0, 78.0, 106.0, 150.0, 162.0, 50.0, 153.0, 136.0, 135.0, 113.0, 18.0, 150.0, 88.0, 132.0, 101.0, 149.0, 158.0, 24.0, 160.0, -73.0, 181.0, 169.0, 159.0, 159.0, 148.0, 130.0, 77.0, 132.0, 130.0, 126.0, 134.0, 69.0, 130.0, 47.0, 18.0, 110.0, 133.0, -72.0, 146.0, 90.0, 163.0, -31.0, 0.0, 171.0, -59.0, -29.0, 164.0, 79.0, 143.0, 32.0, 50.0, -6.0, 114.0, -128.0, 144.0, 6.0, 159.0, 134.0, 102.0, 123.0, 131.0, -94.0, 92.0, 125.0, 103.0, 139.0, -46.0, 143.0, 11.0, 140.0, 61.0, -32.0, 100.0, 85.0, 150.0, 130.0, -32.0, 41.0, 122.0, -5.0, 147.0, 158.0, 162.0, 16.0, 73.0, 120.0, -7.0, 86.0, 168.0, 94.0, 130.0, 0.0, 144.0, 167.0, -44.0, 122.0, 54.0, 46.0, -1.0, 163.0, -4.0, 151.0, 176.0, 14.0, 145.0, 113.0, 166.0, -23.0, 137.0, 122.0, 24.0, 62.0, 131.0, 59.0, 145.0, 151.0, 120.0, -31.0, 178.0, 144.0, 78.0, -117.0, 22.0, -41.0, 34.0, -7.0, -12.0, 62.0, 143.0, 62.0, 135.0, -141.0, 155.0, 161.0, 167.0, 28.0, 110.0, 131.0, 68.0, 137.0, -80.0, 34.0, 122.0, 106.0, 128.0, -243.0, 0.0, 184.0, -36.0, 130.0, 162.0, 71.0, 132.0, 114.0, 51.0, 135.0, 145.0, 44.0, 134.0, 89.0, 117.0, 98.0, 106.0, 182.0, 107.0, 160.0, 24.0, 158.0, 125.0, 152.0, 126.0, 115.0, 105.0, 159.0, 159.0, 71.0, 72.0, 109.0, 110.0, -45.0, 163.0, 128.0, -28.0, 174.0, 141.0, 162.0], "policy_predator_policy_reward": [13.0, 13.0, 13.0, 0.0, 36.0, 41.0, 0.0, 0.0, 0.0, 0.0, 12.0, 20.0, 36.0, 6.0, 0.0, 22.0, 8.0, 0.0, 15.0, 36.0, 9.0, 10.0, 0.0, 0.0, 13.0, 27.0, 22.0, 22.0, 0.0, 0.0, 0.0, 50.0, 76.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 42.0, 40.0, 5.0, 77.0, 0.0, 0.0, 5.0, 68.0, 0.0, 0.0, 54.0, 81.0, 0.0, 6.0, 10.0, 0.0, 39.0, 13.0, 84.0, 0.0, 50.0, 52.0, 0.0, 0.0, 13.0, 2.0, 0.0, 93.0, 0.0, 0.0, 0.0, 0.0, 9.0, 22.0, 30.0, 34.0, 12.0, 16.0, 25.0, 0.0, 0.0, 9.0, 36.0, 70.0, 0.0, 46.0, 0.0, 0.0, 0.0, 27.0, 12.0, 1.0, 28.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 22.0, 36.0, 36.0, 54.0, 0.0, 2.0, 1.0, 8.0, 45.0, 5.0, 6.0, 29.0, 0.0, 6.0, 0.0, 48.0, 9.0, 0.0, 27.0, 12.0, 0.0, 71.0, 0.0, 6.0, 13.0, 74.0, 91.0, 41.0, 75.0, 30.0, 78.0, 0.0, 10.0, 0.0, 17.0, 0.0, 98.0, 2.0, 0.0, 49.0, 47.0, 0.0, 0.0, 34.0, 6.0, 15.0, 86.0, 29.0, 0.0, 92.0, 133.0, 0.0, 0.0, 16.0, 66.0, 0.0, 0.0, 23.0, 12.0, 36.0, 42.0, 43.0, 6.0, 0.0, 0.0, 20.0, 0.0, 0.0, 22.0, 2.0, 1.0, 2.0, 2.0, 21.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 26.0, 0.0, 34.0, 62.0, 69.0, 4.0, 0.0, 48.0, 0.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.854022140292225, "mean_inference_ms": 17.45083433223907, "mean_action_processing_ms": 0.801408796013084, "mean_env_wait_ms": 2.635622530227183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005909085273742676, "StateBufferConnector_ms": 0.00810539722442627, "ViewRequirementAgentConnector_ms": 0.4473388195037842}, "num_episodes": 18, "episode_return_max": 350.0, "episode_return_min": 47.0, "episode_return_mean": 217.52, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 2096000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 229.87297054628976, "num_env_steps_trained_throughput_per_sec": 229.87297054628976, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 2096000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2096000, "timers": {"training_iteration_time_ms": 300349.609, "restore_workers_time_ms": 0.098, "training_step_time_ms": 300349.407, "sample_time_ms": 4567.168, "learn_time_ms": 295736.677, "learn_throughput": 13.526, "synch_weights_time_ms": 37.621}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 2096000}, "done": false, "training_iteration": 131, "trial_id": "45bed_00000", "date": "2024-08-13_04-44-07", "timestamp": 1723538647, "time_this_iter_s": 17.473904132843018, "time_total_s": 12827.391194820404, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b528f430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12827.391194820404, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 79.844, "ram_util_percent": 83.584}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5874411585075514, "cur_kl_coeff": 1.1102230246251566e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.741219832279064, "policy_loss": -0.0008304193968239127, "vf_loss": 2.742050249172897, "vf_explained_var": 0.0013368777812473357, "kl": 0.001590868315988649, "entropy": 0.12442439706828544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 248535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.386868143050128, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.889461472930101, "policy_loss": 0.004518022609963304, "vf_loss": 6.8849434686085536, "vf_explained_var": 0.24060932155008669, "kl": 0.012498486140776024, "entropy": 1.2702004703895124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 248535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "env_runners": {"episode_reward_max": 365.0, "episode_reward_min": -18.0, "episode_reward_mean": 213.85, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -243.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 188.0, "predator_policy": 133.0}, "policy_reward_mean": {"prey_policy": 83.67, "predator_policy": 23.255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.0, 210.0, 143.0, 236.0, 205.0, 171.0, 47.0, 249.0, 185.0, 96.0, 70.0, 252.0, 293.0, 240.0, 130.0, 217.0, 242.0, 128.0, 215.0, 57.0, 210.0, 289.0, 115.0, 163.0, 305.0, 205.0, 206.0, 134.0, 262.0, 130.0, 311.0, 101.0, 172.0, 216.0, 150.0, 243.0, 269.0, 172.0, 265.0, 143.0, 217.0, 308.0, 160.0, 341.0, 126.0, 97.0, 135.0, 60.0, 222.0, 92.0, 318.0, 291.0, 241.0, 245.0, 55.0, 257.0, 110.0, 184.0, 176.0, 233.0, 281.0, 264.0, 238.0, 223.0, 235.0, 310.0, 270.0, 186.0, 298.0, 252.0, 264.0, 256.0, 215.0, 196.0, 295.0, 194.0, 304.0, 235.0, 216.0, 127.0, 365.0, 266.0, 306.0, 234.0, 325.0, 303.0, -18.0, 290.0, 248.0, 292.0, 278.0, 200.0, 55.0, 300.0, 337.0, 135.0, 208.0, 243.0, 365.0, 269.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [130.0, 47.0, 18.0, 110.0, 133.0, -72.0, 146.0, 90.0, 163.0, -31.0, 0.0, 171.0, -59.0, -29.0, 164.0, 79.0, 143.0, 32.0, 50.0, -6.0, 114.0, -128.0, 144.0, 6.0, 159.0, 134.0, 102.0, 123.0, 131.0, -94.0, 92.0, 125.0, 103.0, 139.0, -46.0, 143.0, 11.0, 140.0, 61.0, -32.0, 100.0, 85.0, 150.0, 130.0, -32.0, 41.0, 122.0, -5.0, 147.0, 158.0, 162.0, 16.0, 73.0, 120.0, -7.0, 86.0, 168.0, 94.0, 130.0, 0.0, 144.0, 167.0, -44.0, 122.0, 54.0, 46.0, -1.0, 163.0, -4.0, 151.0, 176.0, 14.0, 145.0, 113.0, 166.0, -23.0, 137.0, 122.0, 24.0, 62.0, 131.0, 59.0, 145.0, 151.0, 120.0, -31.0, 178.0, 144.0, 78.0, -117.0, 22.0, -41.0, 34.0, -7.0, -12.0, 62.0, 143.0, 62.0, 135.0, -141.0, 155.0, 161.0, 167.0, 28.0, 110.0, 131.0, 68.0, 137.0, -80.0, 34.0, 122.0, 106.0, 128.0, -243.0, 0.0, 184.0, -36.0, 130.0, 162.0, 71.0, 132.0, 114.0, 51.0, 135.0, 145.0, 44.0, 134.0, 89.0, 117.0, 98.0, 106.0, 182.0, 107.0, 160.0, 24.0, 158.0, 125.0, 152.0, 126.0, 115.0, 105.0, 159.0, 159.0, 71.0, 72.0, 109.0, 110.0, -45.0, 163.0, 128.0, -28.0, 174.0, 141.0, 162.0, -30.0, 141.0, 69.0, 10.0, -25.0, 68.0, 177.0, 188.0, 103.0, 163.0, 157.0, 115.0, 125.0, 109.0, 186.0, 118.0, 163.0, 100.0, -190.0, -11.0, 149.0, 61.0, 100.0, 148.0, 174.0, 79.0, -2.0, 169.0, 8.0, 149.0, -134.0, -57.0, 180.0, 38.0, 183.0, 143.0, 124.0, -57.0, 95.0, 9.0, 69.0, 157.0, 181.0, 184.0, 79.0, 147.0], "policy_predator_policy_reward": [0.0, 33.0, 42.0, 40.0, 5.0, 77.0, 0.0, 0.0, 5.0, 68.0, 0.0, 0.0, 54.0, 81.0, 0.0, 6.0, 10.0, 0.0, 39.0, 13.0, 84.0, 0.0, 50.0, 52.0, 0.0, 0.0, 13.0, 2.0, 0.0, 93.0, 0.0, 0.0, 0.0, 0.0, 9.0, 22.0, 30.0, 34.0, 12.0, 16.0, 25.0, 0.0, 0.0, 9.0, 36.0, 70.0, 0.0, 46.0, 0.0, 0.0, 0.0, 27.0, 12.0, 1.0, 28.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 22.0, 36.0, 36.0, 54.0, 0.0, 2.0, 1.0, 8.0, 45.0, 5.0, 6.0, 29.0, 0.0, 6.0, 0.0, 48.0, 9.0, 0.0, 27.0, 12.0, 0.0, 71.0, 0.0, 6.0, 13.0, 74.0, 91.0, 41.0, 75.0, 30.0, 78.0, 0.0, 10.0, 0.0, 17.0, 0.0, 98.0, 2.0, 0.0, 49.0, 47.0, 0.0, 0.0, 34.0, 6.0, 15.0, 86.0, 29.0, 0.0, 92.0, 133.0, 0.0, 0.0, 16.0, 66.0, 0.0, 0.0, 23.0, 12.0, 36.0, 42.0, 43.0, 6.0, 0.0, 0.0, 20.0, 0.0, 0.0, 22.0, 2.0, 1.0, 2.0, 2.0, 21.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 26.0, 0.0, 34.0, 62.0, 69.0, 4.0, 0.0, 48.0, 0.0, 0.0, 1.0, 62.0, 62.0, 71.0, 66.0, 37.0, 47.0, 0.0, 0.0, 0.0, 0.0, 17.0, 17.0, 0.0, 0.0, 0.0, 21.0, 22.0, 18.0, 115.0, 68.0, 43.0, 37.0, 0.0, 0.0, 39.0, 0.0, 55.0, 56.0, 0.0, 43.0, 122.0, 124.0, 40.0, 42.0, 0.0, 11.0, 65.0, 3.0, 29.0, 75.0, 7.0, 10.0, 0.0, 0.0, 3.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.185410428179415, "mean_inference_ms": 17.0055241504161, "mean_action_processing_ms": 0.8063806180596681, "mean_env_wait_ms": 2.626347327383749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005874752998352051, "StateBufferConnector_ms": 0.00577092170715332, "ViewRequirementAgentConnector_ms": 0.40689849853515625}, "num_episodes": 23, "episode_return_max": 365.0, "episode_return_min": -18.0, "episode_return_mean": 213.85, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 233.19590237111046, "num_env_steps_trained_throughput_per_sec": 233.19590237111046, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 2112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2112000, "timers": {"training_iteration_time_ms": 299296.079, "restore_workers_time_ms": 0.056, "training_step_time_ms": 299295.962, "sample_time_ms": 4357.04, "learn_time_ms": 294888.919, "learn_throughput": 13.564, "synch_weights_time_ms": 41.002}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "done": false, "training_iteration": 132, "trial_id": "45bed_00000", "date": "2024-08-13_04-44-24", "timestamp": 1723538664, "time_this_iter_s": 17.263916015625, "time_total_s": 12844.655110836029, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44e50d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12844.655110836029, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 76.66666666666667, "ram_util_percent": 83.20416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8785162111281086, "cur_kl_coeff": 5.551115123125783e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.194273689688829, "policy_loss": -0.0023091876721650206, "vf_loss": 3.1965828793389455, "vf_explained_var": 0.0009170337013466648, "kl": 0.0017650104923123597, "entropy": 0.12499222140857782, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 250425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.736636113742041, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.350790205960552, "policy_loss": -0.0016309015333366695, "vf_loss": 7.352421132345048, "vf_explained_var": 0.1397078699220425, "kl": 0.011264368932780367, "entropy": 1.3250061677246499, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 250425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000}, "env_runners": {"episode_reward_max": 365.0, "episode_reward_min": -18.0, "episode_reward_mean": 218.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -247.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 146.0}, "policy_reward_mean": {"prey_policy": 83.765, "predator_policy": 25.515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [215.0, 57.0, 210.0, 289.0, 115.0, 163.0, 305.0, 205.0, 206.0, 134.0, 262.0, 130.0, 311.0, 101.0, 172.0, 216.0, 150.0, 243.0, 269.0, 172.0, 265.0, 143.0, 217.0, 308.0, 160.0, 341.0, 126.0, 97.0, 135.0, 60.0, 222.0, 92.0, 318.0, 291.0, 241.0, 245.0, 55.0, 257.0, 110.0, 184.0, 176.0, 233.0, 281.0, 264.0, 238.0, 223.0, 235.0, 310.0, 270.0, 186.0, 298.0, 252.0, 264.0, 256.0, 215.0, 196.0, 295.0, 194.0, 304.0, 235.0, 216.0, 127.0, 365.0, 266.0, 306.0, 234.0, 325.0, 303.0, -18.0, 290.0, 248.0, 292.0, 278.0, 200.0, 55.0, 300.0, 337.0, 135.0, 208.0, 243.0, 365.0, 269.0, 217.0, 284.0, 227.0, -6.0, 324.0, 222.0, 200.0, 239.0, 185.0, 32.0, 293.0, 349.0, 224.0, 83.0, 316.0, 234.0, 195.0, 177.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [11.0, 140.0, 61.0, -32.0, 100.0, 85.0, 150.0, 130.0, -32.0, 41.0, 122.0, -5.0, 147.0, 158.0, 162.0, 16.0, 73.0, 120.0, -7.0, 86.0, 168.0, 94.0, 130.0, 0.0, 144.0, 167.0, -44.0, 122.0, 54.0, 46.0, -1.0, 163.0, -4.0, 151.0, 176.0, 14.0, 145.0, 113.0, 166.0, -23.0, 137.0, 122.0, 24.0, 62.0, 131.0, 59.0, 145.0, 151.0, 120.0, -31.0, 178.0, 144.0, 78.0, -117.0, 22.0, -41.0, 34.0, -7.0, -12.0, 62.0, 143.0, 62.0, 135.0, -141.0, 155.0, 161.0, 167.0, 28.0, 110.0, 131.0, 68.0, 137.0, -80.0, 34.0, 122.0, 106.0, 128.0, -243.0, 0.0, 184.0, -36.0, 130.0, 162.0, 71.0, 132.0, 114.0, 51.0, 135.0, 145.0, 44.0, 134.0, 89.0, 117.0, 98.0, 106.0, 182.0, 107.0, 160.0, 24.0, 158.0, 125.0, 152.0, 126.0, 115.0, 105.0, 159.0, 159.0, 71.0, 72.0, 109.0, 110.0, -45.0, 163.0, 128.0, -28.0, 174.0, 141.0, 162.0, -30.0, 141.0, 69.0, 10.0, -25.0, 68.0, 177.0, 188.0, 103.0, 163.0, 157.0, 115.0, 125.0, 109.0, 186.0, 118.0, 163.0, 100.0, -190.0, -11.0, 149.0, 61.0, 100.0, 148.0, 174.0, 79.0, -2.0, 169.0, 8.0, 149.0, -134.0, -57.0, 180.0, 38.0, 183.0, 143.0, 124.0, -57.0, 95.0, 9.0, 69.0, 157.0, 181.0, 184.0, 79.0, 147.0, 121.0, 36.0, 98.0, 163.0, 131.0, 66.0, 71.0, -247.0, 145.0, 164.0, 148.0, -68.0, 175.0, 25.0, 196.0, -16.0, 150.0, -14.0, -59.0, -165.0, 129.0, 164.0, 174.0, 175.0, 150.0, -11.0, 75.0, -90.0, 174.0, 142.0, 13.0, 132.0, -11.0, 161.0, 115.0, -67.0], "policy_predator_policy_reward": [30.0, 34.0, 12.0, 16.0, 25.0, 0.0, 0.0, 9.0, 36.0, 70.0, 0.0, 46.0, 0.0, 0.0, 0.0, 27.0, 12.0, 1.0, 28.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 22.0, 36.0, 36.0, 54.0, 0.0, 2.0, 1.0, 8.0, 45.0, 5.0, 6.0, 29.0, 0.0, 6.0, 0.0, 48.0, 9.0, 0.0, 27.0, 12.0, 0.0, 71.0, 0.0, 6.0, 13.0, 74.0, 91.0, 41.0, 75.0, 30.0, 78.0, 0.0, 10.0, 0.0, 17.0, 0.0, 98.0, 2.0, 0.0, 49.0, 47.0, 0.0, 0.0, 34.0, 6.0, 15.0, 86.0, 29.0, 0.0, 92.0, 133.0, 0.0, 0.0, 16.0, 66.0, 0.0, 0.0, 23.0, 12.0, 36.0, 42.0, 43.0, 6.0, 0.0, 0.0, 20.0, 0.0, 0.0, 22.0, 2.0, 1.0, 2.0, 2.0, 21.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 26.0, 0.0, 34.0, 62.0, 69.0, 4.0, 0.0, 48.0, 0.0, 0.0, 1.0, 62.0, 62.0, 71.0, 66.0, 37.0, 47.0, 0.0, 0.0, 0.0, 0.0, 17.0, 17.0, 0.0, 0.0, 0.0, 21.0, 22.0, 18.0, 115.0, 68.0, 43.0, 37.0, 0.0, 0.0, 39.0, 0.0, 55.0, 56.0, 0.0, 43.0, 122.0, 124.0, 40.0, 42.0, 0.0, 11.0, 65.0, 3.0, 29.0, 75.0, 7.0, 10.0, 0.0, 0.0, 3.0, 40.0, 30.0, 30.0, 0.0, 23.0, 0.0, 30.0, 146.0, 24.0, 0.0, 15.0, 77.0, 65.0, 0.0, 0.0, 0.0, 59.0, 49.0, 0.0, 131.0, 125.0, 0.0, 0.0, 0.0, 0.0, 33.0, 52.0, 0.0, 98.0, 0.0, 0.0, 45.0, 44.0, 45.0, 0.0, 67.0, 62.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.79589045214858, "mean_inference_ms": 17.295752626229003, "mean_action_processing_ms": 0.8040146203435523, "mean_env_wait_ms": 2.6118571745673558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012960553169250488, "StateBufferConnector_ms": 0.004210948944091797, "ViewRequirementAgentConnector_ms": 0.319913387298584}, "num_episodes": 18, "episode_return_max": 365.0, "episode_return_min": -18.0, "episode_return_mean": 218.56, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 199.456821524501, "num_env_steps_trained_throughput_per_sec": 199.456821524501, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 2128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2128000, "timers": {"training_iteration_time_ms": 299597.024, "restore_workers_time_ms": 0.059, "training_step_time_ms": 299596.903, "sample_time_ms": 4522.017, "learn_time_ms": 295020.301, "learn_throughput": 13.558, "synch_weights_time_ms": 45.648}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000}, "done": false, "training_iteration": 133, "trial_id": "45bed_00000", "date": "2024-08-13_04-44-45", "timestamp": 1723538685, "time_this_iter_s": 20.11487579345703, "time_total_s": 12864.769986629486, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44b4040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12864.769986629486, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 79.50714285714287, "ram_util_percent": 83.57500000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.515305813871048, "cur_kl_coeff": 2.7755575615628915e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5500375693437283, "policy_loss": -0.0016492394259859803, "vf_loss": 2.551686805770511, "vf_explained_var": 0.002134220877652446, "kl": 0.0016617326913381456, "entropy": 0.0910151787457012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 252315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.158194370465305, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.988453595600431, "policy_loss": -0.0024472775881390564, "vf_loss": 7.99090085029602, "vf_explained_var": 0.2525810825130927, "kl": 0.018044882506057996, "entropy": 1.273404862388732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 252315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000}, "env_runners": {"episode_reward_max": 365.0, "episode_reward_min": -18.0, "episode_reward_mean": 221.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -247.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 146.0}, "policy_reward_mean": {"prey_policy": 83.26, "predator_policy": 27.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.0, 308.0, 160.0, 341.0, 126.0, 97.0, 135.0, 60.0, 222.0, 92.0, 318.0, 291.0, 241.0, 245.0, 55.0, 257.0, 110.0, 184.0, 176.0, 233.0, 281.0, 264.0, 238.0, 223.0, 235.0, 310.0, 270.0, 186.0, 298.0, 252.0, 264.0, 256.0, 215.0, 196.0, 295.0, 194.0, 304.0, 235.0, 216.0, 127.0, 365.0, 266.0, 306.0, 234.0, 325.0, 303.0, -18.0, 290.0, 248.0, 292.0, 278.0, 200.0, 55.0, 300.0, 337.0, 135.0, 208.0, 243.0, 365.0, 269.0, 217.0, 284.0, 227.0, -6.0, 324.0, 222.0, 200.0, 239.0, 185.0, 32.0, 293.0, 349.0, 224.0, 83.0, 316.0, 234.0, 195.0, 177.0, 223.0, 155.0, 239.0, 250.0, 252.0, 301.0, 303.0, 313.0, 123.0, 176.0, 84.0, 178.0, 198.0, 183.0, 276.0, 99.0, 246.0, 231.0, 155.0, 171.0, 229.0, 214.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [131.0, 59.0, 145.0, 151.0, 120.0, -31.0, 178.0, 144.0, 78.0, -117.0, 22.0, -41.0, 34.0, -7.0, -12.0, 62.0, 143.0, 62.0, 135.0, -141.0, 155.0, 161.0, 167.0, 28.0, 110.0, 131.0, 68.0, 137.0, -80.0, 34.0, 122.0, 106.0, 128.0, -243.0, 0.0, 184.0, -36.0, 130.0, 162.0, 71.0, 132.0, 114.0, 51.0, 135.0, 145.0, 44.0, 134.0, 89.0, 117.0, 98.0, 106.0, 182.0, 107.0, 160.0, 24.0, 158.0, 125.0, 152.0, 126.0, 115.0, 105.0, 159.0, 159.0, 71.0, 72.0, 109.0, 110.0, -45.0, 163.0, 128.0, -28.0, 174.0, 141.0, 162.0, -30.0, 141.0, 69.0, 10.0, -25.0, 68.0, 177.0, 188.0, 103.0, 163.0, 157.0, 115.0, 125.0, 109.0, 186.0, 118.0, 163.0, 100.0, -190.0, -11.0, 149.0, 61.0, 100.0, 148.0, 174.0, 79.0, -2.0, 169.0, 8.0, 149.0, -134.0, -57.0, 180.0, 38.0, 183.0, 143.0, 124.0, -57.0, 95.0, 9.0, 69.0, 157.0, 181.0, 184.0, 79.0, 147.0, 121.0, 36.0, 98.0, 163.0, 131.0, 66.0, 71.0, -247.0, 145.0, 164.0, 148.0, -68.0, 175.0, 25.0, 196.0, -16.0, 150.0, -14.0, -59.0, -165.0, 129.0, 164.0, 174.0, 175.0, 150.0, -11.0, 75.0, -90.0, 174.0, 142.0, 13.0, 132.0, -11.0, 161.0, 115.0, -67.0, 14.0, 180.0, 99.0, -4.0, 73.0, 100.0, 120.0, 130.0, 159.0, 58.0, 137.0, 149.0, 91.0, 182.0, 173.0, 83.0, 147.0, -91.0, 110.0, 39.0, 85.0, -8.0, 116.0, 43.0, 92.0, 27.0, 87.0, 96.0, 116.0, 156.0, 100.0, -105.0, 154.0, 61.0, 70.0, 140.0, -100.0, 121.0, 2.0, 119.0, 47.0, 138.0, 173.0, -128.0], "policy_predator_policy_reward": [0.0, 27.0, 12.0, 0.0, 71.0, 0.0, 6.0, 13.0, 74.0, 91.0, 41.0, 75.0, 30.0, 78.0, 0.0, 10.0, 0.0, 17.0, 0.0, 98.0, 2.0, 0.0, 49.0, 47.0, 0.0, 0.0, 34.0, 6.0, 15.0, 86.0, 29.0, 0.0, 92.0, 133.0, 0.0, 0.0, 16.0, 66.0, 0.0, 0.0, 23.0, 12.0, 36.0, 42.0, 43.0, 6.0, 0.0, 0.0, 20.0, 0.0, 0.0, 22.0, 2.0, 1.0, 2.0, 2.0, 21.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 26.0, 0.0, 34.0, 62.0, 69.0, 4.0, 0.0, 48.0, 0.0, 0.0, 1.0, 62.0, 62.0, 71.0, 66.0, 37.0, 47.0, 0.0, 0.0, 0.0, 0.0, 17.0, 17.0, 0.0, 0.0, 0.0, 21.0, 22.0, 18.0, 115.0, 68.0, 43.0, 37.0, 0.0, 0.0, 39.0, 0.0, 55.0, 56.0, 0.0, 43.0, 122.0, 124.0, 40.0, 42.0, 0.0, 11.0, 65.0, 3.0, 29.0, 75.0, 7.0, 10.0, 0.0, 0.0, 3.0, 40.0, 30.0, 30.0, 0.0, 23.0, 0.0, 30.0, 146.0, 24.0, 0.0, 15.0, 77.0, 65.0, 0.0, 0.0, 0.0, 59.0, 49.0, 0.0, 131.0, 125.0, 0.0, 0.0, 0.0, 0.0, 33.0, 52.0, 0.0, 98.0, 0.0, 0.0, 45.0, 44.0, 45.0, 0.0, 67.0, 62.0, 29.0, 0.0, 15.0, 45.0, 32.0, 34.0, 0.0, 0.0, 16.0, 19.0, 15.0, 0.0, 27.0, 3.0, 27.0, 30.0, 67.0, 0.0, 27.0, 0.0, 7.0, 0.0, 19.0, 0.0, 33.0, 46.0, 0.0, 0.0, 0.0, 4.0, 91.0, 13.0, 31.0, 0.0, 19.0, 2.0, 83.0, 51.0, 34.0, 16.0, 44.0, 0.0, 91.0, 78.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.7709533839853915, "mean_inference_ms": 17.200620555809223, "mean_action_processing_ms": 0.8040344504688887, "mean_env_wait_ms": 2.5925436025118334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015011310577392578, "StateBufferConnector_ms": 0.0042531490325927734, "ViewRequirementAgentConnector_ms": 0.30398452281951904}, "num_episodes": 22, "episode_return_max": 365.0, "episode_return_min": -18.0, "episode_return_mean": 221.22, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.12630160277075, "num_env_steps_trained_throughput_per_sec": 210.12630160277075, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 2144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2144000, "timers": {"training_iteration_time_ms": 299905.414, "restore_workers_time_ms": 0.059, "training_step_time_ms": 299905.291, "sample_time_ms": 4576.663, "learn_time_ms": 295272.428, "learn_throughput": 13.547, "synch_weights_time_ms": 47.48}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000}, "done": false, "training_iteration": 134, "trial_id": "45bed_00000", "date": "2024-08-13_04-45-04", "timestamp": 1723538704, "time_this_iter_s": 19.10768413543701, "time_total_s": 12883.877670764923, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44b34c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12883.877670764923, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 79.93703703703704, "ram_util_percent": 83.52592592592592}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2558935220673602, "cur_kl_coeff": 1.3877787807814458e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.08444933304711, "policy_loss": -0.00026834249144134224, "vf_loss": 2.0847176671343504, "vf_explained_var": 0.00023717987474310335, "kl": 0.0015123679129961695, "entropy": 0.10160107167743186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 254205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.827101163116712, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.377955959461353, "policy_loss": -0.002664155125982626, "vf_loss": 7.380620123091198, "vf_explained_var": 0.2458461463766754, "kl": 0.008172508259897378, "entropy": 1.2104939333976261, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 254205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": 365.0, "episode_reward_min": -18.0, "episode_reward_mean": 226.29, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -247.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 146.0}, "policy_reward_mean": {"prey_policy": 88.14, "predator_policy": 25.005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [176.0, 233.0, 281.0, 264.0, 238.0, 223.0, 235.0, 310.0, 270.0, 186.0, 298.0, 252.0, 264.0, 256.0, 215.0, 196.0, 295.0, 194.0, 304.0, 235.0, 216.0, 127.0, 365.0, 266.0, 306.0, 234.0, 325.0, 303.0, -18.0, 290.0, 248.0, 292.0, 278.0, 200.0, 55.0, 300.0, 337.0, 135.0, 208.0, 243.0, 365.0, 269.0, 217.0, 284.0, 227.0, -6.0, 324.0, 222.0, 200.0, 239.0, 185.0, 32.0, 293.0, 349.0, 224.0, 83.0, 316.0, 234.0, 195.0, 177.0, 223.0, 155.0, 239.0, 250.0, 252.0, 301.0, 303.0, 313.0, 123.0, 176.0, 84.0, 178.0, 198.0, 183.0, 276.0, 99.0, 246.0, 231.0, 155.0, 171.0, 229.0, 214.0, 282.0, 354.0, 255.0, 190.0, 293.0, 301.0, 62.0, 190.0, 96.0, 104.0, 261.0, 185.0, 222.0, 324.0, 254.0, 112.0, 127.0, 354.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-36.0, 130.0, 162.0, 71.0, 132.0, 114.0, 51.0, 135.0, 145.0, 44.0, 134.0, 89.0, 117.0, 98.0, 106.0, 182.0, 107.0, 160.0, 24.0, 158.0, 125.0, 152.0, 126.0, 115.0, 105.0, 159.0, 159.0, 71.0, 72.0, 109.0, 110.0, -45.0, 163.0, 128.0, -28.0, 174.0, 141.0, 162.0, -30.0, 141.0, 69.0, 10.0, -25.0, 68.0, 177.0, 188.0, 103.0, 163.0, 157.0, 115.0, 125.0, 109.0, 186.0, 118.0, 163.0, 100.0, -190.0, -11.0, 149.0, 61.0, 100.0, 148.0, 174.0, 79.0, -2.0, 169.0, 8.0, 149.0, -134.0, -57.0, 180.0, 38.0, 183.0, 143.0, 124.0, -57.0, 95.0, 9.0, 69.0, 157.0, 181.0, 184.0, 79.0, 147.0, 121.0, 36.0, 98.0, 163.0, 131.0, 66.0, 71.0, -247.0, 145.0, 164.0, 148.0, -68.0, 175.0, 25.0, 196.0, -16.0, 150.0, -14.0, -59.0, -165.0, 129.0, 164.0, 174.0, 175.0, 150.0, -11.0, 75.0, -90.0, 174.0, 142.0, 13.0, 132.0, -11.0, 161.0, 115.0, -67.0, 14.0, 180.0, 99.0, -4.0, 73.0, 100.0, 120.0, 130.0, 159.0, 58.0, 137.0, 149.0, 91.0, 182.0, 173.0, 83.0, 147.0, -91.0, 110.0, 39.0, 85.0, -8.0, 116.0, 43.0, 92.0, 27.0, 87.0, 96.0, 116.0, 156.0, 100.0, -105.0, 154.0, 61.0, 70.0, 140.0, -100.0, 121.0, 2.0, 119.0, 47.0, 138.0, 173.0, -128.0, 145.0, 131.0, 171.0, 179.0, 84.0, 164.0, 94.0, -11.0, 146.0, 147.0, 153.0, 136.0, 46.0, -63.0, 49.0, 141.0, 16.0, 13.0, -20.0, 58.0, 145.0, 107.0, 151.0, -103.0, 28.0, 154.0, 156.0, 163.0, 112.0, 142.0, 75.0, -21.0, -23.0, 80.0, 174.0, 180.0], "policy_predator_policy_reward": [16.0, 66.0, 0.0, 0.0, 23.0, 12.0, 36.0, 42.0, 43.0, 6.0, 0.0, 0.0, 20.0, 0.0, 0.0, 22.0, 2.0, 1.0, 2.0, 2.0, 21.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 26.0, 0.0, 34.0, 62.0, 69.0, 4.0, 0.0, 48.0, 0.0, 0.0, 1.0, 62.0, 62.0, 71.0, 66.0, 37.0, 47.0, 0.0, 0.0, 0.0, 0.0, 17.0, 17.0, 0.0, 0.0, 0.0, 21.0, 22.0, 18.0, 115.0, 68.0, 43.0, 37.0, 0.0, 0.0, 39.0, 0.0, 55.0, 56.0, 0.0, 43.0, 122.0, 124.0, 40.0, 42.0, 0.0, 11.0, 65.0, 3.0, 29.0, 75.0, 7.0, 10.0, 0.0, 0.0, 3.0, 40.0, 30.0, 30.0, 0.0, 23.0, 0.0, 30.0, 146.0, 24.0, 0.0, 15.0, 77.0, 65.0, 0.0, 0.0, 0.0, 59.0, 49.0, 0.0, 131.0, 125.0, 0.0, 0.0, 0.0, 0.0, 33.0, 52.0, 0.0, 98.0, 0.0, 0.0, 45.0, 44.0, 45.0, 0.0, 67.0, 62.0, 29.0, 0.0, 15.0, 45.0, 32.0, 34.0, 0.0, 0.0, 16.0, 19.0, 15.0, 0.0, 27.0, 3.0, 27.0, 30.0, 67.0, 0.0, 27.0, 0.0, 7.0, 0.0, 19.0, 0.0, 33.0, 46.0, 0.0, 0.0, 0.0, 4.0, 91.0, 13.0, 31.0, 0.0, 19.0, 2.0, 83.0, 51.0, 34.0, 16.0, 44.0, 0.0, 91.0, 78.0, 0.0, 6.0, 0.0, 4.0, 5.0, 2.0, 42.0, 65.0, 0.0, 0.0, 12.0, 0.0, 79.0, 0.0, 0.0, 0.0, 34.0, 33.0, 66.0, 0.0, 8.0, 1.0, 85.0, 52.0, 0.0, 40.0, 5.0, 0.0, 0.0, 0.0, 6.0, 52.0, 70.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.742457514800638, "mean_inference_ms": 17.114030354054286, "mean_action_processing_ms": 0.8028268573764376, "mean_env_wait_ms": 2.578509531512413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01522207260131836, "StateBufferConnector_ms": 0.004042148590087891, "ViewRequirementAgentConnector_ms": 0.2752091884613037}, "num_episodes": 18, "episode_return_max": 365.0, "episode_return_min": -18.0, "episode_return_mean": 226.29, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 205.3740218954019, "num_env_steps_trained_throughput_per_sec": 205.3740218954019, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 300144.719, "restore_workers_time_ms": 0.059, "training_step_time_ms": 300144.596, "sample_time_ms": 4567.157, "learn_time_ms": 295519.553, "learn_throughput": 13.535, "synch_weights_time_ms": 48.282}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 135, "trial_id": "45bed_00000", "date": "2024-08-13_04-45-23", "timestamp": 1723538723, "time_this_iter_s": 19.53837513923645, "time_total_s": 12903.41604590416, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b528fd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12903.41604590416, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 81.32142857142857, "ram_util_percent": 83.26071428571426}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4188253705306029, "cur_kl_coeff": 6.938893903907229e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6450359829834529, "policy_loss": -0.0015058747784692853, "vf_loss": 1.6465418520427886, "vf_explained_var": 0.0008066836488309991, "kl": 0.0015961383205532237, "entropy": 0.11800368106554425, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 256095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.453530413763863, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.816523109668147, "policy_loss": -0.0040855045504276715, "vf_loss": 6.820608607801811, "vf_explained_var": 0.549308572212855, "kl": 0.015561309248967838, "entropy": 1.2213402757568965, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 256095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000}, "env_runners": {"episode_reward_max": 365.0, "episode_reward_min": -18.0, "episode_reward_mean": 222.29, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -247.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 146.0}, "policy_reward_mean": {"prey_policy": 84.715, "predator_policy": 26.43}, "custom_metrics": {}, "hist_stats": {"episode_reward": [304.0, 235.0, 216.0, 127.0, 365.0, 266.0, 306.0, 234.0, 325.0, 303.0, -18.0, 290.0, 248.0, 292.0, 278.0, 200.0, 55.0, 300.0, 337.0, 135.0, 208.0, 243.0, 365.0, 269.0, 217.0, 284.0, 227.0, -6.0, 324.0, 222.0, 200.0, 239.0, 185.0, 32.0, 293.0, 349.0, 224.0, 83.0, 316.0, 234.0, 195.0, 177.0, 223.0, 155.0, 239.0, 250.0, 252.0, 301.0, 303.0, 313.0, 123.0, 176.0, 84.0, 178.0, 198.0, 183.0, 276.0, 99.0, 246.0, 231.0, 155.0, 171.0, 229.0, 214.0, 282.0, 354.0, 255.0, 190.0, 293.0, 301.0, 62.0, 190.0, 96.0, 104.0, 261.0, 185.0, 222.0, 324.0, 254.0, 112.0, 127.0, 354.0, 355.0, 148.0, 249.0, 246.0, 216.0, 263.0, 66.0, 95.0, 113.0, 299.0, 145.0, 321.0, 209.0, 177.0, 250.0, 336.0, 246.0, 252.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [141.0, 162.0, -30.0, 141.0, 69.0, 10.0, -25.0, 68.0, 177.0, 188.0, 103.0, 163.0, 157.0, 115.0, 125.0, 109.0, 186.0, 118.0, 163.0, 100.0, -190.0, -11.0, 149.0, 61.0, 100.0, 148.0, 174.0, 79.0, -2.0, 169.0, 8.0, 149.0, -134.0, -57.0, 180.0, 38.0, 183.0, 143.0, 124.0, -57.0, 95.0, 9.0, 69.0, 157.0, 181.0, 184.0, 79.0, 147.0, 121.0, 36.0, 98.0, 163.0, 131.0, 66.0, 71.0, -247.0, 145.0, 164.0, 148.0, -68.0, 175.0, 25.0, 196.0, -16.0, 150.0, -14.0, -59.0, -165.0, 129.0, 164.0, 174.0, 175.0, 150.0, -11.0, 75.0, -90.0, 174.0, 142.0, 13.0, 132.0, -11.0, 161.0, 115.0, -67.0, 14.0, 180.0, 99.0, -4.0, 73.0, 100.0, 120.0, 130.0, 159.0, 58.0, 137.0, 149.0, 91.0, 182.0, 173.0, 83.0, 147.0, -91.0, 110.0, 39.0, 85.0, -8.0, 116.0, 43.0, 92.0, 27.0, 87.0, 96.0, 116.0, 156.0, 100.0, -105.0, 154.0, 61.0, 70.0, 140.0, -100.0, 121.0, 2.0, 119.0, 47.0, 138.0, 173.0, -128.0, 145.0, 131.0, 171.0, 179.0, 84.0, 164.0, 94.0, -11.0, 146.0, 147.0, 153.0, 136.0, 46.0, -63.0, 49.0, 141.0, 16.0, 13.0, -20.0, 58.0, 145.0, 107.0, 151.0, -103.0, 28.0, 154.0, 156.0, 163.0, 112.0, 142.0, 75.0, -21.0, -23.0, 80.0, 174.0, 180.0, 178.0, 165.0, 139.0, -12.0, 66.0, 140.0, 167.0, 26.0, 12.0, 114.0, 138.0, 105.0, 0.0, -25.0, -4.0, -8.0, 43.0, 20.0, 167.0, 102.0, 157.0, -63.0, 138.0, 160.0, 132.0, 42.0, 48.0, 87.0, 3.0, 163.0, 161.0, 175.0, 63.0, 144.0, -9.0, 199.0], "policy_predator_policy_reward": [0.0, 1.0, 62.0, 62.0, 71.0, 66.0, 37.0, 47.0, 0.0, 0.0, 0.0, 0.0, 17.0, 17.0, 0.0, 0.0, 0.0, 21.0, 22.0, 18.0, 115.0, 68.0, 43.0, 37.0, 0.0, 0.0, 39.0, 0.0, 55.0, 56.0, 0.0, 43.0, 122.0, 124.0, 40.0, 42.0, 0.0, 11.0, 65.0, 3.0, 29.0, 75.0, 7.0, 10.0, 0.0, 0.0, 3.0, 40.0, 30.0, 30.0, 0.0, 23.0, 0.0, 30.0, 146.0, 24.0, 0.0, 15.0, 77.0, 65.0, 0.0, 0.0, 0.0, 59.0, 49.0, 0.0, 131.0, 125.0, 0.0, 0.0, 0.0, 0.0, 33.0, 52.0, 0.0, 98.0, 0.0, 0.0, 45.0, 44.0, 45.0, 0.0, 67.0, 62.0, 29.0, 0.0, 15.0, 45.0, 32.0, 34.0, 0.0, 0.0, 16.0, 19.0, 15.0, 0.0, 27.0, 3.0, 27.0, 30.0, 67.0, 0.0, 27.0, 0.0, 7.0, 0.0, 19.0, 0.0, 33.0, 46.0, 0.0, 0.0, 0.0, 4.0, 91.0, 13.0, 31.0, 0.0, 19.0, 2.0, 83.0, 51.0, 34.0, 16.0, 44.0, 0.0, 91.0, 78.0, 0.0, 6.0, 0.0, 4.0, 5.0, 2.0, 42.0, 65.0, 0.0, 0.0, 12.0, 0.0, 79.0, 0.0, 0.0, 0.0, 34.0, 33.0, 66.0, 0.0, 8.0, 1.0, 85.0, 52.0, 0.0, 40.0, 5.0, 0.0, 0.0, 0.0, 6.0, 52.0, 70.0, 0.0, 0.0, 0.0, 5.0, 7.0, 0.0, 21.0, 0.0, 43.0, 53.0, 0.0, 45.0, 45.0, 20.0, 0.0, 65.0, 26.0, 40.0, 67.0, 43.0, 7.0, 0.0, 30.0, 0.0, 51.0, 0.0, 23.0, 34.0, 1.0, 21.0, 21.0, 42.0, 42.0, 0.0, 0.0, 0.0, 39.0, 0.0, 62.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.713388305077334, "mean_inference_ms": 17.02676924868018, "mean_action_processing_ms": 0.8012795842746588, "mean_env_wait_ms": 2.564298142882564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015685558319091797, "StateBufferConnector_ms": 0.004099249839782715, "ViewRequirementAgentConnector_ms": 0.25279438495635986}, "num_episodes": 18, "episode_return_max": 365.0, "episode_return_min": -18.0, "episode_return_mean": 222.29, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.71721484676235, "num_env_steps_trained_throughput_per_sec": 207.71721484676235, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 2176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2176000, "timers": {"training_iteration_time_ms": 205868.29, "restore_workers_time_ms": 0.059, "training_step_time_ms": 205868.167, "sample_time_ms": 4493.735, "learn_time_ms": 201319.302, "learn_throughput": 19.869, "synch_weights_time_ms": 45.283}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000}, "done": false, "training_iteration": 136, "trial_id": "45bed_00000", "date": "2024-08-13_04-45-43", "timestamp": 1723538743, "time_this_iter_s": 19.32522416114807, "time_total_s": 12922.741270065308, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b528ff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12922.741270065308, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 79.90740740740742, "ram_util_percent": 83.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5999424534421118, "cur_kl_coeff": 3.4694469519536144e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7739808736654816, "policy_loss": -0.0012025184589364226, "vf_loss": 1.7751833946301192, "vf_explained_var": 0.004550639157572751, "kl": 0.001605243023218624, "entropy": 0.08218174896464146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 257985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.271305029417471, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.5965390954698835, "policy_loss": -0.0036997150830559867, "vf_loss": 6.600238799291944, "vf_explained_var": 0.45404939799712446, "kl": 0.01351520077770008, "entropy": 1.132509323907277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 257985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 2192000}, "env_runners": {"episode_reward_max": 362.0, "episode_reward_min": -6.0, "episode_reward_mean": 221.09, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -247.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 146.0}, "policy_reward_mean": {"prey_policy": 87.07, "predator_policy": 23.475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [269.0, 217.0, 284.0, 227.0, -6.0, 324.0, 222.0, 200.0, 239.0, 185.0, 32.0, 293.0, 349.0, 224.0, 83.0, 316.0, 234.0, 195.0, 177.0, 223.0, 155.0, 239.0, 250.0, 252.0, 301.0, 303.0, 313.0, 123.0, 176.0, 84.0, 178.0, 198.0, 183.0, 276.0, 99.0, 246.0, 231.0, 155.0, 171.0, 229.0, 214.0, 282.0, 354.0, 255.0, 190.0, 293.0, 301.0, 62.0, 190.0, 96.0, 104.0, 261.0, 185.0, 222.0, 324.0, 254.0, 112.0, 127.0, 354.0, 355.0, 148.0, 249.0, 246.0, 216.0, 263.0, 66.0, 95.0, 113.0, 299.0, 145.0, 321.0, 209.0, 177.0, 250.0, 336.0, 246.0, 252.0, 282.0, 191.0, 191.0, 246.0, 41.0, 283.0, 323.0, 282.0, 270.0, 174.0, 268.0, 0.0, 200.0, 290.0, 192.0, 362.0, 319.0, 155.0, 249.0, 345.0, 257.0, 259.0, 315.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [79.0, 147.0, 121.0, 36.0, 98.0, 163.0, 131.0, 66.0, 71.0, -247.0, 145.0, 164.0, 148.0, -68.0, 175.0, 25.0, 196.0, -16.0, 150.0, -14.0, -59.0, -165.0, 129.0, 164.0, 174.0, 175.0, 150.0, -11.0, 75.0, -90.0, 174.0, 142.0, 13.0, 132.0, -11.0, 161.0, 115.0, -67.0, 14.0, 180.0, 99.0, -4.0, 73.0, 100.0, 120.0, 130.0, 159.0, 58.0, 137.0, 149.0, 91.0, 182.0, 173.0, 83.0, 147.0, -91.0, 110.0, 39.0, 85.0, -8.0, 116.0, 43.0, 92.0, 27.0, 87.0, 96.0, 116.0, 156.0, 100.0, -105.0, 154.0, 61.0, 70.0, 140.0, -100.0, 121.0, 2.0, 119.0, 47.0, 138.0, 173.0, -128.0, 145.0, 131.0, 171.0, 179.0, 84.0, 164.0, 94.0, -11.0, 146.0, 147.0, 153.0, 136.0, 46.0, -63.0, 49.0, 141.0, 16.0, 13.0, -20.0, 58.0, 145.0, 107.0, 151.0, -103.0, 28.0, 154.0, 156.0, 163.0, 112.0, 142.0, 75.0, -21.0, -23.0, 80.0, 174.0, 180.0, 178.0, 165.0, 139.0, -12.0, 66.0, 140.0, 167.0, 26.0, 12.0, 114.0, 138.0, 105.0, 0.0, -25.0, -4.0, -8.0, 43.0, 20.0, 167.0, 102.0, 157.0, -63.0, 138.0, 160.0, 132.0, 42.0, 48.0, 87.0, 3.0, 163.0, 161.0, 175.0, 63.0, 144.0, -9.0, 199.0, 140.0, 115.0, 168.0, 4.0, 63.0, 63.0, 47.0, 172.0, -85.0, -101.0, 63.0, 184.0, 179.0, 135.0, 95.0, 154.0, 188.0, -9.0, 7.0, 116.0, 163.0, 88.0, 0.0, 0.0, 51.0, 109.0, 141.0, 143.0, 30.0, 162.0, 166.0, 190.0, 164.0, 155.0, 105.0, -20.0, 91.0, 98.0, 177.0, 167.0, 129.0, 99.0, 45.0, 194.0, 183.0, 132.0], "policy_predator_policy_reward": [3.0, 40.0, 30.0, 30.0, 0.0, 23.0, 0.0, 30.0, 146.0, 24.0, 0.0, 15.0, 77.0, 65.0, 0.0, 0.0, 0.0, 59.0, 49.0, 0.0, 131.0, 125.0, 0.0, 0.0, 0.0, 0.0, 33.0, 52.0, 0.0, 98.0, 0.0, 0.0, 45.0, 44.0, 45.0, 0.0, 67.0, 62.0, 29.0, 0.0, 15.0, 45.0, 32.0, 34.0, 0.0, 0.0, 16.0, 19.0, 15.0, 0.0, 27.0, 3.0, 27.0, 30.0, 67.0, 0.0, 27.0, 0.0, 7.0, 0.0, 19.0, 0.0, 33.0, 46.0, 0.0, 0.0, 0.0, 4.0, 91.0, 13.0, 31.0, 0.0, 19.0, 2.0, 83.0, 51.0, 34.0, 16.0, 44.0, 0.0, 91.0, 78.0, 0.0, 6.0, 0.0, 4.0, 5.0, 2.0, 42.0, 65.0, 0.0, 0.0, 12.0, 0.0, 79.0, 0.0, 0.0, 0.0, 34.0, 33.0, 66.0, 0.0, 8.0, 1.0, 85.0, 52.0, 0.0, 40.0, 5.0, 0.0, 0.0, 0.0, 6.0, 52.0, 70.0, 0.0, 0.0, 0.0, 5.0, 7.0, 0.0, 21.0, 0.0, 43.0, 53.0, 0.0, 45.0, 45.0, 20.0, 0.0, 65.0, 26.0, 40.0, 67.0, 43.0, 7.0, 0.0, 30.0, 0.0, 51.0, 0.0, 23.0, 34.0, 1.0, 21.0, 21.0, 42.0, 42.0, 0.0, 0.0, 0.0, 39.0, 0.0, 62.0, 5.0, 22.0, 17.0, 2.0, 32.0, 33.0, 27.0, 0.0, 115.0, 112.0, 36.0, 0.0, 6.0, 3.0, 10.0, 23.0, 38.0, 53.0, 51.0, 0.0, 2.0, 15.0, 0.0, 0.0, 0.0, 40.0, 2.0, 4.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 68.0, 2.0, 24.0, 36.0, 0.0, 1.0, 14.0, 15.0, 0.0, 20.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.670575601181184, "mean_inference_ms": 16.917716443938264, "mean_action_processing_ms": 0.7990459966747459, "mean_env_wait_ms": 2.5498189264075806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01700294017791748, "StateBufferConnector_ms": 0.005070209503173828, "ViewRequirementAgentConnector_ms": 0.23598003387451172}, "num_episodes": 23, "episode_return_max": 362.0, "episode_return_min": -6.0, "episode_return_mean": 221.09, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 2192000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.9613800971363227, "num_env_steps_trained_throughput_per_sec": 3.9613800971363227, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 2192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2192000, "timers": {"training_iteration_time_ms": 213440.44, "restore_workers_time_ms": 0.039, "training_step_time_ms": 213440.338, "sample_time_ms": 4441.034, "learn_time_ms": 208944.766, "learn_throughput": 19.144, "synch_weights_time_ms": 45.756}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 2192000}, "done": false, "training_iteration": 137, "trial_id": "45bed_00000", "date": "2024-08-13_05-02-33", "timestamp": 1723539753, "time_this_iter_s": 1010.0801846981049, "time_total_s": 13932.821454763412, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b528f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13932.821454763412, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 86.24, "ram_util_percent": 83.14}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5217743521093061, "cur_kl_coeff": 1.7347234759768072e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.974612477847508, "policy_loss": -0.001553189760522434, "vf_loss": 1.9761656701880157, "vf_explained_var": 0.00979824217538985, "kl": 0.002010639372651693, "entropy": 0.09457705155527465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 259875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.481683457181568, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.663012687995951, "policy_loss": -0.005442596973959731, "vf_loss": 6.668455290163635, "vf_explained_var": 0.15705259625243131, "kl": 0.017085288520588836, "entropy": 1.2217266836494365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 259875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "env_runners": {"episode_reward_max": 362.0, "episode_reward_min": 0.0, "episode_reward_mean": 230.37, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -128.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 115.0}, "policy_reward_mean": {"prey_policy": 94.76, "predator_policy": 20.425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [250.0, 252.0, 301.0, 303.0, 313.0, 123.0, 176.0, 84.0, 178.0, 198.0, 183.0, 276.0, 99.0, 246.0, 231.0, 155.0, 171.0, 229.0, 214.0, 282.0, 354.0, 255.0, 190.0, 293.0, 301.0, 62.0, 190.0, 96.0, 104.0, 261.0, 185.0, 222.0, 324.0, 254.0, 112.0, 127.0, 354.0, 355.0, 148.0, 249.0, 246.0, 216.0, 263.0, 66.0, 95.0, 113.0, 299.0, 145.0, 321.0, 209.0, 177.0, 250.0, 336.0, 246.0, 252.0, 282.0, 191.0, 191.0, 246.0, 41.0, 283.0, 323.0, 282.0, 270.0, 174.0, 268.0, 0.0, 200.0, 290.0, 192.0, 362.0, 319.0, 155.0, 249.0, 345.0, 257.0, 259.0, 315.0, 193.0, 286.0, 212.0, 316.0, 214.0, 237.0, 212.0, 208.0, 306.0, 330.0, 181.0, 256.0, 262.0, 228.0, 290.0, 203.0, 151.0, 350.0, 353.0, 256.0, 343.0, 222.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [120.0, 130.0, 159.0, 58.0, 137.0, 149.0, 91.0, 182.0, 173.0, 83.0, 147.0, -91.0, 110.0, 39.0, 85.0, -8.0, 116.0, 43.0, 92.0, 27.0, 87.0, 96.0, 116.0, 156.0, 100.0, -105.0, 154.0, 61.0, 70.0, 140.0, -100.0, 121.0, 2.0, 119.0, 47.0, 138.0, 173.0, -128.0, 145.0, 131.0, 171.0, 179.0, 84.0, 164.0, 94.0, -11.0, 146.0, 147.0, 153.0, 136.0, 46.0, -63.0, 49.0, 141.0, 16.0, 13.0, -20.0, 58.0, 145.0, 107.0, 151.0, -103.0, 28.0, 154.0, 156.0, 163.0, 112.0, 142.0, 75.0, -21.0, -23.0, 80.0, 174.0, 180.0, 178.0, 165.0, 139.0, -12.0, 66.0, 140.0, 167.0, 26.0, 12.0, 114.0, 138.0, 105.0, 0.0, -25.0, -4.0, -8.0, 43.0, 20.0, 167.0, 102.0, 157.0, -63.0, 138.0, 160.0, 132.0, 42.0, 48.0, 87.0, 3.0, 163.0, 161.0, 175.0, 63.0, 144.0, -9.0, 199.0, 140.0, 115.0, 168.0, 4.0, 63.0, 63.0, 47.0, 172.0, -85.0, -101.0, 63.0, 184.0, 179.0, 135.0, 95.0, 154.0, 188.0, -9.0, 7.0, 116.0, 163.0, 88.0, 0.0, 0.0, 51.0, 109.0, 141.0, 143.0, 30.0, 162.0, 166.0, 190.0, 164.0, 155.0, 105.0, -20.0, 91.0, 98.0, 177.0, 167.0, 129.0, 99.0, 45.0, 194.0, 183.0, 132.0, -65.0, 177.0, 182.0, 91.0, -23.0, 169.0, 158.0, 158.0, 86.0, 104.0, 77.0, 128.0, -111.0, 173.0, 97.0, 47.0, 138.0, 138.0, 157.0, 172.0, 131.0, -38.0, 117.0, 139.0, 155.0, 92.0, 133.0, 66.0, 133.0, 157.0, -19.0, 165.0, 58.0, 1.0, 168.0, 172.0, 195.0, 158.0, 126.0, 99.0, 179.0, 164.0, 172.0, -5.0], "policy_predator_policy_reward": [0.0, 0.0, 16.0, 19.0, 15.0, 0.0, 27.0, 3.0, 27.0, 30.0, 67.0, 0.0, 27.0, 0.0, 7.0, 0.0, 19.0, 0.0, 33.0, 46.0, 0.0, 0.0, 0.0, 4.0, 91.0, 13.0, 31.0, 0.0, 19.0, 2.0, 83.0, 51.0, 34.0, 16.0, 44.0, 0.0, 91.0, 78.0, 0.0, 6.0, 0.0, 4.0, 5.0, 2.0, 42.0, 65.0, 0.0, 0.0, 12.0, 0.0, 79.0, 0.0, 0.0, 0.0, 34.0, 33.0, 66.0, 0.0, 8.0, 1.0, 85.0, 52.0, 0.0, 40.0, 5.0, 0.0, 0.0, 0.0, 6.0, 52.0, 70.0, 0.0, 0.0, 0.0, 5.0, 7.0, 0.0, 21.0, 0.0, 43.0, 53.0, 0.0, 45.0, 45.0, 20.0, 0.0, 65.0, 26.0, 40.0, 67.0, 43.0, 7.0, 0.0, 30.0, 0.0, 51.0, 0.0, 23.0, 34.0, 1.0, 21.0, 21.0, 42.0, 42.0, 0.0, 0.0, 0.0, 39.0, 0.0, 62.0, 5.0, 22.0, 17.0, 2.0, 32.0, 33.0, 27.0, 0.0, 115.0, 112.0, 36.0, 0.0, 6.0, 3.0, 10.0, 23.0, 38.0, 53.0, 51.0, 0.0, 2.0, 15.0, 0.0, 0.0, 0.0, 40.0, 2.0, 4.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 68.0, 2.0, 24.0, 36.0, 0.0, 1.0, 14.0, 15.0, 0.0, 20.0, 0.0, 0.0, 26.0, 55.0, 0.0, 13.0, 0.0, 66.0, 0.0, 0.0, 3.0, 21.0, 24.0, 8.0, 64.0, 86.0, 21.0, 43.0, 19.0, 11.0, 0.0, 1.0, 56.0, 32.0, 0.0, 0.0, 15.0, 0.0, 17.0, 12.0, 0.0, 0.0, 57.0, 0.0, 36.0, 56.0, 1.0, 9.0, 0.0, 0.0, 3.0, 28.0, 0.0, 0.0, 0.0, 55.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.6400587651939444, "mean_inference_ms": 16.63996221979583, "mean_action_processing_ms": 0.7972531760202017, "mean_env_wait_ms": 2.7050881590263804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013007044792175293, "StateBufferConnector_ms": 0.0051544904708862305, "ViewRequirementAgentConnector_ms": 0.24122321605682373}, "num_episodes": 22, "episode_return_max": 362.0, "episode_return_min": 0.0, "episode_return_mean": 230.37, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 200.6587219178732, "num_env_steps_trained_throughput_per_sec": 200.6587219178732, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 2208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2208000, "timers": {"training_iteration_time_ms": 212999.742, "restore_workers_time_ms": 0.027, "training_step_time_ms": 212999.654, "sample_time_ms": 3904.227, "learn_time_ms": 209041.34, "learn_throughput": 19.135, "synch_weights_time_ms": 44.922}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "done": false, "training_iteration": 138, "trial_id": "45bed_00000", "date": "2024-08-13_05-02-53", "timestamp": 1723539773, "time_this_iter_s": 19.988368272781372, "time_total_s": 13952.809823036194, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b527f940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13952.809823036194, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 88.52142857142857, "ram_util_percent": 83.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2513875451589387, "cur_kl_coeff": 8.673617379884036e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.926827787154566, "policy_loss": -0.0016023121450204777, "vf_loss": 1.9284300923662843, "vf_explained_var": 0.004654659291423818, "kl": 0.001776465540637118, "entropy": 0.09158137985579078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 261765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.186544542432462, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.5332091545932505, "policy_loss": 0.000676782963127292, "vf_loss": 6.532532387940341, "vf_explained_var": 0.14281430685961688, "kl": 0.01294799418402536, "entropy": 1.171723252187961, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 261765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 2224000}, "env_runners": {"episode_reward_max": 362.0, "episode_reward_min": 0.0, "episode_reward_mean": 242.92, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -128.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 115.0}, "policy_reward_mean": {"prey_policy": 101.365, "predator_policy": 20.095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [214.0, 282.0, 354.0, 255.0, 190.0, 293.0, 301.0, 62.0, 190.0, 96.0, 104.0, 261.0, 185.0, 222.0, 324.0, 254.0, 112.0, 127.0, 354.0, 355.0, 148.0, 249.0, 246.0, 216.0, 263.0, 66.0, 95.0, 113.0, 299.0, 145.0, 321.0, 209.0, 177.0, 250.0, 336.0, 246.0, 252.0, 282.0, 191.0, 191.0, 246.0, 41.0, 283.0, 323.0, 282.0, 270.0, 174.0, 268.0, 0.0, 200.0, 290.0, 192.0, 362.0, 319.0, 155.0, 249.0, 345.0, 257.0, 259.0, 315.0, 193.0, 286.0, 212.0, 316.0, 214.0, 237.0, 212.0, 208.0, 306.0, 330.0, 181.0, 256.0, 262.0, 228.0, 290.0, 203.0, 151.0, 350.0, 353.0, 256.0, 343.0, 222.0, 340.0, 284.0, 317.0, 302.0, 261.0, 328.0, 296.0, 278.0, 282.0, 340.0, 311.0, 72.0, 291.0, 183.0, 313.0, 267.0, 264.0, 294.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [173.0, -128.0, 145.0, 131.0, 171.0, 179.0, 84.0, 164.0, 94.0, -11.0, 146.0, 147.0, 153.0, 136.0, 46.0, -63.0, 49.0, 141.0, 16.0, 13.0, -20.0, 58.0, 145.0, 107.0, 151.0, -103.0, 28.0, 154.0, 156.0, 163.0, 112.0, 142.0, 75.0, -21.0, -23.0, 80.0, 174.0, 180.0, 178.0, 165.0, 139.0, -12.0, 66.0, 140.0, 167.0, 26.0, 12.0, 114.0, 138.0, 105.0, 0.0, -25.0, -4.0, -8.0, 43.0, 20.0, 167.0, 102.0, 157.0, -63.0, 138.0, 160.0, 132.0, 42.0, 48.0, 87.0, 3.0, 163.0, 161.0, 175.0, 63.0, 144.0, -9.0, 199.0, 140.0, 115.0, 168.0, 4.0, 63.0, 63.0, 47.0, 172.0, -85.0, -101.0, 63.0, 184.0, 179.0, 135.0, 95.0, 154.0, 188.0, -9.0, 7.0, 116.0, 163.0, 88.0, 0.0, 0.0, 51.0, 109.0, 141.0, 143.0, 30.0, 162.0, 166.0, 190.0, 164.0, 155.0, 105.0, -20.0, 91.0, 98.0, 177.0, 167.0, 129.0, 99.0, 45.0, 194.0, 183.0, 132.0, -65.0, 177.0, 182.0, 91.0, -23.0, 169.0, 158.0, 158.0, 86.0, 104.0, 77.0, 128.0, -111.0, 173.0, 97.0, 47.0, 138.0, 138.0, 157.0, 172.0, 131.0, -38.0, 117.0, 139.0, 155.0, 92.0, 133.0, 66.0, 133.0, 157.0, -19.0, 165.0, 58.0, 1.0, 168.0, 172.0, 195.0, 158.0, 126.0, 99.0, 179.0, 164.0, 172.0, -5.0, 177.0, 150.0, 141.0, 91.0, 186.0, 111.0, 137.0, 156.0, 4.0, 139.0, 132.0, 184.0, 157.0, 132.0, 80.0, 182.0, 135.0, 147.0, 179.0, 161.0, 165.0, 140.0, -86.0, 33.0, 144.0, 135.0, -63.0, 161.0, 150.0, 163.0, 165.0, 18.0, 43.0, 172.0, 82.0, 162.0], "policy_predator_policy_reward": [91.0, 78.0, 0.0, 6.0, 0.0, 4.0, 5.0, 2.0, 42.0, 65.0, 0.0, 0.0, 12.0, 0.0, 79.0, 0.0, 0.0, 0.0, 34.0, 33.0, 66.0, 0.0, 8.0, 1.0, 85.0, 52.0, 0.0, 40.0, 5.0, 0.0, 0.0, 0.0, 6.0, 52.0, 70.0, 0.0, 0.0, 0.0, 5.0, 7.0, 0.0, 21.0, 0.0, 43.0, 53.0, 0.0, 45.0, 45.0, 20.0, 0.0, 65.0, 26.0, 40.0, 67.0, 43.0, 7.0, 0.0, 30.0, 0.0, 51.0, 0.0, 23.0, 34.0, 1.0, 21.0, 21.0, 42.0, 42.0, 0.0, 0.0, 0.0, 39.0, 0.0, 62.0, 5.0, 22.0, 17.0, 2.0, 32.0, 33.0, 27.0, 0.0, 115.0, 112.0, 36.0, 0.0, 6.0, 3.0, 10.0, 23.0, 38.0, 53.0, 51.0, 0.0, 2.0, 15.0, 0.0, 0.0, 0.0, 40.0, 2.0, 4.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 68.0, 2.0, 24.0, 36.0, 0.0, 1.0, 14.0, 15.0, 0.0, 20.0, 0.0, 0.0, 26.0, 55.0, 0.0, 13.0, 0.0, 66.0, 0.0, 0.0, 3.0, 21.0, 24.0, 8.0, 64.0, 86.0, 21.0, 43.0, 19.0, 11.0, 0.0, 1.0, 56.0, 32.0, 0.0, 0.0, 15.0, 0.0, 17.0, 12.0, 0.0, 0.0, 57.0, 0.0, 36.0, 56.0, 1.0, 9.0, 0.0, 0.0, 3.0, 28.0, 0.0, 0.0, 0.0, 55.0, 1.0, 12.0, 23.0, 29.0, 20.0, 0.0, 9.0, 0.0, 61.0, 57.0, 0.0, 12.0, 7.0, 0.0, 1.0, 15.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 48.0, 77.0, 0.0, 12.0, 85.0, 0.0, 0.0, 0.0, 34.0, 50.0, 28.0, 21.0, 25.0, 25.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.610561154968779, "mean_inference_ms": 16.72562232032412, "mean_action_processing_ms": 0.7949256028856979, "mean_env_wait_ms": 2.5162503691912623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011922240257263184, "StateBufferConnector_ms": 0.005093932151794434, "ViewRequirementAgentConnector_ms": 0.1919867992401123}, "num_episodes": 18, "episode_return_max": 362.0, "episode_return_min": 0.0, "episode_return_mean": 242.92, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 2224000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 203.94083946545894, "num_env_steps_trained_throughput_per_sec": 203.94083946545894, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 2224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2224000, "timers": {"training_iteration_time_ms": 118844.829, "restore_workers_time_ms": 0.023, "training_step_time_ms": 118844.75, "sample_time_ms": 3641.092, "learn_time_ms": 115158.778, "learn_throughput": 34.735, "synch_weights_time_ms": 37.694}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 2224000}, "done": false, "training_iteration": 139, "trial_id": "45bed_00000", "date": "2024-08-13_05-03-13", "timestamp": 1723539793, "time_this_iter_s": 19.712305784225464, "time_total_s": 13972.52212882042, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b526a790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13972.52212882042, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 86.40714285714284, "ram_util_percent": 82.9392857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3977866114447357, "cur_kl_coeff": 4.336808689942018e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.867846910411088, "policy_loss": -0.0017062984904638989, "vf_loss": 1.8695532101802725, "vf_explained_var": -5.037535435308224e-05, "kl": 0.0013936511750438439, "entropy": 0.09669114155152803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 263655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.1589735324736, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.815591338324168, "policy_loss": -0.003983909383209215, "vf_loss": 6.819575252734795, "vf_explained_var": 0.15876749905328902, "kl": 0.009705730386610807, "entropy": 1.2182089987255278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 263655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "env_runners": {"episode_reward_max": 362.0, "episode_reward_min": 0.0, "episode_reward_mean": 249.94, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -111.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 115.0}, "policy_reward_mean": {"prey_policy": 105.595, "predator_policy": 19.375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.0, 355.0, 148.0, 249.0, 246.0, 216.0, 263.0, 66.0, 95.0, 113.0, 299.0, 145.0, 321.0, 209.0, 177.0, 250.0, 336.0, 246.0, 252.0, 282.0, 191.0, 191.0, 246.0, 41.0, 283.0, 323.0, 282.0, 270.0, 174.0, 268.0, 0.0, 200.0, 290.0, 192.0, 362.0, 319.0, 155.0, 249.0, 345.0, 257.0, 259.0, 315.0, 193.0, 286.0, 212.0, 316.0, 214.0, 237.0, 212.0, 208.0, 306.0, 330.0, 181.0, 256.0, 262.0, 228.0, 290.0, 203.0, 151.0, 350.0, 353.0, 256.0, 343.0, 222.0, 340.0, 284.0, 317.0, 302.0, 261.0, 328.0, 296.0, 278.0, 282.0, 340.0, 311.0, 72.0, 291.0, 183.0, 313.0, 267.0, 264.0, 294.0, 273.0, 171.0, 248.0, 230.0, 289.0, 304.0, 278.0, 256.0, 250.0, 233.0, 150.0, 286.0, 295.0, 353.0, 293.0, 155.0, 292.0, 172.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [174.0, 180.0, 178.0, 165.0, 139.0, -12.0, 66.0, 140.0, 167.0, 26.0, 12.0, 114.0, 138.0, 105.0, 0.0, -25.0, -4.0, -8.0, 43.0, 20.0, 167.0, 102.0, 157.0, -63.0, 138.0, 160.0, 132.0, 42.0, 48.0, 87.0, 3.0, 163.0, 161.0, 175.0, 63.0, 144.0, -9.0, 199.0, 140.0, 115.0, 168.0, 4.0, 63.0, 63.0, 47.0, 172.0, -85.0, -101.0, 63.0, 184.0, 179.0, 135.0, 95.0, 154.0, 188.0, -9.0, 7.0, 116.0, 163.0, 88.0, 0.0, 0.0, 51.0, 109.0, 141.0, 143.0, 30.0, 162.0, 166.0, 190.0, 164.0, 155.0, 105.0, -20.0, 91.0, 98.0, 177.0, 167.0, 129.0, 99.0, 45.0, 194.0, 183.0, 132.0, -65.0, 177.0, 182.0, 91.0, -23.0, 169.0, 158.0, 158.0, 86.0, 104.0, 77.0, 128.0, -111.0, 173.0, 97.0, 47.0, 138.0, 138.0, 157.0, 172.0, 131.0, -38.0, 117.0, 139.0, 155.0, 92.0, 133.0, 66.0, 133.0, 157.0, -19.0, 165.0, 58.0, 1.0, 168.0, 172.0, 195.0, 158.0, 126.0, 99.0, 179.0, 164.0, 172.0, -5.0, 177.0, 150.0, 141.0, 91.0, 186.0, 111.0, 137.0, 156.0, 4.0, 139.0, 132.0, 184.0, 157.0, 132.0, 80.0, 182.0, 135.0, 147.0, 179.0, 161.0, 165.0, 140.0, -86.0, 33.0, 144.0, 135.0, -63.0, 161.0, 150.0, 163.0, 165.0, 18.0, 43.0, 172.0, 82.0, 162.0, 181.0, 71.0, -33.0, 166.0, 96.0, 124.0, 96.0, 68.0, 157.0, 131.0, 168.0, 53.0, 151.0, 96.0, 152.0, 94.0, 97.0, 101.0, 146.0, 63.0, 34.0, 25.0, 127.0, 159.0, 153.0, 103.0, 170.0, 183.0, 146.0, 93.0, 111.0, -32.0, 168.0, 118.0, 107.0, -7.0], "policy_predator_policy_reward": [0.0, 0.0, 5.0, 7.0, 0.0, 21.0, 0.0, 43.0, 53.0, 0.0, 45.0, 45.0, 20.0, 0.0, 65.0, 26.0, 40.0, 67.0, 43.0, 7.0, 0.0, 30.0, 0.0, 51.0, 0.0, 23.0, 34.0, 1.0, 21.0, 21.0, 42.0, 42.0, 0.0, 0.0, 0.0, 39.0, 0.0, 62.0, 5.0, 22.0, 17.0, 2.0, 32.0, 33.0, 27.0, 0.0, 115.0, 112.0, 36.0, 0.0, 6.0, 3.0, 10.0, 23.0, 38.0, 53.0, 51.0, 0.0, 2.0, 15.0, 0.0, 0.0, 0.0, 40.0, 2.0, 4.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 68.0, 2.0, 24.0, 36.0, 0.0, 1.0, 14.0, 15.0, 0.0, 20.0, 0.0, 0.0, 26.0, 55.0, 0.0, 13.0, 0.0, 66.0, 0.0, 0.0, 3.0, 21.0, 24.0, 8.0, 64.0, 86.0, 21.0, 43.0, 19.0, 11.0, 0.0, 1.0, 56.0, 32.0, 0.0, 0.0, 15.0, 0.0, 17.0, 12.0, 0.0, 0.0, 57.0, 0.0, 36.0, 56.0, 1.0, 9.0, 0.0, 0.0, 3.0, 28.0, 0.0, 0.0, 0.0, 55.0, 1.0, 12.0, 23.0, 29.0, 20.0, 0.0, 9.0, 0.0, 61.0, 57.0, 0.0, 12.0, 7.0, 0.0, 1.0, 15.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 48.0, 77.0, 0.0, 12.0, 85.0, 0.0, 0.0, 0.0, 34.0, 50.0, 28.0, 21.0, 25.0, 25.0, 4.0, 17.0, 38.0, 0.0, 28.0, 0.0, 32.0, 34.0, 0.0, 1.0, 38.0, 45.0, 23.0, 8.0, 10.0, 0.0, 31.0, 21.0, 13.0, 11.0, 55.0, 36.0, 0.0, 0.0, 20.0, 19.0, 0.0, 0.0, 23.0, 31.0, 44.0, 32.0, 0.0, 6.0, 33.0, 39.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.581455386197072, "mean_inference_ms": 16.63960052303421, "mean_action_processing_ms": 0.7928210792751063, "mean_env_wait_ms": 2.5024057166749945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012243032455444336, "StateBufferConnector_ms": 0.009515047073364258, "ViewRequirementAgentConnector_ms": 0.19897353649139404}, "num_episodes": 18, "episode_return_max": 362.0, "episode_return_min": 0.0, "episode_return_mean": 249.94, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.15348312058208, "num_env_steps_trained_throughput_per_sec": 217.15348312058208, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 2240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2240000, "timers": {"training_iteration_time_ms": 118009.541, "restore_workers_time_ms": 0.022, "training_step_time_ms": 118009.466, "sample_time_ms": 3046.53, "learn_time_ms": 114918.907, "learn_throughput": 34.807, "synch_weights_time_ms": 36.906}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "done": false, "training_iteration": 140, "trial_id": "45bed_00000", "date": "2024-08-13_05-03-31", "timestamp": 1723539811, "time_this_iter_s": 18.463520050048828, "time_total_s": 13990.985648870468, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b51f4940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13990.985648870468, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 81.68846153846154, "ram_util_percent": 83.54615384615384}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0524120604116765, "cur_kl_coeff": 2.168404344971009e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5554687643808032, "policy_loss": -0.002132920664242375, "vf_loss": 1.557601684189978, "vf_explained_var": 0.005891586958415925, "kl": 0.0011792570724297648, "entropy": 0.0665338105162379, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 265545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.936307575904504, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.49125276217385, "policy_loss": -0.007045261688017971, "vf_loss": 6.498297994603556, "vf_explained_var": 0.259496129095239, "kl": 0.013585097829345302, "entropy": 1.2277028506395047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 265545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "env_runners": {"episode_reward_max": 362.0, "episode_reward_min": 0.0, "episode_reward_mean": 258.79, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -111.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 115.0}, "policy_reward_mean": {"prey_policy": 111.455, "predator_policy": 17.94}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.0, 283.0, 323.0, 282.0, 270.0, 174.0, 268.0, 0.0, 200.0, 290.0, 192.0, 362.0, 319.0, 155.0, 249.0, 345.0, 257.0, 259.0, 315.0, 193.0, 286.0, 212.0, 316.0, 214.0, 237.0, 212.0, 208.0, 306.0, 330.0, 181.0, 256.0, 262.0, 228.0, 290.0, 203.0, 151.0, 350.0, 353.0, 256.0, 343.0, 222.0, 340.0, 284.0, 317.0, 302.0, 261.0, 328.0, 296.0, 278.0, 282.0, 340.0, 311.0, 72.0, 291.0, 183.0, 313.0, 267.0, 264.0, 294.0, 273.0, 171.0, 248.0, 230.0, 289.0, 304.0, 278.0, 256.0, 250.0, 233.0, 150.0, 286.0, 295.0, 353.0, 293.0, 155.0, 292.0, 172.0, 349.0, 313.0, 325.0, 277.0, 175.0, 317.0, 325.0, 312.0, 189.0, 304.0, 267.0, 250.0, 148.0, 329.0, 335.0, 212.0, 208.0, 307.0, 284.0, 247.0, 238.0, 254.0, 170.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-85.0, -101.0, 63.0, 184.0, 179.0, 135.0, 95.0, 154.0, 188.0, -9.0, 7.0, 116.0, 163.0, 88.0, 0.0, 0.0, 51.0, 109.0, 141.0, 143.0, 30.0, 162.0, 166.0, 190.0, 164.0, 155.0, 105.0, -20.0, 91.0, 98.0, 177.0, 167.0, 129.0, 99.0, 45.0, 194.0, 183.0, 132.0, -65.0, 177.0, 182.0, 91.0, -23.0, 169.0, 158.0, 158.0, 86.0, 104.0, 77.0, 128.0, -111.0, 173.0, 97.0, 47.0, 138.0, 138.0, 157.0, 172.0, 131.0, -38.0, 117.0, 139.0, 155.0, 92.0, 133.0, 66.0, 133.0, 157.0, -19.0, 165.0, 58.0, 1.0, 168.0, 172.0, 195.0, 158.0, 126.0, 99.0, 179.0, 164.0, 172.0, -5.0, 177.0, 150.0, 141.0, 91.0, 186.0, 111.0, 137.0, 156.0, 4.0, 139.0, 132.0, 184.0, 157.0, 132.0, 80.0, 182.0, 135.0, 147.0, 179.0, 161.0, 165.0, 140.0, -86.0, 33.0, 144.0, 135.0, -63.0, 161.0, 150.0, 163.0, 165.0, 18.0, 43.0, 172.0, 82.0, 162.0, 181.0, 71.0, -33.0, 166.0, 96.0, 124.0, 96.0, 68.0, 157.0, 131.0, 168.0, 53.0, 151.0, 96.0, 152.0, 94.0, 97.0, 101.0, 146.0, 63.0, 34.0, 25.0, 127.0, 159.0, 153.0, 103.0, 170.0, 183.0, 146.0, 93.0, 111.0, -32.0, 168.0, 118.0, 107.0, -7.0, 168.0, 181.0, 129.0, 161.0, 141.0, 177.0, 133.0, 138.0, 20.0, 123.0, 163.0, 146.0, 143.0, 182.0, 133.0, 178.0, 68.0, 57.0, 102.0, 176.0, 87.0, 148.0, 33.0, 175.0, 43.0, 70.0, 166.0, 163.0, 172.0, 163.0, 166.0, -12.0, 158.0, 34.0, 196.0, 80.0, 91.0, 152.0, 141.0, 37.0, -42.0, 164.0, 136.0, 80.0, 19.0, 92.0], "policy_predator_policy_reward": [115.0, 112.0, 36.0, 0.0, 6.0, 3.0, 10.0, 23.0, 38.0, 53.0, 51.0, 0.0, 2.0, 15.0, 0.0, 0.0, 0.0, 40.0, 2.0, 4.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 68.0, 2.0, 24.0, 36.0, 0.0, 1.0, 14.0, 15.0, 0.0, 20.0, 0.0, 0.0, 26.0, 55.0, 0.0, 13.0, 0.0, 66.0, 0.0, 0.0, 3.0, 21.0, 24.0, 8.0, 64.0, 86.0, 21.0, 43.0, 19.0, 11.0, 0.0, 1.0, 56.0, 32.0, 0.0, 0.0, 15.0, 0.0, 17.0, 12.0, 0.0, 0.0, 57.0, 0.0, 36.0, 56.0, 1.0, 9.0, 0.0, 0.0, 3.0, 28.0, 0.0, 0.0, 0.0, 55.0, 1.0, 12.0, 23.0, 29.0, 20.0, 0.0, 9.0, 0.0, 61.0, 57.0, 0.0, 12.0, 7.0, 0.0, 1.0, 15.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 48.0, 77.0, 0.0, 12.0, 85.0, 0.0, 0.0, 0.0, 34.0, 50.0, 28.0, 21.0, 25.0, 25.0, 4.0, 17.0, 38.0, 0.0, 28.0, 0.0, 32.0, 34.0, 0.0, 1.0, 38.0, 45.0, 23.0, 8.0, 10.0, 0.0, 31.0, 21.0, 13.0, 11.0, 55.0, 36.0, 0.0, 0.0, 20.0, 19.0, 0.0, 0.0, 23.0, 31.0, 44.0, 32.0, 0.0, 6.0, 33.0, 39.0, 0.0, 0.0, 23.0, 0.0, 1.0, 6.0, 6.0, 0.0, 32.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, 1.0, 64.0, 0.0, 26.0, 0.0, 21.0, 11.0, 21.0, 21.0, 9.0, 26.0, 0.0, 0.0, 0.0, 0.0, 21.0, 37.0, 16.0, 0.0, 31.0, 0.0, 29.0, 12.0, 30.0, 39.0, 53.0, 63.0, 37.0, 1.0, 0.0, 59.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.8828745654743635, "mean_inference_ms": 16.19730531316877, "mean_action_processing_ms": 0.7930709950502204, "mean_env_wait_ms": 2.489905800464298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011780381202697754, "StateBufferConnector_ms": 0.012552618980407715, "ViewRequirementAgentConnector_ms": 0.18834710121154785}, "num_episodes": 23, "episode_return_max": 362.0, "episode_return_min": 0.0, "episode_return_mean": 258.79, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 229.87496426276115, "num_env_steps_trained_throughput_per_sec": 229.87496426276115, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 2256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2256000, "timers": {"training_iteration_time_ms": 118009.526, "restore_workers_time_ms": 0.022, "training_step_time_ms": 118009.45, "sample_time_ms": 2923.875, "learn_time_ms": 115041.78, "learn_throughput": 34.77, "synch_weights_time_ms": 36.759}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "done": false, "training_iteration": 141, "trial_id": "45bed_00000", "date": "2024-08-13_05-03-49", "timestamp": 1723539829, "time_this_iter_s": 17.48385715484619, "time_total_s": 14008.469506025314, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b478ef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14008.469506025314, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 80.54799999999999, "ram_util_percent": 83.444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3474840893789575, "cur_kl_coeff": 1.0842021724855045e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2527081422074131, "policy_loss": -0.0021740657895823164, "vf_loss": 1.2548822137571516, "vf_explained_var": 0.008098522128251495, "kl": 0.0014972665030123162, "entropy": 0.09083126551378026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 267435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.42451369708808, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.393363126875863, "policy_loss": 0.0038002332402688878, "vf_loss": 5.389562898212009, "vf_explained_var": 0.14372265332590337, "kl": 0.005360329085009698, "entropy": 1.2218722413456629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 267435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000}, "env_runners": {"episode_reward_max": 377.0, "episode_reward_min": 72.0, "episode_reward_mean": 272.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -111.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.0, "predator_policy": 86.0}, "policy_reward_mean": {"prey_policy": 119.375, "predator_policy": 16.63}, "custom_metrics": {}, "hist_stats": {"episode_reward": [315.0, 193.0, 286.0, 212.0, 316.0, 214.0, 237.0, 212.0, 208.0, 306.0, 330.0, 181.0, 256.0, 262.0, 228.0, 290.0, 203.0, 151.0, 350.0, 353.0, 256.0, 343.0, 222.0, 340.0, 284.0, 317.0, 302.0, 261.0, 328.0, 296.0, 278.0, 282.0, 340.0, 311.0, 72.0, 291.0, 183.0, 313.0, 267.0, 264.0, 294.0, 273.0, 171.0, 248.0, 230.0, 289.0, 304.0, 278.0, 256.0, 250.0, 233.0, 150.0, 286.0, 295.0, 353.0, 293.0, 155.0, 292.0, 172.0, 349.0, 313.0, 325.0, 277.0, 175.0, 317.0, 325.0, 312.0, 189.0, 304.0, 267.0, 250.0, 148.0, 329.0, 335.0, 212.0, 208.0, 307.0, 284.0, 247.0, 238.0, 254.0, 170.0, 298.0, 283.0, 342.0, 339.0, 261.0, 267.0, 294.0, 296.0, 377.0, 331.0, 219.0, 286.0, 293.0, 377.0, 354.0, 355.0, 306.0, 313.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [183.0, 132.0, -65.0, 177.0, 182.0, 91.0, -23.0, 169.0, 158.0, 158.0, 86.0, 104.0, 77.0, 128.0, -111.0, 173.0, 97.0, 47.0, 138.0, 138.0, 157.0, 172.0, 131.0, -38.0, 117.0, 139.0, 155.0, 92.0, 133.0, 66.0, 133.0, 157.0, -19.0, 165.0, 58.0, 1.0, 168.0, 172.0, 195.0, 158.0, 126.0, 99.0, 179.0, 164.0, 172.0, -5.0, 177.0, 150.0, 141.0, 91.0, 186.0, 111.0, 137.0, 156.0, 4.0, 139.0, 132.0, 184.0, 157.0, 132.0, 80.0, 182.0, 135.0, 147.0, 179.0, 161.0, 165.0, 140.0, -86.0, 33.0, 144.0, 135.0, -63.0, 161.0, 150.0, 163.0, 165.0, 18.0, 43.0, 172.0, 82.0, 162.0, 181.0, 71.0, -33.0, 166.0, 96.0, 124.0, 96.0, 68.0, 157.0, 131.0, 168.0, 53.0, 151.0, 96.0, 152.0, 94.0, 97.0, 101.0, 146.0, 63.0, 34.0, 25.0, 127.0, 159.0, 153.0, 103.0, 170.0, 183.0, 146.0, 93.0, 111.0, -32.0, 168.0, 118.0, 107.0, -7.0, 168.0, 181.0, 129.0, 161.0, 141.0, 177.0, 133.0, 138.0, 20.0, 123.0, 163.0, 146.0, 143.0, 182.0, 133.0, 178.0, 68.0, 57.0, 102.0, 176.0, 87.0, 148.0, 33.0, 175.0, 43.0, 70.0, 166.0, 163.0, 172.0, 163.0, 166.0, -12.0, 158.0, 34.0, 196.0, 80.0, 91.0, 152.0, 141.0, 37.0, -42.0, 164.0, 136.0, 80.0, 19.0, 92.0, 186.0, 94.0, 157.0, 115.0, 161.0, 181.0, 173.0, 154.0, 80.0, 136.0, 113.0, 98.0, 96.0, 169.0, 142.0, 106.0, 180.0, 194.0, 167.0, 153.0, 74.0, 99.0, 84.0, 142.0, 148.0, 145.0, 191.0, 186.0, 197.0, 125.0, 167.0, 188.0, 99.0, 180.0, 192.0, 85.0], "policy_predator_policy_reward": [0.0, 0.0, 26.0, 55.0, 0.0, 13.0, 0.0, 66.0, 0.0, 0.0, 3.0, 21.0, 24.0, 8.0, 64.0, 86.0, 21.0, 43.0, 19.0, 11.0, 0.0, 1.0, 56.0, 32.0, 0.0, 0.0, 15.0, 0.0, 17.0, 12.0, 0.0, 0.0, 57.0, 0.0, 36.0, 56.0, 1.0, 9.0, 0.0, 0.0, 3.0, 28.0, 0.0, 0.0, 0.0, 55.0, 1.0, 12.0, 23.0, 29.0, 20.0, 0.0, 9.0, 0.0, 61.0, 57.0, 0.0, 12.0, 7.0, 0.0, 1.0, 15.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 48.0, 77.0, 0.0, 12.0, 85.0, 0.0, 0.0, 0.0, 34.0, 50.0, 28.0, 21.0, 25.0, 25.0, 4.0, 17.0, 38.0, 0.0, 28.0, 0.0, 32.0, 34.0, 0.0, 1.0, 38.0, 45.0, 23.0, 8.0, 10.0, 0.0, 31.0, 21.0, 13.0, 11.0, 55.0, 36.0, 0.0, 0.0, 20.0, 19.0, 0.0, 0.0, 23.0, 31.0, 44.0, 32.0, 0.0, 6.0, 33.0, 39.0, 0.0, 0.0, 23.0, 0.0, 1.0, 6.0, 6.0, 0.0, 32.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, 1.0, 64.0, 0.0, 26.0, 0.0, 21.0, 11.0, 21.0, 21.0, 9.0, 26.0, 0.0, 0.0, 0.0, 0.0, 21.0, 37.0, 16.0, 0.0, 31.0, 0.0, 29.0, 12.0, 30.0, 39.0, 53.0, 63.0, 37.0, 1.0, 0.0, 59.0, 18.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 12.0, 0.0, 45.0, 29.0, 27.0, 29.0, 0.0, 21.0, 27.0, 3.0, 0.0, 11.0, 0.0, 9.0, 37.0, 28.0, 32.0, 0.0, 0.0, 0.0, 0.0, 25.0, 7.0, 0.0, 0.0, 10.0, 17.0, 0.0, 36.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.514883856692116, "mean_inference_ms": 16.455986005001748, "mean_action_processing_ms": 0.788573644789588, "mean_env_wait_ms": 2.475135680360799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010769009590148926, "StateBufferConnector_ms": 0.011733412742614746, "ViewRequirementAgentConnector_ms": 0.18626677989959717}, "num_episodes": 18, "episode_return_max": 377.0, "episode_return_min": 72.0, "episode_return_mean": 272.01, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 192.8734405425467, "num_env_steps_trained_throughput_per_sec": 192.8734405425467, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 2272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2272000, "timers": {"training_iteration_time_ms": 118368.129, "restore_workers_time_ms": 0.021, "training_step_time_ms": 118368.051, "sample_time_ms": 3009.214, "learn_time_ms": 115317.458, "learn_throughput": 34.687, "synch_weights_time_ms": 35.131}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000}, "done": false, "training_iteration": 142, "trial_id": "45bed_00000", "date": "2024-08-13_05-04-10", "timestamp": 1723539850, "time_this_iter_s": 20.858391046524048, "time_total_s": 14029.327897071838, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b51f4790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14029.327897071838, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 81.34482758620692, "ram_util_percent": 83.20344827586206}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3034813917187786, "cur_kl_coeff": 5.4210108624275225e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.075136953939206, "policy_loss": -0.002257936071018102, "vf_loss": 2.0773948892714484, "vf_explained_var": 0.0008593317692872709, "kl": 0.003681768585810457, "entropy": 0.05583546389209688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 269325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.162884157407221, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.091021725488088, "policy_loss": -0.0035790934707851164, "vf_loss": 5.0946008326515315, "vf_explained_var": 0.0775139520092616, "kl": 0.01653498493873023, "entropy": 1.135378832854922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 269325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 2288000}, "env_runners": {"episode_reward_max": 377.0, "episode_reward_min": 72.0, "episode_reward_mean": 278.37, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -134.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 107.0}, "policy_reward_mean": {"prey_policy": 122.755, "predator_policy": 16.43}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.0, 340.0, 284.0, 317.0, 302.0, 261.0, 328.0, 296.0, 278.0, 282.0, 340.0, 311.0, 72.0, 291.0, 183.0, 313.0, 267.0, 264.0, 294.0, 273.0, 171.0, 248.0, 230.0, 289.0, 304.0, 278.0, 256.0, 250.0, 233.0, 150.0, 286.0, 295.0, 353.0, 293.0, 155.0, 292.0, 172.0, 349.0, 313.0, 325.0, 277.0, 175.0, 317.0, 325.0, 312.0, 189.0, 304.0, 267.0, 250.0, 148.0, 329.0, 335.0, 212.0, 208.0, 307.0, 284.0, 247.0, 238.0, 254.0, 170.0, 298.0, 283.0, 342.0, 339.0, 261.0, 267.0, 294.0, 296.0, 377.0, 331.0, 219.0, 286.0, 293.0, 377.0, 354.0, 355.0, 306.0, 313.0, 289.0, 345.0, 291.0, 210.0, 316.0, 278.0, 303.0, 203.0, 176.0, 353.0, 161.0, 359.0, 366.0, 355.0, 327.0, 296.0, 212.0, 357.0, 343.0, 328.0, 260.0, 210.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [172.0, -5.0, 177.0, 150.0, 141.0, 91.0, 186.0, 111.0, 137.0, 156.0, 4.0, 139.0, 132.0, 184.0, 157.0, 132.0, 80.0, 182.0, 135.0, 147.0, 179.0, 161.0, 165.0, 140.0, -86.0, 33.0, 144.0, 135.0, -63.0, 161.0, 150.0, 163.0, 165.0, 18.0, 43.0, 172.0, 82.0, 162.0, 181.0, 71.0, -33.0, 166.0, 96.0, 124.0, 96.0, 68.0, 157.0, 131.0, 168.0, 53.0, 151.0, 96.0, 152.0, 94.0, 97.0, 101.0, 146.0, 63.0, 34.0, 25.0, 127.0, 159.0, 153.0, 103.0, 170.0, 183.0, 146.0, 93.0, 111.0, -32.0, 168.0, 118.0, 107.0, -7.0, 168.0, 181.0, 129.0, 161.0, 141.0, 177.0, 133.0, 138.0, 20.0, 123.0, 163.0, 146.0, 143.0, 182.0, 133.0, 178.0, 68.0, 57.0, 102.0, 176.0, 87.0, 148.0, 33.0, 175.0, 43.0, 70.0, 166.0, 163.0, 172.0, 163.0, 166.0, -12.0, 158.0, 34.0, 196.0, 80.0, 91.0, 152.0, 141.0, 37.0, -42.0, 164.0, 136.0, 80.0, 19.0, 92.0, 186.0, 94.0, 157.0, 115.0, 161.0, 181.0, 173.0, 154.0, 80.0, 136.0, 113.0, 98.0, 96.0, 169.0, 142.0, 106.0, 180.0, 194.0, 167.0, 153.0, 74.0, 99.0, 84.0, 142.0, 148.0, 145.0, 191.0, 186.0, 197.0, 125.0, 167.0, 188.0, 99.0, 180.0, 192.0, 85.0, 160.0, 107.0, 163.0, 167.0, 104.0, 158.0, 110.0, 71.0, 148.0, 157.0, 83.0, 172.0, 156.0, 123.0, 98.0, 12.0, -134.0, 189.0, 154.0, 186.0, 56.0, 6.0, 169.0, 178.0, 178.0, 188.0, 192.0, 161.0, 178.0, 111.0, 126.0, 159.0, 169.0, -23.0, 177.0, 180.0, 200.0, 131.0, 159.0, 169.0, 35.0, 155.0, 64.0, 93.0], "policy_predator_policy_reward": [0.0, 55.0, 1.0, 12.0, 23.0, 29.0, 20.0, 0.0, 9.0, 0.0, 61.0, 57.0, 0.0, 12.0, 7.0, 0.0, 1.0, 15.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 48.0, 77.0, 0.0, 12.0, 85.0, 0.0, 0.0, 0.0, 34.0, 50.0, 28.0, 21.0, 25.0, 25.0, 4.0, 17.0, 38.0, 0.0, 28.0, 0.0, 32.0, 34.0, 0.0, 1.0, 38.0, 45.0, 23.0, 8.0, 10.0, 0.0, 31.0, 21.0, 13.0, 11.0, 55.0, 36.0, 0.0, 0.0, 20.0, 19.0, 0.0, 0.0, 23.0, 31.0, 44.0, 32.0, 0.0, 6.0, 33.0, 39.0, 0.0, 0.0, 23.0, 0.0, 1.0, 6.0, 6.0, 0.0, 32.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, 1.0, 64.0, 0.0, 26.0, 0.0, 21.0, 11.0, 21.0, 21.0, 9.0, 26.0, 0.0, 0.0, 0.0, 0.0, 21.0, 37.0, 16.0, 0.0, 31.0, 0.0, 29.0, 12.0, 30.0, 39.0, 53.0, 63.0, 37.0, 1.0, 0.0, 59.0, 18.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 12.0, 0.0, 45.0, 29.0, 27.0, 29.0, 0.0, 21.0, 27.0, 3.0, 0.0, 11.0, 0.0, 9.0, 37.0, 28.0, 32.0, 0.0, 0.0, 0.0, 0.0, 25.0, 7.0, 0.0, 0.0, 10.0, 17.0, 0.0, 36.0, 11.0, 11.0, 3.0, 12.0, 0.0, 29.0, 0.0, 29.0, 10.0, 1.0, 23.0, 0.0, 1.0, 23.0, 60.0, 33.0, 107.0, 14.0, 13.0, 0.0, 54.0, 45.0, 4.0, 8.0, 0.0, 0.0, 1.0, 1.0, 13.0, 25.0, 0.0, 11.0, 66.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 45.0, 25.0, 53.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.487077685238574, "mean_inference_ms": 16.354094008772226, "mean_action_processing_ms": 0.7863626728502772, "mean_env_wait_ms": 2.455814915939811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006674766540527344, "StateBufferConnector_ms": 0.011687159538269043, "ViewRequirementAgentConnector_ms": 0.17821192741394043}, "num_episodes": 22, "episode_return_max": 377.0, "episode_return_min": 72.0, "episode_return_mean": 278.37, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 2288000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 206.97642839377048, "num_env_steps_trained_throughput_per_sec": 206.97642839377048, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 2288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2288000, "timers": {"training_iteration_time_ms": 118295.268, "restore_workers_time_ms": 0.02, "training_step_time_ms": 118295.194, "sample_time_ms": 2847.92, "learn_time_ms": 115409.774, "learn_throughput": 34.659, "synch_weights_time_ms": 30.963}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 2288000}, "done": false, "training_iteration": 143, "trial_id": "45bed_00000", "date": "2024-08-13_05-04-29", "timestamp": 1723539869, "time_this_iter_s": 19.381632089614868, "time_total_s": 14048.709529161453, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44b4280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14048.709529161453, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 81.10740740740741, "ram_util_percent": 83.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.908199195185351, "cur_kl_coeff": 2.7105054312137612e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1300193006084078, "policy_loss": -0.002976688346209586, "vf_loss": 1.1329959894929613, "vf_explained_var": 0.011593834212217382, "kl": 0.0019403513795402082, "entropy": 0.04479809550312225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 271215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.905994059579082, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.053369734779237, "policy_loss": -0.009306069752866668, "vf_loss": 8.062675810617113, "vf_explained_var": 0.11672268900921735, "kl": 0.014095348466752217, "entropy": 1.1231216771262034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 271215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "env_runners": {"episode_reward_max": 377.0, "episode_reward_min": 120.0, "episode_reward_mean": 274.42, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -134.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 107.0}, "policy_reward_mean": {"prey_policy": 121.985, "predator_policy": 15.225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [294.0, 273.0, 171.0, 248.0, 230.0, 289.0, 304.0, 278.0, 256.0, 250.0, 233.0, 150.0, 286.0, 295.0, 353.0, 293.0, 155.0, 292.0, 172.0, 349.0, 313.0, 325.0, 277.0, 175.0, 317.0, 325.0, 312.0, 189.0, 304.0, 267.0, 250.0, 148.0, 329.0, 335.0, 212.0, 208.0, 307.0, 284.0, 247.0, 238.0, 254.0, 170.0, 298.0, 283.0, 342.0, 339.0, 261.0, 267.0, 294.0, 296.0, 377.0, 331.0, 219.0, 286.0, 293.0, 377.0, 354.0, 355.0, 306.0, 313.0, 289.0, 345.0, 291.0, 210.0, 316.0, 278.0, 303.0, 203.0, 176.0, 353.0, 161.0, 359.0, 366.0, 355.0, 327.0, 296.0, 212.0, 357.0, 343.0, 328.0, 260.0, 210.0, 265.0, 226.0, 267.0, 163.0, 237.0, 120.0, 293.0, 215.0, 307.0, 274.0, 202.0, 241.0, 192.0, 246.0, 332.0, 332.0, 350.0, 294.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [82.0, 162.0, 181.0, 71.0, -33.0, 166.0, 96.0, 124.0, 96.0, 68.0, 157.0, 131.0, 168.0, 53.0, 151.0, 96.0, 152.0, 94.0, 97.0, 101.0, 146.0, 63.0, 34.0, 25.0, 127.0, 159.0, 153.0, 103.0, 170.0, 183.0, 146.0, 93.0, 111.0, -32.0, 168.0, 118.0, 107.0, -7.0, 168.0, 181.0, 129.0, 161.0, 141.0, 177.0, 133.0, 138.0, 20.0, 123.0, 163.0, 146.0, 143.0, 182.0, 133.0, 178.0, 68.0, 57.0, 102.0, 176.0, 87.0, 148.0, 33.0, 175.0, 43.0, 70.0, 166.0, 163.0, 172.0, 163.0, 166.0, -12.0, 158.0, 34.0, 196.0, 80.0, 91.0, 152.0, 141.0, 37.0, -42.0, 164.0, 136.0, 80.0, 19.0, 92.0, 186.0, 94.0, 157.0, 115.0, 161.0, 181.0, 173.0, 154.0, 80.0, 136.0, 113.0, 98.0, 96.0, 169.0, 142.0, 106.0, 180.0, 194.0, 167.0, 153.0, 74.0, 99.0, 84.0, 142.0, 148.0, 145.0, 191.0, 186.0, 197.0, 125.0, 167.0, 188.0, 99.0, 180.0, 192.0, 85.0, 160.0, 107.0, 163.0, 167.0, 104.0, 158.0, 110.0, 71.0, 148.0, 157.0, 83.0, 172.0, 156.0, 123.0, 98.0, 12.0, -134.0, 189.0, 154.0, 186.0, 56.0, 6.0, 169.0, 178.0, 178.0, 188.0, 192.0, 161.0, 178.0, 111.0, 126.0, 159.0, 169.0, -23.0, 177.0, 180.0, 200.0, 131.0, 159.0, 169.0, 35.0, 155.0, 64.0, 93.0, 122.0, 143.0, 48.0, 146.0, 139.0, 117.0, 112.0, 51.0, 129.0, 28.0, -29.0, 87.0, 149.0, 144.0, 155.0, 22.0, 173.0, 109.0, 164.0, 90.0, 75.0, 47.0, 130.0, 111.0, 40.0, 118.0, 109.0, 114.0, 149.0, 183.0, 133.0, 185.0, 178.0, 169.0, 146.0, 148.0], "policy_predator_policy_reward": [25.0, 25.0, 4.0, 17.0, 38.0, 0.0, 28.0, 0.0, 32.0, 34.0, 0.0, 1.0, 38.0, 45.0, 23.0, 8.0, 10.0, 0.0, 31.0, 21.0, 13.0, 11.0, 55.0, 36.0, 0.0, 0.0, 20.0, 19.0, 0.0, 0.0, 23.0, 31.0, 44.0, 32.0, 0.0, 6.0, 33.0, 39.0, 0.0, 0.0, 23.0, 0.0, 1.0, 6.0, 6.0, 0.0, 32.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, 1.0, 64.0, 0.0, 26.0, 0.0, 21.0, 11.0, 21.0, 21.0, 9.0, 26.0, 0.0, 0.0, 0.0, 0.0, 21.0, 37.0, 16.0, 0.0, 31.0, 0.0, 29.0, 12.0, 30.0, 39.0, 53.0, 63.0, 37.0, 1.0, 0.0, 59.0, 18.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 12.0, 0.0, 45.0, 29.0, 27.0, 29.0, 0.0, 21.0, 27.0, 3.0, 0.0, 11.0, 0.0, 9.0, 37.0, 28.0, 32.0, 0.0, 0.0, 0.0, 0.0, 25.0, 7.0, 0.0, 0.0, 10.0, 17.0, 0.0, 36.0, 11.0, 11.0, 3.0, 12.0, 0.0, 29.0, 0.0, 29.0, 10.0, 1.0, 23.0, 0.0, 1.0, 23.0, 60.0, 33.0, 107.0, 14.0, 13.0, 0.0, 54.0, 45.0, 4.0, 8.0, 0.0, 0.0, 1.0, 1.0, 13.0, 25.0, 0.0, 11.0, 66.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 45.0, 25.0, 53.0, 0.0, 0.0, 0.0, 30.0, 2.0, 11.0, 0.0, 0.0, 0.0, 35.0, 45.0, 51.0, 11.0, 0.0, 0.0, 19.0, 19.0, 11.0, 14.0, 15.0, 5.0, 52.0, 28.0, 0.0, 0.0, 0.0, 34.0, 23.0, 0.0, 0.0, 0.0, 3.0, 11.0, 1.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.460643640501343, "mean_inference_ms": 16.27399253046678, "mean_action_processing_ms": 0.7847091595088226, "mean_env_wait_ms": 2.442876678380758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006140947341918945, "StateBufferConnector_ms": 0.011801362037658691, "ViewRequirementAgentConnector_ms": 0.1704782247543335}, "num_episodes": 18, "episode_return_max": 377.0, "episode_return_min": 120.0, "episode_return_mean": 274.42, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 195.76246749153282, "num_env_steps_trained_throughput_per_sec": 195.76246749153282, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 2304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2304000, "timers": {"training_iteration_time_ms": 118434.943, "restore_workers_time_ms": 0.018, "training_step_time_ms": 118434.873, "sample_time_ms": 2793.753, "learn_time_ms": 115605.527, "learn_throughput": 34.6, "synch_weights_time_ms": 29.067}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "done": false, "training_iteration": 144, "trial_id": "45bed_00000", "date": "2024-08-13_05-04-50", "timestamp": 1723539890, "time_this_iter_s": 20.46444296836853, "time_total_s": 14069.173972129822, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b528f280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14069.173972129822, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 79.7655172413793, "ram_util_percent": 83.3103448275862}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1106128476560115, "cur_kl_coeff": 1.3552527156068806e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8034516586040062, "policy_loss": -0.0016692412991283667, "vf_loss": 0.805120901680655, "vf_explained_var": 0.014775426835610122, "kl": 0.0011584609125122774, "entropy": 0.060795792252337805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 273105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.874853978239039, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.791423511757421, "policy_loss": -0.010065315036034143, "vf_loss": 5.801488830677416, "vf_explained_var": 0.28913469532179453, "kl": 0.01904038930278389, "entropy": 1.0683144227537529, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 273105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "env_runners": {"episode_reward_max": 377.0, "episode_reward_min": 120.0, "episode_reward_mean": 278.69, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -134.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 107.0}, "policy_reward_mean": {"prey_policy": 126.05, "predator_policy": 13.295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [172.0, 349.0, 313.0, 325.0, 277.0, 175.0, 317.0, 325.0, 312.0, 189.0, 304.0, 267.0, 250.0, 148.0, 329.0, 335.0, 212.0, 208.0, 307.0, 284.0, 247.0, 238.0, 254.0, 170.0, 298.0, 283.0, 342.0, 339.0, 261.0, 267.0, 294.0, 296.0, 377.0, 331.0, 219.0, 286.0, 293.0, 377.0, 354.0, 355.0, 306.0, 313.0, 289.0, 345.0, 291.0, 210.0, 316.0, 278.0, 303.0, 203.0, 176.0, 353.0, 161.0, 359.0, 366.0, 355.0, 327.0, 296.0, 212.0, 357.0, 343.0, 328.0, 260.0, 210.0, 265.0, 226.0, 267.0, 163.0, 237.0, 120.0, 293.0, 215.0, 307.0, 274.0, 202.0, 241.0, 192.0, 246.0, 332.0, 332.0, 350.0, 294.0, 293.0, 295.0, 310.0, 318.0, 263.0, 348.0, 217.0, 338.0, 266.0, 306.0, 226.0, 228.0, 266.0, 289.0, 245.0, 298.0, 274.0, 297.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [107.0, -7.0, 168.0, 181.0, 129.0, 161.0, 141.0, 177.0, 133.0, 138.0, 20.0, 123.0, 163.0, 146.0, 143.0, 182.0, 133.0, 178.0, 68.0, 57.0, 102.0, 176.0, 87.0, 148.0, 33.0, 175.0, 43.0, 70.0, 166.0, 163.0, 172.0, 163.0, 166.0, -12.0, 158.0, 34.0, 196.0, 80.0, 91.0, 152.0, 141.0, 37.0, -42.0, 164.0, 136.0, 80.0, 19.0, 92.0, 186.0, 94.0, 157.0, 115.0, 161.0, 181.0, 173.0, 154.0, 80.0, 136.0, 113.0, 98.0, 96.0, 169.0, 142.0, 106.0, 180.0, 194.0, 167.0, 153.0, 74.0, 99.0, 84.0, 142.0, 148.0, 145.0, 191.0, 186.0, 197.0, 125.0, 167.0, 188.0, 99.0, 180.0, 192.0, 85.0, 160.0, 107.0, 163.0, 167.0, 104.0, 158.0, 110.0, 71.0, 148.0, 157.0, 83.0, 172.0, 156.0, 123.0, 98.0, 12.0, -134.0, 189.0, 154.0, 186.0, 56.0, 6.0, 169.0, 178.0, 178.0, 188.0, 192.0, 161.0, 178.0, 111.0, 126.0, 159.0, 169.0, -23.0, 177.0, 180.0, 200.0, 131.0, 159.0, 169.0, 35.0, 155.0, 64.0, 93.0, 122.0, 143.0, 48.0, 146.0, 139.0, 117.0, 112.0, 51.0, 129.0, 28.0, -29.0, 87.0, 149.0, 144.0, 155.0, 22.0, 173.0, 109.0, 164.0, 90.0, 75.0, 47.0, 130.0, 111.0, 40.0, 118.0, 109.0, 114.0, 149.0, 183.0, 133.0, 185.0, 178.0, 169.0, 146.0, 148.0, 122.0, 152.0, 169.0, 114.0, 163.0, 147.0, 164.0, 132.0, 154.0, 91.0, 149.0, 176.0, 149.0, 7.0, 196.0, 115.0, 87.0, 144.0, 179.0, 127.0, 106.0, 120.0, 147.0, 63.0, 125.0, 141.0, 151.0, 122.0, 150.0, 91.0, 166.0, 103.0, 150.0, 124.0, 177.0, 120.0], "policy_predator_policy_reward": [33.0, 39.0, 0.0, 0.0, 23.0, 0.0, 1.0, 6.0, 6.0, 0.0, 32.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, 1.0, 64.0, 0.0, 26.0, 0.0, 21.0, 11.0, 21.0, 21.0, 9.0, 26.0, 0.0, 0.0, 0.0, 0.0, 21.0, 37.0, 16.0, 0.0, 31.0, 0.0, 29.0, 12.0, 30.0, 39.0, 53.0, 63.0, 37.0, 1.0, 0.0, 59.0, 18.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 12.0, 0.0, 45.0, 29.0, 27.0, 29.0, 0.0, 21.0, 27.0, 3.0, 0.0, 11.0, 0.0, 9.0, 37.0, 28.0, 32.0, 0.0, 0.0, 0.0, 0.0, 25.0, 7.0, 0.0, 0.0, 10.0, 17.0, 0.0, 36.0, 11.0, 11.0, 3.0, 12.0, 0.0, 29.0, 0.0, 29.0, 10.0, 1.0, 23.0, 0.0, 1.0, 23.0, 60.0, 33.0, 107.0, 14.0, 13.0, 0.0, 54.0, 45.0, 4.0, 8.0, 0.0, 0.0, 1.0, 1.0, 13.0, 25.0, 0.0, 11.0, 66.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 45.0, 25.0, 53.0, 0.0, 0.0, 0.0, 30.0, 2.0, 11.0, 0.0, 0.0, 0.0, 35.0, 45.0, 51.0, 11.0, 0.0, 0.0, 19.0, 19.0, 11.0, 14.0, 15.0, 5.0, 52.0, 28.0, 0.0, 0.0, 0.0, 34.0, 23.0, 0.0, 0.0, 0.0, 3.0, 11.0, 1.0, 2.0, 0.0, 0.0, 0.0, 19.0, 12.0, 0.0, 0.0, 0.0, 22.0, 0.0, 18.0, 0.0, 10.0, 13.0, 29.0, 32.0, 0.0, 27.0, 10.0, 25.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 8.0, 8.0, 4.0, 0.0, 29.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.434515206343253, "mean_inference_ms": 16.195069492234172, "mean_action_processing_ms": 0.783213520566322, "mean_env_wait_ms": 2.430182454231143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056378841400146484, "StateBufferConnector_ms": 0.01186668872833252, "ViewRequirementAgentConnector_ms": 0.15954101085662842}, "num_episodes": 18, "episode_return_max": 377.0, "episode_return_min": 120.0, "episode_return_mean": 278.69, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 191.41908618478342, "num_env_steps_trained_throughput_per_sec": 191.41908618478342, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 2320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2320000, "timers": {"training_iteration_time_ms": 118576.933, "restore_workers_time_ms": 0.018, "training_step_time_ms": 118576.861, "sample_time_ms": 2819.044, "learn_time_ms": 115722.207, "learn_throughput": 34.566, "synch_weights_time_ms": 29.419}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "done": false, "training_iteration": 145, "trial_id": "45bed_00000", "date": "2024-08-13_05-05-11", "timestamp": 1723539911, "time_this_iter_s": 20.95445489883423, "time_total_s": 14090.128427028656, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b52eb550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14090.128427028656, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 79.62666666666665, "ram_util_percent": 83.53666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3778639601612532, "cur_kl_coeff": 6.776263578034403e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8857885486392117, "policy_loss": -0.0031497940936042047, "vf_loss": 0.8889383424211431, "vf_explained_var": 0.008169803669843724, "kl": 0.002290501265016418, "entropy": 0.10772994277732713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 274995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.133753877215915, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.2318435754725545, "policy_loss": -0.005226140759427041, "vf_loss": 6.237069710474166, "vf_explained_var": 0.23707259918646836, "kl": 0.015027015551713365, "entropy": 1.1429255226301769, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 274995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000}, "env_runners": {"episode_reward_max": 377.0, "episode_reward_min": 120.0, "episode_reward_mean": 283.83, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -134.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 107.0}, "policy_reward_mean": {"prey_policy": 129.8, "predator_policy": 12.115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.0, 298.0, 283.0, 342.0, 339.0, 261.0, 267.0, 294.0, 296.0, 377.0, 331.0, 219.0, 286.0, 293.0, 377.0, 354.0, 355.0, 306.0, 313.0, 289.0, 345.0, 291.0, 210.0, 316.0, 278.0, 303.0, 203.0, 176.0, 353.0, 161.0, 359.0, 366.0, 355.0, 327.0, 296.0, 212.0, 357.0, 343.0, 328.0, 260.0, 210.0, 265.0, 226.0, 267.0, 163.0, 237.0, 120.0, 293.0, 215.0, 307.0, 274.0, 202.0, 241.0, 192.0, 246.0, 332.0, 332.0, 350.0, 294.0, 293.0, 295.0, 310.0, 318.0, 263.0, 348.0, 217.0, 338.0, 266.0, 306.0, 226.0, 228.0, 266.0, 289.0, 245.0, 298.0, 274.0, 297.0, 298.0, 326.0, 369.0, 214.0, 281.0, 360.0, 332.0, 218.0, 267.0, 321.0, 330.0, 295.0, 361.0, 307.0, 224.0, 226.0, 190.0, 261.0, 284.0, 275.0, 246.0, 337.0, 329.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [19.0, 92.0, 186.0, 94.0, 157.0, 115.0, 161.0, 181.0, 173.0, 154.0, 80.0, 136.0, 113.0, 98.0, 96.0, 169.0, 142.0, 106.0, 180.0, 194.0, 167.0, 153.0, 74.0, 99.0, 84.0, 142.0, 148.0, 145.0, 191.0, 186.0, 197.0, 125.0, 167.0, 188.0, 99.0, 180.0, 192.0, 85.0, 160.0, 107.0, 163.0, 167.0, 104.0, 158.0, 110.0, 71.0, 148.0, 157.0, 83.0, 172.0, 156.0, 123.0, 98.0, 12.0, -134.0, 189.0, 154.0, 186.0, 56.0, 6.0, 169.0, 178.0, 178.0, 188.0, 192.0, 161.0, 178.0, 111.0, 126.0, 159.0, 169.0, -23.0, 177.0, 180.0, 200.0, 131.0, 159.0, 169.0, 35.0, 155.0, 64.0, 93.0, 122.0, 143.0, 48.0, 146.0, 139.0, 117.0, 112.0, 51.0, 129.0, 28.0, -29.0, 87.0, 149.0, 144.0, 155.0, 22.0, 173.0, 109.0, 164.0, 90.0, 75.0, 47.0, 130.0, 111.0, 40.0, 118.0, 109.0, 114.0, 149.0, 183.0, 133.0, 185.0, 178.0, 169.0, 146.0, 148.0, 122.0, 152.0, 169.0, 114.0, 163.0, 147.0, 164.0, 132.0, 154.0, 91.0, 149.0, 176.0, 149.0, 7.0, 196.0, 115.0, 87.0, 144.0, 179.0, 127.0, 106.0, 120.0, 147.0, 63.0, 125.0, 141.0, 151.0, 122.0, 150.0, 91.0, 166.0, 103.0, 150.0, 124.0, 177.0, 120.0, 122.0, 157.0, 135.0, 179.0, 188.0, 181.0, 168.0, 29.0, 172.0, 69.0, 154.0, 199.0, 173.0, 140.0, 166.0, 27.0, 60.0, 144.0, 162.0, 131.0, 134.0, 186.0, 103.0, 192.0, 191.0, 170.0, 131.0, 154.0, 49.0, 154.0, 98.0, 85.0, 99.0, 88.0, 183.0, 62.0, 116.0, 151.0, 67.0, 146.0, 102.0, 107.0, 157.0, 168.0, 180.0, 141.0], "policy_predator_policy_reward": [0.0, 59.0, 18.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 12.0, 0.0, 45.0, 29.0, 27.0, 29.0, 0.0, 21.0, 27.0, 3.0, 0.0, 11.0, 0.0, 9.0, 37.0, 28.0, 32.0, 0.0, 0.0, 0.0, 0.0, 25.0, 7.0, 0.0, 0.0, 10.0, 17.0, 0.0, 36.0, 11.0, 11.0, 3.0, 12.0, 0.0, 29.0, 0.0, 29.0, 10.0, 1.0, 23.0, 0.0, 1.0, 23.0, 60.0, 33.0, 107.0, 14.0, 13.0, 0.0, 54.0, 45.0, 4.0, 8.0, 0.0, 0.0, 1.0, 1.0, 13.0, 25.0, 0.0, 11.0, 66.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 45.0, 25.0, 53.0, 0.0, 0.0, 0.0, 30.0, 2.0, 11.0, 0.0, 0.0, 0.0, 35.0, 45.0, 51.0, 11.0, 0.0, 0.0, 19.0, 19.0, 11.0, 14.0, 15.0, 5.0, 52.0, 28.0, 0.0, 0.0, 0.0, 34.0, 23.0, 0.0, 0.0, 0.0, 3.0, 11.0, 1.0, 2.0, 0.0, 0.0, 0.0, 19.0, 12.0, 0.0, 0.0, 0.0, 22.0, 0.0, 18.0, 0.0, 10.0, 13.0, 29.0, 32.0, 0.0, 27.0, 10.0, 25.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 8.0, 8.0, 4.0, 0.0, 29.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 3.0, 2.0, 10.0, 0.0, 0.0, 17.0, 0.0, 13.0, 27.0, 7.0, 0.0, 5.0, 14.0, 25.0, 0.0, 25.0, 38.0, 8.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 21.0, 0.0, 28.0, 15.0, 0.0, 3.0, 16.0, 0.0, 0.0, 17.0, 33.0, 29.0, 25.0, 12.0, 12.0, 0.0, 8.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.396942531401753, "mean_inference_ms": 16.09885353406668, "mean_action_processing_ms": 0.781426196609923, "mean_env_wait_ms": 2.417461456786844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006402254104614258, "StateBufferConnector_ms": 0.004397869110107422, "ViewRequirementAgentConnector_ms": 0.1610661745071411}, "num_episodes": 23, "episode_return_max": 377.0, "episode_return_min": 120.0, "episode_return_mean": 283.83, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 198.6350795216192, "num_env_steps_trained_throughput_per_sec": 198.6350795216192, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 2336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2336000, "timers": {"training_iteration_time_ms": 118664.981, "restore_workers_time_ms": 0.018, "training_step_time_ms": 118664.9, "sample_time_ms": 2848.216, "learn_time_ms": 115781.531, "learn_throughput": 34.548, "synch_weights_time_ms": 29.357}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000}, "done": false, "training_iteration": 146, "trial_id": "45bed_00000", "date": "2024-08-13_05-05-31", "timestamp": 1723539931, "time_this_iter_s": 20.17106795310974, "time_total_s": 14110.299494981766, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5244280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14110.299494981766, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 78.66071428571429, "ram_util_percent": 83.11785714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8417383789878201, "cur_kl_coeff": 3.3881317890172015e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6451730937711776, "policy_loss": -0.0011329723921205317, "vf_loss": 0.6463060666053068, "vf_explained_var": 0.008703843216416696, "kl": 0.0015356525267059302, "entropy": 0.07664215849052189, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 276885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.058632319061845, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.655814341136387, "policy_loss": -0.005057953202126242, "vf_loss": 5.6608723052595025, "vf_explained_var": 0.07775086839363057, "kl": 0.015205094438894617, "entropy": 1.1564159236887774, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 276885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "env_runners": {"episode_reward_max": 381.0, "episode_reward_min": 120.0, "episode_reward_mean": 282.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -134.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 107.0}, "policy_reward_mean": {"prey_policy": 130.3, "predator_policy": 11.135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.0, 316.0, 278.0, 303.0, 203.0, 176.0, 353.0, 161.0, 359.0, 366.0, 355.0, 327.0, 296.0, 212.0, 357.0, 343.0, 328.0, 260.0, 210.0, 265.0, 226.0, 267.0, 163.0, 237.0, 120.0, 293.0, 215.0, 307.0, 274.0, 202.0, 241.0, 192.0, 246.0, 332.0, 332.0, 350.0, 294.0, 293.0, 295.0, 310.0, 318.0, 263.0, 348.0, 217.0, 338.0, 266.0, 306.0, 226.0, 228.0, 266.0, 289.0, 245.0, 298.0, 274.0, 297.0, 298.0, 326.0, 369.0, 214.0, 281.0, 360.0, 332.0, 218.0, 267.0, 321.0, 330.0, 295.0, 361.0, 307.0, 224.0, 226.0, 190.0, 261.0, 284.0, 275.0, 246.0, 337.0, 329.0, 280.0, 287.0, 381.0, 265.0, 320.0, 355.0, 169.0, 316.0, 340.0, 240.0, 244.0, 314.0, 344.0, 204.0, 307.0, 334.0, 327.0, 334.0, 342.0, 304.0, 336.0, 247.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [110.0, 71.0, 148.0, 157.0, 83.0, 172.0, 156.0, 123.0, 98.0, 12.0, -134.0, 189.0, 154.0, 186.0, 56.0, 6.0, 169.0, 178.0, 178.0, 188.0, 192.0, 161.0, 178.0, 111.0, 126.0, 159.0, 169.0, -23.0, 177.0, 180.0, 200.0, 131.0, 159.0, 169.0, 35.0, 155.0, 64.0, 93.0, 122.0, 143.0, 48.0, 146.0, 139.0, 117.0, 112.0, 51.0, 129.0, 28.0, -29.0, 87.0, 149.0, 144.0, 155.0, 22.0, 173.0, 109.0, 164.0, 90.0, 75.0, 47.0, 130.0, 111.0, 40.0, 118.0, 109.0, 114.0, 149.0, 183.0, 133.0, 185.0, 178.0, 169.0, 146.0, 148.0, 122.0, 152.0, 169.0, 114.0, 163.0, 147.0, 164.0, 132.0, 154.0, 91.0, 149.0, 176.0, 149.0, 7.0, 196.0, 115.0, 87.0, 144.0, 179.0, 127.0, 106.0, 120.0, 147.0, 63.0, 125.0, 141.0, 151.0, 122.0, 150.0, 91.0, 166.0, 103.0, 150.0, 124.0, 177.0, 120.0, 122.0, 157.0, 135.0, 179.0, 188.0, 181.0, 168.0, 29.0, 172.0, 69.0, 154.0, 199.0, 173.0, 140.0, 166.0, 27.0, 60.0, 144.0, 162.0, 131.0, 134.0, 186.0, 103.0, 192.0, 191.0, 170.0, 131.0, 154.0, 49.0, 154.0, 98.0, 85.0, 99.0, 88.0, 183.0, 62.0, 116.0, 151.0, 67.0, 146.0, 102.0, 107.0, 157.0, 168.0, 180.0, 141.0, 110.0, 144.0, 148.0, 139.0, 193.0, 186.0, 145.0, 87.0, 158.0, 160.0, 164.0, 191.0, 92.0, 35.0, 145.0, 155.0, 168.0, 172.0, 161.0, 10.0, 105.0, 49.0, 182.0, 132.0, 165.0, 170.0, 122.0, 70.0, 93.0, 186.0, 186.0, 135.0, 135.0, 192.0, 173.0, 161.0, 166.0, 176.0, 132.0, 172.0, 175.0, 160.0, 129.0, 98.0], "policy_predator_policy_reward": [0.0, 29.0, 10.0, 1.0, 23.0, 0.0, 1.0, 23.0, 60.0, 33.0, 107.0, 14.0, 13.0, 0.0, 54.0, 45.0, 4.0, 8.0, 0.0, 0.0, 1.0, 1.0, 13.0, 25.0, 0.0, 11.0, 66.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 45.0, 25.0, 53.0, 0.0, 0.0, 0.0, 30.0, 2.0, 11.0, 0.0, 0.0, 0.0, 35.0, 45.0, 51.0, 11.0, 0.0, 0.0, 19.0, 19.0, 11.0, 14.0, 15.0, 5.0, 52.0, 28.0, 0.0, 0.0, 0.0, 34.0, 23.0, 0.0, 0.0, 0.0, 3.0, 11.0, 1.0, 2.0, 0.0, 0.0, 0.0, 19.0, 12.0, 0.0, 0.0, 0.0, 22.0, 0.0, 18.0, 0.0, 10.0, 13.0, 29.0, 32.0, 0.0, 27.0, 10.0, 25.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 8.0, 8.0, 4.0, 0.0, 29.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 3.0, 2.0, 10.0, 0.0, 0.0, 17.0, 0.0, 13.0, 27.0, 7.0, 0.0, 5.0, 14.0, 25.0, 0.0, 25.0, 38.0, 8.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 21.0, 0.0, 28.0, 15.0, 0.0, 3.0, 16.0, 0.0, 0.0, 17.0, 33.0, 29.0, 25.0, 12.0, 12.0, 0.0, 8.0, 0.0, 0.0, 26.0, 0.0, 0.0, 2.0, 0.0, 33.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 42.0, 7.0, 9.0, 0.0, 0.0, 8.0, 61.0, 40.0, 50.0, 0.0, 0.0, 9.0, 0.0, 6.0, 6.0, 3.0, 25.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 20.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.370143204844647, "mean_inference_ms": 15.843408225343092, "mean_action_processing_ms": 0.7798865531533565, "mean_env_wait_ms": 2.5641483898028645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00657343864440918, "StateBufferConnector_ms": 0.004551291465759277, "ViewRequirementAgentConnector_ms": 0.17274165153503418}, "num_episodes": 22, "episode_return_max": 381.0, "episode_return_min": 120.0, "episode_return_mean": 282.87, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 189.97256263991994, "num_env_steps_trained_throughput_per_sec": 189.97256263991994, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 2352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2352000, "timers": {"training_iteration_time_ms": 19795.635, "restore_workers_time_ms": 0.017, "training_step_time_ms": 19795.558, "sample_time_ms": 2873.547, "learn_time_ms": 16892.035, "learn_throughput": 236.798, "synch_weights_time_ms": 24.935}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "done": false, "training_iteration": 147, "trial_id": "45bed_00000", "date": "2024-08-13_05-05-52", "timestamp": 1723539952, "time_this_iter_s": 21.099206924438477, "time_total_s": 14131.398701906204, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b528f3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14131.398701906204, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 80.62333333333335, "ram_util_percent": 83.31666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1545147180320725, "cur_kl_coeff": 1.6940658945086008e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.784687419290896, "policy_loss": -0.0012393673992760125, "vf_loss": 1.7859267851032277, "vf_explained_var": 0.0014658734911964053, "kl": 0.0018015218141422856, "entropy": 0.08081842510709687, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 278775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.023459290512024, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.729640377766241, "policy_loss": -0.007633852957077718, "vf_loss": 4.737274231607952, "vf_explained_var": 0.05532764041865314, "kl": 0.01334632619744446, "entropy": 1.197346468009646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 278775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000}, "env_runners": {"episode_reward_max": 381.0, "episode_reward_min": 120.0, "episode_reward_mean": 285.09, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -29.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 100.0}, "policy_reward_mean": {"prey_policy": 130.855, "predator_policy": 11.69}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.0, 265.0, 226.0, 267.0, 163.0, 237.0, 120.0, 293.0, 215.0, 307.0, 274.0, 202.0, 241.0, 192.0, 246.0, 332.0, 332.0, 350.0, 294.0, 293.0, 295.0, 310.0, 318.0, 263.0, 348.0, 217.0, 338.0, 266.0, 306.0, 226.0, 228.0, 266.0, 289.0, 245.0, 298.0, 274.0, 297.0, 298.0, 326.0, 369.0, 214.0, 281.0, 360.0, 332.0, 218.0, 267.0, 321.0, 330.0, 295.0, 361.0, 307.0, 224.0, 226.0, 190.0, 261.0, 284.0, 275.0, 246.0, 337.0, 329.0, 280.0, 287.0, 381.0, 265.0, 320.0, 355.0, 169.0, 316.0, 340.0, 240.0, 244.0, 314.0, 344.0, 204.0, 307.0, 334.0, 327.0, 334.0, 342.0, 304.0, 336.0, 247.0, 262.0, 219.0, 329.0, 315.0, 127.0, 356.0, 317.0, 330.0, 280.0, 367.0, 350.0, 350.0, 326.0, 290.0, 299.0, 244.0, 297.0, 367.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [64.0, 93.0, 122.0, 143.0, 48.0, 146.0, 139.0, 117.0, 112.0, 51.0, 129.0, 28.0, -29.0, 87.0, 149.0, 144.0, 155.0, 22.0, 173.0, 109.0, 164.0, 90.0, 75.0, 47.0, 130.0, 111.0, 40.0, 118.0, 109.0, 114.0, 149.0, 183.0, 133.0, 185.0, 178.0, 169.0, 146.0, 148.0, 122.0, 152.0, 169.0, 114.0, 163.0, 147.0, 164.0, 132.0, 154.0, 91.0, 149.0, 176.0, 149.0, 7.0, 196.0, 115.0, 87.0, 144.0, 179.0, 127.0, 106.0, 120.0, 147.0, 63.0, 125.0, 141.0, 151.0, 122.0, 150.0, 91.0, 166.0, 103.0, 150.0, 124.0, 177.0, 120.0, 122.0, 157.0, 135.0, 179.0, 188.0, 181.0, 168.0, 29.0, 172.0, 69.0, 154.0, 199.0, 173.0, 140.0, 166.0, 27.0, 60.0, 144.0, 162.0, 131.0, 134.0, 186.0, 103.0, 192.0, 191.0, 170.0, 131.0, 154.0, 49.0, 154.0, 98.0, 85.0, 99.0, 88.0, 183.0, 62.0, 116.0, 151.0, 67.0, 146.0, 102.0, 107.0, 157.0, 168.0, 180.0, 141.0, 110.0, 144.0, 148.0, 139.0, 193.0, 186.0, 145.0, 87.0, 158.0, 160.0, 164.0, 191.0, 92.0, 35.0, 145.0, 155.0, 168.0, 172.0, 161.0, 10.0, 105.0, 49.0, 182.0, 132.0, 165.0, 170.0, 122.0, 70.0, 93.0, 186.0, 186.0, 135.0, 135.0, 192.0, 173.0, 161.0, 166.0, 176.0, 132.0, 172.0, 175.0, 160.0, 129.0, 98.0, 136.0, 99.0, 131.0, -10.0, 149.0, 159.0, 110.0, 180.0, 36.0, -9.0, 165.0, 191.0, 146.0, 171.0, 158.0, 164.0, 166.0, 2.0, 165.0, 192.0, 171.0, 175.0, 167.0, 152.0, 187.0, 136.0, 186.0, 63.0, 100.0, 168.0, -18.0, 117.0, 41.0, 177.0, 181.0, 186.0], "policy_predator_policy_reward": [53.0, 0.0, 0.0, 0.0, 30.0, 2.0, 11.0, 0.0, 0.0, 0.0, 35.0, 45.0, 51.0, 11.0, 0.0, 0.0, 19.0, 19.0, 11.0, 14.0, 15.0, 5.0, 52.0, 28.0, 0.0, 0.0, 0.0, 34.0, 23.0, 0.0, 0.0, 0.0, 3.0, 11.0, 1.0, 2.0, 0.0, 0.0, 0.0, 19.0, 12.0, 0.0, 0.0, 0.0, 22.0, 0.0, 18.0, 0.0, 10.0, 13.0, 29.0, 32.0, 0.0, 27.0, 10.0, 25.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 8.0, 8.0, 4.0, 0.0, 29.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 3.0, 2.0, 10.0, 0.0, 0.0, 17.0, 0.0, 13.0, 27.0, 7.0, 0.0, 5.0, 14.0, 25.0, 0.0, 25.0, 38.0, 8.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 21.0, 0.0, 28.0, 15.0, 0.0, 3.0, 16.0, 0.0, 0.0, 17.0, 33.0, 29.0, 25.0, 12.0, 12.0, 0.0, 8.0, 0.0, 0.0, 26.0, 0.0, 0.0, 2.0, 0.0, 33.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 42.0, 7.0, 9.0, 0.0, 0.0, 8.0, 61.0, 40.0, 50.0, 0.0, 0.0, 9.0, 0.0, 6.0, 6.0, 3.0, 25.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 20.0, 0.0, 27.0, 0.0, 78.0, 20.0, 7.0, 14.0, 19.0, 6.0, 0.0, 100.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 43.0, 69.0, 0.0, 10.0, 0.0, 4.0, 7.0, 24.0, 1.0, 2.0, 41.0, 0.0, 3.0, 28.0, 73.0, 72.0, 33.0, 46.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.3445425991687285, "mean_inference_ms": 15.928815957429665, "mean_action_processing_ms": 0.7779396989473191, "mean_env_wait_ms": 2.3881332162132676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006420731544494629, "StateBufferConnector_ms": 0.004689335823059082, "ViewRequirementAgentConnector_ms": 0.16002225875854492}, "num_episodes": 18, "episode_return_max": 381.0, "episode_return_min": 120.0, "episode_return_mean": 285.09, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 179.63033245188157, "num_env_steps_trained_throughput_per_sec": 179.63033245188157, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 2368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2368000, "timers": {"training_iteration_time_ms": 20028.996, "restore_workers_time_ms": 0.017, "training_step_time_ms": 20028.921, "sample_time_ms": 2779.075, "learn_time_ms": 17220.976, "learn_throughput": 232.275, "synch_weights_time_ms": 24.2}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000}, "done": false, "training_iteration": 148, "trial_id": "45bed_00000", "date": "2024-08-13_05-06-14", "timestamp": 1723539974, "time_this_iter_s": 22.323702096939087, "time_total_s": 14153.722404003143, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b528f4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14153.722404003143, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 81.84687500000001, "ram_util_percent": 83.49375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9468385387547117, "cur_kl_coeff": 8.470329472543004e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4581622499637503, "policy_loss": -0.00027452339603018666, "vf_loss": 1.4584367730945507, "vf_explained_var": 0.008595515464348768, "kl": 0.0016300443978134863, "entropy": 0.08595482793060087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 280665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.33994931250653, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.3669481426319745, "policy_loss": -0.004799658632172006, "vf_loss": 4.37174780658944, "vf_explained_var": 0.1461499247286055, "kl": 0.013030367719596963, "entropy": 1.2209361976416653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 280665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 2384000}, "env_runners": {"episode_reward_max": 381.0, "episode_reward_min": 67.0, "episode_reward_mean": 293.63, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -64.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 100.0}, "policy_reward_mean": {"prey_policy": 134.795, "predator_policy": 12.02}, "custom_metrics": {}, "hist_stats": {"episode_reward": [294.0, 293.0, 295.0, 310.0, 318.0, 263.0, 348.0, 217.0, 338.0, 266.0, 306.0, 226.0, 228.0, 266.0, 289.0, 245.0, 298.0, 274.0, 297.0, 298.0, 326.0, 369.0, 214.0, 281.0, 360.0, 332.0, 218.0, 267.0, 321.0, 330.0, 295.0, 361.0, 307.0, 224.0, 226.0, 190.0, 261.0, 284.0, 275.0, 246.0, 337.0, 329.0, 280.0, 287.0, 381.0, 265.0, 320.0, 355.0, 169.0, 316.0, 340.0, 240.0, 244.0, 314.0, 344.0, 204.0, 307.0, 334.0, 327.0, 334.0, 342.0, 304.0, 336.0, 247.0, 262.0, 219.0, 329.0, 315.0, 127.0, 356.0, 317.0, 330.0, 280.0, 367.0, 350.0, 350.0, 326.0, 290.0, 299.0, 244.0, 297.0, 367.0, 225.0, 304.0, 178.0, 333.0, 179.0, 322.0, 305.0, 67.0, 370.0, 343.0, 328.0, 278.0, 365.0, 347.0, 377.0, 370.0, 309.0, 326.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [146.0, 148.0, 122.0, 152.0, 169.0, 114.0, 163.0, 147.0, 164.0, 132.0, 154.0, 91.0, 149.0, 176.0, 149.0, 7.0, 196.0, 115.0, 87.0, 144.0, 179.0, 127.0, 106.0, 120.0, 147.0, 63.0, 125.0, 141.0, 151.0, 122.0, 150.0, 91.0, 166.0, 103.0, 150.0, 124.0, 177.0, 120.0, 122.0, 157.0, 135.0, 179.0, 188.0, 181.0, 168.0, 29.0, 172.0, 69.0, 154.0, 199.0, 173.0, 140.0, 166.0, 27.0, 60.0, 144.0, 162.0, 131.0, 134.0, 186.0, 103.0, 192.0, 191.0, 170.0, 131.0, 154.0, 49.0, 154.0, 98.0, 85.0, 99.0, 88.0, 183.0, 62.0, 116.0, 151.0, 67.0, 146.0, 102.0, 107.0, 157.0, 168.0, 180.0, 141.0, 110.0, 144.0, 148.0, 139.0, 193.0, 186.0, 145.0, 87.0, 158.0, 160.0, 164.0, 191.0, 92.0, 35.0, 145.0, 155.0, 168.0, 172.0, 161.0, 10.0, 105.0, 49.0, 182.0, 132.0, 165.0, 170.0, 122.0, 70.0, 93.0, 186.0, 186.0, 135.0, 135.0, 192.0, 173.0, 161.0, 166.0, 176.0, 132.0, 172.0, 175.0, 160.0, 129.0, 98.0, 136.0, 99.0, 131.0, -10.0, 149.0, 159.0, 110.0, 180.0, 36.0, -9.0, 165.0, 191.0, 146.0, 171.0, 158.0, 164.0, 166.0, 2.0, 165.0, 192.0, 171.0, 175.0, 167.0, 152.0, 187.0, 136.0, 186.0, 63.0, 100.0, 168.0, -18.0, 117.0, 41.0, 177.0, 181.0, 186.0, -30.0, 181.0, 132.0, 135.0, 17.0, 115.0, 177.0, 156.0, 11.0, 108.0, 168.0, 142.0, 169.0, 35.0, -64.0, 40.0, 182.0, 188.0, 185.0, 158.0, 176.0, 144.0, 186.0, 39.0, 170.0, 191.0, 161.0, 178.0, 188.0, 189.0, 192.0, 170.0, 143.0, 163.0, 126.0, 164.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 19.0, 12.0, 0.0, 0.0, 0.0, 22.0, 0.0, 18.0, 0.0, 10.0, 13.0, 29.0, 32.0, 0.0, 27.0, 10.0, 25.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 8.0, 8.0, 4.0, 0.0, 29.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 3.0, 2.0, 10.0, 0.0, 0.0, 17.0, 0.0, 13.0, 27.0, 7.0, 0.0, 5.0, 14.0, 25.0, 0.0, 25.0, 38.0, 8.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 21.0, 0.0, 28.0, 15.0, 0.0, 3.0, 16.0, 0.0, 0.0, 17.0, 33.0, 29.0, 25.0, 12.0, 12.0, 0.0, 8.0, 0.0, 0.0, 26.0, 0.0, 0.0, 2.0, 0.0, 33.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 42.0, 7.0, 9.0, 0.0, 0.0, 8.0, 61.0, 40.0, 50.0, 0.0, 0.0, 9.0, 0.0, 6.0, 6.0, 3.0, 25.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 20.0, 0.0, 27.0, 0.0, 78.0, 20.0, 7.0, 14.0, 19.0, 6.0, 0.0, 100.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 43.0, 69.0, 0.0, 10.0, 0.0, 4.0, 7.0, 24.0, 1.0, 2.0, 41.0, 0.0, 3.0, 28.0, 73.0, 72.0, 33.0, 46.0, 0.0, 0.0, 0.0, 74.0, 19.0, 18.0, 13.0, 33.0, 0.0, 0.0, 0.0, 60.0, 9.0, 3.0, 51.0, 50.0, 0.0, 91.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 3.0, 50.0, 4.0, 0.0, 8.0, 0.0, 0.0, 0.0, 7.0, 1.0, 3.0, 0.0, 25.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.319308815626817, "mean_inference_ms": 15.853246755944538, "mean_action_processing_ms": 0.7763733400718159, "mean_env_wait_ms": 2.3760955828948425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006349802017211914, "StateBufferConnector_ms": 0.006920456886291504, "ViewRequirementAgentConnector_ms": 0.1725013256072998}, "num_episodes": 18, "episode_return_max": 381.0, "episode_return_min": 67.0, "episode_return_mean": 293.63, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 2384000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 180.9988891210787, "num_env_steps_trained_throughput_per_sec": 180.9988891210787, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 2384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2384000, "timers": {"training_iteration_time_ms": 20277.6, "restore_workers_time_ms": 0.017, "training_step_time_ms": 20277.529, "sample_time_ms": 2855.9, "learn_time_ms": 17394.579, "learn_throughput": 229.957, "synch_weights_time_ms": 22.874}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 2384000}, "done": false, "training_iteration": 149, "trial_id": "45bed_00000", "date": "2024-08-13_05-06-37", "timestamp": 1723539997, "time_this_iter_s": 22.159672737121582, "time_total_s": 14175.882076740265, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b51f4310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14175.882076740265, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 80.46129032258067, "ram_util_percent": 83.2935483870968}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4788957673169318, "cur_kl_coeff": 4.235164736271502e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.172359202084718, "policy_loss": -0.0007183479162415973, "vf_loss": 2.173077549316265, "vf_explained_var": 0.011752683807302404, "kl": 0.0019591418441396915, "entropy": 0.09834811696043563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 282555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.214461849480079, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.157781088541425, "policy_loss": -0.0036519232512791716, "vf_loss": 5.161433021984403, "vf_explained_var": 0.1549929071355749, "kl": 0.015878115732157725, "entropy": 1.2281990847259603, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 282555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": 381.0, "episode_reward_min": 67.0, "episode_reward_mean": 297.73, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -64.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 100.0}, "policy_reward_mean": {"prey_policy": 134.925, "predator_policy": 13.94}, "custom_metrics": {}, "hist_stats": {"episode_reward": [281.0, 360.0, 332.0, 218.0, 267.0, 321.0, 330.0, 295.0, 361.0, 307.0, 224.0, 226.0, 190.0, 261.0, 284.0, 275.0, 246.0, 337.0, 329.0, 280.0, 287.0, 381.0, 265.0, 320.0, 355.0, 169.0, 316.0, 340.0, 240.0, 244.0, 314.0, 344.0, 204.0, 307.0, 334.0, 327.0, 334.0, 342.0, 304.0, 336.0, 247.0, 262.0, 219.0, 329.0, 315.0, 127.0, 356.0, 317.0, 330.0, 280.0, 367.0, 350.0, 350.0, 326.0, 290.0, 299.0, 244.0, 297.0, 367.0, 225.0, 304.0, 178.0, 333.0, 179.0, 322.0, 305.0, 67.0, 370.0, 343.0, 328.0, 278.0, 365.0, 347.0, 377.0, 370.0, 309.0, 326.0, 308.0, 312.0, 313.0, 297.0, 379.0, 281.0, 353.0, 230.0, 284.0, 329.0, 290.0, 307.0, 281.0, 314.0, 235.0, 371.0, 293.0, 304.0, 334.0, 292.0, 276.0, 313.0, 292.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [172.0, 69.0, 154.0, 199.0, 173.0, 140.0, 166.0, 27.0, 60.0, 144.0, 162.0, 131.0, 134.0, 186.0, 103.0, 192.0, 191.0, 170.0, 131.0, 154.0, 49.0, 154.0, 98.0, 85.0, 99.0, 88.0, 183.0, 62.0, 116.0, 151.0, 67.0, 146.0, 102.0, 107.0, 157.0, 168.0, 180.0, 141.0, 110.0, 144.0, 148.0, 139.0, 193.0, 186.0, 145.0, 87.0, 158.0, 160.0, 164.0, 191.0, 92.0, 35.0, 145.0, 155.0, 168.0, 172.0, 161.0, 10.0, 105.0, 49.0, 182.0, 132.0, 165.0, 170.0, 122.0, 70.0, 93.0, 186.0, 186.0, 135.0, 135.0, 192.0, 173.0, 161.0, 166.0, 176.0, 132.0, 172.0, 175.0, 160.0, 129.0, 98.0, 136.0, 99.0, 131.0, -10.0, 149.0, 159.0, 110.0, 180.0, 36.0, -9.0, 165.0, 191.0, 146.0, 171.0, 158.0, 164.0, 166.0, 2.0, 165.0, 192.0, 171.0, 175.0, 167.0, 152.0, 187.0, 136.0, 186.0, 63.0, 100.0, 168.0, -18.0, 117.0, 41.0, 177.0, 181.0, 186.0, -30.0, 181.0, 132.0, 135.0, 17.0, 115.0, 177.0, 156.0, 11.0, 108.0, 168.0, 142.0, 169.0, 35.0, -64.0, 40.0, 182.0, 188.0, 185.0, 158.0, 176.0, 144.0, 186.0, 39.0, 170.0, 191.0, 161.0, 178.0, 188.0, 189.0, 192.0, 170.0, 143.0, 163.0, 126.0, 164.0, 76.0, 195.0, 149.0, 142.0, 176.0, 79.0, 200.0, 72.0, 186.0, 193.0, 99.0, 130.0, 151.0, 180.0, 27.0, 157.0, 188.0, 51.0, 158.0, 148.0, 189.0, 101.0, 154.0, 132.0, 200.0, 17.0, 134.0, 172.0, 166.0, 6.0, 186.0, 185.0, 104.0, 180.0, 100.0, 142.0, 147.0, 187.0, 191.0, 23.0, 44.0, 186.0, 128.0, 174.0, 200.0, 67.0], "policy_predator_policy_reward": [13.0, 27.0, 7.0, 0.0, 5.0, 14.0, 25.0, 0.0, 25.0, 38.0, 8.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 21.0, 0.0, 28.0, 15.0, 0.0, 3.0, 16.0, 0.0, 0.0, 17.0, 33.0, 29.0, 25.0, 12.0, 12.0, 0.0, 8.0, 0.0, 0.0, 26.0, 0.0, 0.0, 2.0, 0.0, 33.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 42.0, 7.0, 9.0, 0.0, 0.0, 8.0, 61.0, 40.0, 50.0, 0.0, 0.0, 9.0, 0.0, 6.0, 6.0, 3.0, 25.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 20.0, 0.0, 27.0, 0.0, 78.0, 20.0, 7.0, 14.0, 19.0, 6.0, 0.0, 100.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 43.0, 69.0, 0.0, 10.0, 0.0, 4.0, 7.0, 24.0, 1.0, 2.0, 41.0, 0.0, 3.0, 28.0, 73.0, 72.0, 33.0, 46.0, 0.0, 0.0, 0.0, 74.0, 19.0, 18.0, 13.0, 33.0, 0.0, 0.0, 0.0, 60.0, 9.0, 3.0, 51.0, 50.0, 0.0, 91.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 3.0, 50.0, 4.0, 0.0, 8.0, 0.0, 0.0, 0.0, 7.0, 1.0, 3.0, 0.0, 25.0, 11.0, 0.0, 37.0, 9.0, 12.0, 32.0, 26.0, 1.0, 24.0, 0.0, 0.0, 28.0, 24.0, 7.0, 15.0, 11.0, 35.0, 45.0, 0.0, 11.0, 12.0, 0.0, 0.0, 10.0, 11.0, 36.0, 28.0, 8.0, 0.0, 63.0, 0.0, 0.0, 0.0, 0.0, 9.0, 32.0, 30.0, 0.0, 0.0, 42.0, 36.0, 46.0, 0.0, 6.0, 5.0, 13.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.604732452625147, "mean_inference_ms": 15.444502651476926, "mean_action_processing_ms": 0.7772134315248779, "mean_env_wait_ms": 2.365298018625742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006754398345947266, "StateBufferConnector_ms": 0.0070983171463012695, "ViewRequirementAgentConnector_ms": 0.17677998542785645}, "num_episodes": 23, "episode_return_max": 381.0, "episode_return_min": 67.0, "episode_return_mean": 297.73, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.262991286170501, "num_env_steps_trained_throughput_per_sec": 4.262991286170501, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 112266.413, "restore_workers_time_ms": 0.016, "training_step_time_ms": 112266.342, "sample_time_ms": 2840.382, "learn_time_ms": 109397.594, "learn_throughput": 36.564, "synch_weights_time_ms": 24.505}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": false, "training_iteration": 150, "trial_id": "45bed_00000", "date": "2024-08-13_05-22-15", "timestamp": 1723540935, "time_this_iter_s": 938.4443790912628, "time_total_s": 15114.326455831528, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b478e790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15114.326455831528, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 89.48947368421052, "ram_util_percent": 83.3921052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1309141040242539, "cur_kl_coeff": 2.117582368135751e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0053094112368488, "policy_loss": -0.00033795398871892346, "vf_loss": 1.0056473653073663, "vf_explained_var": 0.011931335263782077, "kl": 0.0014014407562177485, "entropy": 0.09051497638442371, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 284445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.194883583777796, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.285913075341119, "policy_loss": -0.007836763757384485, "vf_loss": 6.293749829196425, "vf_explained_var": -0.0034904485341733095, "kl": 0.016487388741405172, "entropy": 1.2575239549238215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 284445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 2416000}, "env_runners": {"episode_reward_max": 381.0, "episode_reward_min": 67.0, "episode_reward_mean": 297.97, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -64.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 100.0}, "policy_reward_mean": {"prey_policy": 134.935, "predator_policy": 14.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.0, 280.0, 287.0, 381.0, 265.0, 320.0, 355.0, 169.0, 316.0, 340.0, 240.0, 244.0, 314.0, 344.0, 204.0, 307.0, 334.0, 327.0, 334.0, 342.0, 304.0, 336.0, 247.0, 262.0, 219.0, 329.0, 315.0, 127.0, 356.0, 317.0, 330.0, 280.0, 367.0, 350.0, 350.0, 326.0, 290.0, 299.0, 244.0, 297.0, 367.0, 225.0, 304.0, 178.0, 333.0, 179.0, 322.0, 305.0, 67.0, 370.0, 343.0, 328.0, 278.0, 365.0, 347.0, 377.0, 370.0, 309.0, 326.0, 308.0, 312.0, 313.0, 297.0, 379.0, 281.0, 353.0, 230.0, 284.0, 329.0, 290.0, 307.0, 281.0, 314.0, 235.0, 371.0, 293.0, 304.0, 334.0, 292.0, 276.0, 313.0, 292.0, 231.0, 349.0, 250.0, 330.0, 291.0, 342.0, 371.0, 320.0, 281.0, 209.0, 309.0, 277.0, 269.0, 282.0, 344.0, 190.0, 272.0, 222.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [180.0, 141.0, 110.0, 144.0, 148.0, 139.0, 193.0, 186.0, 145.0, 87.0, 158.0, 160.0, 164.0, 191.0, 92.0, 35.0, 145.0, 155.0, 168.0, 172.0, 161.0, 10.0, 105.0, 49.0, 182.0, 132.0, 165.0, 170.0, 122.0, 70.0, 93.0, 186.0, 186.0, 135.0, 135.0, 192.0, 173.0, 161.0, 166.0, 176.0, 132.0, 172.0, 175.0, 160.0, 129.0, 98.0, 136.0, 99.0, 131.0, -10.0, 149.0, 159.0, 110.0, 180.0, 36.0, -9.0, 165.0, 191.0, 146.0, 171.0, 158.0, 164.0, 166.0, 2.0, 165.0, 192.0, 171.0, 175.0, 167.0, 152.0, 187.0, 136.0, 186.0, 63.0, 100.0, 168.0, -18.0, 117.0, 41.0, 177.0, 181.0, 186.0, -30.0, 181.0, 132.0, 135.0, 17.0, 115.0, 177.0, 156.0, 11.0, 108.0, 168.0, 142.0, 169.0, 35.0, -64.0, 40.0, 182.0, 188.0, 185.0, 158.0, 176.0, 144.0, 186.0, 39.0, 170.0, 191.0, 161.0, 178.0, 188.0, 189.0, 192.0, 170.0, 143.0, 163.0, 126.0, 164.0, 76.0, 195.0, 149.0, 142.0, 176.0, 79.0, 200.0, 72.0, 186.0, 193.0, 99.0, 130.0, 151.0, 180.0, 27.0, 157.0, 188.0, 51.0, 158.0, 148.0, 189.0, 101.0, 154.0, 132.0, 200.0, 17.0, 134.0, 172.0, 166.0, 6.0, 186.0, 185.0, 104.0, 180.0, 100.0, 142.0, 147.0, 187.0, 191.0, 23.0, 44.0, 186.0, 128.0, 174.0, 200.0, 67.0, -17.0, 194.0, 184.0, 165.0, 156.0, 58.0, 149.0, 181.0, 106.0, 159.0, 182.0, 160.0, 188.0, 183.0, 162.0, 126.0, 168.0, 113.0, -26.0, 169.0, 82.0, 171.0, 53.0, 174.0, 86.0, 157.0, 113.0, 169.0, 168.0, 168.0, 147.0, 20.0, 163.0, 66.0, 93.0, 102.0], "policy_predator_policy_reward": [8.0, 0.0, 0.0, 26.0, 0.0, 0.0, 2.0, 0.0, 33.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 42.0, 7.0, 9.0, 0.0, 0.0, 8.0, 61.0, 40.0, 50.0, 0.0, 0.0, 9.0, 0.0, 6.0, 6.0, 3.0, 25.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 20.0, 0.0, 27.0, 0.0, 78.0, 20.0, 7.0, 14.0, 19.0, 6.0, 0.0, 100.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 43.0, 69.0, 0.0, 10.0, 0.0, 4.0, 7.0, 24.0, 1.0, 2.0, 41.0, 0.0, 3.0, 28.0, 73.0, 72.0, 33.0, 46.0, 0.0, 0.0, 0.0, 74.0, 19.0, 18.0, 13.0, 33.0, 0.0, 0.0, 0.0, 60.0, 9.0, 3.0, 51.0, 50.0, 0.0, 91.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 3.0, 50.0, 4.0, 0.0, 8.0, 0.0, 0.0, 0.0, 7.0, 1.0, 3.0, 0.0, 25.0, 11.0, 0.0, 37.0, 9.0, 12.0, 32.0, 26.0, 1.0, 24.0, 0.0, 0.0, 28.0, 24.0, 7.0, 15.0, 11.0, 35.0, 45.0, 0.0, 11.0, 12.0, 0.0, 0.0, 10.0, 11.0, 36.0, 28.0, 8.0, 0.0, 63.0, 0.0, 0.0, 0.0, 0.0, 9.0, 32.0, 30.0, 0.0, 0.0, 42.0, 36.0, 46.0, 0.0, 6.0, 5.0, 13.0, 12.0, 54.0, 0.0, 0.0, 0.0, 36.0, 0.0, 0.0, 0.0, 0.0, 26.0, 0.0, 0.0, 0.0, 0.0, 5.0, 27.0, 0.0, 0.0, 66.0, 0.0, 28.0, 28.0, 0.0, 50.0, 0.0, 26.0, 0.0, 0.0, 0.0, 8.0, 14.0, 9.0, 0.0, 43.0, 13.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.261729336943607, "mean_inference_ms": 15.694829147490363, "mean_action_processing_ms": 0.7735694445326127, "mean_env_wait_ms": 2.3526163801335405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005846619606018066, "StateBufferConnector_ms": 0.010320544242858887, "ViewRequirementAgentConnector_ms": 0.20798468589782715}, "num_episodes": 18, "episode_return_max": 381.0, "episode_return_min": 67.0, "episode_return_mean": 297.97, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 2416000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.8261793359252, "num_env_steps_trained_throughput_per_sec": 159.8261793359252, "timesteps_total": 604000, "num_env_steps_sampled_lifetime": 604000, "num_agent_steps_sampled_lifetime": 2416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2416000, "timers": {"training_iteration_time_ms": 113029.056, "restore_workers_time_ms": 0.016, "training_step_time_ms": 113028.987, "sample_time_ms": 3174.168, "learn_time_ms": 109825.962, "learn_throughput": 36.421, "synch_weights_time_ms": 24.649}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 2416000}, "done": false, "training_iteration": 151, "trial_id": "45bed_00000", "date": "2024-08-13_05-22-40", "timestamp": 1723540960, "time_this_iter_s": 25.097228050231934, "time_total_s": 15139.42368388176, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b52c6af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15139.42368388176, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 94.96285714285713, "ram_util_percent": 83.74000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1052163946604918, "cur_kl_coeff": 1.0587911840678755e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.621028574544286, "policy_loss": -0.0015383081077031359, "vf_loss": 0.6225668825228852, "vf_explained_var": 0.015345258435244282, "kl": 0.00153679358631067, "entropy": 0.07443388998902664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 286335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.372639999282423, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.282883134720818, "policy_loss": -5.012124631475046e-05, "vf_loss": 5.282933242485006, "vf_explained_var": 0.1436978042125702, "kl": 0.014961598004857232, "entropy": 1.283751440805102, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 286335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000}, "env_runners": {"episode_reward_max": 379.0, "episode_reward_min": 67.0, "episode_reward_mean": 301.19, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -64.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 100.0}, "policy_reward_mean": {"prey_policy": 136.455, "predator_policy": 14.14}, "custom_metrics": {}, "hist_stats": {"episode_reward": [247.0, 262.0, 219.0, 329.0, 315.0, 127.0, 356.0, 317.0, 330.0, 280.0, 367.0, 350.0, 350.0, 326.0, 290.0, 299.0, 244.0, 297.0, 367.0, 225.0, 304.0, 178.0, 333.0, 179.0, 322.0, 305.0, 67.0, 370.0, 343.0, 328.0, 278.0, 365.0, 347.0, 377.0, 370.0, 309.0, 326.0, 308.0, 312.0, 313.0, 297.0, 379.0, 281.0, 353.0, 230.0, 284.0, 329.0, 290.0, 307.0, 281.0, 314.0, 235.0, 371.0, 293.0, 304.0, 334.0, 292.0, 276.0, 313.0, 292.0, 231.0, 349.0, 250.0, 330.0, 291.0, 342.0, 371.0, 320.0, 281.0, 209.0, 309.0, 277.0, 269.0, 282.0, 344.0, 190.0, 272.0, 222.0, 303.0, 277.0, 309.0, 303.0, 349.0, 314.0, 354.0, 300.0, 301.0, 299.0, 321.0, 353.0, 328.0, 291.0, 326.0, 343.0, 319.0, 334.0, 319.0, 351.0, 322.0, 278.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [129.0, 98.0, 136.0, 99.0, 131.0, -10.0, 149.0, 159.0, 110.0, 180.0, 36.0, -9.0, 165.0, 191.0, 146.0, 171.0, 158.0, 164.0, 166.0, 2.0, 165.0, 192.0, 171.0, 175.0, 167.0, 152.0, 187.0, 136.0, 186.0, 63.0, 100.0, 168.0, -18.0, 117.0, 41.0, 177.0, 181.0, 186.0, -30.0, 181.0, 132.0, 135.0, 17.0, 115.0, 177.0, 156.0, 11.0, 108.0, 168.0, 142.0, 169.0, 35.0, -64.0, 40.0, 182.0, 188.0, 185.0, 158.0, 176.0, 144.0, 186.0, 39.0, 170.0, 191.0, 161.0, 178.0, 188.0, 189.0, 192.0, 170.0, 143.0, 163.0, 126.0, 164.0, 76.0, 195.0, 149.0, 142.0, 176.0, 79.0, 200.0, 72.0, 186.0, 193.0, 99.0, 130.0, 151.0, 180.0, 27.0, 157.0, 188.0, 51.0, 158.0, 148.0, 189.0, 101.0, 154.0, 132.0, 200.0, 17.0, 134.0, 172.0, 166.0, 6.0, 186.0, 185.0, 104.0, 180.0, 100.0, 142.0, 147.0, 187.0, 191.0, 23.0, 44.0, 186.0, 128.0, 174.0, 200.0, 67.0, -17.0, 194.0, 184.0, 165.0, 156.0, 58.0, 149.0, 181.0, 106.0, 159.0, 182.0, 160.0, 188.0, 183.0, 162.0, 126.0, 168.0, 113.0, -26.0, 169.0, 82.0, 171.0, 53.0, 174.0, 86.0, 157.0, 113.0, 169.0, 168.0, 168.0, 147.0, 20.0, 163.0, 66.0, 93.0, 102.0, 174.0, 129.0, 179.0, 69.0, 146.0, 151.0, 112.0, 168.0, 181.0, 163.0, 132.0, 157.0, 180.0, 174.0, 122.0, 155.0, 117.0, 165.0, 170.0, 74.0, 149.0, 172.0, 170.0, 173.0, 160.0, 147.0, 102.0, 173.0, 150.0, 176.0, 169.0, 165.0, 166.0, 138.0, 141.0, 189.0, 174.0, 129.0, 191.0, 149.0, 123.0, 164.0, 82.0, 155.0], "policy_predator_policy_reward": [20.0, 0.0, 27.0, 0.0, 78.0, 20.0, 7.0, 14.0, 19.0, 6.0, 0.0, 100.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 43.0, 69.0, 0.0, 10.0, 0.0, 4.0, 7.0, 24.0, 1.0, 2.0, 41.0, 0.0, 3.0, 28.0, 73.0, 72.0, 33.0, 46.0, 0.0, 0.0, 0.0, 74.0, 19.0, 18.0, 13.0, 33.0, 0.0, 0.0, 0.0, 60.0, 9.0, 3.0, 51.0, 50.0, 0.0, 91.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 3.0, 50.0, 4.0, 0.0, 8.0, 0.0, 0.0, 0.0, 7.0, 1.0, 3.0, 0.0, 25.0, 11.0, 0.0, 37.0, 9.0, 12.0, 32.0, 26.0, 1.0, 24.0, 0.0, 0.0, 28.0, 24.0, 7.0, 15.0, 11.0, 35.0, 45.0, 0.0, 11.0, 12.0, 0.0, 0.0, 10.0, 11.0, 36.0, 28.0, 8.0, 0.0, 63.0, 0.0, 0.0, 0.0, 0.0, 9.0, 32.0, 30.0, 0.0, 0.0, 42.0, 36.0, 46.0, 0.0, 6.0, 5.0, 13.0, 12.0, 54.0, 0.0, 0.0, 0.0, 36.0, 0.0, 0.0, 0.0, 0.0, 26.0, 0.0, 0.0, 0.0, 0.0, 5.0, 27.0, 0.0, 0.0, 66.0, 0.0, 28.0, 28.0, 0.0, 50.0, 0.0, 26.0, 0.0, 0.0, 0.0, 8.0, 14.0, 9.0, 0.0, 43.0, 13.0, 14.0, 0.0, 0.0, 29.0, 0.0, 12.0, 0.0, 0.0, 23.0, 0.0, 5.0, 17.0, 8.0, 0.0, 0.0, 10.0, 13.0, 10.0, 9.0, 24.0, 31.0, 0.0, 0.0, 0.0, 10.0, 6.0, 15.0, 0.0, 16.0, 0.0, 0.0, 9.0, 0.0, 3.0, 12.0, 4.0, 0.0, 0.0, 16.0, 11.0, 0.0, 10.0, 25.0, 34.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.237977861586083, "mean_inference_ms": 15.609414853239151, "mean_action_processing_ms": 0.772154427813626, "mean_env_wait_ms": 2.3359731468263516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006219387054443359, "StateBufferConnector_ms": 0.01006162166595459, "ViewRequirementAgentConnector_ms": 0.2121967077255249}, "num_episodes": 22, "episode_return_max": 379.0, "episode_return_min": 67.0, "episode_return_mean": 301.19, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.343799828292324, "num_env_steps_trained_throughput_per_sec": 4.343799828292324, "timesteps_total": 608000, "num_env_steps_sampled_lifetime": 608000, "num_agent_steps_sampled_lifetime": 2432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2432000, "timers": {"training_iteration_time_ms": 203040.431, "restore_workers_time_ms": 0.016, "training_step_time_ms": 203040.365, "sample_time_ms": 2980.056, "learn_time_ms": 200031.512, "learn_throughput": 19.997, "synch_weights_time_ms": 25.085}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000}, "done": false, "training_iteration": 152, "trial_id": "45bed_00000", "date": "2024-08-13_05-38-01", "timestamp": 1723541881, "time_this_iter_s": 920.9817681312561, "time_total_s": 16060.405452013016, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b478ee50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16060.405452013016, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 88.95588235294119, "ram_util_percent": 83.15294117647058}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.050166212077494, "cur_kl_coeff": 5.2939559203393774e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9490726498384324, "policy_loss": -0.0012819543252970097, "vf_loss": 0.9503546047778356, "vf_explained_var": 0.012936779210176417, "kl": 0.0013407865883085783, "entropy": 0.06332237478838396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 288225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.213663668575741, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4136154458636327, "policy_loss": 0.0013316271969526217, "vf_loss": 3.4122838209545803, "vf_explained_var": 0.1525087138963124, "kl": 0.01718446007608186, "entropy": 1.3041129917694778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 288225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000}, "env_runners": {"episode_reward_max": 380.0, "episode_reward_min": 67.0, "episode_reward_mean": 310.72, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -64.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 91.0}, "policy_reward_mean": {"prey_policy": 143.875, "predator_policy": 11.485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [367.0, 225.0, 304.0, 178.0, 333.0, 179.0, 322.0, 305.0, 67.0, 370.0, 343.0, 328.0, 278.0, 365.0, 347.0, 377.0, 370.0, 309.0, 326.0, 308.0, 312.0, 313.0, 297.0, 379.0, 281.0, 353.0, 230.0, 284.0, 329.0, 290.0, 307.0, 281.0, 314.0, 235.0, 371.0, 293.0, 304.0, 334.0, 292.0, 276.0, 313.0, 292.0, 231.0, 349.0, 250.0, 330.0, 291.0, 342.0, 371.0, 320.0, 281.0, 209.0, 309.0, 277.0, 269.0, 282.0, 344.0, 190.0, 272.0, 222.0, 303.0, 277.0, 309.0, 303.0, 349.0, 314.0, 354.0, 300.0, 301.0, 299.0, 321.0, 353.0, 328.0, 291.0, 326.0, 343.0, 319.0, 334.0, 319.0, 351.0, 322.0, 278.0, 342.0, 377.0, 369.0, 345.0, 380.0, 361.0, 377.0, 319.0, 311.0, 347.0, 326.0, 373.0, 320.0, 340.0, 357.0, 346.0, 359.0, 309.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [181.0, 186.0, -30.0, 181.0, 132.0, 135.0, 17.0, 115.0, 177.0, 156.0, 11.0, 108.0, 168.0, 142.0, 169.0, 35.0, -64.0, 40.0, 182.0, 188.0, 185.0, 158.0, 176.0, 144.0, 186.0, 39.0, 170.0, 191.0, 161.0, 178.0, 188.0, 189.0, 192.0, 170.0, 143.0, 163.0, 126.0, 164.0, 76.0, 195.0, 149.0, 142.0, 176.0, 79.0, 200.0, 72.0, 186.0, 193.0, 99.0, 130.0, 151.0, 180.0, 27.0, 157.0, 188.0, 51.0, 158.0, 148.0, 189.0, 101.0, 154.0, 132.0, 200.0, 17.0, 134.0, 172.0, 166.0, 6.0, 186.0, 185.0, 104.0, 180.0, 100.0, 142.0, 147.0, 187.0, 191.0, 23.0, 44.0, 186.0, 128.0, 174.0, 200.0, 67.0, -17.0, 194.0, 184.0, 165.0, 156.0, 58.0, 149.0, 181.0, 106.0, 159.0, 182.0, 160.0, 188.0, 183.0, 162.0, 126.0, 168.0, 113.0, -26.0, 169.0, 82.0, 171.0, 53.0, 174.0, 86.0, 157.0, 113.0, 169.0, 168.0, 168.0, 147.0, 20.0, 163.0, 66.0, 93.0, 102.0, 174.0, 129.0, 179.0, 69.0, 146.0, 151.0, 112.0, 168.0, 181.0, 163.0, 132.0, 157.0, 180.0, 174.0, 122.0, 155.0, 117.0, 165.0, 170.0, 74.0, 149.0, 172.0, 170.0, 173.0, 160.0, 147.0, 102.0, 173.0, 150.0, 176.0, 169.0, 165.0, 166.0, 138.0, 141.0, 189.0, 174.0, 129.0, 191.0, 149.0, 123.0, 164.0, 82.0, 155.0, 131.0, 192.0, 161.0, 199.0, 182.0, 186.0, 174.0, 171.0, 189.0, 191.0, 186.0, 163.0, 191.0, 179.0, 185.0, 114.0, 134.0, 161.0, 181.0, 166.0, 164.0, 138.0, 194.0, 179.0, 107.0, 186.0, 180.0, 107.0, 169.0, 188.0, 161.0, 173.0, 160.0, 189.0, 146.0, 157.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 74.0, 19.0, 18.0, 13.0, 33.0, 0.0, 0.0, 0.0, 60.0, 9.0, 3.0, 51.0, 50.0, 0.0, 91.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 3.0, 50.0, 4.0, 0.0, 8.0, 0.0, 0.0, 0.0, 7.0, 1.0, 3.0, 0.0, 25.0, 11.0, 0.0, 37.0, 9.0, 12.0, 32.0, 26.0, 1.0, 24.0, 0.0, 0.0, 28.0, 24.0, 7.0, 15.0, 11.0, 35.0, 45.0, 0.0, 11.0, 12.0, 0.0, 0.0, 10.0, 11.0, 36.0, 28.0, 8.0, 0.0, 63.0, 0.0, 0.0, 0.0, 0.0, 9.0, 32.0, 30.0, 0.0, 0.0, 42.0, 36.0, 46.0, 0.0, 6.0, 5.0, 13.0, 12.0, 54.0, 0.0, 0.0, 0.0, 36.0, 0.0, 0.0, 0.0, 0.0, 26.0, 0.0, 0.0, 0.0, 0.0, 5.0, 27.0, 0.0, 0.0, 66.0, 0.0, 28.0, 28.0, 0.0, 50.0, 0.0, 26.0, 0.0, 0.0, 0.0, 8.0, 14.0, 9.0, 0.0, 43.0, 13.0, 14.0, 0.0, 0.0, 29.0, 0.0, 12.0, 0.0, 0.0, 23.0, 0.0, 5.0, 17.0, 8.0, 0.0, 0.0, 10.0, 13.0, 10.0, 9.0, 24.0, 31.0, 0.0, 0.0, 0.0, 10.0, 6.0, 15.0, 0.0, 16.0, 0.0, 0.0, 9.0, 0.0, 3.0, 12.0, 4.0, 0.0, 0.0, 16.0, 11.0, 0.0, 10.0, 25.0, 34.0, 7.0, 16.0, 3.0, 11.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 7.0, 0.0, 20.0, 16.0, 0.0, 0.0, 0.0, 15.0, 9.0, 0.0, 0.0, 1.0, 26.0, 31.0, 22.0, 0.0, 0.0, 6.0, 6.0, 0.0, 10.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.215921858331812, "mean_inference_ms": 15.544214277408484, "mean_action_processing_ms": 0.7714222766307125, "mean_env_wait_ms": 2.32528026121205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006112456321716309, "StateBufferConnector_ms": 0.009821772575378418, "ViewRequirementAgentConnector_ms": 0.23703885078430176}, "num_episodes": 18, "episode_return_max": 380.0, "episode_return_min": 67.0, "episode_return_mean": 310.72, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 177.1687343460682, "num_env_steps_trained_throughput_per_sec": 177.1687343460682, "timesteps_total": 612000, "num_env_steps_sampled_lifetime": 612000, "num_agent_steps_sampled_lifetime": 2448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2448000, "timers": {"training_iteration_time_ms": 203365.578, "restore_workers_time_ms": 0.016, "training_step_time_ms": 203365.486, "sample_time_ms": 3132.492, "learn_time_ms": 200203.59, "learn_throughput": 19.98, "synch_weights_time_ms": 25.014}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000}, "done": false, "training_iteration": 153, "trial_id": "45bed_00000", "date": "2024-08-13_05-38-24", "timestamp": 1723541904, "time_this_iter_s": 22.625892162322998, "time_total_s": 16083.031344175339, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b478e670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16083.031344175339, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 91.015625, "ram_util_percent": 82.50312500000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0697035596681335, "cur_kl_coeff": 2.6469779601696887e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.43343613622365174, "policy_loss": -0.0008057796985167202, "vf_loss": 0.43424191620673924, "vf_explained_var": 0.012548085337593442, "kl": 0.0016491747604286853, "entropy": 0.07079128798235346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 290115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.763803319041691, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.962006313081772, "policy_loss": -0.007132262642071558, "vf_loss": 4.969138580024557, "vf_explained_var": 0.09913232209821227, "kl": 0.010530405917042874, "entropy": 1.2594121448577396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 290115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000}, "env_runners": {"episode_reward_max": 393.0, "episode_reward_min": 190.0, "episode_reward_mean": 313.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -26.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 66.0}, "policy_reward_mean": {"prey_policy": 145.815, "predator_policy": 10.855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [326.0, 308.0, 312.0, 313.0, 297.0, 379.0, 281.0, 353.0, 230.0, 284.0, 329.0, 290.0, 307.0, 281.0, 314.0, 235.0, 371.0, 293.0, 304.0, 334.0, 292.0, 276.0, 313.0, 292.0, 231.0, 349.0, 250.0, 330.0, 291.0, 342.0, 371.0, 320.0, 281.0, 209.0, 309.0, 277.0, 269.0, 282.0, 344.0, 190.0, 272.0, 222.0, 303.0, 277.0, 309.0, 303.0, 349.0, 314.0, 354.0, 300.0, 301.0, 299.0, 321.0, 353.0, 328.0, 291.0, 326.0, 343.0, 319.0, 334.0, 319.0, 351.0, 322.0, 278.0, 342.0, 377.0, 369.0, 345.0, 380.0, 361.0, 377.0, 319.0, 311.0, 347.0, 326.0, 373.0, 320.0, 340.0, 357.0, 346.0, 359.0, 309.0, 321.0, 260.0, 330.0, 252.0, 322.0, 337.0, 309.0, 278.0, 347.0, 393.0, 331.0, 363.0, 385.0, 272.0, 233.0, 226.0, 336.0, 334.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [126.0, 164.0, 76.0, 195.0, 149.0, 142.0, 176.0, 79.0, 200.0, 72.0, 186.0, 193.0, 99.0, 130.0, 151.0, 180.0, 27.0, 157.0, 188.0, 51.0, 158.0, 148.0, 189.0, 101.0, 154.0, 132.0, 200.0, 17.0, 134.0, 172.0, 166.0, 6.0, 186.0, 185.0, 104.0, 180.0, 100.0, 142.0, 147.0, 187.0, 191.0, 23.0, 44.0, 186.0, 128.0, 174.0, 200.0, 67.0, -17.0, 194.0, 184.0, 165.0, 156.0, 58.0, 149.0, 181.0, 106.0, 159.0, 182.0, 160.0, 188.0, 183.0, 162.0, 126.0, 168.0, 113.0, -26.0, 169.0, 82.0, 171.0, 53.0, 174.0, 86.0, 157.0, 113.0, 169.0, 168.0, 168.0, 147.0, 20.0, 163.0, 66.0, 93.0, 102.0, 174.0, 129.0, 179.0, 69.0, 146.0, 151.0, 112.0, 168.0, 181.0, 163.0, 132.0, 157.0, 180.0, 174.0, 122.0, 155.0, 117.0, 165.0, 170.0, 74.0, 149.0, 172.0, 170.0, 173.0, 160.0, 147.0, 102.0, 173.0, 150.0, 176.0, 169.0, 165.0, 166.0, 138.0, 141.0, 189.0, 174.0, 129.0, 191.0, 149.0, 123.0, 164.0, 82.0, 155.0, 131.0, 192.0, 161.0, 199.0, 182.0, 186.0, 174.0, 171.0, 189.0, 191.0, 186.0, 163.0, 191.0, 179.0, 185.0, 114.0, 134.0, 161.0, 181.0, 166.0, 164.0, 138.0, 194.0, 179.0, 107.0, 186.0, 180.0, 107.0, 169.0, 188.0, 161.0, 173.0, 160.0, 189.0, 146.0, 157.0, 129.0, 169.0, 151.0, 90.0, 135.0, 195.0, 128.0, 91.0, 109.0, 176.0, 161.0, 170.0, 130.0, 156.0, 99.0, 154.0, 127.0, 198.0, 195.0, 198.0, 182.0, 134.0, 187.0, 176.0, 196.0, 189.0, 172.0, 40.0, 93.0, 93.0, 140.0, 41.0, 184.0, 128.0, 156.0, 178.0], "policy_predator_policy_reward": [25.0, 11.0, 0.0, 37.0, 9.0, 12.0, 32.0, 26.0, 1.0, 24.0, 0.0, 0.0, 28.0, 24.0, 7.0, 15.0, 11.0, 35.0, 45.0, 0.0, 11.0, 12.0, 0.0, 0.0, 10.0, 11.0, 36.0, 28.0, 8.0, 0.0, 63.0, 0.0, 0.0, 0.0, 0.0, 9.0, 32.0, 30.0, 0.0, 0.0, 42.0, 36.0, 46.0, 0.0, 6.0, 5.0, 13.0, 12.0, 54.0, 0.0, 0.0, 0.0, 36.0, 0.0, 0.0, 0.0, 0.0, 26.0, 0.0, 0.0, 0.0, 0.0, 5.0, 27.0, 0.0, 0.0, 66.0, 0.0, 28.0, 28.0, 0.0, 50.0, 0.0, 26.0, 0.0, 0.0, 0.0, 8.0, 14.0, 9.0, 0.0, 43.0, 13.0, 14.0, 0.0, 0.0, 29.0, 0.0, 12.0, 0.0, 0.0, 23.0, 0.0, 5.0, 17.0, 8.0, 0.0, 0.0, 10.0, 13.0, 10.0, 9.0, 24.0, 31.0, 0.0, 0.0, 0.0, 10.0, 6.0, 15.0, 0.0, 16.0, 0.0, 0.0, 9.0, 0.0, 3.0, 12.0, 4.0, 0.0, 0.0, 16.0, 11.0, 0.0, 10.0, 25.0, 34.0, 7.0, 16.0, 3.0, 11.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 7.0, 0.0, 20.0, 16.0, 0.0, 0.0, 0.0, 15.0, 9.0, 0.0, 0.0, 1.0, 26.0, 31.0, 22.0, 0.0, 0.0, 6.0, 6.0, 0.0, 10.0, 6.0, 0.0, 9.0, 14.0, 11.0, 8.0, 0.0, 0.0, 19.0, 14.0, 11.0, 26.0, 0.0, 6.0, 0.0, 23.0, 0.0, 25.0, 22.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 38.0, 0.0, 47.0, 3.0, 42.0, 0.0, 24.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.194763676644292, "mean_inference_ms": 15.481302834531464, "mean_action_processing_ms": 0.7709430078290705, "mean_env_wait_ms": 2.314856243453844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005751609802246094, "StateBufferConnector_ms": 0.01515185832977295, "ViewRequirementAgentConnector_ms": 0.23830389976501465}, "num_episodes": 18, "episode_return_max": 393.0, "episode_return_min": 190.0, "episode_return_mean": 313.34, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.5238204401744, "num_env_steps_trained_throughput_per_sec": 204.5238204401744, "timesteps_total": 616000, "num_env_steps_sampled_lifetime": 616000, "num_agent_steps_sampled_lifetime": 2464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2464000, "timers": {"training_iteration_time_ms": 203278.048, "restore_workers_time_ms": 0.016, "training_step_time_ms": 203277.955, "sample_time_ms": 3269.882, "learn_time_ms": 199975.231, "learn_throughput": 20.002, "synch_weights_time_ms": 26.122}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000}, "done": false, "training_iteration": 154, "trial_id": "45bed_00000", "date": "2024-08-13_05-38-44", "timestamp": 1723541924, "time_this_iter_s": 19.596662998199463, "time_total_s": 16102.628007173538, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b528f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16102.628007173538, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 83.88214285714285, "ram_util_percent": 81.00714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6743549369472676, "cur_kl_coeff": 1.3234889800848444e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.395882261579945, "policy_loss": -0.00041510758850053347, "vf_loss": 0.39629736982862507, "vf_explained_var": 0.043886753774824594, "kl": 0.0009230947232747292, "entropy": 0.0747035019050436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 292005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9499899139479986, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.135949104425138, "policy_loss": -0.005139725282541895, "vf_loss": 4.141088834515324, "vf_explained_var": 0.054270789421424666, "kl": 0.013571435351490503, "entropy": 1.259334565533532, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 292005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "env_runners": {"episode_reward_max": 393.0, "episode_reward_min": 190.0, "episode_reward_mean": 320.18, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -26.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 66.0}, "policy_reward_mean": {"prey_policy": 151.57, "predator_policy": 8.52}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.0, 231.0, 349.0, 250.0, 330.0, 291.0, 342.0, 371.0, 320.0, 281.0, 209.0, 309.0, 277.0, 269.0, 282.0, 344.0, 190.0, 272.0, 222.0, 303.0, 277.0, 309.0, 303.0, 349.0, 314.0, 354.0, 300.0, 301.0, 299.0, 321.0, 353.0, 328.0, 291.0, 326.0, 343.0, 319.0, 334.0, 319.0, 351.0, 322.0, 278.0, 342.0, 377.0, 369.0, 345.0, 380.0, 361.0, 377.0, 319.0, 311.0, 347.0, 326.0, 373.0, 320.0, 340.0, 357.0, 346.0, 359.0, 309.0, 321.0, 260.0, 330.0, 252.0, 322.0, 337.0, 309.0, 278.0, 347.0, 393.0, 331.0, 363.0, 385.0, 272.0, 233.0, 226.0, 336.0, 334.0, 327.0, 342.0, 345.0, 302.0, 342.0, 370.0, 299.0, 338.0, 306.0, 342.0, 313.0, 316.0, 355.0, 384.0, 352.0, 363.0, 330.0, 326.0, 298.0, 339.0, 313.0, 324.0, 380.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 67.0, -17.0, 194.0, 184.0, 165.0, 156.0, 58.0, 149.0, 181.0, 106.0, 159.0, 182.0, 160.0, 188.0, 183.0, 162.0, 126.0, 168.0, 113.0, -26.0, 169.0, 82.0, 171.0, 53.0, 174.0, 86.0, 157.0, 113.0, 169.0, 168.0, 168.0, 147.0, 20.0, 163.0, 66.0, 93.0, 102.0, 174.0, 129.0, 179.0, 69.0, 146.0, 151.0, 112.0, 168.0, 181.0, 163.0, 132.0, 157.0, 180.0, 174.0, 122.0, 155.0, 117.0, 165.0, 170.0, 74.0, 149.0, 172.0, 170.0, 173.0, 160.0, 147.0, 102.0, 173.0, 150.0, 176.0, 169.0, 165.0, 166.0, 138.0, 141.0, 189.0, 174.0, 129.0, 191.0, 149.0, 123.0, 164.0, 82.0, 155.0, 131.0, 192.0, 161.0, 199.0, 182.0, 186.0, 174.0, 171.0, 189.0, 191.0, 186.0, 163.0, 191.0, 179.0, 185.0, 114.0, 134.0, 161.0, 181.0, 166.0, 164.0, 138.0, 194.0, 179.0, 107.0, 186.0, 180.0, 107.0, 169.0, 188.0, 161.0, 173.0, 160.0, 189.0, 146.0, 157.0, 129.0, 169.0, 151.0, 90.0, 135.0, 195.0, 128.0, 91.0, 109.0, 176.0, 161.0, 170.0, 130.0, 156.0, 99.0, 154.0, 127.0, 198.0, 195.0, 198.0, 182.0, 134.0, 187.0, 176.0, 196.0, 189.0, 172.0, 40.0, 93.0, 93.0, 140.0, 41.0, 184.0, 128.0, 156.0, 178.0, 134.0, 151.0, 117.0, 195.0, 165.0, 180.0, 175.0, 122.0, 175.0, 152.0, 190.0, 180.0, 156.0, 139.0, 120.0, 195.0, 185.0, 121.0, 169.0, 166.0, 171.0, 108.0, 145.0, 165.0, 178.0, 163.0, 188.0, 196.0, 183.0, 168.0, 175.0, 179.0, 171.0, 159.0, 168.0, 158.0, 131.0, 153.0, 151.0, 188.0, 116.0, 177.0, 160.0, 128.0, 193.0, 187.0], "policy_predator_policy_reward": [13.0, 12.0, 54.0, 0.0, 0.0, 0.0, 36.0, 0.0, 0.0, 0.0, 0.0, 26.0, 0.0, 0.0, 0.0, 0.0, 5.0, 27.0, 0.0, 0.0, 66.0, 0.0, 28.0, 28.0, 0.0, 50.0, 0.0, 26.0, 0.0, 0.0, 0.0, 8.0, 14.0, 9.0, 0.0, 43.0, 13.0, 14.0, 0.0, 0.0, 29.0, 0.0, 12.0, 0.0, 0.0, 23.0, 0.0, 5.0, 17.0, 8.0, 0.0, 0.0, 10.0, 13.0, 10.0, 9.0, 24.0, 31.0, 0.0, 0.0, 0.0, 10.0, 6.0, 15.0, 0.0, 16.0, 0.0, 0.0, 9.0, 0.0, 3.0, 12.0, 4.0, 0.0, 0.0, 16.0, 11.0, 0.0, 10.0, 25.0, 34.0, 7.0, 16.0, 3.0, 11.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 7.0, 0.0, 20.0, 16.0, 0.0, 0.0, 0.0, 15.0, 9.0, 0.0, 0.0, 1.0, 26.0, 31.0, 22.0, 0.0, 0.0, 6.0, 6.0, 0.0, 10.0, 6.0, 0.0, 9.0, 14.0, 11.0, 8.0, 0.0, 0.0, 19.0, 14.0, 11.0, 26.0, 0.0, 6.0, 0.0, 23.0, 0.0, 25.0, 22.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 38.0, 0.0, 47.0, 3.0, 42.0, 0.0, 24.0, 0.0, 0.0, 20.0, 22.0, 9.0, 21.0, 0.0, 0.0, 5.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 20.0, 0.0, 0.0, 7.0, 0.0, 8.0, 26.0, 4.0, 2.0, 4.0, 10.0, 0.0, 0.0, 0.0, 1.0, 1.0, 8.0, 0.0, 0.0, 0.0, 0.0, 6.0, 8.0, 0.0, 0.0, 16.0, 4.0, 20.0, 16.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.16364226413585, "mean_inference_ms": 15.404183088418769, "mean_action_processing_ms": 0.7704157141469073, "mean_env_wait_ms": 2.3046700331362455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005148172378540039, "StateBufferConnector_ms": 0.014864802360534668, "ViewRequirementAgentConnector_ms": 0.26119518280029297}, "num_episodes": 23, "episode_return_max": 393.0, "episode_return_min": 190.0, "episode_return_mean": 320.18, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.44144634635614, "num_env_steps_trained_throughput_per_sec": 217.44144634635614, "timesteps_total": 620000, "num_env_steps_sampled_lifetime": 620000, "num_agent_steps_sampled_lifetime": 2480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2480000, "timers": {"training_iteration_time_ms": 203027.969, "restore_workers_time_ms": 0.035, "training_step_time_ms": 203027.856, "sample_time_ms": 3271.482, "learn_time_ms": 199725.878, "learn_throughput": 20.027, "synch_weights_time_ms": 23.872}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "done": false, "training_iteration": 155, "trial_id": "45bed_00000", "date": "2024-08-13_05-39-02", "timestamp": 1723541942, "time_this_iter_s": 18.452791929244995, "time_total_s": 16121.080799102783, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b52fbb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16121.080799102783, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 83.66923076923078, "ram_util_percent": 81.00000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.836384368648447, "cur_kl_coeff": 6.617444900424222e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4207463295844497, "policy_loss": -0.0012326502881786496, "vf_loss": 0.4219789794704719, "vf_explained_var": 0.03929207220910087, "kl": 0.0018679729928070534, "entropy": 0.05612376155381007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 293895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.919616916886082, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.219926829817434, "policy_loss": -0.0021897727845325357, "vf_loss": 3.2221166019086485, "vf_explained_var": 0.33380696537002685, "kl": 0.018409929162676728, "entropy": 1.2484266421782277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 293895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000}, "env_runners": {"episode_reward_max": 393.0, "episode_reward_min": 226.0, "episode_reward_mean": 334.51, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 40.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 47.0}, "policy_reward_mean": {"prey_policy": 160.44, "predator_policy": 6.815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [303.0, 349.0, 314.0, 354.0, 300.0, 301.0, 299.0, 321.0, 353.0, 328.0, 291.0, 326.0, 343.0, 319.0, 334.0, 319.0, 351.0, 322.0, 278.0, 342.0, 377.0, 369.0, 345.0, 380.0, 361.0, 377.0, 319.0, 311.0, 347.0, 326.0, 373.0, 320.0, 340.0, 357.0, 346.0, 359.0, 309.0, 321.0, 260.0, 330.0, 252.0, 322.0, 337.0, 309.0, 278.0, 347.0, 393.0, 331.0, 363.0, 385.0, 272.0, 233.0, 226.0, 336.0, 334.0, 327.0, 342.0, 345.0, 302.0, 342.0, 370.0, 299.0, 338.0, 306.0, 342.0, 313.0, 316.0, 355.0, 384.0, 352.0, 363.0, 330.0, 326.0, 298.0, 339.0, 313.0, 324.0, 380.0, 356.0, 367.0, 369.0, 377.0, 353.0, 260.0, 366.0, 370.0, 344.0, 343.0, 373.0, 371.0, 354.0, 360.0, 366.0, 365.0, 327.0, 358.0, 389.0, 303.0, 366.0, 316.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [112.0, 168.0, 181.0, 163.0, 132.0, 157.0, 180.0, 174.0, 122.0, 155.0, 117.0, 165.0, 170.0, 74.0, 149.0, 172.0, 170.0, 173.0, 160.0, 147.0, 102.0, 173.0, 150.0, 176.0, 169.0, 165.0, 166.0, 138.0, 141.0, 189.0, 174.0, 129.0, 191.0, 149.0, 123.0, 164.0, 82.0, 155.0, 131.0, 192.0, 161.0, 199.0, 182.0, 186.0, 174.0, 171.0, 189.0, 191.0, 186.0, 163.0, 191.0, 179.0, 185.0, 114.0, 134.0, 161.0, 181.0, 166.0, 164.0, 138.0, 194.0, 179.0, 107.0, 186.0, 180.0, 107.0, 169.0, 188.0, 161.0, 173.0, 160.0, 189.0, 146.0, 157.0, 129.0, 169.0, 151.0, 90.0, 135.0, 195.0, 128.0, 91.0, 109.0, 176.0, 161.0, 170.0, 130.0, 156.0, 99.0, 154.0, 127.0, 198.0, 195.0, 198.0, 182.0, 134.0, 187.0, 176.0, 196.0, 189.0, 172.0, 40.0, 93.0, 93.0, 140.0, 41.0, 184.0, 128.0, 156.0, 178.0, 134.0, 151.0, 117.0, 195.0, 165.0, 180.0, 175.0, 122.0, 175.0, 152.0, 190.0, 180.0, 156.0, 139.0, 120.0, 195.0, 185.0, 121.0, 169.0, 166.0, 171.0, 108.0, 145.0, 165.0, 178.0, 163.0, 188.0, 196.0, 183.0, 168.0, 175.0, 179.0, 171.0, 159.0, 168.0, 158.0, 131.0, 153.0, 151.0, 188.0, 116.0, 177.0, 160.0, 128.0, 193.0, 187.0, 192.0, 155.0, 179.0, 181.0, 187.0, 166.0, 187.0, 190.0, 194.0, 159.0, 150.0, 91.0, 158.0, 199.0, 194.0, 173.0, 164.0, 149.0, 174.0, 156.0, 185.0, 183.0, 191.0, 180.0, 184.0, 170.0, 164.0, 196.0, 199.0, 167.0, 165.0, 195.0, 124.0, 175.0, 189.0, 169.0, 199.0, 190.0, 169.0, 134.0, 183.0, 183.0, 169.0, 120.0], "policy_predator_policy_reward": [0.0, 23.0, 0.0, 5.0, 17.0, 8.0, 0.0, 0.0, 10.0, 13.0, 10.0, 9.0, 24.0, 31.0, 0.0, 0.0, 0.0, 10.0, 6.0, 15.0, 0.0, 16.0, 0.0, 0.0, 9.0, 0.0, 3.0, 12.0, 4.0, 0.0, 0.0, 16.0, 11.0, 0.0, 10.0, 25.0, 34.0, 7.0, 16.0, 3.0, 11.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 7.0, 0.0, 20.0, 16.0, 0.0, 0.0, 0.0, 15.0, 9.0, 0.0, 0.0, 1.0, 26.0, 31.0, 22.0, 0.0, 0.0, 6.0, 6.0, 0.0, 10.0, 6.0, 0.0, 9.0, 14.0, 11.0, 8.0, 0.0, 0.0, 19.0, 14.0, 11.0, 26.0, 0.0, 6.0, 0.0, 23.0, 0.0, 25.0, 22.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 38.0, 0.0, 47.0, 3.0, 42.0, 0.0, 24.0, 0.0, 0.0, 20.0, 22.0, 9.0, 21.0, 0.0, 0.0, 5.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 20.0, 0.0, 0.0, 7.0, 0.0, 8.0, 26.0, 4.0, 2.0, 4.0, 10.0, 0.0, 0.0, 0.0, 1.0, 1.0, 8.0, 0.0, 0.0, 0.0, 0.0, 6.0, 8.0, 0.0, 0.0, 16.0, 4.0, 20.0, 16.0, 0.0, 0.0, 0.0, 9.0, 0.0, 7.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 3.0, 6.0, 2.0, 1.0, 15.0, 16.0, 2.0, 11.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.140838313199663, "mean_inference_ms": 15.172224176941539, "mean_action_processing_ms": 0.7695408179246283, "mean_env_wait_ms": 2.444021226698893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004762887954711914, "StateBufferConnector_ms": 0.011402010917663574, "ViewRequirementAgentConnector_ms": 0.21697890758514404}, "num_episodes": 22, "episode_return_max": 393.0, "episode_return_min": 226.0, "episode_return_mean": 334.51, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 231.86128579987107, "num_env_steps_trained_throughput_per_sec": 231.86128579987107, "timesteps_total": 624000, "num_env_steps_sampled_lifetime": 624000, "num_agent_steps_sampled_lifetime": 2496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2496000, "timers": {"training_iteration_time_ms": 202739.395, "restore_workers_time_ms": 0.035, "training_step_time_ms": 202739.292, "sample_time_ms": 3210.055, "learn_time_ms": 199499.147, "learn_throughput": 20.05, "synch_weights_time_ms": 23.627}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000}, "done": false, "training_iteration": 156, "trial_id": "45bed_00000", "date": "2024-08-13_05-39-20", "timestamp": 1723541960, "time_this_iter_s": 17.30849575996399, "time_total_s": 16138.389294862747, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b530f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16138.389294862747, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 82.65, "ram_util_percent": 81.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2529703817630886, "cur_kl_coeff": 3.308722450212111e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.743913095338004, "policy_loss": -0.0011233769702138725, "vf_loss": 0.7450364721002718, "vf_explained_var": 0.023697140828642264, "kl": 0.001464134946736899, "entropy": 0.06770898134659523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.374812182358333, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4115606570369983, "policy_loss": -0.0013939199826271131, "vf_loss": 2.4129545825499075, "vf_explained_var": 0.3146141394105538, "kl": 0.015543458068716492, "entropy": 1.2582771183952453, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 2512000}, "env_runners": {"episode_reward_max": 393.0, "episode_reward_min": 226.0, "episode_reward_mean": 336.2, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 40.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 47.0}, "policy_reward_mean": {"prey_policy": 160.91, "predator_policy": 7.19}, "custom_metrics": {}, "hist_stats": {"episode_reward": [278.0, 342.0, 377.0, 369.0, 345.0, 380.0, 361.0, 377.0, 319.0, 311.0, 347.0, 326.0, 373.0, 320.0, 340.0, 357.0, 346.0, 359.0, 309.0, 321.0, 260.0, 330.0, 252.0, 322.0, 337.0, 309.0, 278.0, 347.0, 393.0, 331.0, 363.0, 385.0, 272.0, 233.0, 226.0, 336.0, 334.0, 327.0, 342.0, 345.0, 302.0, 342.0, 370.0, 299.0, 338.0, 306.0, 342.0, 313.0, 316.0, 355.0, 384.0, 352.0, 363.0, 330.0, 326.0, 298.0, 339.0, 313.0, 324.0, 380.0, 356.0, 367.0, 369.0, 377.0, 353.0, 260.0, 366.0, 370.0, 344.0, 343.0, 373.0, 371.0, 354.0, 360.0, 366.0, 365.0, 327.0, 358.0, 389.0, 303.0, 366.0, 316.0, 356.0, 291.0, 316.0, 282.0, 353.0, 315.0, 332.0, 367.0, 324.0, 350.0, 369.0, 354.0, 341.0, 308.0, 365.0, 324.0, 355.0, 294.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [82.0, 155.0, 131.0, 192.0, 161.0, 199.0, 182.0, 186.0, 174.0, 171.0, 189.0, 191.0, 186.0, 163.0, 191.0, 179.0, 185.0, 114.0, 134.0, 161.0, 181.0, 166.0, 164.0, 138.0, 194.0, 179.0, 107.0, 186.0, 180.0, 107.0, 169.0, 188.0, 161.0, 173.0, 160.0, 189.0, 146.0, 157.0, 129.0, 169.0, 151.0, 90.0, 135.0, 195.0, 128.0, 91.0, 109.0, 176.0, 161.0, 170.0, 130.0, 156.0, 99.0, 154.0, 127.0, 198.0, 195.0, 198.0, 182.0, 134.0, 187.0, 176.0, 196.0, 189.0, 172.0, 40.0, 93.0, 93.0, 140.0, 41.0, 184.0, 128.0, 156.0, 178.0, 134.0, 151.0, 117.0, 195.0, 165.0, 180.0, 175.0, 122.0, 175.0, 152.0, 190.0, 180.0, 156.0, 139.0, 120.0, 195.0, 185.0, 121.0, 169.0, 166.0, 171.0, 108.0, 145.0, 165.0, 178.0, 163.0, 188.0, 196.0, 183.0, 168.0, 175.0, 179.0, 171.0, 159.0, 168.0, 158.0, 131.0, 153.0, 151.0, 188.0, 116.0, 177.0, 160.0, 128.0, 193.0, 187.0, 192.0, 155.0, 179.0, 181.0, 187.0, 166.0, 187.0, 190.0, 194.0, 159.0, 150.0, 91.0, 158.0, 199.0, 194.0, 173.0, 164.0, 149.0, 174.0, 156.0, 185.0, 183.0, 191.0, 180.0, 184.0, 170.0, 164.0, 196.0, 199.0, 167.0, 165.0, 195.0, 124.0, 175.0, 189.0, 169.0, 199.0, 190.0, 169.0, 134.0, 183.0, 183.0, 169.0, 120.0, 179.0, 176.0, 166.0, 114.0, 176.0, 110.0, 107.0, 139.0, 183.0, 146.0, 171.0, 144.0, 131.0, 158.0, 197.0, 170.0, 162.0, 138.0, 187.0, 153.0, 184.0, 184.0, 188.0, 132.0, 134.0, 183.0, 140.0, 135.0, 153.0, 190.0, 164.0, 129.0, 191.0, 159.0, 160.0, 101.0], "policy_predator_policy_reward": [34.0, 7.0, 16.0, 3.0, 11.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 7.0, 0.0, 20.0, 16.0, 0.0, 0.0, 0.0, 15.0, 9.0, 0.0, 0.0, 1.0, 26.0, 31.0, 22.0, 0.0, 0.0, 6.0, 6.0, 0.0, 10.0, 6.0, 0.0, 9.0, 14.0, 11.0, 8.0, 0.0, 0.0, 19.0, 14.0, 11.0, 26.0, 0.0, 6.0, 0.0, 23.0, 0.0, 25.0, 22.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 38.0, 0.0, 47.0, 3.0, 42.0, 0.0, 24.0, 0.0, 0.0, 20.0, 22.0, 9.0, 21.0, 0.0, 0.0, 5.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 20.0, 0.0, 0.0, 7.0, 0.0, 8.0, 26.0, 4.0, 2.0, 4.0, 10.0, 0.0, 0.0, 0.0, 1.0, 1.0, 8.0, 0.0, 0.0, 0.0, 0.0, 6.0, 8.0, 0.0, 0.0, 16.0, 4.0, 20.0, 16.0, 0.0, 0.0, 0.0, 9.0, 0.0, 7.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 3.0, 6.0, 2.0, 1.0, 15.0, 16.0, 2.0, 11.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0, 1.0, 0.0, 11.0, 0.0, 7.0, 23.0, 30.0, 6.0, 9.0, 15.0, 0.0, 0.0, 20.0, 23.0, 0.0, 0.0, 12.0, 12.0, 0.0, 10.0, 0.0, 1.0, 17.0, 17.0, 24.0, 0.0, 17.0, 16.0, 14.0, 8.0, 0.0, 31.0, 5.0, 0.0, 30.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.119131776498612, "mean_inference_ms": 15.25868892705446, "mean_action_processing_ms": 0.768344271242859, "mean_env_wait_ms": 2.27951135375851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043038129806518555, "StateBufferConnector_ms": 0.011339187622070312, "ViewRequirementAgentConnector_ms": 0.242340087890625}, "num_episodes": 18, "episode_return_max": 393.0, "episode_return_min": 226.0, "episode_return_mean": 336.2, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 2512000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 228.86609081969456, "num_env_steps_trained_throughput_per_sec": 228.86609081969456, "timesteps_total": 628000, "num_env_steps_sampled_lifetime": 628000, "num_agent_steps_sampled_lifetime": 2512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2512000, "timers": {"training_iteration_time_ms": 202381.574, "restore_workers_time_ms": 0.035, "training_step_time_ms": 202381.471, "sample_time_ms": 3159.503, "learn_time_ms": 199191.296, "learn_throughput": 20.081, "synch_weights_time_ms": 23.611}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 2512000}, "done": false, "training_iteration": 157, "trial_id": "45bed_00000", "date": "2024-08-13_05-39-37", "timestamp": 1723541977, "time_this_iter_s": 17.53550887107849, "time_total_s": 16155.924803733826, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b52fbf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16155.924803733826, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 83.24799999999999, "ram_util_percent": 81.224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0126890170235168, "cur_kl_coeff": 1.6543612251060554e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6059668626340609, "policy_loss": -0.00103133444393438, "vf_loss": 0.6069981969681091, "vf_explained_var": 0.017526673702966598, "kl": 0.0017607127871109329, "entropy": 0.054408220818177574, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 297675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.667892318948236, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.579865877842777, "policy_loss": -0.006173286770431019, "vf_loss": 3.5860391642050766, "vf_explained_var": 0.3185798664572378, "kl": 0.021267635580026218, "entropy": 1.2860329903622785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 297675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000}, "env_runners": {"episode_reward_max": 393.0, "episode_reward_min": 219.0, "episode_reward_mean": 333.69, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 40.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 47.0}, "policy_reward_mean": {"prey_policy": 159.55, "predator_policy": 7.295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [309.0, 321.0, 260.0, 330.0, 252.0, 322.0, 337.0, 309.0, 278.0, 347.0, 393.0, 331.0, 363.0, 385.0, 272.0, 233.0, 226.0, 336.0, 334.0, 327.0, 342.0, 345.0, 302.0, 342.0, 370.0, 299.0, 338.0, 306.0, 342.0, 313.0, 316.0, 355.0, 384.0, 352.0, 363.0, 330.0, 326.0, 298.0, 339.0, 313.0, 324.0, 380.0, 356.0, 367.0, 369.0, 377.0, 353.0, 260.0, 366.0, 370.0, 344.0, 343.0, 373.0, 371.0, 354.0, 360.0, 366.0, 365.0, 327.0, 358.0, 389.0, 303.0, 366.0, 316.0, 356.0, 291.0, 316.0, 282.0, 353.0, 315.0, 332.0, 367.0, 324.0, 350.0, 369.0, 354.0, 341.0, 308.0, 365.0, 324.0, 355.0, 294.0, 345.0, 323.0, 386.0, 325.0, 330.0, 336.0, 310.0, 219.0, 371.0, 320.0, 375.0, 349.0, 337.0, 332.0, 347.0, 340.0, 333.0, 298.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [146.0, 157.0, 129.0, 169.0, 151.0, 90.0, 135.0, 195.0, 128.0, 91.0, 109.0, 176.0, 161.0, 170.0, 130.0, 156.0, 99.0, 154.0, 127.0, 198.0, 195.0, 198.0, 182.0, 134.0, 187.0, 176.0, 196.0, 189.0, 172.0, 40.0, 93.0, 93.0, 140.0, 41.0, 184.0, 128.0, 156.0, 178.0, 134.0, 151.0, 117.0, 195.0, 165.0, 180.0, 175.0, 122.0, 175.0, 152.0, 190.0, 180.0, 156.0, 139.0, 120.0, 195.0, 185.0, 121.0, 169.0, 166.0, 171.0, 108.0, 145.0, 165.0, 178.0, 163.0, 188.0, 196.0, 183.0, 168.0, 175.0, 179.0, 171.0, 159.0, 168.0, 158.0, 131.0, 153.0, 151.0, 188.0, 116.0, 177.0, 160.0, 128.0, 193.0, 187.0, 192.0, 155.0, 179.0, 181.0, 187.0, 166.0, 187.0, 190.0, 194.0, 159.0, 150.0, 91.0, 158.0, 199.0, 194.0, 173.0, 164.0, 149.0, 174.0, 156.0, 185.0, 183.0, 191.0, 180.0, 184.0, 170.0, 164.0, 196.0, 199.0, 167.0, 165.0, 195.0, 124.0, 175.0, 189.0, 169.0, 199.0, 190.0, 169.0, 134.0, 183.0, 183.0, 169.0, 120.0, 179.0, 176.0, 166.0, 114.0, 176.0, 110.0, 107.0, 139.0, 183.0, 146.0, 171.0, 144.0, 131.0, 158.0, 197.0, 170.0, 162.0, 138.0, 187.0, 153.0, 184.0, 184.0, 188.0, 132.0, 134.0, 183.0, 140.0, 135.0, 153.0, 190.0, 164.0, 129.0, 191.0, 159.0, 160.0, 101.0, 144.0, 193.0, 150.0, 173.0, 185.0, 200.0, 144.0, 167.0, 188.0, 140.0, 182.0, 152.0, 109.0, 183.0, 101.0, 95.0, 191.0, 180.0, 98.0, 190.0, 184.0, 189.0, 171.0, 178.0, 143.0, 175.0, 156.0, 176.0, 110.0, 182.0, 189.0, 108.0, 158.0, 151.0, 119.0, 142.0], "policy_predator_policy_reward": [6.0, 0.0, 9.0, 14.0, 11.0, 8.0, 0.0, 0.0, 19.0, 14.0, 11.0, 26.0, 0.0, 6.0, 0.0, 23.0, 0.0, 25.0, 22.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 38.0, 0.0, 47.0, 3.0, 42.0, 0.0, 24.0, 0.0, 0.0, 20.0, 22.0, 9.0, 21.0, 0.0, 0.0, 5.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 20.0, 0.0, 0.0, 7.0, 0.0, 8.0, 26.0, 4.0, 2.0, 4.0, 10.0, 0.0, 0.0, 0.0, 1.0, 1.0, 8.0, 0.0, 0.0, 0.0, 0.0, 6.0, 8.0, 0.0, 0.0, 16.0, 4.0, 20.0, 16.0, 0.0, 0.0, 0.0, 9.0, 0.0, 7.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 3.0, 6.0, 2.0, 1.0, 15.0, 16.0, 2.0, 11.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0, 1.0, 0.0, 11.0, 0.0, 7.0, 23.0, 30.0, 6.0, 9.0, 15.0, 0.0, 0.0, 20.0, 23.0, 0.0, 0.0, 12.0, 12.0, 0.0, 10.0, 0.0, 1.0, 17.0, 17.0, 24.0, 0.0, 17.0, 16.0, 14.0, 8.0, 0.0, 31.0, 5.0, 0.0, 30.0, 3.0, 0.0, 8.0, 0.0, 0.0, 1.0, 0.0, 14.0, 0.0, 0.0, 2.0, 0.0, 2.0, 18.0, 0.0, 23.0, 0.0, 0.0, 0.0, 23.0, 9.0, 2.0, 0.0, 0.0, 0.0, 3.0, 16.0, 0.0, 0.0, 30.0, 25.0, 15.0, 28.0, 14.0, 10.0, 18.0, 19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0963792724221015, "mean_inference_ms": 15.190309807289523, "mean_action_processing_ms": 0.766883661697162, "mean_env_wait_ms": 2.268710649564502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006509065628051758, "StateBufferConnector_ms": 0.011725306510925293, "ViewRequirementAgentConnector_ms": 0.21482205390930176}, "num_episodes": 18, "episode_return_max": 393.0, "episode_return_min": 219.0, "episode_return_mean": 333.69, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 221.96028267879552, "num_env_steps_trained_throughput_per_sec": 221.96028267879552, "timesteps_total": 632000, "num_env_steps_sampled_lifetime": 632000, "num_agent_steps_sampled_lifetime": 2528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2528000, "timers": {"training_iteration_time_ms": 201956.903, "restore_workers_time_ms": 0.035, "training_step_time_ms": 201956.801, "sample_time_ms": 3114.433, "learn_time_ms": 198811.649, "learn_throughput": 20.12, "synch_weights_time_ms": 23.736}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000}, "done": false, "training_iteration": 158, "trial_id": "45bed_00000", "date": "2024-08-13_05-39-55", "timestamp": 1723541995, "time_this_iter_s": 18.058068990707397, "time_total_s": 16173.982872724533, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b44b4ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16173.982872724533, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 83.9076923076923, "ram_util_percent": 81.48076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7003556583884847, "cur_kl_coeff": 8.271806125530277e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5361726450147453, "policy_loss": -0.0011354821840074485, "vf_loss": 0.537308128610273, "vf_explained_var": 0.011064136154437191, "kl": 0.000905782123384277, "entropy": 0.04212704904466158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 299565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9289024885211674, "cur_kl_coeff": 2.5579538487363614e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2631166459391356, "policy_loss": -0.00402788405981723, "vf_loss": 3.26714453533213, "vf_explained_var": 0.22331831007407457, "kl": 0.02006525380873321, "entropy": 1.275407455144105, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 299565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000}, "env_runners": {"episode_reward_max": 389.0, "episode_reward_min": 219.0, "episode_reward_mean": 336.44, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 81.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 43.0}, "policy_reward_mean": {"prey_policy": 161.07, "predator_policy": 7.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 327.0, 342.0, 345.0, 302.0, 342.0, 370.0, 299.0, 338.0, 306.0, 342.0, 313.0, 316.0, 355.0, 384.0, 352.0, 363.0, 330.0, 326.0, 298.0, 339.0, 313.0, 324.0, 380.0, 356.0, 367.0, 369.0, 377.0, 353.0, 260.0, 366.0, 370.0, 344.0, 343.0, 373.0, 371.0, 354.0, 360.0, 366.0, 365.0, 327.0, 358.0, 389.0, 303.0, 366.0, 316.0, 356.0, 291.0, 316.0, 282.0, 353.0, 315.0, 332.0, 367.0, 324.0, 350.0, 369.0, 354.0, 341.0, 308.0, 365.0, 324.0, 355.0, 294.0, 345.0, 323.0, 386.0, 325.0, 330.0, 336.0, 310.0, 219.0, 371.0, 320.0, 375.0, 349.0, 337.0, 332.0, 347.0, 340.0, 333.0, 298.0, 348.0, 272.0, 360.0, 299.0, 287.0, 365.0, 339.0, 306.0, 320.0, 373.0, 318.0, 282.0, 285.0, 330.0, 356.0, 375.0, 330.0, 334.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [156.0, 178.0, 134.0, 151.0, 117.0, 195.0, 165.0, 180.0, 175.0, 122.0, 175.0, 152.0, 190.0, 180.0, 156.0, 139.0, 120.0, 195.0, 185.0, 121.0, 169.0, 166.0, 171.0, 108.0, 145.0, 165.0, 178.0, 163.0, 188.0, 196.0, 183.0, 168.0, 175.0, 179.0, 171.0, 159.0, 168.0, 158.0, 131.0, 153.0, 151.0, 188.0, 116.0, 177.0, 160.0, 128.0, 193.0, 187.0, 192.0, 155.0, 179.0, 181.0, 187.0, 166.0, 187.0, 190.0, 194.0, 159.0, 150.0, 91.0, 158.0, 199.0, 194.0, 173.0, 164.0, 149.0, 174.0, 156.0, 185.0, 183.0, 191.0, 180.0, 184.0, 170.0, 164.0, 196.0, 199.0, 167.0, 165.0, 195.0, 124.0, 175.0, 189.0, 169.0, 199.0, 190.0, 169.0, 134.0, 183.0, 183.0, 169.0, 120.0, 179.0, 176.0, 166.0, 114.0, 176.0, 110.0, 107.0, 139.0, 183.0, 146.0, 171.0, 144.0, 131.0, 158.0, 197.0, 170.0, 162.0, 138.0, 187.0, 153.0, 184.0, 184.0, 188.0, 132.0, 134.0, 183.0, 140.0, 135.0, 153.0, 190.0, 164.0, 129.0, 191.0, 159.0, 160.0, 101.0, 144.0, 193.0, 150.0, 173.0, 185.0, 200.0, 144.0, 167.0, 188.0, 140.0, 182.0, 152.0, 109.0, 183.0, 101.0, 95.0, 191.0, 180.0, 98.0, 190.0, 184.0, 189.0, 171.0, 178.0, 143.0, 175.0, 156.0, 176.0, 110.0, 182.0, 189.0, 108.0, 158.0, 151.0, 119.0, 142.0, 168.0, 176.0, 99.0, 114.0, 177.0, 177.0, 184.0, 115.0, 120.0, 122.0, 177.0, 188.0, 170.0, 169.0, 185.0, 118.0, 184.0, 113.0, 171.0, 192.0, 111.0, 172.0, 81.0, 143.0, 124.0, 118.0, 166.0, 164.0, 155.0, 187.0, 191.0, 172.0, 171.0, 132.0, 149.0, 168.0], "policy_predator_policy_reward": [0.0, 0.0, 20.0, 22.0, 9.0, 21.0, 0.0, 0.0, 5.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 20.0, 0.0, 0.0, 7.0, 0.0, 8.0, 26.0, 4.0, 2.0, 4.0, 10.0, 0.0, 0.0, 0.0, 1.0, 1.0, 8.0, 0.0, 0.0, 0.0, 0.0, 6.0, 8.0, 0.0, 0.0, 16.0, 4.0, 20.0, 16.0, 0.0, 0.0, 0.0, 9.0, 0.0, 7.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 3.0, 6.0, 2.0, 1.0, 15.0, 16.0, 2.0, 11.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0, 1.0, 0.0, 11.0, 0.0, 7.0, 23.0, 30.0, 6.0, 9.0, 15.0, 0.0, 0.0, 20.0, 23.0, 0.0, 0.0, 12.0, 12.0, 0.0, 10.0, 0.0, 1.0, 17.0, 17.0, 24.0, 0.0, 17.0, 16.0, 14.0, 8.0, 0.0, 31.0, 5.0, 0.0, 30.0, 3.0, 0.0, 8.0, 0.0, 0.0, 1.0, 0.0, 14.0, 0.0, 0.0, 2.0, 0.0, 2.0, 18.0, 0.0, 23.0, 0.0, 0.0, 0.0, 23.0, 9.0, 2.0, 0.0, 0.0, 0.0, 3.0, 16.0, 0.0, 0.0, 30.0, 25.0, 15.0, 28.0, 14.0, 10.0, 18.0, 19.0, 4.0, 0.0, 24.0, 35.0, 6.0, 0.0, 0.0, 0.0, 24.0, 21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 23.0, 4.0, 6.0, 27.0, 8.0, 34.0, 24.0, 43.0, 0.0, 0.0, 0.0, 14.0, 0.0, 6.0, 6.0, 13.0, 14.0, 17.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.072977421679597, "mean_inference_ms": 15.120684593311212, "mean_action_processing_ms": 0.7650332616515161, "mean_env_wait_ms": 2.257817284929503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008256912231445312, "StateBufferConnector_ms": 0.004177451133728027, "ViewRequirementAgentConnector_ms": 0.22034800052642822}, "num_episodes": 18, "episode_return_max": 389.0, "episode_return_min": 219.0, "episode_return_mean": 336.44, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.14193890147803, "num_env_steps_trained_throughput_per_sec": 213.14193890147803, "timesteps_total": 636000, "num_env_steps_sampled_lifetime": 636000, "num_agent_steps_sampled_lifetime": 2544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2544000, "timers": {"training_iteration_time_ms": 201623.629, "restore_workers_time_ms": 0.035, "training_step_time_ms": 201623.526, "sample_time_ms": 3059.331, "learn_time_ms": 198533.767, "learn_throughput": 20.148, "synch_weights_time_ms": 23.449}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000}, "done": false, "training_iteration": 159, "trial_id": "45bed_00000", "date": "2024-08-13_05-40-14", "timestamp": 1723542014, "time_this_iter_s": 18.829262018203735, "time_total_s": 16192.812134742737, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b51f4310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16192.812134742737, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 83.5576923076923, "ram_util_percent": 81.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8150360624724753, "cur_kl_coeff": 4.1359030627651386e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.237317709975122, "policy_loss": -0.0006530472052791132, "vf_loss": 0.2379707571200376, "vf_explained_var": -0.000237341564168375, "kl": 0.0015117032317829048, "entropy": 0.06002938122976394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 301455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.853705044808211, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.212877483594985, "policy_loss": -0.008282108001396178, "vf_loss": 2.2211595958502834, "vf_explained_var": 0.43193294566775126, "kl": 0.01806873404577864, "entropy": 1.319981575012207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 301455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "env_runners": {"episode_reward_max": 389.0, "episode_reward_min": 219.0, "episode_reward_mean": 340.98, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 51.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 48.0}, "policy_reward_mean": {"prey_policy": 163.65, "predator_policy": 6.84}, "custom_metrics": {}, "hist_stats": {"episode_reward": [377.0, 353.0, 260.0, 366.0, 370.0, 344.0, 343.0, 373.0, 371.0, 354.0, 360.0, 366.0, 365.0, 327.0, 358.0, 389.0, 303.0, 366.0, 316.0, 356.0, 291.0, 316.0, 282.0, 353.0, 315.0, 332.0, 367.0, 324.0, 350.0, 369.0, 354.0, 341.0, 308.0, 365.0, 324.0, 355.0, 294.0, 345.0, 323.0, 386.0, 325.0, 330.0, 336.0, 310.0, 219.0, 371.0, 320.0, 375.0, 349.0, 337.0, 332.0, 347.0, 340.0, 333.0, 298.0, 348.0, 272.0, 360.0, 299.0, 287.0, 365.0, 339.0, 306.0, 320.0, 373.0, 318.0, 282.0, 285.0, 330.0, 356.0, 375.0, 330.0, 334.0, 302.0, 378.0, 381.0, 299.0, 384.0, 364.0, 385.0, 294.0, 349.0, 353.0, 365.0, 360.0, 348.0, 368.0, 366.0, 371.0, 352.0, 370.0, 320.0, 366.0, 364.0, 378.0, 363.0, 361.0, 308.0, 373.0, 364.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [187.0, 190.0, 194.0, 159.0, 150.0, 91.0, 158.0, 199.0, 194.0, 173.0, 164.0, 149.0, 174.0, 156.0, 185.0, 183.0, 191.0, 180.0, 184.0, 170.0, 164.0, 196.0, 199.0, 167.0, 165.0, 195.0, 124.0, 175.0, 189.0, 169.0, 199.0, 190.0, 169.0, 134.0, 183.0, 183.0, 169.0, 120.0, 179.0, 176.0, 166.0, 114.0, 176.0, 110.0, 107.0, 139.0, 183.0, 146.0, 171.0, 144.0, 131.0, 158.0, 197.0, 170.0, 162.0, 138.0, 187.0, 153.0, 184.0, 184.0, 188.0, 132.0, 134.0, 183.0, 140.0, 135.0, 153.0, 190.0, 164.0, 129.0, 191.0, 159.0, 160.0, 101.0, 144.0, 193.0, 150.0, 173.0, 185.0, 200.0, 144.0, 167.0, 188.0, 140.0, 182.0, 152.0, 109.0, 183.0, 101.0, 95.0, 191.0, 180.0, 98.0, 190.0, 184.0, 189.0, 171.0, 178.0, 143.0, 175.0, 156.0, 176.0, 110.0, 182.0, 189.0, 108.0, 158.0, 151.0, 119.0, 142.0, 168.0, 176.0, 99.0, 114.0, 177.0, 177.0, 184.0, 115.0, 120.0, 122.0, 177.0, 188.0, 170.0, 169.0, 185.0, 118.0, 184.0, 113.0, 171.0, 192.0, 111.0, 172.0, 81.0, 143.0, 124.0, 118.0, 166.0, 164.0, 155.0, 187.0, 191.0, 172.0, 171.0, 132.0, 149.0, 168.0, 115.0, 146.0, 182.0, 193.0, 197.0, 183.0, 149.0, 126.0, 189.0, 195.0, 196.0, 168.0, 189.0, 196.0, 51.0, 195.0, 156.0, 193.0, 185.0, 168.0, 171.0, 194.0, 153.0, 195.0, 174.0, 174.0, 181.0, 182.0, 197.0, 166.0, 184.0, 186.0, 177.0, 168.0, 200.0, 167.0, 145.0, 149.0, 188.0, 171.0, 189.0, 175.0, 187.0, 187.0, 179.0, 184.0, 170.0, 182.0, 107.0, 165.0, 179.0, 194.0, 186.0, 178.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 3.0, 6.0, 2.0, 1.0, 15.0, 16.0, 2.0, 11.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0, 1.0, 0.0, 11.0, 0.0, 7.0, 23.0, 30.0, 6.0, 9.0, 15.0, 0.0, 0.0, 20.0, 23.0, 0.0, 0.0, 12.0, 12.0, 0.0, 10.0, 0.0, 1.0, 17.0, 17.0, 24.0, 0.0, 17.0, 16.0, 14.0, 8.0, 0.0, 31.0, 5.0, 0.0, 30.0, 3.0, 0.0, 8.0, 0.0, 0.0, 1.0, 0.0, 14.0, 0.0, 0.0, 2.0, 0.0, 2.0, 18.0, 0.0, 23.0, 0.0, 0.0, 0.0, 23.0, 9.0, 2.0, 0.0, 0.0, 0.0, 3.0, 16.0, 0.0, 0.0, 30.0, 25.0, 15.0, 28.0, 14.0, 10.0, 18.0, 19.0, 4.0, 0.0, 24.0, 35.0, 6.0, 0.0, 0.0, 0.0, 24.0, 21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 23.0, 4.0, 6.0, 27.0, 8.0, 34.0, 24.0, 43.0, 0.0, 0.0, 0.0, 14.0, 0.0, 6.0, 6.0, 13.0, 14.0, 17.0, 0.0, 23.0, 18.0, 3.0, 0.0, 1.0, 0.0, 7.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 48.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 5.0, 3.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 3.0, 12.0, 14.0, 0.0, 7.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 28.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.038040357998098, "mean_inference_ms": 14.871721456174651, "mean_action_processing_ms": 0.7621788028714651, "mean_env_wait_ms": 2.3924924429264496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013096928596496582, "StateBufferConnector_ms": 0.004566311836242676, "ViewRequirementAgentConnector_ms": 0.18457210063934326}, "num_episodes": 27, "episode_return_max": 389.0, "episode_return_min": 219.0, "episode_return_mean": 340.98, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.46560117458432, "num_env_steps_trained_throughput_per_sec": 148.46560117458432, "timesteps_total": 640000, "num_env_steps_sampled_lifetime": 640000, "num_agent_steps_sampled_lifetime": 2560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2560000, "timers": {"training_iteration_time_ms": 110487.029, "restore_workers_time_ms": 0.038, "training_step_time_ms": 110486.921, "sample_time_ms": 3028.198, "learn_time_ms": 107428.259, "learn_throughput": 37.234, "synch_weights_time_ms": 22.647}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "done": false, "training_iteration": 160, "trial_id": "45bed_00000", "date": "2024-08-13_05-40-41", "timestamp": 1723542041, "time_this_iter_s": 27.011698961257935, "time_total_s": 16219.823833703995, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b52c68b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16219.823833703995, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 88.9, "ram_util_percent": 83.27894736842104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0684823137703081, "cur_kl_coeff": 2.0679515313825693e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3089571657910864, "policy_loss": -0.001719345236640601, "vf_loss": 0.3106765104551361, "vf_explained_var": 0.035283361824731976, "kl": 0.0016985469118588673, "entropy": 0.06757993286761342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 303345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6457597363405125, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3223799949758268, "policy_loss": -0.0040023607215425245, "vf_loss": 1.3263823583327905, "vf_explained_var": 0.2772776833286992, "kl": 0.01991465675377088, "entropy": 1.3409469901569306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 303345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000}, "env_runners": {"episode_reward_max": 399.0, "episode_reward_min": 219.0, "episode_reward_mean": 343.09, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 51.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 48.0}, "policy_reward_mean": {"prey_policy": 164.41, "predator_policy": 7.135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [316.0, 356.0, 291.0, 316.0, 282.0, 353.0, 315.0, 332.0, 367.0, 324.0, 350.0, 369.0, 354.0, 341.0, 308.0, 365.0, 324.0, 355.0, 294.0, 345.0, 323.0, 386.0, 325.0, 330.0, 336.0, 310.0, 219.0, 371.0, 320.0, 375.0, 349.0, 337.0, 332.0, 347.0, 340.0, 333.0, 298.0, 348.0, 272.0, 360.0, 299.0, 287.0, 365.0, 339.0, 306.0, 320.0, 373.0, 318.0, 282.0, 285.0, 330.0, 356.0, 375.0, 330.0, 334.0, 302.0, 378.0, 381.0, 299.0, 384.0, 364.0, 385.0, 294.0, 349.0, 353.0, 365.0, 360.0, 348.0, 368.0, 366.0, 371.0, 352.0, 370.0, 320.0, 366.0, 364.0, 378.0, 363.0, 361.0, 308.0, 373.0, 364.0, 382.0, 367.0, 341.0, 360.0, 399.0, 357.0, 383.0, 397.0, 336.0, 364.0, 377.0, 319.0, 349.0, 367.0, 320.0, 387.0, 375.0, 376.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [169.0, 120.0, 179.0, 176.0, 166.0, 114.0, 176.0, 110.0, 107.0, 139.0, 183.0, 146.0, 171.0, 144.0, 131.0, 158.0, 197.0, 170.0, 162.0, 138.0, 187.0, 153.0, 184.0, 184.0, 188.0, 132.0, 134.0, 183.0, 140.0, 135.0, 153.0, 190.0, 164.0, 129.0, 191.0, 159.0, 160.0, 101.0, 144.0, 193.0, 150.0, 173.0, 185.0, 200.0, 144.0, 167.0, 188.0, 140.0, 182.0, 152.0, 109.0, 183.0, 101.0, 95.0, 191.0, 180.0, 98.0, 190.0, 184.0, 189.0, 171.0, 178.0, 143.0, 175.0, 156.0, 176.0, 110.0, 182.0, 189.0, 108.0, 158.0, 151.0, 119.0, 142.0, 168.0, 176.0, 99.0, 114.0, 177.0, 177.0, 184.0, 115.0, 120.0, 122.0, 177.0, 188.0, 170.0, 169.0, 185.0, 118.0, 184.0, 113.0, 171.0, 192.0, 111.0, 172.0, 81.0, 143.0, 124.0, 118.0, 166.0, 164.0, 155.0, 187.0, 191.0, 172.0, 171.0, 132.0, 149.0, 168.0, 115.0, 146.0, 182.0, 193.0, 197.0, 183.0, 149.0, 126.0, 189.0, 195.0, 196.0, 168.0, 189.0, 196.0, 51.0, 195.0, 156.0, 193.0, 185.0, 168.0, 171.0, 194.0, 153.0, 195.0, 174.0, 174.0, 181.0, 182.0, 197.0, 166.0, 184.0, 186.0, 177.0, 168.0, 200.0, 167.0, 145.0, 149.0, 188.0, 171.0, 189.0, 175.0, 187.0, 187.0, 179.0, 184.0, 170.0, 182.0, 107.0, 165.0, 179.0, 194.0, 186.0, 178.0, 192.0, 187.0, 143.0, 199.0, 137.0, 181.0, 147.0, 193.0, 200.0, 199.0, 157.0, 192.0, 192.0, 191.0, 197.0, 200.0, 169.0, 160.0, 179.0, 185.0, 192.0, 178.0, 176.0, 103.0, 171.0, 178.0, 169.0, 198.0, 154.0, 151.0, 187.0, 200.0, 200.0, 160.0, 194.0, 173.0], "policy_predator_policy_reward": [0.0, 27.0, 1.0, 0.0, 11.0, 0.0, 7.0, 23.0, 30.0, 6.0, 9.0, 15.0, 0.0, 0.0, 20.0, 23.0, 0.0, 0.0, 12.0, 12.0, 0.0, 10.0, 0.0, 1.0, 17.0, 17.0, 24.0, 0.0, 17.0, 16.0, 14.0, 8.0, 0.0, 31.0, 5.0, 0.0, 30.0, 3.0, 0.0, 8.0, 0.0, 0.0, 1.0, 0.0, 14.0, 0.0, 0.0, 2.0, 0.0, 2.0, 18.0, 0.0, 23.0, 0.0, 0.0, 0.0, 23.0, 9.0, 2.0, 0.0, 0.0, 0.0, 3.0, 16.0, 0.0, 0.0, 30.0, 25.0, 15.0, 28.0, 14.0, 10.0, 18.0, 19.0, 4.0, 0.0, 24.0, 35.0, 6.0, 0.0, 0.0, 0.0, 24.0, 21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 23.0, 4.0, 6.0, 27.0, 8.0, 34.0, 24.0, 43.0, 0.0, 0.0, 0.0, 14.0, 0.0, 6.0, 6.0, 13.0, 14.0, 17.0, 0.0, 23.0, 18.0, 3.0, 0.0, 1.0, 0.0, 7.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 48.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 5.0, 3.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 3.0, 12.0, 14.0, 0.0, 7.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 28.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 16.0, 9.0, 4.0, 19.0, 10.0, 10.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 7.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 6.0, 9.0, 0.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.01570533639838, "mean_inference_ms": 14.952141020183696, "mean_action_processing_ms": 0.7600688456875201, "mean_env_wait_ms": 2.2317324587228464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014193296432495117, "StateBufferConnector_ms": 0.004792928695678711, "ViewRequirementAgentConnector_ms": 0.17957568168640137}, "num_episodes": 18, "episode_return_max": 399.0, "episode_return_min": 219.0, "episode_return_mean": 343.09, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 198.94293730241736, "num_env_steps_trained_throughput_per_sec": 198.94293730241736, "timesteps_total": 644000, "num_env_steps_sampled_lifetime": 644000, "num_agent_steps_sampled_lifetime": 2576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2576000, "timers": {"training_iteration_time_ms": 109994.936, "restore_workers_time_ms": 0.038, "training_step_time_ms": 109994.829, "sample_time_ms": 2727.934, "learn_time_ms": 107236.604, "learn_throughput": 37.301, "synch_weights_time_ms": 22.671}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000}, "done": false, "training_iteration": 161, "trial_id": "45bed_00000", "date": "2024-08-13_05-41-01", "timestamp": 1723542061, "time_this_iter_s": 20.15003728866577, "time_total_s": 16239.97387099266, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b52eb700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16239.97387099266, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 85.78928571428571, "ram_util_percent": 83.31785714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7562070190669998, "cur_kl_coeff": 1.0339757656912847e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.20478863353845933, "policy_loss": -0.0023629841500666564, "vf_loss": 0.20715161750022884, "vf_explained_var": 0.07610416929557841, "kl": 0.002272333395317229, "entropy": 0.0497550450152072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 305235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.88064522784223, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.647074447643189, "policy_loss": -0.0057839527260512115, "vf_loss": 1.652858398421101, "vf_explained_var": 0.29103546754392995, "kl": 0.014957186861204204, "entropy": 1.3499751419617385, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 305235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000}, "env_runners": {"episode_reward_max": 399.0, "episode_reward_min": 219.0, "episode_reward_mean": 347.98, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 51.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 48.0}, "policy_reward_mean": {"prey_policy": 168.035, "predator_policy": 5.955}, "custom_metrics": {}, "hist_stats": {"episode_reward": [294.0, 345.0, 323.0, 386.0, 325.0, 330.0, 336.0, 310.0, 219.0, 371.0, 320.0, 375.0, 349.0, 337.0, 332.0, 347.0, 340.0, 333.0, 298.0, 348.0, 272.0, 360.0, 299.0, 287.0, 365.0, 339.0, 306.0, 320.0, 373.0, 318.0, 282.0, 285.0, 330.0, 356.0, 375.0, 330.0, 334.0, 302.0, 378.0, 381.0, 299.0, 384.0, 364.0, 385.0, 294.0, 349.0, 353.0, 365.0, 360.0, 348.0, 368.0, 366.0, 371.0, 352.0, 370.0, 320.0, 366.0, 364.0, 378.0, 363.0, 361.0, 308.0, 373.0, 364.0, 382.0, 367.0, 341.0, 360.0, 399.0, 357.0, 383.0, 397.0, 336.0, 364.0, 377.0, 319.0, 349.0, 367.0, 320.0, 387.0, 375.0, 376.0, 310.0, 360.0, 361.0, 337.0, 368.0, 360.0, 377.0, 340.0, 370.0, 383.0, 380.0, 361.0, 385.0, 352.0, 394.0, 332.0, 355.0, 382.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [160.0, 101.0, 144.0, 193.0, 150.0, 173.0, 185.0, 200.0, 144.0, 167.0, 188.0, 140.0, 182.0, 152.0, 109.0, 183.0, 101.0, 95.0, 191.0, 180.0, 98.0, 190.0, 184.0, 189.0, 171.0, 178.0, 143.0, 175.0, 156.0, 176.0, 110.0, 182.0, 189.0, 108.0, 158.0, 151.0, 119.0, 142.0, 168.0, 176.0, 99.0, 114.0, 177.0, 177.0, 184.0, 115.0, 120.0, 122.0, 177.0, 188.0, 170.0, 169.0, 185.0, 118.0, 184.0, 113.0, 171.0, 192.0, 111.0, 172.0, 81.0, 143.0, 124.0, 118.0, 166.0, 164.0, 155.0, 187.0, 191.0, 172.0, 171.0, 132.0, 149.0, 168.0, 115.0, 146.0, 182.0, 193.0, 197.0, 183.0, 149.0, 126.0, 189.0, 195.0, 196.0, 168.0, 189.0, 196.0, 51.0, 195.0, 156.0, 193.0, 185.0, 168.0, 171.0, 194.0, 153.0, 195.0, 174.0, 174.0, 181.0, 182.0, 197.0, 166.0, 184.0, 186.0, 177.0, 168.0, 200.0, 167.0, 145.0, 149.0, 188.0, 171.0, 189.0, 175.0, 187.0, 187.0, 179.0, 184.0, 170.0, 182.0, 107.0, 165.0, 179.0, 194.0, 186.0, 178.0, 192.0, 187.0, 143.0, 199.0, 137.0, 181.0, 147.0, 193.0, 200.0, 199.0, 157.0, 192.0, 192.0, 191.0, 197.0, 200.0, 169.0, 160.0, 179.0, 185.0, 192.0, 178.0, 176.0, 103.0, 171.0, 178.0, 169.0, 198.0, 154.0, 151.0, 187.0, 200.0, 200.0, 160.0, 194.0, 173.0, 83.0, 191.0, 199.0, 161.0, 192.0, 169.0, 187.0, 141.0, 177.0, 185.0, 177.0, 170.0, 195.0, 181.0, 171.0, 169.0, 194.0, 166.0, 185.0, 198.0, 185.0, 191.0, 185.0, 176.0, 192.0, 193.0, 191.0, 138.0, 199.0, 195.0, 144.0, 176.0, 167.0, 182.0, 192.0, 190.0], "policy_predator_policy_reward": [30.0, 3.0, 0.0, 8.0, 0.0, 0.0, 1.0, 0.0, 14.0, 0.0, 0.0, 2.0, 0.0, 2.0, 18.0, 0.0, 23.0, 0.0, 0.0, 0.0, 23.0, 9.0, 2.0, 0.0, 0.0, 0.0, 3.0, 16.0, 0.0, 0.0, 30.0, 25.0, 15.0, 28.0, 14.0, 10.0, 18.0, 19.0, 4.0, 0.0, 24.0, 35.0, 6.0, 0.0, 0.0, 0.0, 24.0, 21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 23.0, 4.0, 6.0, 27.0, 8.0, 34.0, 24.0, 43.0, 0.0, 0.0, 0.0, 14.0, 0.0, 6.0, 6.0, 13.0, 14.0, 17.0, 0.0, 23.0, 18.0, 3.0, 0.0, 1.0, 0.0, 7.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 48.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 5.0, 3.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 3.0, 12.0, 14.0, 0.0, 7.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 28.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 16.0, 9.0, 4.0, 19.0, 10.0, 10.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 7.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 6.0, 9.0, 0.0, 9.0, 1.0, 35.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 6.0, 13.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 16.0, 0.0, 0.0, 12.0, 0.0, 0.0, 6.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.993584078425835, "mean_inference_ms": 14.885590325824957, "mean_action_processing_ms": 0.7582636786297371, "mean_env_wait_ms": 2.2212466220227824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016852498054504395, "StateBufferConnector_ms": 0.005036830902099609, "ViewRequirementAgentConnector_ms": 0.17807304859161377}, "num_episodes": 18, "episode_return_max": 399.0, "episode_return_min": 219.0, "episode_return_mean": 347.98, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 179.12815795395974, "num_env_steps_trained_throughput_per_sec": 179.12815795395974, "timesteps_total": 648000, "num_env_steps_sampled_lifetime": 648000, "num_agent_steps_sampled_lifetime": 2592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2592000, "timers": {"training_iteration_time_ms": 20142.7, "restore_workers_time_ms": 0.038, "training_step_time_ms": 20142.592, "sample_time_ms": 2782.931, "learn_time_ms": 17331.398, "learn_throughput": 230.795, "synch_weights_time_ms": 20.621}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000}, "done": false, "training_iteration": 162, "trial_id": "45bed_00000", "date": "2024-08-13_05-41-24", "timestamp": 1723542084, "time_this_iter_s": 22.376693964004517, "time_total_s": 16262.350564956665, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b52fb790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16262.350564956665, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 85.178125, "ram_util_percent": 83.571875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2382035726947445, "cur_kl_coeff": 5.169878828456423e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6691610011316481, "policy_loss": -0.0012546571461907613, "vf_loss": 0.6704156580386023, "vf_explained_var": 0.026352482245712683, "kl": 0.002048614494361588, "entropy": 0.05133722298236554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 307125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.5280060035211065, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6361910025436412, "policy_loss": -0.006664819184138819, "vf_loss": 1.642855822945398, "vf_explained_var": 0.47895662888648016, "kl": 0.014528479733798541, "entropy": 1.370274228646011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 307125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 2608000}, "env_runners": {"episode_reward_max": 399.0, "episode_reward_min": 272.0, "episode_reward_mean": 351.75, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 51.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 48.0}, "policy_reward_mean": {"prey_policy": 170.165, "predator_policy": 5.71}, "custom_metrics": {}, "hist_stats": {"episode_reward": [298.0, 348.0, 272.0, 360.0, 299.0, 287.0, 365.0, 339.0, 306.0, 320.0, 373.0, 318.0, 282.0, 285.0, 330.0, 356.0, 375.0, 330.0, 334.0, 302.0, 378.0, 381.0, 299.0, 384.0, 364.0, 385.0, 294.0, 349.0, 353.0, 365.0, 360.0, 348.0, 368.0, 366.0, 371.0, 352.0, 370.0, 320.0, 366.0, 364.0, 378.0, 363.0, 361.0, 308.0, 373.0, 364.0, 382.0, 367.0, 341.0, 360.0, 399.0, 357.0, 383.0, 397.0, 336.0, 364.0, 377.0, 319.0, 349.0, 367.0, 320.0, 387.0, 375.0, 376.0, 310.0, 360.0, 361.0, 337.0, 368.0, 360.0, 377.0, 340.0, 370.0, 383.0, 380.0, 361.0, 385.0, 352.0, 394.0, 332.0, 355.0, 382.0, 372.0, 364.0, 377.0, 326.0, 358.0, 323.0, 323.0, 370.0, 340.0, 376.0, 372.0, 363.0, 373.0, 308.0, 386.0, 371.0, 372.0, 275.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [119.0, 142.0, 168.0, 176.0, 99.0, 114.0, 177.0, 177.0, 184.0, 115.0, 120.0, 122.0, 177.0, 188.0, 170.0, 169.0, 185.0, 118.0, 184.0, 113.0, 171.0, 192.0, 111.0, 172.0, 81.0, 143.0, 124.0, 118.0, 166.0, 164.0, 155.0, 187.0, 191.0, 172.0, 171.0, 132.0, 149.0, 168.0, 115.0, 146.0, 182.0, 193.0, 197.0, 183.0, 149.0, 126.0, 189.0, 195.0, 196.0, 168.0, 189.0, 196.0, 51.0, 195.0, 156.0, 193.0, 185.0, 168.0, 171.0, 194.0, 153.0, 195.0, 174.0, 174.0, 181.0, 182.0, 197.0, 166.0, 184.0, 186.0, 177.0, 168.0, 200.0, 167.0, 145.0, 149.0, 188.0, 171.0, 189.0, 175.0, 187.0, 187.0, 179.0, 184.0, 170.0, 182.0, 107.0, 165.0, 179.0, 194.0, 186.0, 178.0, 192.0, 187.0, 143.0, 199.0, 137.0, 181.0, 147.0, 193.0, 200.0, 199.0, 157.0, 192.0, 192.0, 191.0, 197.0, 200.0, 169.0, 160.0, 179.0, 185.0, 192.0, 178.0, 176.0, 103.0, 171.0, 178.0, 169.0, 198.0, 154.0, 151.0, 187.0, 200.0, 200.0, 160.0, 194.0, 173.0, 83.0, 191.0, 199.0, 161.0, 192.0, 169.0, 187.0, 141.0, 177.0, 185.0, 177.0, 170.0, 195.0, 181.0, 171.0, 169.0, 194.0, 166.0, 185.0, 198.0, 185.0, 191.0, 185.0, 176.0, 192.0, 193.0, 191.0, 138.0, 199.0, 195.0, 144.0, 176.0, 167.0, 182.0, 192.0, 190.0, 182.0, 185.0, 186.0, 169.0, 190.0, 187.0, 185.0, 132.0, 165.0, 173.0, 106.0, 176.0, 155.0, 138.0, 165.0, 199.0, 177.0, 163.0, 200.0, 134.0, 193.0, 179.0, 192.0, 171.0, 188.0, 176.0, 145.0, 142.0, 197.0, 188.0, 189.0, 173.0, 188.0, 176.0, 112.0, 146.0], "policy_predator_policy_reward": [18.0, 19.0, 4.0, 0.0, 24.0, 35.0, 6.0, 0.0, 0.0, 0.0, 24.0, 21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 23.0, 4.0, 6.0, 27.0, 8.0, 34.0, 24.0, 43.0, 0.0, 0.0, 0.0, 14.0, 0.0, 6.0, 6.0, 13.0, 14.0, 17.0, 0.0, 23.0, 18.0, 3.0, 0.0, 1.0, 0.0, 7.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 48.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 5.0, 3.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 3.0, 12.0, 14.0, 0.0, 7.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 28.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 16.0, 9.0, 4.0, 19.0, 10.0, 10.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 7.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 6.0, 9.0, 0.0, 9.0, 1.0, 35.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 6.0, 13.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 16.0, 0.0, 0.0, 12.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 12.0, 18.0, 23.0, 15.0, 15.0, 6.0, 0.0, 0.0, 0.0, 20.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 21.0, 0.0, 0.0, 1.0, 0.0, 9.0, 0.0, 8.0, 1.0, 16.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.972144812566222, "mean_inference_ms": 14.820674286665485, "mean_action_processing_ms": 0.7565864040993947, "mean_env_wait_ms": 2.211029707732048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015074372291564941, "StateBufferConnector_ms": 0.0055266618728637695, "ViewRequirementAgentConnector_ms": 0.2481173276901245}, "num_episodes": 18, "episode_return_max": 399.0, "episode_return_min": 272.0, "episode_return_mean": 351.75, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 2608000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 184.42147638653935, "num_env_steps_trained_throughput_per_sec": 184.42147638653935, "timesteps_total": 652000, "num_env_steps_sampled_lifetime": 652000, "num_agent_steps_sampled_lifetime": 2608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2608000, "timers": {"training_iteration_time_ms": 20053.911, "restore_workers_time_ms": 0.039, "training_step_time_ms": 20053.828, "sample_time_ms": 2619.852, "learn_time_ms": 17406.066, "learn_throughput": 229.805, "synch_weights_time_ms": 20.816}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 2608000}, "done": false, "training_iteration": 163, "trial_id": "45bed_00000", "date": "2024-08-13_05-41-46", "timestamp": 1723542106, "time_this_iter_s": 21.745761156082153, "time_total_s": 16284.096326112747, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b52c6940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16284.096326112747, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 84.73333333333332, "ram_util_percent": 83.52999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1366023499183553, "cur_kl_coeff": 2.5849394142282116e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4890073641109719, "policy_loss": -0.001815708772964263, "vf_loss": 0.4908230709690581, "vf_explained_var": 0.058990544616860686, "kl": 0.0013523367990410165, "entropy": 0.04120595791086397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 309015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.311594625093319, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2355839155180743, "policy_loss": -0.0036226034883863082, "vf_loss": 1.239206524753066, "vf_explained_var": 0.323730299270973, "kl": 0.015718022936015694, "entropy": 1.319584023321747, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 309015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000}, "env_runners": {"episode_reward_max": 399.0, "episode_reward_min": 258.0, "episode_reward_mean": 357.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 51.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 48.0}, "policy_reward_mean": {"prey_policy": 173.85, "predator_policy": 4.78}, "custom_metrics": {}, "hist_stats": {"episode_reward": [384.0, 364.0, 385.0, 294.0, 349.0, 353.0, 365.0, 360.0, 348.0, 368.0, 366.0, 371.0, 352.0, 370.0, 320.0, 366.0, 364.0, 378.0, 363.0, 361.0, 308.0, 373.0, 364.0, 382.0, 367.0, 341.0, 360.0, 399.0, 357.0, 383.0, 397.0, 336.0, 364.0, 377.0, 319.0, 349.0, 367.0, 320.0, 387.0, 375.0, 376.0, 310.0, 360.0, 361.0, 337.0, 368.0, 360.0, 377.0, 340.0, 370.0, 383.0, 380.0, 361.0, 385.0, 352.0, 394.0, 332.0, 355.0, 382.0, 372.0, 364.0, 377.0, 326.0, 358.0, 323.0, 323.0, 370.0, 340.0, 376.0, 372.0, 363.0, 373.0, 308.0, 386.0, 371.0, 372.0, 275.0, 369.0, 376.0, 380.0, 339.0, 336.0, 367.0, 335.0, 389.0, 343.0, 334.0, 364.0, 292.0, 315.0, 386.0, 349.0, 337.0, 393.0, 258.0, 354.0, 364.0, 375.0, 345.0, 388.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [189.0, 195.0, 196.0, 168.0, 189.0, 196.0, 51.0, 195.0, 156.0, 193.0, 185.0, 168.0, 171.0, 194.0, 153.0, 195.0, 174.0, 174.0, 181.0, 182.0, 197.0, 166.0, 184.0, 186.0, 177.0, 168.0, 200.0, 167.0, 145.0, 149.0, 188.0, 171.0, 189.0, 175.0, 187.0, 187.0, 179.0, 184.0, 170.0, 182.0, 107.0, 165.0, 179.0, 194.0, 186.0, 178.0, 192.0, 187.0, 143.0, 199.0, 137.0, 181.0, 147.0, 193.0, 200.0, 199.0, 157.0, 192.0, 192.0, 191.0, 197.0, 200.0, 169.0, 160.0, 179.0, 185.0, 192.0, 178.0, 176.0, 103.0, 171.0, 178.0, 169.0, 198.0, 154.0, 151.0, 187.0, 200.0, 200.0, 160.0, 194.0, 173.0, 83.0, 191.0, 199.0, 161.0, 192.0, 169.0, 187.0, 141.0, 177.0, 185.0, 177.0, 170.0, 195.0, 181.0, 171.0, 169.0, 194.0, 166.0, 185.0, 198.0, 185.0, 191.0, 185.0, 176.0, 192.0, 193.0, 191.0, 138.0, 199.0, 195.0, 144.0, 176.0, 167.0, 182.0, 192.0, 190.0, 182.0, 185.0, 186.0, 169.0, 190.0, 187.0, 185.0, 132.0, 165.0, 173.0, 106.0, 176.0, 155.0, 138.0, 165.0, 199.0, 177.0, 163.0, 200.0, 134.0, 193.0, 179.0, 192.0, 171.0, 188.0, 176.0, 145.0, 142.0, 197.0, 188.0, 189.0, 173.0, 188.0, 176.0, 112.0, 146.0, 200.0, 149.0, 173.0, 188.0, 190.0, 187.0, 160.0, 173.0, 186.0, 130.0, 181.0, 179.0, 161.0, 149.0, 195.0, 193.0, 181.0, 159.0, 196.0, 111.0, 182.0, 169.0, 80.0, 200.0, 138.0, 140.0, 194.0, 192.0, 154.0, 195.0, 181.0, 150.0, 197.0, 196.0, 137.0, 87.0, 157.0, 194.0, 152.0, 191.0, 198.0, 177.0, 172.0, 152.0, 192.0, 194.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 48.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 5.0, 3.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 3.0, 12.0, 14.0, 0.0, 7.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 28.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 16.0, 9.0, 4.0, 19.0, 10.0, 10.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 7.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 6.0, 9.0, 0.0, 9.0, 1.0, 35.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 6.0, 13.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 16.0, 0.0, 0.0, 12.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 12.0, 18.0, 23.0, 15.0, 15.0, 6.0, 0.0, 0.0, 0.0, 20.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 21.0, 0.0, 0.0, 1.0, 0.0, 9.0, 0.0, 8.0, 1.0, 16.0, 6.0, 14.0, 6.0, 9.0, 0.0, 3.0, 6.0, 0.0, 0.0, 20.0, 7.0, 0.0, 13.0, 12.0, 1.0, 0.0, 0.0, 3.0, 0.0, 27.0, 5.0, 8.0, 6.0, 6.0, 23.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 18.0, 16.0, 3.0, 0.0, 16.0, 5.0, 0.0, 0.0, 7.0, 14.0, 2.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.23633068752298, "mean_inference_ms": 14.455825896313229, "mean_action_processing_ms": 0.7575103343572889, "mean_env_wait_ms": 2.2022777227777466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01363062858581543, "StateBufferConnector_ms": 0.005804181098937988, "ViewRequirementAgentConnector_ms": 0.2791804075241089}, "num_episodes": 23, "episode_return_max": 399.0, "episode_return_min": 258.0, "episode_return_mean": 357.26, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 163.15403447639494, "num_env_steps_trained_throughput_per_sec": 163.15403447639494, "timesteps_total": 656000, "num_env_steps_sampled_lifetime": 656000, "num_agent_steps_sampled_lifetime": 2624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2624000, "timers": {"training_iteration_time_ms": 20549.82, "restore_workers_time_ms": 0.039, "training_step_time_ms": 20549.736, "sample_time_ms": 2615.282, "learn_time_ms": 17909.239, "learn_throughput": 223.348, "synch_weights_time_ms": 20.408}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000}, "done": false, "training_iteration": 164, "trial_id": "45bed_00000", "date": "2024-08-13_05-42-10", "timestamp": 1723542130, "time_this_iter_s": 24.564074993133545, "time_total_s": 16308.66040110588, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b530f8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16308.66040110588, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 86.32857142857142, "ram_util_percent": 83.50857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7965873878114123, "cur_kl_coeff": 1.2924697071141058e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.29062465411172345, "policy_loss": -0.0015973028253823045, "vf_loss": 0.292221958052229, "vf_explained_var": 0.05371958749004142, "kl": 0.001347323368645021, "entropy": 0.05603991460804113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 310905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.882518442219527, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.703225813845478, "policy_loss": -0.009625228373555556, "vf_loss": 1.7128510438891316, "vf_explained_var": 0.5957856880924689, "kl": 0.013885598942106213, "entropy": 1.3377730437687465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 310905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "env_runners": {"episode_reward_max": 399.0, "episode_reward_min": 176.0, "episode_reward_mean": 355.44, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 10.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 35.0}, "policy_reward_mean": {"prey_policy": 172.415, "predator_policy": 5.305}, "custom_metrics": {}, "hist_stats": {"episode_reward": [364.0, 382.0, 367.0, 341.0, 360.0, 399.0, 357.0, 383.0, 397.0, 336.0, 364.0, 377.0, 319.0, 349.0, 367.0, 320.0, 387.0, 375.0, 376.0, 310.0, 360.0, 361.0, 337.0, 368.0, 360.0, 377.0, 340.0, 370.0, 383.0, 380.0, 361.0, 385.0, 352.0, 394.0, 332.0, 355.0, 382.0, 372.0, 364.0, 377.0, 326.0, 358.0, 323.0, 323.0, 370.0, 340.0, 376.0, 372.0, 363.0, 373.0, 308.0, 386.0, 371.0, 372.0, 275.0, 369.0, 376.0, 380.0, 339.0, 336.0, 367.0, 335.0, 389.0, 343.0, 334.0, 364.0, 292.0, 315.0, 386.0, 349.0, 337.0, 393.0, 258.0, 354.0, 364.0, 375.0, 345.0, 388.0, 332.0, 337.0, 176.0, 363.0, 334.0, 353.0, 358.0, 343.0, 352.0, 338.0, 391.0, 367.0, 385.0, 356.0, 363.0, 392.0, 353.0, 372.0, 377.0, 393.0, 309.0, 336.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [186.0, 178.0, 192.0, 187.0, 143.0, 199.0, 137.0, 181.0, 147.0, 193.0, 200.0, 199.0, 157.0, 192.0, 192.0, 191.0, 197.0, 200.0, 169.0, 160.0, 179.0, 185.0, 192.0, 178.0, 176.0, 103.0, 171.0, 178.0, 169.0, 198.0, 154.0, 151.0, 187.0, 200.0, 200.0, 160.0, 194.0, 173.0, 83.0, 191.0, 199.0, 161.0, 192.0, 169.0, 187.0, 141.0, 177.0, 185.0, 177.0, 170.0, 195.0, 181.0, 171.0, 169.0, 194.0, 166.0, 185.0, 198.0, 185.0, 191.0, 185.0, 176.0, 192.0, 193.0, 191.0, 138.0, 199.0, 195.0, 144.0, 176.0, 167.0, 182.0, 192.0, 190.0, 182.0, 185.0, 186.0, 169.0, 190.0, 187.0, 185.0, 132.0, 165.0, 173.0, 106.0, 176.0, 155.0, 138.0, 165.0, 199.0, 177.0, 163.0, 200.0, 134.0, 193.0, 179.0, 192.0, 171.0, 188.0, 176.0, 145.0, 142.0, 197.0, 188.0, 189.0, 173.0, 188.0, 176.0, 112.0, 146.0, 200.0, 149.0, 173.0, 188.0, 190.0, 187.0, 160.0, 173.0, 186.0, 130.0, 181.0, 179.0, 161.0, 149.0, 195.0, 193.0, 181.0, 159.0, 196.0, 111.0, 182.0, 169.0, 80.0, 200.0, 138.0, 140.0, 194.0, 192.0, 154.0, 195.0, 181.0, 150.0, 197.0, 196.0, 137.0, 87.0, 157.0, 194.0, 152.0, 191.0, 198.0, 177.0, 172.0, 152.0, 192.0, 194.0, 131.0, 168.0, 200.0, 108.0, 166.0, 10.0, 170.0, 190.0, 174.0, 147.0, 167.0, 175.0, 166.0, 188.0, 149.0, 176.0, 152.0, 200.0, 189.0, 124.0, 191.0, 200.0, 185.0, 182.0, 191.0, 194.0, 168.0, 172.0, 180.0, 170.0, 198.0, 194.0, 199.0, 130.0, 200.0, 158.0, 174.0, 198.0, 191.0, 199.0, 136.0, 135.0, 153.0, 166.0], "policy_predator_policy_reward": [0.0, 0.0, 3.0, 0.0, 16.0, 9.0, 4.0, 19.0, 10.0, 10.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 7.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 6.0, 9.0, 0.0, 9.0, 1.0, 35.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 6.0, 13.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 16.0, 0.0, 0.0, 12.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 12.0, 18.0, 23.0, 15.0, 15.0, 6.0, 0.0, 0.0, 0.0, 20.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 21.0, 0.0, 0.0, 1.0, 0.0, 9.0, 0.0, 8.0, 1.0, 16.0, 6.0, 14.0, 6.0, 9.0, 0.0, 3.0, 6.0, 0.0, 0.0, 20.0, 7.0, 0.0, 13.0, 12.0, 1.0, 0.0, 0.0, 3.0, 0.0, 27.0, 5.0, 8.0, 6.0, 6.0, 23.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 18.0, 16.0, 3.0, 0.0, 16.0, 5.0, 0.0, 0.0, 7.0, 14.0, 2.0, 0.0, 23.0, 10.0, 0.0, 29.0, 0.0, 0.0, 3.0, 0.0, 13.0, 0.0, 0.0, 11.0, 4.0, 0.0, 8.0, 10.0, 0.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 9.0, 13.0, 0.0, 0.0, 0.0, 14.0, 10.0, 14.0, 0.0, 5.0, 0.0, 3.0, 0.0, 18.0, 20.0, 7.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.924220066150788, "mean_inference_ms": 14.671495982652232, "mean_action_processing_ms": 0.7535419942918378, "mean_env_wait_ms": 2.187113517446711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009427785873413086, "StateBufferConnector_ms": 0.00577235221862793, "ViewRequirementAgentConnector_ms": 0.3110218048095703}, "num_episodes": 22, "episode_return_max": 399.0, "episode_return_min": 176.0, "episode_return_mean": 355.44, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 164.3737701089643, "num_env_steps_trained_throughput_per_sec": 164.3737701089643, "timesteps_total": 660000, "num_env_steps_sampled_lifetime": 660000, "num_agent_steps_sampled_lifetime": 2640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2640000, "timers": {"training_iteration_time_ms": 21143.722, "restore_workers_time_ms": 0.02, "training_step_time_ms": 21143.658, "sample_time_ms": 2633.94, "learn_time_ms": 18484.209, "learn_throughput": 216.401, "synch_weights_time_ms": 21.02}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "done": false, "training_iteration": 165, "trial_id": "45bed_00000", "date": "2024-08-13_05-42-35", "timestamp": 1723542155, "time_this_iter_s": 24.410248041152954, "time_total_s": 16333.070649147034, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b53295e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16333.070649147034, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 86.47941176470587, "ram_util_percent": 83.60588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.611970455085159, "cur_kl_coeff": 6.462348535570529e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.514543800213665, "policy_loss": -0.0015368822683634424, "vf_loss": 0.5160806829789801, "vf_explained_var": 0.035915178912026544, "kl": 0.00263714861795412, "entropy": 0.04408968221199103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 312795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6809789452130204, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9602331310648609, "policy_loss": -0.005166874747112315, "vf_loss": 0.965400004394786, "vf_explained_var": 0.48189691787674316, "kl": 0.009770942257033427, "entropy": 1.3248677264445674, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 312795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000}, "env_runners": {"episode_reward_max": 394.0, "episode_reward_min": 176.0, "episode_reward_mean": 353.57, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 10.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 35.0}, "policy_reward_mean": {"prey_policy": 171.205, "predator_policy": 5.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [376.0, 310.0, 360.0, 361.0, 337.0, 368.0, 360.0, 377.0, 340.0, 370.0, 383.0, 380.0, 361.0, 385.0, 352.0, 394.0, 332.0, 355.0, 382.0, 372.0, 364.0, 377.0, 326.0, 358.0, 323.0, 323.0, 370.0, 340.0, 376.0, 372.0, 363.0, 373.0, 308.0, 386.0, 371.0, 372.0, 275.0, 369.0, 376.0, 380.0, 339.0, 336.0, 367.0, 335.0, 389.0, 343.0, 334.0, 364.0, 292.0, 315.0, 386.0, 349.0, 337.0, 393.0, 258.0, 354.0, 364.0, 375.0, 345.0, 388.0, 332.0, 337.0, 176.0, 363.0, 334.0, 353.0, 358.0, 343.0, 352.0, 338.0, 391.0, 367.0, 385.0, 356.0, 363.0, 392.0, 353.0, 372.0, 377.0, 393.0, 309.0, 336.0, 373.0, 372.0, 371.0, 335.0, 372.0, 342.0, 383.0, 389.0, 356.0, 358.0, 307.0, 375.0, 372.0, 386.0, 229.0, 359.0, 318.0, 360.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [194.0, 173.0, 83.0, 191.0, 199.0, 161.0, 192.0, 169.0, 187.0, 141.0, 177.0, 185.0, 177.0, 170.0, 195.0, 181.0, 171.0, 169.0, 194.0, 166.0, 185.0, 198.0, 185.0, 191.0, 185.0, 176.0, 192.0, 193.0, 191.0, 138.0, 199.0, 195.0, 144.0, 176.0, 167.0, 182.0, 192.0, 190.0, 182.0, 185.0, 186.0, 169.0, 190.0, 187.0, 185.0, 132.0, 165.0, 173.0, 106.0, 176.0, 155.0, 138.0, 165.0, 199.0, 177.0, 163.0, 200.0, 134.0, 193.0, 179.0, 192.0, 171.0, 188.0, 176.0, 145.0, 142.0, 197.0, 188.0, 189.0, 173.0, 188.0, 176.0, 112.0, 146.0, 200.0, 149.0, 173.0, 188.0, 190.0, 187.0, 160.0, 173.0, 186.0, 130.0, 181.0, 179.0, 161.0, 149.0, 195.0, 193.0, 181.0, 159.0, 196.0, 111.0, 182.0, 169.0, 80.0, 200.0, 138.0, 140.0, 194.0, 192.0, 154.0, 195.0, 181.0, 150.0, 197.0, 196.0, 137.0, 87.0, 157.0, 194.0, 152.0, 191.0, 198.0, 177.0, 172.0, 152.0, 192.0, 194.0, 131.0, 168.0, 200.0, 108.0, 166.0, 10.0, 170.0, 190.0, 174.0, 147.0, 167.0, 175.0, 166.0, 188.0, 149.0, 176.0, 152.0, 200.0, 189.0, 124.0, 191.0, 200.0, 185.0, 182.0, 191.0, 194.0, 168.0, 172.0, 180.0, 170.0, 198.0, 194.0, 199.0, 130.0, 200.0, 158.0, 174.0, 198.0, 191.0, 199.0, 136.0, 135.0, 153.0, 166.0, 185.0, 182.0, 158.0, 200.0, 190.0, 180.0, 187.0, 120.0, 192.0, 180.0, 170.0, 125.0, 192.0, 191.0, 189.0, 200.0, 174.0, 173.0, 144.0, 200.0, 179.0, 128.0, 191.0, 174.0, 190.0, 180.0, 200.0, 186.0, 174.0, 28.0, 150.0, 193.0, 125.0, 155.0, 182.0, 172.0], "policy_predator_policy_reward": [0.0, 9.0, 1.0, 35.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 6.0, 13.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 16.0, 0.0, 0.0, 12.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 12.0, 18.0, 23.0, 15.0, 15.0, 6.0, 0.0, 0.0, 0.0, 20.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 21.0, 0.0, 0.0, 1.0, 0.0, 9.0, 0.0, 8.0, 1.0, 16.0, 6.0, 14.0, 6.0, 9.0, 0.0, 3.0, 6.0, 0.0, 0.0, 20.0, 7.0, 0.0, 13.0, 12.0, 1.0, 0.0, 0.0, 3.0, 0.0, 27.0, 5.0, 8.0, 6.0, 6.0, 23.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 18.0, 16.0, 3.0, 0.0, 16.0, 5.0, 0.0, 0.0, 7.0, 14.0, 2.0, 0.0, 23.0, 10.0, 0.0, 29.0, 0.0, 0.0, 3.0, 0.0, 13.0, 0.0, 0.0, 11.0, 4.0, 0.0, 8.0, 10.0, 0.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 9.0, 13.0, 0.0, 0.0, 0.0, 14.0, 10.0, 14.0, 0.0, 5.0, 0.0, 3.0, 0.0, 18.0, 20.0, 7.0, 10.0, 0.0, 6.0, 14.0, 0.0, 0.0, 1.0, 22.0, 6.0, 0.0, 0.0, 25.0, 22.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 14.0, 0.0, 0.0, 7.0, 3.0, 0.0, 2.0, 0.0, 0.0, 27.0, 0.0, 0.0, 16.0, 13.0, 25.0, 0.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.90507977707362, "mean_inference_ms": 14.612749119756304, "mean_action_processing_ms": 0.7524541977905957, "mean_env_wait_ms": 2.1779110108410875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008656144142150879, "StateBufferConnector_ms": 0.005930662155151367, "ViewRequirementAgentConnector_ms": 0.33017611503601074}, "num_episodes": 18, "episode_return_max": 394.0, "episode_return_min": 176.0, "episode_return_mean": 353.57, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 171.53303026521638, "num_env_steps_trained_throughput_per_sec": 171.53303026521638, "timesteps_total": 664000, "num_env_steps_sampled_lifetime": 664000, "num_agent_steps_sampled_lifetime": 2656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2656000, "timers": {"training_iteration_time_ms": 21750.465, "restore_workers_time_ms": 0.02, "training_step_time_ms": 21750.401, "sample_time_ms": 2740.206, "learn_time_ms": 18985.11, "learn_throughput": 210.691, "synch_weights_time_ms": 20.709}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000}, "done": false, "training_iteration": 166, "trial_id": "45bed_00000", "date": "2024-08-13_05-42-58", "timestamp": 1723542178, "time_this_iter_s": 23.37831711769104, "time_total_s": 16356.448966264725, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5329820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16356.448966264725, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 84.05454545454545, "ram_util_percent": 83.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5757357470454678, "cur_kl_coeff": 3.2311742677852645e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.21182983025277732, "policy_loss": -0.0011109965003376443, "vf_loss": 0.2129408270334973, "vf_explained_var": 0.0893550418356739, "kl": 0.0011524167706382868, "entropy": 0.04634792073703711, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 314685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9376793150706266, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.269423871932837, "policy_loss": 0.0005896113184650266, "vf_loss": 1.268834260153392, "vf_explained_var": 0.14894663322539556, "kl": 0.015284127328389123, "entropy": 1.320125751268296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 314685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 2672000}, "env_runners": {"episode_reward_max": 393.0, "episode_reward_min": 176.0, "episode_reward_mean": 354.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 10.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 29.0}, "policy_reward_mean": {"prey_policy": 171.675, "predator_policy": 5.585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [382.0, 372.0, 364.0, 377.0, 326.0, 358.0, 323.0, 323.0, 370.0, 340.0, 376.0, 372.0, 363.0, 373.0, 308.0, 386.0, 371.0, 372.0, 275.0, 369.0, 376.0, 380.0, 339.0, 336.0, 367.0, 335.0, 389.0, 343.0, 334.0, 364.0, 292.0, 315.0, 386.0, 349.0, 337.0, 393.0, 258.0, 354.0, 364.0, 375.0, 345.0, 388.0, 332.0, 337.0, 176.0, 363.0, 334.0, 353.0, 358.0, 343.0, 352.0, 338.0, 391.0, 367.0, 385.0, 356.0, 363.0, 392.0, 353.0, 372.0, 377.0, 393.0, 309.0, 336.0, 373.0, 372.0, 371.0, 335.0, 372.0, 342.0, 383.0, 389.0, 356.0, 358.0, 307.0, 375.0, 372.0, 386.0, 229.0, 359.0, 318.0, 360.0, 361.0, 383.0, 363.0, 379.0, 375.0, 371.0, 353.0, 356.0, 296.0, 372.0, 382.0, 368.0, 379.0, 368.0, 356.0, 361.0, 392.0, 381.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [192.0, 190.0, 182.0, 185.0, 186.0, 169.0, 190.0, 187.0, 185.0, 132.0, 165.0, 173.0, 106.0, 176.0, 155.0, 138.0, 165.0, 199.0, 177.0, 163.0, 200.0, 134.0, 193.0, 179.0, 192.0, 171.0, 188.0, 176.0, 145.0, 142.0, 197.0, 188.0, 189.0, 173.0, 188.0, 176.0, 112.0, 146.0, 200.0, 149.0, 173.0, 188.0, 190.0, 187.0, 160.0, 173.0, 186.0, 130.0, 181.0, 179.0, 161.0, 149.0, 195.0, 193.0, 181.0, 159.0, 196.0, 111.0, 182.0, 169.0, 80.0, 200.0, 138.0, 140.0, 194.0, 192.0, 154.0, 195.0, 181.0, 150.0, 197.0, 196.0, 137.0, 87.0, 157.0, 194.0, 152.0, 191.0, 198.0, 177.0, 172.0, 152.0, 192.0, 194.0, 131.0, 168.0, 200.0, 108.0, 166.0, 10.0, 170.0, 190.0, 174.0, 147.0, 167.0, 175.0, 166.0, 188.0, 149.0, 176.0, 152.0, 200.0, 189.0, 124.0, 191.0, 200.0, 185.0, 182.0, 191.0, 194.0, 168.0, 172.0, 180.0, 170.0, 198.0, 194.0, 199.0, 130.0, 200.0, 158.0, 174.0, 198.0, 191.0, 199.0, 136.0, 135.0, 153.0, 166.0, 185.0, 182.0, 158.0, 200.0, 190.0, 180.0, 187.0, 120.0, 192.0, 180.0, 170.0, 125.0, 192.0, 191.0, 189.0, 200.0, 174.0, 173.0, 144.0, 200.0, 179.0, 128.0, 191.0, 174.0, 190.0, 180.0, 200.0, 186.0, 174.0, 28.0, 150.0, 193.0, 125.0, 155.0, 182.0, 172.0, 180.0, 172.0, 186.0, 197.0, 191.0, 172.0, 196.0, 181.0, 197.0, 167.0, 185.0, 179.0, 172.0, 164.0, 152.0, 186.0, 99.0, 186.0, 188.0, 183.0, 200.0, 173.0, 184.0, 176.0, 191.0, 181.0, 186.0, 179.0, 167.0, 176.0, 154.0, 194.0, 194.0, 197.0, 190.0, 191.0], "policy_predator_policy_reward": [0.0, 0.0, 5.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 12.0, 18.0, 23.0, 15.0, 15.0, 6.0, 0.0, 0.0, 0.0, 20.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 21.0, 0.0, 0.0, 1.0, 0.0, 9.0, 0.0, 8.0, 1.0, 16.0, 6.0, 14.0, 6.0, 9.0, 0.0, 3.0, 6.0, 0.0, 0.0, 20.0, 7.0, 0.0, 13.0, 12.0, 1.0, 0.0, 0.0, 3.0, 0.0, 27.0, 5.0, 8.0, 6.0, 6.0, 23.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 18.0, 16.0, 3.0, 0.0, 16.0, 5.0, 0.0, 0.0, 7.0, 14.0, 2.0, 0.0, 23.0, 10.0, 0.0, 29.0, 0.0, 0.0, 3.0, 0.0, 13.0, 0.0, 0.0, 11.0, 4.0, 0.0, 8.0, 10.0, 0.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 9.0, 13.0, 0.0, 0.0, 0.0, 14.0, 10.0, 14.0, 0.0, 5.0, 0.0, 3.0, 0.0, 18.0, 20.0, 7.0, 10.0, 0.0, 6.0, 14.0, 0.0, 0.0, 1.0, 22.0, 6.0, 0.0, 0.0, 25.0, 22.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 14.0, 0.0, 0.0, 7.0, 3.0, 0.0, 2.0, 0.0, 0.0, 27.0, 0.0, 0.0, 16.0, 13.0, 25.0, 0.0, 6.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 9.0, 2.0, 7.0, 0.0, 9.0, 8.0, 3.0, 15.0, 9.0, 2.0, 1.0, 0.0, 5.0, 4.0, 8.0, 0.0, 7.0, 0.0, 3.0, 0.0, 13.0, 0.0, 0.0, 13.0, 0.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.886325597583734, "mean_inference_ms": 14.555080345344223, "mean_action_processing_ms": 0.7514338063297155, "mean_env_wait_ms": 2.168854041280112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006372213363647461, "StateBufferConnector_ms": 0.007116079330444336, "ViewRequirementAgentConnector_ms": 0.3216686248779297}, "num_episodes": 18, "episode_return_max": 393.0, "episode_return_min": 176.0, "episode_return_mean": 354.52, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 2672000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 158.15149907865236, "num_env_steps_trained_throughput_per_sec": 158.15149907865236, "timesteps_total": 668000, "num_env_steps_sampled_lifetime": 668000, "num_agent_steps_sampled_lifetime": 2672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2672000, "timers": {"training_iteration_time_ms": 22531.938, "restore_workers_time_ms": 0.02, "training_step_time_ms": 22531.875, "sample_time_ms": 2806.812, "learn_time_ms": 19698.996, "learn_throughput": 203.056, "synch_weights_time_ms": 21.848}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 2672000}, "done": false, "training_iteration": 167, "trial_id": "45bed_00000", "date": "2024-08-13_05-43-23", "timestamp": 1723542203, "time_this_iter_s": 25.401430130004883, "time_total_s": 16381.85039639473, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b530fb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16381.85039639473, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 86.27777777777779, "ram_util_percent": 83.49166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8854410331440035, "cur_kl_coeff": 1.6155871338926323e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3388631698709947, "policy_loss": -0.0004831677078510876, "vf_loss": 0.3393463366280591, "vf_explained_var": 0.07496306757447581, "kl": 0.0020629573262187033, "entropy": 0.059121705226048274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 316575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.809606204083357, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2513703358394128, "policy_loss": -0.007193008597408022, "vf_loss": 1.2585633412240043, "vf_explained_var": 0.35242100351701966, "kl": 0.013521718870010004, "entropy": 1.2613790542991072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 316575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 176.0, "episode_reward_mean": 356.88, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 10.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 29.0}, "policy_reward_mean": {"prey_policy": 173.1, "predator_policy": 5.34}, "custom_metrics": {}, "hist_stats": {"episode_reward": [275.0, 369.0, 376.0, 380.0, 339.0, 336.0, 367.0, 335.0, 389.0, 343.0, 334.0, 364.0, 292.0, 315.0, 386.0, 349.0, 337.0, 393.0, 258.0, 354.0, 364.0, 375.0, 345.0, 388.0, 332.0, 337.0, 176.0, 363.0, 334.0, 353.0, 358.0, 343.0, 352.0, 338.0, 391.0, 367.0, 385.0, 356.0, 363.0, 392.0, 353.0, 372.0, 377.0, 393.0, 309.0, 336.0, 373.0, 372.0, 371.0, 335.0, 372.0, 342.0, 383.0, 389.0, 356.0, 358.0, 307.0, 375.0, 372.0, 386.0, 229.0, 359.0, 318.0, 360.0, 361.0, 383.0, 363.0, 379.0, 375.0, 371.0, 353.0, 356.0, 296.0, 372.0, 382.0, 368.0, 379.0, 368.0, 356.0, 361.0, 392.0, 381.0, 400.0, 369.0, 375.0, 359.0, 375.0, 355.0, 374.0, 387.0, 392.0, 333.0, 356.0, 382.0, 373.0, 358.0, 373.0, 370.0, 392.0, 369.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [112.0, 146.0, 200.0, 149.0, 173.0, 188.0, 190.0, 187.0, 160.0, 173.0, 186.0, 130.0, 181.0, 179.0, 161.0, 149.0, 195.0, 193.0, 181.0, 159.0, 196.0, 111.0, 182.0, 169.0, 80.0, 200.0, 138.0, 140.0, 194.0, 192.0, 154.0, 195.0, 181.0, 150.0, 197.0, 196.0, 137.0, 87.0, 157.0, 194.0, 152.0, 191.0, 198.0, 177.0, 172.0, 152.0, 192.0, 194.0, 131.0, 168.0, 200.0, 108.0, 166.0, 10.0, 170.0, 190.0, 174.0, 147.0, 167.0, 175.0, 166.0, 188.0, 149.0, 176.0, 152.0, 200.0, 189.0, 124.0, 191.0, 200.0, 185.0, 182.0, 191.0, 194.0, 168.0, 172.0, 180.0, 170.0, 198.0, 194.0, 199.0, 130.0, 200.0, 158.0, 174.0, 198.0, 191.0, 199.0, 136.0, 135.0, 153.0, 166.0, 185.0, 182.0, 158.0, 200.0, 190.0, 180.0, 187.0, 120.0, 192.0, 180.0, 170.0, 125.0, 192.0, 191.0, 189.0, 200.0, 174.0, 173.0, 144.0, 200.0, 179.0, 128.0, 191.0, 174.0, 190.0, 180.0, 200.0, 186.0, 174.0, 28.0, 150.0, 193.0, 125.0, 155.0, 182.0, 172.0, 180.0, 172.0, 186.0, 197.0, 191.0, 172.0, 196.0, 181.0, 197.0, 167.0, 185.0, 179.0, 172.0, 164.0, 152.0, 186.0, 99.0, 186.0, 188.0, 183.0, 200.0, 173.0, 184.0, 176.0, 191.0, 181.0, 186.0, 179.0, 167.0, 176.0, 154.0, 194.0, 194.0, 197.0, 190.0, 191.0, 200.0, 200.0, 199.0, 134.0, 188.0, 181.0, 167.0, 188.0, 197.0, 165.0, 180.0, 163.0, 192.0, 175.0, 187.0, 200.0, 196.0, 195.0, 147.0, 164.0, 181.0, 160.0, 196.0, 186.0, 181.0, 192.0, 169.0, 180.0, 182.0, 182.0, 170.0, 184.0, 196.0, 194.0, 188.0, 172.0], "policy_predator_policy_reward": [1.0, 16.0, 6.0, 14.0, 6.0, 9.0, 0.0, 3.0, 6.0, 0.0, 0.0, 20.0, 7.0, 0.0, 13.0, 12.0, 1.0, 0.0, 0.0, 3.0, 0.0, 27.0, 5.0, 8.0, 6.0, 6.0, 23.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 18.0, 16.0, 3.0, 0.0, 16.0, 5.0, 0.0, 0.0, 7.0, 14.0, 2.0, 0.0, 23.0, 10.0, 0.0, 29.0, 0.0, 0.0, 3.0, 0.0, 13.0, 0.0, 0.0, 11.0, 4.0, 0.0, 8.0, 10.0, 0.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 9.0, 13.0, 0.0, 0.0, 0.0, 14.0, 10.0, 14.0, 0.0, 5.0, 0.0, 3.0, 0.0, 18.0, 20.0, 7.0, 10.0, 0.0, 6.0, 14.0, 0.0, 0.0, 1.0, 22.0, 6.0, 0.0, 0.0, 25.0, 22.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 14.0, 0.0, 0.0, 7.0, 3.0, 0.0, 2.0, 0.0, 0.0, 27.0, 0.0, 0.0, 16.0, 13.0, 25.0, 0.0, 6.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 9.0, 2.0, 7.0, 0.0, 9.0, 8.0, 3.0, 15.0, 9.0, 2.0, 1.0, 0.0, 5.0, 4.0, 8.0, 0.0, 7.0, 0.0, 3.0, 0.0, 13.0, 0.0, 0.0, 13.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 21.0, 15.0, 0.0, 6.0, 4.0, 0.0, 7.0, 6.0, 0.0, 12.0, 7.0, 0.0, 0.0, 0.0, 0.0, 1.0, 11.0, 11.0, 9.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 9.0, 5.0, 11.0, 0.0, 2.0, 0.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.868055471014984, "mean_inference_ms": 14.498835997283503, "mean_action_processing_ms": 0.750586644251893, "mean_env_wait_ms": 2.1600187132196993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006202340126037598, "StateBufferConnector_ms": 0.014428973197937012, "ViewRequirementAgentConnector_ms": 0.27306342124938965}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 176.0, "episode_return_mean": 356.88, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 163.86340174206128, "num_env_steps_trained_throughput_per_sec": 163.86340174206128, "timesteps_total": 672000, "num_env_steps_sampled_lifetime": 672000, "num_agent_steps_sampled_lifetime": 2688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2688000, "timers": {"training_iteration_time_ms": 23170.872, "restore_workers_time_ms": 0.021, "training_step_time_ms": 23170.806, "sample_time_ms": 2920.732, "learn_time_ms": 20222.859, "learn_throughput": 197.796, "synch_weights_time_ms": 22.789}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000}, "done": false, "training_iteration": 168, "trial_id": "45bed_00000", "date": "2024-08-13_05-43-48", "timestamp": 1723542228, "time_this_iter_s": 24.461200952529907, "time_total_s": 16406.31159734726, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b52c68b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16406.31159734726, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 86.16764705882352, "ram_util_percent": 83.55882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8982178231829373, "cur_kl_coeff": 8.077935669463161e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3500278695392861, "policy_loss": -0.0007564409692628831, "vf_loss": 0.3507843097597952, "vf_explained_var": 0.07148969428879874, "kl": 0.0020194042948591642, "entropy": 0.055492564519404104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 318465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8119003457367104, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8954255520311928, "policy_loss": -0.0037883835892739987, "vf_loss": 0.8992139355609656, "vf_explained_var": 0.2782369575803242, "kl": 0.014771301431903649, "entropy": 1.1793263720456886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 318465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 2704000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 229.0, "episode_reward_mean": 363.16, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 28.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 27.0}, "policy_reward_mean": {"prey_policy": 176.785, "predator_policy": 4.795}, "custom_metrics": {}, "hist_stats": {"episode_reward": [363.0, 334.0, 353.0, 358.0, 343.0, 352.0, 338.0, 391.0, 367.0, 385.0, 356.0, 363.0, 392.0, 353.0, 372.0, 377.0, 393.0, 309.0, 336.0, 373.0, 372.0, 371.0, 335.0, 372.0, 342.0, 383.0, 389.0, 356.0, 358.0, 307.0, 375.0, 372.0, 386.0, 229.0, 359.0, 318.0, 360.0, 361.0, 383.0, 363.0, 379.0, 375.0, 371.0, 353.0, 356.0, 296.0, 372.0, 382.0, 368.0, 379.0, 368.0, 356.0, 361.0, 392.0, 381.0, 400.0, 369.0, 375.0, 359.0, 375.0, 355.0, 374.0, 387.0, 392.0, 333.0, 356.0, 382.0, 373.0, 358.0, 373.0, 370.0, 392.0, 369.0, 381.0, 349.0, 336.0, 380.0, 340.0, 390.0, 379.0, 381.0, 330.0, 339.0, 321.0, 384.0, 385.0, 386.0, 387.0, 382.0, 358.0, 385.0, 339.0, 380.0, 379.0, 371.0, 360.0, 329.0, 337.0, 368.0, 380.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [170.0, 190.0, 174.0, 147.0, 167.0, 175.0, 166.0, 188.0, 149.0, 176.0, 152.0, 200.0, 189.0, 124.0, 191.0, 200.0, 185.0, 182.0, 191.0, 194.0, 168.0, 172.0, 180.0, 170.0, 198.0, 194.0, 199.0, 130.0, 200.0, 158.0, 174.0, 198.0, 191.0, 199.0, 136.0, 135.0, 153.0, 166.0, 185.0, 182.0, 158.0, 200.0, 190.0, 180.0, 187.0, 120.0, 192.0, 180.0, 170.0, 125.0, 192.0, 191.0, 189.0, 200.0, 174.0, 173.0, 144.0, 200.0, 179.0, 128.0, 191.0, 174.0, 190.0, 180.0, 200.0, 186.0, 174.0, 28.0, 150.0, 193.0, 125.0, 155.0, 182.0, 172.0, 180.0, 172.0, 186.0, 197.0, 191.0, 172.0, 196.0, 181.0, 197.0, 167.0, 185.0, 179.0, 172.0, 164.0, 152.0, 186.0, 99.0, 186.0, 188.0, 183.0, 200.0, 173.0, 184.0, 176.0, 191.0, 181.0, 186.0, 179.0, 167.0, 176.0, 154.0, 194.0, 194.0, 197.0, 190.0, 191.0, 200.0, 200.0, 199.0, 134.0, 188.0, 181.0, 167.0, 188.0, 197.0, 165.0, 180.0, 163.0, 192.0, 175.0, 187.0, 200.0, 196.0, 195.0, 147.0, 164.0, 181.0, 160.0, 196.0, 186.0, 181.0, 192.0, 169.0, 180.0, 182.0, 182.0, 170.0, 184.0, 196.0, 194.0, 188.0, 172.0, 175.0, 200.0, 162.0, 180.0, 133.0, 180.0, 176.0, 199.0, 157.0, 166.0, 190.0, 200.0, 187.0, 188.0, 195.0, 186.0, 154.0, 160.0, 138.0, 189.0, 143.0, 150.0, 185.0, 199.0, 199.0, 181.0, 196.0, 190.0, 191.0, 196.0, 200.0, 173.0, 161.0, 173.0, 190.0, 195.0, 170.0, 152.0, 192.0, 188.0, 187.0, 189.0, 199.0, 172.0, 196.0, 159.0, 145.0, 156.0, 158.0, 152.0, 185.0, 173.0, 193.0, 187.0], "policy_predator_policy_reward": [3.0, 0.0, 13.0, 0.0, 0.0, 11.0, 4.0, 0.0, 8.0, 10.0, 0.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 9.0, 13.0, 0.0, 0.0, 0.0, 14.0, 10.0, 14.0, 0.0, 5.0, 0.0, 3.0, 0.0, 18.0, 20.0, 7.0, 10.0, 0.0, 6.0, 14.0, 0.0, 0.0, 1.0, 22.0, 6.0, 0.0, 0.0, 25.0, 22.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 14.0, 0.0, 0.0, 7.0, 3.0, 0.0, 2.0, 0.0, 0.0, 27.0, 0.0, 0.0, 16.0, 13.0, 25.0, 0.0, 6.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 9.0, 2.0, 7.0, 0.0, 9.0, 8.0, 3.0, 15.0, 9.0, 2.0, 1.0, 0.0, 5.0, 4.0, 8.0, 0.0, 7.0, 0.0, 3.0, 0.0, 13.0, 0.0, 0.0, 13.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 21.0, 15.0, 0.0, 6.0, 4.0, 0.0, 7.0, 6.0, 0.0, 12.0, 7.0, 0.0, 0.0, 0.0, 0.0, 1.0, 11.0, 11.0, 9.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 9.0, 5.0, 11.0, 0.0, 2.0, 0.0, 9.0, 6.0, 0.0, 7.0, 0.0, 17.0, 6.0, 5.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 16.0, 0.0, 2.0, 10.0, 12.0, 16.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 12.0, 12.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 5.0, 12.0, 16.0, 13.0, 14.0, 0.0, 10.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.840288474507722, "mean_inference_ms": 14.276853264141659, "mean_action_processing_ms": 0.7492580025924062, "mean_env_wait_ms": 2.2894834070513848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007526040077209473, "StateBufferConnector_ms": 0.01452624797821045, "ViewRequirementAgentConnector_ms": 0.26227903366088867}, "num_episodes": 27, "episode_return_max": 400.0, "episode_return_min": 229.0, "episode_return_mean": 363.16, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 2704000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 163.29325304655472, "num_env_steps_trained_throughput_per_sec": 163.29325304655472, "timesteps_total": 676000, "num_env_steps_sampled_lifetime": 676000, "num_agent_steps_sampled_lifetime": 2704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2704000, "timers": {"training_iteration_time_ms": 23743.77, "restore_workers_time_ms": 0.021, "training_step_time_ms": 23743.679, "sample_time_ms": 2984.439, "learn_time_ms": 20731.451, "learn_throughput": 192.944, "synch_weights_time_ms": 23.095}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 2704000}, "done": false, "training_iteration": 169, "trial_id": "45bed_00000", "date": "2024-08-13_05-44-13", "timestamp": 1723542253, "time_this_iter_s": 24.572339057922363, "time_total_s": 16430.883936405182, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b53434c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16430.883936405182, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 83.75142857142856, "ram_util_percent": 83.17142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5223571532164459, "cur_kl_coeff": 4.0389678347315807e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3057816957828229, "policy_loss": -0.0010432912189533156, "vf_loss": 0.30682498738426833, "vf_explained_var": 0.03922079296969863, "kl": 0.001683498052573405, "entropy": 0.059163346453003154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 320355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.688711305632793, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7740180177545106, "policy_loss": -0.003916683926483587, "vf_loss": 0.7779347029943314, "vf_explained_var": 0.45776698554634415, "kl": 0.01010920403381066, "entropy": 1.158246732325781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 320355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 229.0, "episode_reward_mean": 364.27, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 28.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 27.0}, "policy_reward_mean": {"prey_policy": 177.345, "predator_policy": 4.79}, "custom_metrics": {}, "hist_stats": {"episode_reward": [336.0, 373.0, 372.0, 371.0, 335.0, 372.0, 342.0, 383.0, 389.0, 356.0, 358.0, 307.0, 375.0, 372.0, 386.0, 229.0, 359.0, 318.0, 360.0, 361.0, 383.0, 363.0, 379.0, 375.0, 371.0, 353.0, 356.0, 296.0, 372.0, 382.0, 368.0, 379.0, 368.0, 356.0, 361.0, 392.0, 381.0, 400.0, 369.0, 375.0, 359.0, 375.0, 355.0, 374.0, 387.0, 392.0, 333.0, 356.0, 382.0, 373.0, 358.0, 373.0, 370.0, 392.0, 369.0, 381.0, 349.0, 336.0, 380.0, 340.0, 390.0, 379.0, 381.0, 330.0, 339.0, 321.0, 384.0, 385.0, 386.0, 387.0, 382.0, 358.0, 385.0, 339.0, 380.0, 379.0, 371.0, 360.0, 329.0, 337.0, 368.0, 380.0, 369.0, 359.0, 345.0, 357.0, 330.0, 368.0, 367.0, 377.0, 354.0, 378.0, 357.0, 392.0, 382.0, 384.0, 389.0, 359.0, 368.0, 375.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [153.0, 166.0, 185.0, 182.0, 158.0, 200.0, 190.0, 180.0, 187.0, 120.0, 192.0, 180.0, 170.0, 125.0, 192.0, 191.0, 189.0, 200.0, 174.0, 173.0, 144.0, 200.0, 179.0, 128.0, 191.0, 174.0, 190.0, 180.0, 200.0, 186.0, 174.0, 28.0, 150.0, 193.0, 125.0, 155.0, 182.0, 172.0, 180.0, 172.0, 186.0, 197.0, 191.0, 172.0, 196.0, 181.0, 197.0, 167.0, 185.0, 179.0, 172.0, 164.0, 152.0, 186.0, 99.0, 186.0, 188.0, 183.0, 200.0, 173.0, 184.0, 176.0, 191.0, 181.0, 186.0, 179.0, 167.0, 176.0, 154.0, 194.0, 194.0, 197.0, 190.0, 191.0, 200.0, 200.0, 199.0, 134.0, 188.0, 181.0, 167.0, 188.0, 197.0, 165.0, 180.0, 163.0, 192.0, 175.0, 187.0, 200.0, 196.0, 195.0, 147.0, 164.0, 181.0, 160.0, 196.0, 186.0, 181.0, 192.0, 169.0, 180.0, 182.0, 182.0, 170.0, 184.0, 196.0, 194.0, 188.0, 172.0, 175.0, 200.0, 162.0, 180.0, 133.0, 180.0, 176.0, 199.0, 157.0, 166.0, 190.0, 200.0, 187.0, 188.0, 195.0, 186.0, 154.0, 160.0, 138.0, 189.0, 143.0, 150.0, 185.0, 199.0, 199.0, 181.0, 196.0, 190.0, 191.0, 196.0, 200.0, 173.0, 161.0, 173.0, 190.0, 195.0, 170.0, 152.0, 192.0, 188.0, 187.0, 189.0, 199.0, 172.0, 196.0, 159.0, 145.0, 156.0, 158.0, 152.0, 185.0, 173.0, 193.0, 187.0, 180.0, 180.0, 189.0, 156.0, 149.0, 173.0, 193.0, 148.0, 121.0, 199.0, 184.0, 170.0, 177.0, 176.0, 185.0, 192.0, 182.0, 146.0, 192.0, 186.0, 145.0, 190.0, 196.0, 196.0, 184.0, 198.0, 182.0, 196.0, 185.0, 199.0, 165.0, 176.0, 172.0, 187.0, 181.0, 194.0], "policy_predator_policy_reward": [7.0, 10.0, 0.0, 6.0, 14.0, 0.0, 0.0, 1.0, 22.0, 6.0, 0.0, 0.0, 25.0, 22.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 14.0, 0.0, 0.0, 7.0, 3.0, 0.0, 2.0, 0.0, 0.0, 27.0, 0.0, 0.0, 16.0, 13.0, 25.0, 0.0, 6.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 9.0, 2.0, 7.0, 0.0, 9.0, 8.0, 3.0, 15.0, 9.0, 2.0, 1.0, 0.0, 5.0, 4.0, 8.0, 0.0, 7.0, 0.0, 3.0, 0.0, 13.0, 0.0, 0.0, 13.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 21.0, 15.0, 0.0, 6.0, 4.0, 0.0, 7.0, 6.0, 0.0, 12.0, 7.0, 0.0, 0.0, 0.0, 0.0, 1.0, 11.0, 11.0, 9.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 9.0, 5.0, 11.0, 0.0, 2.0, 0.0, 9.0, 6.0, 0.0, 7.0, 0.0, 17.0, 6.0, 5.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 16.0, 0.0, 2.0, 10.0, 12.0, 16.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 12.0, 12.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 5.0, 12.0, 16.0, 13.0, 14.0, 0.0, 10.0, 0.0, 0.0, 9.0, 0.0, 14.0, 0.0, 17.0, 6.0, 16.0, 0.0, 0.0, 10.0, 5.0, 9.0, 6.0, 8.0, 0.0, 0.0, 11.0, 15.0, 0.0, 0.0, 11.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 5.0, 11.0, 7.0, 9.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.823313401013496, "mean_inference_ms": 14.363875965277257, "mean_action_processing_ms": 0.7486760533318376, "mean_env_wait_ms": 2.1389668673180546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010866880416870117, "StateBufferConnector_ms": 0.014582276344299316, "ViewRequirementAgentConnector_ms": 0.2974109649658203}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 229.0, "episode_return_mean": 364.27, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.81793429352737, "num_env_steps_trained_throughput_per_sec": 155.81793429352737, "timesteps_total": 680000, "num_env_steps_sampled_lifetime": 680000, "num_agent_steps_sampled_lifetime": 2720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2720000, "timers": {"training_iteration_time_ms": 23616.641, "restore_workers_time_ms": 0.019, "training_step_time_ms": 23616.546, "sample_time_ms": 3266.86, "learn_time_ms": 20319.801, "learn_throughput": 196.852, "synch_weights_time_ms": 25.826}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "done": false, "training_iteration": 170, "trial_id": "45bed_00000", "date": "2024-08-13_05-44-38", "timestamp": 1723542278, "time_this_iter_s": 25.781437873840332, "time_total_s": 16456.665374279022, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b535c550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16456.665374279022, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 85.3027027027027, "ram_util_percent": 83.45405405405404}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6901294847014089, "cur_kl_coeff": 2.0194839173657903e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3744973925607545, "policy_loss": -0.00021914073546964026, "vf_loss": 0.37471653289377516, "vf_explained_var": 0.04692421634361227, "kl": 0.0011025825654109084, "entropy": 0.04094133218922825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 322245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2469796012397167, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8132236520725268, "policy_loss": -0.004633129746579225, "vf_loss": 0.8178567830216947, "vf_explained_var": 0.29399941636141014, "kl": 0.013780802549125063, "entropy": 1.065144490722626, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 322245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 2736000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 296.0, "episode_reward_mean": 367.03, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 99.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 21.0}, "policy_reward_mean": {"prey_policy": 179.01, "predator_policy": 4.505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.0, 361.0, 383.0, 363.0, 379.0, 375.0, 371.0, 353.0, 356.0, 296.0, 372.0, 382.0, 368.0, 379.0, 368.0, 356.0, 361.0, 392.0, 381.0, 400.0, 369.0, 375.0, 359.0, 375.0, 355.0, 374.0, 387.0, 392.0, 333.0, 356.0, 382.0, 373.0, 358.0, 373.0, 370.0, 392.0, 369.0, 381.0, 349.0, 336.0, 380.0, 340.0, 390.0, 379.0, 381.0, 330.0, 339.0, 321.0, 384.0, 385.0, 386.0, 387.0, 382.0, 358.0, 385.0, 339.0, 380.0, 379.0, 371.0, 360.0, 329.0, 337.0, 368.0, 380.0, 369.0, 359.0, 345.0, 357.0, 330.0, 368.0, 367.0, 377.0, 354.0, 378.0, 357.0, 392.0, 382.0, 384.0, 389.0, 359.0, 368.0, 375.0, 300.0, 336.0, 378.0, 385.0, 364.0, 383.0, 388.0, 381.0, 359.0, 343.0, 398.0, 381.0, 364.0, 386.0, 370.0, 363.0, 373.0, 357.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [182.0, 172.0, 180.0, 172.0, 186.0, 197.0, 191.0, 172.0, 196.0, 181.0, 197.0, 167.0, 185.0, 179.0, 172.0, 164.0, 152.0, 186.0, 99.0, 186.0, 188.0, 183.0, 200.0, 173.0, 184.0, 176.0, 191.0, 181.0, 186.0, 179.0, 167.0, 176.0, 154.0, 194.0, 194.0, 197.0, 190.0, 191.0, 200.0, 200.0, 199.0, 134.0, 188.0, 181.0, 167.0, 188.0, 197.0, 165.0, 180.0, 163.0, 192.0, 175.0, 187.0, 200.0, 196.0, 195.0, 147.0, 164.0, 181.0, 160.0, 196.0, 186.0, 181.0, 192.0, 169.0, 180.0, 182.0, 182.0, 170.0, 184.0, 196.0, 194.0, 188.0, 172.0, 175.0, 200.0, 162.0, 180.0, 133.0, 180.0, 176.0, 199.0, 157.0, 166.0, 190.0, 200.0, 187.0, 188.0, 195.0, 186.0, 154.0, 160.0, 138.0, 189.0, 143.0, 150.0, 185.0, 199.0, 199.0, 181.0, 196.0, 190.0, 191.0, 196.0, 200.0, 173.0, 161.0, 173.0, 190.0, 195.0, 170.0, 152.0, 192.0, 188.0, 187.0, 189.0, 199.0, 172.0, 196.0, 159.0, 145.0, 156.0, 158.0, 152.0, 185.0, 173.0, 193.0, 187.0, 180.0, 180.0, 189.0, 156.0, 149.0, 173.0, 193.0, 148.0, 121.0, 199.0, 184.0, 170.0, 177.0, 176.0, 185.0, 192.0, 182.0, 146.0, 192.0, 186.0, 145.0, 190.0, 196.0, 196.0, 184.0, 198.0, 182.0, 196.0, 185.0, 199.0, 165.0, 176.0, 172.0, 187.0, 181.0, 194.0, 185.0, 113.0, 157.0, 158.0, 196.0, 182.0, 191.0, 194.0, 182.0, 176.0, 183.0, 200.0, 200.0, 182.0, 191.0, 185.0, 171.0, 179.0, 138.0, 179.0, 198.0, 200.0, 192.0, 189.0, 193.0, 140.0, 196.0, 185.0, 141.0, 199.0, 168.0, 185.0, 195.0, 170.0, 177.0, 167.0], "policy_predator_policy_reward": [0.0, 6.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 9.0, 2.0, 7.0, 0.0, 9.0, 8.0, 3.0, 15.0, 9.0, 2.0, 1.0, 0.0, 5.0, 4.0, 8.0, 0.0, 7.0, 0.0, 3.0, 0.0, 13.0, 0.0, 0.0, 13.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 21.0, 15.0, 0.0, 6.0, 4.0, 0.0, 7.0, 6.0, 0.0, 12.0, 7.0, 0.0, 0.0, 0.0, 0.0, 1.0, 11.0, 11.0, 9.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 9.0, 5.0, 11.0, 0.0, 2.0, 0.0, 9.0, 6.0, 0.0, 7.0, 0.0, 17.0, 6.0, 5.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 16.0, 0.0, 2.0, 10.0, 12.0, 16.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 12.0, 12.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 5.0, 12.0, 16.0, 13.0, 14.0, 0.0, 10.0, 0.0, 0.0, 9.0, 0.0, 14.0, 0.0, 17.0, 6.0, 16.0, 0.0, 0.0, 10.0, 5.0, 9.0, 6.0, 8.0, 0.0, 0.0, 11.0, 15.0, 0.0, 0.0, 11.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 5.0, 11.0, 7.0, 9.0, 0.0, 0.0, 0.0, 2.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 6.0, 0.0, 5.0, 0.0, 0.0, 9.0, 6.0, 20.0, 0.0, 0.0, 0.0, 0.0, 12.0, 19.0, 5.0, 0.0, 18.0, 12.0, 7.0, 3.0, 0.0, 8.0, 2.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.806799591484791, "mean_inference_ms": 14.312111220879087, "mean_action_processing_ms": 0.7484171192930827, "mean_env_wait_ms": 2.130689393600118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014214515686035156, "StateBufferConnector_ms": 0.014637589454650879, "ViewRequirementAgentConnector_ms": 0.3231527805328369}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 296.0, "episode_return_mean": 367.03, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 2736000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 163.55321486820642, "num_env_steps_trained_throughput_per_sec": 163.55321486820642, "timesteps_total": 684000, "num_env_steps_sampled_lifetime": 684000, "num_agent_steps_sampled_lifetime": 2736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2736000, "timers": {"training_iteration_time_ms": 24051.701, "restore_workers_time_ms": 0.02, "training_step_time_ms": 24051.605, "sample_time_ms": 3419.123, "learn_time_ms": 20601.794, "learn_throughput": 194.158, "synch_weights_time_ms": 26.093}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 2736000}, "done": false, "training_iteration": 171, "trial_id": "45bed_00000", "date": "2024-08-13_05-45-03", "timestamp": 1723542303, "time_this_iter_s": 24.551430702209473, "time_total_s": 16481.21680498123, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b52ebee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16481.21680498123, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 86.28823529411765, "ram_util_percent": 83.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9406214113766082, "cur_kl_coeff": 1.0097419586828952e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3742050687945078, "policy_loss": -0.0005846356026946553, "vf_loss": 0.3747897040961241, "vf_explained_var": 0.05339976627990682, "kl": 0.0028686039186847246, "entropy": 0.05670199881963156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 324135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8370927974029825, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1739177329672708, "policy_loss": -0.004991730308239028, "vf_loss": 1.1789094652921435, "vf_explained_var": 0.315173417582083, "kl": 0.008542465629042673, "entropy": 1.030118040149174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 324135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 300.0, "episode_reward_mean": 365.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 113.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 23.0}, "policy_reward_mean": {"prey_policy": 177.435, "predator_policy": 5.175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [381.0, 400.0, 369.0, 375.0, 359.0, 375.0, 355.0, 374.0, 387.0, 392.0, 333.0, 356.0, 382.0, 373.0, 358.0, 373.0, 370.0, 392.0, 369.0, 381.0, 349.0, 336.0, 380.0, 340.0, 390.0, 379.0, 381.0, 330.0, 339.0, 321.0, 384.0, 385.0, 386.0, 387.0, 382.0, 358.0, 385.0, 339.0, 380.0, 379.0, 371.0, 360.0, 329.0, 337.0, 368.0, 380.0, 369.0, 359.0, 345.0, 357.0, 330.0, 368.0, 367.0, 377.0, 354.0, 378.0, 357.0, 392.0, 382.0, 384.0, 389.0, 359.0, 368.0, 375.0, 300.0, 336.0, 378.0, 385.0, 364.0, 383.0, 388.0, 381.0, 359.0, 343.0, 398.0, 381.0, 364.0, 386.0, 370.0, 363.0, 373.0, 357.0, 346.0, 307.0, 398.0, 352.0, 327.0, 390.0, 340.0, 340.0, 382.0, 368.0, 371.0, 372.0, 349.0, 355.0, 315.0, 371.0, 362.0, 349.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [190.0, 191.0, 200.0, 200.0, 199.0, 134.0, 188.0, 181.0, 167.0, 188.0, 197.0, 165.0, 180.0, 163.0, 192.0, 175.0, 187.0, 200.0, 196.0, 195.0, 147.0, 164.0, 181.0, 160.0, 196.0, 186.0, 181.0, 192.0, 169.0, 180.0, 182.0, 182.0, 170.0, 184.0, 196.0, 194.0, 188.0, 172.0, 175.0, 200.0, 162.0, 180.0, 133.0, 180.0, 176.0, 199.0, 157.0, 166.0, 190.0, 200.0, 187.0, 188.0, 195.0, 186.0, 154.0, 160.0, 138.0, 189.0, 143.0, 150.0, 185.0, 199.0, 199.0, 181.0, 196.0, 190.0, 191.0, 196.0, 200.0, 173.0, 161.0, 173.0, 190.0, 195.0, 170.0, 152.0, 192.0, 188.0, 187.0, 189.0, 199.0, 172.0, 196.0, 159.0, 145.0, 156.0, 158.0, 152.0, 185.0, 173.0, 193.0, 187.0, 180.0, 180.0, 189.0, 156.0, 149.0, 173.0, 193.0, 148.0, 121.0, 199.0, 184.0, 170.0, 177.0, 176.0, 185.0, 192.0, 182.0, 146.0, 192.0, 186.0, 145.0, 190.0, 196.0, 196.0, 184.0, 198.0, 182.0, 196.0, 185.0, 199.0, 165.0, 176.0, 172.0, 187.0, 181.0, 194.0, 185.0, 113.0, 157.0, 158.0, 196.0, 182.0, 191.0, 194.0, 182.0, 176.0, 183.0, 200.0, 200.0, 182.0, 191.0, 185.0, 171.0, 179.0, 138.0, 179.0, 198.0, 200.0, 192.0, 189.0, 193.0, 140.0, 196.0, 185.0, 141.0, 199.0, 168.0, 185.0, 195.0, 170.0, 177.0, 167.0, 159.0, 151.0, 123.0, 164.0, 200.0, 198.0, 164.0, 177.0, 165.0, 141.0, 191.0, 199.0, 157.0, 165.0, 142.0, 185.0, 187.0, 189.0, 166.0, 173.0, 185.0, 179.0, 200.0, 159.0, 171.0, 161.0, 189.0, 150.0, 131.0, 146.0, 161.0, 185.0, 195.0, 167.0, 151.0, 198.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 21.0, 15.0, 0.0, 6.0, 4.0, 0.0, 7.0, 6.0, 0.0, 12.0, 7.0, 0.0, 0.0, 0.0, 0.0, 1.0, 11.0, 11.0, 9.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 9.0, 5.0, 11.0, 0.0, 2.0, 0.0, 9.0, 6.0, 0.0, 7.0, 0.0, 17.0, 6.0, 5.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 16.0, 0.0, 2.0, 10.0, 12.0, 16.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 12.0, 12.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 5.0, 12.0, 16.0, 13.0, 14.0, 0.0, 10.0, 0.0, 0.0, 9.0, 0.0, 14.0, 0.0, 17.0, 6.0, 16.0, 0.0, 0.0, 10.0, 5.0, 9.0, 6.0, 8.0, 0.0, 0.0, 11.0, 15.0, 0.0, 0.0, 11.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 5.0, 11.0, 7.0, 9.0, 0.0, 0.0, 0.0, 2.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 6.0, 0.0, 5.0, 0.0, 0.0, 9.0, 6.0, 20.0, 0.0, 0.0, 0.0, 0.0, 12.0, 19.0, 5.0, 0.0, 18.0, 12.0, 7.0, 3.0, 0.0, 8.0, 2.0, 11.0, 16.0, 20.0, 11.0, 9.0, 0.0, 0.0, 11.0, 0.0, 12.0, 9.0, 0.0, 0.0, 11.0, 7.0, 7.0, 6.0, 0.0, 6.0, 15.0, 14.0, 7.0, 0.0, 5.0, 8.0, 17.0, 0.0, 0.0, 16.0, 15.0, 23.0, 14.0, 11.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.790817831336203, "mean_inference_ms": 14.261409452336629, "mean_action_processing_ms": 0.7482089995461999, "mean_env_wait_ms": 2.122547419862313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014116883277893066, "StateBufferConnector_ms": 0.013559937477111816, "ViewRequirementAgentConnector_ms": 0.3223022222518921}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 300.0, "episode_return_mean": 365.22, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.37412216732022, "num_env_steps_trained_throughput_per_sec": 156.37412216732022, "timesteps_total": 688000, "num_env_steps_sampled_lifetime": 688000, "num_agent_steps_sampled_lifetime": 2752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2752000, "timers": {"training_iteration_time_ms": 24376.631, "restore_workers_time_ms": 0.02, "training_step_time_ms": 24376.535, "sample_time_ms": 3491.182, "learn_time_ms": 20854.223, "learn_throughput": 191.808, "synch_weights_time_ms": 26.425}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000}, "done": false, "training_iteration": 172, "trial_id": "45bed_00000", "date": "2024-08-13_05-45-29", "timestamp": 1723542329, "time_this_iter_s": 25.633010864257812, "time_total_s": 16506.84981584549, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5329820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16506.84981584549, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 85.20270270270271, "ram_util_percent": 83.31891891891892}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0853830526311876, "cur_kl_coeff": 5.048709793414476e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2984813700040812, "policy_loss": -0.0007636636601534312, "vf_loss": 0.2992450332897962, "vf_explained_var": 0.10772323974225886, "kl": 0.0048315150610602495, "entropy": 0.08974451785562215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 326025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5515083697895524, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8363505762208391, "policy_loss": -0.002975841652030352, "vf_loss": 0.8393264170834627, "vf_explained_var": 0.3886839522886529, "kl": 0.008573023058875954, "entropy": 1.0137063985779171, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 326025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 2768000}, "env_runners": {"episode_reward_max": 398.0, "episode_reward_min": 296.0, "episode_reward_mean": 364.2, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 113.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 23.0}, "policy_reward_mean": {"prey_policy": 177.115, "predator_policy": 4.985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [340.0, 390.0, 379.0, 381.0, 330.0, 339.0, 321.0, 384.0, 385.0, 386.0, 387.0, 382.0, 358.0, 385.0, 339.0, 380.0, 379.0, 371.0, 360.0, 329.0, 337.0, 368.0, 380.0, 369.0, 359.0, 345.0, 357.0, 330.0, 368.0, 367.0, 377.0, 354.0, 378.0, 357.0, 392.0, 382.0, 384.0, 389.0, 359.0, 368.0, 375.0, 300.0, 336.0, 378.0, 385.0, 364.0, 383.0, 388.0, 381.0, 359.0, 343.0, 398.0, 381.0, 364.0, 386.0, 370.0, 363.0, 373.0, 357.0, 346.0, 307.0, 398.0, 352.0, 327.0, 390.0, 340.0, 340.0, 382.0, 368.0, 371.0, 372.0, 349.0, 355.0, 315.0, 371.0, 362.0, 349.0, 377.0, 358.0, 360.0, 375.0, 360.0, 373.0, 372.0, 356.0, 344.0, 384.0, 332.0, 362.0, 373.0, 343.0, 385.0, 373.0, 368.0, 396.0, 393.0, 380.0, 369.0, 296.0, 388.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [157.0, 166.0, 190.0, 200.0, 187.0, 188.0, 195.0, 186.0, 154.0, 160.0, 138.0, 189.0, 143.0, 150.0, 185.0, 199.0, 199.0, 181.0, 196.0, 190.0, 191.0, 196.0, 200.0, 173.0, 161.0, 173.0, 190.0, 195.0, 170.0, 152.0, 192.0, 188.0, 187.0, 189.0, 199.0, 172.0, 196.0, 159.0, 145.0, 156.0, 158.0, 152.0, 185.0, 173.0, 193.0, 187.0, 180.0, 180.0, 189.0, 156.0, 149.0, 173.0, 193.0, 148.0, 121.0, 199.0, 184.0, 170.0, 177.0, 176.0, 185.0, 192.0, 182.0, 146.0, 192.0, 186.0, 145.0, 190.0, 196.0, 196.0, 184.0, 198.0, 182.0, 196.0, 185.0, 199.0, 165.0, 176.0, 172.0, 187.0, 181.0, 194.0, 185.0, 113.0, 157.0, 158.0, 196.0, 182.0, 191.0, 194.0, 182.0, 176.0, 183.0, 200.0, 200.0, 182.0, 191.0, 185.0, 171.0, 179.0, 138.0, 179.0, 198.0, 200.0, 192.0, 189.0, 193.0, 140.0, 196.0, 185.0, 141.0, 199.0, 168.0, 185.0, 195.0, 170.0, 177.0, 167.0, 159.0, 151.0, 123.0, 164.0, 200.0, 198.0, 164.0, 177.0, 165.0, 141.0, 191.0, 199.0, 157.0, 165.0, 142.0, 185.0, 187.0, 189.0, 166.0, 173.0, 185.0, 179.0, 200.0, 159.0, 171.0, 161.0, 189.0, 150.0, 131.0, 146.0, 161.0, 185.0, 195.0, 167.0, 151.0, 198.0, 179.0, 198.0, 167.0, 191.0, 173.0, 170.0, 165.0, 200.0, 178.0, 182.0, 194.0, 179.0, 192.0, 173.0, 186.0, 170.0, 148.0, 168.0, 195.0, 182.0, 170.0, 142.0, 162.0, 200.0, 185.0, 183.0, 155.0, 167.0, 192.0, 191.0, 194.0, 173.0, 200.0, 168.0, 199.0, 197.0, 199.0, 194.0, 200.0, 171.0, 179.0, 183.0, 135.0, 136.0, 200.0, 188.0], "policy_predator_policy_reward": [0.0, 17.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 16.0, 0.0, 2.0, 10.0, 12.0, 16.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 12.0, 12.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 5.0, 12.0, 16.0, 13.0, 14.0, 0.0, 10.0, 0.0, 0.0, 9.0, 0.0, 14.0, 0.0, 17.0, 6.0, 16.0, 0.0, 0.0, 10.0, 5.0, 9.0, 6.0, 8.0, 0.0, 0.0, 11.0, 15.0, 0.0, 0.0, 11.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 5.0, 11.0, 7.0, 9.0, 0.0, 0.0, 0.0, 2.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 6.0, 0.0, 5.0, 0.0, 0.0, 9.0, 6.0, 20.0, 0.0, 0.0, 0.0, 0.0, 12.0, 19.0, 5.0, 0.0, 18.0, 12.0, 7.0, 3.0, 0.0, 8.0, 2.0, 11.0, 16.0, 20.0, 11.0, 9.0, 0.0, 0.0, 11.0, 0.0, 12.0, 9.0, 0.0, 0.0, 11.0, 7.0, 7.0, 6.0, 0.0, 6.0, 15.0, 14.0, 7.0, 0.0, 5.0, 8.0, 17.0, 0.0, 0.0, 16.0, 15.0, 23.0, 14.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 9.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 16.0, 12.0, 1.0, 6.0, 20.0, 0.0, 0.0, 0.0, 0.0, 5.0, 11.0, 10.0, 0.0, 2.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, 0.0, 7.0, 7.0, 18.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.045861263287401, "mean_inference_ms": 13.928259626988336, "mean_action_processing_ms": 0.7505348292628422, "mean_env_wait_ms": 2.1157858977035504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014481544494628906, "StateBufferConnector_ms": 0.009472250938415527, "ViewRequirementAgentConnector_ms": 0.3254281282424927}, "num_episodes": 23, "episode_return_max": 398.0, "episode_return_min": 296.0, "episode_return_mean": 364.2, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 2768000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 162.7616626586828, "num_env_steps_trained_throughput_per_sec": 162.7616626586828, "timesteps_total": 692000, "num_env_steps_sampled_lifetime": 692000, "num_agent_steps_sampled_lifetime": 2768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2768000, "timers": {"training_iteration_time_ms": 24665.266, "restore_workers_time_ms": 0.019, "training_step_time_ms": 24665.173, "sample_time_ms": 3639.066, "learn_time_ms": 20993.466, "learn_throughput": 190.535, "synch_weights_time_ms": 27.761}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 2768000}, "done": false, "training_iteration": 173, "trial_id": "45bed_00000", "date": "2024-08-13_05-45-53", "timestamp": 1723542353, "time_this_iter_s": 24.63126230239868, "time_total_s": 16531.48107814789, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b535c4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16531.48107814789, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 85.00294117647059, "ram_util_percent": 83.22058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.183346758130445, "cur_kl_coeff": 2.524354896707238e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3630823044549851, "policy_loss": -0.0002170232430139862, "vf_loss": 0.36329932697573136, "vf_explained_var": 0.06738335149628776, "kl": 0.002518875711605359, "entropy": 0.06671400956572994, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 327915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2406939522693397, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6692768131417257, "policy_loss": -0.003196499698484937, "vf_loss": 0.6724733116134765, "vf_explained_var": 0.3280802248962342, "kl": 0.007337062851515987, "entropy": 1.0109404330215757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 327915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000}, "env_runners": {"episode_reward_max": 398.0, "episode_reward_min": 296.0, "episode_reward_mean": 365.5, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 113.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 23.0}, "policy_reward_mean": {"prey_policy": 177.9, "predator_policy": 4.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.0, 369.0, 359.0, 345.0, 357.0, 330.0, 368.0, 367.0, 377.0, 354.0, 378.0, 357.0, 392.0, 382.0, 384.0, 389.0, 359.0, 368.0, 375.0, 300.0, 336.0, 378.0, 385.0, 364.0, 383.0, 388.0, 381.0, 359.0, 343.0, 398.0, 381.0, 364.0, 386.0, 370.0, 363.0, 373.0, 357.0, 346.0, 307.0, 398.0, 352.0, 327.0, 390.0, 340.0, 340.0, 382.0, 368.0, 371.0, 372.0, 349.0, 355.0, 315.0, 371.0, 362.0, 349.0, 377.0, 358.0, 360.0, 375.0, 360.0, 373.0, 372.0, 356.0, 344.0, 384.0, 332.0, 362.0, 373.0, 343.0, 385.0, 373.0, 368.0, 396.0, 393.0, 380.0, 369.0, 296.0, 388.0, 377.0, 361.0, 361.0, 336.0, 377.0, 391.0, 329.0, 382.0, 394.0, 367.0, 339.0, 379.0, 338.0, 390.0, 366.0, 367.0, 392.0, 373.0, 387.0, 385.0, 392.0, 357.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [193.0, 187.0, 180.0, 180.0, 189.0, 156.0, 149.0, 173.0, 193.0, 148.0, 121.0, 199.0, 184.0, 170.0, 177.0, 176.0, 185.0, 192.0, 182.0, 146.0, 192.0, 186.0, 145.0, 190.0, 196.0, 196.0, 184.0, 198.0, 182.0, 196.0, 185.0, 199.0, 165.0, 176.0, 172.0, 187.0, 181.0, 194.0, 185.0, 113.0, 157.0, 158.0, 196.0, 182.0, 191.0, 194.0, 182.0, 176.0, 183.0, 200.0, 200.0, 182.0, 191.0, 185.0, 171.0, 179.0, 138.0, 179.0, 198.0, 200.0, 192.0, 189.0, 193.0, 140.0, 196.0, 185.0, 141.0, 199.0, 168.0, 185.0, 195.0, 170.0, 177.0, 167.0, 159.0, 151.0, 123.0, 164.0, 200.0, 198.0, 164.0, 177.0, 165.0, 141.0, 191.0, 199.0, 157.0, 165.0, 142.0, 185.0, 187.0, 189.0, 166.0, 173.0, 185.0, 179.0, 200.0, 159.0, 171.0, 161.0, 189.0, 150.0, 131.0, 146.0, 161.0, 185.0, 195.0, 167.0, 151.0, 198.0, 179.0, 198.0, 167.0, 191.0, 173.0, 170.0, 165.0, 200.0, 178.0, 182.0, 194.0, 179.0, 192.0, 173.0, 186.0, 170.0, 148.0, 168.0, 195.0, 182.0, 170.0, 142.0, 162.0, 200.0, 185.0, 183.0, 155.0, 167.0, 192.0, 191.0, 194.0, 173.0, 200.0, 168.0, 199.0, 197.0, 199.0, 194.0, 200.0, 171.0, 179.0, 183.0, 135.0, 136.0, 200.0, 188.0, 182.0, 195.0, 193.0, 160.0, 150.0, 200.0, 136.0, 175.0, 189.0, 185.0, 191.0, 200.0, 149.0, 163.0, 196.0, 179.0, 196.0, 198.0, 172.0, 187.0, 161.0, 163.0, 180.0, 193.0, 150.0, 168.0, 197.0, 193.0, 173.0, 184.0, 152.0, 199.0, 198.0, 194.0, 161.0, 199.0, 196.0, 187.0, 198.0, 187.0, 193.0, 197.0, 158.0, 185.0], "policy_predator_policy_reward": [0.0, 0.0, 9.0, 0.0, 14.0, 0.0, 17.0, 6.0, 16.0, 0.0, 0.0, 10.0, 5.0, 9.0, 6.0, 8.0, 0.0, 0.0, 11.0, 15.0, 0.0, 0.0, 11.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 5.0, 11.0, 7.0, 9.0, 0.0, 0.0, 0.0, 2.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 6.0, 0.0, 5.0, 0.0, 0.0, 9.0, 6.0, 20.0, 0.0, 0.0, 0.0, 0.0, 12.0, 19.0, 5.0, 0.0, 18.0, 12.0, 7.0, 3.0, 0.0, 8.0, 2.0, 11.0, 16.0, 20.0, 11.0, 9.0, 0.0, 0.0, 11.0, 0.0, 12.0, 9.0, 0.0, 0.0, 11.0, 7.0, 7.0, 6.0, 0.0, 6.0, 15.0, 14.0, 7.0, 0.0, 5.0, 8.0, 17.0, 0.0, 0.0, 16.0, 15.0, 23.0, 14.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 9.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 16.0, 12.0, 1.0, 6.0, 20.0, 0.0, 0.0, 0.0, 0.0, 5.0, 11.0, 10.0, 0.0, 2.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, 0.0, 7.0, 7.0, 18.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 11.0, 0.0, 9.0, 16.0, 3.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 7.0, 0.0, 0.0, 5.0, 3.0, 0.0, 15.0, 6.0, 0.0, 11.0, 9.0, 0.0, 0.0, 0.0, 9.0, 0.0, 16.0, 0.0, 0.0, 13.0, 0.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 14.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.755147862684288, "mean_inference_ms": 14.144412855538592, "mean_action_processing_ms": 0.7484727984317745, "mean_env_wait_ms": 2.102869268665886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013588786125183105, "StateBufferConnector_ms": 0.009450912475585938, "ViewRequirementAgentConnector_ms": 0.3113715648651123}, "num_episodes": 22, "episode_return_max": 398.0, "episode_return_min": 296.0, "episode_return_mean": 365.5, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.84561121299268, "num_env_steps_trained_throughput_per_sec": 154.84561121299268, "timesteps_total": 696000, "num_env_steps_sampled_lifetime": 696000, "num_agent_steps_sampled_lifetime": 2784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2784000, "timers": {"training_iteration_time_ms": 24796.813, "restore_workers_time_ms": 0.019, "training_step_time_ms": 24796.72, "sample_time_ms": 3675.826, "learn_time_ms": 21087.852, "learn_throughput": 189.683, "synch_weights_time_ms": 27.894}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000}, "done": false, "training_iteration": 174, "trial_id": "45bed_00000", "date": "2024-08-13_05-46-19", "timestamp": 1723542379, "time_this_iter_s": 25.896119832992554, "time_total_s": 16557.37719798088, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5378670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16557.37719798088, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 87.50270270270269, "ram_util_percent": 83.26756756756755}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.48886283021913, "cur_kl_coeff": 1.262177448353619e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.22332511681807105, "policy_loss": -0.0006279702367330039, "vf_loss": 0.2239530867454719, "vf_explained_var": 0.09254161403292702, "kl": 0.001862172931457002, "entropy": 0.09147006419521791, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 329805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9596569987201184, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8233151122267363, "policy_loss": -0.005348514090538537, "vf_loss": 0.8286636277165993, "vf_explained_var": 0.47374833147361795, "kl": 0.007606659678461558, "entropy": 0.9654446135753046, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 329805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 296.0, "episode_reward_mean": 364.93, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 113.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 23.0}, "policy_reward_mean": {"prey_policy": 177.68, "predator_policy": 4.785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [375.0, 300.0, 336.0, 378.0, 385.0, 364.0, 383.0, 388.0, 381.0, 359.0, 343.0, 398.0, 381.0, 364.0, 386.0, 370.0, 363.0, 373.0, 357.0, 346.0, 307.0, 398.0, 352.0, 327.0, 390.0, 340.0, 340.0, 382.0, 368.0, 371.0, 372.0, 349.0, 355.0, 315.0, 371.0, 362.0, 349.0, 377.0, 358.0, 360.0, 375.0, 360.0, 373.0, 372.0, 356.0, 344.0, 384.0, 332.0, 362.0, 373.0, 343.0, 385.0, 373.0, 368.0, 396.0, 393.0, 380.0, 369.0, 296.0, 388.0, 377.0, 361.0, 361.0, 336.0, 377.0, 391.0, 329.0, 382.0, 394.0, 367.0, 339.0, 379.0, 338.0, 390.0, 366.0, 367.0, 392.0, 373.0, 387.0, 385.0, 392.0, 357.0, 362.0, 363.0, 370.0, 360.0, 350.0, 363.0, 372.0, 365.0, 352.0, 399.0, 321.0, 374.0, 400.0, 384.0, 359.0, 356.0, 367.0, 341.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [181.0, 194.0, 185.0, 113.0, 157.0, 158.0, 196.0, 182.0, 191.0, 194.0, 182.0, 176.0, 183.0, 200.0, 200.0, 182.0, 191.0, 185.0, 171.0, 179.0, 138.0, 179.0, 198.0, 200.0, 192.0, 189.0, 193.0, 140.0, 196.0, 185.0, 141.0, 199.0, 168.0, 185.0, 195.0, 170.0, 177.0, 167.0, 159.0, 151.0, 123.0, 164.0, 200.0, 198.0, 164.0, 177.0, 165.0, 141.0, 191.0, 199.0, 157.0, 165.0, 142.0, 185.0, 187.0, 189.0, 166.0, 173.0, 185.0, 179.0, 200.0, 159.0, 171.0, 161.0, 189.0, 150.0, 131.0, 146.0, 161.0, 185.0, 195.0, 167.0, 151.0, 198.0, 179.0, 198.0, 167.0, 191.0, 173.0, 170.0, 165.0, 200.0, 178.0, 182.0, 194.0, 179.0, 192.0, 173.0, 186.0, 170.0, 148.0, 168.0, 195.0, 182.0, 170.0, 142.0, 162.0, 200.0, 185.0, 183.0, 155.0, 167.0, 192.0, 191.0, 194.0, 173.0, 200.0, 168.0, 199.0, 197.0, 199.0, 194.0, 200.0, 171.0, 179.0, 183.0, 135.0, 136.0, 200.0, 188.0, 182.0, 195.0, 193.0, 160.0, 150.0, 200.0, 136.0, 175.0, 189.0, 185.0, 191.0, 200.0, 149.0, 163.0, 196.0, 179.0, 196.0, 198.0, 172.0, 187.0, 161.0, 163.0, 180.0, 193.0, 150.0, 168.0, 197.0, 193.0, 173.0, 184.0, 152.0, 199.0, 198.0, 194.0, 161.0, 199.0, 196.0, 187.0, 198.0, 187.0, 193.0, 197.0, 158.0, 185.0, 167.0, 184.0, 181.0, 182.0, 140.0, 196.0, 170.0, 180.0, 179.0, 157.0, 176.0, 186.0, 179.0, 185.0, 190.0, 163.0, 161.0, 170.0, 200.0, 199.0, 149.0, 150.0, 188.0, 175.0, 200.0, 200.0, 191.0, 190.0, 167.0, 191.0, 153.0, 193.0, 176.0, 183.0, 179.0, 155.0], "policy_predator_policy_reward": [0.0, 0.0, 2.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 6.0, 0.0, 5.0, 0.0, 0.0, 9.0, 6.0, 20.0, 0.0, 0.0, 0.0, 0.0, 12.0, 19.0, 5.0, 0.0, 18.0, 12.0, 7.0, 3.0, 0.0, 8.0, 2.0, 11.0, 16.0, 20.0, 11.0, 9.0, 0.0, 0.0, 11.0, 0.0, 12.0, 9.0, 0.0, 0.0, 11.0, 7.0, 7.0, 6.0, 0.0, 6.0, 15.0, 14.0, 7.0, 0.0, 5.0, 8.0, 17.0, 0.0, 0.0, 16.0, 15.0, 23.0, 14.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 9.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 16.0, 12.0, 1.0, 6.0, 20.0, 0.0, 0.0, 0.0, 0.0, 5.0, 11.0, 10.0, 0.0, 2.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, 0.0, 7.0, 7.0, 18.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 11.0, 0.0, 9.0, 16.0, 3.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 7.0, 0.0, 0.0, 5.0, 3.0, 0.0, 15.0, 6.0, 0.0, 11.0, 9.0, 0.0, 0.0, 0.0, 9.0, 0.0, 16.0, 0.0, 0.0, 13.0, 0.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 14.0, 0.0, 11.0, 0.0, 0.0, 0.0, 16.0, 18.0, 10.0, 0.0, 6.0, 8.0, 1.0, 0.0, 1.0, 7.0, 12.0, 0.0, 8.0, 13.0, 0.0, 0.0, 3.0, 19.0, 0.0, 11.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 10.0, 0.0, 8.0, 0.0, 0.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.740935443643291, "mean_inference_ms": 14.097307077295708, "mean_action_processing_ms": 0.7484996636781324, "mean_env_wait_ms": 2.095059563876368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011159539222717285, "StateBufferConnector_ms": 0.010860919952392578, "ViewRequirementAgentConnector_ms": 0.339682936668396}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 296.0, "episode_return_mean": 364.93, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.36552253484692, "num_env_steps_trained_throughput_per_sec": 149.36552253484692, "timesteps_total": 700000, "num_env_steps_sampled_lifetime": 700000, "num_agent_steps_sampled_lifetime": 2800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2800000, "timers": {"training_iteration_time_ms": 25041.329, "restore_workers_time_ms": 0.019, "training_step_time_ms": 25041.226, "sample_time_ms": 3839.424, "learn_time_ms": 21167.938, "learn_throughput": 188.965, "synch_weights_time_ms": 27.844}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "done": false, "training_iteration": 175, "trial_id": "45bed_00000", "date": "2024-08-13_05-46-46", "timestamp": 1723542406, "time_this_iter_s": 26.831305027008057, "time_total_s": 16584.20850300789, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5329a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16584.20850300789, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 88.55526315789474, "ram_util_percent": 83.26052631578946}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7542327787667986, "cur_kl_coeff": 6.310887241768095e-31, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.18108543509016276, "policy_loss": -0.0009885593521945849, "vf_loss": 0.18207399477358666, "vf_explained_var": 0.11067213094423688, "kl": 0.004797459563753675, "entropy": 0.09320463942827056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 331695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6988516946949024, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6183964371326424, "policy_loss": -0.00271999068908078, "vf_loss": 0.6211164288380474, "vf_explained_var": 0.40926728270671986, "kl": 0.008057029359673841, "entropy": 0.9544180519681759, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 331695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 296.0, "episode_reward_mean": 364.5, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 123.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 23.0}, "policy_reward_mean": {"prey_policy": 177.585, "predator_policy": 4.665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [357.0, 346.0, 307.0, 398.0, 352.0, 327.0, 390.0, 340.0, 340.0, 382.0, 368.0, 371.0, 372.0, 349.0, 355.0, 315.0, 371.0, 362.0, 349.0, 377.0, 358.0, 360.0, 375.0, 360.0, 373.0, 372.0, 356.0, 344.0, 384.0, 332.0, 362.0, 373.0, 343.0, 385.0, 373.0, 368.0, 396.0, 393.0, 380.0, 369.0, 296.0, 388.0, 377.0, 361.0, 361.0, 336.0, 377.0, 391.0, 329.0, 382.0, 394.0, 367.0, 339.0, 379.0, 338.0, 390.0, 366.0, 367.0, 392.0, 373.0, 387.0, 385.0, 392.0, 357.0, 362.0, 363.0, 370.0, 360.0, 350.0, 363.0, 372.0, 365.0, 352.0, 399.0, 321.0, 374.0, 400.0, 384.0, 359.0, 356.0, 367.0, 341.0, 353.0, 369.0, 364.0, 375.0, 348.0, 361.0, 357.0, 356.0, 339.0, 353.0, 357.0, 393.0, 398.0, 372.0, 375.0, 390.0, 367.0, 357.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [177.0, 167.0, 159.0, 151.0, 123.0, 164.0, 200.0, 198.0, 164.0, 177.0, 165.0, 141.0, 191.0, 199.0, 157.0, 165.0, 142.0, 185.0, 187.0, 189.0, 166.0, 173.0, 185.0, 179.0, 200.0, 159.0, 171.0, 161.0, 189.0, 150.0, 131.0, 146.0, 161.0, 185.0, 195.0, 167.0, 151.0, 198.0, 179.0, 198.0, 167.0, 191.0, 173.0, 170.0, 165.0, 200.0, 178.0, 182.0, 194.0, 179.0, 192.0, 173.0, 186.0, 170.0, 148.0, 168.0, 195.0, 182.0, 170.0, 142.0, 162.0, 200.0, 185.0, 183.0, 155.0, 167.0, 192.0, 191.0, 194.0, 173.0, 200.0, 168.0, 199.0, 197.0, 199.0, 194.0, 200.0, 171.0, 179.0, 183.0, 135.0, 136.0, 200.0, 188.0, 182.0, 195.0, 193.0, 160.0, 150.0, 200.0, 136.0, 175.0, 189.0, 185.0, 191.0, 200.0, 149.0, 163.0, 196.0, 179.0, 196.0, 198.0, 172.0, 187.0, 161.0, 163.0, 180.0, 193.0, 150.0, 168.0, 197.0, 193.0, 173.0, 184.0, 152.0, 199.0, 198.0, 194.0, 161.0, 199.0, 196.0, 187.0, 198.0, 187.0, 193.0, 197.0, 158.0, 185.0, 167.0, 184.0, 181.0, 182.0, 140.0, 196.0, 170.0, 180.0, 179.0, 157.0, 176.0, 186.0, 179.0, 185.0, 190.0, 163.0, 161.0, 170.0, 200.0, 199.0, 149.0, 150.0, 188.0, 175.0, 200.0, 200.0, 191.0, 190.0, 167.0, 191.0, 153.0, 193.0, 176.0, 183.0, 179.0, 155.0, 172.0, 172.0, 199.0, 161.0, 182.0, 173.0, 197.0, 178.0, 154.0, 177.0, 178.0, 176.0, 186.0, 159.0, 173.0, 173.0, 170.0, 161.0, 175.0, 166.0, 185.0, 168.0, 200.0, 193.0, 198.0, 200.0, 152.0, 200.0, 175.0, 200.0, 191.0, 196.0, 167.0, 193.0, 161.0, 188.0], "policy_predator_policy_reward": [2.0, 11.0, 16.0, 20.0, 11.0, 9.0, 0.0, 0.0, 11.0, 0.0, 12.0, 9.0, 0.0, 0.0, 11.0, 7.0, 7.0, 6.0, 0.0, 6.0, 15.0, 14.0, 7.0, 0.0, 5.0, 8.0, 17.0, 0.0, 0.0, 16.0, 15.0, 23.0, 14.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 9.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 16.0, 12.0, 1.0, 6.0, 20.0, 0.0, 0.0, 0.0, 0.0, 5.0, 11.0, 10.0, 0.0, 2.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, 0.0, 7.0, 7.0, 18.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 11.0, 0.0, 9.0, 16.0, 3.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 7.0, 0.0, 0.0, 5.0, 3.0, 0.0, 15.0, 6.0, 0.0, 11.0, 9.0, 0.0, 0.0, 0.0, 9.0, 0.0, 16.0, 0.0, 0.0, 13.0, 0.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 14.0, 0.0, 11.0, 0.0, 0.0, 0.0, 16.0, 18.0, 10.0, 0.0, 6.0, 8.0, 1.0, 0.0, 1.0, 7.0, 12.0, 0.0, 8.0, 13.0, 0.0, 0.0, 3.0, 19.0, 0.0, 11.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 10.0, 0.0, 8.0, 0.0, 0.0, 7.0, 2.0, 7.0, 9.0, 0.0, 0.0, 9.0, 0.0, 0.0, 5.0, 12.0, 7.0, 0.0, 5.0, 7.0, 0.0, 10.0, 8.0, 0.0, 0.0, 12.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 12.0, 8.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 1.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.7268942012445585, "mean_inference_ms": 14.051158077774101, "mean_action_processing_ms": 0.7484994666286348, "mean_env_wait_ms": 2.0872952681142234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008038878440856934, "StateBufferConnector_ms": 0.010991334915161133, "ViewRequirementAgentConnector_ms": 0.31742966175079346}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 296.0, "episode_return_mean": 364.5, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.38422019610218, "num_env_steps_trained_throughput_per_sec": 151.38422019610218, "timesteps_total": 704000, "num_env_steps_sampled_lifetime": 704000, "num_agent_steps_sampled_lifetime": 2816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2816000, "timers": {"training_iteration_time_ms": 25351.7, "restore_workers_time_ms": 0.02, "training_step_time_ms": 25351.596, "sample_time_ms": 3947.442, "learn_time_ms": 21368.317, "learn_throughput": 187.193, "synch_weights_time_ms": 29.46}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000}, "done": false, "training_iteration": 176, "trial_id": "45bed_00000", "date": "2024-08-13_05-47-13", "timestamp": 1723542433, "time_this_iter_s": 26.557876110076904, "time_total_s": 16610.766379117966, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b52ebee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16610.766379117966, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 87.74736842105263, "ram_util_percent": 83.03947368421052}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8822757832607422, "cur_kl_coeff": 3.1554436208840474e-31, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.24021131315776123, "policy_loss": -0.0015382089827052027, "vf_loss": 0.2417495214725874, "vf_explained_var": 0.06448082356225876, "kl": 0.0009637297232417334, "entropy": 0.04500924782906339, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 333585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0449077100507798, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5621751907350564, "policy_loss": -0.001940275255957786, "vf_loss": 0.5641154667392136, "vf_explained_var": 0.30466340527963387, "kl": 0.006975408393856206, "entropy": 0.9672328663250757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 333585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 2832000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 296.0, "episode_reward_mean": 367.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 135.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 20.0}, "policy_reward_mean": {"prey_policy": 179.9, "predator_policy": 3.845}, "custom_metrics": {}, "hist_stats": {"episode_reward": [349.0, 377.0, 358.0, 360.0, 375.0, 360.0, 373.0, 372.0, 356.0, 344.0, 384.0, 332.0, 362.0, 373.0, 343.0, 385.0, 373.0, 368.0, 396.0, 393.0, 380.0, 369.0, 296.0, 388.0, 377.0, 361.0, 361.0, 336.0, 377.0, 391.0, 329.0, 382.0, 394.0, 367.0, 339.0, 379.0, 338.0, 390.0, 366.0, 367.0, 392.0, 373.0, 387.0, 385.0, 392.0, 357.0, 362.0, 363.0, 370.0, 360.0, 350.0, 363.0, 372.0, 365.0, 352.0, 399.0, 321.0, 374.0, 400.0, 384.0, 359.0, 356.0, 367.0, 341.0, 353.0, 369.0, 364.0, 375.0, 348.0, 361.0, 357.0, 356.0, 339.0, 353.0, 357.0, 393.0, 398.0, 372.0, 375.0, 390.0, 367.0, 357.0, 395.0, 389.0, 368.0, 363.0, 381.0, 336.0, 356.0, 386.0, 374.0, 343.0, 376.0, 377.0, 364.0, 367.0, 399.0, 366.0, 367.0, 394.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [151.0, 198.0, 179.0, 198.0, 167.0, 191.0, 173.0, 170.0, 165.0, 200.0, 178.0, 182.0, 194.0, 179.0, 192.0, 173.0, 186.0, 170.0, 148.0, 168.0, 195.0, 182.0, 170.0, 142.0, 162.0, 200.0, 185.0, 183.0, 155.0, 167.0, 192.0, 191.0, 194.0, 173.0, 200.0, 168.0, 199.0, 197.0, 199.0, 194.0, 200.0, 171.0, 179.0, 183.0, 135.0, 136.0, 200.0, 188.0, 182.0, 195.0, 193.0, 160.0, 150.0, 200.0, 136.0, 175.0, 189.0, 185.0, 191.0, 200.0, 149.0, 163.0, 196.0, 179.0, 196.0, 198.0, 172.0, 187.0, 161.0, 163.0, 180.0, 193.0, 150.0, 168.0, 197.0, 193.0, 173.0, 184.0, 152.0, 199.0, 198.0, 194.0, 161.0, 199.0, 196.0, 187.0, 198.0, 187.0, 193.0, 197.0, 158.0, 185.0, 167.0, 184.0, 181.0, 182.0, 140.0, 196.0, 170.0, 180.0, 179.0, 157.0, 176.0, 186.0, 179.0, 185.0, 190.0, 163.0, 161.0, 170.0, 200.0, 199.0, 149.0, 150.0, 188.0, 175.0, 200.0, 200.0, 191.0, 190.0, 167.0, 191.0, 153.0, 193.0, 176.0, 183.0, 179.0, 155.0, 172.0, 172.0, 199.0, 161.0, 182.0, 173.0, 197.0, 178.0, 154.0, 177.0, 178.0, 176.0, 186.0, 159.0, 173.0, 173.0, 170.0, 161.0, 175.0, 166.0, 185.0, 168.0, 200.0, 193.0, 198.0, 200.0, 152.0, 200.0, 175.0, 200.0, 191.0, 196.0, 167.0, 193.0, 161.0, 188.0, 197.0, 198.0, 199.0, 178.0, 197.0, 164.0, 176.0, 173.0, 198.0, 183.0, 169.0, 152.0, 174.0, 175.0, 197.0, 189.0, 183.0, 185.0, 164.0, 168.0, 193.0, 183.0, 195.0, 182.0, 188.0, 176.0, 185.0, 175.0, 199.0, 200.0, 173.0, 186.0, 151.0, 186.0, 197.0, 194.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 9.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 16.0, 12.0, 1.0, 6.0, 20.0, 0.0, 0.0, 0.0, 0.0, 5.0, 11.0, 10.0, 0.0, 2.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, 0.0, 7.0, 7.0, 18.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 11.0, 0.0, 9.0, 16.0, 3.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 7.0, 0.0, 0.0, 5.0, 3.0, 0.0, 15.0, 6.0, 0.0, 11.0, 9.0, 0.0, 0.0, 0.0, 9.0, 0.0, 16.0, 0.0, 0.0, 13.0, 0.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 14.0, 0.0, 11.0, 0.0, 0.0, 0.0, 16.0, 18.0, 10.0, 0.0, 6.0, 8.0, 1.0, 0.0, 1.0, 7.0, 12.0, 0.0, 8.0, 13.0, 0.0, 0.0, 3.0, 19.0, 0.0, 11.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 10.0, 0.0, 8.0, 0.0, 0.0, 7.0, 2.0, 7.0, 9.0, 0.0, 0.0, 9.0, 0.0, 0.0, 5.0, 12.0, 7.0, 0.0, 5.0, 7.0, 0.0, 10.0, 8.0, 0.0, 0.0, 12.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 12.0, 8.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 1.0, 7.0, 0.0, 0.0, 6.0, 6.0, 7.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 15.0, 7.0, 0.0, 0.0, 0.0, 1.0, 5.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 2.0, 5.0, 15.0, 15.0, 2.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.7129585095311555, "mean_inference_ms": 14.005852381273387, "mean_action_processing_ms": 0.7485555559488171, "mean_env_wait_ms": 2.0796684219636563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008117437362670898, "StateBufferConnector_ms": 0.01125192642211914, "ViewRequirementAgentConnector_ms": 0.31877756118774414}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 296.0, "episode_return_mean": 367.49, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 2832000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.6784543031323, "num_env_steps_trained_throughput_per_sec": 156.6784543031323, "timesteps_total": 708000, "num_env_steps_sampled_lifetime": 708000, "num_agent_steps_sampled_lifetime": 2832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2832000, "timers": {"training_iteration_time_ms": 25375.479, "restore_workers_time_ms": 0.02, "training_step_time_ms": 25375.374, "sample_time_ms": 4012.782, "learn_time_ms": 21327.669, "learn_throughput": 187.55, "synch_weights_time_ms": 28.759}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 2832000}, "done": false, "training_iteration": 177, "trial_id": "45bed_00000", "date": "2024-08-13_05-47-39", "timestamp": 1723542459, "time_this_iter_s": 25.619840145111084, "time_total_s": 16636.386219263077, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5378310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16636.386219263077, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 88.31666666666666, "ram_util_percent": 83.48611111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6327391838487336, "cur_kl_coeff": 1.5777218104420237e-31, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.18755804868168616, "policy_loss": -0.0014097010366934002, "vf_loss": 0.18896774988499515, "vf_explained_var": 0.0959906346268124, "kl": 0.0019641608647919476, "entropy": 0.07768725887847641, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 335475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.670905974838469, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4217585013265273, "policy_loss": -0.004382035149527448, "vf_loss": 0.42614053503940347, "vf_explained_var": 0.4123276204974563, "kl": 0.011551149865184358, "entropy": 1.0395023262059246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 335475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 321.0, "episode_reward_mean": 370.3, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 127.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 24.0}, "policy_reward_mean": {"prey_policy": 181.19, "predator_policy": 3.96}, "custom_metrics": {}, "hist_stats": {"episode_reward": [336.0, 377.0, 391.0, 329.0, 382.0, 394.0, 367.0, 339.0, 379.0, 338.0, 390.0, 366.0, 367.0, 392.0, 373.0, 387.0, 385.0, 392.0, 357.0, 362.0, 363.0, 370.0, 360.0, 350.0, 363.0, 372.0, 365.0, 352.0, 399.0, 321.0, 374.0, 400.0, 384.0, 359.0, 356.0, 367.0, 341.0, 353.0, 369.0, 364.0, 375.0, 348.0, 361.0, 357.0, 356.0, 339.0, 353.0, 357.0, 393.0, 398.0, 372.0, 375.0, 390.0, 367.0, 357.0, 395.0, 389.0, 368.0, 363.0, 381.0, 336.0, 356.0, 386.0, 374.0, 343.0, 376.0, 377.0, 364.0, 367.0, 399.0, 366.0, 367.0, 394.0, 358.0, 363.0, 359.0, 344.0, 372.0, 391.0, 385.0, 396.0, 369.0, 358.0, 400.0, 389.0, 360.0, 381.0, 380.0, 377.0, 370.0, 395.0, 393.0, 385.0, 394.0, 365.0, 363.0, 393.0, 351.0, 375.0, 380.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [136.0, 175.0, 189.0, 185.0, 191.0, 200.0, 149.0, 163.0, 196.0, 179.0, 196.0, 198.0, 172.0, 187.0, 161.0, 163.0, 180.0, 193.0, 150.0, 168.0, 197.0, 193.0, 173.0, 184.0, 152.0, 199.0, 198.0, 194.0, 161.0, 199.0, 196.0, 187.0, 198.0, 187.0, 193.0, 197.0, 158.0, 185.0, 167.0, 184.0, 181.0, 182.0, 140.0, 196.0, 170.0, 180.0, 179.0, 157.0, 176.0, 186.0, 179.0, 185.0, 190.0, 163.0, 161.0, 170.0, 200.0, 199.0, 149.0, 150.0, 188.0, 175.0, 200.0, 200.0, 191.0, 190.0, 167.0, 191.0, 153.0, 193.0, 176.0, 183.0, 179.0, 155.0, 172.0, 172.0, 199.0, 161.0, 182.0, 173.0, 197.0, 178.0, 154.0, 177.0, 178.0, 176.0, 186.0, 159.0, 173.0, 173.0, 170.0, 161.0, 175.0, 166.0, 185.0, 168.0, 200.0, 193.0, 198.0, 200.0, 152.0, 200.0, 175.0, 200.0, 191.0, 196.0, 167.0, 193.0, 161.0, 188.0, 197.0, 198.0, 199.0, 178.0, 197.0, 164.0, 176.0, 173.0, 198.0, 183.0, 169.0, 152.0, 174.0, 175.0, 197.0, 189.0, 183.0, 185.0, 164.0, 168.0, 193.0, 183.0, 195.0, 182.0, 188.0, 176.0, 185.0, 175.0, 199.0, 200.0, 173.0, 186.0, 151.0, 186.0, 197.0, 194.0, 169.0, 172.0, 176.0, 176.0, 149.0, 191.0, 170.0, 152.0, 183.0, 184.0, 194.0, 197.0, 199.0, 186.0, 200.0, 196.0, 172.0, 190.0, 180.0, 170.0, 200.0, 200.0, 193.0, 196.0, 185.0, 155.0, 188.0, 189.0, 188.0, 188.0, 170.0, 200.0, 156.0, 188.0, 200.0, 195.0, 193.0, 200.0, 182.0, 194.0, 198.0, 196.0, 189.0, 175.0, 185.0, 173.0, 193.0, 200.0, 200.0, 127.0, 194.0, 174.0, 185.0, 185.0], "policy_predator_policy_reward": [9.0, 16.0, 3.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 7.0, 0.0, 0.0, 5.0, 3.0, 0.0, 15.0, 6.0, 0.0, 11.0, 9.0, 0.0, 0.0, 0.0, 9.0, 0.0, 16.0, 0.0, 0.0, 13.0, 0.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 14.0, 0.0, 11.0, 0.0, 0.0, 0.0, 16.0, 18.0, 10.0, 0.0, 6.0, 8.0, 1.0, 0.0, 1.0, 7.0, 12.0, 0.0, 8.0, 13.0, 0.0, 0.0, 3.0, 19.0, 0.0, 11.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 10.0, 0.0, 8.0, 0.0, 0.0, 7.0, 2.0, 7.0, 9.0, 0.0, 0.0, 9.0, 0.0, 0.0, 5.0, 12.0, 7.0, 0.0, 5.0, 7.0, 0.0, 10.0, 8.0, 0.0, 0.0, 12.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 12.0, 8.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 1.0, 7.0, 0.0, 0.0, 6.0, 6.0, 7.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 15.0, 7.0, 0.0, 0.0, 0.0, 1.0, 5.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 2.0, 5.0, 15.0, 15.0, 2.0, 1.0, 7.0, 10.0, 11.0, 0.0, 19.0, 0.0, 10.0, 12.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 15.0, 5.0, 3.0, 1.0, 4.0, 0.0, 0.0, 7.0, 12.0, 14.0, 0.0, 0.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 24.0, 7.0, 0.0, 5.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.691284718519045, "mean_inference_ms": 13.806757153565586, "mean_action_processing_ms": 0.748359828057505, "mean_env_wait_ms": 2.2036678548792974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011915802955627441, "StateBufferConnector_ms": 0.008343100547790527, "ViewRequirementAgentConnector_ms": 0.3430713415145874}, "num_episodes": 27, "episode_return_max": 400.0, "episode_return_min": 321.0, "episode_return_mean": 370.3, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.93898145411464, "num_env_steps_trained_throughput_per_sec": 155.93898145411464, "timesteps_total": 712000, "num_env_steps_sampled_lifetime": 712000, "num_agent_steps_sampled_lifetime": 2848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2848000, "timers": {"training_iteration_time_ms": 25499.527, "restore_workers_time_ms": 0.019, "training_step_time_ms": 25499.423, "sample_time_ms": 4004.931, "learn_time_ms": 21459.701, "learn_throughput": 186.396, "synch_weights_time_ms": 28.145}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000}, "done": false, "training_iteration": 178, "trial_id": "45bed_00000", "date": "2024-08-13_05-48-04", "timestamp": 1723542484, "time_this_iter_s": 25.70645785331726, "time_total_s": 16662.092677116394, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b52c8700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16662.092677116394, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 85.84444444444446, "ram_util_percent": 83.44444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9733939217807597, "cur_kl_coeff": 7.888609052210118e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2943308472317993, "policy_loss": -0.001358738947147257, "vf_loss": 0.29568958628409, "vf_explained_var": 0.0777938633684128, "kl": 0.002638926919972986, "entropy": 0.0647741553491898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 337365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7588830112464844, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5626507052047937, "policy_loss": -0.0023289020020495015, "vf_loss": 0.5649796091611423, "vf_explained_var": 0.32834521396450267, "kl": 0.0077691090341886595, "entropy": 1.0029995547085213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 337365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 2864000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 321.0, "episode_reward_mean": 370.18, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 127.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 24.0}, "policy_reward_mean": {"prey_policy": 181.025, "predator_policy": 4.065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [357.0, 362.0, 363.0, 370.0, 360.0, 350.0, 363.0, 372.0, 365.0, 352.0, 399.0, 321.0, 374.0, 400.0, 384.0, 359.0, 356.0, 367.0, 341.0, 353.0, 369.0, 364.0, 375.0, 348.0, 361.0, 357.0, 356.0, 339.0, 353.0, 357.0, 393.0, 398.0, 372.0, 375.0, 390.0, 367.0, 357.0, 395.0, 389.0, 368.0, 363.0, 381.0, 336.0, 356.0, 386.0, 374.0, 343.0, 376.0, 377.0, 364.0, 367.0, 399.0, 366.0, 367.0, 394.0, 358.0, 363.0, 359.0, 344.0, 372.0, 391.0, 385.0, 396.0, 369.0, 358.0, 400.0, 389.0, 360.0, 381.0, 380.0, 377.0, 370.0, 395.0, 393.0, 385.0, 394.0, 365.0, 363.0, 393.0, 351.0, 375.0, 380.0, 343.0, 345.0, 377.0, 378.0, 385.0, 354.0, 373.0, 396.0, 363.0, 377.0, 391.0, 389.0, 355.0, 355.0, 381.0, 354.0, 398.0, 358.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [158.0, 185.0, 167.0, 184.0, 181.0, 182.0, 140.0, 196.0, 170.0, 180.0, 179.0, 157.0, 176.0, 186.0, 179.0, 185.0, 190.0, 163.0, 161.0, 170.0, 200.0, 199.0, 149.0, 150.0, 188.0, 175.0, 200.0, 200.0, 191.0, 190.0, 167.0, 191.0, 153.0, 193.0, 176.0, 183.0, 179.0, 155.0, 172.0, 172.0, 199.0, 161.0, 182.0, 173.0, 197.0, 178.0, 154.0, 177.0, 178.0, 176.0, 186.0, 159.0, 173.0, 173.0, 170.0, 161.0, 175.0, 166.0, 185.0, 168.0, 200.0, 193.0, 198.0, 200.0, 152.0, 200.0, 175.0, 200.0, 191.0, 196.0, 167.0, 193.0, 161.0, 188.0, 197.0, 198.0, 199.0, 178.0, 197.0, 164.0, 176.0, 173.0, 198.0, 183.0, 169.0, 152.0, 174.0, 175.0, 197.0, 189.0, 183.0, 185.0, 164.0, 168.0, 193.0, 183.0, 195.0, 182.0, 188.0, 176.0, 185.0, 175.0, 199.0, 200.0, 173.0, 186.0, 151.0, 186.0, 197.0, 194.0, 169.0, 172.0, 176.0, 176.0, 149.0, 191.0, 170.0, 152.0, 183.0, 184.0, 194.0, 197.0, 199.0, 186.0, 200.0, 196.0, 172.0, 190.0, 180.0, 170.0, 200.0, 200.0, 193.0, 196.0, 185.0, 155.0, 188.0, 189.0, 188.0, 188.0, 170.0, 200.0, 156.0, 188.0, 200.0, 195.0, 193.0, 200.0, 182.0, 194.0, 198.0, 196.0, 189.0, 175.0, 185.0, 173.0, 193.0, 200.0, 200.0, 127.0, 194.0, 174.0, 185.0, 185.0, 175.0, 151.0, 173.0, 149.0, 188.0, 184.0, 200.0, 172.0, 193.0, 188.0, 174.0, 161.0, 179.0, 187.0, 200.0, 196.0, 180.0, 167.0, 197.0, 170.0, 200.0, 191.0, 199.0, 190.0, 174.0, 180.0, 164.0, 179.0, 176.0, 197.0, 163.0, 173.0, 198.0, 200.0, 138.0, 200.0], "policy_predator_policy_reward": [14.0, 0.0, 11.0, 0.0, 0.0, 0.0, 16.0, 18.0, 10.0, 0.0, 6.0, 8.0, 1.0, 0.0, 1.0, 7.0, 12.0, 0.0, 8.0, 13.0, 0.0, 0.0, 3.0, 19.0, 0.0, 11.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 10.0, 0.0, 8.0, 0.0, 0.0, 7.0, 2.0, 7.0, 9.0, 0.0, 0.0, 9.0, 0.0, 0.0, 5.0, 12.0, 7.0, 0.0, 5.0, 7.0, 0.0, 10.0, 8.0, 0.0, 0.0, 12.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 12.0, 8.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 1.0, 7.0, 0.0, 0.0, 6.0, 6.0, 7.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 15.0, 7.0, 0.0, 0.0, 0.0, 1.0, 5.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 2.0, 5.0, 15.0, 15.0, 2.0, 1.0, 7.0, 10.0, 11.0, 0.0, 19.0, 0.0, 10.0, 12.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 15.0, 5.0, 3.0, 1.0, 4.0, 0.0, 0.0, 7.0, 12.0, 14.0, 0.0, 0.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 24.0, 7.0, 0.0, 5.0, 5.0, 9.0, 8.0, 23.0, 0.0, 5.0, 0.0, 6.0, 0.0, 4.0, 0.0, 6.0, 13.0, 7.0, 0.0, 0.0, 0.0, 7.0, 9.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 12.0, 0.0, 0.0, 8.0, 14.0, 4.0, 0.0, 0.0, 0.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.677053315631108, "mean_inference_ms": 13.894077952768326, "mean_action_processing_ms": 0.7480123298689877, "mean_env_wait_ms": 2.0616483606952483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023430585861206055, "StateBufferConnector_ms": 0.013963699340820312, "ViewRequirementAgentConnector_ms": 0.3383209705352783}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 321.0, "episode_return_mean": 370.18, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 2864000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.18166514990784, "num_env_steps_trained_throughput_per_sec": 148.18166514990784, "timesteps_total": 716000, "num_env_steps_sampled_lifetime": 716000, "num_agent_steps_sampled_lifetime": 2864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2864000, "timers": {"training_iteration_time_ms": 25749.335, "restore_workers_time_ms": 0.019, "training_step_time_ms": 25749.255, "sample_time_ms": 4098.879, "learn_time_ms": 21615.19, "learn_throughput": 185.055, "synch_weights_time_ms": 28.435}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 2864000}, "done": false, "training_iteration": 179, "trial_id": "45bed_00000", "date": "2024-08-13_05-48-31", "timestamp": 1723542511, "time_this_iter_s": 27.051388263702393, "time_total_s": 16689.144065380096, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5343a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16689.144065380096, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 85.80526315789474, "ram_util_percent": 83.41578947368423}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8043629738901342, "cur_kl_coeff": 3.944304526105059e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.24640678466548996, "policy_loss": -0.001341712412981208, "vf_loss": 0.24774849698493853, "vf_explained_var": 0.0780988421074297, "kl": 0.0013539643311176021, "entropy": 0.08370377023029264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 339255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4689184052288216, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5651120008405535, "policy_loss": -0.002887872994566957, "vf_loss": 0.5679998737232631, "vf_explained_var": 0.35667638151103226, "kl": 0.008588383537170303, "entropy": 1.025723081732553, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 339255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 334.0, "episode_reward_mean": 370.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 127.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 24.0}, "policy_reward_mean": {"prey_policy": 181.61, "predator_policy": 3.79}, "custom_metrics": {}, "hist_stats": {"episode_reward": [341.0, 353.0, 369.0, 364.0, 375.0, 348.0, 361.0, 357.0, 356.0, 339.0, 353.0, 357.0, 393.0, 398.0, 372.0, 375.0, 390.0, 367.0, 357.0, 395.0, 389.0, 368.0, 363.0, 381.0, 336.0, 356.0, 386.0, 374.0, 343.0, 376.0, 377.0, 364.0, 367.0, 399.0, 366.0, 367.0, 394.0, 358.0, 363.0, 359.0, 344.0, 372.0, 391.0, 385.0, 396.0, 369.0, 358.0, 400.0, 389.0, 360.0, 381.0, 380.0, 377.0, 370.0, 395.0, 393.0, 385.0, 394.0, 365.0, 363.0, 393.0, 351.0, 375.0, 380.0, 343.0, 345.0, 377.0, 378.0, 385.0, 354.0, 373.0, 396.0, 363.0, 377.0, 391.0, 389.0, 355.0, 355.0, 381.0, 354.0, 398.0, 358.0, 383.0, 369.0, 362.0, 364.0, 343.0, 354.0, 334.0, 388.0, 374.0, 385.0, 386.0, 393.0, 365.0, 384.0, 398.0, 344.0, 360.0, 350.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [179.0, 155.0, 172.0, 172.0, 199.0, 161.0, 182.0, 173.0, 197.0, 178.0, 154.0, 177.0, 178.0, 176.0, 186.0, 159.0, 173.0, 173.0, 170.0, 161.0, 175.0, 166.0, 185.0, 168.0, 200.0, 193.0, 198.0, 200.0, 152.0, 200.0, 175.0, 200.0, 191.0, 196.0, 167.0, 193.0, 161.0, 188.0, 197.0, 198.0, 199.0, 178.0, 197.0, 164.0, 176.0, 173.0, 198.0, 183.0, 169.0, 152.0, 174.0, 175.0, 197.0, 189.0, 183.0, 185.0, 164.0, 168.0, 193.0, 183.0, 195.0, 182.0, 188.0, 176.0, 185.0, 175.0, 199.0, 200.0, 173.0, 186.0, 151.0, 186.0, 197.0, 194.0, 169.0, 172.0, 176.0, 176.0, 149.0, 191.0, 170.0, 152.0, 183.0, 184.0, 194.0, 197.0, 199.0, 186.0, 200.0, 196.0, 172.0, 190.0, 180.0, 170.0, 200.0, 200.0, 193.0, 196.0, 185.0, 155.0, 188.0, 189.0, 188.0, 188.0, 170.0, 200.0, 156.0, 188.0, 200.0, 195.0, 193.0, 200.0, 182.0, 194.0, 198.0, 196.0, 189.0, 175.0, 185.0, 173.0, 193.0, 200.0, 200.0, 127.0, 194.0, 174.0, 185.0, 185.0, 175.0, 151.0, 173.0, 149.0, 188.0, 184.0, 200.0, 172.0, 193.0, 188.0, 174.0, 161.0, 179.0, 187.0, 200.0, 196.0, 180.0, 167.0, 197.0, 170.0, 200.0, 191.0, 199.0, 190.0, 174.0, 180.0, 164.0, 179.0, 176.0, 197.0, 163.0, 173.0, 198.0, 200.0, 138.0, 200.0, 177.0, 200.0, 172.0, 193.0, 182.0, 172.0, 168.0, 176.0, 175.0, 168.0, 191.0, 146.0, 152.0, 159.0, 188.0, 200.0, 173.0, 192.0, 199.0, 181.0, 195.0, 191.0, 194.0, 199.0, 188.0, 168.0, 187.0, 197.0, 200.0, 198.0, 161.0, 171.0, 194.0, 166.0, 170.0, 168.0], "policy_predator_policy_reward": [0.0, 7.0, 2.0, 7.0, 9.0, 0.0, 0.0, 9.0, 0.0, 0.0, 5.0, 12.0, 7.0, 0.0, 5.0, 7.0, 0.0, 10.0, 8.0, 0.0, 0.0, 12.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 12.0, 8.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 1.0, 7.0, 0.0, 0.0, 6.0, 6.0, 7.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 15.0, 7.0, 0.0, 0.0, 0.0, 1.0, 5.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 2.0, 5.0, 15.0, 15.0, 2.0, 1.0, 7.0, 10.0, 11.0, 0.0, 19.0, 0.0, 10.0, 12.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 15.0, 5.0, 3.0, 1.0, 4.0, 0.0, 0.0, 7.0, 12.0, 14.0, 0.0, 0.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 24.0, 7.0, 0.0, 5.0, 5.0, 9.0, 8.0, 23.0, 0.0, 5.0, 0.0, 6.0, 0.0, 4.0, 0.0, 6.0, 13.0, 7.0, 0.0, 0.0, 0.0, 7.0, 9.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 12.0, 0.0, 0.0, 8.0, 14.0, 4.0, 0.0, 0.0, 0.0, 20.0, 6.0, 0.0, 3.0, 1.0, 0.0, 8.0, 11.0, 9.0, 0.0, 0.0, 8.0, 9.0, 14.0, 9.0, 0.0, 0.0, 9.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.6622348857510385, "mean_inference_ms": 13.84768516722698, "mean_action_processing_ms": 0.7476315131444201, "mean_env_wait_ms": 2.0542134629001514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022689223289489746, "StateBufferConnector_ms": 0.012467503547668457, "ViewRequirementAgentConnector_ms": 0.2687593698501587}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 334.0, "episode_return_mean": 370.8, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.28947534679617, "num_env_steps_trained_throughput_per_sec": 156.28947534679617, "timesteps_total": 720000, "num_env_steps_sampled_lifetime": 720000, "num_agent_steps_sampled_lifetime": 2880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2880000, "timers": {"training_iteration_time_ms": 25741.591, "restore_workers_time_ms": 0.019, "training_step_time_ms": 25741.518, "sample_time_ms": 3958.517, "learn_time_ms": 21751.775, "learn_throughput": 183.893, "synch_weights_time_ms": 24.682}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "done": false, "training_iteration": 180, "trial_id": "45bed_00000", "date": "2024-08-13_05-48-57", "timestamp": 1723542537, "time_this_iter_s": 25.638900995254517, "time_total_s": 16714.78296637535, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b53295e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16714.78296637535, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 82.8027027027027, "ram_util_percent": 82.92972972972974}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9397912124083155, "cur_kl_coeff": 1.9721522630525296e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.36487421081968086, "policy_loss": -0.0010629725716416799, "vf_loss": 0.3659371825167909, "vf_explained_var": 0.06476438846537676, "kl": 0.0016053932875753577, "entropy": 0.05886892026004495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 341145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9928696886020363, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5548482650664275, "policy_loss": -0.007159565798149853, "vf_loss": 0.5620078320137013, "vf_explained_var": 0.24535079945332158, "kl": 0.007151124290343091, "entropy": 1.0587883147297712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 341145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 2896000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 314.0, "episode_reward_mean": 370.88, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 98.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 34.0}, "policy_reward_mean": {"prey_policy": 181.0, "predator_policy": 4.44}, "custom_metrics": {}, "hist_stats": {"episode_reward": [357.0, 395.0, 389.0, 368.0, 363.0, 381.0, 336.0, 356.0, 386.0, 374.0, 343.0, 376.0, 377.0, 364.0, 367.0, 399.0, 366.0, 367.0, 394.0, 358.0, 363.0, 359.0, 344.0, 372.0, 391.0, 385.0, 396.0, 369.0, 358.0, 400.0, 389.0, 360.0, 381.0, 380.0, 377.0, 370.0, 395.0, 393.0, 385.0, 394.0, 365.0, 363.0, 393.0, 351.0, 375.0, 380.0, 343.0, 345.0, 377.0, 378.0, 385.0, 354.0, 373.0, 396.0, 363.0, 377.0, 391.0, 389.0, 355.0, 355.0, 381.0, 354.0, 398.0, 358.0, 383.0, 369.0, 362.0, 364.0, 343.0, 354.0, 334.0, 388.0, 374.0, 385.0, 386.0, 393.0, 365.0, 384.0, 398.0, 344.0, 360.0, 350.0, 353.0, 386.0, 314.0, 366.0, 356.0, 338.0, 374.0, 353.0, 374.0, 385.0, 390.0, 373.0, 377.0, 351.0, 398.0, 366.0, 376.0, 346.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [161.0, 188.0, 197.0, 198.0, 199.0, 178.0, 197.0, 164.0, 176.0, 173.0, 198.0, 183.0, 169.0, 152.0, 174.0, 175.0, 197.0, 189.0, 183.0, 185.0, 164.0, 168.0, 193.0, 183.0, 195.0, 182.0, 188.0, 176.0, 185.0, 175.0, 199.0, 200.0, 173.0, 186.0, 151.0, 186.0, 197.0, 194.0, 169.0, 172.0, 176.0, 176.0, 149.0, 191.0, 170.0, 152.0, 183.0, 184.0, 194.0, 197.0, 199.0, 186.0, 200.0, 196.0, 172.0, 190.0, 180.0, 170.0, 200.0, 200.0, 193.0, 196.0, 185.0, 155.0, 188.0, 189.0, 188.0, 188.0, 170.0, 200.0, 156.0, 188.0, 200.0, 195.0, 193.0, 200.0, 182.0, 194.0, 198.0, 196.0, 189.0, 175.0, 185.0, 173.0, 193.0, 200.0, 200.0, 127.0, 194.0, 174.0, 185.0, 185.0, 175.0, 151.0, 173.0, 149.0, 188.0, 184.0, 200.0, 172.0, 193.0, 188.0, 174.0, 161.0, 179.0, 187.0, 200.0, 196.0, 180.0, 167.0, 197.0, 170.0, 200.0, 191.0, 199.0, 190.0, 174.0, 180.0, 164.0, 179.0, 176.0, 197.0, 163.0, 173.0, 198.0, 200.0, 138.0, 200.0, 177.0, 200.0, 172.0, 193.0, 182.0, 172.0, 168.0, 176.0, 175.0, 168.0, 191.0, 146.0, 152.0, 159.0, 188.0, 200.0, 173.0, 192.0, 199.0, 181.0, 195.0, 191.0, 194.0, 199.0, 188.0, 168.0, 187.0, 197.0, 200.0, 198.0, 161.0, 171.0, 194.0, 166.0, 170.0, 168.0, 164.0, 182.0, 192.0, 191.0, 167.0, 124.0, 179.0, 170.0, 170.0, 164.0, 153.0, 161.0, 191.0, 175.0, 140.0, 195.0, 196.0, 173.0, 193.0, 188.0, 190.0, 200.0, 155.0, 193.0, 167.0, 200.0, 167.0, 166.0, 200.0, 198.0, 194.0, 160.0, 185.0, 184.0, 98.0, 187.0], "policy_predator_policy_reward": [1.0, 7.0, 0.0, 0.0, 6.0, 6.0, 7.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 15.0, 7.0, 0.0, 0.0, 0.0, 1.0, 5.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 2.0, 5.0, 15.0, 15.0, 2.0, 1.0, 7.0, 10.0, 11.0, 0.0, 19.0, 0.0, 10.0, 12.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 15.0, 5.0, 3.0, 1.0, 4.0, 0.0, 0.0, 7.0, 12.0, 14.0, 0.0, 0.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 24.0, 7.0, 0.0, 5.0, 5.0, 9.0, 8.0, 23.0, 0.0, 5.0, 0.0, 6.0, 0.0, 4.0, 0.0, 6.0, 13.0, 7.0, 0.0, 0.0, 0.0, 7.0, 9.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 12.0, 0.0, 0.0, 8.0, 14.0, 4.0, 0.0, 0.0, 0.0, 20.0, 6.0, 0.0, 3.0, 1.0, 0.0, 8.0, 11.0, 9.0, 0.0, 0.0, 8.0, 9.0, 14.0, 9.0, 0.0, 0.0, 9.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 7.0, 3.0, 0.0, 23.0, 0.0, 12.0, 5.0, 10.0, 12.0, 13.0, 11.0, 0.0, 8.0, 18.0, 0.0, 5.0, 0.0, 0.0, 4.0, 0.0, 0.0, 11.0, 14.0, 6.0, 4.0, 7.0, 11.0, 0.0, 0.0, 0.0, 12.0, 0.0, 7.0, 34.0, 27.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.647714651686736, "mean_inference_ms": 13.801930924950494, "mean_action_processing_ms": 0.7473105171526271, "mean_env_wait_ms": 2.0469421915057757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023284196853637695, "StateBufferConnector_ms": 0.013522148132324219, "ViewRequirementAgentConnector_ms": 0.2596200704574585}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 314.0, "episode_return_mean": 370.88, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 2896000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.3250623232192, "num_env_steps_trained_throughput_per_sec": 148.3250623232192, "timesteps_total": 724000, "num_env_steps_sampled_lifetime": 724000, "num_agent_steps_sampled_lifetime": 2896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2896000, "timers": {"training_iteration_time_ms": 25992.683, "restore_workers_time_ms": 0.018, "training_step_time_ms": 25992.611, "sample_time_ms": 3986.49, "learn_time_ms": 21975.576, "learn_throughput": 182.02, "synch_weights_time_ms": 24.773}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 2896000}, "done": false, "training_iteration": 181, "trial_id": "45bed_00000", "date": "2024-08-13_05-49-24", "timestamp": 1723542564, "time_this_iter_s": 27.045010089874268, "time_total_s": 16741.827976465225, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b52c84c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16741.827976465225, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 84.04210526315791, "ram_util_percent": 83.23947368421051}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7834289539506827, "cur_kl_coeff": 9.860761315262648e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.22322418715745684, "policy_loss": -0.0007542489022607841, "vf_loss": 0.22397843639196324, "vf_explained_var": 0.07244913921785102, "kl": 0.002007494743248414, "entropy": 0.062274530642325916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 343035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.326179405881299, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.44500733949588955, "policy_loss": -0.0038114294651205895, "vf_loss": 0.44881876997117487, "vf_explained_var": 0.30320480229362606, "kl": 0.010262055210711569, "entropy": 1.1144919192980207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 343035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 314.0, "episode_reward_mean": 372.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 98.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 34.0}, "policy_reward_mean": {"prey_policy": 182.105, "predator_policy": 4.155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [372.0, 391.0, 385.0, 396.0, 369.0, 358.0, 400.0, 389.0, 360.0, 381.0, 380.0, 377.0, 370.0, 395.0, 393.0, 385.0, 394.0, 365.0, 363.0, 393.0, 351.0, 375.0, 380.0, 343.0, 345.0, 377.0, 378.0, 385.0, 354.0, 373.0, 396.0, 363.0, 377.0, 391.0, 389.0, 355.0, 355.0, 381.0, 354.0, 398.0, 358.0, 383.0, 369.0, 362.0, 364.0, 343.0, 354.0, 334.0, 388.0, 374.0, 385.0, 386.0, 393.0, 365.0, 384.0, 398.0, 344.0, 360.0, 350.0, 353.0, 386.0, 314.0, 366.0, 356.0, 338.0, 374.0, 353.0, 374.0, 385.0, 390.0, 373.0, 377.0, 351.0, 398.0, 366.0, 376.0, 346.0, 369.0, 387.0, 361.0, 355.0, 386.0, 381.0, 372.0, 396.0, 374.0, 338.0, 383.0, 382.0, 372.0, 395.0, 360.0, 396.0, 378.0, 356.0, 388.0, 348.0, 399.0, 370.0, 400.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [183.0, 184.0, 194.0, 197.0, 199.0, 186.0, 200.0, 196.0, 172.0, 190.0, 180.0, 170.0, 200.0, 200.0, 193.0, 196.0, 185.0, 155.0, 188.0, 189.0, 188.0, 188.0, 170.0, 200.0, 156.0, 188.0, 200.0, 195.0, 193.0, 200.0, 182.0, 194.0, 198.0, 196.0, 189.0, 175.0, 185.0, 173.0, 193.0, 200.0, 200.0, 127.0, 194.0, 174.0, 185.0, 185.0, 175.0, 151.0, 173.0, 149.0, 188.0, 184.0, 200.0, 172.0, 193.0, 188.0, 174.0, 161.0, 179.0, 187.0, 200.0, 196.0, 180.0, 167.0, 197.0, 170.0, 200.0, 191.0, 199.0, 190.0, 174.0, 180.0, 164.0, 179.0, 176.0, 197.0, 163.0, 173.0, 198.0, 200.0, 138.0, 200.0, 177.0, 200.0, 172.0, 193.0, 182.0, 172.0, 168.0, 176.0, 175.0, 168.0, 191.0, 146.0, 152.0, 159.0, 188.0, 200.0, 173.0, 192.0, 199.0, 181.0, 195.0, 191.0, 194.0, 199.0, 188.0, 168.0, 187.0, 197.0, 200.0, 198.0, 161.0, 171.0, 194.0, 166.0, 170.0, 168.0, 164.0, 182.0, 192.0, 191.0, 167.0, 124.0, 179.0, 170.0, 170.0, 164.0, 153.0, 161.0, 191.0, 175.0, 140.0, 195.0, 196.0, 173.0, 193.0, 188.0, 190.0, 200.0, 155.0, 193.0, 167.0, 200.0, 167.0, 166.0, 200.0, 198.0, 194.0, 160.0, 185.0, 184.0, 98.0, 187.0, 183.0, 186.0, 200.0, 181.0, 184.0, 177.0, 167.0, 168.0, 198.0, 182.0, 194.0, 185.0, 179.0, 182.0, 196.0, 200.0, 192.0, 174.0, 157.0, 160.0, 189.0, 194.0, 193.0, 189.0, 176.0, 188.0, 196.0, 199.0, 188.0, 161.0, 196.0, 200.0, 167.0, 200.0, 176.0, 172.0, 182.0, 200.0, 165.0, 169.0, 200.0, 199.0, 184.0, 179.0, 200.0, 200.0], "policy_predator_policy_reward": [5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 15.0, 5.0, 3.0, 1.0, 4.0, 0.0, 0.0, 7.0, 12.0, 14.0, 0.0, 0.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 24.0, 7.0, 0.0, 5.0, 5.0, 9.0, 8.0, 23.0, 0.0, 5.0, 0.0, 6.0, 0.0, 4.0, 0.0, 6.0, 13.0, 7.0, 0.0, 0.0, 0.0, 7.0, 9.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 12.0, 0.0, 0.0, 8.0, 14.0, 4.0, 0.0, 0.0, 0.0, 20.0, 6.0, 0.0, 3.0, 1.0, 0.0, 8.0, 11.0, 9.0, 0.0, 0.0, 8.0, 9.0, 14.0, 9.0, 0.0, 0.0, 9.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 7.0, 3.0, 0.0, 23.0, 0.0, 12.0, 5.0, 10.0, 12.0, 13.0, 11.0, 0.0, 8.0, 18.0, 0.0, 5.0, 0.0, 0.0, 4.0, 0.0, 0.0, 11.0, 14.0, 6.0, 4.0, 7.0, 11.0, 0.0, 0.0, 0.0, 12.0, 0.0, 7.0, 34.0, 27.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 11.0, 9.0, 0.0, 6.0, 2.0, 0.0, 0.0, 11.0, 0.0, 0.0, 8.0, 0.0, 9.0, 12.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 11.0, 0.0, 0.0, 8.0, 0.0, 6.0, 5.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.8913293711579335, "mean_inference_ms": 13.488848628005748, "mean_action_processing_ms": 0.7494418239626482, "mean_env_wait_ms": 2.041096630846469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030150771141052246, "StateBufferConnector_ms": 0.01461637020111084, "ViewRequirementAgentConnector_ms": 0.3530768156051636}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 314.0, "episode_return_mean": 372.52, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.00433563851274, "num_env_steps_trained_throughput_per_sec": 154.00433563851274, "timesteps_total": 728000, "num_env_steps_sampled_lifetime": 728000, "num_agent_steps_sampled_lifetime": 2912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2912000, "timers": {"training_iteration_time_ms": 26032.045, "restore_workers_time_ms": 0.019, "training_step_time_ms": 26031.972, "sample_time_ms": 4108.125, "learn_time_ms": 21893.462, "learn_throughput": 182.703, "synch_weights_time_ms": 24.464}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000}, "done": false, "training_iteration": 182, "trial_id": "45bed_00000", "date": "2024-08-13_05-49-50", "timestamp": 1723542590, "time_this_iter_s": 26.016371965408325, "time_total_s": 16767.844348430634, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b53928b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16767.844348430634, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 83.73243243243243, "ram_util_percent": 83.0891891891892}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8967263987810208, "cur_kl_coeff": 4.930380657631324e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.47536510669049764, "policy_loss": -0.0011778126621037406, "vf_loss": 0.47654291752297134, "vf_explained_var": 0.04607891963903235, "kl": 0.0017922180331076947, "entropy": 0.06285647888810783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 344925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5211721880962608, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7277569398648603, "policy_loss": -0.004906431452504226, "vf_loss": 0.7326633732470255, "vf_explained_var": 0.21994190827879326, "kl": 0.010509141654273706, "entropy": 1.0540523944077669, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 344925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 2928000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 302.0, "episode_reward_mean": 370.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 98.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 34.0}, "policy_reward_mean": {"prey_policy": 180.155, "predator_policy": 4.865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.0, 343.0, 345.0, 377.0, 378.0, 385.0, 354.0, 373.0, 396.0, 363.0, 377.0, 391.0, 389.0, 355.0, 355.0, 381.0, 354.0, 398.0, 358.0, 383.0, 369.0, 362.0, 364.0, 343.0, 354.0, 334.0, 388.0, 374.0, 385.0, 386.0, 393.0, 365.0, 384.0, 398.0, 344.0, 360.0, 350.0, 353.0, 386.0, 314.0, 366.0, 356.0, 338.0, 374.0, 353.0, 374.0, 385.0, 390.0, 373.0, 377.0, 351.0, 398.0, 366.0, 376.0, 346.0, 369.0, 387.0, 361.0, 355.0, 386.0, 381.0, 372.0, 396.0, 374.0, 338.0, 383.0, 382.0, 372.0, 395.0, 360.0, 396.0, 378.0, 356.0, 388.0, 348.0, 399.0, 370.0, 400.0, 362.0, 343.0, 380.0, 376.0, 385.0, 368.0, 374.0, 393.0, 352.0, 368.0, 385.0, 398.0, 305.0, 396.0, 358.0, 363.0, 378.0, 378.0, 381.0, 389.0, 360.0, 302.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [185.0, 185.0, 175.0, 151.0, 173.0, 149.0, 188.0, 184.0, 200.0, 172.0, 193.0, 188.0, 174.0, 161.0, 179.0, 187.0, 200.0, 196.0, 180.0, 167.0, 197.0, 170.0, 200.0, 191.0, 199.0, 190.0, 174.0, 180.0, 164.0, 179.0, 176.0, 197.0, 163.0, 173.0, 198.0, 200.0, 138.0, 200.0, 177.0, 200.0, 172.0, 193.0, 182.0, 172.0, 168.0, 176.0, 175.0, 168.0, 191.0, 146.0, 152.0, 159.0, 188.0, 200.0, 173.0, 192.0, 199.0, 181.0, 195.0, 191.0, 194.0, 199.0, 188.0, 168.0, 187.0, 197.0, 200.0, 198.0, 161.0, 171.0, 194.0, 166.0, 170.0, 168.0, 164.0, 182.0, 192.0, 191.0, 167.0, 124.0, 179.0, 170.0, 170.0, 164.0, 153.0, 161.0, 191.0, 175.0, 140.0, 195.0, 196.0, 173.0, 193.0, 188.0, 190.0, 200.0, 155.0, 193.0, 167.0, 200.0, 167.0, 166.0, 200.0, 198.0, 194.0, 160.0, 185.0, 184.0, 98.0, 187.0, 183.0, 186.0, 200.0, 181.0, 184.0, 177.0, 167.0, 168.0, 198.0, 182.0, 194.0, 185.0, 179.0, 182.0, 196.0, 200.0, 192.0, 174.0, 157.0, 160.0, 189.0, 194.0, 193.0, 189.0, 176.0, 188.0, 196.0, 199.0, 188.0, 161.0, 196.0, 200.0, 167.0, 200.0, 176.0, 172.0, 182.0, 200.0, 165.0, 169.0, 200.0, 199.0, 184.0, 179.0, 200.0, 200.0, 152.0, 194.0, 138.0, 176.0, 146.0, 200.0, 188.0, 188.0, 200.0, 181.0, 128.0, 200.0, 192.0, 182.0, 200.0, 193.0, 135.0, 200.0, 161.0, 191.0, 191.0, 194.0, 200.0, 198.0, 136.0, 142.0, 198.0, 197.0, 170.0, 178.0, 177.0, 179.0, 176.0, 194.0, 170.0, 199.0, 197.0, 184.0, 189.0, 200.0, 143.0, 200.0, 156.0, 112.0], "policy_predator_policy_reward": [5.0, 5.0, 9.0, 8.0, 23.0, 0.0, 5.0, 0.0, 6.0, 0.0, 4.0, 0.0, 6.0, 13.0, 7.0, 0.0, 0.0, 0.0, 7.0, 9.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 12.0, 0.0, 0.0, 8.0, 14.0, 4.0, 0.0, 0.0, 0.0, 20.0, 6.0, 0.0, 3.0, 1.0, 0.0, 8.0, 11.0, 9.0, 0.0, 0.0, 8.0, 9.0, 14.0, 9.0, 0.0, 0.0, 9.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 7.0, 3.0, 0.0, 23.0, 0.0, 12.0, 5.0, 10.0, 12.0, 13.0, 11.0, 0.0, 8.0, 18.0, 0.0, 5.0, 0.0, 0.0, 4.0, 0.0, 0.0, 11.0, 14.0, 6.0, 4.0, 7.0, 11.0, 0.0, 0.0, 0.0, 12.0, 0.0, 7.0, 34.0, 27.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 11.0, 9.0, 0.0, 6.0, 2.0, 0.0, 0.0, 11.0, 0.0, 0.0, 8.0, 0.0, 9.0, 12.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 11.0, 0.0, 0.0, 8.0, 0.0, 6.0, 5.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 9.0, 7.0, 15.0, 14.0, 16.0, 18.0, 0.0, 0.0, 4.0, 0.0, 17.0, 23.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 3.0, 13.0, 0.0, 0.0, 0.0, 0.0, 8.0, 19.0, 0.0, 1.0, 10.0, 0.0, 0.0, 7.0, 8.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 13.0, 21.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.616783368931434, "mean_inference_ms": 13.697311898446156, "mean_action_processing_ms": 0.7474786333081588, "mean_env_wait_ms": 2.029734753974668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03166306018829346, "StateBufferConnector_ms": 0.043778419494628906, "ViewRequirementAgentConnector_ms": 0.44297170639038086}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 302.0, "episode_return_mean": 370.04, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 2928000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.2791278474869, "num_env_steps_trained_throughput_per_sec": 148.2791278474869, "timesteps_total": 732000, "num_env_steps_sampled_lifetime": 732000, "num_agent_steps_sampled_lifetime": 2928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2928000, "timers": {"training_iteration_time_ms": 26272.079, "restore_workers_time_ms": 0.019, "training_step_time_ms": 26272.005, "sample_time_ms": 4168.643, "learn_time_ms": 22074.516, "learn_throughput": 181.204, "synch_weights_time_ms": 23.211}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 2928000}, "done": false, "training_iteration": 183, "trial_id": "45bed_00000", "date": "2024-08-13_05-50-17", "timestamp": 1723542617, "time_this_iter_s": 27.098365306854248, "time_total_s": 16794.942713737488, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5211b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16794.942713737488, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 85.4236842105263, "ram_util_percent": 82.99473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4143405484893019, "cur_kl_coeff": 2.465190328815662e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.20986342207435027, "policy_loss": -0.00040419814300048286, "vf_loss": 0.2102676205142406, "vf_explained_var": 0.009582126645184067, "kl": 0.003564746938159826, "entropy": 0.06849122898426478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 346815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8828362516782902, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5324136991566294, "policy_loss": -0.00474965371334403, "vf_loss": 0.5371633515574984, "vf_explained_var": 0.307333959883483, "kl": 0.008733152715335625, "entropy": 1.0626983588965482, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 346815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 302.0, "episode_reward_mean": 369.82, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 98.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 34.0}, "policy_reward_mean": {"prey_policy": 180.015, "predator_policy": 4.895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [358.0, 383.0, 369.0, 362.0, 364.0, 343.0, 354.0, 334.0, 388.0, 374.0, 385.0, 386.0, 393.0, 365.0, 384.0, 398.0, 344.0, 360.0, 350.0, 353.0, 386.0, 314.0, 366.0, 356.0, 338.0, 374.0, 353.0, 374.0, 385.0, 390.0, 373.0, 377.0, 351.0, 398.0, 366.0, 376.0, 346.0, 369.0, 387.0, 361.0, 355.0, 386.0, 381.0, 372.0, 396.0, 374.0, 338.0, 383.0, 382.0, 372.0, 395.0, 360.0, 396.0, 378.0, 356.0, 388.0, 348.0, 399.0, 370.0, 400.0, 362.0, 343.0, 380.0, 376.0, 385.0, 368.0, 374.0, 393.0, 352.0, 368.0, 385.0, 398.0, 305.0, 396.0, 358.0, 363.0, 378.0, 378.0, 381.0, 389.0, 360.0, 302.0, 368.0, 373.0, 364.0, 354.0, 365.0, 372.0, 370.0, 386.0, 390.0, 363.0, 344.0, 317.0, 380.0, 376.0, 400.0, 388.0, 392.0, 370.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [138.0, 200.0, 177.0, 200.0, 172.0, 193.0, 182.0, 172.0, 168.0, 176.0, 175.0, 168.0, 191.0, 146.0, 152.0, 159.0, 188.0, 200.0, 173.0, 192.0, 199.0, 181.0, 195.0, 191.0, 194.0, 199.0, 188.0, 168.0, 187.0, 197.0, 200.0, 198.0, 161.0, 171.0, 194.0, 166.0, 170.0, 168.0, 164.0, 182.0, 192.0, 191.0, 167.0, 124.0, 179.0, 170.0, 170.0, 164.0, 153.0, 161.0, 191.0, 175.0, 140.0, 195.0, 196.0, 173.0, 193.0, 188.0, 190.0, 200.0, 155.0, 193.0, 167.0, 200.0, 167.0, 166.0, 200.0, 198.0, 194.0, 160.0, 185.0, 184.0, 98.0, 187.0, 183.0, 186.0, 200.0, 181.0, 184.0, 177.0, 167.0, 168.0, 198.0, 182.0, 194.0, 185.0, 179.0, 182.0, 196.0, 200.0, 192.0, 174.0, 157.0, 160.0, 189.0, 194.0, 193.0, 189.0, 176.0, 188.0, 196.0, 199.0, 188.0, 161.0, 196.0, 200.0, 167.0, 200.0, 176.0, 172.0, 182.0, 200.0, 165.0, 169.0, 200.0, 199.0, 184.0, 179.0, 200.0, 200.0, 152.0, 194.0, 138.0, 176.0, 146.0, 200.0, 188.0, 188.0, 200.0, 181.0, 128.0, 200.0, 192.0, 182.0, 200.0, 193.0, 135.0, 200.0, 161.0, 191.0, 191.0, 194.0, 200.0, 198.0, 136.0, 142.0, 198.0, 197.0, 170.0, 178.0, 177.0, 179.0, 176.0, 194.0, 170.0, 199.0, 197.0, 184.0, 189.0, 200.0, 143.0, 200.0, 156.0, 112.0, 177.0, 184.0, 169.0, 194.0, 181.0, 177.0, 160.0, 182.0, 152.0, 196.0, 178.0, 192.0, 195.0, 167.0, 196.0, 185.0, 198.0, 188.0, 170.0, 167.0, 140.0, 181.0, 146.0, 142.0, 187.0, 189.0, 181.0, 195.0, 200.0, 200.0, 193.0, 195.0, 198.0, 194.0, 165.0, 196.0], "policy_predator_policy_reward": [0.0, 20.0, 6.0, 0.0, 3.0, 1.0, 0.0, 8.0, 11.0, 9.0, 0.0, 0.0, 8.0, 9.0, 14.0, 9.0, 0.0, 0.0, 9.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 7.0, 3.0, 0.0, 23.0, 0.0, 12.0, 5.0, 10.0, 12.0, 13.0, 11.0, 0.0, 8.0, 18.0, 0.0, 5.0, 0.0, 0.0, 4.0, 0.0, 0.0, 11.0, 14.0, 6.0, 4.0, 7.0, 11.0, 0.0, 0.0, 0.0, 12.0, 0.0, 7.0, 34.0, 27.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 11.0, 9.0, 0.0, 6.0, 2.0, 0.0, 0.0, 11.0, 0.0, 0.0, 8.0, 0.0, 9.0, 12.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 11.0, 0.0, 0.0, 8.0, 0.0, 6.0, 5.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 9.0, 7.0, 15.0, 14.0, 16.0, 18.0, 0.0, 0.0, 4.0, 0.0, 17.0, 23.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 3.0, 13.0, 0.0, 0.0, 0.0, 0.0, 8.0, 19.0, 0.0, 1.0, 10.0, 0.0, 0.0, 7.0, 8.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 13.0, 21.0, 1.0, 6.0, 0.0, 10.0, 6.0, 0.0, 12.0, 0.0, 8.0, 9.0, 2.0, 0.0, 0.0, 8.0, 0.0, 5.0, 4.0, 0.0, 12.0, 14.0, 0.0, 23.0, 0.0, 29.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.605362575731712, "mean_inference_ms": 13.65698431767691, "mean_action_processing_ms": 0.7479042852877578, "mean_env_wait_ms": 2.023119334533758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028167366981506348, "StateBufferConnector_ms": 0.03873002529144287, "ViewRequirementAgentConnector_ms": 0.4467289447784424}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 302.0, "episode_return_mean": 369.82, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 145.25444798033507, "num_env_steps_trained_throughput_per_sec": 145.25444798033507, "timesteps_total": 736000, "num_env_steps_sampled_lifetime": 736000, "num_agent_steps_sampled_lifetime": 2944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2944000, "timers": {"training_iteration_time_ms": 26442.649, "restore_workers_time_ms": 0.019, "training_step_time_ms": 26442.575, "sample_time_ms": 4237.392, "learn_time_ms": 22176.351, "learn_throughput": 180.372, "synch_weights_time_ms": 23.154}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000}, "done": false, "training_iteration": 184, "trial_id": "45bed_00000", "date": "2024-08-13_05-50-45", "timestamp": 1723542645, "time_this_iter_s": 27.604999780654907, "time_total_s": 16822.547713518143, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b521cc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16822.547713518143, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 84.47948717948718, "ram_util_percent": 83.21794871794873}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4420034242882615, "cur_kl_coeff": 1.232595164407831e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.22904512643341035, "policy_loss": -0.0035320717880807854, "vf_loss": 0.23257719769694463, "vf_explained_var": 0.005680096780181562, "kl": 0.12247126237928656, "entropy": 0.09391745374237419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 348705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.739056872943091, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9901780905428702, "policy_loss": -0.007240842418774726, "vf_loss": 0.9974189333026371, "vf_explained_var": 0.5364512880958577, "kl": 0.013761348446081506, "entropy": 0.9937870189626381, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 348705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 257.0, "episode_reward_mean": 369.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 62.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 34.0}, "policy_reward_mean": {"prey_policy": 179.8, "predator_policy": 5.04}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.0, 353.0, 386.0, 314.0, 366.0, 356.0, 338.0, 374.0, 353.0, 374.0, 385.0, 390.0, 373.0, 377.0, 351.0, 398.0, 366.0, 376.0, 346.0, 369.0, 387.0, 361.0, 355.0, 386.0, 381.0, 372.0, 396.0, 374.0, 338.0, 383.0, 382.0, 372.0, 395.0, 360.0, 396.0, 378.0, 356.0, 388.0, 348.0, 399.0, 370.0, 400.0, 362.0, 343.0, 380.0, 376.0, 385.0, 368.0, 374.0, 393.0, 352.0, 368.0, 385.0, 398.0, 305.0, 396.0, 358.0, 363.0, 378.0, 378.0, 381.0, 389.0, 360.0, 302.0, 368.0, 373.0, 364.0, 354.0, 365.0, 372.0, 370.0, 386.0, 390.0, 363.0, 344.0, 317.0, 380.0, 376.0, 400.0, 388.0, 392.0, 370.0, 361.0, 368.0, 358.0, 365.0, 364.0, 380.0, 358.0, 257.0, 399.0, 373.0, 399.0, 361.0, 379.0, 374.0, 399.0, 375.0, 376.0, 384.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [170.0, 168.0, 164.0, 182.0, 192.0, 191.0, 167.0, 124.0, 179.0, 170.0, 170.0, 164.0, 153.0, 161.0, 191.0, 175.0, 140.0, 195.0, 196.0, 173.0, 193.0, 188.0, 190.0, 200.0, 155.0, 193.0, 167.0, 200.0, 167.0, 166.0, 200.0, 198.0, 194.0, 160.0, 185.0, 184.0, 98.0, 187.0, 183.0, 186.0, 200.0, 181.0, 184.0, 177.0, 167.0, 168.0, 198.0, 182.0, 194.0, 185.0, 179.0, 182.0, 196.0, 200.0, 192.0, 174.0, 157.0, 160.0, 189.0, 194.0, 193.0, 189.0, 176.0, 188.0, 196.0, 199.0, 188.0, 161.0, 196.0, 200.0, 167.0, 200.0, 176.0, 172.0, 182.0, 200.0, 165.0, 169.0, 200.0, 199.0, 184.0, 179.0, 200.0, 200.0, 152.0, 194.0, 138.0, 176.0, 146.0, 200.0, 188.0, 188.0, 200.0, 181.0, 128.0, 200.0, 192.0, 182.0, 200.0, 193.0, 135.0, 200.0, 161.0, 191.0, 191.0, 194.0, 200.0, 198.0, 136.0, 142.0, 198.0, 197.0, 170.0, 178.0, 177.0, 179.0, 176.0, 194.0, 170.0, 199.0, 197.0, 184.0, 189.0, 200.0, 143.0, 200.0, 156.0, 112.0, 177.0, 184.0, 169.0, 194.0, 181.0, 177.0, 160.0, 182.0, 152.0, 196.0, 178.0, 192.0, 195.0, 167.0, 196.0, 185.0, 198.0, 188.0, 170.0, 167.0, 140.0, 181.0, 146.0, 142.0, 187.0, 189.0, 181.0, 195.0, 200.0, 200.0, 193.0, 195.0, 198.0, 194.0, 165.0, 196.0, 171.0, 174.0, 182.0, 175.0, 176.0, 164.0, 198.0, 152.0, 200.0, 146.0, 170.0, 200.0, 187.0, 158.0, 195.0, 62.0, 199.0, 200.0, 150.0, 199.0, 200.0, 199.0, 166.0, 183.0, 192.0, 187.0, 163.0, 200.0, 199.0, 200.0, 191.0, 181.0, 195.0, 174.0, 192.0, 188.0], "policy_predator_policy_reward": [0.0, 12.0, 0.0, 7.0, 3.0, 0.0, 23.0, 0.0, 12.0, 5.0, 10.0, 12.0, 13.0, 11.0, 0.0, 8.0, 18.0, 0.0, 5.0, 0.0, 0.0, 4.0, 0.0, 0.0, 11.0, 14.0, 6.0, 4.0, 7.0, 11.0, 0.0, 0.0, 0.0, 12.0, 0.0, 7.0, 34.0, 27.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 11.0, 9.0, 0.0, 6.0, 2.0, 0.0, 0.0, 11.0, 0.0, 0.0, 8.0, 0.0, 9.0, 12.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 11.0, 0.0, 0.0, 8.0, 0.0, 6.0, 5.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 9.0, 7.0, 15.0, 14.0, 16.0, 18.0, 0.0, 0.0, 4.0, 0.0, 17.0, 23.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 3.0, 13.0, 0.0, 0.0, 0.0, 0.0, 8.0, 19.0, 0.0, 1.0, 10.0, 0.0, 0.0, 7.0, 8.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 13.0, 21.0, 1.0, 6.0, 0.0, 10.0, 6.0, 0.0, 12.0, 0.0, 8.0, 9.0, 2.0, 0.0, 0.0, 8.0, 0.0, 5.0, 4.0, 0.0, 12.0, 14.0, 0.0, 23.0, 0.0, 29.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 8.0, 7.0, 9.0, 0.0, 11.0, 7.0, 11.0, 15.0, 0.0, 0.0, 18.0, 10.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 12.0, 12.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.595796591502945, "mean_inference_ms": 13.620788459833426, "mean_action_processing_ms": 0.7488875043388452, "mean_env_wait_ms": 2.016992840614343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11808061599731445, "StateBufferConnector_ms": 0.041701436042785645, "ViewRequirementAgentConnector_ms": 0.5150445699691772}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 257.0, "episode_return_mean": 369.68, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 144.75726347772687, "num_env_steps_trained_throughput_per_sec": 144.75726347772687, "timesteps_total": 740000, "num_env_steps_sampled_lifetime": 740000, "num_agent_steps_sampled_lifetime": 2960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2960000, "timers": {"training_iteration_time_ms": 26527.902, "restore_workers_time_ms": 0.019, "training_step_time_ms": 26527.836, "sample_time_ms": 4456.02, "learn_time_ms": 22035.961, "learn_throughput": 181.521, "synch_weights_time_ms": 30.633}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "done": false, "training_iteration": 185, "trial_id": "45bed_00000", "date": "2024-08-13_05-51-13", "timestamp": 1723542673, "time_this_iter_s": 27.702770948410034, "time_total_s": 16850.250484466553, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5392ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16850.250484466553, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 83.84615384615385, "ram_util_percent": 83.15641025641027}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6932189449431404, "cur_kl_coeff": 1.848892746611746e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.22048544392147393, "policy_loss": -0.0010964669452280438, "vf_loss": 0.2215819109331942, "vf_explained_var": 0.04926295368759721, "kl": 0.004246762228706505, "entropy": 0.10421696180901514, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 350595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.280465894574841, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9853127708668431, "policy_loss": -0.004880597025510811, "vf_loss": 0.9901933717230956, "vf_explained_var": 0.6833705213019456, "kl": 0.00711676044280067, "entropy": 0.9542634963673889, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 350595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 37.0, "episode_reward_mean": 365.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 0.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 34.0}, "policy_reward_mean": {"prey_policy": 178.265, "predator_policy": 4.64}, "custom_metrics": {}, "hist_stats": {"episode_reward": [346.0, 369.0, 387.0, 361.0, 355.0, 386.0, 381.0, 372.0, 396.0, 374.0, 338.0, 383.0, 382.0, 372.0, 395.0, 360.0, 396.0, 378.0, 356.0, 388.0, 348.0, 399.0, 370.0, 400.0, 362.0, 343.0, 380.0, 376.0, 385.0, 368.0, 374.0, 393.0, 352.0, 368.0, 385.0, 398.0, 305.0, 396.0, 358.0, 363.0, 378.0, 378.0, 381.0, 389.0, 360.0, 302.0, 368.0, 373.0, 364.0, 354.0, 365.0, 372.0, 370.0, 386.0, 390.0, 363.0, 344.0, 317.0, 380.0, 376.0, 400.0, 388.0, 392.0, 370.0, 361.0, 368.0, 358.0, 365.0, 364.0, 380.0, 358.0, 257.0, 399.0, 373.0, 399.0, 361.0, 379.0, 374.0, 399.0, 375.0, 376.0, 384.0, 357.0, 365.0, 384.0, 392.0, 37.0, 346.0, 361.0, 353.0, 390.0, 365.0, 194.0, 378.0, 370.0, 376.0, 385.0, 365.0, 386.0, 389.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [98.0, 187.0, 183.0, 186.0, 200.0, 181.0, 184.0, 177.0, 167.0, 168.0, 198.0, 182.0, 194.0, 185.0, 179.0, 182.0, 196.0, 200.0, 192.0, 174.0, 157.0, 160.0, 189.0, 194.0, 193.0, 189.0, 176.0, 188.0, 196.0, 199.0, 188.0, 161.0, 196.0, 200.0, 167.0, 200.0, 176.0, 172.0, 182.0, 200.0, 165.0, 169.0, 200.0, 199.0, 184.0, 179.0, 200.0, 200.0, 152.0, 194.0, 138.0, 176.0, 146.0, 200.0, 188.0, 188.0, 200.0, 181.0, 128.0, 200.0, 192.0, 182.0, 200.0, 193.0, 135.0, 200.0, 161.0, 191.0, 191.0, 194.0, 200.0, 198.0, 136.0, 142.0, 198.0, 197.0, 170.0, 178.0, 177.0, 179.0, 176.0, 194.0, 170.0, 199.0, 197.0, 184.0, 189.0, 200.0, 143.0, 200.0, 156.0, 112.0, 177.0, 184.0, 169.0, 194.0, 181.0, 177.0, 160.0, 182.0, 152.0, 196.0, 178.0, 192.0, 195.0, 167.0, 196.0, 185.0, 198.0, 188.0, 170.0, 167.0, 140.0, 181.0, 146.0, 142.0, 187.0, 189.0, 181.0, 195.0, 200.0, 200.0, 193.0, 195.0, 198.0, 194.0, 165.0, 196.0, 171.0, 174.0, 182.0, 175.0, 176.0, 164.0, 198.0, 152.0, 200.0, 146.0, 170.0, 200.0, 187.0, 158.0, 195.0, 62.0, 199.0, 200.0, 150.0, 199.0, 200.0, 199.0, 166.0, 183.0, 192.0, 187.0, 163.0, 200.0, 199.0, 200.0, 191.0, 181.0, 195.0, 174.0, 192.0, 188.0, 146.0, 193.0, 199.0, 163.0, 184.0, 200.0, 197.0, 195.0, 19.0, 18.0, 196.0, 143.0, 162.0, 183.0, 164.0, 171.0, 200.0, 185.0, 174.0, 185.0, 191.0, 0.0, 170.0, 193.0, 164.0, 191.0, 180.0, 191.0, 185.0, 195.0, 152.0, 197.0, 191.0, 192.0, 195.0, 194.0], "policy_predator_policy_reward": [34.0, 27.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 11.0, 9.0, 0.0, 6.0, 2.0, 0.0, 0.0, 11.0, 0.0, 0.0, 8.0, 0.0, 9.0, 12.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 11.0, 0.0, 0.0, 8.0, 0.0, 6.0, 5.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 9.0, 7.0, 15.0, 14.0, 16.0, 18.0, 0.0, 0.0, 4.0, 0.0, 17.0, 23.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 3.0, 13.0, 0.0, 0.0, 0.0, 0.0, 8.0, 19.0, 0.0, 1.0, 10.0, 0.0, 0.0, 7.0, 8.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 13.0, 21.0, 1.0, 6.0, 0.0, 10.0, 6.0, 0.0, 12.0, 0.0, 8.0, 9.0, 2.0, 0.0, 0.0, 8.0, 0.0, 5.0, 4.0, 0.0, 12.0, 14.0, 0.0, 23.0, 0.0, 29.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 8.0, 7.0, 9.0, 0.0, 11.0, 7.0, 11.0, 15.0, 0.0, 0.0, 18.0, 10.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 12.0, 12.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 4.0, 0.0, 18.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 4.0, 12.0, 0.0, 18.0, 5.0, 0.0, 0.0, 6.0, 3.0, 0.0, 10.0, 5.0, 12.0, 3.0, 5.0, 0.0, 5.0, 0.0, 0.0, 16.0, 3.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.587840086582152, "mean_inference_ms": 13.589695508966955, "mean_action_processing_ms": 0.7504789342679511, "mean_env_wait_ms": 2.011483729838217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11873960494995117, "StateBufferConnector_ms": 0.04114806652069092, "ViewRequirementAgentConnector_ms": 0.5498887300491333}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 37.0, "episode_return_mean": 365.81, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 141.25593966969723, "num_env_steps_trained_throughput_per_sec": 141.25593966969723, "timesteps_total": 744000, "num_env_steps_sampled_lifetime": 744000, "num_agent_steps_sampled_lifetime": 2976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2976000, "timers": {"training_iteration_time_ms": 26717.358, "restore_workers_time_ms": 0.021, "training_step_time_ms": 26717.291, "sample_time_ms": 4845.81, "learn_time_ms": 21836.767, "learn_throughput": 183.177, "synch_weights_time_ms": 29.945}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000}, "done": false, "training_iteration": 186, "trial_id": "45bed_00000", "date": "2024-08-13_05-51-41", "timestamp": 1723542701, "time_this_iter_s": 28.331225156784058, "time_total_s": 16878.581709623337, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5317c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16878.581709623337, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 83.5625, "ram_util_percent": 83.28}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2178039524487403, "cur_kl_coeff": 9.24446373305873e-34, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3456207569235216, "policy_loss": -0.0022791954003786915, "vf_loss": 0.34789995234619786, "vf_explained_var": 0.10057269028885654, "kl": 0.003059713245661905, "entropy": 0.08134165816797466, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 352485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3844331474767793, "cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5843203470519887, "policy_loss": -0.0020704926336529077, "vf_loss": 0.5863908398088324, "vf_explained_var": 0.3192691813385676, "kl": 0.004884464128423081, "entropy": 0.9274514361979469, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 352485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 2992000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 37.0, "episode_reward_mean": 365.33, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 0.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 29.0}, "policy_reward_mean": {"prey_policy": 178.39, "predator_policy": 4.275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [376.0, 385.0, 368.0, 374.0, 393.0, 352.0, 368.0, 385.0, 398.0, 305.0, 396.0, 358.0, 363.0, 378.0, 378.0, 381.0, 389.0, 360.0, 302.0, 368.0, 373.0, 364.0, 354.0, 365.0, 372.0, 370.0, 386.0, 390.0, 363.0, 344.0, 317.0, 380.0, 376.0, 400.0, 388.0, 392.0, 370.0, 361.0, 368.0, 358.0, 365.0, 364.0, 380.0, 358.0, 257.0, 399.0, 373.0, 399.0, 361.0, 379.0, 374.0, 399.0, 375.0, 376.0, 384.0, 357.0, 365.0, 384.0, 392.0, 37.0, 346.0, 361.0, 353.0, 390.0, 365.0, 194.0, 378.0, 370.0, 376.0, 385.0, 365.0, 386.0, 389.0, 371.0, 372.0, 385.0, 351.0, 360.0, 396.0, 339.0, 374.0, 366.0, 380.0, 362.0, 370.0, 359.0, 384.0, 342.0, 391.0, 369.0, 385.0, 400.0, 356.0, 378.0, 381.0, 379.0, 388.0, 383.0, 363.0, 345.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [188.0, 188.0, 200.0, 181.0, 128.0, 200.0, 192.0, 182.0, 200.0, 193.0, 135.0, 200.0, 161.0, 191.0, 191.0, 194.0, 200.0, 198.0, 136.0, 142.0, 198.0, 197.0, 170.0, 178.0, 177.0, 179.0, 176.0, 194.0, 170.0, 199.0, 197.0, 184.0, 189.0, 200.0, 143.0, 200.0, 156.0, 112.0, 177.0, 184.0, 169.0, 194.0, 181.0, 177.0, 160.0, 182.0, 152.0, 196.0, 178.0, 192.0, 195.0, 167.0, 196.0, 185.0, 198.0, 188.0, 170.0, 167.0, 140.0, 181.0, 146.0, 142.0, 187.0, 189.0, 181.0, 195.0, 200.0, 200.0, 193.0, 195.0, 198.0, 194.0, 165.0, 196.0, 171.0, 174.0, 182.0, 175.0, 176.0, 164.0, 198.0, 152.0, 200.0, 146.0, 170.0, 200.0, 187.0, 158.0, 195.0, 62.0, 199.0, 200.0, 150.0, 199.0, 200.0, 199.0, 166.0, 183.0, 192.0, 187.0, 163.0, 200.0, 199.0, 200.0, 191.0, 181.0, 195.0, 174.0, 192.0, 188.0, 146.0, 193.0, 199.0, 163.0, 184.0, 200.0, 197.0, 195.0, 19.0, 18.0, 196.0, 143.0, 162.0, 183.0, 164.0, 171.0, 200.0, 185.0, 174.0, 185.0, 191.0, 0.0, 170.0, 193.0, 164.0, 191.0, 180.0, 191.0, 185.0, 195.0, 152.0, 197.0, 191.0, 192.0, 195.0, 194.0, 200.0, 166.0, 176.0, 193.0, 189.0, 196.0, 180.0, 160.0, 170.0, 180.0, 196.0, 200.0, 144.0, 195.0, 185.0, 184.0, 180.0, 179.0, 197.0, 183.0, 173.0, 177.0, 200.0, 155.0, 157.0, 192.0, 200.0, 176.0, 178.0, 148.0, 194.0, 197.0, 182.0, 172.0, 195.0, 185.0, 200.0, 200.0, 161.0, 173.0, 158.0, 200.0, 181.0, 189.0, 187.0, 192.0, 194.0, 191.0, 195.0, 188.0, 170.0, 182.0, 191.0, 137.0], "policy_predator_policy_reward": [0.0, 0.0, 4.0, 0.0, 17.0, 23.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 3.0, 13.0, 0.0, 0.0, 0.0, 0.0, 8.0, 19.0, 0.0, 1.0, 10.0, 0.0, 0.0, 7.0, 8.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 13.0, 21.0, 1.0, 6.0, 0.0, 10.0, 6.0, 0.0, 12.0, 0.0, 8.0, 9.0, 2.0, 0.0, 0.0, 8.0, 0.0, 5.0, 4.0, 0.0, 12.0, 14.0, 0.0, 23.0, 0.0, 29.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 8.0, 7.0, 9.0, 0.0, 11.0, 7.0, 11.0, 15.0, 0.0, 0.0, 18.0, 10.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 12.0, 12.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 4.0, 0.0, 18.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 4.0, 12.0, 0.0, 18.0, 5.0, 0.0, 0.0, 6.0, 3.0, 0.0, 10.0, 5.0, 12.0, 3.0, 5.0, 0.0, 5.0, 0.0, 0.0, 16.0, 3.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 7.0, 0.0, 0.0, 6.0, 6.0, 15.0, 0.0, 0.0, 10.0, 0.0, 8.0, 0.0, 16.0, 0.0, 0.0, 6.0, 9.0, 5.0, 0.0, 0.0, 0.0, 13.0, 9.0, 6.0, 14.0, 6.0, 5.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 7.0, 4.0, 17.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.576149321946282, "mean_inference_ms": 13.420444667476243, "mean_action_processing_ms": 0.752986065565075, "mean_env_wait_ms": 2.1320903014656505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11138522624969482, "StateBufferConnector_ms": 0.04027760028839111, "ViewRequirementAgentConnector_ms": 0.5313842296600342}, "num_episodes": 27, "episode_return_max": 400.0, "episode_return_min": 37.0, "episode_return_mean": 365.33, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 2992000, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 191.334583448922, "num_env_steps_trained_throughput_per_sec": 191.334583448922, "timesteps_total": 748000, "num_env_steps_sampled_lifetime": 748000, "num_agent_steps_sampled_lifetime": 2992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2992000, "timers": {"training_iteration_time_ms": 26254.937, "restore_workers_time_ms": 0.02, "training_step_time_ms": 26254.872, "sample_time_ms": 4998.908, "learn_time_ms": 21221.012, "learn_throughput": 188.492, "synch_weights_time_ms": 30.349}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 2992000}, "done": false, "training_iteration": 187, "trial_id": "45bed_00000", "date": "2024-08-13_05-52-02", "timestamp": 1723542722, "time_this_iter_s": 20.916244983673096, "time_total_s": 16899.49795460701, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5317e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16899.49795460701, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 73.15517241379311, "ram_util_percent": 76.00689655172413}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.644901699030762, "cur_kl_coeff": 4.622231866529365e-34, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.24122114669157083, "policy_loss": -0.00036729111548059834, "vf_loss": 0.241588437040204, "vf_explained_var": 0.05146942305817175, "kl": 0.001222635714603476, "entropy": 0.09607826845828818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 354375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.199308813607724, "cur_kl_coeff": 1.9184653865522706e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.44260696081208095, "policy_loss": -0.00407041982592394, "vf_loss": 0.4466773817286132, "vf_explained_var": 0.3249249259630839, "kl": 0.005715897037162725, "entropy": 0.9794199414038784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 354375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 37.0, "episode_reward_mean": 364.93, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 0.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 29.0}, "policy_reward_mean": {"prey_policy": 178.185, "predator_policy": 4.28}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.0, 368.0, 373.0, 364.0, 354.0, 365.0, 372.0, 370.0, 386.0, 390.0, 363.0, 344.0, 317.0, 380.0, 376.0, 400.0, 388.0, 392.0, 370.0, 361.0, 368.0, 358.0, 365.0, 364.0, 380.0, 358.0, 257.0, 399.0, 373.0, 399.0, 361.0, 379.0, 374.0, 399.0, 375.0, 376.0, 384.0, 357.0, 365.0, 384.0, 392.0, 37.0, 346.0, 361.0, 353.0, 390.0, 365.0, 194.0, 378.0, 370.0, 376.0, 385.0, 365.0, 386.0, 389.0, 371.0, 372.0, 385.0, 351.0, 360.0, 396.0, 339.0, 374.0, 366.0, 380.0, 362.0, 370.0, 359.0, 384.0, 342.0, 391.0, 369.0, 385.0, 400.0, 356.0, 378.0, 381.0, 379.0, 388.0, 383.0, 363.0, 345.0, 378.0, 333.0, 374.0, 386.0, 374.0, 368.0, 394.0, 388.0, 364.0, 373.0, 359.0, 374.0, 355.0, 359.0, 377.0, 373.0, 362.0, 376.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [156.0, 112.0, 177.0, 184.0, 169.0, 194.0, 181.0, 177.0, 160.0, 182.0, 152.0, 196.0, 178.0, 192.0, 195.0, 167.0, 196.0, 185.0, 198.0, 188.0, 170.0, 167.0, 140.0, 181.0, 146.0, 142.0, 187.0, 189.0, 181.0, 195.0, 200.0, 200.0, 193.0, 195.0, 198.0, 194.0, 165.0, 196.0, 171.0, 174.0, 182.0, 175.0, 176.0, 164.0, 198.0, 152.0, 200.0, 146.0, 170.0, 200.0, 187.0, 158.0, 195.0, 62.0, 199.0, 200.0, 150.0, 199.0, 200.0, 199.0, 166.0, 183.0, 192.0, 187.0, 163.0, 200.0, 199.0, 200.0, 191.0, 181.0, 195.0, 174.0, 192.0, 188.0, 146.0, 193.0, 199.0, 163.0, 184.0, 200.0, 197.0, 195.0, 19.0, 18.0, 196.0, 143.0, 162.0, 183.0, 164.0, 171.0, 200.0, 185.0, 174.0, 185.0, 191.0, 0.0, 170.0, 193.0, 164.0, 191.0, 180.0, 191.0, 185.0, 195.0, 152.0, 197.0, 191.0, 192.0, 195.0, 194.0, 200.0, 166.0, 176.0, 193.0, 189.0, 196.0, 180.0, 160.0, 170.0, 180.0, 196.0, 200.0, 144.0, 195.0, 185.0, 184.0, 180.0, 179.0, 197.0, 183.0, 173.0, 177.0, 200.0, 155.0, 157.0, 192.0, 200.0, 176.0, 178.0, 148.0, 194.0, 197.0, 182.0, 172.0, 195.0, 185.0, 200.0, 200.0, 161.0, 173.0, 158.0, 200.0, 181.0, 189.0, 187.0, 192.0, 194.0, 191.0, 195.0, 188.0, 170.0, 182.0, 191.0, 137.0, 183.0, 195.0, 161.0, 158.0, 178.0, 196.0, 200.0, 181.0, 190.0, 176.0, 172.0, 188.0, 196.0, 198.0, 196.0, 192.0, 187.0, 158.0, 161.0, 199.0, 179.0, 170.0, 185.0, 184.0, 131.0, 195.0, 182.0, 166.0, 182.0, 188.0, 171.0, 200.0, 175.0, 173.0, 188.0, 176.0], "policy_predator_policy_reward": [13.0, 21.0, 1.0, 6.0, 0.0, 10.0, 6.0, 0.0, 12.0, 0.0, 8.0, 9.0, 2.0, 0.0, 0.0, 8.0, 0.0, 5.0, 4.0, 0.0, 12.0, 14.0, 0.0, 23.0, 0.0, 29.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 8.0, 7.0, 9.0, 0.0, 11.0, 7.0, 11.0, 15.0, 0.0, 0.0, 18.0, 10.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 12.0, 12.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 4.0, 0.0, 18.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 4.0, 12.0, 0.0, 18.0, 5.0, 0.0, 0.0, 6.0, 3.0, 0.0, 10.0, 5.0, 12.0, 3.0, 5.0, 0.0, 5.0, 0.0, 0.0, 16.0, 3.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 7.0, 0.0, 0.0, 6.0, 6.0, 15.0, 0.0, 0.0, 10.0, 0.0, 8.0, 0.0, 16.0, 0.0, 0.0, 6.0, 9.0, 5.0, 0.0, 0.0, 0.0, 13.0, 9.0, 6.0, 14.0, 6.0, 5.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 7.0, 4.0, 17.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 5.0, 0.0, 8.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 7.0, 13.0, 0.0, 0.0, 10.0, 0.0, 5.0, 16.0, 13.0, 0.0, 11.0, 0.0, 7.0, 0.0, 2.0, 0.0, 14.0, 4.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.568270991311054, "mean_inference_ms": 13.517024160657218, "mean_action_processing_ms": 0.7546273244664918, "mean_env_wait_ms": 1.9985710820112126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11396980285644531, "StateBufferConnector_ms": 0.023217439651489258, "ViewRequirementAgentConnector_ms": 0.48967981338500977}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 37.0, "episode_return_mean": 364.93, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 181.224171067798, "num_env_steps_trained_throughput_per_sec": 181.224171067798, "timesteps_total": 752000, "num_env_steps_sampled_lifetime": 752000, "num_agent_steps_sampled_lifetime": 3008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3008000, "timers": {"training_iteration_time_ms": 25897.042, "restore_workers_time_ms": 0.02, "training_step_time_ms": 25896.978, "sample_time_ms": 5131.368, "learn_time_ms": 20731.566, "learn_throughput": 192.942, "synch_weights_time_ms": 30.095}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000}, "done": false, "training_iteration": 188, "trial_id": "45bed_00000", "date": "2024-08-13_05-52-24", "timestamp": 1723542744, "time_this_iter_s": 22.13954997062683, "time_total_s": 16921.637504577637, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5378b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16921.637504577637, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 74.77812499999999, "ram_util_percent": 76.521875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6052229283170567, "cur_kl_coeff": 2.3111159332646825e-34, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2143684489228738, "policy_loss": -0.0007332412981817489, "vf_loss": 0.21510168978138752, "vf_explained_var": 0.08563219390848957, "kl": 0.0029274544097086263, "entropy": 0.08251302040246113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 356265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.348830541897388, "cur_kl_coeff": 1.9184653865522706e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7285222187441177, "policy_loss": -0.0035957165719034574, "vf_loss": 0.732117935565729, "vf_explained_var": 0.628719230429836, "kl": 0.008408338773269394, "entropy": 0.9282897874161049, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 356265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 3024000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 37.0, "episode_reward_mean": 366.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 0.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 18.0}, "policy_reward_mean": {"prey_policy": 179.13, "predator_policy": 4.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [370.0, 361.0, 368.0, 358.0, 365.0, 364.0, 380.0, 358.0, 257.0, 399.0, 373.0, 399.0, 361.0, 379.0, 374.0, 399.0, 375.0, 376.0, 384.0, 357.0, 365.0, 384.0, 392.0, 37.0, 346.0, 361.0, 353.0, 390.0, 365.0, 194.0, 378.0, 370.0, 376.0, 385.0, 365.0, 386.0, 389.0, 371.0, 372.0, 385.0, 351.0, 360.0, 396.0, 339.0, 374.0, 366.0, 380.0, 362.0, 370.0, 359.0, 384.0, 342.0, 391.0, 369.0, 385.0, 400.0, 356.0, 378.0, 381.0, 379.0, 388.0, 383.0, 363.0, 345.0, 378.0, 333.0, 374.0, 386.0, 374.0, 368.0, 394.0, 388.0, 364.0, 373.0, 359.0, 374.0, 355.0, 359.0, 377.0, 373.0, 362.0, 376.0, 379.0, 352.0, 388.0, 385.0, 371.0, 392.0, 370.0, 383.0, 390.0, 380.0, 331.0, 394.0, 395.0, 364.0, 368.0, 375.0, 337.0, 383.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [165.0, 196.0, 171.0, 174.0, 182.0, 175.0, 176.0, 164.0, 198.0, 152.0, 200.0, 146.0, 170.0, 200.0, 187.0, 158.0, 195.0, 62.0, 199.0, 200.0, 150.0, 199.0, 200.0, 199.0, 166.0, 183.0, 192.0, 187.0, 163.0, 200.0, 199.0, 200.0, 191.0, 181.0, 195.0, 174.0, 192.0, 188.0, 146.0, 193.0, 199.0, 163.0, 184.0, 200.0, 197.0, 195.0, 19.0, 18.0, 196.0, 143.0, 162.0, 183.0, 164.0, 171.0, 200.0, 185.0, 174.0, 185.0, 191.0, 0.0, 170.0, 193.0, 164.0, 191.0, 180.0, 191.0, 185.0, 195.0, 152.0, 197.0, 191.0, 192.0, 195.0, 194.0, 200.0, 166.0, 176.0, 193.0, 189.0, 196.0, 180.0, 160.0, 170.0, 180.0, 196.0, 200.0, 144.0, 195.0, 185.0, 184.0, 180.0, 179.0, 197.0, 183.0, 173.0, 177.0, 200.0, 155.0, 157.0, 192.0, 200.0, 176.0, 178.0, 148.0, 194.0, 197.0, 182.0, 172.0, 195.0, 185.0, 200.0, 200.0, 161.0, 173.0, 158.0, 200.0, 181.0, 189.0, 187.0, 192.0, 194.0, 191.0, 195.0, 188.0, 170.0, 182.0, 191.0, 137.0, 183.0, 195.0, 161.0, 158.0, 178.0, 196.0, 200.0, 181.0, 190.0, 176.0, 172.0, 188.0, 196.0, 198.0, 196.0, 192.0, 187.0, 158.0, 161.0, 199.0, 179.0, 170.0, 185.0, 184.0, 131.0, 195.0, 182.0, 166.0, 182.0, 188.0, 171.0, 200.0, 175.0, 173.0, 188.0, 176.0, 200.0, 150.0, 171.0, 175.0, 182.0, 200.0, 200.0, 185.0, 187.0, 177.0, 200.0, 192.0, 179.0, 184.0, 196.0, 187.0, 198.0, 188.0, 190.0, 182.0, 148.0, 152.0, 196.0, 198.0, 197.0, 198.0, 194.0, 170.0, 168.0, 193.0, 179.0, 190.0, 168.0, 157.0, 176.0, 199.0], "policy_predator_policy_reward": [1.0, 8.0, 7.0, 9.0, 0.0, 11.0, 7.0, 11.0, 15.0, 0.0, 0.0, 18.0, 10.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 12.0, 12.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 4.0, 0.0, 18.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 4.0, 12.0, 0.0, 18.0, 5.0, 0.0, 0.0, 6.0, 3.0, 0.0, 10.0, 5.0, 12.0, 3.0, 5.0, 0.0, 5.0, 0.0, 0.0, 16.0, 3.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 7.0, 0.0, 0.0, 6.0, 6.0, 15.0, 0.0, 0.0, 10.0, 0.0, 8.0, 0.0, 16.0, 0.0, 0.0, 6.0, 9.0, 5.0, 0.0, 0.0, 0.0, 13.0, 9.0, 6.0, 14.0, 6.0, 5.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 7.0, 4.0, 17.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 5.0, 0.0, 8.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 7.0, 13.0, 0.0, 0.0, 10.0, 0.0, 5.0, 16.0, 13.0, 0.0, 11.0, 0.0, 7.0, 0.0, 2.0, 0.0, 14.0, 4.0, 8.0, 13.0, 16.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, 6.0, 2.0, 16.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 6.0, 0.0, 12.0, 0.0, 8.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5597332165597315, "mean_inference_ms": 13.486961587368569, "mean_action_processing_ms": 0.7561825464110771, "mean_env_wait_ms": 1.99309430368318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10328519344329834, "StateBufferConnector_ms": 0.022626638412475586, "ViewRequirementAgentConnector_ms": 0.48986291885375977}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 37.0, "episode_return_mean": 366.26, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 3024000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 199.49091885675494, "num_env_steps_trained_throughput_per_sec": 199.49091885675494, "timesteps_total": 756000, "num_env_steps_sampled_lifetime": 756000, "num_agent_steps_sampled_lifetime": 3024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3024000, "timers": {"training_iteration_time_ms": 25202.757, "restore_workers_time_ms": 0.02, "training_step_time_ms": 25202.693, "sample_time_ms": 5142.006, "learn_time_ms": 20027.104, "learn_throughput": 199.729, "synch_weights_time_ms": 30.17}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 3024000}, "done": false, "training_iteration": 189, "trial_id": "45bed_00000", "date": "2024-08-13_05-52-45", "timestamp": 1723542765, "time_this_iter_s": 20.090943098068237, "time_total_s": 16941.728447675705, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b53434c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16941.728447675705, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 71.59285714285716, "ram_util_percent": 78.1392857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3028640839985754, "cur_kl_coeff": 1.1555579666323413e-34, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.16023825435411362, "policy_loss": -0.00037411413027377673, "vf_loss": 0.1606123684104575, "vf_explained_var": 0.0422013333550206, "kl": 0.0012139554038755015, "entropy": 0.055141075008681845, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 358155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7412037869531012, "cur_kl_coeff": 1.9184653865522706e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.41154595781524206, "policy_loss": -0.0022926631568384076, "vf_loss": 0.41383862200552823, "vf_explained_var": 0.3673256480504596, "kl": 0.005633541256600799, "entropy": 0.9271218432635857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 358155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 37.0, "episode_reward_mean": 365.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 0.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 20.0}, "policy_reward_mean": {"prey_policy": 178.805, "predator_policy": 4.095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [384.0, 357.0, 365.0, 384.0, 392.0, 37.0, 346.0, 361.0, 353.0, 390.0, 365.0, 194.0, 378.0, 370.0, 376.0, 385.0, 365.0, 386.0, 389.0, 371.0, 372.0, 385.0, 351.0, 360.0, 396.0, 339.0, 374.0, 366.0, 380.0, 362.0, 370.0, 359.0, 384.0, 342.0, 391.0, 369.0, 385.0, 400.0, 356.0, 378.0, 381.0, 379.0, 388.0, 383.0, 363.0, 345.0, 378.0, 333.0, 374.0, 386.0, 374.0, 368.0, 394.0, 388.0, 364.0, 373.0, 359.0, 374.0, 355.0, 359.0, 377.0, 373.0, 362.0, 376.0, 379.0, 352.0, 388.0, 385.0, 371.0, 392.0, 370.0, 383.0, 390.0, 380.0, 331.0, 394.0, 395.0, 364.0, 368.0, 375.0, 337.0, 383.0, 388.0, 370.0, 389.0, 355.0, 283.0, 399.0, 349.0, 329.0, 337.0, 375.0, 386.0, 354.0, 364.0, 394.0, 384.0, 356.0, 385.0, 373.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [192.0, 188.0, 146.0, 193.0, 199.0, 163.0, 184.0, 200.0, 197.0, 195.0, 19.0, 18.0, 196.0, 143.0, 162.0, 183.0, 164.0, 171.0, 200.0, 185.0, 174.0, 185.0, 191.0, 0.0, 170.0, 193.0, 164.0, 191.0, 180.0, 191.0, 185.0, 195.0, 152.0, 197.0, 191.0, 192.0, 195.0, 194.0, 200.0, 166.0, 176.0, 193.0, 189.0, 196.0, 180.0, 160.0, 170.0, 180.0, 196.0, 200.0, 144.0, 195.0, 185.0, 184.0, 180.0, 179.0, 197.0, 183.0, 173.0, 177.0, 200.0, 155.0, 157.0, 192.0, 200.0, 176.0, 178.0, 148.0, 194.0, 197.0, 182.0, 172.0, 195.0, 185.0, 200.0, 200.0, 161.0, 173.0, 158.0, 200.0, 181.0, 189.0, 187.0, 192.0, 194.0, 191.0, 195.0, 188.0, 170.0, 182.0, 191.0, 137.0, 183.0, 195.0, 161.0, 158.0, 178.0, 196.0, 200.0, 181.0, 190.0, 176.0, 172.0, 188.0, 196.0, 198.0, 196.0, 192.0, 187.0, 158.0, 161.0, 199.0, 179.0, 170.0, 185.0, 184.0, 131.0, 195.0, 182.0, 166.0, 182.0, 188.0, 171.0, 200.0, 175.0, 173.0, 188.0, 176.0, 200.0, 150.0, 171.0, 175.0, 182.0, 200.0, 200.0, 185.0, 187.0, 177.0, 200.0, 192.0, 179.0, 184.0, 196.0, 187.0, 198.0, 188.0, 190.0, 182.0, 148.0, 152.0, 196.0, 198.0, 197.0, 198.0, 194.0, 170.0, 168.0, 193.0, 179.0, 190.0, 168.0, 157.0, 176.0, 199.0, 188.0, 200.0, 185.0, 185.0, 195.0, 194.0, 169.0, 176.0, 173.0, 99.0, 200.0, 199.0, 176.0, 151.0, 150.0, 152.0, 154.0, 175.0, 194.0, 155.0, 199.0, 182.0, 183.0, 154.0, 154.0, 182.0, 197.0, 196.0, 193.0, 183.0, 176.0, 172.0, 193.0, 188.0, 174.0, 188.0], "policy_predator_policy_reward": [0.0, 4.0, 0.0, 18.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 4.0, 12.0, 0.0, 18.0, 5.0, 0.0, 0.0, 6.0, 3.0, 0.0, 10.0, 5.0, 12.0, 3.0, 5.0, 0.0, 5.0, 0.0, 0.0, 16.0, 3.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 7.0, 0.0, 0.0, 6.0, 6.0, 15.0, 0.0, 0.0, 10.0, 0.0, 8.0, 0.0, 16.0, 0.0, 0.0, 6.0, 9.0, 5.0, 0.0, 0.0, 0.0, 13.0, 9.0, 6.0, 14.0, 6.0, 5.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 7.0, 4.0, 17.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 5.0, 0.0, 8.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 7.0, 13.0, 0.0, 0.0, 10.0, 0.0, 5.0, 16.0, 13.0, 0.0, 11.0, 0.0, 7.0, 0.0, 2.0, 0.0, 14.0, 4.0, 8.0, 13.0, 16.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, 6.0, 2.0, 16.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 6.0, 0.0, 12.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 11.0, 0.0, 0.0, 10.0, 12.0, 7.0, 20.0, 1.0, 7.0, 13.0, 13.0, 0.0, 5.0, 12.0, 5.0, 14.0, 14.0, 0.0, 1.0, 4.0, 4.0, 8.0, 0.0, 0.0, 4.0, 4.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.549966508132907, "mean_inference_ms": 13.45526407053401, "mean_action_processing_ms": 0.7574200025756318, "mean_env_wait_ms": 1.987400482105782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018883466720581055, "StateBufferConnector_ms": 0.01983773708343506, "ViewRequirementAgentConnector_ms": 0.463458776473999}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 37.0, "episode_return_mean": 365.8, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 121.4495264995336, "num_env_steps_trained_throughput_per_sec": 121.4495264995336, "timesteps_total": 760000, "num_env_steps_sampled_lifetime": 760000, "num_agent_steps_sampled_lifetime": 3040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3040000, "timers": {"training_iteration_time_ms": 25936.952, "restore_workers_time_ms": 0.02, "training_step_time_ms": 25936.847, "sample_time_ms": 5245.364, "learn_time_ms": 20652.874, "learn_throughput": 193.678, "synch_weights_time_ms": 32.969}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "done": false, "training_iteration": 190, "trial_id": "45bed_00000", "date": "2024-08-13_05-53-18", "timestamp": 1723542798, "time_this_iter_s": 33.19758129119873, "time_total_s": 16974.926028966904, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b539c820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16974.926028966904, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 90.94347826086955, "ram_util_percent": 81.6391304347826}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7779314338963814, "cur_kl_coeff": 5.777789833161706e-35, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.20028221680925637, "policy_loss": -0.0007939961369311998, "vf_loss": 0.2010762130209028, "vf_explained_var": -0.007716200055268707, "kl": 0.0022914991630973874, "entropy": 0.0786484602513531, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 360045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.047415340585368, "cur_kl_coeff": 1.9184653865522706e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7005093999926454, "policy_loss": -0.005220223505360385, "vf_loss": 0.7057296243294207, "vf_explained_var": 0.3732691557003707, "kl": 0.009510679591025278, "entropy": 0.906463711665421, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 360045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 3056000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 283.0, "episode_reward_mean": 371.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 99.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 20.0}, "policy_reward_mean": {"prey_policy": 182.07, "predator_policy": 3.865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.0, 396.0, 339.0, 374.0, 366.0, 380.0, 362.0, 370.0, 359.0, 384.0, 342.0, 391.0, 369.0, 385.0, 400.0, 356.0, 378.0, 381.0, 379.0, 388.0, 383.0, 363.0, 345.0, 378.0, 333.0, 374.0, 386.0, 374.0, 368.0, 394.0, 388.0, 364.0, 373.0, 359.0, 374.0, 355.0, 359.0, 377.0, 373.0, 362.0, 376.0, 379.0, 352.0, 388.0, 385.0, 371.0, 392.0, 370.0, 383.0, 390.0, 380.0, 331.0, 394.0, 395.0, 364.0, 368.0, 375.0, 337.0, 383.0, 388.0, 370.0, 389.0, 355.0, 283.0, 399.0, 349.0, 329.0, 337.0, 375.0, 386.0, 354.0, 364.0, 394.0, 384.0, 356.0, 385.0, 373.0, 371.0, 381.0, 372.0, 387.0, 388.0, 333.0, 371.0, 368.0, 388.0, 392.0, 350.0, 388.0, 375.0, 390.0, 391.0, 369.0, 399.0, 379.0, 374.0, 389.0, 382.0, 366.0, 360.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [170.0, 180.0, 196.0, 200.0, 144.0, 195.0, 185.0, 184.0, 180.0, 179.0, 197.0, 183.0, 173.0, 177.0, 200.0, 155.0, 157.0, 192.0, 200.0, 176.0, 178.0, 148.0, 194.0, 197.0, 182.0, 172.0, 195.0, 185.0, 200.0, 200.0, 161.0, 173.0, 158.0, 200.0, 181.0, 189.0, 187.0, 192.0, 194.0, 191.0, 195.0, 188.0, 170.0, 182.0, 191.0, 137.0, 183.0, 195.0, 161.0, 158.0, 178.0, 196.0, 200.0, 181.0, 190.0, 176.0, 172.0, 188.0, 196.0, 198.0, 196.0, 192.0, 187.0, 158.0, 161.0, 199.0, 179.0, 170.0, 185.0, 184.0, 131.0, 195.0, 182.0, 166.0, 182.0, 188.0, 171.0, 200.0, 175.0, 173.0, 188.0, 176.0, 200.0, 150.0, 171.0, 175.0, 182.0, 200.0, 200.0, 185.0, 187.0, 177.0, 200.0, 192.0, 179.0, 184.0, 196.0, 187.0, 198.0, 188.0, 190.0, 182.0, 148.0, 152.0, 196.0, 198.0, 197.0, 198.0, 194.0, 170.0, 168.0, 193.0, 179.0, 190.0, 168.0, 157.0, 176.0, 199.0, 188.0, 200.0, 185.0, 185.0, 195.0, 194.0, 169.0, 176.0, 173.0, 99.0, 200.0, 199.0, 176.0, 151.0, 150.0, 152.0, 154.0, 175.0, 194.0, 155.0, 199.0, 182.0, 183.0, 154.0, 154.0, 182.0, 197.0, 196.0, 193.0, 183.0, 176.0, 172.0, 193.0, 188.0, 174.0, 188.0, 193.0, 176.0, 196.0, 185.0, 199.0, 173.0, 200.0, 187.0, 193.0, 195.0, 200.0, 114.0, 185.0, 186.0, 192.0, 167.0, 188.0, 200.0, 198.0, 191.0, 164.0, 162.0, 182.0, 200.0, 195.0, 180.0, 200.0, 189.0, 191.0, 200.0, 179.0, 183.0, 199.0, 200.0, 185.0, 189.0, 185.0, 177.0, 195.0, 194.0, 196.0, 178.0, 152.0, 198.0, 171.0, 189.0], "policy_predator_policy_reward": [10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 7.0, 0.0, 0.0, 6.0, 6.0, 15.0, 0.0, 0.0, 10.0, 0.0, 8.0, 0.0, 16.0, 0.0, 0.0, 6.0, 9.0, 5.0, 0.0, 0.0, 0.0, 13.0, 9.0, 6.0, 14.0, 6.0, 5.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 7.0, 4.0, 17.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 5.0, 0.0, 8.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 7.0, 13.0, 0.0, 0.0, 10.0, 0.0, 5.0, 16.0, 13.0, 0.0, 11.0, 0.0, 7.0, 0.0, 2.0, 0.0, 14.0, 4.0, 8.0, 13.0, 16.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, 6.0, 2.0, 16.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 6.0, 0.0, 12.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 11.0, 0.0, 0.0, 10.0, 12.0, 7.0, 20.0, 1.0, 7.0, 13.0, 13.0, 0.0, 5.0, 12.0, 5.0, 14.0, 14.0, 0.0, 1.0, 4.0, 4.0, 8.0, 0.0, 0.0, 4.0, 4.0, 7.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 3.0, 0.0, 12.0, 12.0, 0.0, 6.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 5.0, 5.0, 7.0, 0.0, 0.0, 7.0, 1.0, 16.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.784774370725095, "mean_inference_ms": 13.167019102285275, "mean_action_processing_ms": 0.7604583849722139, "mean_env_wait_ms": 1.982693142801442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019292116165161133, "StateBufferConnector_ms": 0.019627094268798828, "ViewRequirementAgentConnector_ms": 0.45309925079345703}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 283.0, "episode_return_mean": 371.87, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 3056000, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 183.47347907890128, "num_env_steps_trained_throughput_per_sec": 183.47347907890128, "timesteps_total": 764000, "num_env_steps_sampled_lifetime": 764000, "num_agent_steps_sampled_lifetime": 3056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3056000, "timers": {"training_iteration_time_ms": 25420.324, "restore_workers_time_ms": 0.02, "training_step_time_ms": 25420.219, "sample_time_ms": 5414.486, "learn_time_ms": 19967.171, "learn_throughput": 200.329, "synch_weights_time_ms": 32.896}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 3056000}, "done": false, "training_iteration": 191, "trial_id": "45bed_00000", "date": "2024-08-13_05-53-40", "timestamp": 1723542820, "time_this_iter_s": 21.864181995391846, "time_total_s": 16996.790210962296, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b539caf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16996.790210962296, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 75.31612903225808, "ram_util_percent": 83.63870967741933}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8967722154759541, "cur_kl_coeff": 2.888894916580853e-35, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4250597984781341, "policy_loss": -0.0006146996151458808, "vf_loss": 0.42567449840125704, "vf_explained_var": 0.08438260299818856, "kl": 0.0026676909501078165, "entropy": 0.11935080603632346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 361935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3923391616927883, "cur_kl_coeff": 1.9184653865522706e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6440619260545761, "policy_loss": -0.0058571320675096655, "vf_loss": 0.6499190568687424, "vf_explained_var": 0.3846781938479691, "kl": 0.007053286162812172, "entropy": 0.8549445419084458, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 361935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000}, "env_runners": {"episode_reward_max": 399.0, "episode_reward_min": 283.0, "episode_reward_mean": 371.79, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 99.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 20.0}, "policy_reward_mean": {"prey_policy": 182.02, "predator_policy": 3.875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [345.0, 378.0, 333.0, 374.0, 386.0, 374.0, 368.0, 394.0, 388.0, 364.0, 373.0, 359.0, 374.0, 355.0, 359.0, 377.0, 373.0, 362.0, 376.0, 379.0, 352.0, 388.0, 385.0, 371.0, 392.0, 370.0, 383.0, 390.0, 380.0, 331.0, 394.0, 395.0, 364.0, 368.0, 375.0, 337.0, 383.0, 388.0, 370.0, 389.0, 355.0, 283.0, 399.0, 349.0, 329.0, 337.0, 375.0, 386.0, 354.0, 364.0, 394.0, 384.0, 356.0, 385.0, 373.0, 371.0, 381.0, 372.0, 387.0, 388.0, 333.0, 371.0, 368.0, 388.0, 392.0, 350.0, 388.0, 375.0, 390.0, 391.0, 369.0, 399.0, 379.0, 374.0, 389.0, 382.0, 366.0, 360.0, 378.0, 374.0, 353.0, 384.0, 385.0, 371.0, 391.0, 389.0, 376.0, 352.0, 390.0, 383.0, 358.0, 361.0, 365.0, 382.0, 368.0, 340.0, 382.0, 372.0, 372.0, 371.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [191.0, 137.0, 183.0, 195.0, 161.0, 158.0, 178.0, 196.0, 200.0, 181.0, 190.0, 176.0, 172.0, 188.0, 196.0, 198.0, 196.0, 192.0, 187.0, 158.0, 161.0, 199.0, 179.0, 170.0, 185.0, 184.0, 131.0, 195.0, 182.0, 166.0, 182.0, 188.0, 171.0, 200.0, 175.0, 173.0, 188.0, 176.0, 200.0, 150.0, 171.0, 175.0, 182.0, 200.0, 200.0, 185.0, 187.0, 177.0, 200.0, 192.0, 179.0, 184.0, 196.0, 187.0, 198.0, 188.0, 190.0, 182.0, 148.0, 152.0, 196.0, 198.0, 197.0, 198.0, 194.0, 170.0, 168.0, 193.0, 179.0, 190.0, 168.0, 157.0, 176.0, 199.0, 188.0, 200.0, 185.0, 185.0, 195.0, 194.0, 169.0, 176.0, 173.0, 99.0, 200.0, 199.0, 176.0, 151.0, 150.0, 152.0, 154.0, 175.0, 194.0, 155.0, 199.0, 182.0, 183.0, 154.0, 154.0, 182.0, 197.0, 196.0, 193.0, 183.0, 176.0, 172.0, 193.0, 188.0, 174.0, 188.0, 193.0, 176.0, 196.0, 185.0, 199.0, 173.0, 200.0, 187.0, 193.0, 195.0, 200.0, 114.0, 185.0, 186.0, 192.0, 167.0, 188.0, 200.0, 198.0, 191.0, 164.0, 162.0, 182.0, 200.0, 195.0, 180.0, 200.0, 189.0, 191.0, 200.0, 179.0, 183.0, 199.0, 200.0, 185.0, 189.0, 185.0, 177.0, 195.0, 194.0, 196.0, 178.0, 152.0, 198.0, 171.0, 189.0, 181.0, 197.0, 166.0, 199.0, 164.0, 181.0, 192.0, 188.0, 196.0, 184.0, 151.0, 197.0, 192.0, 199.0, 200.0, 184.0, 196.0, 174.0, 195.0, 143.0, 187.0, 199.0, 200.0, 183.0, 173.0, 169.0, 166.0, 176.0, 196.0, 155.0, 186.0, 196.0, 179.0, 182.0, 124.0, 199.0, 191.0, 187.0, 168.0, 196.0, 186.0, 180.0, 177.0, 191.0], "policy_predator_policy_reward": [17.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 5.0, 0.0, 8.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 7.0, 13.0, 0.0, 0.0, 10.0, 0.0, 5.0, 16.0, 13.0, 0.0, 11.0, 0.0, 7.0, 0.0, 2.0, 0.0, 14.0, 4.0, 8.0, 13.0, 16.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, 6.0, 2.0, 16.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 6.0, 0.0, 12.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 11.0, 0.0, 0.0, 10.0, 12.0, 7.0, 20.0, 1.0, 7.0, 13.0, 13.0, 0.0, 5.0, 12.0, 5.0, 14.0, 14.0, 0.0, 1.0, 4.0, 4.0, 8.0, 0.0, 0.0, 4.0, 4.0, 7.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 3.0, 0.0, 12.0, 12.0, 0.0, 6.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 5.0, 5.0, 7.0, 0.0, 0.0, 7.0, 1.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 4.0, 4.0, 4.0, 0.0, 0.0, 5.0, 14.0, 9.0, 0.0, 0.0, 5.0, 0.0, 6.0, 0.0, 14.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 16.0, 14.0, 5.0, 5.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 17.0, 4.0, 0.0, 0.0, 8.0, 5.0, 1.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.52392810941274, "mean_inference_ms": 13.371141387134314, "mean_action_processing_ms": 0.7592151255829636, "mean_env_wait_ms": 1.972249949640904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020003795623779297, "StateBufferConnector_ms": 0.007518887519836426, "ViewRequirementAgentConnector_ms": 0.40111494064331055}, "num_episodes": 22, "episode_return_max": 399.0, "episode_return_min": 283.0, "episode_return_mean": 371.79, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 184.9799024795687, "num_env_steps_trained_throughput_per_sec": 184.9799024795687, "timesteps_total": 768000, "num_env_steps_sampled_lifetime": 768000, "num_agent_steps_sampled_lifetime": 3072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3072000, "timers": {"training_iteration_time_ms": 24985.392, "restore_workers_time_ms": 0.02, "training_step_time_ms": 24985.287, "sample_time_ms": 5350.579, "learn_time_ms": 19596.528, "learn_throughput": 204.118, "synch_weights_time_ms": 32.741}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000}, "done": false, "training_iteration": 192, "trial_id": "45bed_00000", "date": "2024-08-13_05-54-01", "timestamp": 1723542841, "time_this_iter_s": 21.67725896835327, "time_total_s": 17018.46746993065, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b52c8dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17018.46746993065, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 76.10967741935484, "ram_util_percent": 83.19677419354836}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0126007588432422, "cur_kl_coeff": 1.4444474582904266e-35, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.21645967253538037, "policy_loss": -0.0007980618027171918, "vf_loss": 0.21725773450859365, "vf_explained_var": 0.13426529251078448, "kl": 0.0008846114207028135, "entropy": 0.045426477484956936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 363825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7210745013895488, "cur_kl_coeff": 1.9184653865522706e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7456318425931154, "policy_loss": -0.004658793245575258, "vf_loss": 0.750290633592183, "vf_explained_var": 0.2594156004764416, "kl": 0.010310713840148453, "entropy": 0.8561204524267287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 363825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 3088000}, "env_runners": {"episode_reward_max": 399.0, "episode_reward_min": 283.0, "episode_reward_mean": 371.53, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 99.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 20.0}, "policy_reward_mean": {"prey_policy": 181.72, "predator_policy": 4.045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [376.0, 379.0, 352.0, 388.0, 385.0, 371.0, 392.0, 370.0, 383.0, 390.0, 380.0, 331.0, 394.0, 395.0, 364.0, 368.0, 375.0, 337.0, 383.0, 388.0, 370.0, 389.0, 355.0, 283.0, 399.0, 349.0, 329.0, 337.0, 375.0, 386.0, 354.0, 364.0, 394.0, 384.0, 356.0, 385.0, 373.0, 371.0, 381.0, 372.0, 387.0, 388.0, 333.0, 371.0, 368.0, 388.0, 392.0, 350.0, 388.0, 375.0, 390.0, 391.0, 369.0, 399.0, 379.0, 374.0, 389.0, 382.0, 366.0, 360.0, 378.0, 374.0, 353.0, 384.0, 385.0, 371.0, 391.0, 389.0, 376.0, 352.0, 390.0, 383.0, 358.0, 361.0, 365.0, 382.0, 368.0, 340.0, 382.0, 372.0, 372.0, 371.0, 373.0, 385.0, 374.0, 388.0, 384.0, 379.0, 338.0, 360.0, 378.0, 351.0, 386.0, 358.0, 369.0, 325.0, 351.0, 367.0, 388.0, 356.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [188.0, 176.0, 200.0, 150.0, 171.0, 175.0, 182.0, 200.0, 200.0, 185.0, 187.0, 177.0, 200.0, 192.0, 179.0, 184.0, 196.0, 187.0, 198.0, 188.0, 190.0, 182.0, 148.0, 152.0, 196.0, 198.0, 197.0, 198.0, 194.0, 170.0, 168.0, 193.0, 179.0, 190.0, 168.0, 157.0, 176.0, 199.0, 188.0, 200.0, 185.0, 185.0, 195.0, 194.0, 169.0, 176.0, 173.0, 99.0, 200.0, 199.0, 176.0, 151.0, 150.0, 152.0, 154.0, 175.0, 194.0, 155.0, 199.0, 182.0, 183.0, 154.0, 154.0, 182.0, 197.0, 196.0, 193.0, 183.0, 176.0, 172.0, 193.0, 188.0, 174.0, 188.0, 193.0, 176.0, 196.0, 185.0, 199.0, 173.0, 200.0, 187.0, 193.0, 195.0, 200.0, 114.0, 185.0, 186.0, 192.0, 167.0, 188.0, 200.0, 198.0, 191.0, 164.0, 162.0, 182.0, 200.0, 195.0, 180.0, 200.0, 189.0, 191.0, 200.0, 179.0, 183.0, 199.0, 200.0, 185.0, 189.0, 185.0, 177.0, 195.0, 194.0, 196.0, 178.0, 152.0, 198.0, 171.0, 189.0, 181.0, 197.0, 166.0, 199.0, 164.0, 181.0, 192.0, 188.0, 196.0, 184.0, 151.0, 197.0, 192.0, 199.0, 200.0, 184.0, 196.0, 174.0, 195.0, 143.0, 187.0, 199.0, 200.0, 183.0, 173.0, 169.0, 166.0, 176.0, 196.0, 155.0, 186.0, 196.0, 179.0, 182.0, 124.0, 199.0, 191.0, 187.0, 168.0, 196.0, 186.0, 180.0, 177.0, 191.0, 167.0, 198.0, 195.0, 185.0, 187.0, 171.0, 192.0, 194.0, 195.0, 189.0, 199.0, 170.0, 172.0, 147.0, 167.0, 182.0, 184.0, 191.0, 170.0, 170.0, 185.0, 196.0, 163.0, 182.0, 169.0, 192.0, 190.0, 116.0, 191.0, 125.0, 188.0, 164.0, 190.0, 198.0, 167.0, 173.0], "policy_predator_policy_reward": [4.0, 8.0, 13.0, 16.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, 6.0, 2.0, 16.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 6.0, 0.0, 12.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 11.0, 0.0, 0.0, 10.0, 12.0, 7.0, 20.0, 1.0, 7.0, 13.0, 13.0, 0.0, 5.0, 12.0, 5.0, 14.0, 14.0, 0.0, 1.0, 4.0, 4.0, 8.0, 0.0, 0.0, 4.0, 4.0, 7.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 3.0, 0.0, 12.0, 12.0, 0.0, 6.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 5.0, 5.0, 7.0, 0.0, 0.0, 7.0, 1.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 4.0, 4.0, 4.0, 0.0, 0.0, 5.0, 14.0, 9.0, 0.0, 0.0, 5.0, 0.0, 6.0, 0.0, 14.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 16.0, 14.0, 5.0, 5.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 17.0, 4.0, 0.0, 0.0, 8.0, 5.0, 1.0, 3.0, 0.0, 8.0, 0.0, 0.0, 5.0, 5.0, 11.0, 2.0, 0.0, 0.0, 0.0, 0.0, 10.0, 9.0, 10.0, 0.0, 11.0, 0.0, 3.0, 11.0, 0.0, 0.0, 5.0, 0.0, 13.0, 0.0, 8.0, 15.0, 4.0, 18.0, 17.0, 6.0, 9.0, 0.0, 0.0, 0.0, 16.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5121204226314475, "mean_inference_ms": 13.334788780755403, "mean_action_processing_ms": 0.7594718803874619, "mean_env_wait_ms": 1.9660190045173571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014960646629333496, "StateBufferConnector_ms": 0.007479548454284668, "ViewRequirementAgentConnector_ms": 0.3195948600769043}, "num_episodes": 18, "episode_return_max": 399.0, "episode_return_min": 283.0, "episode_return_mean": 371.53, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 3088000, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 189.16486360833065, "num_env_steps_trained_throughput_per_sec": 189.16486360833065, "timesteps_total": 772000, "num_env_steps_sampled_lifetime": 772000, "num_agent_steps_sampled_lifetime": 3088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3088000, "timers": {"training_iteration_time_ms": 24402.334, "restore_workers_time_ms": 0.019, "training_step_time_ms": 24402.231, "sample_time_ms": 5163.432, "learn_time_ms": 19201.24, "learn_throughput": 208.32, "synch_weights_time_ms": 32.491}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 3088000}, "done": false, "training_iteration": 193, "trial_id": "45bed_00000", "date": "2024-08-13_05-54-23", "timestamp": 1723542863, "time_this_iter_s": 21.192983150482178, "time_total_s": 17039.66045308113, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5378700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17039.66045308113, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 75.26666666666667, "ram_util_percent": 83.34}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4276185026441617, "cur_kl_coeff": 7.222237291452133e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.20401275034540545, "policy_loss": -0.0023610530943466873, "vf_loss": 0.2063738032538495, "vf_explained_var": 0.01700904959093326, "kl": 0.005209774160550159, "entropy": 0.053337615043437356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 365715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.292092130368664, "cur_kl_coeff": 1.9184653865522706e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.35752588743935265, "policy_loss": -0.0011257438921670197, "vf_loss": 0.35865163137180306, "vf_explained_var": 0.37237414872204816, "kl": 0.008164656779215157, "entropy": 0.8307702100466168, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 365715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 283.0, "episode_reward_mean": 371.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 99.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 20.0}, "policy_reward_mean": {"prey_policy": 181.905, "predator_policy": 3.825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [383.0, 388.0, 370.0, 389.0, 355.0, 283.0, 399.0, 349.0, 329.0, 337.0, 375.0, 386.0, 354.0, 364.0, 394.0, 384.0, 356.0, 385.0, 373.0, 371.0, 381.0, 372.0, 387.0, 388.0, 333.0, 371.0, 368.0, 388.0, 392.0, 350.0, 388.0, 375.0, 390.0, 391.0, 369.0, 399.0, 379.0, 374.0, 389.0, 382.0, 366.0, 360.0, 378.0, 374.0, 353.0, 384.0, 385.0, 371.0, 391.0, 389.0, 376.0, 352.0, 390.0, 383.0, 358.0, 361.0, 365.0, 382.0, 368.0, 340.0, 382.0, 372.0, 372.0, 371.0, 373.0, 385.0, 374.0, 388.0, 384.0, 379.0, 338.0, 360.0, 378.0, 351.0, 386.0, 358.0, 369.0, 325.0, 351.0, 367.0, 388.0, 356.0, 390.0, 386.0, 336.0, 400.0, 360.0, 348.0, 379.0, 377.0, 355.0, 397.0, 379.0, 382.0, 392.0, 371.0, 345.0, 363.0, 381.0, 382.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [176.0, 199.0, 188.0, 200.0, 185.0, 185.0, 195.0, 194.0, 169.0, 176.0, 173.0, 99.0, 200.0, 199.0, 176.0, 151.0, 150.0, 152.0, 154.0, 175.0, 194.0, 155.0, 199.0, 182.0, 183.0, 154.0, 154.0, 182.0, 197.0, 196.0, 193.0, 183.0, 176.0, 172.0, 193.0, 188.0, 174.0, 188.0, 193.0, 176.0, 196.0, 185.0, 199.0, 173.0, 200.0, 187.0, 193.0, 195.0, 200.0, 114.0, 185.0, 186.0, 192.0, 167.0, 188.0, 200.0, 198.0, 191.0, 164.0, 162.0, 182.0, 200.0, 195.0, 180.0, 200.0, 189.0, 191.0, 200.0, 179.0, 183.0, 199.0, 200.0, 185.0, 189.0, 185.0, 177.0, 195.0, 194.0, 196.0, 178.0, 152.0, 198.0, 171.0, 189.0, 181.0, 197.0, 166.0, 199.0, 164.0, 181.0, 192.0, 188.0, 196.0, 184.0, 151.0, 197.0, 192.0, 199.0, 200.0, 184.0, 196.0, 174.0, 195.0, 143.0, 187.0, 199.0, 200.0, 183.0, 173.0, 169.0, 166.0, 176.0, 196.0, 155.0, 186.0, 196.0, 179.0, 182.0, 124.0, 199.0, 191.0, 187.0, 168.0, 196.0, 186.0, 180.0, 177.0, 191.0, 167.0, 198.0, 195.0, 185.0, 187.0, 171.0, 192.0, 194.0, 195.0, 189.0, 199.0, 170.0, 172.0, 147.0, 167.0, 182.0, 184.0, 191.0, 170.0, 170.0, 185.0, 196.0, 163.0, 182.0, 169.0, 192.0, 190.0, 116.0, 191.0, 125.0, 188.0, 164.0, 190.0, 198.0, 167.0, 173.0, 180.0, 200.0, 193.0, 193.0, 151.0, 185.0, 200.0, 200.0, 179.0, 175.0, 185.0, 152.0, 187.0, 190.0, 169.0, 199.0, 169.0, 172.0, 200.0, 197.0, 190.0, 189.0, 196.0, 179.0, 190.0, 199.0, 182.0, 183.0, 169.0, 164.0, 167.0, 185.0, 190.0, 191.0, 192.0, 190.0], "policy_predator_policy_reward": [8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 11.0, 0.0, 0.0, 10.0, 12.0, 7.0, 20.0, 1.0, 7.0, 13.0, 13.0, 0.0, 5.0, 12.0, 5.0, 14.0, 14.0, 0.0, 1.0, 4.0, 4.0, 8.0, 0.0, 0.0, 4.0, 4.0, 7.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 3.0, 0.0, 12.0, 12.0, 0.0, 6.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 5.0, 5.0, 7.0, 0.0, 0.0, 7.0, 1.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 4.0, 4.0, 4.0, 0.0, 0.0, 5.0, 14.0, 9.0, 0.0, 0.0, 5.0, 0.0, 6.0, 0.0, 14.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 16.0, 14.0, 5.0, 5.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 17.0, 4.0, 0.0, 0.0, 8.0, 5.0, 1.0, 3.0, 0.0, 8.0, 0.0, 0.0, 5.0, 5.0, 11.0, 2.0, 0.0, 0.0, 0.0, 0.0, 10.0, 9.0, 10.0, 0.0, 11.0, 0.0, 3.0, 11.0, 0.0, 0.0, 5.0, 0.0, 13.0, 0.0, 8.0, 15.0, 4.0, 18.0, 17.0, 6.0, 9.0, 0.0, 0.0, 0.0, 16.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 11.0, 0.0, 0.0, 2.0, 2.0, 7.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 3.0, 0.0, 6.0, 0.0, 0.0, 12.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.499968821211018, "mean_inference_ms": 13.297583128240817, "mean_action_processing_ms": 0.7595257325987103, "mean_env_wait_ms": 1.9597458716798664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01582181453704834, "StateBufferConnector_ms": 0.007538318634033203, "ViewRequirementAgentConnector_ms": 0.3127225637435913}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 283.0, "episode_return_mean": 371.46, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 186.18278099671457, "num_env_steps_trained_throughput_per_sec": 186.18278099671457, "timesteps_total": 776000, "num_env_steps_sampled_lifetime": 776000, "num_agent_steps_sampled_lifetime": 3104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3104000, "timers": {"training_iteration_time_ms": 23796.972, "restore_workers_time_ms": 0.019, "training_step_time_ms": 23796.869, "sample_time_ms": 4965.168, "learn_time_ms": 18795.375, "learn_throughput": 212.818, "synch_weights_time_ms": 31.855}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000}, "done": false, "training_iteration": 194, "trial_id": "45bed_00000", "date": "2024-08-13_05-54-44", "timestamp": 1723542884, "time_this_iter_s": 21.52724289894104, "time_total_s": 17061.187695980072, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b53170d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17061.187695980072, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 74.77333333333333, "ram_util_percent": 83.35333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6242324540480262, "cur_kl_coeff": 7.222237291452133e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3020138792969562, "policy_loss": -0.0011647742253940098, "vf_loss": 0.30317865317482895, "vf_explained_var": 0.04515997521461002, "kl": 0.00668934333665252, "entropy": 0.07496482038466389, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 367605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8131923447998743, "cur_kl_coeff": 1.9184653865522706e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3544266151008073, "policy_loss": -0.00015163804027473643, "vf_loss": 0.35457825358740236, "vf_explained_var": 0.29023112642071236, "kl": 0.004215614980488735, "entropy": 0.8693875056725962, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 367605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 325.0, "episode_reward_mean": 372.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 114.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 19.0}, "policy_reward_mean": {"prey_policy": 182.1, "predator_policy": 4.01}, "custom_metrics": {}, "hist_stats": {"episode_reward": [373.0, 371.0, 381.0, 372.0, 387.0, 388.0, 333.0, 371.0, 368.0, 388.0, 392.0, 350.0, 388.0, 375.0, 390.0, 391.0, 369.0, 399.0, 379.0, 374.0, 389.0, 382.0, 366.0, 360.0, 378.0, 374.0, 353.0, 384.0, 385.0, 371.0, 391.0, 389.0, 376.0, 352.0, 390.0, 383.0, 358.0, 361.0, 365.0, 382.0, 368.0, 340.0, 382.0, 372.0, 372.0, 371.0, 373.0, 385.0, 374.0, 388.0, 384.0, 379.0, 338.0, 360.0, 378.0, 351.0, 386.0, 358.0, 369.0, 325.0, 351.0, 367.0, 388.0, 356.0, 390.0, 386.0, 336.0, 400.0, 360.0, 348.0, 379.0, 377.0, 355.0, 397.0, 379.0, 382.0, 392.0, 371.0, 345.0, 363.0, 381.0, 382.0, 372.0, 377.0, 368.0, 368.0, 364.0, 330.0, 349.0, 387.0, 389.0, 383.0, 381.0, 373.0, 355.0, 369.0, 376.0, 365.0, 351.0, 399.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [174.0, 188.0, 193.0, 176.0, 196.0, 185.0, 199.0, 173.0, 200.0, 187.0, 193.0, 195.0, 200.0, 114.0, 185.0, 186.0, 192.0, 167.0, 188.0, 200.0, 198.0, 191.0, 164.0, 162.0, 182.0, 200.0, 195.0, 180.0, 200.0, 189.0, 191.0, 200.0, 179.0, 183.0, 199.0, 200.0, 185.0, 189.0, 185.0, 177.0, 195.0, 194.0, 196.0, 178.0, 152.0, 198.0, 171.0, 189.0, 181.0, 197.0, 166.0, 199.0, 164.0, 181.0, 192.0, 188.0, 196.0, 184.0, 151.0, 197.0, 192.0, 199.0, 200.0, 184.0, 196.0, 174.0, 195.0, 143.0, 187.0, 199.0, 200.0, 183.0, 173.0, 169.0, 166.0, 176.0, 196.0, 155.0, 186.0, 196.0, 179.0, 182.0, 124.0, 199.0, 191.0, 187.0, 168.0, 196.0, 186.0, 180.0, 177.0, 191.0, 167.0, 198.0, 195.0, 185.0, 187.0, 171.0, 192.0, 194.0, 195.0, 189.0, 199.0, 170.0, 172.0, 147.0, 167.0, 182.0, 184.0, 191.0, 170.0, 170.0, 185.0, 196.0, 163.0, 182.0, 169.0, 192.0, 190.0, 116.0, 191.0, 125.0, 188.0, 164.0, 190.0, 198.0, 167.0, 173.0, 180.0, 200.0, 193.0, 193.0, 151.0, 185.0, 200.0, 200.0, 179.0, 175.0, 185.0, 152.0, 187.0, 190.0, 169.0, 199.0, 169.0, 172.0, 200.0, 197.0, 190.0, 189.0, 196.0, 179.0, 190.0, 199.0, 182.0, 183.0, 169.0, 164.0, 167.0, 185.0, 190.0, 191.0, 192.0, 190.0, 180.0, 188.0, 162.0, 200.0, 194.0, 161.0, 179.0, 164.0, 154.0, 195.0, 155.0, 144.0, 168.0, 174.0, 171.0, 200.0, 200.0, 189.0, 195.0, 188.0, 172.0, 200.0, 156.0, 200.0, 155.0, 179.0, 172.0, 183.0, 189.0, 181.0, 163.0, 190.0, 181.0, 155.0, 199.0, 200.0], "policy_predator_policy_reward": [4.0, 7.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 3.0, 0.0, 12.0, 12.0, 0.0, 6.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 5.0, 5.0, 7.0, 0.0, 0.0, 7.0, 1.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 4.0, 4.0, 4.0, 0.0, 0.0, 5.0, 14.0, 9.0, 0.0, 0.0, 5.0, 0.0, 6.0, 0.0, 14.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 16.0, 14.0, 5.0, 5.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 17.0, 4.0, 0.0, 0.0, 8.0, 5.0, 1.0, 3.0, 0.0, 8.0, 0.0, 0.0, 5.0, 5.0, 11.0, 2.0, 0.0, 0.0, 0.0, 0.0, 10.0, 9.0, 10.0, 0.0, 11.0, 0.0, 3.0, 11.0, 0.0, 0.0, 5.0, 0.0, 13.0, 0.0, 8.0, 15.0, 4.0, 18.0, 17.0, 6.0, 9.0, 0.0, 0.0, 0.0, 16.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 11.0, 0.0, 0.0, 2.0, 2.0, 7.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 3.0, 0.0, 6.0, 0.0, 0.0, 12.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 5.0, 10.0, 0.0, 13.0, 12.0, 13.0, 0.0, 15.0, 17.0, 14.0, 7.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 11.0, 6.0, 16.0, 5.0, 5.0, 9.0, 0.0, 6.0, 0.0, 12.0, 0.0, 15.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.487121390916868, "mean_inference_ms": 13.258609018815159, "mean_action_processing_ms": 0.7592239391875714, "mean_env_wait_ms": 1.9532934610241468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010519981384277344, "StateBufferConnector_ms": 0.007525801658630371, "ViewRequirementAgentConnector_ms": 0.2985222339630127}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 325.0, "episode_return_mean": 372.22, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 186.8327388660948, "num_env_steps_trained_throughput_per_sec": 186.8327388660948, "timesteps_total": 780000, "num_env_steps_sampled_lifetime": 780000, "num_agent_steps_sampled_lifetime": 3120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3120000, "timers": {"training_iteration_time_ms": 23174.678, "restore_workers_time_ms": 0.019, "training_step_time_ms": 23174.577, "sample_time_ms": 4569.406, "learn_time_ms": 18577.326, "learn_throughput": 215.316, "synch_weights_time_ms": 23.814}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "done": false, "training_iteration": 195, "trial_id": "45bed_00000", "date": "2024-08-13_05-55-06", "timestamp": 1723542906, "time_this_iter_s": 21.465279817581177, "time_total_s": 17082.652975797653, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b53a1ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17082.652975797653, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 75.69333333333334, "ram_util_percent": 83.32666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.021806546986576, "cur_kl_coeff": 7.222237291452133e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2623236830272372, "policy_loss": 0.0001133693424028852, "vf_loss": 0.2622103137421796, "vf_explained_var": 0.05512078833327722, "kl": 0.002528409948777364, "entropy": 0.08709069895089934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 369495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.494862396029568, "cur_kl_coeff": 9.592326932761353e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.579467180540795, "policy_loss": -0.0034167418726990936, "vf_loss": 0.5828839232760762, "vf_explained_var": 0.35525615704122676, "kl": 0.007047981416750897, "entropy": 0.8790453591990093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 369495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 325.0, "episode_reward_mean": 371.74, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 116.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 23.0}, "policy_reward_mean": {"prey_policy": 181.51, "predator_policy": 4.36}, "custom_metrics": {}, "hist_stats": {"episode_reward": [384.0, 385.0, 371.0, 391.0, 389.0, 376.0, 352.0, 390.0, 383.0, 358.0, 361.0, 365.0, 382.0, 368.0, 340.0, 382.0, 372.0, 372.0, 371.0, 373.0, 385.0, 374.0, 388.0, 384.0, 379.0, 338.0, 360.0, 378.0, 351.0, 386.0, 358.0, 369.0, 325.0, 351.0, 367.0, 388.0, 356.0, 390.0, 386.0, 336.0, 400.0, 360.0, 348.0, 379.0, 377.0, 355.0, 397.0, 379.0, 382.0, 392.0, 371.0, 345.0, 363.0, 381.0, 382.0, 372.0, 377.0, 368.0, 368.0, 364.0, 330.0, 349.0, 387.0, 389.0, 383.0, 381.0, 373.0, 355.0, 369.0, 376.0, 365.0, 351.0, 399.0, 369.0, 381.0, 368.0, 390.0, 397.0, 373.0, 354.0, 379.0, 358.0, 374.0, 336.0, 383.0, 387.0, 341.0, 376.0, 380.0, 390.0, 372.0, 361.0, 359.0, 382.0, 398.0, 329.0, 380.0, 393.0, 389.0, 394.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [192.0, 188.0, 196.0, 184.0, 151.0, 197.0, 192.0, 199.0, 200.0, 184.0, 196.0, 174.0, 195.0, 143.0, 187.0, 199.0, 200.0, 183.0, 173.0, 169.0, 166.0, 176.0, 196.0, 155.0, 186.0, 196.0, 179.0, 182.0, 124.0, 199.0, 191.0, 187.0, 168.0, 196.0, 186.0, 180.0, 177.0, 191.0, 167.0, 198.0, 195.0, 185.0, 187.0, 171.0, 192.0, 194.0, 195.0, 189.0, 199.0, 170.0, 172.0, 147.0, 167.0, 182.0, 184.0, 191.0, 170.0, 170.0, 185.0, 196.0, 163.0, 182.0, 169.0, 192.0, 190.0, 116.0, 191.0, 125.0, 188.0, 164.0, 190.0, 198.0, 167.0, 173.0, 180.0, 200.0, 193.0, 193.0, 151.0, 185.0, 200.0, 200.0, 179.0, 175.0, 185.0, 152.0, 187.0, 190.0, 169.0, 199.0, 169.0, 172.0, 200.0, 197.0, 190.0, 189.0, 196.0, 179.0, 190.0, 199.0, 182.0, 183.0, 169.0, 164.0, 167.0, 185.0, 190.0, 191.0, 192.0, 190.0, 180.0, 188.0, 162.0, 200.0, 194.0, 161.0, 179.0, 164.0, 154.0, 195.0, 155.0, 144.0, 168.0, 174.0, 171.0, 200.0, 200.0, 189.0, 195.0, 188.0, 172.0, 200.0, 156.0, 200.0, 155.0, 179.0, 172.0, 183.0, 189.0, 181.0, 163.0, 190.0, 181.0, 155.0, 199.0, 200.0, 182.0, 181.0, 197.0, 176.0, 186.0, 172.0, 198.0, 192.0, 197.0, 200.0, 189.0, 177.0, 139.0, 195.0, 185.0, 187.0, 178.0, 166.0, 184.0, 190.0, 161.0, 152.0, 194.0, 189.0, 187.0, 200.0, 164.0, 151.0, 183.0, 193.0, 175.0, 200.0, 200.0, 190.0, 199.0, 161.0, 170.0, 167.0, 159.0, 182.0, 182.0, 193.0, 200.0, 198.0, 161.0, 151.0, 190.0, 190.0, 198.0, 193.0, 197.0, 188.0, 196.0, 198.0], "policy_predator_policy_reward": [4.0, 0.0, 0.0, 5.0, 14.0, 9.0, 0.0, 0.0, 5.0, 0.0, 6.0, 0.0, 14.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 16.0, 14.0, 5.0, 5.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 17.0, 4.0, 0.0, 0.0, 8.0, 5.0, 1.0, 3.0, 0.0, 8.0, 0.0, 0.0, 5.0, 5.0, 11.0, 2.0, 0.0, 0.0, 0.0, 0.0, 10.0, 9.0, 10.0, 0.0, 11.0, 0.0, 3.0, 11.0, 0.0, 0.0, 5.0, 0.0, 13.0, 0.0, 8.0, 15.0, 4.0, 18.0, 17.0, 6.0, 9.0, 0.0, 0.0, 0.0, 16.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 11.0, 0.0, 0.0, 2.0, 2.0, 7.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 3.0, 0.0, 6.0, 0.0, 0.0, 12.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 5.0, 10.0, 0.0, 13.0, 12.0, 13.0, 0.0, 15.0, 17.0, 14.0, 7.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 11.0, 6.0, 16.0, 5.0, 5.0, 9.0, 0.0, 6.0, 0.0, 12.0, 0.0, 15.0, 0.0, 0.0, 6.0, 0.0, 4.0, 4.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 7.0, 13.0, 2.0, 5.0, 14.0, 0.0, 0.0, 0.0, 0.0, 23.0, 0.0, 0.0, 0.0, 0.0, 12.0, 14.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 9.0, 3.0, 14.0, 10.0, 6.0, 12.0, 1.0, 6.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.46613758555261, "mean_inference_ms": 13.07735971785994, "mean_action_processing_ms": 0.7580910687848882, "mean_env_wait_ms": 2.0658017454713424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008484125137329102, "StateBufferConnector_ms": 0.006619811058044434, "ViewRequirementAgentConnector_ms": 0.2560875415802002}, "num_episodes": 27, "episode_return_max": 400.0, "episode_return_min": 325.0, "episode_return_mean": 371.74, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 179.4949289350135, "num_env_steps_trained_throughput_per_sec": 179.4949289350135, "timesteps_total": 784000, "num_env_steps_sampled_lifetime": 784000, "num_agent_steps_sampled_lifetime": 3136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3136000, "timers": {"training_iteration_time_ms": 22571.413, "restore_workers_time_ms": 0.017, "training_step_time_ms": 22571.316, "sample_time_ms": 4060.66, "learn_time_ms": 18483.643, "learn_throughput": 216.408, "synch_weights_time_ms": 22.994}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000}, "done": false, "training_iteration": 196, "trial_id": "45bed_00000", "date": "2024-08-13_05-55-28", "timestamp": 1723542928, "time_this_iter_s": 22.329933881759644, "time_total_s": 17104.982909679413, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b525fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17104.982909679413, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 74.9625, "ram_util_percent": 83.31562500000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2044456926287797, "cur_kl_coeff": 3.6111186457260664e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4340840918677194, "policy_loss": -0.001156712335746282, "vf_loss": 0.4352408047849263, "vf_explained_var": 0.06986459134117005, "kl": 0.002325414757007925, "entropy": 0.05786395962473261, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 371385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0989396930135116, "cur_kl_coeff": 9.592326932761353e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6941388439436359, "policy_loss": -0.0009120160561035235, "vf_loss": 0.6950508611069786, "vf_explained_var": 0.34825946407974084, "kl": 0.005664364103376822, "entropy": 0.8548009760480709, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 371385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 3152000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 325.0, "episode_reward_mean": 371.95, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 116.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 23.0}, "policy_reward_mean": {"prey_policy": 181.75, "predator_policy": 4.225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [371.0, 373.0, 385.0, 374.0, 388.0, 384.0, 379.0, 338.0, 360.0, 378.0, 351.0, 386.0, 358.0, 369.0, 325.0, 351.0, 367.0, 388.0, 356.0, 390.0, 386.0, 336.0, 400.0, 360.0, 348.0, 379.0, 377.0, 355.0, 397.0, 379.0, 382.0, 392.0, 371.0, 345.0, 363.0, 381.0, 382.0, 372.0, 377.0, 368.0, 368.0, 364.0, 330.0, 349.0, 387.0, 389.0, 383.0, 381.0, 373.0, 355.0, 369.0, 376.0, 365.0, 351.0, 399.0, 369.0, 381.0, 368.0, 390.0, 397.0, 373.0, 354.0, 379.0, 358.0, 374.0, 336.0, 383.0, 387.0, 341.0, 376.0, 380.0, 390.0, 372.0, 361.0, 359.0, 382.0, 398.0, 329.0, 380.0, 393.0, 389.0, 394.0, 374.0, 373.0, 386.0, 357.0, 355.0, 366.0, 334.0, 359.0, 389.0, 378.0, 388.0, 375.0, 374.0, 386.0, 399.0, 371.0, 384.0, 394.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [177.0, 191.0, 167.0, 198.0, 195.0, 185.0, 187.0, 171.0, 192.0, 194.0, 195.0, 189.0, 199.0, 170.0, 172.0, 147.0, 167.0, 182.0, 184.0, 191.0, 170.0, 170.0, 185.0, 196.0, 163.0, 182.0, 169.0, 192.0, 190.0, 116.0, 191.0, 125.0, 188.0, 164.0, 190.0, 198.0, 167.0, 173.0, 180.0, 200.0, 193.0, 193.0, 151.0, 185.0, 200.0, 200.0, 179.0, 175.0, 185.0, 152.0, 187.0, 190.0, 169.0, 199.0, 169.0, 172.0, 200.0, 197.0, 190.0, 189.0, 196.0, 179.0, 190.0, 199.0, 182.0, 183.0, 169.0, 164.0, 167.0, 185.0, 190.0, 191.0, 192.0, 190.0, 180.0, 188.0, 162.0, 200.0, 194.0, 161.0, 179.0, 164.0, 154.0, 195.0, 155.0, 144.0, 168.0, 174.0, 171.0, 200.0, 200.0, 189.0, 195.0, 188.0, 172.0, 200.0, 156.0, 200.0, 155.0, 179.0, 172.0, 183.0, 189.0, 181.0, 163.0, 190.0, 181.0, 155.0, 199.0, 200.0, 182.0, 181.0, 197.0, 176.0, 186.0, 172.0, 198.0, 192.0, 197.0, 200.0, 189.0, 177.0, 139.0, 195.0, 185.0, 187.0, 178.0, 166.0, 184.0, 190.0, 161.0, 152.0, 194.0, 189.0, 187.0, 200.0, 164.0, 151.0, 183.0, 193.0, 175.0, 200.0, 200.0, 190.0, 199.0, 161.0, 170.0, 167.0, 159.0, 182.0, 182.0, 193.0, 200.0, 198.0, 161.0, 151.0, 190.0, 190.0, 198.0, 193.0, 197.0, 188.0, 196.0, 198.0, 182.0, 188.0, 175.0, 193.0, 200.0, 186.0, 174.0, 173.0, 152.0, 187.0, 187.0, 173.0, 159.0, 159.0, 162.0, 192.0, 191.0, 197.0, 200.0, 161.0, 191.0, 197.0, 190.0, 169.0, 200.0, 174.0, 198.0, 167.0, 199.0, 200.0, 198.0, 166.0, 196.0, 188.0, 193.0, 200.0], "policy_predator_policy_reward": [3.0, 0.0, 8.0, 0.0, 0.0, 5.0, 5.0, 11.0, 2.0, 0.0, 0.0, 0.0, 0.0, 10.0, 9.0, 10.0, 0.0, 11.0, 0.0, 3.0, 11.0, 0.0, 0.0, 5.0, 0.0, 13.0, 0.0, 8.0, 15.0, 4.0, 18.0, 17.0, 6.0, 9.0, 0.0, 0.0, 0.0, 16.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 11.0, 0.0, 0.0, 2.0, 2.0, 7.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 3.0, 0.0, 6.0, 0.0, 0.0, 12.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 5.0, 10.0, 0.0, 13.0, 12.0, 13.0, 0.0, 15.0, 17.0, 14.0, 7.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 11.0, 6.0, 16.0, 5.0, 5.0, 9.0, 0.0, 6.0, 0.0, 12.0, 0.0, 15.0, 0.0, 0.0, 6.0, 0.0, 4.0, 4.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 7.0, 13.0, 2.0, 5.0, 14.0, 0.0, 0.0, 0.0, 0.0, 23.0, 0.0, 0.0, 0.0, 0.0, 12.0, 14.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 9.0, 3.0, 14.0, 10.0, 6.0, 12.0, 1.0, 6.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 16.0, 6.0, 0.0, 5.0, 11.0, 0.0, 5.0, 1.0, 0.0, 5.0, 12.0, 0.0, 0.0, 7.0, 9.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 1.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.452009348160671, "mean_inference_ms": 13.15494149073263, "mean_action_processing_ms": 0.757073098947803, "mean_env_wait_ms": 1.936877489573765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007610797882080078, "StateBufferConnector_ms": 0.006765842437744141, "ViewRequirementAgentConnector_ms": 0.239210844039917}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 325.0, "episode_return_mean": 371.95, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 3152000, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 188.40264953803145, "num_env_steps_trained_throughput_per_sec": 188.40264953803145, "timesteps_total": 788000, "num_env_steps_sampled_lifetime": 788000, "num_agent_steps_sampled_lifetime": 3152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3152000, "timers": {"training_iteration_time_ms": 22603.947, "restore_workers_time_ms": 0.017, "training_step_time_ms": 22603.849, "sample_time_ms": 3862.41, "learn_time_ms": 18715.038, "learn_throughput": 213.732, "synch_weights_time_ms": 22.346}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 3152000}, "done": false, "training_iteration": 197, "trial_id": "45bed_00000", "date": "2024-08-13_05-55-49", "timestamp": 1723542949, "time_this_iter_s": 21.275705814361572, "time_total_s": 17126.258615493774, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b53a1e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17126.258615493774, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 74.94333333333333, "ram_util_percent": 83.26}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0716018062084913, "cur_kl_coeff": 1.8055593228630332e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.16135969275519962, "policy_loss": 0.0002989467143490122, "vf_loss": 0.16106074613661606, "vf_explained_var": -0.01812755124909537, "kl": 0.0012709674478893636, "entropy": 0.06783817940879436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 373275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3329303679248645, "cur_kl_coeff": 9.592326932761353e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.34155321752285417, "policy_loss": -0.002347234703314604, "vf_loss": 0.3439004525680233, "vf_explained_var": 0.4230320585467828, "kl": 0.007569617885850935, "entropy": 0.9243070124002991, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 373275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 325.0, "episode_reward_mean": 372.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 139.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 23.0}, "policy_reward_mean": {"prey_policy": 181.595, "predator_policy": 4.41}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 390.0, 386.0, 336.0, 400.0, 360.0, 348.0, 379.0, 377.0, 355.0, 397.0, 379.0, 382.0, 392.0, 371.0, 345.0, 363.0, 381.0, 382.0, 372.0, 377.0, 368.0, 368.0, 364.0, 330.0, 349.0, 387.0, 389.0, 383.0, 381.0, 373.0, 355.0, 369.0, 376.0, 365.0, 351.0, 399.0, 369.0, 381.0, 368.0, 390.0, 397.0, 373.0, 354.0, 379.0, 358.0, 374.0, 336.0, 383.0, 387.0, 341.0, 376.0, 380.0, 390.0, 372.0, 361.0, 359.0, 382.0, 398.0, 329.0, 380.0, 393.0, 389.0, 394.0, 374.0, 373.0, 386.0, 357.0, 355.0, 366.0, 334.0, 359.0, 389.0, 378.0, 388.0, 375.0, 374.0, 386.0, 399.0, 371.0, 384.0, 394.0, 338.0, 369.0, 371.0, 383.0, 345.0, 365.0, 363.0, 378.0, 325.0, 397.0, 356.0, 382.0, 373.0, 382.0, 365.0, 380.0, 382.0, 377.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [167.0, 173.0, 180.0, 200.0, 193.0, 193.0, 151.0, 185.0, 200.0, 200.0, 179.0, 175.0, 185.0, 152.0, 187.0, 190.0, 169.0, 199.0, 169.0, 172.0, 200.0, 197.0, 190.0, 189.0, 196.0, 179.0, 190.0, 199.0, 182.0, 183.0, 169.0, 164.0, 167.0, 185.0, 190.0, 191.0, 192.0, 190.0, 180.0, 188.0, 162.0, 200.0, 194.0, 161.0, 179.0, 164.0, 154.0, 195.0, 155.0, 144.0, 168.0, 174.0, 171.0, 200.0, 200.0, 189.0, 195.0, 188.0, 172.0, 200.0, 156.0, 200.0, 155.0, 179.0, 172.0, 183.0, 189.0, 181.0, 163.0, 190.0, 181.0, 155.0, 199.0, 200.0, 182.0, 181.0, 197.0, 176.0, 186.0, 172.0, 198.0, 192.0, 197.0, 200.0, 189.0, 177.0, 139.0, 195.0, 185.0, 187.0, 178.0, 166.0, 184.0, 190.0, 161.0, 152.0, 194.0, 189.0, 187.0, 200.0, 164.0, 151.0, 183.0, 193.0, 175.0, 200.0, 200.0, 190.0, 199.0, 161.0, 170.0, 167.0, 159.0, 182.0, 182.0, 193.0, 200.0, 198.0, 161.0, 151.0, 190.0, 190.0, 198.0, 193.0, 197.0, 188.0, 196.0, 198.0, 182.0, 188.0, 175.0, 193.0, 200.0, 186.0, 174.0, 173.0, 152.0, 187.0, 187.0, 173.0, 159.0, 159.0, 162.0, 192.0, 191.0, 197.0, 200.0, 161.0, 191.0, 197.0, 190.0, 169.0, 200.0, 174.0, 198.0, 167.0, 199.0, 200.0, 198.0, 166.0, 196.0, 188.0, 193.0, 200.0, 163.0, 150.0, 179.0, 178.0, 181.0, 172.0, 186.0, 197.0, 158.0, 162.0, 186.0, 166.0, 163.0, 177.0, 191.0, 187.0, 154.0, 143.0, 197.0, 200.0, 151.0, 189.0, 177.0, 193.0, 185.0, 183.0, 189.0, 186.0, 191.0, 168.0, 184.0, 194.0, 183.0, 199.0, 158.0, 191.0], "policy_predator_policy_reward": [0.0, 16.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 11.0, 0.0, 0.0, 2.0, 2.0, 7.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 3.0, 0.0, 6.0, 0.0, 0.0, 12.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 5.0, 10.0, 0.0, 13.0, 12.0, 13.0, 0.0, 15.0, 17.0, 14.0, 7.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 11.0, 6.0, 16.0, 5.0, 5.0, 9.0, 0.0, 6.0, 0.0, 12.0, 0.0, 15.0, 0.0, 0.0, 6.0, 0.0, 4.0, 4.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 7.0, 13.0, 2.0, 5.0, 14.0, 0.0, 0.0, 0.0, 0.0, 23.0, 0.0, 0.0, 0.0, 0.0, 12.0, 14.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 9.0, 3.0, 14.0, 10.0, 6.0, 12.0, 1.0, 6.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 16.0, 6.0, 0.0, 5.0, 11.0, 0.0, 5.0, 1.0, 0.0, 5.0, 12.0, 0.0, 0.0, 7.0, 9.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 1.0, 0.0, 12.0, 13.0, 7.0, 5.0, 12.0, 6.0, 0.0, 0.0, 14.0, 11.0, 5.0, 8.0, 14.0, 9.0, 0.0, 0.0, 19.0, 9.0, 0.0, 0.0, 0.0, 16.0, 6.0, 6.0, 0.0, 5.0, 3.0, 4.0, 0.0, 6.0, 0.0, 2.0, 0.0, 0.0, 14.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.437877101546258, "mean_inference_ms": 13.112579147451996, "mean_action_processing_ms": 0.7561223132703873, "mean_env_wait_ms": 1.9301155350645558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007714748382568359, "StateBufferConnector_ms": 0.008316636085510254, "ViewRequirementAgentConnector_ms": 0.24772167205810547}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 325.0, "episode_return_mean": 372.01, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 188.09718995811397, "num_env_steps_trained_throughput_per_sec": 188.09718995811397, "timesteps_total": 792000, "num_env_steps_sampled_lifetime": 792000, "num_agent_steps_sampled_lifetime": 3168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3168000, "timers": {"training_iteration_time_ms": 22523.296, "restore_workers_time_ms": 0.017, "training_step_time_ms": 22523.198, "sample_time_ms": 3703.393, "learn_time_ms": 18793.797, "learn_throughput": 212.836, "synch_weights_time_ms": 21.703}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000}, "done": false, "training_iteration": 198, "trial_id": "45bed_00000", "date": "2024-08-13_05-56-11", "timestamp": 1723542971, "time_this_iter_s": 21.322727918624878, "time_total_s": 17147.5813434124, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5392790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17147.5813434124, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 75.74000000000001, "ram_util_percent": 82.86666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7101183984034434, "cur_kl_coeff": 9.027796614315166e-37, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.16958083515129393, "policy_loss": -0.00047999613834594294, "vf_loss": 0.17006083110134654, "vf_explained_var": 0.02635634077919854, "kl": 0.001950073068336054, "entropy": 0.07111845543341977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 375165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1519085895132135, "cur_kl_coeff": 9.592326932761353e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6628415532548119, "policy_loss": -0.0034683771086511787, "vf_loss": 0.6663099299820643, "vf_explained_var": 0.1577362194893852, "kl": 0.010438317723855206, "entropy": 0.9729967536749663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 375165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 3184000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 325.0, "episode_reward_mean": 373.08, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 139.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 23.0}, "policy_reward_mean": {"prey_policy": 182.245, "predator_policy": 4.295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [382.0, 372.0, 377.0, 368.0, 368.0, 364.0, 330.0, 349.0, 387.0, 389.0, 383.0, 381.0, 373.0, 355.0, 369.0, 376.0, 365.0, 351.0, 399.0, 369.0, 381.0, 368.0, 390.0, 397.0, 373.0, 354.0, 379.0, 358.0, 374.0, 336.0, 383.0, 387.0, 341.0, 376.0, 380.0, 390.0, 372.0, 361.0, 359.0, 382.0, 398.0, 329.0, 380.0, 393.0, 389.0, 394.0, 374.0, 373.0, 386.0, 357.0, 355.0, 366.0, 334.0, 359.0, 389.0, 378.0, 388.0, 375.0, 374.0, 386.0, 399.0, 371.0, 384.0, 394.0, 338.0, 369.0, 371.0, 383.0, 345.0, 365.0, 363.0, 378.0, 325.0, 397.0, 356.0, 382.0, 373.0, 382.0, 365.0, 380.0, 382.0, 377.0, 373.0, 392.0, 392.0, 391.0, 376.0, 371.0, 385.0, 355.0, 384.0, 394.0, 392.0, 379.0, 376.0, 373.0, 400.0, 367.0, 351.0, 353.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [192.0, 190.0, 180.0, 188.0, 162.0, 200.0, 194.0, 161.0, 179.0, 164.0, 154.0, 195.0, 155.0, 144.0, 168.0, 174.0, 171.0, 200.0, 200.0, 189.0, 195.0, 188.0, 172.0, 200.0, 156.0, 200.0, 155.0, 179.0, 172.0, 183.0, 189.0, 181.0, 163.0, 190.0, 181.0, 155.0, 199.0, 200.0, 182.0, 181.0, 197.0, 176.0, 186.0, 172.0, 198.0, 192.0, 197.0, 200.0, 189.0, 177.0, 139.0, 195.0, 185.0, 187.0, 178.0, 166.0, 184.0, 190.0, 161.0, 152.0, 194.0, 189.0, 187.0, 200.0, 164.0, 151.0, 183.0, 193.0, 175.0, 200.0, 200.0, 190.0, 199.0, 161.0, 170.0, 167.0, 159.0, 182.0, 182.0, 193.0, 200.0, 198.0, 161.0, 151.0, 190.0, 190.0, 198.0, 193.0, 197.0, 188.0, 196.0, 198.0, 182.0, 188.0, 175.0, 193.0, 200.0, 186.0, 174.0, 173.0, 152.0, 187.0, 187.0, 173.0, 159.0, 159.0, 162.0, 192.0, 191.0, 197.0, 200.0, 161.0, 191.0, 197.0, 190.0, 169.0, 200.0, 174.0, 198.0, 167.0, 199.0, 200.0, 198.0, 166.0, 196.0, 188.0, 193.0, 200.0, 163.0, 150.0, 179.0, 178.0, 181.0, 172.0, 186.0, 197.0, 158.0, 162.0, 186.0, 166.0, 163.0, 177.0, 191.0, 187.0, 154.0, 143.0, 197.0, 200.0, 151.0, 189.0, 177.0, 193.0, 185.0, 183.0, 189.0, 186.0, 191.0, 168.0, 184.0, 194.0, 183.0, 199.0, 158.0, 191.0, 182.0, 191.0, 197.0, 195.0, 200.0, 192.0, 200.0, 191.0, 183.0, 193.0, 176.0, 187.0, 200.0, 179.0, 173.0, 170.0, 198.0, 179.0, 195.0, 199.0, 192.0, 200.0, 191.0, 188.0, 193.0, 183.0, 188.0, 176.0, 200.0, 200.0, 168.0, 185.0, 163.0, 176.0, 186.0, 151.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 4.0, 5.0, 10.0, 0.0, 13.0, 12.0, 13.0, 0.0, 15.0, 17.0, 14.0, 7.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 11.0, 6.0, 16.0, 5.0, 5.0, 9.0, 0.0, 6.0, 0.0, 12.0, 0.0, 15.0, 0.0, 0.0, 6.0, 0.0, 4.0, 4.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 7.0, 13.0, 2.0, 5.0, 14.0, 0.0, 0.0, 0.0, 0.0, 23.0, 0.0, 0.0, 0.0, 0.0, 12.0, 14.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 9.0, 3.0, 14.0, 10.0, 6.0, 12.0, 1.0, 6.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 16.0, 6.0, 0.0, 5.0, 11.0, 0.0, 5.0, 1.0, 0.0, 5.0, 12.0, 0.0, 0.0, 7.0, 9.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 1.0, 0.0, 12.0, 13.0, 7.0, 5.0, 12.0, 6.0, 0.0, 0.0, 14.0, 11.0, 5.0, 8.0, 14.0, 9.0, 0.0, 0.0, 19.0, 9.0, 0.0, 0.0, 0.0, 16.0, 6.0, 6.0, 0.0, 5.0, 3.0, 4.0, 0.0, 6.0, 0.0, 2.0, 0.0, 0.0, 14.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 6.0, 0.0, 8.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 0.0, 14.0, 12.0, 0.0, 4.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4239344442391895, "mean_inference_ms": 13.070724509161252, "mean_action_processing_ms": 0.755206154274029, "mean_env_wait_ms": 1.9234055932807552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007823824882507324, "StateBufferConnector_ms": 0.008507966995239258, "ViewRequirementAgentConnector_ms": 0.27097904682159424}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 325.0, "episode_return_mean": 373.08, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 3184000, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 122.62929225594624, "num_env_steps_trained_throughput_per_sec": 122.62929225594624, "timesteps_total": 796000, "num_env_steps_sampled_lifetime": 796000, "num_agent_steps_sampled_lifetime": 3184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3184000, "timers": {"training_iteration_time_ms": 23780.056, "restore_workers_time_ms": 0.017, "training_step_time_ms": 23779.953, "sample_time_ms": 3609.799, "learn_time_ms": 20142.446, "learn_throughput": 198.586, "synch_weights_time_ms": 22.719}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 3184000}, "done": false, "training_iteration": 199, "trial_id": "45bed_00000", "date": "2024-08-13_05-56-44", "timestamp": 1723543004, "time_this_iter_s": 32.73339581489563, "time_total_s": 17180.314739227295, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b539cd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17180.314739227295, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 81.465, "ram_util_percent": 84.0175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0547506653698822, "cur_kl_coeff": 4.513898307157583e-37, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3281045567421686, "policy_loss": -0.001039858223998515, "vf_loss": 0.3291444139941916, "vf_explained_var": 0.049987850555036434, "kl": 0.0017429429046774726, "entropy": 0.07212670023242633, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 377055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.504225627194952, "cur_kl_coeff": 9.592326932761353e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.48202623656689725, "policy_loss": -0.0038999064497787644, "vf_loss": 0.48592614404187, "vf_explained_var": 0.3188898255585363, "kl": 0.006239153786259807, "entropy": 0.9618089796374084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 377055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 325.0, "episode_reward_mean": 372.66, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 114.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 23.0}, "policy_reward_mean": {"prey_policy": 182.135, "predator_policy": 4.195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [358.0, 374.0, 336.0, 383.0, 387.0, 341.0, 376.0, 380.0, 390.0, 372.0, 361.0, 359.0, 382.0, 398.0, 329.0, 380.0, 393.0, 389.0, 394.0, 374.0, 373.0, 386.0, 357.0, 355.0, 366.0, 334.0, 359.0, 389.0, 378.0, 388.0, 375.0, 374.0, 386.0, 399.0, 371.0, 384.0, 394.0, 338.0, 369.0, 371.0, 383.0, 345.0, 365.0, 363.0, 378.0, 325.0, 397.0, 356.0, 382.0, 373.0, 382.0, 365.0, 380.0, 382.0, 377.0, 373.0, 392.0, 392.0, 391.0, 376.0, 371.0, 385.0, 355.0, 384.0, 394.0, 392.0, 379.0, 376.0, 373.0, 400.0, 367.0, 351.0, 353.0, 379.0, 384.0, 354.0, 367.0, 354.0, 378.0, 342.0, 381.0, 388.0, 373.0, 361.0, 361.0, 375.0, 400.0, 328.0, 389.0, 384.0, 374.0, 374.0, 382.0, 382.0, 400.0, 344.0, 373.0, 356.0, 362.0, 362.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [178.0, 166.0, 184.0, 190.0, 161.0, 152.0, 194.0, 189.0, 187.0, 200.0, 164.0, 151.0, 183.0, 193.0, 175.0, 200.0, 200.0, 190.0, 199.0, 161.0, 170.0, 167.0, 159.0, 182.0, 182.0, 193.0, 200.0, 198.0, 161.0, 151.0, 190.0, 190.0, 198.0, 193.0, 197.0, 188.0, 196.0, 198.0, 182.0, 188.0, 175.0, 193.0, 200.0, 186.0, 174.0, 173.0, 152.0, 187.0, 187.0, 173.0, 159.0, 159.0, 162.0, 192.0, 191.0, 197.0, 200.0, 161.0, 191.0, 197.0, 190.0, 169.0, 200.0, 174.0, 198.0, 167.0, 199.0, 200.0, 198.0, 166.0, 196.0, 188.0, 193.0, 200.0, 163.0, 150.0, 179.0, 178.0, 181.0, 172.0, 186.0, 197.0, 158.0, 162.0, 186.0, 166.0, 163.0, 177.0, 191.0, 187.0, 154.0, 143.0, 197.0, 200.0, 151.0, 189.0, 177.0, 193.0, 185.0, 183.0, 189.0, 186.0, 191.0, 168.0, 184.0, 194.0, 183.0, 199.0, 158.0, 191.0, 182.0, 191.0, 197.0, 195.0, 200.0, 192.0, 200.0, 191.0, 183.0, 193.0, 176.0, 187.0, 200.0, 179.0, 173.0, 170.0, 198.0, 179.0, 195.0, 199.0, 192.0, 200.0, 191.0, 188.0, 193.0, 183.0, 188.0, 176.0, 200.0, 200.0, 168.0, 185.0, 163.0, 176.0, 186.0, 151.0, 193.0, 179.0, 194.0, 188.0, 152.0, 186.0, 193.0, 174.0, 162.0, 182.0, 167.0, 200.0, 152.0, 167.0, 184.0, 192.0, 184.0, 200.0, 194.0, 169.0, 179.0, 170.0, 172.0, 180.0, 188.0, 187.0, 200.0, 200.0, 114.0, 186.0, 200.0, 189.0, 187.0, 196.0, 175.0, 187.0, 179.0, 195.0, 173.0, 200.0, 176.0, 195.0, 200.0, 200.0, 149.0, 169.0, 200.0, 145.0, 166.0, 174.0, 158.0, 194.0, 180.0, 174.0], "policy_predator_policy_reward": [14.0, 0.0, 0.0, 0.0, 0.0, 23.0, 0.0, 0.0, 0.0, 0.0, 12.0, 14.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 9.0, 3.0, 14.0, 10.0, 6.0, 12.0, 1.0, 6.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 16.0, 6.0, 0.0, 5.0, 11.0, 0.0, 5.0, 1.0, 0.0, 5.0, 12.0, 0.0, 0.0, 7.0, 9.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 1.0, 0.0, 12.0, 13.0, 7.0, 5.0, 12.0, 6.0, 0.0, 0.0, 14.0, 11.0, 5.0, 8.0, 14.0, 9.0, 0.0, 0.0, 19.0, 9.0, 0.0, 0.0, 0.0, 16.0, 6.0, 6.0, 0.0, 5.0, 3.0, 4.0, 0.0, 6.0, 0.0, 2.0, 0.0, 0.0, 14.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 6.0, 0.0, 8.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 0.0, 14.0, 12.0, 0.0, 4.0, 12.0, 7.0, 0.0, 2.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 10.0, 11.0, 0.0, 6.0, 17.0, 5.0, 0.0, 0.0, 4.0, 0.0, 10.0, 0.0, 12.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 11.0, 0.0, 0.0, 0.0, 1.0, 7.0, 5.0, 0.0, 0.0, 0.0, 9.0, 4.0, 7.0, 0.0, 0.0, 17.0, 9.0, 10.0, 18.0, 16.0, 0.0, 0.0, 10.0, 4.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.961502873923902, "mean_inference_ms": 14.884491715716496, "mean_action_processing_ms": 0.756780401571305, "mean_env_wait_ms": 2.353075772847566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0071904659271240234, "StateBufferConnector_ms": 0.00850367546081543, "ViewRequirementAgentConnector_ms": 0.31615471839904785}, "num_episodes": 27, "episode_return_max": 400.0, "episode_return_min": 325.0, "episode_return_mean": 372.66, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.134812805398648, "num_env_steps_trained_throughput_per_sec": 4.134812805398648, "timesteps_total": 800000, "num_env_steps_sampled_lifetime": 800000, "num_agent_steps_sampled_lifetime": 3200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3200000, "timers": {"training_iteration_time_ms": 117226.075, "restore_workers_time_ms": 0.022, "training_step_time_ms": 117226.005, "sample_time_ms": 97814.369, "learn_time_ms": 19388.115, "learn_throughput": 206.312, "synch_weights_time_ms": 20.286}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "done": true, "training_iteration": 200, "trial_id": "45bed_00000", "date": "2024-08-13_06-12-51", "timestamp": 1723543971, "time_this_iter_s": 967.4995038509369, "time_total_s": 18147.81424307823, "pid": 21667, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b539c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 4, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18147.81424307823, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 90.55526315789474, "ram_util_percent": 83.63684210526316}}
