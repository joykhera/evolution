{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7089347494726486, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.064687790769212, "policy_loss": -0.01814853293926072, "vf_loss": 7.080925771361547, "vf_explained_var": 0.04042655855205888, "kl": 0.009552775029545478, "entropy": 1.6009526266696605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 1410.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1415170176398186, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.031899463058148, "policy_loss": -0.01849272044710618, "vf_loss": 7.048874633274381, "vf_explained_var": 0.0394313341095334, "kl": 0.007587792823477968, "entropy": 1.6028457567174599, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 60.033119233947616, "num_env_steps_trained_throughput_per_sec": 60.033119233947616, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 66629.9, "restore_workers_time_ms": 0.02, "training_step_time_ms": 66629.844, "sample_time_ms": 5465.69, "learn_time_ms": 61134.856, "learn_throughput": 65.429, "synch_weights_time_ms": 14.781}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 1, "trial_id": "62684_00000", "date": "2024-08-20_16-08-50", "timestamp": 1724150330, "time_this_iter_s": 66.71983599662781, "time_total_s": 66.71983599662781, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fad4940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 66.71983599662781, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 57.096875000000004, "ram_util_percent": 83.51041666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.592142182905623, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.079849459431696, "policy_loss": -0.02335175003609554, "vf_loss": 6.101132496028927, "vf_explained_var": 0.11963018867986422, "kl": 0.010343487197002775, "entropy": 1.5851604596942874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 4230.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9340559414770238, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.856753160083104, "policy_loss": -0.023000777736133723, "vf_loss": 5.87781482222219, "vf_explained_var": 0.09161201983532577, "kl": 0.009695490436855131, "entropy": 1.5879013153611037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.522198099262376, "num_env_steps_trained_throughput_per_sec": 55.522198099262376, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 69336.637, "restore_workers_time_ms": 0.099, "training_step_time_ms": 69336.412, "sample_time_ms": 4641.966, "learn_time_ms": 64672.254, "learn_throughput": 61.85, "synch_weights_time_ms": 13.301}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 2, "trial_id": "62684_00000", "date": "2024-08-20_16-10-05", "timestamp": 1724150405, "time_this_iter_s": 72.19739127159119, "time_total_s": 138.917227268219, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fad49d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 138.917227268219, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 59.626168224299064, "ram_util_percent": 83.5869158878505}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9084341135430845, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.555306107608985, "policy_loss": -0.017039668474987096, "vf_loss": 5.570541138682805, "vf_explained_var": 0.11229653081572648, "kl": 0.009023199787389006, "entropy": 1.573341761962742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 7050.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.874166099735038, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.651732304613426, "policy_loss": -0.022114018320534674, "vf_loss": 4.672060410938566, "vf_explained_var": 0.08730396558998754, "kl": 0.00892948449873267, "entropy": 1.5743316208874738, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": 239.39999999999873, "episode_reward_min": 239.39999999999873, "episode_reward_mean": 239.39999999999873, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 200, "policy_reward_min": {"prey_policy": -95.33590576040369, "predator_policy": 47.72284923259906}, "policy_reward_max": {"prey_policy": 167.59999999999985, "predator_policy": 118.46249731506404}, "policy_reward_mean": {"prey_policy": 24.40488448411195, "predator_policy": 83.09267327383155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [239.39999999999873], "episode_lengths": [200], "policy_prey_policy_reward": [0.9505592127396914, -95.33590576040369, 167.59999999999985], "policy_predator_policy_reward": [118.46249731506404, 47.72284923259906]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.840220966977936, "mean_inference_ms": 6.45248741624458, "mean_action_processing_ms": 2.3281083723004357, "mean_env_wait_ms": 13.016307182859576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002944469451904297, "StateBufferConnector_ms": 0.004029273986816406, "ViewRequirementAgentConnector_ms": 0.09375810623168945}, "num_episodes": 1, "episode_return_max": 239.39999999999873, "episode_return_min": 239.39999999999873, "episode_return_mean": 239.39999999999873, "episodes_this_iter": 1}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 57.861292812671174, "num_env_steps_trained_throughput_per_sec": 57.861292812671174, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 69268.043, "restore_workers_time_ms": 0.071, "training_step_time_ms": 69267.877, "sample_time_ms": 4447.389, "learn_time_ms": 64799.201, "learn_throughput": 61.729, "synch_weights_time_ms": 14.332}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 3, "trial_id": "62684_00000", "date": "2024-08-20_16-11-14", "timestamp": 1724150474, "time_this_iter_s": 69.19334173202515, "time_total_s": 208.11056900024414, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffa9ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 208.11056900024414, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 54.207142857142856, "ram_util_percent": 83.41020408163266}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.073216587918025, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.394297794670078, "policy_loss": -0.02430147689307713, "vf_loss": 5.416424703767114, "vf_explained_var": 0.25007044560943087, "kl": 0.010872807703146064, "entropy": 1.533568141857783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 9870.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7571977571835595, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.885167352106206, "policy_loss": -0.027177092483237623, "vf_loss": 4.909642677584653, "vf_explained_var": 0.18716272639219092, "kl": 0.013508840268736498, "entropy": 1.5282951730268972, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 314.8648501361709, "episode_reward_min": -51.023062653928164, "episode_reward_mean": 141.96558897732515, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -471.83676647050527, "predator_policy": 1.970165963680401}, "policy_reward_max": {"prey_policy": 181.09999999999988, "predator_policy": 469.6293408902028}, "policy_reward_mean": {"prey_policy": -53.06735045739114, "predator_policy": 150.58382017474943}, "custom_metrics": {}, "hist_stats": {"episode_reward": [239.39999999999873, 236.74994898880283, 217.14705510872014, 158.82720098504595, 237.06021935752855, 91.43354607356503, 153.62362386129038, 264.9912644060712, -51.023062653928164, 218.05654402715612, 18.167664115262298, 171.21104871274454, 152.84765562075486, 78.07798241331217, 231.73991910211322, 205.8918305882458, 204.94484772782138, 172.05009715416762, 61.28443498712082, 221.61271656433036, 85.71708780497733, 160.89999999999918, 52.797357848307534, 213.498768370985, 276.32898156823455, 88.20022068068354, 203.39869695250914, 234.4110020022605, 178.4041175488934, 107.23260918067866, 54.01611652351733, 124.27706446400227, 35.672630334324175, 73.10416359398296, 36.31449746923505, 196.90877232113587, -21.094022778267224, 141.76943166807862, 123.59999999999809, 158.61321959390798, 182.04241193673815, 1.49295662865042, 19.171211553914564, 136.98286264041644, 147.89714972186184, 95.89999999999942, 162.19999999999916, 117.39157014363153, 101.00202251493437, 67.40872236734224, 144.14587532367983, 26.52598860210152, 177.4136414528967, 173.513647462721, 23.746547722537972, 131.7213320106102, 145.192325500056, 314.8648501361709, 184.58686136118405, 155.75767483208642, 137.899268917031, 128.29999999999956, 212.855937878985, 194.36761292787867, 148.9694541063758, 256.4201755153144, 295.9999999999992, 36.570650200632116, 184.82788476064073, 8.801364129357587, 163.53977884499008, 135.84737488710562], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.9505592127396914, -95.33590576040369, 167.59999999999985, 63.66042004021319, 13.711052970150647, 26.30000000000012, -180.43994011637525, 106.39298318012837, 39.41669597358029, -414.91705350262123, 30.679239838647092, 81.11092039672123, 102.79999999999953, -95.88637471308904, 37.16098668770449, -103.86103600010135, -248.19026526713506, 47.403167720918525, -158.08959829334876, 93.1535787161577, 20.000000000000014, 49.92077722248086, -48.54169348303614, -77.62659972558282, -291.4627409145269, -170.41495338825752, -52.78802011771328, -115.96579361462764, -39.9002923302152, 128.7759920183599, -43.8877390628111, -282.9994712977213, -260.2714639269774, -301.1001150979375, -63.95772139159729, 93.80000000000013, -3.4793103510531074, -169.79970328335432, 39.8000000000002, -82.29860767622809, 12.538070512519463, -257.1293844080145, 81.63168593139072, 67.69999999999996, -89.69071888185712, -2.8480170086340646, 25.945817473450568, -54.907843426805016, 20.000000000000014, -202.42799201557992, 127.46100108203946, 27.794405442340405, -311.9304868096805, 21.80000000000004, 20.900000000000013, -145.71491660608996, -55.49110013259194, -320.1691503077063, 101.46723825182775, -73.87265181543759, -42.64149901565241, -28.8373386239291, 1.6730619630637307, -92.26124419148248, 13.19990008784871, 30.231602522261966, -84.3811015965864, -294.1703902553279, -120.49211203359287, 75.80000000000007, -71.47147130319489, -160.84793576576536, 26.795525428550732, 142.3999999999998, -66.57320899603107, -30.331809266154206, -47.7277739093593, -26.679875938827923, 21.800000000000047, 60.50000000000018, -277.30392238076064, 40.23854732781016, 50.17723331028906, 18.261637113428392, -29.186800147409386, 21.80000000000004, 20.000000000000014, -114.17973951895635, 76.57464374963664, -28.58197380193853, -95.49447570043557, 17.829834036319586, 18.843082888533942, 17.234728987754334, -27.257945684982413, -2.7978150681730836, -196.49418857256134, -160.10011914482666, 33.50000000000019, -33.19269216020086, -105.49295695165685, -13.226875635020129, -100.08724749804503, -174.59087218694006, -178.39050104924553, -45.77139017497987, -317.6233280743962, 73.86244113276432, -10.343336975315273, -230.66852619931134, -134.3867454293843, -225.54843440016995, 62.31527276938405, -85.59369048384116, -88.05843809829759, 82.26579050461145, -86.44803647980402, -135.64992321873243, -66.7443984302982, 51.462582012723686, -167.2391944198911, 53.78198455161219, -8.068571367200207, -414.9753492286705, -36.74172820983104, -346.51246239810945, -210.48340763302264, 32.599999999999994, -104.01366100746078, -108.67756624687215, 3.466729203543049, -152.11135943924302, -156.12349628848202, -91.52790665905793, 27.60678163178693, 20.90000000000003, 41.970581767287776, -112.83889761750261, 135.2, -121.45239517227972, -135.66227384970983, -75.62306395169954, -36.20363313228011, 20.000000000000014, 20.000000000000014, 20.000000000000014, -30.954174456125422, 20.908722367341895, -19.469588213014596, -49.132498891382404, -36.30947224431668, -42.786285149497054, -88.28740116894036, -5.064967535089375, -87.27804190039683, -222.26462930346813, -59.92096595580679, 79.39999999999984, -310.76006596675353, 17.03512603007598, -51.959165200877145, -53.515519847446335, -100.82283291899294, -171.39195006892706, -162.07269189347198, -5.067538200824263, -12.615650487799932, 23.318609892950143, -52.80475174214942, -125.14661103609868, -113.33784509251544, -47.4923484110584, 159.24340248114856, 76.91111708685824, 33.82436289450702, -193.4181728061421, 51.5000000000002, 54.20000000000019, -471.83676647050527, -7.910782258428782, -113.25163980799084, 24.253604275775853, -20.83786010127795, -22.88107165303709, 72.20000000000006, 6.19489188705451, 106.39999999999998, -196.56672219338887, -46.538373649416364, -11.657228333636063, -59.7011235905661, -15.779931263882638, -59.11890916971239, -23.394702659040437, 20.000000000000014, 23.60000000000001, -314.0145240286328, 161.13672032365005, 181.09999999999988, 8.565959643004385, -20.805497441827413, -207.82867987360999, 10.452991814554187, -51.35879632173413, -50.040043037786404, -219.06895680150276, 20.900000000000027, -105.5479141171333, -103.12716355396346, 20.000000000000014, -137.10786356741215, 93.48434488478759, -82.20718849186338, 22.17781285421547, -257.76772752780096, 31.98247722226351], "policy_predator_policy_reward": [118.46249731506404, 47.72284923259906, 12.723800171325628, 120.35467580711422, 82.664701118892, 169.11261495249516, 13.868162751217621, 448.08593150108123, 154.1836942155447, 38.801913167369854, 245.12049060607336, 150.96118901380942, 112.92669345939572, 85.63294997908669, 188.09708690917319, 153.1416934830361, 99.0880201177129, 364.5546316488554, 100.68711817652316, 144.4595197771162, 279.42686710505245, 325.8994712977214, 325.3312687075862, 117.13761649469514, 126.34334957979983, 159.98331967536387, 248.76594859192747, 156.2019553931081, 135.39677079009272, 36.70218126248734, 95.02559124496375, 142.67628230527123, 52.76772968705581, 207.14410897430665, 295.47107616287633, 138.91510235863353, 142.17164950142177, 99.4188022243804, 188.47456928067066, 325.71271115497586, 110.08552485756724, 45.43733862392933, 124.02037041020495, 85.70937117116648, 360.4553430034755, 191.38561873033805, 118.23704080479827, 251.78113463514723, 78.29406997411837, 95.41259516159639, 55.62385951767986, 137.31582027734473, 103.10182558585764, 295.3007937474135, 90.89522136416255, 34.83836288657162, 31.522251814411227, 134.2686658818926, 169.99432250157346, 3.42535625036333, 110.86750933541758, 1.970165963680401, 83.06642209730833, 54.0316741320965, 107.5373431202282, 251.22959493148286, 213.28126797901876, 11.735420361840433, 201.2908721869399, 288.0922460165248, 199.4049880105984, 287.03606142714943, 89.49865931149824, 264.80592651424456, 170.2078101119413, 220.38847367076508, 114.09264759368475, 101.7480364798036, 54.60597499635183, 254.93898423386344, 235.90559138355616, 67.66260178866148, 336.9458386157975, 462.7766578494659, 126.5099364889827, 174.55834370541453, 197.0762914020547, 197.22876772093403, 161.52790665905758, 206.41386437855755, 127.6575902386778, 18.210725611536507, 147.86227384970914, 136.25239517227888, 58.338233177233, 150.88003405037884, 52.70470696567925, 39.2514900053826, 54.77830420041318, 60.32378290398428, 40.877491088343945, 270.6515427980907, 116.46682036053068, 224.66680698052417, 255.94339832071722, 212.75127505474128, 65.869777079439, 196.08342940153105, 215.76180402694874, 242.27221857697936, 78.15904878983946, 47.92686201644532, 148.43454662286342, 288.04698674795634, 18.47677935397042, 107.7258996252519, 49.13680659790857, 243.5438646749116, 469.6293408902028, 111.67588267081786, 126.05163980799014, 121.68352474253412, 12.505108112945482, 60.28107165303723, 229.34151882990884, 120.2195148918814, 116.99027512824075, 164.51562098772263, 132.58729909733015, 78.89576683779936, 52.791134122421774, 332.90684509787604, 90.10549744182723, 37.03404035699561, 82.64306816418018, 202.6620664172413, 104.2568876280207, 328.7799969719103, 9.018469460468008, 188.45797233998582, 203.745866555873, 85.62461946360493, 51.45492036846373, 287.9998919699656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.466167331362303, "mean_inference_ms": 7.050024797546966, "mean_action_processing_ms": 5.313635349964689, "mean_env_wait_ms": 14.332404442191558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006516774495442708, "StateBufferConnector_ms": 0.01366734504699707, "ViewRequirementAgentConnector_ms": 2.8468453221850925}, "num_episodes": 71, "episode_return_max": 314.8648501361709, "episode_return_min": -51.023062653928164, "episode_return_mean": 141.96558897732515, "episodes_this_iter": 71}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 53.81493326663708, "num_env_steps_trained_throughput_per_sec": 53.81493326663708, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 70533.239, "restore_workers_time_ms": 0.057, "training_step_time_ms": 70533.101, "sample_time_ms": 5230.203, "learn_time_ms": 65279.18, "learn_throughput": 61.275, "synch_weights_time_ms": 14.706}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 4, "trial_id": "62684_00000", "date": "2024-08-20_16-12-29", "timestamp": 1724150549, "time_this_iter_s": 74.41151881217957, "time_total_s": 282.5220878124237, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb0a670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 282.5220878124237, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 52.708571428571425, "ram_util_percent": 83.42857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.654622049682529, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.5011606368612735, "policy_loss": -0.02011890713288944, "vf_loss": 6.518965898676122, "vf_explained_var": 0.22625674677233323, "kl": 0.011568175094385453, "entropy": 1.5206042352720355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 12690.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.499338065032606, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.91515113462216, "policy_loss": -0.022966962302763943, "vf_loss": 5.935271471770352, "vf_explained_var": 0.1397614036918317, "kl": 0.014233136586426073, "entropy": 1.4993869546229246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": 314.8648501361709, "episode_reward_min": -51.023062653928164, "episode_reward_mean": 141.96558897732515, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -471.83676647050527, "predator_policy": 1.970165963680401}, "policy_reward_max": {"prey_policy": 181.09999999999988, "predator_policy": 469.6293408902028}, "policy_reward_mean": {"prey_policy": -53.06735045739114, "predator_policy": 150.58382017474943}, "custom_metrics": {}, "hist_stats": {"episode_reward": [239.39999999999873, 236.74994898880283, 217.14705510872014, 158.82720098504595, 237.06021935752855, 91.43354607356503, 153.62362386129038, 264.9912644060712, -51.023062653928164, 218.05654402715612, 18.167664115262298, 171.21104871274454, 152.84765562075486, 78.07798241331217, 231.73991910211322, 205.8918305882458, 204.94484772782138, 172.05009715416762, 61.28443498712082, 221.61271656433036, 85.71708780497733, 160.89999999999918, 52.797357848307534, 213.498768370985, 276.32898156823455, 88.20022068068354, 203.39869695250914, 234.4110020022605, 178.4041175488934, 107.23260918067866, 54.01611652351733, 124.27706446400227, 35.672630334324175, 73.10416359398296, 36.31449746923505, 196.90877232113587, -21.094022778267224, 141.76943166807862, 123.59999999999809, 158.61321959390798, 182.04241193673815, 1.49295662865042, 19.171211553914564, 136.98286264041644, 147.89714972186184, 95.89999999999942, 162.19999999999916, 117.39157014363153, 101.00202251493437, 67.40872236734224, 144.14587532367983, 26.52598860210152, 177.4136414528967, 173.513647462721, 23.746547722537972, 131.7213320106102, 145.192325500056, 314.8648501361709, 184.58686136118405, 155.75767483208642, 137.899268917031, 128.29999999999956, 212.855937878985, 194.36761292787867, 148.9694541063758, 256.4201755153144, 295.9999999999992, 36.570650200632116, 184.82788476064073, 8.801364129357587, 163.53977884499008, 135.84737488710562], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.9505592127396914, -95.33590576040369, 167.59999999999985, 63.66042004021319, 13.711052970150647, 26.30000000000012, -180.43994011637525, 106.39298318012837, 39.41669597358029, -414.91705350262123, 30.679239838647092, 81.11092039672123, 102.79999999999953, -95.88637471308904, 37.16098668770449, -103.86103600010135, -248.19026526713506, 47.403167720918525, -158.08959829334876, 93.1535787161577, 20.000000000000014, 49.92077722248086, -48.54169348303614, -77.62659972558282, -291.4627409145269, -170.41495338825752, -52.78802011771328, -115.96579361462764, -39.9002923302152, 128.7759920183599, -43.8877390628111, -282.9994712977213, -260.2714639269774, -301.1001150979375, -63.95772139159729, 93.80000000000013, -3.4793103510531074, -169.79970328335432, 39.8000000000002, -82.29860767622809, 12.538070512519463, -257.1293844080145, 81.63168593139072, 67.69999999999996, -89.69071888185712, -2.8480170086340646, 25.945817473450568, -54.907843426805016, 20.000000000000014, -202.42799201557992, 127.46100108203946, 27.794405442340405, -311.9304868096805, 21.80000000000004, 20.900000000000013, -145.71491660608996, -55.49110013259194, -320.1691503077063, 101.46723825182775, -73.87265181543759, -42.64149901565241, -28.8373386239291, 1.6730619630637307, -92.26124419148248, 13.19990008784871, 30.231602522261966, -84.3811015965864, -294.1703902553279, -120.49211203359287, 75.80000000000007, -71.47147130319489, -160.84793576576536, 26.795525428550732, 142.3999999999998, -66.57320899603107, -30.331809266154206, -47.7277739093593, -26.679875938827923, 21.800000000000047, 60.50000000000018, -277.30392238076064, 40.23854732781016, 50.17723331028906, 18.261637113428392, -29.186800147409386, 21.80000000000004, 20.000000000000014, -114.17973951895635, 76.57464374963664, -28.58197380193853, -95.49447570043557, 17.829834036319586, 18.843082888533942, 17.234728987754334, -27.257945684982413, -2.7978150681730836, -196.49418857256134, -160.10011914482666, 33.50000000000019, -33.19269216020086, -105.49295695165685, -13.226875635020129, -100.08724749804503, -174.59087218694006, -178.39050104924553, -45.77139017497987, -317.6233280743962, 73.86244113276432, -10.343336975315273, -230.66852619931134, -134.3867454293843, -225.54843440016995, 62.31527276938405, -85.59369048384116, -88.05843809829759, 82.26579050461145, -86.44803647980402, -135.64992321873243, -66.7443984302982, 51.462582012723686, -167.2391944198911, 53.78198455161219, -8.068571367200207, -414.9753492286705, -36.74172820983104, -346.51246239810945, -210.48340763302264, 32.599999999999994, -104.01366100746078, -108.67756624687215, 3.466729203543049, -152.11135943924302, -156.12349628848202, -91.52790665905793, 27.60678163178693, 20.90000000000003, 41.970581767287776, -112.83889761750261, 135.2, -121.45239517227972, -135.66227384970983, -75.62306395169954, -36.20363313228011, 20.000000000000014, 20.000000000000014, 20.000000000000014, -30.954174456125422, 20.908722367341895, -19.469588213014596, -49.132498891382404, -36.30947224431668, -42.786285149497054, -88.28740116894036, -5.064967535089375, -87.27804190039683, -222.26462930346813, -59.92096595580679, 79.39999999999984, -310.76006596675353, 17.03512603007598, -51.959165200877145, -53.515519847446335, -100.82283291899294, -171.39195006892706, -162.07269189347198, -5.067538200824263, -12.615650487799932, 23.318609892950143, -52.80475174214942, -125.14661103609868, -113.33784509251544, -47.4923484110584, 159.24340248114856, 76.91111708685824, 33.82436289450702, -193.4181728061421, 51.5000000000002, 54.20000000000019, -471.83676647050527, -7.910782258428782, -113.25163980799084, 24.253604275775853, -20.83786010127795, -22.88107165303709, 72.20000000000006, 6.19489188705451, 106.39999999999998, -196.56672219338887, -46.538373649416364, -11.657228333636063, -59.7011235905661, -15.779931263882638, -59.11890916971239, -23.394702659040437, 20.000000000000014, 23.60000000000001, -314.0145240286328, 161.13672032365005, 181.09999999999988, 8.565959643004385, -20.805497441827413, -207.82867987360999, 10.452991814554187, -51.35879632173413, -50.040043037786404, -219.06895680150276, 20.900000000000027, -105.5479141171333, -103.12716355396346, 20.000000000000014, -137.10786356741215, 93.48434488478759, -82.20718849186338, 22.17781285421547, -257.76772752780096, 31.98247722226351], "policy_predator_policy_reward": [118.46249731506404, 47.72284923259906, 12.723800171325628, 120.35467580711422, 82.664701118892, 169.11261495249516, 13.868162751217621, 448.08593150108123, 154.1836942155447, 38.801913167369854, 245.12049060607336, 150.96118901380942, 112.92669345939572, 85.63294997908669, 188.09708690917319, 153.1416934830361, 99.0880201177129, 364.5546316488554, 100.68711817652316, 144.4595197771162, 279.42686710505245, 325.8994712977214, 325.3312687075862, 117.13761649469514, 126.34334957979983, 159.98331967536387, 248.76594859192747, 156.2019553931081, 135.39677079009272, 36.70218126248734, 95.02559124496375, 142.67628230527123, 52.76772968705581, 207.14410897430665, 295.47107616287633, 138.91510235863353, 142.17164950142177, 99.4188022243804, 188.47456928067066, 325.71271115497586, 110.08552485756724, 45.43733862392933, 124.02037041020495, 85.70937117116648, 360.4553430034755, 191.38561873033805, 118.23704080479827, 251.78113463514723, 78.29406997411837, 95.41259516159639, 55.62385951767986, 137.31582027734473, 103.10182558585764, 295.3007937474135, 90.89522136416255, 34.83836288657162, 31.522251814411227, 134.2686658818926, 169.99432250157346, 3.42535625036333, 110.86750933541758, 1.970165963680401, 83.06642209730833, 54.0316741320965, 107.5373431202282, 251.22959493148286, 213.28126797901876, 11.735420361840433, 201.2908721869399, 288.0922460165248, 199.4049880105984, 287.03606142714943, 89.49865931149824, 264.80592651424456, 170.2078101119413, 220.38847367076508, 114.09264759368475, 101.7480364798036, 54.60597499635183, 254.93898423386344, 235.90559138355616, 67.66260178866148, 336.9458386157975, 462.7766578494659, 126.5099364889827, 174.55834370541453, 197.0762914020547, 197.22876772093403, 161.52790665905758, 206.41386437855755, 127.6575902386778, 18.210725611536507, 147.86227384970914, 136.25239517227888, 58.338233177233, 150.88003405037884, 52.70470696567925, 39.2514900053826, 54.77830420041318, 60.32378290398428, 40.877491088343945, 270.6515427980907, 116.46682036053068, 224.66680698052417, 255.94339832071722, 212.75127505474128, 65.869777079439, 196.08342940153105, 215.76180402694874, 242.27221857697936, 78.15904878983946, 47.92686201644532, 148.43454662286342, 288.04698674795634, 18.47677935397042, 107.7258996252519, 49.13680659790857, 243.5438646749116, 469.6293408902028, 111.67588267081786, 126.05163980799014, 121.68352474253412, 12.505108112945482, 60.28107165303723, 229.34151882990884, 120.2195148918814, 116.99027512824075, 164.51562098772263, 132.58729909733015, 78.89576683779936, 52.791134122421774, 332.90684509787604, 90.10549744182723, 37.03404035699561, 82.64306816418018, 202.6620664172413, 104.2568876280207, 328.7799969719103, 9.018469460468008, 188.45797233998582, 203.745866555873, 85.62461946360493, 51.45492036846373, 287.9998919699656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.466167331362303, "mean_inference_ms": 7.050024797546966, "mean_action_processing_ms": 5.313635349964689, "mean_env_wait_ms": 14.332404442191558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006516774495442708, "StateBufferConnector_ms": 0.01366734504699707, "ViewRequirementAgentConnector_ms": 2.8468453221850925}, "num_episodes": 0, "episode_return_max": 314.8648501361709, "episode_return_min": -51.023062653928164, "episode_return_mean": 141.96558897732515, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 53.87733058884582, "num_env_steps_trained_throughput_per_sec": 53.87733058884582, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 71275.139, "restore_workers_time_ms": 0.048, "training_step_time_ms": 71275.019, "sample_time_ms": 5017.607, "learn_time_ms": 66233.999, "learn_throughput": 60.392, "synch_weights_time_ms": 14.839}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 5, "trial_id": "62684_00000", "date": "2024-08-20_16-13-43", "timestamp": 1724150623, "time_this_iter_s": 74.3082811832428, "time_total_s": 356.8303689956665, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb0cca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 356.8303689956665, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 57.600952380952386, "ram_util_percent": 83.47428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.625366467300882, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.001770602895858, "policy_loss": -0.02127215839511259, "vf_loss": 6.020703716988259, "vf_explained_var": 0.21428005991252602, "kl": 0.011695234768228037, "entropy": 1.516406114388865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 15510.5, "diff_num_grad_updates_vs_sampler_policy": 1448.2749999999996}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5758667609048267, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.331195371365421, "policy_loss": -0.02210826506399643, "vf_loss": 5.350537324204016, "vf_explained_var": 0.12589739002878703, "kl": 0.013831547166777666, "entropy": 1.4803897987597834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999993}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 314.8648501361709, "episode_reward_min": -51.023062653928164, "episode_reward_mean": 141.96558897732515, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -471.83676647050527, "predator_policy": 1.970165963680401}, "policy_reward_max": {"prey_policy": 181.09999999999988, "predator_policy": 469.6293408902028}, "policy_reward_mean": {"prey_policy": -53.06735045739114, "predator_policy": 150.58382017474943}, "custom_metrics": {}, "hist_stats": {"episode_reward": [239.39999999999873, 236.74994898880283, 217.14705510872014, 158.82720098504595, 237.06021935752855, 91.43354607356503, 153.62362386129038, 264.9912644060712, -51.023062653928164, 218.05654402715612, 18.167664115262298, 171.21104871274454, 152.84765562075486, 78.07798241331217, 231.73991910211322, 205.8918305882458, 204.94484772782138, 172.05009715416762, 61.28443498712082, 221.61271656433036, 85.71708780497733, 160.89999999999918, 52.797357848307534, 213.498768370985, 276.32898156823455, 88.20022068068354, 203.39869695250914, 234.4110020022605, 178.4041175488934, 107.23260918067866, 54.01611652351733, 124.27706446400227, 35.672630334324175, 73.10416359398296, 36.31449746923505, 196.90877232113587, -21.094022778267224, 141.76943166807862, 123.59999999999809, 158.61321959390798, 182.04241193673815, 1.49295662865042, 19.171211553914564, 136.98286264041644, 147.89714972186184, 95.89999999999942, 162.19999999999916, 117.39157014363153, 101.00202251493437, 67.40872236734224, 144.14587532367983, 26.52598860210152, 177.4136414528967, 173.513647462721, 23.746547722537972, 131.7213320106102, 145.192325500056, 314.8648501361709, 184.58686136118405, 155.75767483208642, 137.899268917031, 128.29999999999956, 212.855937878985, 194.36761292787867, 148.9694541063758, 256.4201755153144, 295.9999999999992, 36.570650200632116, 184.82788476064073, 8.801364129357587, 163.53977884499008, 135.84737488710562], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.9505592127396914, -95.33590576040369, 167.59999999999985, 63.66042004021319, 13.711052970150647, 26.30000000000012, -180.43994011637525, 106.39298318012837, 39.41669597358029, -414.91705350262123, 30.679239838647092, 81.11092039672123, 102.79999999999953, -95.88637471308904, 37.16098668770449, -103.86103600010135, -248.19026526713506, 47.403167720918525, -158.08959829334876, 93.1535787161577, 20.000000000000014, 49.92077722248086, -48.54169348303614, -77.62659972558282, -291.4627409145269, -170.41495338825752, -52.78802011771328, -115.96579361462764, -39.9002923302152, 128.7759920183599, -43.8877390628111, -282.9994712977213, -260.2714639269774, -301.1001150979375, -63.95772139159729, 93.80000000000013, -3.4793103510531074, -169.79970328335432, 39.8000000000002, -82.29860767622809, 12.538070512519463, -257.1293844080145, 81.63168593139072, 67.69999999999996, -89.69071888185712, -2.8480170086340646, 25.945817473450568, -54.907843426805016, 20.000000000000014, -202.42799201557992, 127.46100108203946, 27.794405442340405, -311.9304868096805, 21.80000000000004, 20.900000000000013, -145.71491660608996, -55.49110013259194, -320.1691503077063, 101.46723825182775, -73.87265181543759, -42.64149901565241, -28.8373386239291, 1.6730619630637307, -92.26124419148248, 13.19990008784871, 30.231602522261966, -84.3811015965864, -294.1703902553279, -120.49211203359287, 75.80000000000007, -71.47147130319489, -160.84793576576536, 26.795525428550732, 142.3999999999998, -66.57320899603107, -30.331809266154206, -47.7277739093593, -26.679875938827923, 21.800000000000047, 60.50000000000018, -277.30392238076064, 40.23854732781016, 50.17723331028906, 18.261637113428392, -29.186800147409386, 21.80000000000004, 20.000000000000014, -114.17973951895635, 76.57464374963664, -28.58197380193853, -95.49447570043557, 17.829834036319586, 18.843082888533942, 17.234728987754334, -27.257945684982413, -2.7978150681730836, -196.49418857256134, -160.10011914482666, 33.50000000000019, -33.19269216020086, -105.49295695165685, -13.226875635020129, -100.08724749804503, -174.59087218694006, -178.39050104924553, -45.77139017497987, -317.6233280743962, 73.86244113276432, -10.343336975315273, -230.66852619931134, -134.3867454293843, -225.54843440016995, 62.31527276938405, -85.59369048384116, -88.05843809829759, 82.26579050461145, -86.44803647980402, -135.64992321873243, -66.7443984302982, 51.462582012723686, -167.2391944198911, 53.78198455161219, -8.068571367200207, -414.9753492286705, -36.74172820983104, -346.51246239810945, -210.48340763302264, 32.599999999999994, -104.01366100746078, -108.67756624687215, 3.466729203543049, -152.11135943924302, -156.12349628848202, -91.52790665905793, 27.60678163178693, 20.90000000000003, 41.970581767287776, -112.83889761750261, 135.2, -121.45239517227972, -135.66227384970983, -75.62306395169954, -36.20363313228011, 20.000000000000014, 20.000000000000014, 20.000000000000014, -30.954174456125422, 20.908722367341895, -19.469588213014596, -49.132498891382404, -36.30947224431668, -42.786285149497054, -88.28740116894036, -5.064967535089375, -87.27804190039683, -222.26462930346813, -59.92096595580679, 79.39999999999984, -310.76006596675353, 17.03512603007598, -51.959165200877145, -53.515519847446335, -100.82283291899294, -171.39195006892706, -162.07269189347198, -5.067538200824263, -12.615650487799932, 23.318609892950143, -52.80475174214942, -125.14661103609868, -113.33784509251544, -47.4923484110584, 159.24340248114856, 76.91111708685824, 33.82436289450702, -193.4181728061421, 51.5000000000002, 54.20000000000019, -471.83676647050527, -7.910782258428782, -113.25163980799084, 24.253604275775853, -20.83786010127795, -22.88107165303709, 72.20000000000006, 6.19489188705451, 106.39999999999998, -196.56672219338887, -46.538373649416364, -11.657228333636063, -59.7011235905661, -15.779931263882638, -59.11890916971239, -23.394702659040437, 20.000000000000014, 23.60000000000001, -314.0145240286328, 161.13672032365005, 181.09999999999988, 8.565959643004385, -20.805497441827413, -207.82867987360999, 10.452991814554187, -51.35879632173413, -50.040043037786404, -219.06895680150276, 20.900000000000027, -105.5479141171333, -103.12716355396346, 20.000000000000014, -137.10786356741215, 93.48434488478759, -82.20718849186338, 22.17781285421547, -257.76772752780096, 31.98247722226351], "policy_predator_policy_reward": [118.46249731506404, 47.72284923259906, 12.723800171325628, 120.35467580711422, 82.664701118892, 169.11261495249516, 13.868162751217621, 448.08593150108123, 154.1836942155447, 38.801913167369854, 245.12049060607336, 150.96118901380942, 112.92669345939572, 85.63294997908669, 188.09708690917319, 153.1416934830361, 99.0880201177129, 364.5546316488554, 100.68711817652316, 144.4595197771162, 279.42686710505245, 325.8994712977214, 325.3312687075862, 117.13761649469514, 126.34334957979983, 159.98331967536387, 248.76594859192747, 156.2019553931081, 135.39677079009272, 36.70218126248734, 95.02559124496375, 142.67628230527123, 52.76772968705581, 207.14410897430665, 295.47107616287633, 138.91510235863353, 142.17164950142177, 99.4188022243804, 188.47456928067066, 325.71271115497586, 110.08552485756724, 45.43733862392933, 124.02037041020495, 85.70937117116648, 360.4553430034755, 191.38561873033805, 118.23704080479827, 251.78113463514723, 78.29406997411837, 95.41259516159639, 55.62385951767986, 137.31582027734473, 103.10182558585764, 295.3007937474135, 90.89522136416255, 34.83836288657162, 31.522251814411227, 134.2686658818926, 169.99432250157346, 3.42535625036333, 110.86750933541758, 1.970165963680401, 83.06642209730833, 54.0316741320965, 107.5373431202282, 251.22959493148286, 213.28126797901876, 11.735420361840433, 201.2908721869399, 288.0922460165248, 199.4049880105984, 287.03606142714943, 89.49865931149824, 264.80592651424456, 170.2078101119413, 220.38847367076508, 114.09264759368475, 101.7480364798036, 54.60597499635183, 254.93898423386344, 235.90559138355616, 67.66260178866148, 336.9458386157975, 462.7766578494659, 126.5099364889827, 174.55834370541453, 197.0762914020547, 197.22876772093403, 161.52790665905758, 206.41386437855755, 127.6575902386778, 18.210725611536507, 147.86227384970914, 136.25239517227888, 58.338233177233, 150.88003405037884, 52.70470696567925, 39.2514900053826, 54.77830420041318, 60.32378290398428, 40.877491088343945, 270.6515427980907, 116.46682036053068, 224.66680698052417, 255.94339832071722, 212.75127505474128, 65.869777079439, 196.08342940153105, 215.76180402694874, 242.27221857697936, 78.15904878983946, 47.92686201644532, 148.43454662286342, 288.04698674795634, 18.47677935397042, 107.7258996252519, 49.13680659790857, 243.5438646749116, 469.6293408902028, 111.67588267081786, 126.05163980799014, 121.68352474253412, 12.505108112945482, 60.28107165303723, 229.34151882990884, 120.2195148918814, 116.99027512824075, 164.51562098772263, 132.58729909733015, 78.89576683779936, 52.791134122421774, 332.90684509787604, 90.10549744182723, 37.03404035699561, 82.64306816418018, 202.6620664172413, 104.2568876280207, 328.7799969719103, 9.018469460468008, 188.45797233998582, 203.745866555873, 85.62461946360493, 51.45492036846373, 287.9998919699656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.466167331362303, "mean_inference_ms": 7.050024797546966, "mean_action_processing_ms": 5.313635349964689, "mean_env_wait_ms": 14.332404442191558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006516774495442708, "StateBufferConnector_ms": 0.01366734504699707, "ViewRequirementAgentConnector_ms": 2.8468453221850925}, "num_episodes": 0, "episode_return_max": 314.8648501361709, "episode_return_min": -51.023062653928164, "episode_return_mean": 141.96558897732515, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.09546329461683, "num_env_steps_trained_throughput_per_sec": 55.09546329461683, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 71496.161, "restore_workers_time_ms": 0.043, "training_step_time_ms": 71496.053, "sample_time_ms": 4848.637, "learn_time_ms": 66624.892, "learn_throughput": 60.038, "synch_weights_time_ms": 14.698}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 6, "trial_id": "62684_00000", "date": "2024-08-20_16-14-56", "timestamp": 1724150696, "time_this_iter_s": 72.66593265533447, "time_total_s": 429.496301651001, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fad4040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 429.496301651001, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 55.91165048543688, "ram_util_percent": 83.38252427184464}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.306083136987179, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.211507671775547, "policy_loss": -0.02163149007110599, "vf_loss": 6.2306547831136285, "vf_explained_var": 0.2175034632285436, "kl": 0.012421947872309106, "entropy": 1.4877601203343547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 18330.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7000667898743242, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.3071496037579085, "policy_loss": -0.02337507824967837, "vf_loss": 5.327571107218505, "vf_explained_var": 0.1660968432981501, "kl": 0.014767921867869085, "entropy": 1.4424916211259429, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "env_runners": {"episode_reward_max": 390.9354373723189, "episode_reward_min": -21.094022778267224, "episode_reward_mean": 155.54364351749552, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -471.83676647050527, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.54521165761588, "predator_policy": 469.6293408902028}, "policy_reward_mean": {"prey_policy": -39.67881514656745, "predator_policy": 137.29004447859913}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.71708780497733, 160.89999999999918, 52.797357848307534, 213.498768370985, 276.32898156823455, 88.20022068068354, 203.39869695250914, 234.4110020022605, 178.4041175488934, 107.23260918067866, 54.01611652351733, 124.27706446400227, 35.672630334324175, 73.10416359398296, 36.31449746923505, 196.90877232113587, -21.094022778267224, 141.76943166807862, 123.59999999999809, 158.61321959390798, 182.04241193673815, 1.49295662865042, 19.171211553914564, 136.98286264041644, 147.89714972186184, 95.89999999999942, 162.19999999999916, 117.39157014363153, 101.00202251493437, 67.40872236734224, 144.14587532367983, 26.52598860210152, 177.4136414528967, 173.513647462721, 23.746547722537972, 131.7213320106102, 145.192325500056, 314.8648501361709, 184.58686136118405, 155.75767483208642, 137.899268917031, 128.29999999999956, 212.855937878985, 194.36761292787867, 148.9694541063758, 256.4201755153144, 295.9999999999992, 36.570650200632116, 184.82788476064073, 8.801364129357587, 163.53977884499008, 135.84737488710562, 256.3434671032626, 150.76168315624278, 140.24405209833913, 150.72166338050008, 70.47920930792112, 177.18113146870732, 302.293950404243, 198.44047468937936, 85.07407827921809, 146.7999999999986, 73.43681437422794, 222.84521165761493, 94.14318769893558, 196.25509707835315, 262.0863361006752, 98.05253115903906, 73.86100760315892, 326.8384198740485, 154.69361160511224, 123.14146057018309, 272.6373521736428, 307.8000000000003, 99.02845278398254, 266.1721888377332, 35.65943810583523, 238.41173270480243, 65.62010733127721, 93.5372652993951, 121.12227682952395, 390.9354373723189, 210.2969784453231, 203.4901112462478, 106.37139658916183, 252.2554391510107, 272.1550562241513, 92.52644628835264, 181.90765054313516, 209.03172027630956, 297.89999999999964, 282.0070274097544, 92.05936531388755, 87.09999999999968, 217.02387633257774, 132.55886562152546, 268.32899121839137, 151.20138763422372, 154.07051108730707, 212.03402009323077], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-42.64149901565241, -28.8373386239291, 1.6730619630637307, -92.26124419148248, 13.19990008784871, 30.231602522261966, -84.3811015965864, -294.1703902553279, -120.49211203359287, 75.80000000000007, -71.47147130319489, -160.84793576576536, 26.795525428550732, 142.3999999999998, -66.57320899603107, -30.331809266154206, -47.7277739093593, -26.679875938827923, 21.800000000000047, 60.50000000000018, -277.30392238076064, 40.23854732781016, 50.17723331028906, 18.261637113428392, -29.186800147409386, 21.80000000000004, 20.000000000000014, -114.17973951895635, 76.57464374963664, -28.58197380193853, -95.49447570043557, 17.829834036319586, 18.843082888533942, 17.234728987754334, -27.257945684982413, -2.7978150681730836, -196.49418857256134, -160.10011914482666, 33.50000000000019, -33.19269216020086, -105.49295695165685, -13.226875635020129, -100.08724749804503, -174.59087218694006, -178.39050104924553, -45.77139017497987, -317.6233280743962, 73.86244113276432, -10.343336975315273, -230.66852619931134, -134.3867454293843, -225.54843440016995, 62.31527276938405, -85.59369048384116, -88.05843809829759, 82.26579050461145, -86.44803647980402, -135.64992321873243, -66.7443984302982, 51.462582012723686, -167.2391944198911, 53.78198455161219, -8.068571367200207, -414.9753492286705, -36.74172820983104, -346.51246239810945, -210.48340763302264, 32.599999999999994, -104.01366100746078, -108.67756624687215, 3.466729203543049, -152.11135943924302, -156.12349628848202, -91.52790665905793, 27.60678163178693, 20.90000000000003, 41.970581767287776, -112.83889761750261, 135.2, -121.45239517227972, -135.66227384970983, -75.62306395169954, -36.20363313228011, 20.000000000000014, 20.000000000000014, 20.000000000000014, -30.954174456125422, 20.908722367341895, -19.469588213014596, -49.132498891382404, -36.30947224431668, -42.786285149497054, -88.28740116894036, -5.064967535089375, -87.27804190039683, -222.26462930346813, -59.92096595580679, 79.39999999999984, -310.76006596675353, 17.03512603007598, -51.959165200877145, -53.515519847446335, -100.82283291899294, -171.39195006892706, -162.07269189347198, -5.067538200824263, -12.615650487799932, 23.318609892950143, -52.80475174214942, -125.14661103609868, -113.33784509251544, -47.4923484110584, 159.24340248114856, 76.91111708685824, 33.82436289450702, -193.4181728061421, 51.5000000000002, 54.20000000000019, -471.83676647050527, -7.910782258428782, -113.25163980799084, 24.253604275775853, -20.83786010127795, -22.88107165303709, 72.20000000000006, 6.19489188705451, 106.39999999999998, -196.56672219338887, -46.538373649416364, -11.657228333636063, -59.7011235905661, -15.779931263882638, -59.11890916971239, -23.394702659040437, 20.000000000000014, 23.60000000000001, -314.0145240286328, 161.13672032365005, 181.09999999999988, 8.565959643004385, -20.805497441827413, -207.82867987360999, 10.452991814554187, -51.35879632173413, -50.040043037786404, -219.06895680150276, 20.900000000000027, -105.5479141171333, -103.12716355396346, 20.000000000000014, -137.10786356741215, 93.48434488478759, -82.20718849186338, 22.17781285421547, -257.76772752780096, 31.98247722226351, -110.54655313143616, 188.3, -87.07570887795399, -29.4091948823483, 44.300000000000075, -60.684846775958036, -18.490879940151103, -40.83532990993657, 88.70770800822166, -42.42823145836938, -122.57168840137513, -30.89961858346416, 7.661044540028309, 5.7335767079771225, -346.31770734473525, 5.516089087533848, -276.8291585764795, 109.00775936328996, 124.07839809706496, 20.000000000000014, 47.47029919396493, 98.84581643750182, -47.57429240357906, 45.20000000000022, -146.00526020964162, -100.59915264180866, -129.3604283798918, 16.80920403757159, 76.08306576560874, -212.099036283678, -28.716324598169265, -287.8086915468139, -85.0688613416427, -3.62326448021423, 194.54521165761588, -273.11323985186425, -93.76930959114615, -60.38429160040482, -228.62552858704825, 21.88187464444011, 16.125658041704792, -83.6007647380778, -128.89951478876748, 79.27389697379544, 111.67688938664209, -27.60688322213909, 20.000000000000014, -180.9815968766647, 13.680189319421213, -24.358157261152044, 20.000000000000014, -121.34783554993885, 170.72167939919126, -24.860361262790306, 20.000000000000014, -46.012630049953664, -21.803721494898447, -135.09431934469652, 17.550299879231048, -265.8295377723307, 171.48038224846536, -15.971398966097924, 54.20000000000017, 9.299366350648318, 192.79999999999995, 4.625444977935786, 63.5564937765791, -83.08788534816763, -53.98331211930067, -55.05664987562295, -17.13845961278189, 19.29817444946241, -102.1899353002453, 56.96213452366074, -114.74237376474154, 107.03263687480506, 20.000000000000014, 12.949764412732327, -69.31935969107937, -25.834199335715642, 20.000000000000014, 22.112528577778413, -17.779238172454054, -179.90742180826675, -81.2278030104934, -36.97591720783456, 20.000000000000014, 63.7143781275754, 73.42422072412339, 107.29999999999998, -64.75810889109393, -50.59733814568897, 36.75723913700331, 10.50880426413592, -49.101646496234586, -141.76768717422576, -107.99892089615196, -75.87004872492756, 20.000000000000014, -32.43323062263858, -34.52598411857105, 143.50913505386748, 135.2, -31.829546876953508, -83.31127861677135, 10.883886443372617, -16.39319731607596, -18.36273764541594, 102.59118479103658, 21.80000000000004, -31.716351205220228, 117.86359137700795, 36.441478839127775, -116.77566544285644, -1.5090021093395762, 47.57710508384308, -34.83830358390473, -60.20414969309685, 129.55841978400673, -23.623475511620406, 35.9681018239806, -216.8354489486786, 20.000000000000014, -195.79302897230062, 20.9152401594396, -96.28904575661005, -154.2136525607715, 120.32325447945209, -30.226452105324306, 14.988267285833789, -104.79240691434815, -109.4532081129021, -0.7437910279948685, -143.7414375279006, -8.423608385634779, 6.1339197175724545, -167.22016585195703, -98.38910649078639, -31.985102568313692, 4.763529979867231, -139.99160238742977, -29.678777994048183, 35.513127614500554, 20.000000000000014], "policy_predator_policy_reward": [110.08552485756724, 45.43733862392933, 124.02037041020495, 85.70937117116648, 360.4553430034755, 191.38561873033805, 118.23704080479827, 251.78113463514723, 78.29406997411837, 95.41259516159639, 55.62385951767986, 137.31582027734473, 103.10182558585764, 295.3007937474135, 90.89522136416255, 34.83836288657162, 31.522251814411227, 134.2686658818926, 169.99432250157346, 3.42535625036333, 110.86750933541758, 1.970165963680401, 83.06642209730833, 54.0316741320965, 107.5373431202282, 251.22959493148286, 213.28126797901876, 11.735420361840433, 201.2908721869399, 288.0922460165248, 199.4049880105984, 287.03606142714943, 89.49865931149824, 264.80592651424456, 170.2078101119413, 220.38847367076508, 114.09264759368475, 101.7480364798036, 54.60597499635183, 254.93898423386344, 235.90559138355616, 67.66260178866148, 336.9458386157975, 462.7766578494659, 126.5099364889827, 174.55834370541453, 197.0762914020547, 197.22876772093403, 161.52790665905758, 206.41386437855755, 127.6575902386778, 18.210725611536507, 147.86227384970914, 136.25239517227888, 58.338233177233, 150.88003405037884, 52.70470696567925, 39.2514900053826, 54.77830420041318, 60.32378290398428, 40.877491088343945, 270.6515427980907, 116.46682036053068, 224.66680698052417, 255.94339832071722, 212.75127505474128, 65.869777079439, 196.08342940153105, 215.76180402694874, 242.27221857697936, 78.15904878983946, 47.92686201644532, 148.43454662286342, 288.04698674795634, 18.47677935397042, 107.7258996252519, 49.13680659790857, 243.5438646749116, 469.6293408902028, 111.67588267081786, 126.05163980799014, 121.68352474253412, 12.505108112945482, 60.28107165303723, 229.34151882990884, 120.2195148918814, 116.99027512824075, 164.51562098772263, 132.58729909733015, 78.89576683779936, 52.791134122421774, 332.90684509787604, 90.10549744182723, 37.03404035699561, 82.64306816418018, 202.6620664172413, 104.2568876280207, 328.7799969719103, 9.018469460468008, 188.45797233998582, 203.745866555873, 85.62461946360493, 51.45492036846373, 287.9998919699656, 141.31917598121743, 124.34655313143537, 112.63751367187518, 83.91821114267493, 74.77167400005574, 36.090879940151275, 157.47168840137502, 189.14951342233425, 359.63172396314, 43.77057144151192, 285.8873152800486, 53.59912631431473, 30.475745025229, 80.26950808798381, 36.84881469279618, 65.12013596266173, 245.51272814851407, 215.52619136204544, 28.307730196819804, 237.69903628367777, 350.39014276045066, 124.64054910040379, 280.81323985186395, 24.223264480214187, 125.99345307101348, 350.9288644065216, 82.30871044500374, 159.53961868528415, 124.46325792887849, 75.57180660012597, 47.17091563379115, 239.4700956240526, 33.093094585837875, 31.445880959052147, 149.30938347377918, 153.01555381380783, 76.66976101604382, 125.8402021339219, 357.6903159888372, 148.82470181914434, 12.8931653912457, 50.03520350003029, 87.10063364935183, 13.974555022064182, 70.68331211930045, 101.85984435557248, 191.35917254008058, 127.70995133659542, 119.81606519136707, 75.81354745579297, 47.56736312519494, 50.861968292071474, 93.22612788084132, 47.547538477230866, 78.80975747379276, 190.30163922854572, 64.6949357534522, 154.63106129440004, 65.60336119811161, 80.89347732250862, 211.0625347207741, 77.83265162432967, 249.03809056977016, 134.81255008280314, 134.20669495816492, 136.0336712520766, 69.0554295376022, 106.65008930075165, 77.26836590130195, 174.82751581657413, 52.082381249845625, 64.31611355662737, 0.0, 89.23281695731986, 159.38994041125397, 12.11237509177638, 106.79326397641793, 179.8769366329835, 144.93291186074, 91.34332096972538, 29.193755430338584, 223.73295700824795, 249.07778881286106, 109.18904575661014, 143.11157311376274, 138.02915340545897, 204.94362038364739, 126.87259297929516, 99.86744657209633, 321.3703815878255, 171.16699893133296, 239.50974132806178, 109.02260939986606, 212.26107666331745, 41.01654167498809, 145.18312879779157]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.13529715404177, "mean_inference_ms": 6.373079230170975, "mean_action_processing_ms": 4.6639979301594074, "mean_env_wait_ms": 15.189563191766531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025081992149353027, "StateBufferConnector_ms": 0.008330106735229492, "ViewRequirementAgentConnector_ms": 2.1555745601654053}, "num_episodes": 48, "episode_return_max": 390.9354373723189, "episode_return_min": -21.094022778267224, "episode_return_mean": 155.54364351749552, "episodes_this_iter": 48}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.4840474768281, "num_env_steps_trained_throughput_per_sec": 56.4840474768281, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 71399.062, "restore_workers_time_ms": 0.039, "training_step_time_ms": 71398.962, "sample_time_ms": 4790.581, "learn_time_ms": 66584.714, "learn_throughput": 60.074, "synch_weights_time_ms": 14.92}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "training_iteration": 7, "trial_id": "62684_00000", "date": "2024-08-20_16-16-07", "timestamp": 1724150767, "time_this_iter_s": 70.89591407775879, "time_total_s": 500.39221572875977, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb12ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 500.39221572875977, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 54.41400000000001, "ram_util_percent": 83.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.33784677145329, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.55018063200281, "policy_loss": -0.024311354247291105, "vf_loss": 6.571815712401207, "vf_explained_var": 0.28850592958166243, "kl": 0.013381339914119201, "entropy": 1.4336865715523983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 21150.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.213282874305412, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.281532608012043, "policy_loss": -0.02437731664191695, "vf_loss": 6.302722911733799, "vf_explained_var": 0.1569217032541043, "kl": 0.015935088268594532, "entropy": 1.354810953518701, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 392.7495388848546, "episode_reward_min": 8.801364129357587, "episode_reward_mean": 180.56265417686552, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -471.83676647050527, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.54521165761588, "predator_policy": 469.6293408902028}, "policy_reward_mean": {"prey_policy": -32.69949519975562, "predator_policy": 139.3305698880664}, "custom_metrics": {}, "hist_stats": {"episode_reward": [147.89714972186184, 95.89999999999942, 162.19999999999916, 117.39157014363153, 101.00202251493437, 67.40872236734224, 144.14587532367983, 26.52598860210152, 177.4136414528967, 173.513647462721, 23.746547722537972, 131.7213320106102, 145.192325500056, 314.8648501361709, 184.58686136118405, 155.75767483208642, 137.899268917031, 128.29999999999956, 212.855937878985, 194.36761292787867, 148.9694541063758, 256.4201755153144, 295.9999999999992, 36.570650200632116, 184.82788476064073, 8.801364129357587, 163.53977884499008, 135.84737488710562, 256.3434671032626, 150.76168315624278, 140.24405209833913, 150.72166338050008, 70.47920930792112, 177.18113146870732, 302.293950404243, 198.44047468937936, 85.07407827921809, 146.7999999999986, 73.43681437422794, 222.84521165761493, 94.14318769893558, 196.25509707835315, 262.0863361006752, 98.05253115903906, 73.86100760315892, 326.8384198740485, 154.69361160511224, 123.14146057018309, 272.6373521736428, 307.8000000000003, 99.02845278398254, 266.1721888377332, 35.65943810583523, 238.41173270480243, 65.62010733127721, 93.5372652993951, 121.12227682952395, 390.9354373723189, 210.2969784453231, 203.4901112462478, 106.37139658916183, 252.2554391510107, 272.1550562241513, 92.52644628835264, 181.90765054313516, 209.03172027630956, 297.89999999999964, 282.0070274097544, 92.05936531388755, 87.09999999999968, 217.02387633257774, 132.55886562152546, 268.32899121839137, 151.20138763422372, 154.07051108730707, 212.03402009323077, 333.133041318261, 276.076980311634, 219.85371190694454, 242.94047130743002, 141.36602076313764, 195.8400255243281, 172.91452327445242, 231.4431871506039, 174.69423366564277, 277.12657115190746, 255.43678032162518, 158.2999999999988, 276.51977722129504, 392.7495388848546, 87.08340365990821, 163.2999999999994, 198.57283384723263, 226.87753880674416, 186.07006255306112, 351.74947015104675, 198.47736806313804, 301.0874957993891, 186.98540754383376, 117.06278061770138], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-156.12349628848202, -91.52790665905793, 27.60678163178693, 20.90000000000003, 41.970581767287776, -112.83889761750261, 135.2, -121.45239517227972, -135.66227384970983, -75.62306395169954, -36.20363313228011, 20.000000000000014, 20.000000000000014, 20.000000000000014, -30.954174456125422, 20.908722367341895, -19.469588213014596, -49.132498891382404, -36.30947224431668, -42.786285149497054, -88.28740116894036, -5.064967535089375, -87.27804190039683, -222.26462930346813, -59.92096595580679, 79.39999999999984, -310.76006596675353, 17.03512603007598, -51.959165200877145, -53.515519847446335, -100.82283291899294, -171.39195006892706, -162.07269189347198, -5.067538200824263, -12.615650487799932, 23.318609892950143, -52.80475174214942, -125.14661103609868, -113.33784509251544, -47.4923484110584, 159.24340248114856, 76.91111708685824, 33.82436289450702, -193.4181728061421, 51.5000000000002, 54.20000000000019, -471.83676647050527, -7.910782258428782, -113.25163980799084, 24.253604275775853, -20.83786010127795, -22.88107165303709, 72.20000000000006, 6.19489188705451, 106.39999999999998, -196.56672219338887, -46.538373649416364, -11.657228333636063, -59.7011235905661, -15.779931263882638, -59.11890916971239, -23.394702659040437, 20.000000000000014, 23.60000000000001, -314.0145240286328, 161.13672032365005, 181.09999999999988, 8.565959643004385, -20.805497441827413, -207.82867987360999, 10.452991814554187, -51.35879632173413, -50.040043037786404, -219.06895680150276, 20.900000000000027, -105.5479141171333, -103.12716355396346, 20.000000000000014, -137.10786356741215, 93.48434488478759, -82.20718849186338, 22.17781285421547, -257.76772752780096, 31.98247722226351, -110.54655313143616, 188.3, -87.07570887795399, -29.4091948823483, 44.300000000000075, -60.684846775958036, -18.490879940151103, -40.83532990993657, 88.70770800822166, -42.42823145836938, -122.57168840137513, -30.89961858346416, 7.661044540028309, 5.7335767079771225, -346.31770734473525, 5.516089087533848, -276.8291585764795, 109.00775936328996, 124.07839809706496, 20.000000000000014, 47.47029919396493, 98.84581643750182, -47.57429240357906, 45.20000000000022, -146.00526020964162, -100.59915264180866, -129.3604283798918, 16.80920403757159, 76.08306576560874, -212.099036283678, -28.716324598169265, -287.8086915468139, -85.0688613416427, -3.62326448021423, 194.54521165761588, -273.11323985186425, -93.76930959114615, -60.38429160040482, -228.62552858704825, 21.88187464444011, 16.125658041704792, -83.6007647380778, -128.89951478876748, 79.27389697379544, 111.67688938664209, -27.60688322213909, 20.000000000000014, -180.9815968766647, 13.680189319421213, -24.358157261152044, 20.000000000000014, -121.34783554993885, 170.72167939919126, -24.860361262790306, 20.000000000000014, -46.012630049953664, -21.803721494898447, -135.09431934469652, 17.550299879231048, -265.8295377723307, 171.48038224846536, -15.971398966097924, 54.20000000000017, 9.299366350648318, 192.79999999999995, 4.625444977935786, 63.5564937765791, -83.08788534816763, -53.98331211930067, -55.05664987562295, -17.13845961278189, 19.29817444946241, -102.1899353002453, 56.96213452366074, -114.74237376474154, 107.03263687480506, 20.000000000000014, 12.949764412732327, -69.31935969107937, -25.834199335715642, 20.000000000000014, 22.112528577778413, -17.779238172454054, -179.90742180826675, -81.2278030104934, -36.97591720783456, 20.000000000000014, 63.7143781275754, 73.42422072412339, 107.29999999999998, -64.75810889109393, -50.59733814568897, 36.75723913700331, 10.50880426413592, -49.101646496234586, -141.76768717422576, -107.99892089615196, -75.87004872492756, 20.000000000000014, -32.43323062263858, -34.52598411857105, 143.50913505386748, 135.2, -31.829546876953508, -83.31127861677135, 10.883886443372617, -16.39319731607596, -18.36273764541594, 102.59118479103658, 21.80000000000004, -31.716351205220228, 117.86359137700795, 36.441478839127775, -116.77566544285644, -1.5090021093395762, 47.57710508384308, -34.83830358390473, -60.20414969309685, 129.55841978400673, -23.623475511620406, 35.9681018239806, -216.8354489486786, 20.000000000000014, -195.79302897230062, 20.9152401594396, -96.28904575661005, -154.2136525607715, 120.32325447945209, -30.226452105324306, 14.988267285833789, -104.79240691434815, -109.4532081129021, -0.7437910279948685, -143.7414375279006, -8.423608385634779, 6.1339197175724545, -167.22016585195703, -98.38910649078639, -31.985102568313692, 4.763529979867231, -139.99160238742977, -29.678777994048183, 35.513127614500554, 20.000000000000014, 96.6868065578117, -196.57913160045038, 77.22395568010397, -139.7995082335016, -47.088225627260684, -30.69746697848768, 30.365798676204893, -231.517539847852, 20.00772252926134, 22.5622351209299, 87.43434920716228, -206.19781487155493, -47.089783798030794, -172.25481077026464, 70.9480864676492, -146.39334919605994, 36.831132708644816, 5.174032150870041, -26.853199526854926, -197.0915465482398, 101.03479024774406, 35.17953049136801, -70.46329031015092, -33.63490521881863, -163.74508279397963, -56.672111680934066, -3.4134151074049273, -164.2463658249314, 75.20790549658324, -76.9746683938569, -118.04324973967242, 125.54231772860727, 18.55533674815988, 40.427798257411524, -44.865907461477846, -6.802879410556584, -153.50566171700137, 191.74380381880093, -119.52439693139792, 175.90839067152024, -224.42668538041428, 147.9391545727608, 36.360257965334284, -194.95421471248932, -26.207040098928303, -19.005611057581085, -127.61568597120663, 28.1, 20.000000000000014, -38.27935478623623, 99.80373211169785, -283.85123336435754, 61.782454652459265, 79.39999999999938, 2.5582793261988046, -135.22603143944804, -243.7740006736462, 111.3309306066955, 21.01342033452371, 85.78770701534785, 12.697942919241171, -82.65025399216755, 36.00674181271617, 106.55542139205174, 14.237045649318835, -50.754243148914014, -113.24098469765902, -233.17010458492948, -1.4108525069358233, 7.175193486355946, -315.84080131673693, 24.23628223865377], "policy_predator_policy_reward": [161.52790665905758, 206.41386437855755, 127.6575902386778, 18.210725611536507, 147.86227384970914, 136.25239517227888, 58.338233177233, 150.88003405037884, 52.70470696567925, 39.2514900053826, 54.77830420041318, 60.32378290398428, 40.877491088343945, 270.6515427980907, 116.46682036053068, 224.66680698052417, 255.94339832071722, 212.75127505474128, 65.869777079439, 196.08342940153105, 215.76180402694874, 242.27221857697936, 78.15904878983946, 47.92686201644532, 148.43454662286342, 288.04698674795634, 18.47677935397042, 107.7258996252519, 49.13680659790857, 243.5438646749116, 469.6293408902028, 111.67588267081786, 126.05163980799014, 121.68352474253412, 12.505108112945482, 60.28107165303723, 229.34151882990884, 120.2195148918814, 116.99027512824075, 164.51562098772263, 132.58729909733015, 78.89576683779936, 52.791134122421774, 332.90684509787604, 90.10549744182723, 37.03404035699561, 82.64306816418018, 202.6620664172413, 104.2568876280207, 328.7799969719103, 9.018469460468008, 188.45797233998582, 203.745866555873, 85.62461946360493, 51.45492036846373, 287.9998919699656, 141.31917598121743, 124.34655313143537, 112.63751367187518, 83.91821114267493, 74.77167400005574, 36.090879940151275, 157.47168840137502, 189.14951342233425, 359.63172396314, 43.77057144151192, 285.8873152800486, 53.59912631431473, 30.475745025229, 80.26950808798381, 36.84881469279618, 65.12013596266173, 245.51272814851407, 215.52619136204544, 28.307730196819804, 237.69903628367777, 350.39014276045066, 124.64054910040379, 280.81323985186395, 24.223264480214187, 125.99345307101348, 350.9288644065216, 82.30871044500374, 159.53961868528415, 124.46325792887849, 75.57180660012597, 47.17091563379115, 239.4700956240526, 33.093094585837875, 31.445880959052147, 149.30938347377918, 153.01555381380783, 76.66976101604382, 125.8402021339219, 357.6903159888372, 148.82470181914434, 12.8931653912457, 50.03520350003029, 87.10063364935183, 13.974555022064182, 70.68331211930045, 101.85984435557248, 191.35917254008058, 127.70995133659542, 119.81606519136707, 75.81354745579297, 47.56736312519494, 50.861968292071474, 93.22612788084132, 47.547538477230866, 78.80975747379276, 190.30163922854572, 64.6949357534522, 154.63106129440004, 65.60336119811161, 80.89347732250862, 211.0625347207741, 77.83265162432967, 249.03809056977016, 134.81255008280314, 134.20669495816492, 136.0336712520766, 69.0554295376022, 106.65008930075165, 77.26836590130195, 174.82751581657413, 52.082381249845625, 64.31611355662737, 0.0, 89.23281695731986, 159.38994041125397, 12.11237509177638, 106.79326397641793, 179.8769366329835, 144.93291186074, 91.34332096972538, 29.193755430338584, 223.73295700824795, 249.07778881286106, 109.18904575661014, 143.11157311376274, 138.02915340545897, 204.94362038364739, 126.87259297929516, 99.86744657209633, 321.3703815878255, 171.16699893133296, 239.50974132806178, 109.02260939986606, 212.26107666331745, 41.01654167498809, 145.18312879779157, 295.31557733599817, 60.48583334479573, 253.44185891791864, 240.22032223296526, 168.70183277247887, 232.29589777685288, 127.27854450040972, 211.8631573504839, 73.9801622882097, 215.78236657557483, 120.77686220654893, 179.45134765432437, 199.5953068306333, 96.22917227117001, 276.4529303329315, 23.90892185527437, 186.65182596201345, 211.87301728594852, 172.3497382553377, 270.78996161877495, 113.67974448776354, 115.7026310967668, 116.31801841294066, 53.222970201682195, 262.9303897247121, 94.87564232618149, 52.465339087310504, 240.86333993367663, 79.98080389719144, 191.90359660880011, 140.605611057581, 141.21568597120586, 49.30007095519304, 67.74838556657882, 108.87297283038089, 260.67334468826294, 206.6977172866847, 355.81409805327166, 10.213801997180802, 123.40361019729855, 171.09587215512286, 61.32706516822522, 157.5864970388576, 73.46277486807419, 184.87809945188073, 349.9292498814777, 252.48994549630885, 149.0021607131211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.701862497195611, "mean_inference_ms": 6.431388787678678, "mean_action_processing_ms": 3.9860289582472945, "mean_env_wait_ms": 15.572233564887823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026030302047729492, "StateBufferConnector_ms": 0.00789034366607666, "ViewRequirementAgentConnector_ms": 2.177240014076233}, "num_episodes": 24, "episode_return_max": 392.7495388848546, "episode_return_min": 8.801364129357587, "episode_return_mean": 180.56265417686552, "episodes_this_iter": 24}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 57.21609127675987, "num_env_steps_trained_throughput_per_sec": 57.21609127675987, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 71212.981, "restore_workers_time_ms": 0.036, "training_step_time_ms": 71212.887, "sample_time_ms": 4733.535, "learn_time_ms": 66456.035, "learn_throughput": 60.19, "synch_weights_time_ms": 14.854}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 8, "trial_id": "62684_00000", "date": "2024-08-20_16-17-17", "timestamp": 1724150837, "time_this_iter_s": 69.96555495262146, "time_total_s": 570.3577706813812, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb0ce50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 570.3577706813812, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 53.12699999999999, "ram_util_percent": 83.325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.770953902876969, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.135660130250539, "policy_loss": -0.021934740800833238, "vf_loss": 7.154939411210676, "vf_explained_var": 0.26637008488178254, "kl": 0.01327722872184682, "entropy": 1.4269278987502376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 23970.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.985927349013626, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.320232053786989, "policy_loss": -0.023357878358807985, "vf_loss": 6.340339215596517, "vf_explained_var": 0.15575573412829605, "kl": 0.016253574792832806, "entropy": 1.3128341742293546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": 392.7495388848546, "episode_reward_min": 8.801364129357587, "episode_reward_mean": 180.56265417686552, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -471.83676647050527, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.54521165761588, "predator_policy": 469.6293408902028}, "policy_reward_mean": {"prey_policy": -32.69949519975562, "predator_policy": 139.3305698880664}, "custom_metrics": {}, "hist_stats": {"episode_reward": [147.89714972186184, 95.89999999999942, 162.19999999999916, 117.39157014363153, 101.00202251493437, 67.40872236734224, 144.14587532367983, 26.52598860210152, 177.4136414528967, 173.513647462721, 23.746547722537972, 131.7213320106102, 145.192325500056, 314.8648501361709, 184.58686136118405, 155.75767483208642, 137.899268917031, 128.29999999999956, 212.855937878985, 194.36761292787867, 148.9694541063758, 256.4201755153144, 295.9999999999992, 36.570650200632116, 184.82788476064073, 8.801364129357587, 163.53977884499008, 135.84737488710562, 256.3434671032626, 150.76168315624278, 140.24405209833913, 150.72166338050008, 70.47920930792112, 177.18113146870732, 302.293950404243, 198.44047468937936, 85.07407827921809, 146.7999999999986, 73.43681437422794, 222.84521165761493, 94.14318769893558, 196.25509707835315, 262.0863361006752, 98.05253115903906, 73.86100760315892, 326.8384198740485, 154.69361160511224, 123.14146057018309, 272.6373521736428, 307.8000000000003, 99.02845278398254, 266.1721888377332, 35.65943810583523, 238.41173270480243, 65.62010733127721, 93.5372652993951, 121.12227682952395, 390.9354373723189, 210.2969784453231, 203.4901112462478, 106.37139658916183, 252.2554391510107, 272.1550562241513, 92.52644628835264, 181.90765054313516, 209.03172027630956, 297.89999999999964, 282.0070274097544, 92.05936531388755, 87.09999999999968, 217.02387633257774, 132.55886562152546, 268.32899121839137, 151.20138763422372, 154.07051108730707, 212.03402009323077, 333.133041318261, 276.076980311634, 219.85371190694454, 242.94047130743002, 141.36602076313764, 195.8400255243281, 172.91452327445242, 231.4431871506039, 174.69423366564277, 277.12657115190746, 255.43678032162518, 158.2999999999988, 276.51977722129504, 392.7495388848546, 87.08340365990821, 163.2999999999994, 198.57283384723263, 226.87753880674416, 186.07006255306112, 351.74947015104675, 198.47736806313804, 301.0874957993891, 186.98540754383376, 117.06278061770138], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-156.12349628848202, -91.52790665905793, 27.60678163178693, 20.90000000000003, 41.970581767287776, -112.83889761750261, 135.2, -121.45239517227972, -135.66227384970983, -75.62306395169954, -36.20363313228011, 20.000000000000014, 20.000000000000014, 20.000000000000014, -30.954174456125422, 20.908722367341895, -19.469588213014596, -49.132498891382404, -36.30947224431668, -42.786285149497054, -88.28740116894036, -5.064967535089375, -87.27804190039683, -222.26462930346813, -59.92096595580679, 79.39999999999984, -310.76006596675353, 17.03512603007598, -51.959165200877145, -53.515519847446335, -100.82283291899294, -171.39195006892706, -162.07269189347198, -5.067538200824263, -12.615650487799932, 23.318609892950143, -52.80475174214942, -125.14661103609868, -113.33784509251544, -47.4923484110584, 159.24340248114856, 76.91111708685824, 33.82436289450702, -193.4181728061421, 51.5000000000002, 54.20000000000019, -471.83676647050527, -7.910782258428782, -113.25163980799084, 24.253604275775853, -20.83786010127795, -22.88107165303709, 72.20000000000006, 6.19489188705451, 106.39999999999998, -196.56672219338887, -46.538373649416364, -11.657228333636063, -59.7011235905661, -15.779931263882638, -59.11890916971239, -23.394702659040437, 20.000000000000014, 23.60000000000001, -314.0145240286328, 161.13672032365005, 181.09999999999988, 8.565959643004385, -20.805497441827413, -207.82867987360999, 10.452991814554187, -51.35879632173413, -50.040043037786404, -219.06895680150276, 20.900000000000027, -105.5479141171333, -103.12716355396346, 20.000000000000014, -137.10786356741215, 93.48434488478759, -82.20718849186338, 22.17781285421547, -257.76772752780096, 31.98247722226351, -110.54655313143616, 188.3, -87.07570887795399, -29.4091948823483, 44.300000000000075, -60.684846775958036, -18.490879940151103, -40.83532990993657, 88.70770800822166, -42.42823145836938, -122.57168840137513, -30.89961858346416, 7.661044540028309, 5.7335767079771225, -346.31770734473525, 5.516089087533848, -276.8291585764795, 109.00775936328996, 124.07839809706496, 20.000000000000014, 47.47029919396493, 98.84581643750182, -47.57429240357906, 45.20000000000022, -146.00526020964162, -100.59915264180866, -129.3604283798918, 16.80920403757159, 76.08306576560874, -212.099036283678, -28.716324598169265, -287.8086915468139, -85.0688613416427, -3.62326448021423, 194.54521165761588, -273.11323985186425, -93.76930959114615, -60.38429160040482, -228.62552858704825, 21.88187464444011, 16.125658041704792, -83.6007647380778, -128.89951478876748, 79.27389697379544, 111.67688938664209, -27.60688322213909, 20.000000000000014, -180.9815968766647, 13.680189319421213, -24.358157261152044, 20.000000000000014, -121.34783554993885, 170.72167939919126, -24.860361262790306, 20.000000000000014, -46.012630049953664, -21.803721494898447, -135.09431934469652, 17.550299879231048, -265.8295377723307, 171.48038224846536, -15.971398966097924, 54.20000000000017, 9.299366350648318, 192.79999999999995, 4.625444977935786, 63.5564937765791, -83.08788534816763, -53.98331211930067, -55.05664987562295, -17.13845961278189, 19.29817444946241, -102.1899353002453, 56.96213452366074, -114.74237376474154, 107.03263687480506, 20.000000000000014, 12.949764412732327, -69.31935969107937, -25.834199335715642, 20.000000000000014, 22.112528577778413, -17.779238172454054, -179.90742180826675, -81.2278030104934, -36.97591720783456, 20.000000000000014, 63.7143781275754, 73.42422072412339, 107.29999999999998, -64.75810889109393, -50.59733814568897, 36.75723913700331, 10.50880426413592, -49.101646496234586, -141.76768717422576, -107.99892089615196, -75.87004872492756, 20.000000000000014, -32.43323062263858, -34.52598411857105, 143.50913505386748, 135.2, -31.829546876953508, -83.31127861677135, 10.883886443372617, -16.39319731607596, -18.36273764541594, 102.59118479103658, 21.80000000000004, -31.716351205220228, 117.86359137700795, 36.441478839127775, -116.77566544285644, -1.5090021093395762, 47.57710508384308, -34.83830358390473, -60.20414969309685, 129.55841978400673, -23.623475511620406, 35.9681018239806, -216.8354489486786, 20.000000000000014, -195.79302897230062, 20.9152401594396, -96.28904575661005, -154.2136525607715, 120.32325447945209, -30.226452105324306, 14.988267285833789, -104.79240691434815, -109.4532081129021, -0.7437910279948685, -143.7414375279006, -8.423608385634779, 6.1339197175724545, -167.22016585195703, -98.38910649078639, -31.985102568313692, 4.763529979867231, -139.99160238742977, -29.678777994048183, 35.513127614500554, 20.000000000000014, 96.6868065578117, -196.57913160045038, 77.22395568010397, -139.7995082335016, -47.088225627260684, -30.69746697848768, 30.365798676204893, -231.517539847852, 20.00772252926134, 22.5622351209299, 87.43434920716228, -206.19781487155493, -47.089783798030794, -172.25481077026464, 70.9480864676492, -146.39334919605994, 36.831132708644816, 5.174032150870041, -26.853199526854926, -197.0915465482398, 101.03479024774406, 35.17953049136801, -70.46329031015092, -33.63490521881863, -163.74508279397963, -56.672111680934066, -3.4134151074049273, -164.2463658249314, 75.20790549658324, -76.9746683938569, -118.04324973967242, 125.54231772860727, 18.55533674815988, 40.427798257411524, -44.865907461477846, -6.802879410556584, -153.50566171700137, 191.74380381880093, -119.52439693139792, 175.90839067152024, -224.42668538041428, 147.9391545727608, 36.360257965334284, -194.95421471248932, -26.207040098928303, -19.005611057581085, -127.61568597120663, 28.1, 20.000000000000014, -38.27935478623623, 99.80373211169785, -283.85123336435754, 61.782454652459265, 79.39999999999938, 2.5582793261988046, -135.22603143944804, -243.7740006736462, 111.3309306066955, 21.01342033452371, 85.78770701534785, 12.697942919241171, -82.65025399216755, 36.00674181271617, 106.55542139205174, 14.237045649318835, -50.754243148914014, -113.24098469765902, -233.17010458492948, -1.4108525069358233, 7.175193486355946, -315.84080131673693, 24.23628223865377], "policy_predator_policy_reward": [161.52790665905758, 206.41386437855755, 127.6575902386778, 18.210725611536507, 147.86227384970914, 136.25239517227888, 58.338233177233, 150.88003405037884, 52.70470696567925, 39.2514900053826, 54.77830420041318, 60.32378290398428, 40.877491088343945, 270.6515427980907, 116.46682036053068, 224.66680698052417, 255.94339832071722, 212.75127505474128, 65.869777079439, 196.08342940153105, 215.76180402694874, 242.27221857697936, 78.15904878983946, 47.92686201644532, 148.43454662286342, 288.04698674795634, 18.47677935397042, 107.7258996252519, 49.13680659790857, 243.5438646749116, 469.6293408902028, 111.67588267081786, 126.05163980799014, 121.68352474253412, 12.505108112945482, 60.28107165303723, 229.34151882990884, 120.2195148918814, 116.99027512824075, 164.51562098772263, 132.58729909733015, 78.89576683779936, 52.791134122421774, 332.90684509787604, 90.10549744182723, 37.03404035699561, 82.64306816418018, 202.6620664172413, 104.2568876280207, 328.7799969719103, 9.018469460468008, 188.45797233998582, 203.745866555873, 85.62461946360493, 51.45492036846373, 287.9998919699656, 141.31917598121743, 124.34655313143537, 112.63751367187518, 83.91821114267493, 74.77167400005574, 36.090879940151275, 157.47168840137502, 189.14951342233425, 359.63172396314, 43.77057144151192, 285.8873152800486, 53.59912631431473, 30.475745025229, 80.26950808798381, 36.84881469279618, 65.12013596266173, 245.51272814851407, 215.52619136204544, 28.307730196819804, 237.69903628367777, 350.39014276045066, 124.64054910040379, 280.81323985186395, 24.223264480214187, 125.99345307101348, 350.9288644065216, 82.30871044500374, 159.53961868528415, 124.46325792887849, 75.57180660012597, 47.17091563379115, 239.4700956240526, 33.093094585837875, 31.445880959052147, 149.30938347377918, 153.01555381380783, 76.66976101604382, 125.8402021339219, 357.6903159888372, 148.82470181914434, 12.8931653912457, 50.03520350003029, 87.10063364935183, 13.974555022064182, 70.68331211930045, 101.85984435557248, 191.35917254008058, 127.70995133659542, 119.81606519136707, 75.81354745579297, 47.56736312519494, 50.861968292071474, 93.22612788084132, 47.547538477230866, 78.80975747379276, 190.30163922854572, 64.6949357534522, 154.63106129440004, 65.60336119811161, 80.89347732250862, 211.0625347207741, 77.83265162432967, 249.03809056977016, 134.81255008280314, 134.20669495816492, 136.0336712520766, 69.0554295376022, 106.65008930075165, 77.26836590130195, 174.82751581657413, 52.082381249845625, 64.31611355662737, 0.0, 89.23281695731986, 159.38994041125397, 12.11237509177638, 106.79326397641793, 179.8769366329835, 144.93291186074, 91.34332096972538, 29.193755430338584, 223.73295700824795, 249.07778881286106, 109.18904575661014, 143.11157311376274, 138.02915340545897, 204.94362038364739, 126.87259297929516, 99.86744657209633, 321.3703815878255, 171.16699893133296, 239.50974132806178, 109.02260939986606, 212.26107666331745, 41.01654167498809, 145.18312879779157, 295.31557733599817, 60.48583334479573, 253.44185891791864, 240.22032223296526, 168.70183277247887, 232.29589777685288, 127.27854450040972, 211.8631573504839, 73.9801622882097, 215.78236657557483, 120.77686220654893, 179.45134765432437, 199.5953068306333, 96.22917227117001, 276.4529303329315, 23.90892185527437, 186.65182596201345, 211.87301728594852, 172.3497382553377, 270.78996161877495, 113.67974448776354, 115.7026310967668, 116.31801841294066, 53.222970201682195, 262.9303897247121, 94.87564232618149, 52.465339087310504, 240.86333993367663, 79.98080389719144, 191.90359660880011, 140.605611057581, 141.21568597120586, 49.30007095519304, 67.74838556657882, 108.87297283038089, 260.67334468826294, 206.6977172866847, 355.81409805327166, 10.213801997180802, 123.40361019729855, 171.09587215512286, 61.32706516822522, 157.5864970388576, 73.46277486807419, 184.87809945188073, 349.9292498814777, 252.48994549630885, 149.0021607131211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.701862497195611, "mean_inference_ms": 6.431388787678678, "mean_action_processing_ms": 3.9860289582472945, "mean_env_wait_ms": 15.572233564887823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026030302047729492, "StateBufferConnector_ms": 0.00789034366607666, "ViewRequirementAgentConnector_ms": 2.177240014076233}, "num_episodes": 0, "episode_return_max": 392.7495388848546, "episode_return_min": 8.801364129357587, "episode_return_mean": 180.56265417686552, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.05313379774925, "num_env_steps_trained_throughput_per_sec": 56.05313379774925, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 71229.414, "restore_workers_time_ms": 0.034, "training_step_time_ms": 71229.324, "sample_time_ms": 4749.219, "learn_time_ms": 66456.263, "learn_throughput": 60.19, "synch_weights_time_ms": 14.971}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 9, "trial_id": "62684_00000", "date": "2024-08-20_16-18-28", "timestamp": 1724150908, "time_this_iter_s": 71.40797591209412, "time_total_s": 641.7657465934753, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ff92e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 641.7657465934753, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 57.15299999999999, "ram_util_percent": 83.418}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.24192625119331, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.111946213160846, "policy_loss": -0.020427236638976432, "vf_loss": 7.129946053619926, "vf_explained_var": 0.279208590312207, "kl": 0.012136998200782489, "entropy": 1.4293946221787879, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 26790.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.598426037711441, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.3598383517492385, "policy_loss": -0.020278270826453254, "vf_loss": 6.377557555708305, "vf_explained_var": 0.15863209669552153, "kl": 0.012795339380119923, "entropy": 1.298871979322383, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": 392.7495388848546, "episode_reward_min": 8.801364129357587, "episode_reward_mean": 192.34548546846196, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -347.5433465082441, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.1711554484475, "predator_policy": 474.4407770260447}, "policy_reward_mean": {"prey_policy": -32.67586849687261, "predator_policy": 145.18654547954011}, "custom_metrics": {}, "hist_stats": {"episode_reward": [128.29999999999956, 212.855937878985, 194.36761292787867, 148.9694541063758, 256.4201755153144, 295.9999999999992, 36.570650200632116, 184.82788476064073, 8.801364129357587, 163.53977884499008, 135.84737488710562, 256.3434671032626, 150.76168315624278, 140.24405209833913, 150.72166338050008, 70.47920930792112, 177.18113146870732, 302.293950404243, 198.44047468937936, 85.07407827921809, 146.7999999999986, 73.43681437422794, 222.84521165761493, 94.14318769893558, 196.25509707835315, 262.0863361006752, 98.05253115903906, 73.86100760315892, 326.8384198740485, 154.69361160511224, 123.14146057018309, 272.6373521736428, 307.8000000000003, 99.02845278398254, 266.1721888377332, 35.65943810583523, 238.41173270480243, 65.62010733127721, 93.5372652993951, 121.12227682952395, 390.9354373723189, 210.2969784453231, 203.4901112462478, 106.37139658916183, 252.2554391510107, 272.1550562241513, 92.52644628835264, 181.90765054313516, 209.03172027630956, 297.89999999999964, 282.0070274097544, 92.05936531388755, 87.09999999999968, 217.02387633257774, 132.55886562152546, 268.32899121839137, 151.20138763422372, 154.07051108730707, 212.03402009323077, 333.133041318261, 276.076980311634, 219.85371190694454, 242.94047130743002, 141.36602076313764, 195.8400255243281, 172.91452327445242, 231.4431871506039, 174.69423366564277, 277.12657115190746, 255.43678032162518, 158.2999999999988, 276.51977722129504, 392.7495388848546, 87.08340365990821, 163.2999999999994, 198.57283384723263, 226.87753880674416, 186.07006255306112, 351.74947015104675, 198.47736806313804, 301.0874957993891, 186.98540754383376, 117.06278061770138, 361.6512704922852, 225.61662474933684, 235.6072046096563, 261.47514977216747, 85.13134390440808, 277.3350449764155, 219.0912039149736, 173.87802025027815, 288.9745558145682, 43.93839738501445, 378.9847137082918, 195.47986082765422, 129.57433967705907, 127.51469403137676, 145.41869150832056, 177.67322767557945, 158.10626393110147], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.88107165303709, 72.20000000000006, 6.19489188705451, 106.39999999999998, -196.56672219338887, -46.538373649416364, -11.657228333636063, -59.7011235905661, -15.779931263882638, -59.11890916971239, -23.394702659040437, 20.000000000000014, 23.60000000000001, -314.0145240286328, 161.13672032365005, 181.09999999999988, 8.565959643004385, -20.805497441827413, -207.82867987360999, 10.452991814554187, -51.35879632173413, -50.040043037786404, -219.06895680150276, 20.900000000000027, -105.5479141171333, -103.12716355396346, 20.000000000000014, -137.10786356741215, 93.48434488478759, -82.20718849186338, 22.17781285421547, -257.76772752780096, 31.98247722226351, -110.54655313143616, 188.3, -87.07570887795399, -29.4091948823483, 44.300000000000075, -60.684846775958036, -18.490879940151103, -40.83532990993657, 88.70770800822166, -42.42823145836938, -122.57168840137513, -30.89961858346416, 7.661044540028309, 5.7335767079771225, -346.31770734473525, 5.516089087533848, -276.8291585764795, 109.00775936328996, 124.07839809706496, 20.000000000000014, 47.47029919396493, 98.84581643750182, -47.57429240357906, 45.20000000000022, -146.00526020964162, -100.59915264180866, -129.3604283798918, 16.80920403757159, 76.08306576560874, -212.099036283678, -28.716324598169265, -287.8086915468139, -85.0688613416427, -3.62326448021423, 194.54521165761588, -273.11323985186425, -93.76930959114615, -60.38429160040482, -228.62552858704825, 21.88187464444011, 16.125658041704792, -83.6007647380778, -128.89951478876748, 79.27389697379544, 111.67688938664209, -27.60688322213909, 20.000000000000014, -180.9815968766647, 13.680189319421213, -24.358157261152044, 20.000000000000014, -121.34783554993885, 170.72167939919126, -24.860361262790306, 20.000000000000014, -46.012630049953664, -21.803721494898447, -135.09431934469652, 17.550299879231048, -265.8295377723307, 171.48038224846536, -15.971398966097924, 54.20000000000017, 9.299366350648318, 192.79999999999995, 4.625444977935786, 63.5564937765791, -83.08788534816763, -53.98331211930067, -55.05664987562295, -17.13845961278189, 19.29817444946241, -102.1899353002453, 56.96213452366074, -114.74237376474154, 107.03263687480506, 20.000000000000014, 12.949764412732327, -69.31935969107937, -25.834199335715642, 20.000000000000014, 22.112528577778413, -17.779238172454054, -179.90742180826675, -81.2278030104934, -36.97591720783456, 20.000000000000014, 63.7143781275754, 73.42422072412339, 107.29999999999998, -64.75810889109393, -50.59733814568897, 36.75723913700331, 10.50880426413592, -49.101646496234586, -141.76768717422576, -107.99892089615196, -75.87004872492756, 20.000000000000014, -32.43323062263858, -34.52598411857105, 143.50913505386748, 135.2, -31.829546876953508, -83.31127861677135, 10.883886443372617, -16.39319731607596, -18.36273764541594, 102.59118479103658, 21.80000000000004, -31.716351205220228, 117.86359137700795, 36.441478839127775, -116.77566544285644, -1.5090021093395762, 47.57710508384308, -34.83830358390473, -60.20414969309685, 129.55841978400673, -23.623475511620406, 35.9681018239806, -216.8354489486786, 20.000000000000014, -195.79302897230062, 20.9152401594396, -96.28904575661005, -154.2136525607715, 120.32325447945209, -30.226452105324306, 14.988267285833789, -104.79240691434815, -109.4532081129021, -0.7437910279948685, -143.7414375279006, -8.423608385634779, 6.1339197175724545, -167.22016585195703, -98.38910649078639, -31.985102568313692, 4.763529979867231, -139.99160238742977, -29.678777994048183, 35.513127614500554, 20.000000000000014, 96.6868065578117, -196.57913160045038, 77.22395568010397, -139.7995082335016, -47.088225627260684, -30.69746697848768, 30.365798676204893, -231.517539847852, 20.00772252926134, 22.5622351209299, 87.43434920716228, -206.19781487155493, -47.089783798030794, -172.25481077026464, 70.9480864676492, -146.39334919605994, 36.831132708644816, 5.174032150870041, -26.853199526854926, -197.0915465482398, 101.03479024774406, 35.17953049136801, -70.46329031015092, -33.63490521881863, -163.74508279397963, -56.672111680934066, -3.4134151074049273, -164.2463658249314, 75.20790549658324, -76.9746683938569, -118.04324973967242, 125.54231772860727, 18.55533674815988, 40.427798257411524, -44.865907461477846, -6.802879410556584, -153.50566171700137, 191.74380381880093, -119.52439693139792, 175.90839067152024, -224.42668538041428, 147.9391545727608, 36.360257965334284, -194.95421471248932, -26.207040098928303, -19.005611057581085, -127.61568597120663, 28.1, 20.000000000000014, -38.27935478623623, 99.80373211169785, -283.85123336435754, 61.782454652459265, 79.39999999999938, 2.5582793261988046, -135.22603143944804, -243.7740006736462, 111.3309306066955, 21.01342033452371, 85.78770701534785, 12.697942919241171, -82.65025399216755, 36.00674181271617, 106.55542139205174, 14.237045649318835, -50.754243148914014, -113.24098469765902, -233.17010458492948, -1.4108525069358233, 7.175193486355946, -315.84080131673693, 24.23628223865377, 172.1, 163.09999999999988, -9.044205403233889, -180.21809479083387, -158.3356678789227, 138.55763650724913, -182.24042868340857, 76.35476340724009, -165.4608824758396, 33.21808532601165, 8.486270519806231, -78.0506047453487, -203.13198566779633, -71.96972021453985, -347.5433465082441, 96.11139416526787, -64.98271986296145, -91.35418642621022, -108.87478304150505, 129.68242989019825, -104.35913534622537, -108.29893335375928, -17.492573524041212, 57.32117554659182, -289.25855259709544, -144.38745447982254, 198.1711554484475, -25.943285923305737, -8.778959716356633, -189.78543492290646, 173.0, 186.5, -78.42482942064144, -70.30385803096614, 20.817860470919207, -50.0298285324213, -61.173006758568114, 10.941025558835449, -40.77131586017275, 13.156544887547419, 36.257158031736054, -344.5393936762952, -162.05698240274484, -165.0946722954457, -61.6012054295431, -55.69430145380603, -76.38329043865319, 55.48661518431592, -157.88826712052526, -122.0795624589956, -125.49221001070359], "policy_predator_policy_reward": [12.505108112945482, 60.28107165303723, 229.34151882990884, 120.2195148918814, 116.99027512824075, 164.51562098772263, 132.58729909733015, 78.89576683779936, 52.791134122421774, 332.90684509787604, 90.10549744182723, 37.03404035699561, 82.64306816418018, 202.6620664172413, 104.2568876280207, 328.7799969719103, 9.018469460468008, 188.45797233998582, 203.745866555873, 85.62461946360493, 51.45492036846373, 287.9998919699656, 141.31917598121743, 124.34655313143537, 112.63751367187518, 83.91821114267493, 74.77167400005574, 36.090879940151275, 157.47168840137502, 189.14951342233425, 359.63172396314, 43.77057144151192, 285.8873152800486, 53.59912631431473, 30.475745025229, 80.26950808798381, 36.84881469279618, 65.12013596266173, 245.51272814851407, 215.52619136204544, 28.307730196819804, 237.69903628367777, 350.39014276045066, 124.64054910040379, 280.81323985186395, 24.223264480214187, 125.99345307101348, 350.9288644065216, 82.30871044500374, 159.53961868528415, 124.46325792887849, 75.57180660012597, 47.17091563379115, 239.4700956240526, 33.093094585837875, 31.445880959052147, 149.30938347377918, 153.01555381380783, 76.66976101604382, 125.8402021339219, 357.6903159888372, 148.82470181914434, 12.8931653912457, 50.03520350003029, 87.10063364935183, 13.974555022064182, 70.68331211930045, 101.85984435557248, 191.35917254008058, 127.70995133659542, 119.81606519136707, 75.81354745579297, 47.56736312519494, 50.861968292071474, 93.22612788084132, 47.547538477230866, 78.80975747379276, 190.30163922854572, 64.6949357534522, 154.63106129440004, 65.60336119811161, 80.89347732250862, 211.0625347207741, 77.83265162432967, 249.03809056977016, 134.81255008280314, 134.20669495816492, 136.0336712520766, 69.0554295376022, 106.65008930075165, 77.26836590130195, 174.82751581657413, 52.082381249845625, 64.31611355662737, 0.0, 89.23281695731986, 159.38994041125397, 12.11237509177638, 106.79326397641793, 179.8769366329835, 144.93291186074, 91.34332096972538, 29.193755430338584, 223.73295700824795, 249.07778881286106, 109.18904575661014, 143.11157311376274, 138.02915340545897, 204.94362038364739, 126.87259297929516, 99.86744657209633, 321.3703815878255, 171.16699893133296, 239.50974132806178, 109.02260939986606, 212.26107666331745, 41.01654167498809, 145.18312879779157, 295.31557733599817, 60.48583334479573, 253.44185891791864, 240.22032223296526, 168.70183277247887, 232.29589777685288, 127.27854450040972, 211.8631573504839, 73.9801622882097, 215.78236657557483, 120.77686220654893, 179.45134765432437, 199.5953068306333, 96.22917227117001, 276.4529303329315, 23.90892185527437, 186.65182596201345, 211.87301728594852, 172.3497382553377, 270.78996161877495, 113.67974448776354, 115.7026310967668, 116.31801841294066, 53.222970201682195, 262.9303897247121, 94.87564232618149, 52.465339087310504, 240.86333993367663, 79.98080389719144, 191.90359660880011, 140.605611057581, 141.21568597120586, 49.30007095519304, 67.74838556657882, 108.87297283038089, 260.67334468826294, 206.6977172866847, 355.81409805327166, 10.213801997180802, 123.40361019729855, 171.09587215512286, 61.32706516822522, 157.5864970388576, 73.46277486807419, 184.87809945188073, 349.9292498814777, 252.48994549630885, 149.0021607131211, 20.51351642943719, 14.98195946608053, 325.17823418509136, 100.4345167267528, 276.97005228498796, 229.983700076677, 106.2258230048944, 191.5955756668042, 283.87685524462637, 423.89954105036213, 254.59714305424475, 82.96341404607477, 130.60339437712562, 172.03929803538045, 184.1519724384384, 58.1963791430487, 474.4407770260447, 50.008630416995885, 146.1109041577486, 122.3351737898346, 80.96442775375581, 16.945115375176414, 59.2917192924834, 235.70396762764028, 55.94040129142067, 164.63723544554446, 373.088837503142, 49.551547285247544, 262.8647495208452, 271.3068021152088, 202.8514873440674, 51.412717039655874, 304.9211306056689, 258.6451729156569]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.304071289027345, "mean_inference_ms": 6.517750095288818, "mean_action_processing_ms": 3.5559639316950746, "mean_env_wait_ms": 15.97754586313716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038587331771850586, "StateBufferConnector_ms": 0.008700728416442871, "ViewRequirementAgentConnector_ms": 2.1687670946121216}, "num_episodes": 17, "episode_return_max": 392.7495388848546, "episode_return_min": 8.801364129357587, "episode_return_mean": 192.34548546846196, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.06282287885218, "num_env_steps_trained_throughput_per_sec": 55.06282287885218, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 71370.904, "restore_workers_time_ms": 0.032, "training_step_time_ms": 71370.817, "sample_time_ms": 4732.019, "learn_time_ms": 66614.171, "learn_throughput": 60.047, "synch_weights_time_ms": 15.285}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 10, "trial_id": "62684_00000", "date": "2024-08-20_16-19-41", "timestamp": 1724150981, "time_this_iter_s": 72.69219779968262, "time_total_s": 714.457944393158, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb0cdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 714.457944393158, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 56.22038834951455, "ram_util_percent": 82.72427184466021}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.989682621101961, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.713692059415452, "policy_loss": -0.01963783039765908, "vf_loss": 6.730686539453818, "vf_explained_var": 0.3073563870808757, "kl": 0.013216756916677593, "entropy": 1.3979155866389579, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 29610.5, "diff_num_grad_updates_vs_sampler_policy": 1448.2750000000015}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9561950070202037, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.738576551215359, "policy_loss": -0.023506896746364574, "vf_loss": 6.759216630521905, "vf_explained_var": 0.14563202744438536, "kl": 0.014334044151535386, "entropy": 1.2194016771341758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999993}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "env_runners": {"episode_reward_max": 392.7495388848546, "episode_reward_min": 43.93839738501445, "episode_reward_mean": 199.17836489670663, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -452.00406089097925, "predator_policy": 10.213801997180802}, "policy_reward_max": {"prey_policy": 198.1711554484475, "predator_policy": 509.88793594384094}, "policy_reward_mean": {"prey_policy": -59.727638629304174, "predator_policy": 189.18064039230973}, "custom_metrics": {}, "hist_stats": {"episode_reward": [209.03172027630956, 297.89999999999964, 282.0070274097544, 92.05936531388755, 87.09999999999968, 217.02387633257774, 132.55886562152546, 268.32899121839137, 151.20138763422372, 154.07051108730707, 212.03402009323077, 333.133041318261, 276.076980311634, 219.85371190694454, 242.94047130743002, 141.36602076313764, 195.8400255243281, 172.91452327445242, 231.4431871506039, 174.69423366564277, 277.12657115190746, 255.43678032162518, 158.2999999999988, 276.51977722129504, 392.7495388848546, 87.08340365990821, 163.2999999999994, 198.57283384723263, 226.87753880674416, 186.07006255306112, 351.74947015104675, 198.47736806313804, 301.0874957993891, 186.98540754383376, 117.06278061770138, 361.6512704922852, 225.61662474933684, 235.6072046096563, 261.47514977216747, 85.13134390440808, 277.3350449764155, 219.0912039149736, 173.87802025027815, 288.9745558145682, 43.93839738501445, 378.9847137082918, 195.47986082765422, 129.57433967705907, 127.51469403137676, 145.41869150832056, 177.67322767557945, 158.10626393110147, 289.16578602271125, 216.7256406343863, 82.77858764382682, 226.75641169661904, 203.64086820674095, 199.0604571578789, 282.75458602460003, 176.874033504924, 53.42211960424826, 141.9999999999992, 127.88273383518917, 141.0760894206638, 291.73548175971655, 151.2475457716704, 77.28115009131453, 106.68330818681437, 209.32330330076184, 239.41598967560398, 93.0719637948387, 119.37486931502494, 84.9701691507974, 181.2688502334529, 102.38481254959088, 283.4979273643493, 277.49999999999915, 159.62826473305913, 218.7179361929924, 259.53166632429327, 44.03175750402032, 188.70205216194313, 231.49091216216738, 260.0262135344343, 150.4447245522945, 262.7365684304455, 235.17225615814104, 187.60334779519508, 144.60137625788425, 267.23596969834824, 259.13415035887635, 149.5310906801705, 250.63626266311618, 273.9957788155367, 200.35272573250992, 126.39999999999839, 244.70844491273658, 161.4782670974175, 74.17907876937146, 253.17736413012562], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [117.86359137700795, 36.441478839127775, -116.77566544285644, -1.5090021093395762, 47.57710508384308, -34.83830358390473, -60.20414969309685, 129.55841978400673, -23.623475511620406, 35.9681018239806, -216.8354489486786, 20.000000000000014, -195.79302897230062, 20.9152401594396, -96.28904575661005, -154.2136525607715, 120.32325447945209, -30.226452105324306, 14.988267285833789, -104.79240691434815, -109.4532081129021, -0.7437910279948685, -143.7414375279006, -8.423608385634779, 6.1339197175724545, -167.22016585195703, -98.38910649078639, -31.985102568313692, 4.763529979867231, -139.99160238742977, -29.678777994048183, 35.513127614500554, 20.000000000000014, 96.6868065578117, -196.57913160045038, 77.22395568010397, -139.7995082335016, -47.088225627260684, -30.69746697848768, 30.365798676204893, -231.517539847852, 20.00772252926134, 22.5622351209299, 87.43434920716228, -206.19781487155493, -47.089783798030794, -172.25481077026464, 70.9480864676492, -146.39334919605994, 36.831132708644816, 5.174032150870041, -26.853199526854926, -197.0915465482398, 101.03479024774406, 35.17953049136801, -70.46329031015092, -33.63490521881863, -163.74508279397963, -56.672111680934066, -3.4134151074049273, -164.2463658249314, 75.20790549658324, -76.9746683938569, -118.04324973967242, 125.54231772860727, 18.55533674815988, 40.427798257411524, -44.865907461477846, -6.802879410556584, -153.50566171700137, 191.74380381880093, -119.52439693139792, 175.90839067152024, -224.42668538041428, 147.9391545727608, 36.360257965334284, -194.95421471248932, -26.207040098928303, -19.005611057581085, -127.61568597120663, 28.1, 20.000000000000014, -38.27935478623623, 99.80373211169785, -283.85123336435754, 61.782454652459265, 79.39999999999938, 2.5582793261988046, -135.22603143944804, -243.7740006736462, 111.3309306066955, 21.01342033452371, 85.78770701534785, 12.697942919241171, -82.65025399216755, 36.00674181271617, 106.55542139205174, 14.237045649318835, -50.754243148914014, -113.24098469765902, -233.17010458492948, -1.4108525069358233, 7.175193486355946, -315.84080131673693, 24.23628223865377, 172.1, 163.09999999999988, -9.044205403233889, -180.21809479083387, -158.3356678789227, 138.55763650724913, -182.24042868340857, 76.35476340724009, -165.4608824758396, 33.21808532601165, 8.486270519806231, -78.0506047453487, -203.13198566779633, -71.96972021453985, -347.5433465082441, 96.11139416526787, -64.98271986296145, -91.35418642621022, -108.87478304150505, 129.68242989019825, -104.35913534622537, -108.29893335375928, -17.492573524041212, 57.32117554659182, -289.25855259709544, -144.38745447982254, 198.1711554484475, -25.943285923305737, -8.778959716356633, -189.78543492290646, 173.0, 186.5, -78.42482942064144, -70.30385803096614, 20.817860470919207, -50.0298285324213, -61.173006758568114, 10.941025558835449, -40.77131586017275, 13.156544887547419, 36.257158031736054, -344.5393936762952, -162.05698240274484, -165.0946722954457, -61.6012054295431, -55.69430145380603, -76.38329043865319, 55.48661518431592, -157.88826712052526, -122.0795624589956, -125.49221001070359, -79.51946618523151, -324.4636975416422, 172.56166446143942, 0.8363578674912938, 187.4, -127.1942824589942, 4.469505469101859, -350.31654963012164, 20.987586656538472, -85.21626762406245, 146.89999999999995, -66.16690369607204, 136.94024605554424, -201.42656396882387, -317.082273028407, -108.33089399150533, -366.18651554926004, 11.65368732363656, 134.51070809436857, -85.95029927981383, -354.4078525039062, -321.4055738311878, -70.86122888246412, -76.44505094975284, -259.06687866484015, -53.936698082718266, -117.14068206307581, 18.117618031683776, -37.16512440610043, 44.35225718789286, -334.85426086224993, -20.290005926897894, -117.33545532935585, 7.728243879908254, -26.826448283344106, -103.3738558634471, 59.34102990235951, -183.82144262001074, 151.29117027816912, -348.36955339434735, 26.19437701656533, -126.04207914618189, -380.67814407118976, 11.007839983910326, -185.92885483914628, 8.354594871421702, -35.03498232449104, -452.00406089097925, 116.49432060758669, -284.9645363844737, -241.47652099465358, 122.54335208501105, -125.59040616934749, -364.8031876472011, 12.464707206805404, 20.000000000000014, -126.21402564539383, -87.96361555646392, -189.9898038089615, 26.842499581313994, -113.65124288610757, -15.443645467516365, -111.66504598104834, -19.31376038280105, -335.4382726767012, 149.08547792910238, -24.873574882953314, 1.4306836535884984, -39.899155143764, 20.622251944534643, -93.98216053855239, -7.691109911353237, -142.9055764285591, 135.1999999999996, 110.01038156813465, -113.79252843644659, 91.3846338018541, -388.2901862635763, -27.30183647785273, -99.42666109187267, -203.60271930902914, -43.16470872320984, -73.42162297324305, 156.01750045369886, -334.23784893398783, 33.68009120515606, -128.82789436936045, -7.836873614857746, 24.82545086343289, -146.16304396272028, -73.0197327971805, 169.30594250851513, -420.43737937222636, 58.69999999999996, 38.130845467414744, -318.18891598864417, 93.83246122186696, -5.185263312760579, -281.34680327630605, 153.80101342572073, -173.93190375204892, -188.4129822299167, -3.7378912319333395, 128.78213862544146, -332.9428180584878, 40.780483635616555, -317.2331936431281, -177.02751437496423, -332.29976882503746, -352.93836470980847, 19.758204466747188, -211.8826727776427, 35.411006608707055, 34.26889061502041, 48.9209357074006, 94.07027166294358, -242.13694679645363, -3.04991270842316, -228.3500599502431, -144.3863543891957, 69.20675134078122, -163.781094077145, -2.968481901400729, 118.14565692054744, -392.7858623894654, 27.599537672330534, -125.17109941346087, -156.6417207110635, -6.6397674499731, -19.830695782012782, 5.200030781601107, -128.08785077586225, -46.66168316277359, 51.730290918343606, 66.93081670108516, -283.25192918158467, -251.07494313995954, 144.38479738793464, -357.90047757139035, 20.000000000000014, 3.1575031660305934, -128.3309307327477, 85.1190856831657, 34.137846733214445], "policy_predator_policy_reward": [159.38994041125397, 12.11237509177638, 106.79326397641793, 179.8769366329835, 144.93291186074, 91.34332096972538, 29.193755430338584, 223.73295700824795, 249.07778881286106, 109.18904575661014, 143.11157311376274, 138.02915340545897, 204.94362038364739, 126.87259297929516, 99.86744657209633, 321.3703815878255, 171.16699893133296, 239.50974132806178, 109.02260939986606, 212.26107666331745, 41.01654167498809, 145.18312879779157, 295.31557733599817, 60.48583334479573, 253.44185891791864, 240.22032223296526, 168.70183277247887, 232.29589777685288, 127.27854450040972, 211.8631573504839, 73.9801622882097, 215.78236657557483, 120.77686220654893, 179.45134765432437, 199.5953068306333, 96.22917227117001, 276.4529303329315, 23.90892185527437, 186.65182596201345, 211.87301728594852, 172.3497382553377, 270.78996161877495, 113.67974448776354, 115.7026310967668, 116.31801841294066, 53.222970201682195, 262.9303897247121, 94.87564232618149, 52.465339087310504, 240.86333993367663, 79.98080389719144, 191.90359660880011, 140.605611057581, 141.21568597120586, 49.30007095519304, 67.74838556657882, 108.87297283038089, 260.67334468826294, 206.6977172866847, 355.81409805327166, 10.213801997180802, 123.40361019729855, 171.09587215512286, 61.32706516822522, 157.5864970388576, 73.46277486807419, 184.87809945188073, 349.9292498814777, 252.48994549630885, 149.0021607131211, 20.51351642943719, 14.98195946608053, 325.17823418509136, 100.4345167267528, 276.97005228498796, 229.983700076677, 106.2258230048944, 191.5955756668042, 283.87685524462637, 423.89954105036213, 254.59714305424475, 82.96341404607477, 130.60339437712562, 172.03929803538045, 184.1519724384384, 58.1963791430487, 474.4407770260447, 50.008630416995885, 146.1109041577486, 122.3351737898346, 80.96442775375581, 16.945115375176414, 59.2917192924834, 235.70396762764028, 55.94040129142067, 164.63723544554446, 373.088837503142, 49.551547285247544, 262.8647495208452, 271.3068021152088, 202.8514873440674, 51.412717039655874, 304.9211306056689, 258.6451729156569, 183.2019718482733, 337.3853134398722, 16.353318404253816, 139.3302468216366, 141.9593746078636, 265.6786705404445, 165.67830944353528, 65.56127357321859, 386.43186116593, 198.77759798249826, 281.99991902761235, 379.9242603473957, 355.6700811804745, 232.9319485334768, 398.19920821203317, 247.3866789562965, 118.93919754584579, 364.62718086903664, 57.63012478042335, 59.065124406100644, 277.527493064045, 322.834962889649, 220.62170140420386, 42.92644828334433, 204.80303696841972, 60.12168723077771, 239.8797022143996, 359.58509908123506, 275.96046577020735, 356.91984324753304, 449.2734622018123, 136.09429432905026, 344.77153012843144, 274.49850994387106, 245.59199659335525, 361.67423481378626, 114.6484268122515, 72.17285542117631, 288.31423923671105, 82.17154986242495, 168.94664343506548, 156.78346005040387, 285.09807887222934, 101.83732649162407, 148.557542576309, 17.169316346411478, 183.54493473086265, 181.00401113885772, 150.31248584710337, 24.88270901332028, 179.05851987569474, 391.267825755534, 290.71818020770127, 258.33097286404507, 90.71034815701462, 129.39014941003344, 19.91990879484414, 453.49750080736885, 133.5026765620724, 184.37384231401646, 398.103217676148, 157.53886414691118, 328.4904732931446, 152.89381076252073, 152.94706543915154, 190.19726448034402, 412.85233055327643, 58.428110433414375, 365.8667283872353, 77.2040984358857, 131.19563623382984, 509.88793594384094, 466.8185809444698, 343.2627243815143, 265.34935320012255, 144.08939205214023, 97.796733635182, 260.4831561498038, 263.665395578759, 261.6520221492734, 200.59714942844136, 147.5819378724394, 157.2136564745613, 363.8227901375631, 34.34509213382888, 454.4602211731796, 254.52297017846607, 14.595545597808124, 90.91979971961025, 81.78922073647163, 257.77494313995925, 293.6453988910677, 52.349104841123676, 356.5729483336076, 199.50017165847555, 62.75119078801772]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.890431379511618, "mean_inference_ms": 6.465207437305708, "mean_action_processing_ms": 3.235478612587416, "mean_env_wait_ms": 16.893189384620136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05357980728149414, "StateBufferConnector_ms": 0.008432149887084961, "ViewRequirementAgentConnector_ms": 0.4261859655380249}, "num_episodes": 48, "episode_return_max": 392.7495388848546, "episode_return_min": 43.93839738501445, "episode_return_mean": 199.17836489670663, "episodes_this_iter": 48}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.17238621001175, "num_env_steps_trained_throughput_per_sec": 56.17238621001175, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 71828.852, "restore_workers_time_ms": 0.032, "training_step_time_ms": 71828.766, "sample_time_ms": 4690.234, "learn_time_ms": 67115.027, "learn_throughput": 59.599, "synch_weights_time_ms": 15.303}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "training_iteration": 11, "trial_id": "62684_00000", "date": "2024-08-20_16-20-53", "timestamp": 1724151053, "time_this_iter_s": 71.2900002002716, "time_total_s": 785.7479445934296, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ff8be50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 785.7479445934296, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 54.195, "ram_util_percent": 83.42300000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.635997981551691, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.884376935755953, "policy_loss": -0.021255338196816083, "vf_loss": 6.902837885356118, "vf_explained_var": 0.26897618178780197, "kl": 0.013971976940817338, "entropy": 1.3539093550638104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 32430.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.887123246262313, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.959993887956811, "policy_loss": -0.0224295699473707, "vf_loss": 6.979410489400228, "vf_explained_var": 0.12002683108445829, "kl": 0.015064907893932685, "entropy": 1.1607219315079784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 405.41593904100915, "episode_reward_min": 43.93839738501445, "episode_reward_mean": 200.1546168210626, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -452.00406089097925, "predator_policy": 10.213801997180802}, "policy_reward_max": {"prey_policy": 198.1711554484475, "predator_policy": 509.88793594384094}, "policy_reward_mean": {"prey_policy": -61.376674084248336, "predator_policy": 192.14231953690395}, "custom_metrics": {}, "hist_stats": {"episode_reward": [268.32899121839137, 151.20138763422372, 154.07051108730707, 212.03402009323077, 333.133041318261, 276.076980311634, 219.85371190694454, 242.94047130743002, 141.36602076313764, 195.8400255243281, 172.91452327445242, 231.4431871506039, 174.69423366564277, 277.12657115190746, 255.43678032162518, 158.2999999999988, 276.51977722129504, 392.7495388848546, 87.08340365990821, 163.2999999999994, 198.57283384723263, 226.87753880674416, 186.07006255306112, 351.74947015104675, 198.47736806313804, 301.0874957993891, 186.98540754383376, 117.06278061770138, 361.6512704922852, 225.61662474933684, 235.6072046096563, 261.47514977216747, 85.13134390440808, 277.3350449764155, 219.0912039149736, 173.87802025027815, 288.9745558145682, 43.93839738501445, 378.9847137082918, 195.47986082765422, 129.57433967705907, 127.51469403137676, 145.41869150832056, 177.67322767557945, 158.10626393110147, 289.16578602271125, 216.7256406343863, 82.77858764382682, 226.75641169661904, 203.64086820674095, 199.0604571578789, 282.75458602460003, 176.874033504924, 53.42211960424826, 141.9999999999992, 127.88273383518917, 141.0760894206638, 291.73548175971655, 151.2475457716704, 77.28115009131453, 106.68330818681437, 209.32330330076184, 239.41598967560398, 93.0719637948387, 119.37486931502494, 84.9701691507974, 181.2688502334529, 102.38481254959088, 283.4979273643493, 277.49999999999915, 159.62826473305913, 218.7179361929924, 259.53166632429327, 44.03175750402032, 188.70205216194313, 231.49091216216738, 260.0262135344343, 150.4447245522945, 262.7365684304455, 235.17225615814104, 187.60334779519508, 144.60137625788425, 267.23596969834824, 259.13415035887635, 149.5310906801705, 250.63626266311618, 273.9957788155367, 200.35272573250992, 126.39999999999839, 244.70844491273658, 161.4782670974175, 74.17907876937146, 253.17736413012562, 54.174045543793845, 77.07848651699642, 129.4965341299502, 188.54223693913403, 405.41593904100915, 211.7873970393208, 348.8114081794483], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-0.7437910279948685, -143.7414375279006, -8.423608385634779, 6.1339197175724545, -167.22016585195703, -98.38910649078639, -31.985102568313692, 4.763529979867231, -139.99160238742977, -29.678777994048183, 35.513127614500554, 20.000000000000014, 96.6868065578117, -196.57913160045038, 77.22395568010397, -139.7995082335016, -47.088225627260684, -30.69746697848768, 30.365798676204893, -231.517539847852, 20.00772252926134, 22.5622351209299, 87.43434920716228, -206.19781487155493, -47.089783798030794, -172.25481077026464, 70.9480864676492, -146.39334919605994, 36.831132708644816, 5.174032150870041, -26.853199526854926, -197.0915465482398, 101.03479024774406, 35.17953049136801, -70.46329031015092, -33.63490521881863, -163.74508279397963, -56.672111680934066, -3.4134151074049273, -164.2463658249314, 75.20790549658324, -76.9746683938569, -118.04324973967242, 125.54231772860727, 18.55533674815988, 40.427798257411524, -44.865907461477846, -6.802879410556584, -153.50566171700137, 191.74380381880093, -119.52439693139792, 175.90839067152024, -224.42668538041428, 147.9391545727608, 36.360257965334284, -194.95421471248932, -26.207040098928303, -19.005611057581085, -127.61568597120663, 28.1, 20.000000000000014, -38.27935478623623, 99.80373211169785, -283.85123336435754, 61.782454652459265, 79.39999999999938, 2.5582793261988046, -135.22603143944804, -243.7740006736462, 111.3309306066955, 21.01342033452371, 85.78770701534785, 12.697942919241171, -82.65025399216755, 36.00674181271617, 106.55542139205174, 14.237045649318835, -50.754243148914014, -113.24098469765902, -233.17010458492948, -1.4108525069358233, 7.175193486355946, -315.84080131673693, 24.23628223865377, 172.1, 163.09999999999988, -9.044205403233889, -180.21809479083387, -158.3356678789227, 138.55763650724913, -182.24042868340857, 76.35476340724009, -165.4608824758396, 33.21808532601165, 8.486270519806231, -78.0506047453487, -203.13198566779633, -71.96972021453985, -347.5433465082441, 96.11139416526787, -64.98271986296145, -91.35418642621022, -108.87478304150505, 129.68242989019825, -104.35913534622537, -108.29893335375928, -17.492573524041212, 57.32117554659182, -289.25855259709544, -144.38745447982254, 198.1711554484475, -25.943285923305737, -8.778959716356633, -189.78543492290646, 173.0, 186.5, -78.42482942064144, -70.30385803096614, 20.817860470919207, -50.0298285324213, -61.173006758568114, 10.941025558835449, -40.77131586017275, 13.156544887547419, 36.257158031736054, -344.5393936762952, -162.05698240274484, -165.0946722954457, -61.6012054295431, -55.69430145380603, -76.38329043865319, 55.48661518431592, -157.88826712052526, -122.0795624589956, -125.49221001070359, -79.51946618523151, -324.4636975416422, 172.56166446143942, 0.8363578674912938, 187.4, -127.1942824589942, 4.469505469101859, -350.31654963012164, 20.987586656538472, -85.21626762406245, 146.89999999999995, -66.16690369607204, 136.94024605554424, -201.42656396882387, -317.082273028407, -108.33089399150533, -366.18651554926004, 11.65368732363656, 134.51070809436857, -85.95029927981383, -354.4078525039062, -321.4055738311878, -70.86122888246412, -76.44505094975284, -259.06687866484015, -53.936698082718266, -117.14068206307581, 18.117618031683776, -37.16512440610043, 44.35225718789286, -334.85426086224993, -20.290005926897894, -117.33545532935585, 7.728243879908254, -26.826448283344106, -103.3738558634471, 59.34102990235951, -183.82144262001074, 151.29117027816912, -348.36955339434735, 26.19437701656533, -126.04207914618189, -380.67814407118976, 11.007839983910326, -185.92885483914628, 8.354594871421702, -35.03498232449104, -452.00406089097925, 116.49432060758669, -284.9645363844737, -241.47652099465358, 122.54335208501105, -125.59040616934749, -364.8031876472011, 12.464707206805404, 20.000000000000014, -126.21402564539383, -87.96361555646392, -189.9898038089615, 26.842499581313994, -113.65124288610757, -15.443645467516365, -111.66504598104834, -19.31376038280105, -335.4382726767012, 149.08547792910238, -24.873574882953314, 1.4306836535884984, -39.899155143764, 20.622251944534643, -93.98216053855239, -7.691109911353237, -142.9055764285591, 135.1999999999996, 110.01038156813465, -113.79252843644659, 91.3846338018541, -388.2901862635763, -27.30183647785273, -99.42666109187267, -203.60271930902914, -43.16470872320984, -73.42162297324305, 156.01750045369886, -334.23784893398783, 33.68009120515606, -128.82789436936045, -7.836873614857746, 24.82545086343289, -146.16304396272028, -73.0197327971805, 169.30594250851513, -420.43737937222636, 58.69999999999996, 38.130845467414744, -318.18891598864417, 93.83246122186696, -5.185263312760579, -281.34680327630605, 153.80101342572073, -173.93190375204892, -188.4129822299167, -3.7378912319333395, 128.78213862544146, -332.9428180584878, 40.780483635616555, -317.2331936431281, -177.02751437496423, -332.29976882503746, -352.93836470980847, 19.758204466747188, -211.8826727776427, 35.411006608707055, 34.26889061502041, 48.9209357074006, 94.07027166294358, -242.13694679645363, -3.04991270842316, -228.3500599502431, -144.3863543891957, 69.20675134078122, -163.781094077145, -2.968481901400729, 118.14565692054744, -392.7858623894654, 27.599537672330534, -125.17109941346087, -156.6417207110635, -6.6397674499731, -19.830695782012782, 5.200030781601107, -128.08785077586225, -46.66168316277359, 51.730290918343606, 66.93081670108516, -283.25192918158467, -251.07494313995954, 144.38479738793464, -357.90047757139035, 20.000000000000014, 3.1575031660305934, -128.3309307327477, 85.1190856831657, 34.137846733214445, 20.000000000000014, -220.9790523453376, -431.9122647696911, -83.63311894988286, 34.36762756939793, -22.485349636291787, 43.91356461129224, -157.79997525265475, -96.28962949817888, -121.05292416099073, 35.433803664917164, 98.30264999287076, 143.18812841135252, 83.0096108309195, -260.11257905344905, 103.69999999999995, -110.39049815451044, -180.28425340800464, 136.04055678109566, -240.6079748753401, 131.9626608801749], "policy_predator_policy_reward": [99.86744657209633, 321.3703815878255, 171.16699893133296, 239.50974132806178, 109.02260939986606, 212.26107666331745, 41.01654167498809, 145.18312879779157, 295.31557733599817, 60.48583334479573, 253.44185891791864, 240.22032223296526, 168.70183277247887, 232.29589777685288, 127.27854450040972, 211.8631573504839, 73.9801622882097, 215.78236657557483, 120.77686220654893, 179.45134765432437, 199.5953068306333, 96.22917227117001, 276.4529303329315, 23.90892185527437, 186.65182596201345, 211.87301728594852, 172.3497382553377, 270.78996161877495, 113.67974448776354, 115.7026310967668, 116.31801841294066, 53.222970201682195, 262.9303897247121, 94.87564232618149, 52.465339087310504, 240.86333993367663, 79.98080389719144, 191.90359660880011, 140.605611057581, 141.21568597120586, 49.30007095519304, 67.74838556657882, 108.87297283038089, 260.67334468826294, 206.6977172866847, 355.81409805327166, 10.213801997180802, 123.40361019729855, 171.09587215512286, 61.32706516822522, 157.5864970388576, 73.46277486807419, 184.87809945188073, 349.9292498814777, 252.48994549630885, 149.0021607131211, 20.51351642943719, 14.98195946608053, 325.17823418509136, 100.4345167267528, 276.97005228498796, 229.983700076677, 106.2258230048944, 191.5955756668042, 283.87685524462637, 423.89954105036213, 254.59714305424475, 82.96341404607477, 130.60339437712562, 172.03929803538045, 184.1519724384384, 58.1963791430487, 474.4407770260447, 50.008630416995885, 146.1109041577486, 122.3351737898346, 80.96442775375581, 16.945115375176414, 59.2917192924834, 235.70396762764028, 55.94040129142067, 164.63723544554446, 373.088837503142, 49.551547285247544, 262.8647495208452, 271.3068021152088, 202.8514873440674, 51.412717039655874, 304.9211306056689, 258.6451729156569, 183.2019718482733, 337.3853134398722, 16.353318404253816, 139.3302468216366, 141.9593746078636, 265.6786705404445, 165.67830944353528, 65.56127357321859, 386.43186116593, 198.77759798249826, 281.99991902761235, 379.9242603473957, 355.6700811804745, 232.9319485334768, 398.19920821203317, 247.3866789562965, 118.93919754584579, 364.62718086903664, 57.63012478042335, 59.065124406100644, 277.527493064045, 322.834962889649, 220.62170140420386, 42.92644828334433, 204.80303696841972, 60.12168723077771, 239.8797022143996, 359.58509908123506, 275.96046577020735, 356.91984324753304, 449.2734622018123, 136.09429432905026, 344.77153012843144, 274.49850994387106, 245.59199659335525, 361.67423481378626, 114.6484268122515, 72.17285542117631, 288.31423923671105, 82.17154986242495, 168.94664343506548, 156.78346005040387, 285.09807887222934, 101.83732649162407, 148.557542576309, 17.169316346411478, 183.54493473086265, 181.00401113885772, 150.31248584710337, 24.88270901332028, 179.05851987569474, 391.267825755534, 290.71818020770127, 258.33097286404507, 90.71034815701462, 129.39014941003344, 19.91990879484414, 453.49750080736885, 133.5026765620724, 184.37384231401646, 398.103217676148, 157.53886414691118, 328.4904732931446, 152.89381076252073, 152.94706543915154, 190.19726448034402, 412.85233055327643, 58.428110433414375, 365.8667283872353, 77.2040984358857, 131.19563623382984, 509.88793594384094, 466.8185809444698, 343.2627243815143, 265.34935320012255, 144.08939205214023, 97.796733635182, 260.4831561498038, 263.665395578759, 261.6520221492734, 200.59714942844136, 147.5819378724394, 157.2136564745613, 363.8227901375631, 34.34509213382888, 454.4602211731796, 254.52297017846607, 14.595545597808124, 90.91979971961025, 81.78922073647163, 257.77494313995925, 293.6453988910677, 52.349104841123676, 356.5729483336076, 199.50017165847555, 62.75119078801772, 305.5589623901235, 381.5064002686987, 109.24397789748014, 39.58534963629203, 173.56147642963728, 166.1110978398558, 41.90155284357258, 133.9571545987647, 199.12446158795788, 240.20631726422766, 223.88658915560256, 174.875559446233, 72.25611857119559, 249.1600468223206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.700292671418321, "mean_inference_ms": 6.485318062323589, "mean_action_processing_ms": 3.3178348632368504, "mean_env_wait_ms": 16.974337729447868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0536501407623291, "StateBufferConnector_ms": 0.008569717407226562, "ViewRequirementAgentConnector_ms": 0.390508770942688}, "num_episodes": 7, "episode_return_max": 405.41593904100915, "episode_return_min": 43.93839738501445, "episode_return_mean": 200.1546168210626, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 57.61416743155183, "num_env_steps_trained_throughput_per_sec": 57.61416743155183, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 71567.252, "restore_workers_time_ms": 0.015, "training_step_time_ms": 71567.198, "sample_time_ms": 4681.644, "learn_time_ms": 66860.751, "learn_throughput": 59.826, "synch_weights_time_ms": 15.521}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 12, "trial_id": "62684_00000", "date": "2024-08-20_16-22-02", "timestamp": 1724151122, "time_this_iter_s": 69.46946406364441, "time_total_s": 855.217408657074, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb0a550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 855.217408657074, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 52.11530612244897, "ram_util_percent": 83.35204081632654}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.70399299904387, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.679659080674463, "policy_loss": -0.016506872044592197, "vf_loss": 6.693572597638935, "vf_explained_var": 0.25655918761770774, "kl": 0.012966818538501013, "entropy": 1.3603400139098472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 35250.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7205861146487886, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.162526638041098, "policy_loss": -0.021004690023178542, "vf_loss": 7.1803379414573545, "vf_explained_var": 0.16439102326751387, "kl": 0.015966933594878625, "entropy": 1.1235760260511327, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "env_runners": {"episode_reward_max": 405.41593904100915, "episode_reward_min": 43.93839738501445, "episode_reward_mean": 195.9032471139062, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -452.00406089097925, "predator_policy": 10.213801997180802}, "policy_reward_max": {"prey_policy": 198.1711554484475, "predator_policy": 509.88793594384094}, "policy_reward_mean": {"prey_policy": -67.22112448163857, "predator_policy": 198.7833102794111}, "custom_metrics": {}, "hist_stats": {"episode_reward": [195.8400255243281, 172.91452327445242, 231.4431871506039, 174.69423366564277, 277.12657115190746, 255.43678032162518, 158.2999999999988, 276.51977722129504, 392.7495388848546, 87.08340365990821, 163.2999999999994, 198.57283384723263, 226.87753880674416, 186.07006255306112, 351.74947015104675, 198.47736806313804, 301.0874957993891, 186.98540754383376, 117.06278061770138, 361.6512704922852, 225.61662474933684, 235.6072046096563, 261.47514977216747, 85.13134390440808, 277.3350449764155, 219.0912039149736, 173.87802025027815, 288.9745558145682, 43.93839738501445, 378.9847137082918, 195.47986082765422, 129.57433967705907, 127.51469403137676, 145.41869150832056, 177.67322767557945, 158.10626393110147, 289.16578602271125, 216.7256406343863, 82.77858764382682, 226.75641169661904, 203.64086820674095, 199.0604571578789, 282.75458602460003, 176.874033504924, 53.42211960424826, 141.9999999999992, 127.88273383518917, 141.0760894206638, 291.73548175971655, 151.2475457716704, 77.28115009131453, 106.68330818681437, 209.32330330076184, 239.41598967560398, 93.0719637948387, 119.37486931502494, 84.9701691507974, 181.2688502334529, 102.38481254959088, 283.4979273643493, 277.49999999999915, 159.62826473305913, 218.7179361929924, 259.53166632429327, 44.03175750402032, 188.70205216194313, 231.49091216216738, 260.0262135344343, 150.4447245522945, 262.7365684304455, 235.17225615814104, 187.60334779519508, 144.60137625788425, 267.23596969834824, 259.13415035887635, 149.5310906801705, 250.63626266311618, 273.9957788155367, 200.35272573250992, 126.39999999999839, 244.70844491273658, 161.4782670974175, 74.17907876937146, 253.17736413012562, 54.174045543793845, 77.07848651699642, 129.4965341299502, 188.54223693913403, 405.41593904100915, 211.7873970393208, 348.8114081794483, 185.22572766475133, 254.02764814181657, 159.13007982641827, 101.43284687561322, 145.8350295510867, 264.37051742464206, 51.30452746158086, 162.5817586346809, 249.96002934432224], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-146.39334919605994, 36.831132708644816, 5.174032150870041, -26.853199526854926, -197.0915465482398, 101.03479024774406, 35.17953049136801, -70.46329031015092, -33.63490521881863, -163.74508279397963, -56.672111680934066, -3.4134151074049273, -164.2463658249314, 75.20790549658324, -76.9746683938569, -118.04324973967242, 125.54231772860727, 18.55533674815988, 40.427798257411524, -44.865907461477846, -6.802879410556584, -153.50566171700137, 191.74380381880093, -119.52439693139792, 175.90839067152024, -224.42668538041428, 147.9391545727608, 36.360257965334284, -194.95421471248932, -26.207040098928303, -19.005611057581085, -127.61568597120663, 28.1, 20.000000000000014, -38.27935478623623, 99.80373211169785, -283.85123336435754, 61.782454652459265, 79.39999999999938, 2.5582793261988046, -135.22603143944804, -243.7740006736462, 111.3309306066955, 21.01342033452371, 85.78770701534785, 12.697942919241171, -82.65025399216755, 36.00674181271617, 106.55542139205174, 14.237045649318835, -50.754243148914014, -113.24098469765902, -233.17010458492948, -1.4108525069358233, 7.175193486355946, -315.84080131673693, 24.23628223865377, 172.1, 163.09999999999988, -9.044205403233889, -180.21809479083387, -158.3356678789227, 138.55763650724913, -182.24042868340857, 76.35476340724009, -165.4608824758396, 33.21808532601165, 8.486270519806231, -78.0506047453487, -203.13198566779633, -71.96972021453985, -347.5433465082441, 96.11139416526787, -64.98271986296145, -91.35418642621022, -108.87478304150505, 129.68242989019825, -104.35913534622537, -108.29893335375928, -17.492573524041212, 57.32117554659182, -289.25855259709544, -144.38745447982254, 198.1711554484475, -25.943285923305737, -8.778959716356633, -189.78543492290646, 173.0, 186.5, -78.42482942064144, -70.30385803096614, 20.817860470919207, -50.0298285324213, -61.173006758568114, 10.941025558835449, -40.77131586017275, 13.156544887547419, 36.257158031736054, -344.5393936762952, -162.05698240274484, -165.0946722954457, -61.6012054295431, -55.69430145380603, -76.38329043865319, 55.48661518431592, -157.88826712052526, -122.0795624589956, -125.49221001070359, -79.51946618523151, -324.4636975416422, 172.56166446143942, 0.8363578674912938, 187.4, -127.1942824589942, 4.469505469101859, -350.31654963012164, 20.987586656538472, -85.21626762406245, 146.89999999999995, -66.16690369607204, 136.94024605554424, -201.42656396882387, -317.082273028407, -108.33089399150533, -366.18651554926004, 11.65368732363656, 134.51070809436857, -85.95029927981383, -354.4078525039062, -321.4055738311878, -70.86122888246412, -76.44505094975284, -259.06687866484015, -53.936698082718266, -117.14068206307581, 18.117618031683776, -37.16512440610043, 44.35225718789286, -334.85426086224993, -20.290005926897894, -117.33545532935585, 7.728243879908254, -26.826448283344106, -103.3738558634471, 59.34102990235951, -183.82144262001074, 151.29117027816912, -348.36955339434735, 26.19437701656533, -126.04207914618189, -380.67814407118976, 11.007839983910326, -185.92885483914628, 8.354594871421702, -35.03498232449104, -452.00406089097925, 116.49432060758669, -284.9645363844737, -241.47652099465358, 122.54335208501105, -125.59040616934749, -364.8031876472011, 12.464707206805404, 20.000000000000014, -126.21402564539383, -87.96361555646392, -189.9898038089615, 26.842499581313994, -113.65124288610757, -15.443645467516365, -111.66504598104834, -19.31376038280105, -335.4382726767012, 149.08547792910238, -24.873574882953314, 1.4306836535884984, -39.899155143764, 20.622251944534643, -93.98216053855239, -7.691109911353237, -142.9055764285591, 135.1999999999996, 110.01038156813465, -113.79252843644659, 91.3846338018541, -388.2901862635763, -27.30183647785273, -99.42666109187267, -203.60271930902914, -43.16470872320984, -73.42162297324305, 156.01750045369886, -334.23784893398783, 33.68009120515606, -128.82789436936045, -7.836873614857746, 24.82545086343289, -146.16304396272028, -73.0197327971805, 169.30594250851513, -420.43737937222636, 58.69999999999996, 38.130845467414744, -318.18891598864417, 93.83246122186696, -5.185263312760579, -281.34680327630605, 153.80101342572073, -173.93190375204892, -188.4129822299167, -3.7378912319333395, 128.78213862544146, -332.9428180584878, 40.780483635616555, -317.2331936431281, -177.02751437496423, -332.29976882503746, -352.93836470980847, 19.758204466747188, -211.8826727776427, 35.411006608707055, 34.26889061502041, 48.9209357074006, 94.07027166294358, -242.13694679645363, -3.04991270842316, -228.3500599502431, -144.3863543891957, 69.20675134078122, -163.781094077145, -2.968481901400729, 118.14565692054744, -392.7858623894654, 27.599537672330534, -125.17109941346087, -156.6417207110635, -6.6397674499731, -19.830695782012782, 5.200030781601107, -128.08785077586225, -46.66168316277359, 51.730290918343606, 66.93081670108516, -283.25192918158467, -251.07494313995954, 144.38479738793464, -357.90047757139035, 20.000000000000014, 3.1575031660305934, -128.3309307327477, 85.1190856831657, 34.137846733214445, 20.000000000000014, -220.9790523453376, -431.9122647696911, -83.63311894988286, 34.36762756939793, -22.485349636291787, 43.91356461129224, -157.79997525265475, -96.28962949817888, -121.05292416099073, 35.433803664917164, 98.30264999287076, 143.18812841135252, 83.0096108309195, -260.11257905344905, 103.69999999999995, -110.39049815451044, -180.28425340800464, 136.04055678109566, -240.6079748753401, 131.9626608801749, -287.00701446889707, 18.735271629304652, -375.058561813338, -336.2569945436995, 197.23317773099973, 20.000000000000014, 4.783640524651805, -64.32971175721758, 19.033614913787453, -71.0129666293058, -360.33333190468176, -118.73249716010392, -51.518254992457074, -85.71688699258422, 85.69999999999997, -388.8341485955631, 105.95133725193207, -167.3640236195365, -303.0515465742486, 17.553677961371086, -421.7903425985992, -264.42828305801874, 70.62237983750657, 20.25213321906849, -288.51780803533035, 30.993678047485552, 20.000000000000014], "policy_predator_policy_reward": [120.77686220654893, 179.45134765432437, 199.5953068306333, 96.22917227117001, 276.4529303329315, 23.90892185527437, 186.65182596201345, 211.87301728594852, 172.3497382553377, 270.78996161877495, 113.67974448776354, 115.7026310967668, 116.31801841294066, 53.222970201682195, 262.9303897247121, 94.87564232618149, 52.465339087310504, 240.86333993367663, 79.98080389719144, 191.90359660880011, 140.605611057581, 141.21568597120586, 49.30007095519304, 67.74838556657882, 108.87297283038089, 260.67334468826294, 206.6977172866847, 355.81409805327166, 10.213801997180802, 123.40361019729855, 171.09587215512286, 61.32706516822522, 157.5864970388576, 73.46277486807419, 184.87809945188073, 349.9292498814777, 252.48994549630885, 149.0021607131211, 20.51351642943719, 14.98195946608053, 325.17823418509136, 100.4345167267528, 276.97005228498796, 229.983700076677, 106.2258230048944, 191.5955756668042, 283.87685524462637, 423.89954105036213, 254.59714305424475, 82.96341404607477, 130.60339437712562, 172.03929803538045, 184.1519724384384, 58.1963791430487, 474.4407770260447, 50.008630416995885, 146.1109041577486, 122.3351737898346, 80.96442775375581, 16.945115375176414, 59.2917192924834, 235.70396762764028, 55.94040129142067, 164.63723544554446, 373.088837503142, 49.551547285247544, 262.8647495208452, 271.3068021152088, 202.8514873440674, 51.412717039655874, 304.9211306056689, 258.6451729156569, 183.2019718482733, 337.3853134398722, 16.353318404253816, 139.3302468216366, 141.9593746078636, 265.6786705404445, 165.67830944353528, 65.56127357321859, 386.43186116593, 198.77759798249826, 281.99991902761235, 379.9242603473957, 355.6700811804745, 232.9319485334768, 398.19920821203317, 247.3866789562965, 118.93919754584579, 364.62718086903664, 57.63012478042335, 59.065124406100644, 277.527493064045, 322.834962889649, 220.62170140420386, 42.92644828334433, 204.80303696841972, 60.12168723077771, 239.8797022143996, 359.58509908123506, 275.96046577020735, 356.91984324753304, 449.2734622018123, 136.09429432905026, 344.77153012843144, 274.49850994387106, 245.59199659335525, 361.67423481378626, 114.6484268122515, 72.17285542117631, 288.31423923671105, 82.17154986242495, 168.94664343506548, 156.78346005040387, 285.09807887222934, 101.83732649162407, 148.557542576309, 17.169316346411478, 183.54493473086265, 181.00401113885772, 150.31248584710337, 24.88270901332028, 179.05851987569474, 391.267825755534, 290.71818020770127, 258.33097286404507, 90.71034815701462, 129.39014941003344, 19.91990879484414, 453.49750080736885, 133.5026765620724, 184.37384231401646, 398.103217676148, 157.53886414691118, 328.4904732931446, 152.89381076252073, 152.94706543915154, 190.19726448034402, 412.85233055327643, 58.428110433414375, 365.8667283872353, 77.2040984358857, 131.19563623382984, 509.88793594384094, 466.8185809444698, 343.2627243815143, 265.34935320012255, 144.08939205214023, 97.796733635182, 260.4831561498038, 263.665395578759, 261.6520221492734, 200.59714942844136, 147.5819378724394, 157.2136564745613, 363.8227901375631, 34.34509213382888, 454.4602211731796, 254.52297017846607, 14.595545597808124, 90.91979971961025, 81.78922073647163, 257.77494313995925, 293.6453988910677, 52.349104841123676, 356.5729483336076, 199.50017165847555, 62.75119078801772, 305.5589623901235, 381.5064002686987, 109.24397789748014, 39.58534963629203, 173.56147642963728, 166.1110978398558, 41.90155284357258, 133.9571545987647, 199.12446158795788, 240.20631726422766, 223.88658915560256, 174.875559446233, 72.25611857119559, 249.1600468223206, 394.08692213145963, 434.46911018622166, 344.95699454370146, 28.094470410818126, 176.1618525758006, 23.480683569396746, 279.1192813351261, 372.39236123457874, 108.31688699258345, 89.05328454354435, 465.14274515840424, 249.47460722940554, 334.28746094343506, 424.30527772962205, 57.68368194171668, 278.4518466944092, 178.58977074023, 308.8943885919406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.625822728135828, "mean_inference_ms": 6.410595464314167, "mean_action_processing_ms": 3.347319108600733, "mean_env_wait_ms": 17.11275848533592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036022186279296875, "StateBufferConnector_ms": 0.008598566055297852, "ViewRequirementAgentConnector_ms": 0.38024747371673584}, "num_episodes": 9, "episode_return_max": 405.41593904100915, "episode_return_min": 43.93839738501445, "episode_return_mean": 195.9032471139062, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 57.75219224096533, "num_env_steps_trained_throughput_per_sec": 57.75219224096533, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 71580.313, "restore_workers_time_ms": 0.016, "training_step_time_ms": 71580.256, "sample_time_ms": 4657.768, "learn_time_ms": 66897.576, "learn_throughput": 59.793, "synch_weights_time_ms": 15.198}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "training_iteration": 13, "trial_id": "62684_00000", "date": "2024-08-20_16-23-11", "timestamp": 1724151191, "time_this_iter_s": 69.31452703475952, "time_total_s": 924.5319356918335, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ff92790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 924.5319356918335, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 52.88775510204081, "ram_util_percent": 83.36938775510203}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.025625861113799, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.506392313571687, "policy_loss": -0.017870602084171846, "vf_loss": 6.521680487470424, "vf_explained_var": 0.3497184403821932, "kl": 0.012912117604311582, "entropy": 1.344760849754861, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 38070.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4024003375774967, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.202777528258228, "policy_loss": -0.018404229264459993, "vf_loss": 7.218005020151693, "vf_explained_var": 0.17300271909072917, "kl": 0.015883687742192436, "entropy": 1.070267210246394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 405.41593904100915, "episode_reward_min": 43.93839738501445, "episode_reward_mean": 179.04604917644076, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -544.9503037277098, "predator_policy": 3.597121874057696}, "policy_reward_max": {"prey_policy": 198.1711554484475, "predator_policy": 540.1042424180976}, "policy_reward_mean": {"prey_policy": -88.30703574223212, "predator_policy": 221.98357820156875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [219.0912039149736, 173.87802025027815, 288.9745558145682, 43.93839738501445, 378.9847137082918, 195.47986082765422, 129.57433967705907, 127.51469403137676, 145.41869150832056, 177.67322767557945, 158.10626393110147, 289.16578602271125, 216.7256406343863, 82.77858764382682, 226.75641169661904, 203.64086820674095, 199.0604571578789, 282.75458602460003, 176.874033504924, 53.42211960424826, 141.9999999999992, 127.88273383518917, 141.0760894206638, 291.73548175971655, 151.2475457716704, 77.28115009131453, 106.68330818681437, 209.32330330076184, 239.41598967560398, 93.0719637948387, 119.37486931502494, 84.9701691507974, 181.2688502334529, 102.38481254959088, 283.4979273643493, 277.49999999999915, 159.62826473305913, 218.7179361929924, 259.53166632429327, 44.03175750402032, 188.70205216194313, 231.49091216216738, 260.0262135344343, 150.4447245522945, 262.7365684304455, 235.17225615814104, 187.60334779519508, 144.60137625788425, 267.23596969834824, 259.13415035887635, 149.5310906801705, 250.63626266311618, 273.9957788155367, 200.35272573250992, 126.39999999999839, 244.70844491273658, 161.4782670974175, 74.17907876937146, 253.17736413012562, 54.174045543793845, 77.07848651699642, 129.4965341299502, 188.54223693913403, 405.41593904100915, 211.7873970393208, 348.8114081794483, 185.22572766475133, 254.02764814181657, 159.13007982641827, 101.43284687561322, 145.8350295510867, 264.37051742464206, 51.30452746158086, 162.5817586346809, 249.96002934432224, 131.95777008698295, 101.04545724426475, 153.708396350302, 79.7661089447633, 116.90075801235135, 64.38521114274677, 59.62674087421323, 55.39892198952673, 160.45011966975105, 171.80772880435487, 181.19698207327335, 109.27035342596348, 300.2126986995506, 236.4068697925528, 85.72375933623584, 205.99999317245997, 96.68382367332492, 281.2231469944438, 124.72294513987617, 140.78437092912205, 258.53073302593924, 201.3227067018956, 293.15720554534494, 180.94483528860474, 122.1602060766476], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-108.87478304150505, 129.68242989019825, -104.35913534622537, -108.29893335375928, -17.492573524041212, 57.32117554659182, -289.25855259709544, -144.38745447982254, 198.1711554484475, -25.943285923305737, -8.778959716356633, -189.78543492290646, 173.0, 186.5, -78.42482942064144, -70.30385803096614, 20.817860470919207, -50.0298285324213, -61.173006758568114, 10.941025558835449, -40.77131586017275, 13.156544887547419, 36.257158031736054, -344.5393936762952, -162.05698240274484, -165.0946722954457, -61.6012054295431, -55.69430145380603, -76.38329043865319, 55.48661518431592, -157.88826712052526, -122.0795624589956, -125.49221001070359, -79.51946618523151, -324.4636975416422, 172.56166446143942, 0.8363578674912938, 187.4, -127.1942824589942, 4.469505469101859, -350.31654963012164, 20.987586656538472, -85.21626762406245, 146.89999999999995, -66.16690369607204, 136.94024605554424, -201.42656396882387, -317.082273028407, -108.33089399150533, -366.18651554926004, 11.65368732363656, 134.51070809436857, -85.95029927981383, -354.4078525039062, -321.4055738311878, -70.86122888246412, -76.44505094975284, -259.06687866484015, -53.936698082718266, -117.14068206307581, 18.117618031683776, -37.16512440610043, 44.35225718789286, -334.85426086224993, -20.290005926897894, -117.33545532935585, 7.728243879908254, -26.826448283344106, -103.3738558634471, 59.34102990235951, -183.82144262001074, 151.29117027816912, -348.36955339434735, 26.19437701656533, -126.04207914618189, -380.67814407118976, 11.007839983910326, -185.92885483914628, 8.354594871421702, -35.03498232449104, -452.00406089097925, 116.49432060758669, -284.9645363844737, -241.47652099465358, 122.54335208501105, -125.59040616934749, -364.8031876472011, 12.464707206805404, 20.000000000000014, -126.21402564539383, -87.96361555646392, -189.9898038089615, 26.842499581313994, -113.65124288610757, -15.443645467516365, -111.66504598104834, -19.31376038280105, -335.4382726767012, 149.08547792910238, -24.873574882953314, 1.4306836535884984, -39.899155143764, 20.622251944534643, -93.98216053855239, -7.691109911353237, -142.9055764285591, 135.1999999999996, 110.01038156813465, -113.79252843644659, 91.3846338018541, -388.2901862635763, -27.30183647785273, -99.42666109187267, -203.60271930902914, -43.16470872320984, -73.42162297324305, 156.01750045369886, -334.23784893398783, 33.68009120515606, -128.82789436936045, -7.836873614857746, 24.82545086343289, -146.16304396272028, -73.0197327971805, 169.30594250851513, -420.43737937222636, 58.69999999999996, 38.130845467414744, -318.18891598864417, 93.83246122186696, -5.185263312760579, -281.34680327630605, 153.80101342572073, -173.93190375204892, -188.4129822299167, -3.7378912319333395, 128.78213862544146, -332.9428180584878, 40.780483635616555, -317.2331936431281, -177.02751437496423, -332.29976882503746, -352.93836470980847, 19.758204466747188, -211.8826727776427, 35.411006608707055, 34.26889061502041, 48.9209357074006, 94.07027166294358, -242.13694679645363, -3.04991270842316, -228.3500599502431, -144.3863543891957, 69.20675134078122, -163.781094077145, -2.968481901400729, 118.14565692054744, -392.7858623894654, 27.599537672330534, -125.17109941346087, -156.6417207110635, -6.6397674499731, -19.830695782012782, 5.200030781601107, -128.08785077586225, -46.66168316277359, 51.730290918343606, 66.93081670108516, -283.25192918158467, -251.07494313995954, 144.38479738793464, -357.90047757139035, 20.000000000000014, 3.1575031660305934, -128.3309307327477, 85.1190856831657, 34.137846733214445, 20.000000000000014, -220.9790523453376, -431.9122647696911, -83.63311894988286, 34.36762756939793, -22.485349636291787, 43.91356461129224, -157.79997525265475, -96.28962949817888, -121.05292416099073, 35.433803664917164, 98.30264999287076, 143.18812841135252, 83.0096108309195, -260.11257905344905, 103.69999999999995, -110.39049815451044, -180.28425340800464, 136.04055678109566, -240.6079748753401, 131.9626608801749, -287.00701446889707, 18.735271629304652, -375.058561813338, -336.2569945436995, 197.23317773099973, 20.000000000000014, 4.783640524651805, -64.32971175721758, 19.033614913787453, -71.0129666293058, -360.33333190468176, -118.73249716010392, -51.518254992457074, -85.71688699258422, 85.69999999999997, -388.8341485955631, 105.95133725193207, -167.3640236195365, -303.0515465742486, 17.553677961371086, -421.7903425985992, -264.42828305801874, 70.62237983750657, 20.25213321906849, -288.51780803533035, 30.993678047485552, 20.000000000000014, -201.18048463239674, 91.97904153467331, -431.7271267971864, -544.9503037277098, 25.363720462683744, 20.000000000000014, -34.374898423953, -54.993228289430014, -164.11484638623688, -181.99631711717652, -371.1543695364875, 12.824348924041438, 23.100998988139654, 10.678665152350952, -172.83617811093367, -158.11838784124825, -145.5549297214244, 43.769722766930386, -343.06323954031564, -13.361428412107568, -365.7295641223037, -71.1773135160903, -437.9172689356735, 20.000000000000014, -232.2856947299634, -488.0723544193833, 84.65911053666727, -45.875446124459216, -179.50526738521773, -165.44298942314612, -346.8763786698971, -312.5453948030466, 64.91184408006333, -117.29299762523127, 17.94584676972757, -396.2723062953906, -166.98418689493957, 139.73528567074584, -232.54845273352447, 24.872014278968077, -119.8104333891726, -72.65502302503937, -141.85348702150532, -256.6235274147732, -33.868235194571135, -404.4476966964415, -22.817240782986516, 11.300450408553516, -39.44871606699698, 20.000000000000014, -102.17454811909646, 45.41197315222365, -49.781592489820135, -155.06017249825015, -18.666308133091846, -152.22869758623034, 6.164281023817165, -47.22319612068073, -197.42447612872928, -179.479367787807, 31.093038183624177, -304.413267503148, -135.4824383006338, -154.69771729607945, 1.682966521183577, 64.7627194593811, -316.0465430171834, -59.86075740025454, 102.34866863119835, 15.644835288605307, 135.81344947867376, -208.82513551541533, -78.36324768496848, 20.000000000000014, -369.0843980242528], "policy_predator_policy_reward": [130.60339437712562, 172.03929803538045, 184.1519724384384, 58.1963791430487, 474.4407770260447, 50.008630416995885, 146.1109041577486, 122.3351737898346, 80.96442775375581, 16.945115375176414, 59.2917192924834, 235.70396762764028, 55.94040129142067, 164.63723544554446, 373.088837503142, 49.551547285247544, 262.8647495208452, 271.3068021152088, 202.8514873440674, 51.412717039655874, 304.9211306056689, 258.6451729156569, 183.2019718482733, 337.3853134398722, 16.353318404253816, 139.3302468216366, 141.9593746078636, 265.6786705404445, 165.67830944353528, 65.56127357321859, 386.43186116593, 198.77759798249826, 281.99991902761235, 379.9242603473957, 355.6700811804745, 232.9319485334768, 398.19920821203317, 247.3866789562965, 118.93919754584579, 364.62718086903664, 57.63012478042335, 59.065124406100644, 277.527493064045, 322.834962889649, 220.62170140420386, 42.92644828334433, 204.80303696841972, 60.12168723077771, 239.8797022143996, 359.58509908123506, 275.96046577020735, 356.91984324753304, 449.2734622018123, 136.09429432905026, 344.77153012843144, 274.49850994387106, 245.59199659335525, 361.67423481378626, 114.6484268122515, 72.17285542117631, 288.31423923671105, 82.17154986242495, 168.94664343506548, 156.78346005040387, 285.09807887222934, 101.83732649162407, 148.557542576309, 17.169316346411478, 183.54493473086265, 181.00401113885772, 150.31248584710337, 24.88270901332028, 179.05851987569474, 391.267825755534, 290.71818020770127, 258.33097286404507, 90.71034815701462, 129.39014941003344, 19.91990879484414, 453.49750080736885, 133.5026765620724, 184.37384231401646, 398.103217676148, 157.53886414691118, 328.4904732931446, 152.89381076252073, 152.94706543915154, 190.19726448034402, 412.85233055327643, 58.428110433414375, 365.8667283872353, 77.2040984358857, 131.19563623382984, 509.88793594384094, 466.8185809444698, 343.2627243815143, 265.34935320012255, 144.08939205214023, 97.796733635182, 260.4831561498038, 263.665395578759, 261.6520221492734, 200.59714942844136, 147.5819378724394, 157.2136564745613, 363.8227901375631, 34.34509213382888, 454.4602211731796, 254.52297017846607, 14.595545597808124, 90.91979971961025, 81.78922073647163, 257.77494313995925, 293.6453988910677, 52.349104841123676, 356.5729483336076, 199.50017165847555, 62.75119078801772, 305.5589623901235, 381.5064002686987, 109.24397789748014, 39.58534963629203, 173.56147642963728, 166.1110978398558, 41.90155284357258, 133.9571545987647, 199.12446158795788, 240.20631726422766, 223.88658915560256, 174.875559446233, 72.25611857119559, 249.1600468223206, 394.08692213145963, 434.46911018622166, 344.95699454370146, 28.094470410818126, 176.1618525758006, 23.480683569396746, 279.1192813351261, 372.39236123457874, 108.31688699258345, 89.05328454354435, 465.14274515840424, 249.47460722940554, 334.28746094343506, 424.30527772962205, 57.68368194171668, 278.4518466944092, 178.58977074023, 308.8943885919406, 193.22665961232298, 479.65968036956997, 60.527798091193816, 540.1042424180976, 130.9687647342449, 276.2226047156785, 386.46402617930227, 233.62842049508328, 3.597121874057696, 252.3601501087383, 71.85809061183743, 252.4307153266502, 433.61773340862476, 348.16323954031554, 246.77939332151277, 297.7141111197767, 360.7373328084291, 435.41172547400055, 315.0687146506275, 247.5627170865499, 410.10963359038124, 365.59727787577316, 301.0851773668945, 303.80463320996324, 375.4233058713012, 184.5867467859679, 171.40515484289682, 232.59515708490017, 198.7471573703692, 319.3218515967163, 316.5920812516756, 305.37239899165934, 78.81020508119198, 139.49688277822818, 258.1873384142535, 182.46560041603652, 114.07886298164517, 175.37480685373717, 263.1448255598119, 301.7665854065283, 303.7914818879679, 363.54191875812955, 128.56872873662857, 161.00600928078262, 345.97397298296113, 220.741864348625, 17.705032121780075, 220.60665391496138, 171.74956469484124, 377.8582870910275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.51572899857884, "mean_inference_ms": 6.392355770342788, "mean_action_processing_ms": 3.1683492926116776, "mean_env_wait_ms": 17.307629771087594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0344012975692749, "StateBufferConnector_ms": 0.00905156135559082, "ViewRequirementAgentConnector_ms": 0.4328441619873047}, "num_episodes": 25, "episode_return_max": 405.41593904100915, "episode_return_min": 43.93839738501445, "episode_return_mean": 179.04604917644076, "episodes_this_iter": 25}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 53.71213858822415, "num_env_steps_trained_throughput_per_sec": 53.71213858822415, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 71594.538, "restore_workers_time_ms": 0.017, "training_step_time_ms": 71594.478, "sample_time_ms": 4329.199, "learn_time_ms": 67240.027, "learn_throughput": 59.488, "synch_weights_time_ms": 15.514}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 14, "trial_id": "62684_00000", "date": "2024-08-20_16-24-26", "timestamp": 1724151266, "time_this_iter_s": 74.52665686607361, "time_total_s": 999.0585925579071, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ff92dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 999.0585925579071, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 56.90666666666666, "ram_util_percent": 83.38666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.708853356931226, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.825165171487957, "policy_loss": -0.017115275690444343, "vf_loss": 6.839505455341745, "vf_explained_var": 0.36287291777049396, "kl": 0.013874975375084747, "entropy": 1.3157358031323616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 40890.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6050146859789653, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.350627202836294, "policy_loss": -0.020420553428046998, "vf_loss": 7.367990216754731, "vf_explained_var": 0.17308234509336887, "kl": 0.015287696831076154, "entropy": 1.0197804272490203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "env_runners": {"episode_reward_max": 405.41593904100915, "episode_reward_min": 22.30000000000004, "episode_reward_mean": 173.85117243408288, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -620.1582312379982, "predator_policy": 3.597121874057696}, "policy_reward_max": {"prey_policy": 197.23317773099973, "predator_policy": 616.3818232844333}, "policy_reward_mean": {"prey_policy": -111.32505392709353, "predator_policy": 253.9131671076819}, "custom_metrics": {}, "hist_stats": {"episode_reward": [259.53166632429327, 44.03175750402032, 188.70205216194313, 231.49091216216738, 260.0262135344343, 150.4447245522945, 262.7365684304455, 235.17225615814104, 187.60334779519508, 144.60137625788425, 267.23596969834824, 259.13415035887635, 149.5310906801705, 250.63626266311618, 273.9957788155367, 200.35272573250992, 126.39999999999839, 244.70844491273658, 161.4782670974175, 74.17907876937146, 253.17736413012562, 54.174045543793845, 77.07848651699642, 129.4965341299502, 188.54223693913403, 405.41593904100915, 211.7873970393208, 348.8114081794483, 185.22572766475133, 254.02764814181657, 159.13007982641827, 101.43284687561322, 145.8350295510867, 264.37051742464206, 51.30452746158086, 162.5817586346809, 249.96002934432224, 131.95777008698295, 101.04545724426475, 153.708396350302, 79.7661089447633, 116.90075801235135, 64.38521114274677, 59.62674087421323, 55.39892198952673, 160.45011966975105, 171.80772880435487, 181.19698207327335, 109.27035342596348, 300.2126986995506, 236.4068697925528, 85.72375933623584, 205.99999317245997, 96.68382367332492, 281.2231469944438, 124.72294513987617, 140.78437092912205, 258.53073302593924, 201.3227067018956, 293.15720554534494, 180.94483528860474, 122.1602060766476, 229.0542655302679, 192.04156670816127, 65.63819537595606, 205.05174271759816, 233.92722807621976, 203.40716243646236, 149.29428048502822, 72.12981353636576, 206.15292762377402, 208.355324365005, 136.89370345065885, 257.5200589933162, 22.30000000000004, 112.36418917382215, 301.95884098290145, 285.13071702473985, 150.03084571288326, 186.37347077499018, 126.51541733210887, 52.58419912170008, 215.21656738912242, 203.51486601119896, 169.90215016711895, 143.82404722893077, 87.959888556331, 64.50000000000034, 56.73552306361455, 202.43177081651518, 153.646362676101, 146.93319140559933, 210.1380032567985, 191.1600374687302, 74.45989413315175, 124.17790436873538, 95.29404295098422, 298.75439892056795, 205.15047796298893, 216.86210456175093], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-43.16470872320984, -73.42162297324305, 156.01750045369886, -334.23784893398783, 33.68009120515606, -128.82789436936045, -7.836873614857746, 24.82545086343289, -146.16304396272028, -73.0197327971805, 169.30594250851513, -420.43737937222636, 58.69999999999996, 38.130845467414744, -318.18891598864417, 93.83246122186696, -5.185263312760579, -281.34680327630605, 153.80101342572073, -173.93190375204892, -188.4129822299167, -3.7378912319333395, 128.78213862544146, -332.9428180584878, 40.780483635616555, -317.2331936431281, -177.02751437496423, -332.29976882503746, -352.93836470980847, 19.758204466747188, -211.8826727776427, 35.411006608707055, 34.26889061502041, 48.9209357074006, 94.07027166294358, -242.13694679645363, -3.04991270842316, -228.3500599502431, -144.3863543891957, 69.20675134078122, -163.781094077145, -2.968481901400729, 118.14565692054744, -392.7858623894654, 27.599537672330534, -125.17109941346087, -156.6417207110635, -6.6397674499731, -19.830695782012782, 5.200030781601107, -128.08785077586225, -46.66168316277359, 51.730290918343606, 66.93081670108516, -283.25192918158467, -251.07494313995954, 144.38479738793464, -357.90047757139035, 20.000000000000014, 3.1575031660305934, -128.3309307327477, 85.1190856831657, 34.137846733214445, 20.000000000000014, -220.9790523453376, -431.9122647696911, -83.63311894988286, 34.36762756939793, -22.485349636291787, 43.91356461129224, -157.79997525265475, -96.28962949817888, -121.05292416099073, 35.433803664917164, 98.30264999287076, 143.18812841135252, 83.0096108309195, -260.11257905344905, 103.69999999999995, -110.39049815451044, -180.28425340800464, 136.04055678109566, -240.6079748753401, 131.9626608801749, -287.00701446889707, 18.735271629304652, -375.058561813338, -336.2569945436995, 197.23317773099973, 20.000000000000014, 4.783640524651805, -64.32971175721758, 19.033614913787453, -71.0129666293058, -360.33333190468176, -118.73249716010392, -51.518254992457074, -85.71688699258422, 85.69999999999997, -388.8341485955631, 105.95133725193207, -167.3640236195365, -303.0515465742486, 17.553677961371086, -421.7903425985992, -264.42828305801874, 70.62237983750657, 20.25213321906849, -288.51780803533035, 30.993678047485552, 20.000000000000014, -201.18048463239674, 91.97904153467331, -431.7271267971864, -544.9503037277098, 25.363720462683744, 20.000000000000014, -34.374898423953, -54.993228289430014, -164.11484638623688, -181.99631711717652, -371.1543695364875, 12.824348924041438, 23.100998988139654, 10.678665152350952, -172.83617811093367, -158.11838784124825, -145.5549297214244, 43.769722766930386, -343.06323954031564, -13.361428412107568, -365.7295641223037, -71.1773135160903, -437.9172689356735, 20.000000000000014, -232.2856947299634, -488.0723544193833, 84.65911053666727, -45.875446124459216, -179.50526738521773, -165.44298942314612, -346.8763786698971, -312.5453948030466, 64.91184408006333, -117.29299762523127, 17.94584676972757, -396.2723062953906, -166.98418689493957, 139.73528567074584, -232.54845273352447, 24.872014278968077, -119.8104333891726, -72.65502302503937, -141.85348702150532, -256.6235274147732, -33.868235194571135, -404.4476966964415, -22.817240782986516, 11.300450408553516, -39.44871606699698, 20.000000000000014, -102.17454811909646, 45.41197315222365, -49.781592489820135, -155.06017249825015, -18.666308133091846, -152.22869758623034, 6.164281023817165, -47.22319612068073, -197.42447612872928, -179.479367787807, 31.093038183624177, -304.413267503148, -135.4824383006338, -154.69771729607945, 1.682966521183577, 64.7627194593811, -316.0465430171834, -59.86075740025454, 102.34866863119835, 15.644835288605307, 135.81344947867376, -208.82513551541533, -78.36324768496848, 20.000000000000014, -369.0843980242528, -173.83719832575474, -110.27075777314963, -272.25766593412067, -429.1902092546789, 33.37725094042431, 20.000000000000014, -231.57410021491316, -221.27158241822767, 20.000000000000014, 120.64456148821725, -146.50434657857105, -514.2452105908039, -319.87932845426377, 154.94643058002555, -190.80691312249692, 169.55852157760046, -309.9368400748396, -170.74410007153693, -183.28737793564903, -97.09906116434865, 20.000000000000014, 7.096274677908577, -107.25755893751887, -620.1582312379982, -148.8437276583422, 82.82508215731364, -173.19568395483677, 46.4195696191015, -85.90720991025508, -96.8553945943014, -8.619127642964234, 20.000000000000014, -127.1333518733212, -252.26811983495526, -601.6927310475658, 96.73807320668081, 20.000000000000014, -429.691969041711, -441.3944572533466, -56.35288148022706, 12.104271955167308, -511.5764846203217, -132.04240657753556, 171.42605627780486, 51.499999999999964, -186.08916746266948, 129.2154296908897, -142.19798390438206, -67.2455591841339, -334.64303177734917, -41.47247423262782, -580.3361138466732, 20.000000000000014, -182.61849270432688, -116.69894652735624, 73.62417625171936, -447.19972787646043, -4.827612615253083, 20.000000000000014, -416.8938236724582, 18.855806471564417, -263.8741140930558, -200.8561970998682, 151.910032488366, -581.0834751276385, 13.183893980496297, -128.52998611289067, -195.90444100575831, -133.47130934396256, -249.97272126557917, -151.52930639204902, -211.43926933076062, -65.7108559331469, -318.7176325960045, -58.971305319890384, -325.42692981489284, -112.55150443129583, 20.000000000000014, -53.529389643135715, -108.92041308406431, -406.28678850545697, 20.000000000000014, 132.5241714645022, -490.117658162411, -32.0159417196334, 20.000000000000014, -592.0798797922567, 47.33725363671326, -305.85985550094523, 20.000000000000014, -100.95155875478889, -154.9079579467863, -28.804679057335278, 93.82443226011988, 12.517366570006105, -189.29959979379367, 1.754899073533487, 28.978665290951035, -403.998635369546, -22.818940273347494, 18.907139663878354, -307.43255260162425, -581.7010232558026, 20.000000000000014, 20.000000000000014, -89.67983780682417, -129.5215246823117, 166.23497289518696, -104.37043954215504, 3.4528991297230336, -323.67604854842943, -198.06606865549412, -413.23596381882925, 101.2938846654898], "policy_predator_policy_reward": [90.71034815701462, 129.39014941003344, 19.91990879484414, 453.49750080736885, 133.5026765620724, 184.37384231401646, 398.103217676148, 157.53886414691118, 328.4904732931446, 152.89381076252073, 152.94706543915154, 190.19726448034402, 412.85233055327643, 58.428110433414375, 365.8667283872353, 77.2040984358857, 131.19563623382984, 509.88793594384094, 466.8185809444698, 343.2627243815143, 265.34935320012255, 144.08939205214023, 97.796733635182, 260.4831561498038, 263.665395578759, 261.6520221492734, 200.59714942844136, 147.5819378724394, 157.2136564745613, 363.8227901375631, 34.34509213382888, 454.4602211731796, 254.52297017846607, 14.595545597808124, 90.91979971961025, 81.78922073647163, 257.77494313995925, 293.6453988910677, 52.349104841123676, 356.5729483336076, 199.50017165847555, 62.75119078801772, 305.5589623901235, 381.5064002686987, 109.24397789748014, 39.58534963629203, 173.56147642963728, 166.1110978398558, 41.90155284357258, 133.9571545987647, 199.12446158795788, 240.20631726422766, 223.88658915560256, 174.875559446233, 72.25611857119559, 249.1600468223206, 394.08692213145963, 434.46911018622166, 344.95699454370146, 28.094470410818126, 176.1618525758006, 23.480683569396746, 279.1192813351261, 372.39236123457874, 108.31688699258345, 89.05328454354435, 465.14274515840424, 249.47460722940554, 334.28746094343506, 424.30527772962205, 57.68368194171668, 278.4518466944092, 178.58977074023, 308.8943885919406, 193.22665961232298, 479.65968036956997, 60.527798091193816, 540.1042424180976, 130.9687647342449, 276.2226047156785, 386.46402617930227, 233.62842049508328, 3.597121874057696, 252.3601501087383, 71.85809061183743, 252.4307153266502, 433.61773340862476, 348.16323954031554, 246.77939332151277, 297.7141111197767, 360.7373328084291, 435.41172547400055, 315.0687146506275, 247.5627170865499, 410.10963359038124, 365.59727787577316, 301.0851773668945, 303.80463320996324, 375.4233058713012, 184.5867467859679, 171.40515484289682, 232.59515708490017, 198.7471573703692, 319.3218515967163, 316.5920812516756, 305.37239899165934, 78.81020508119198, 139.49688277822818, 258.1873384142535, 182.46560041603652, 114.07886298164517, 175.37480685373717, 263.1448255598119, 301.7665854065283, 303.7914818879679, 363.54191875812955, 128.56872873662857, 161.00600928078262, 345.97397298296113, 220.741864348625, 17.705032121780075, 220.60665391496138, 171.74956469484124, 377.8582870910275, 459.60115763680756, 325.81872992648624, 195.10602403794414, 372.7485009844733, 239.37410021491272, 259.1097777941834, 310.5589623455948, 434.5977760531611, 303.2927884977928, 286.374250575162, 315.3368400748396, 199.19274093039877, 113.7645288707002, 295.9161907143263, 321.4711216788121, 470.9782073551612, 172.51597557611117, 272.85128150352756, 185.96076231873425, 158.73759693172576, 241.88822653029578, 10.757956436650314, 398.36101338472236, 616.3818232844333, 442.49445725334664, 430.89196904171104, 511.92243692899024, 156.26684639021403, 138.80396214569112, 72.27122913694089, 49.8164233528175, 434.38601534808333, 454.2663337865257, 139.12557712046805, 494.64287186531374, 434.68520546067634, 167.29018760774608, 449.4997278764603, 33.15291794335322, 421.15271746605765, 277.0220285662145, 384.06904354426797, 110.63639123355165, 508.8680234364244, 213.8792625450736, 413.92862408465663, 425.35869851337173, 331.40664570394785, 447.3283223410769, 84.03136006429776, 357.6269298148928, 124.85150443129518, 194.44492615193974, 431.0271881443316, 164.66864629633264, 375.3566112180925, 327.37903884604316, 430.3631453419481, 226.3011909971856, 159.15460227264595, 277.0135327777979, 217.78866623791117, 183.27061442267726, 90.84722400972117, 427.41155797993224, 20.313407158280796, 385.1597248347589, 50.362532745071206, 522.5094637377643, 114.4856024690241, 160.78363177326824, 190.9371567412477, 438.9920505245985, 190.75201639925265, 447.03120128482414, 279.8390510857602]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.47828266130206, "mean_inference_ms": 6.266034782301306, "mean_action_processing_ms": 3.018010387527893, "mean_env_wait_ms": 17.411433849928443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022162199020385742, "StateBufferConnector_ms": 0.00841820240020752, "ViewRequirementAgentConnector_ms": 0.4001896381378174}, "num_episodes": 38, "episode_return_max": 405.41593904100915, "episode_return_min": 22.30000000000004, "episode_return_mean": 173.85117243408288, "episodes_this_iter": 38}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.43401213568929, "num_env_steps_trained_throughput_per_sec": 56.43401213568929, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 71258.189, "restore_workers_time_ms": 0.017, "training_step_time_ms": 71258.128, "sample_time_ms": 4440.897, "learn_time_ms": 66791.04, "learn_throughput": 59.888, "synch_weights_time_ms": 15.557}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "training_iteration": 15, "trial_id": "62684_00000", "date": "2024-08-20_16-25-37", "timestamp": 1724151337, "time_this_iter_s": 70.93348526954651, "time_total_s": 1069.9920778274536, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffa9e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1069.9920778274536, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 54.00792079207921, "ram_util_percent": 83.2079207920792}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.589327348250869, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.718767534925583, "policy_loss": -0.018168125240749792, "vf_loss": 6.734042539664194, "vf_explained_var": 0.3807564453664401, "kl": 0.014465631604366374, "entropy": 1.315679716387539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 43710.5, "diff_num_grad_updates_vs_sampler_policy": 1448.2750000000015}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4629916639555067, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.26330582300822, "policy_loss": -0.01758193372472845, "vf_loss": 7.27821255537568, "vf_explained_var": 0.2106216596863257, "kl": 0.01337600428359731, "entropy": 1.0219690874455467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999993}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 405.41593904100915, "episode_reward_min": 22.30000000000004, "episode_reward_mean": 175.54293828902684, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -620.1582312379982, "predator_policy": 3.597121874057696}, "policy_reward_max": {"prey_policy": 197.23317773099973, "predator_policy": 616.3818232844333}, "policy_reward_mean": {"prey_policy": -111.9995957181838, "predator_policy": 255.77086272178923}, "custom_metrics": {}, "hist_stats": {"episode_reward": [188.70205216194313, 231.49091216216738, 260.0262135344343, 150.4447245522945, 262.7365684304455, 235.17225615814104, 187.60334779519508, 144.60137625788425, 267.23596969834824, 259.13415035887635, 149.5310906801705, 250.63626266311618, 273.9957788155367, 200.35272573250992, 126.39999999999839, 244.70844491273658, 161.4782670974175, 74.17907876937146, 253.17736413012562, 54.174045543793845, 77.07848651699642, 129.4965341299502, 188.54223693913403, 405.41593904100915, 211.7873970393208, 348.8114081794483, 185.22572766475133, 254.02764814181657, 159.13007982641827, 101.43284687561322, 145.8350295510867, 264.37051742464206, 51.30452746158086, 162.5817586346809, 249.96002934432224, 131.95777008698295, 101.04545724426475, 153.708396350302, 79.7661089447633, 116.90075801235135, 64.38521114274677, 59.62674087421323, 55.39892198952673, 160.45011966975105, 171.80772880435487, 181.19698207327335, 109.27035342596348, 300.2126986995506, 236.4068697925528, 85.72375933623584, 205.99999317245997, 96.68382367332492, 281.2231469944438, 124.72294513987617, 140.78437092912205, 258.53073302593924, 201.3227067018956, 293.15720554534494, 180.94483528860474, 122.1602060766476, 229.0542655302679, 192.04156670816127, 65.63819537595606, 205.05174271759816, 233.92722807621976, 203.40716243646236, 149.29428048502822, 72.12981353636576, 206.15292762377402, 208.355324365005, 136.89370345065885, 257.5200589933162, 22.30000000000004, 112.36418917382215, 301.95884098290145, 285.13071702473985, 150.03084571288326, 186.37347077499018, 126.51541733210887, 52.58419912170008, 215.21656738912242, 203.51486601119896, 169.90215016711895, 143.82404722893077, 87.959888556331, 64.50000000000034, 56.73552306361455, 202.43177081651518, 153.646362676101, 146.93319140559933, 210.1380032567985, 191.1600374687302, 74.45989413315175, 124.17790436873538, 95.29404295098422, 298.75439892056795, 205.15047796298893, 216.86210456175093, 260.5834759886364, 212.15653333407775], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-7.836873614857746, 24.82545086343289, -146.16304396272028, -73.0197327971805, 169.30594250851513, -420.43737937222636, 58.69999999999996, 38.130845467414744, -318.18891598864417, 93.83246122186696, -5.185263312760579, -281.34680327630605, 153.80101342572073, -173.93190375204892, -188.4129822299167, -3.7378912319333395, 128.78213862544146, -332.9428180584878, 40.780483635616555, -317.2331936431281, -177.02751437496423, -332.29976882503746, -352.93836470980847, 19.758204466747188, -211.8826727776427, 35.411006608707055, 34.26889061502041, 48.9209357074006, 94.07027166294358, -242.13694679645363, -3.04991270842316, -228.3500599502431, -144.3863543891957, 69.20675134078122, -163.781094077145, -2.968481901400729, 118.14565692054744, -392.7858623894654, 27.599537672330534, -125.17109941346087, -156.6417207110635, -6.6397674499731, -19.830695782012782, 5.200030781601107, -128.08785077586225, -46.66168316277359, 51.730290918343606, 66.93081670108516, -283.25192918158467, -251.07494313995954, 144.38479738793464, -357.90047757139035, 20.000000000000014, 3.1575031660305934, -128.3309307327477, 85.1190856831657, 34.137846733214445, 20.000000000000014, -220.9790523453376, -431.9122647696911, -83.63311894988286, 34.36762756939793, -22.485349636291787, 43.91356461129224, -157.79997525265475, -96.28962949817888, -121.05292416099073, 35.433803664917164, 98.30264999287076, 143.18812841135252, 83.0096108309195, -260.11257905344905, 103.69999999999995, -110.39049815451044, -180.28425340800464, 136.04055678109566, -240.6079748753401, 131.9626608801749, -287.00701446889707, 18.735271629304652, -375.058561813338, -336.2569945436995, 197.23317773099973, 20.000000000000014, 4.783640524651805, -64.32971175721758, 19.033614913787453, -71.0129666293058, -360.33333190468176, -118.73249716010392, -51.518254992457074, -85.71688699258422, 85.69999999999997, -388.8341485955631, 105.95133725193207, -167.3640236195365, -303.0515465742486, 17.553677961371086, -421.7903425985992, -264.42828305801874, 70.62237983750657, 20.25213321906849, -288.51780803533035, 30.993678047485552, 20.000000000000014, -201.18048463239674, 91.97904153467331, -431.7271267971864, -544.9503037277098, 25.363720462683744, 20.000000000000014, -34.374898423953, -54.993228289430014, -164.11484638623688, -181.99631711717652, -371.1543695364875, 12.824348924041438, 23.100998988139654, 10.678665152350952, -172.83617811093367, -158.11838784124825, -145.5549297214244, 43.769722766930386, -343.06323954031564, -13.361428412107568, -365.7295641223037, -71.1773135160903, -437.9172689356735, 20.000000000000014, -232.2856947299634, -488.0723544193833, 84.65911053666727, -45.875446124459216, -179.50526738521773, -165.44298942314612, -346.8763786698971, -312.5453948030466, 64.91184408006333, -117.29299762523127, 17.94584676972757, -396.2723062953906, -166.98418689493957, 139.73528567074584, -232.54845273352447, 24.872014278968077, -119.8104333891726, -72.65502302503937, -141.85348702150532, -256.6235274147732, -33.868235194571135, -404.4476966964415, -22.817240782986516, 11.300450408553516, -39.44871606699698, 20.000000000000014, -102.17454811909646, 45.41197315222365, -49.781592489820135, -155.06017249825015, -18.666308133091846, -152.22869758623034, 6.164281023817165, -47.22319612068073, -197.42447612872928, -179.479367787807, 31.093038183624177, -304.413267503148, -135.4824383006338, -154.69771729607945, 1.682966521183577, 64.7627194593811, -316.0465430171834, -59.86075740025454, 102.34866863119835, 15.644835288605307, 135.81344947867376, -208.82513551541533, -78.36324768496848, 20.000000000000014, -369.0843980242528, -173.83719832575474, -110.27075777314963, -272.25766593412067, -429.1902092546789, 33.37725094042431, 20.000000000000014, -231.57410021491316, -221.27158241822767, 20.000000000000014, 120.64456148821725, -146.50434657857105, -514.2452105908039, -319.87932845426377, 154.94643058002555, -190.80691312249692, 169.55852157760046, -309.9368400748396, -170.74410007153693, -183.28737793564903, -97.09906116434865, 20.000000000000014, 7.096274677908577, -107.25755893751887, -620.1582312379982, -148.8437276583422, 82.82508215731364, -173.19568395483677, 46.4195696191015, -85.90720991025508, -96.8553945943014, -8.619127642964234, 20.000000000000014, -127.1333518733212, -252.26811983495526, -601.6927310475658, 96.73807320668081, 20.000000000000014, -429.691969041711, -441.3944572533466, -56.35288148022706, 12.104271955167308, -511.5764846203217, -132.04240657753556, 171.42605627780486, 51.499999999999964, -186.08916746266948, 129.2154296908897, -142.19798390438206, -67.2455591841339, -334.64303177734917, -41.47247423262782, -580.3361138466732, 20.000000000000014, -182.61849270432688, -116.69894652735624, 73.62417625171936, -447.19972787646043, -4.827612615253083, 20.000000000000014, -416.8938236724582, 18.855806471564417, -263.8741140930558, -200.8561970998682, 151.910032488366, -581.0834751276385, 13.183893980496297, -128.52998611289067, -195.90444100575831, -133.47130934396256, -249.97272126557917, -151.52930639204902, -211.43926933076062, -65.7108559331469, -318.7176325960045, -58.971305319890384, -325.42692981489284, -112.55150443129583, 20.000000000000014, -53.529389643135715, -108.92041308406431, -406.28678850545697, 20.000000000000014, 132.5241714645022, -490.117658162411, -32.0159417196334, 20.000000000000014, -592.0798797922567, 47.33725363671326, -305.85985550094523, 20.000000000000014, -100.95155875478889, -154.9079579467863, -28.804679057335278, 93.82443226011988, 12.517366570006105, -189.29959979379367, 1.754899073533487, 28.978665290951035, -403.998635369546, -22.818940273347494, 18.907139663878354, -307.43255260162425, -581.7010232558026, 20.000000000000014, 20.000000000000014, -89.67983780682417, -129.5215246823117, 166.23497289518696, -104.37043954215504, 3.4528991297230336, -323.67604854842943, -198.06606865549412, -413.23596381882925, 101.2938846654898, -533.8496216356352, 38.00000000000017, 166.39817059204174, 0.2971379128906282, -34.938353605935745, -228.22435393137636], "policy_predator_policy_reward": [133.5026765620724, 184.37384231401646, 398.103217676148, 157.53886414691118, 328.4904732931446, 152.89381076252073, 152.94706543915154, 190.19726448034402, 412.85233055327643, 58.428110433414375, 365.8667283872353, 77.2040984358857, 131.19563623382984, 509.88793594384094, 466.8185809444698, 343.2627243815143, 265.34935320012255, 144.08939205214023, 97.796733635182, 260.4831561498038, 263.665395578759, 261.6520221492734, 200.59714942844136, 147.5819378724394, 157.2136564745613, 363.8227901375631, 34.34509213382888, 454.4602211731796, 254.52297017846607, 14.595545597808124, 90.91979971961025, 81.78922073647163, 257.77494313995925, 293.6453988910677, 52.349104841123676, 356.5729483336076, 199.50017165847555, 62.75119078801772, 305.5589623901235, 381.5064002686987, 109.24397789748014, 39.58534963629203, 173.56147642963728, 166.1110978398558, 41.90155284357258, 133.9571545987647, 199.12446158795788, 240.20631726422766, 223.88658915560256, 174.875559446233, 72.25611857119559, 249.1600468223206, 394.08692213145963, 434.46911018622166, 344.95699454370146, 28.094470410818126, 176.1618525758006, 23.480683569396746, 279.1192813351261, 372.39236123457874, 108.31688699258345, 89.05328454354435, 465.14274515840424, 249.47460722940554, 334.28746094343506, 424.30527772962205, 57.68368194171668, 278.4518466944092, 178.58977074023, 308.8943885919406, 193.22665961232298, 479.65968036956997, 60.527798091193816, 540.1042424180976, 130.9687647342449, 276.2226047156785, 386.46402617930227, 233.62842049508328, 3.597121874057696, 252.3601501087383, 71.85809061183743, 252.4307153266502, 433.61773340862476, 348.16323954031554, 246.77939332151277, 297.7141111197767, 360.7373328084291, 435.41172547400055, 315.0687146506275, 247.5627170865499, 410.10963359038124, 365.59727787577316, 301.0851773668945, 303.80463320996324, 375.4233058713012, 184.5867467859679, 171.40515484289682, 232.59515708490017, 198.7471573703692, 319.3218515967163, 316.5920812516756, 305.37239899165934, 78.81020508119198, 139.49688277822818, 258.1873384142535, 182.46560041603652, 114.07886298164517, 175.37480685373717, 263.1448255598119, 301.7665854065283, 303.7914818879679, 363.54191875812955, 128.56872873662857, 161.00600928078262, 345.97397298296113, 220.741864348625, 17.705032121780075, 220.60665391496138, 171.74956469484124, 377.8582870910275, 459.60115763680756, 325.81872992648624, 195.10602403794414, 372.7485009844733, 239.37410021491272, 259.1097777941834, 310.5589623455948, 434.5977760531611, 303.2927884977928, 286.374250575162, 315.3368400748396, 199.19274093039877, 113.7645288707002, 295.9161907143263, 321.4711216788121, 470.9782073551612, 172.51597557611117, 272.85128150352756, 185.96076231873425, 158.73759693172576, 241.88822653029578, 10.757956436650314, 398.36101338472236, 616.3818232844333, 442.49445725334664, 430.89196904171104, 511.92243692899024, 156.26684639021403, 138.80396214569112, 72.27122913694089, 49.8164233528175, 434.38601534808333, 454.2663337865257, 139.12557712046805, 494.64287186531374, 434.68520546067634, 167.29018760774608, 449.4997278764603, 33.15291794335322, 421.15271746605765, 277.0220285662145, 384.06904354426797, 110.63639123355165, 508.8680234364244, 213.8792625450736, 413.92862408465663, 425.35869851337173, 331.40664570394785, 447.3283223410769, 84.03136006429776, 357.6269298148928, 124.85150443129518, 194.44492615193974, 431.0271881443316, 164.66864629633264, 375.3566112180925, 327.37903884604316, 430.3631453419481, 226.3011909971856, 159.15460227264595, 277.0135327777979, 217.78866623791117, 183.27061442267726, 90.84722400972117, 427.41155797993224, 20.313407158280796, 385.1597248347589, 50.362532745071206, 522.5094637377643, 114.4856024690241, 160.78363177326824, 190.9371567412477, 438.9920505245985, 190.75201639925265, 447.03120128482414, 279.8390510857602, 156.94691916781247, 433.0880078644182, 7.603046777812481, 467.41905618068694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.44773545920342, "mean_inference_ms": 6.285345363121568, "mean_action_processing_ms": 3.0075859090410346, "mean_env_wait_ms": 17.398978401391222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02857184410095215, "StateBufferConnector_ms": 0.008456826210021973, "ViewRequirementAgentConnector_ms": 0.3898887634277344}, "num_episodes": 2, "episode_return_max": 405.41593904100915, "episode_return_min": 22.30000000000004, "episode_return_mean": 175.54293828902684, "episodes_this_iter": 2}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.638253975401774, "num_env_steps_trained_throughput_per_sec": 56.638253975401774, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 71060.428, "restore_workers_time_ms": 0.017, "training_step_time_ms": 71060.367, "sample_time_ms": 4540.29, "learn_time_ms": 66493.593, "learn_throughput": 60.156, "synch_weights_time_ms": 15.898}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 16, "trial_id": "62684_00000", "date": "2024-08-20_16-26-48", "timestamp": 1724151408, "time_this_iter_s": 70.64601612091064, "time_total_s": 1140.6380939483643, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ff8b8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1140.6380939483643, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 52.985, "ram_util_percent": 83.288}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.285537811965807, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.649032253407418, "policy_loss": -0.020767711564302068, "vf_loss": 6.666491653225946, "vf_explained_var": 0.3041014254938626, "kl": 0.016541681498956226, "entropy": 1.3102467391507846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 46530.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.165274015620903, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.831660993263204, "policy_loss": -0.01869606778417374, "vf_loss": 7.8475893956643565, "vf_explained_var": 0.14072181752749852, "kl": 0.013838281313193932, "entropy": 0.9753872678393409, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "env_runners": {"episode_reward_max": 405.41593904100915, "episode_reward_min": 10.280646382657675, "episode_reward_mean": 162.74378528600948, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -620.1582312379982, "predator_policy": 3.597121874057696}, "policy_reward_max": {"prey_policy": 197.23317773099973, "predator_policy": 616.3818232844333}, "policy_reward_mean": {"prey_policy": -127.04906190878273, "predator_policy": 271.945485506179}, "custom_metrics": {}, "hist_stats": {"episode_reward": [161.4782670974175, 74.17907876937146, 253.17736413012562, 54.174045543793845, 77.07848651699642, 129.4965341299502, 188.54223693913403, 405.41593904100915, 211.7873970393208, 348.8114081794483, 185.22572766475133, 254.02764814181657, 159.13007982641827, 101.43284687561322, 145.8350295510867, 264.37051742464206, 51.30452746158086, 162.5817586346809, 249.96002934432224, 131.95777008698295, 101.04545724426475, 153.708396350302, 79.7661089447633, 116.90075801235135, 64.38521114274677, 59.62674087421323, 55.39892198952673, 160.45011966975105, 171.80772880435487, 181.19698207327335, 109.27035342596348, 300.2126986995506, 236.4068697925528, 85.72375933623584, 205.99999317245997, 96.68382367332492, 281.2231469944438, 124.72294513987617, 140.78437092912205, 258.53073302593924, 201.3227067018956, 293.15720554534494, 180.94483528860474, 122.1602060766476, 229.0542655302679, 192.04156670816127, 65.63819537595606, 205.05174271759816, 233.92722807621976, 203.40716243646236, 149.29428048502822, 72.12981353636576, 206.15292762377402, 208.355324365005, 136.89370345065885, 257.5200589933162, 22.30000000000004, 112.36418917382215, 301.95884098290145, 285.13071702473985, 150.03084571288326, 186.37347077499018, 126.51541733210887, 52.58419912170008, 215.21656738912242, 203.51486601119896, 169.90215016711895, 143.82404722893077, 87.959888556331, 64.50000000000034, 56.73552306361455, 202.43177081651518, 153.646362676101, 146.93319140559933, 210.1380032567985, 191.1600374687302, 74.45989413315175, 124.17790436873538, 95.29404295098422, 298.75439892056795, 205.15047796298893, 216.86210456175093, 260.5834759886364, 212.15653333407775, 19.097260385084954, 210.2980295769356, 151.18222970611646, 18.599362411405444, 102.55078871138198, 10.280646382657675, 133.41402433480638, 159.71568139939632, 160.30986860364987, 74.14634286305832, 107.16866834017846, 359.32543972548314, 144.06017118273607, 114.84431047724013, 151.87523990331522, 235.98850960861665], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-283.25192918158467, -251.07494313995954, 144.38479738793464, -357.90047757139035, 20.000000000000014, 3.1575031660305934, -128.3309307327477, 85.1190856831657, 34.137846733214445, 20.000000000000014, -220.9790523453376, -431.9122647696911, -83.63311894988286, 34.36762756939793, -22.485349636291787, 43.91356461129224, -157.79997525265475, -96.28962949817888, -121.05292416099073, 35.433803664917164, 98.30264999287076, 143.18812841135252, 83.0096108309195, -260.11257905344905, 103.69999999999995, -110.39049815451044, -180.28425340800464, 136.04055678109566, -240.6079748753401, 131.9626608801749, -287.00701446889707, 18.735271629304652, -375.058561813338, -336.2569945436995, 197.23317773099973, 20.000000000000014, 4.783640524651805, -64.32971175721758, 19.033614913787453, -71.0129666293058, -360.33333190468176, -118.73249716010392, -51.518254992457074, -85.71688699258422, 85.69999999999997, -388.8341485955631, 105.95133725193207, -167.3640236195365, -303.0515465742486, 17.553677961371086, -421.7903425985992, -264.42828305801874, 70.62237983750657, 20.25213321906849, -288.51780803533035, 30.993678047485552, 20.000000000000014, -201.18048463239674, 91.97904153467331, -431.7271267971864, -544.9503037277098, 25.363720462683744, 20.000000000000014, -34.374898423953, -54.993228289430014, -164.11484638623688, -181.99631711717652, -371.1543695364875, 12.824348924041438, 23.100998988139654, 10.678665152350952, -172.83617811093367, -158.11838784124825, -145.5549297214244, 43.769722766930386, -343.06323954031564, -13.361428412107568, -365.7295641223037, -71.1773135160903, -437.9172689356735, 20.000000000000014, -232.2856947299634, -488.0723544193833, 84.65911053666727, -45.875446124459216, -179.50526738521773, -165.44298942314612, -346.8763786698971, -312.5453948030466, 64.91184408006333, -117.29299762523127, 17.94584676972757, -396.2723062953906, -166.98418689493957, 139.73528567074584, -232.54845273352447, 24.872014278968077, -119.8104333891726, -72.65502302503937, -141.85348702150532, -256.6235274147732, -33.868235194571135, -404.4476966964415, -22.817240782986516, 11.300450408553516, -39.44871606699698, 20.000000000000014, -102.17454811909646, 45.41197315222365, -49.781592489820135, -155.06017249825015, -18.666308133091846, -152.22869758623034, 6.164281023817165, -47.22319612068073, -197.42447612872928, -179.479367787807, 31.093038183624177, -304.413267503148, -135.4824383006338, -154.69771729607945, 1.682966521183577, 64.7627194593811, -316.0465430171834, -59.86075740025454, 102.34866863119835, 15.644835288605307, 135.81344947867376, -208.82513551541533, -78.36324768496848, 20.000000000000014, -369.0843980242528, -173.83719832575474, -110.27075777314963, -272.25766593412067, -429.1902092546789, 33.37725094042431, 20.000000000000014, -231.57410021491316, -221.27158241822767, 20.000000000000014, 120.64456148821725, -146.50434657857105, -514.2452105908039, -319.87932845426377, 154.94643058002555, -190.80691312249692, 169.55852157760046, -309.9368400748396, -170.74410007153693, -183.28737793564903, -97.09906116434865, 20.000000000000014, 7.096274677908577, -107.25755893751887, -620.1582312379982, -148.8437276583422, 82.82508215731364, -173.19568395483677, 46.4195696191015, -85.90720991025508, -96.8553945943014, -8.619127642964234, 20.000000000000014, -127.1333518733212, -252.26811983495526, -601.6927310475658, 96.73807320668081, 20.000000000000014, -429.691969041711, -441.3944572533466, -56.35288148022706, 12.104271955167308, -511.5764846203217, -132.04240657753556, 171.42605627780486, 51.499999999999964, -186.08916746266948, 129.2154296908897, -142.19798390438206, -67.2455591841339, -334.64303177734917, -41.47247423262782, -580.3361138466732, 20.000000000000014, -182.61849270432688, -116.69894652735624, 73.62417625171936, -447.19972787646043, -4.827612615253083, 20.000000000000014, -416.8938236724582, 18.855806471564417, -263.8741140930558, -200.8561970998682, 151.910032488366, -581.0834751276385, 13.183893980496297, -128.52998611289067, -195.90444100575831, -133.47130934396256, -249.97272126557917, -151.52930639204902, -211.43926933076062, -65.7108559331469, -318.7176325960045, -58.971305319890384, -325.42692981489284, -112.55150443129583, 20.000000000000014, -53.529389643135715, -108.92041308406431, -406.28678850545697, 20.000000000000014, 132.5241714645022, -490.117658162411, -32.0159417196334, 20.000000000000014, -592.0798797922567, 47.33725363671326, -305.85985550094523, 20.000000000000014, -100.95155875478889, -154.9079579467863, -28.804679057335278, 93.82443226011988, 12.517366570006105, -189.29959979379367, 1.754899073533487, 28.978665290951035, -403.998635369546, -22.818940273347494, 18.907139663878354, -307.43255260162425, -581.7010232558026, 20.000000000000014, 20.000000000000014, -89.67983780682417, -129.5215246823117, 166.23497289518696, -104.37043954215504, 3.4528991297230336, -323.67604854842943, -198.06606865549412, -413.23596381882925, 101.2938846654898, -533.8496216356352, 38.00000000000017, 166.39817059204174, 0.2971379128906282, -34.938353605935745, -228.22435393137636, -318.6250101721175, -474.2461438644577, 1.2588944425185036, 61.44513175379811, -217.65258093650127, -118.04645163894925, 63.209398360530066, 18.229388530328894, -482.12659284701203, -531.1142314442735, -266.66147787746513, -4.0847403010083365, -179.38215057799167, 14.54048008087164, -490.1054863383581, -539.2378485560845, -1.714425348004307, -197.4483078209584, -542.5358470672965, -500.77089732301977, 133.07108851202335, -369.3071088607591, -89.93811489884371, -3.222399015673367, 20.000000000000014, -137.03697982732388, -100.87318592881378, 20.000000000000014, -242.73107910434567, -366.53028668903306, 15.285756137202972, -66.97821434498569, -385.59112826280995, -303.35767696133144, -148.02657386002934, 27.346247024511662, 20.46303471508501, -258.6710470667724, 13.69893951625145, -21.62583400810649, -516.0604269287121, -46.40703232193516, 128.56265209285587, -175.5210848528487, -408.3468225589239, -60.58390202595484, 20.000000000000014, -231.06570100658274], "policy_predator_policy_reward": [257.77494313995925, 293.6453988910677, 52.349104841123676, 356.5729483336076, 199.50017165847555, 62.75119078801772, 305.5589623901235, 381.5064002686987, 109.24397789748014, 39.58534963629203, 173.56147642963728, 166.1110978398558, 41.90155284357258, 133.9571545987647, 199.12446158795788, 240.20631726422766, 223.88658915560256, 174.875559446233, 72.25611857119559, 249.1600468223206, 394.08692213145963, 434.46911018622166, 344.95699454370146, 28.094470410818126, 176.1618525758006, 23.480683569396746, 279.1192813351261, 372.39236123457874, 108.31688699258345, 89.05328454354435, 465.14274515840424, 249.47460722940554, 334.28746094343506, 424.30527772962205, 57.68368194171668, 278.4518466944092, 178.58977074023, 308.8943885919406, 193.22665961232298, 479.65968036956997, 60.527798091193816, 540.1042424180976, 130.9687647342449, 276.2226047156785, 386.46402617930227, 233.62842049508328, 3.597121874057696, 252.3601501087383, 71.85809061183743, 252.4307153266502, 433.61773340862476, 348.16323954031554, 246.77939332151277, 297.7141111197767, 360.7373328084291, 435.41172547400055, 315.0687146506275, 247.5627170865499, 410.10963359038124, 365.59727787577316, 301.0851773668945, 303.80463320996324, 375.4233058713012, 184.5867467859679, 171.40515484289682, 232.59515708490017, 198.7471573703692, 319.3218515967163, 316.5920812516756, 305.37239899165934, 78.81020508119198, 139.49688277822818, 258.1873384142535, 182.46560041603652, 114.07886298164517, 175.37480685373717, 263.1448255598119, 301.7665854065283, 303.7914818879679, 363.54191875812955, 128.56872873662857, 161.00600928078262, 345.97397298296113, 220.741864348625, 17.705032121780075, 220.60665391496138, 171.74956469484124, 377.8582870910275, 459.60115763680756, 325.81872992648624, 195.10602403794414, 372.7485009844733, 239.37410021491272, 259.1097777941834, 310.5589623455948, 434.5977760531611, 303.2927884977928, 286.374250575162, 315.3368400748396, 199.19274093039877, 113.7645288707002, 295.9161907143263, 321.4711216788121, 470.9782073551612, 172.51597557611117, 272.85128150352756, 185.96076231873425, 158.73759693172576, 241.88822653029578, 10.757956436650314, 398.36101338472236, 616.3818232844333, 442.49445725334664, 430.89196904171104, 511.92243692899024, 156.26684639021403, 138.80396214569112, 72.27122913694089, 49.8164233528175, 434.38601534808333, 454.2663337865257, 139.12557712046805, 494.64287186531374, 434.68520546067634, 167.29018760774608, 449.4997278764603, 33.15291794335322, 421.15271746605765, 277.0220285662145, 384.06904354426797, 110.63639123355165, 508.8680234364244, 213.8792625450736, 413.92862408465663, 425.35869851337173, 331.40664570394785, 447.3283223410769, 84.03136006429776, 357.6269298148928, 124.85150443129518, 194.44492615193974, 431.0271881443316, 164.66864629633264, 375.3566112180925, 327.37903884604316, 430.3631453419481, 226.3011909971856, 159.15460227264595, 277.0135327777979, 217.78866623791117, 183.27061442267726, 90.84722400972117, 427.41155797993224, 20.313407158280796, 385.1597248347589, 50.362532745071206, 522.5094637377643, 114.4856024690241, 160.78363177326824, 190.9371567412477, 438.9920505245985, 190.75201639925265, 447.03120128482414, 279.8390510857602, 156.94691916781247, 433.0880078644182, 7.603046777812481, 467.41905618068694, 501.1743467655018, 309.53517321364075, 54.21303799698292, 430.338892401605, 484.32659284701253, 67.54344281525842, 531.1102535662144, 289.3495584679379, 268.4816833767984, 489.0162621700619, 539.3378485560845, 209.34337955161973, 502.97089732302004, 540.6787828900797, 294.848923105496, 327.3343810691769, 275.2138468203719, 103.00618753941684, 300.63594609604655, 362.7717625603921, 321.8141135910057, 222.6381412197656, 447.61064523445015, 335.7527982878815, 280.1360861137566, 88.43315790441582, 417.42826588609273, 281.5093378499026, 195.4336726633079, 411.7468225589238, 240.82695731636647, 266.8111553247891]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.282973985147981, "mean_inference_ms": 6.303405165718841, "mean_action_processing_ms": 3.0806426466078394, "mean_env_wait_ms": 17.29796523172304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01595163345336914, "StateBufferConnector_ms": 0.008323311805725098, "ViewRequirementAgentConnector_ms": 0.3610055446624756}, "num_episodes": 16, "episode_return_max": 405.41593904100915, "episode_return_min": 10.280646382657675, "episode_return_mean": 162.74378528600948, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 48.408933228032105, "num_env_steps_trained_throughput_per_sec": 48.408933228032105, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 72241.721, "restore_workers_time_ms": 0.017, "training_step_time_ms": 72241.658, "sample_time_ms": 4475.926, "learn_time_ms": 67737.69, "learn_throughput": 59.051, "synch_weights_time_ms": 18.488}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "training_iteration": 17, "trial_id": "62684_00000", "date": "2024-08-20_16-28-10", "timestamp": 1724151490, "time_this_iter_s": 82.77010107040405, "time_total_s": 1223.4081950187683, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ff92ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1223.4081950187683, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 64.39572649572649, "ram_util_percent": 83.3965811965812}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.140644494396575, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.885122223779665, "policy_loss": -0.018201964723560563, "vf_loss": 6.900332395066607, "vf_explained_var": 0.33402401728832976, "kl": 0.01495898119702354, "entropy": 1.304112044040193, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 49350.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.482892501890344, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.105325325456246, "policy_loss": -0.018717698386510606, "vf_loss": 8.121274953670603, "vf_explained_var": 0.18342320944266344, "kl": 0.013840362937904145, "entropy": 0.9195841004293431, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 359.32543972548314, "episode_reward_min": 10.280646382657675, "episode_reward_mean": 154.70956444688662, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -620.1582312379982, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.42605627780486, "predator_policy": 616.3818232844333}, "policy_reward_mean": {"prey_policy": -143.4204019984929, "predator_policy": 292.4853852211828}, "custom_metrics": {}, "hist_stats": {"episode_reward": [109.27035342596348, 300.2126986995506, 236.4068697925528, 85.72375933623584, 205.99999317245997, 96.68382367332492, 281.2231469944438, 124.72294513987617, 140.78437092912205, 258.53073302593924, 201.3227067018956, 293.15720554534494, 180.94483528860474, 122.1602060766476, 229.0542655302679, 192.04156670816127, 65.63819537595606, 205.05174271759816, 233.92722807621976, 203.40716243646236, 149.29428048502822, 72.12981353636576, 206.15292762377402, 208.355324365005, 136.89370345065885, 257.5200589933162, 22.30000000000004, 112.36418917382215, 301.95884098290145, 285.13071702473985, 150.03084571288326, 186.37347077499018, 126.51541733210887, 52.58419912170008, 215.21656738912242, 203.51486601119896, 169.90215016711895, 143.82404722893077, 87.959888556331, 64.50000000000034, 56.73552306361455, 202.43177081651518, 153.646362676101, 146.93319140559933, 210.1380032567985, 191.1600374687302, 74.45989413315175, 124.17790436873538, 95.29404295098422, 298.75439892056795, 205.15047796298893, 216.86210456175093, 260.5834759886364, 212.15653333407775, 19.097260385084954, 210.2980295769356, 151.18222970611646, 18.599362411405444, 102.55078871138198, 10.280646382657675, 133.41402433480638, 159.71568139939632, 160.30986860364987, 74.14634286305832, 107.16866834017846, 359.32543972548314, 144.06017118273607, 114.84431047724013, 151.87523990331522, 235.98850960861665, 178.34295934006948, 31.599931439713586, 20.032710561778906, 50.1688707276878, 36.14380654354164, 86.95083111404813, 149.66420992412407, 129.362323132106, 94.79999999999872, 97.07359969730521, 190.61002079517593, 219.18026405084217, 114.1283693009751, 124.68769837435558, 91.7867891293439, 97.89391665313602, 102.4691978075994, 47.11655719615174, 131.45869678600263, 159.83722863320529, 255.18863968947966, 175.1501530946464, 72.04760995380269, 183.4258274649226, 332.39504894709773, 33.372032820924936, 209.39403311094173, 253.62342839437295, 118.09293431786786, 164.83334459050374], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-117.29299762523127, 17.94584676972757, -396.2723062953906, -166.98418689493957, 139.73528567074584, -232.54845273352447, 24.872014278968077, -119.8104333891726, -72.65502302503937, -141.85348702150532, -256.6235274147732, -33.868235194571135, -404.4476966964415, -22.817240782986516, 11.300450408553516, -39.44871606699698, 20.000000000000014, -102.17454811909646, 45.41197315222365, -49.781592489820135, -155.06017249825015, -18.666308133091846, -152.22869758623034, 6.164281023817165, -47.22319612068073, -197.42447612872928, -179.479367787807, 31.093038183624177, -304.413267503148, -135.4824383006338, -154.69771729607945, 1.682966521183577, 64.7627194593811, -316.0465430171834, -59.86075740025454, 102.34866863119835, 15.644835288605307, 135.81344947867376, -208.82513551541533, -78.36324768496848, 20.000000000000014, -369.0843980242528, -173.83719832575474, -110.27075777314963, -272.25766593412067, -429.1902092546789, 33.37725094042431, 20.000000000000014, -231.57410021491316, -221.27158241822767, 20.000000000000014, 120.64456148821725, -146.50434657857105, -514.2452105908039, -319.87932845426377, 154.94643058002555, -190.80691312249692, 169.55852157760046, -309.9368400748396, -170.74410007153693, -183.28737793564903, -97.09906116434865, 20.000000000000014, 7.096274677908577, -107.25755893751887, -620.1582312379982, -148.8437276583422, 82.82508215731364, -173.19568395483677, 46.4195696191015, -85.90720991025508, -96.8553945943014, -8.619127642964234, 20.000000000000014, -127.1333518733212, -252.26811983495526, -601.6927310475658, 96.73807320668081, 20.000000000000014, -429.691969041711, -441.3944572533466, -56.35288148022706, 12.104271955167308, -511.5764846203217, -132.04240657753556, 171.42605627780486, 51.499999999999964, -186.08916746266948, 129.2154296908897, -142.19798390438206, -67.2455591841339, -334.64303177734917, -41.47247423262782, -580.3361138466732, 20.000000000000014, -182.61849270432688, -116.69894652735624, 73.62417625171936, -447.19972787646043, -4.827612615253083, 20.000000000000014, -416.8938236724582, 18.855806471564417, -263.8741140930558, -200.8561970998682, 151.910032488366, -581.0834751276385, 13.183893980496297, -128.52998611289067, -195.90444100575831, -133.47130934396256, -249.97272126557917, -151.52930639204902, -211.43926933076062, -65.7108559331469, -318.7176325960045, -58.971305319890384, -325.42692981489284, -112.55150443129583, 20.000000000000014, -53.529389643135715, -108.92041308406431, -406.28678850545697, 20.000000000000014, 132.5241714645022, -490.117658162411, -32.0159417196334, 20.000000000000014, -592.0798797922567, 47.33725363671326, -305.85985550094523, 20.000000000000014, -100.95155875478889, -154.9079579467863, -28.804679057335278, 93.82443226011988, 12.517366570006105, -189.29959979379367, 1.754899073533487, 28.978665290951035, -403.998635369546, -22.818940273347494, 18.907139663878354, -307.43255260162425, -581.7010232558026, 20.000000000000014, 20.000000000000014, -89.67983780682417, -129.5215246823117, 166.23497289518696, -104.37043954215504, 3.4528991297230336, -323.67604854842943, -198.06606865549412, -413.23596381882925, 101.2938846654898, -533.8496216356352, 38.00000000000017, 166.39817059204174, 0.2971379128906282, -34.938353605935745, -228.22435393137636, -318.6250101721175, -474.2461438644577, 1.2588944425185036, 61.44513175379811, -217.65258093650127, -118.04645163894925, 63.209398360530066, 18.229388530328894, -482.12659284701203, -531.1142314442735, -266.66147787746513, -4.0847403010083365, -179.38215057799167, 14.54048008087164, -490.1054863383581, -539.2378485560845, -1.714425348004307, -197.4483078209584, -542.5358470672965, -500.77089732301977, 133.07108851202335, -369.3071088607591, -89.93811489884371, -3.222399015673367, 20.000000000000014, -137.03697982732388, -100.87318592881378, 20.000000000000014, -242.73107910434567, -366.53028668903306, 15.285756137202972, -66.97821434498569, -385.59112826280995, -303.35767696133144, -148.02657386002934, 27.346247024511662, 20.46303471508501, -258.6710470667724, 13.69893951625145, -21.62583400810649, -516.0604269287121, -46.40703232193516, 128.56265209285587, -175.5210848528487, -408.3468225589239, -60.58390202595484, 20.000000000000014, -231.06570100658274, -32.4459427577675, -391.7087281371763, -73.84914101215865, -461.8914696409048, 7.560406804900918, -92.89132148751888, -466.7441170602137, -413.80628576931304, 12.049287499273289, -413.27681732749636, -219.65379040166638, -5.000545215112114, -2.2095550235111268, -140.28146395072866, -424.3173110501669, -175.16733107335438, 4.299180684598614, -483.95895059146216, -549.9304115972154, -98.41350429172755, -165.9573565776463, -391.0629549906137, -42.714223526711855, -27.18917315780788, 20.51636545411126, -1.1241009951870011, 20.000000000000014, -498.499287897672, -86.96771378667708, -6.660940951533952, -46.8942788960804, 93.02596995161183, -206.6399716417149, -300.00348717558717, -514.5052407325718, 19.016116523516818, 20.000000000000014, -299.3323944178011, -139.20856155204368, -475.79685835172216, -161.83859424236877, 46.30240660380218, 4.7927706511819075, -379.96814552997006, -21.394263895881977, -151.56773540521408, -276.9474640996491, -152.81797689259218, -123.69343791202286, -302.477937794306, -216.05339833632428, -26.06008190124467, -442.96075700968885, -123.37375837950934, -178.26189790342042, -89.84127821147271, -90.46866413025073, 106.48781107055062, -562.3260880582192, -81.91168209907309, -519.0441847668413, 4.480014186778689, 112.83579958377184, -598.624177694848, -235.60509987610578, 72.14854704939455, 15.550428819748916, -172.49309807431354, -499.86260199224193, -75.19748320345327, -536.8082007725025, 164.12582746492322, 48.73837185992592, 69.678514737195, -158.76070449740092, -218.30502052123123, -178.88111926809808, 20.000000000000014, -240.86422855704922, -119.97286511212747, 118.23995860991934, -448.2060758396088, -118.26000478646061, -140.250964282945, -71.98097635739168, 20.000000000000014, -341.92497940884664, 25.860035034765065, -18.849774025129395, -81.19937249171261], "policy_predator_policy_reward": [301.0851773668945, 303.80463320996324, 375.4233058713012, 184.5867467859679, 171.40515484289682, 232.59515708490017, 198.7471573703692, 319.3218515967163, 316.5920812516756, 305.37239899165934, 78.81020508119198, 139.49688277822818, 258.1873384142535, 182.46560041603652, 114.07886298164517, 175.37480685373717, 263.1448255598119, 301.7665854065283, 303.7914818879679, 363.54191875812955, 128.56872873662857, 161.00600928078262, 345.97397298296113, 220.741864348625, 17.705032121780075, 220.60665391496138, 171.74956469484124, 377.8582870910275, 459.60115763680756, 325.81872992648624, 195.10602403794414, 372.7485009844733, 239.37410021491272, 259.1097777941834, 310.5589623455948, 434.5977760531611, 303.2927884977928, 286.374250575162, 315.3368400748396, 199.19274093039877, 113.7645288707002, 295.9161907143263, 321.4711216788121, 470.9782073551612, 172.51597557611117, 272.85128150352756, 185.96076231873425, 158.73759693172576, 241.88822653029578, 10.757956436650314, 398.36101338472236, 616.3818232844333, 442.49445725334664, 430.89196904171104, 511.92243692899024, 156.26684639021403, 138.80396214569112, 72.27122913694089, 49.8164233528175, 434.38601534808333, 454.2663337865257, 139.12557712046805, 494.64287186531374, 434.68520546067634, 167.29018760774608, 449.4997278764603, 33.15291794335322, 421.15271746605765, 277.0220285662145, 384.06904354426797, 110.63639123355165, 508.8680234364244, 213.8792625450736, 413.92862408465663, 425.35869851337173, 331.40664570394785, 447.3283223410769, 84.03136006429776, 357.6269298148928, 124.85150443129518, 194.44492615193974, 431.0271881443316, 164.66864629633264, 375.3566112180925, 327.37903884604316, 430.3631453419481, 226.3011909971856, 159.15460227264595, 277.0135327777979, 217.78866623791117, 183.27061442267726, 90.84722400972117, 427.41155797993224, 20.313407158280796, 385.1597248347589, 50.362532745071206, 522.5094637377643, 114.4856024690241, 160.78363177326824, 190.9371567412477, 438.9920505245985, 190.75201639925265, 447.03120128482414, 279.8390510857602, 156.94691916781247, 433.0880078644182, 7.603046777812481, 467.41905618068694, 501.1743467655018, 309.53517321364075, 54.21303799698292, 430.338892401605, 484.32659284701253, 67.54344281525842, 531.1102535662144, 289.3495584679379, 268.4816833767984, 489.0162621700619, 539.3378485560845, 209.34337955161973, 502.97089732302004, 540.6787828900797, 294.848923105496, 327.3343810691769, 275.2138468203719, 103.00618753941684, 300.63594609604655, 362.7717625603921, 321.8141135910057, 222.6381412197656, 447.61064523445015, 335.7527982878815, 280.1360861137566, 88.43315790441582, 417.42826588609273, 281.5093378499026, 195.4336726633079, 411.7468225589238, 240.82695731636647, 266.8111553247891, 214.57473102828695, 461.7720402188845, 462.78439673460593, 116.03791902862959, 468.4839902736809, 420.0498356183516, 418.4894988696181, 269.6105248023441, 373.33185909277694, 229.62027747517038, 498.55895059146224, 243.21898150280393, 413.2824213095939, 550.6830610811187, 362.8227220461327, 227.50595276110852, 0.0, 55.40773554107576, 188.62457739166905, 500.57696494152, 338.22049993434257, 12.897801447018246, 499.0200115275997, 515.6528639078857, 228.53693085301964, 304.1323944178022, 237.8238860129234, 478.1968583517227, 203.0880962904439, 285.2683316135706, 282.6474640996488, 396.5796289509424, 330.7128379262114, 413.98113392404144, 378.1579790263227, 261.3531754602715, 67.1202932254536, 422.91024380569286, 325.1682442602847, 372.4189434596622, 404.15748689503243, 252.7595237907382, 536.4305893355462, 400.8002942806582, 228.15304734159736, 500.69983385901173, 540.8082007725023, 90.4974832034524, 196.70547043697806, 176.03339641039815, 53.479131596549806, 357.07904101370303, 283.31830305807233, 168.67286511212708, 575.0686643969707, 385.27180890641637, 260.0416363285536, 251.95725375555347, 115.14839508282469, 123.87406098975616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.315367550475461, "mean_inference_ms": 6.311079548714538, "mean_action_processing_ms": 3.1153383420749323, "mean_env_wait_ms": 17.25770176173185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016968607902526855, "StateBufferConnector_ms": 0.02264416217803955, "ViewRequirementAgentConnector_ms": 0.47131991386413574}, "num_episodes": 30, "episode_return_max": 359.32543972548314, "episode_return_min": 10.280646382657675, "episode_return_mean": 154.70956444688662, "episodes_this_iter": 30}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 51.58752165913124, "num_env_steps_trained_throughput_per_sec": 51.58752165913124, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 73004.494, "restore_workers_time_ms": 0.017, "training_step_time_ms": 73004.43, "sample_time_ms": 4612.24, "learn_time_ms": 68363.91, "learn_throughput": 58.51, "synch_weights_time_ms": 18.751}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 18, "trial_id": "62684_00000", "date": "2024-08-20_16-29-28", "timestamp": 1724151568, "time_this_iter_s": 77.6076271533966, "time_total_s": 1301.015822172165, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffa6dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1301.015822172165, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 58.590825688073394, "ram_util_percent": 83.13853211009175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.794038021944939, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.867855451293026, "policy_loss": -0.01836796070759495, "vf_loss": 6.883586751315611, "vf_explained_var": 0.3658401421621336, "kl": 0.013183318189979393, "entropy": 1.2897696032591746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 52170.5, "diff_num_grad_updates_vs_sampler_policy": 1448.9800000000032}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.927790302385098, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.247990077134794, "policy_loss": -0.01783015919533908, "vf_loss": 8.263201603813776, "vf_explained_var": 0.15715109172952238, "kl": 0.01309317659571885, "entropy": 0.8893627154764044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "env_runners": {"episode_reward_max": 394.06833918797196, "episode_reward_min": 6.644057457597196, "episode_reward_mean": 145.98584239790486, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -634.7537841208415, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.42605627780486, "predator_policy": 616.3818232844333}, "policy_reward_mean": {"prey_policy": -158.284959184821, "predator_policy": 310.42035997618405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [208.355324365005, 136.89370345065885, 257.5200589933162, 22.30000000000004, 112.36418917382215, 301.95884098290145, 285.13071702473985, 150.03084571288326, 186.37347077499018, 126.51541733210887, 52.58419912170008, 215.21656738912242, 203.51486601119896, 169.90215016711895, 143.82404722893077, 87.959888556331, 64.50000000000034, 56.73552306361455, 202.43177081651518, 153.646362676101, 146.93319140559933, 210.1380032567985, 191.1600374687302, 74.45989413315175, 124.17790436873538, 95.29404295098422, 298.75439892056795, 205.15047796298893, 216.86210456175093, 260.5834759886364, 212.15653333407775, 19.097260385084954, 210.2980295769356, 151.18222970611646, 18.599362411405444, 102.55078871138198, 10.280646382657675, 133.41402433480638, 159.71568139939632, 160.30986860364987, 74.14634286305832, 107.16866834017846, 359.32543972548314, 144.06017118273607, 114.84431047724013, 151.87523990331522, 235.98850960861665, 178.34295934006948, 31.599931439713586, 20.032710561778906, 50.1688707276878, 36.14380654354164, 86.95083111404813, 149.66420992412407, 129.362323132106, 94.79999999999872, 97.07359969730521, 190.61002079517593, 219.18026405084217, 114.1283693009751, 124.68769837435558, 91.7867891293439, 97.89391665313602, 102.4691978075994, 47.11655719615174, 131.45869678600263, 159.83722863320529, 255.18863968947966, 175.1501530946464, 72.04760995380269, 183.4258274649226, 332.39504894709773, 33.372032820924936, 209.39403311094173, 253.62342839437295, 118.09293431786786, 164.83334459050374, 71.78503514161062, 107.4255409979109, 164.1530882329349, 123.50503437210982, 143.19603498510835, 174.55725902325156, 394.06833918797196, 75.8057161428208, 263.1826780706436, 50.60237718321931, 156.3054676313953, 365.4388941082871, 130.89999999999887, 185.37025356174547, 161.16237926680108, 33.01672580878005, 166.92124234746228, 6.644057457597196, 93.48952737278789, 92.81579341347674, 78.53751642705255, 93.53527350447553, 189.0503911561792], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [46.4195696191015, -85.90720991025508, -96.8553945943014, -8.619127642964234, 20.000000000000014, -127.1333518733212, -252.26811983495526, -601.6927310475658, 96.73807320668081, 20.000000000000014, -429.691969041711, -441.3944572533466, -56.35288148022706, 12.104271955167308, -511.5764846203217, -132.04240657753556, 171.42605627780486, 51.499999999999964, -186.08916746266948, 129.2154296908897, -142.19798390438206, -67.2455591841339, -334.64303177734917, -41.47247423262782, -580.3361138466732, 20.000000000000014, -182.61849270432688, -116.69894652735624, 73.62417625171936, -447.19972787646043, -4.827612615253083, 20.000000000000014, -416.8938236724582, 18.855806471564417, -263.8741140930558, -200.8561970998682, 151.910032488366, -581.0834751276385, 13.183893980496297, -128.52998611289067, -195.90444100575831, -133.47130934396256, -249.97272126557917, -151.52930639204902, -211.43926933076062, -65.7108559331469, -318.7176325960045, -58.971305319890384, -325.42692981489284, -112.55150443129583, 20.000000000000014, -53.529389643135715, -108.92041308406431, -406.28678850545697, 20.000000000000014, 132.5241714645022, -490.117658162411, -32.0159417196334, 20.000000000000014, -592.0798797922567, 47.33725363671326, -305.85985550094523, 20.000000000000014, -100.95155875478889, -154.9079579467863, -28.804679057335278, 93.82443226011988, 12.517366570006105, -189.29959979379367, 1.754899073533487, 28.978665290951035, -403.998635369546, -22.818940273347494, 18.907139663878354, -307.43255260162425, -581.7010232558026, 20.000000000000014, 20.000000000000014, -89.67983780682417, -129.5215246823117, 166.23497289518696, -104.37043954215504, 3.4528991297230336, -323.67604854842943, -198.06606865549412, -413.23596381882925, 101.2938846654898, -533.8496216356352, 38.00000000000017, 166.39817059204174, 0.2971379128906282, -34.938353605935745, -228.22435393137636, -318.6250101721175, -474.2461438644577, 1.2588944425185036, 61.44513175379811, -217.65258093650127, -118.04645163894925, 63.209398360530066, 18.229388530328894, -482.12659284701203, -531.1142314442735, -266.66147787746513, -4.0847403010083365, -179.38215057799167, 14.54048008087164, -490.1054863383581, -539.2378485560845, -1.714425348004307, -197.4483078209584, -542.5358470672965, -500.77089732301977, 133.07108851202335, -369.3071088607591, -89.93811489884371, -3.222399015673367, 20.000000000000014, -137.03697982732388, -100.87318592881378, 20.000000000000014, -242.73107910434567, -366.53028668903306, 15.285756137202972, -66.97821434498569, -385.59112826280995, -303.35767696133144, -148.02657386002934, 27.346247024511662, 20.46303471508501, -258.6710470667724, 13.69893951625145, -21.62583400810649, -516.0604269287121, -46.40703232193516, 128.56265209285587, -175.5210848528487, -408.3468225589239, -60.58390202595484, 20.000000000000014, -231.06570100658274, -32.4459427577675, -391.7087281371763, -73.84914101215865, -461.8914696409048, 7.560406804900918, -92.89132148751888, -466.7441170602137, -413.80628576931304, 12.049287499273289, -413.27681732749636, -219.65379040166638, -5.000545215112114, -2.2095550235111268, -140.28146395072866, -424.3173110501669, -175.16733107335438, 4.299180684598614, -483.95895059146216, -549.9304115972154, -98.41350429172755, -165.9573565776463, -391.0629549906137, -42.714223526711855, -27.18917315780788, 20.51636545411126, -1.1241009951870011, 20.000000000000014, -498.499287897672, -86.96771378667708, -6.660940951533952, -46.8942788960804, 93.02596995161183, -206.6399716417149, -300.00348717558717, -514.5052407325718, 19.016116523516818, 20.000000000000014, -299.3323944178011, -139.20856155204368, -475.79685835172216, -161.83859424236877, 46.30240660380218, 4.7927706511819075, -379.96814552997006, -21.394263895881977, -151.56773540521408, -276.9474640996491, -152.81797689259218, -123.69343791202286, -302.477937794306, -216.05339833632428, -26.06008190124467, -442.96075700968885, -123.37375837950934, -178.26189790342042, -89.84127821147271, -90.46866413025073, 106.48781107055062, -562.3260880582192, -81.91168209907309, -519.0441847668413, 4.480014186778689, 112.83579958377184, -598.624177694848, -235.60509987610578, 72.14854704939455, 15.550428819748916, -172.49309807431354, -499.86260199224193, -75.19748320345327, -536.8082007725025, 164.12582746492322, 48.73837185992592, 69.678514737195, -158.76070449740092, -218.30502052123123, -178.88111926809808, 20.000000000000014, -240.86422855704922, -119.97286511212747, 118.23995860991934, -448.2060758396088, -118.26000478646061, -140.250964282945, -71.98097635739168, 20.000000000000014, -341.92497940884664, 25.860035034765065, -18.849774025129395, -81.19937249171261, -427.41853626400075, -186.73258981905613, -364.66099682659143, -231.45984634043538, -60.48544107935926, -269.7505266034741, -259.5681488415838, -289.3480660295698, -123.37203760264288, -147.24078223480376, -48.40034491601949, 22.725844777926877, 23.615192240991874, -57.33167302019602, -141.89007142862815, -383.6227752804951, -82.3783339399868, -325.17903960556686, 105.08732187481831, -634.7537841208415, 37.844549933872585, 5.826848494472879, -45.81680662416882, -377.2189053043347, -343.1385807253051, 157.2209581819147, -127.77335640299005, -108.86208317997158, -168.25358162122618, -436.498631530424, 64.09999999999997, -313.09187721024057, -375.19956942692147, 85.76348955964988, 148.21721582452992, -419.2393401019418, 20.000000000000014, -210.92252312318232, -129.89885909221442, -147.00962316367082, -126.42647806684906, -106.50916458011218, -88.81008080952815, -167.1184765227976, -182.72530295937824, -460.4214803792086, 13.997702792385386, -468.2500098237672, -449.80944663748227, -91.41239050438105, 18.662393417190774, -428.17160967303573, -384.2937922511305, -20.51418263546149, 15.458669186555897, -53.51639544539984, -393.22062029434363, -586.8884714565875, -66.64523695090315, -84.60846475879958, -21.861189077672066, -512.1436148706966, 20.000000000000014, -317.83051608253567, 18.11037719934423, -399.28652453782826, -120.62271514381109, -53.05226948340112, -83.91296513719361], "policy_predator_policy_reward": [185.96076231873425, 158.73759693172576, 241.88822653029578, 10.757956436650314, 398.36101338472236, 616.3818232844333, 442.49445725334664, 430.89196904171104, 511.92243692899024, 156.26684639021403, 138.80396214569112, 72.27122913694089, 49.8164233528175, 434.38601534808333, 454.2663337865257, 139.12557712046805, 494.64287186531374, 434.68520546067634, 167.29018760774608, 449.4997278764603, 33.15291794335322, 421.15271746605765, 277.0220285662145, 384.06904354426797, 110.63639123355165, 508.8680234364244, 213.8792625450736, 413.92862408465663, 425.35869851337173, 331.40664570394785, 447.3283223410769, 84.03136006429776, 357.6269298148928, 124.85150443129518, 194.44492615193974, 431.0271881443316, 164.66864629633264, 375.3566112180925, 327.37903884604316, 430.3631453419481, 226.3011909971856, 159.15460227264595, 277.0135327777979, 217.78866623791117, 183.27061442267726, 90.84722400972117, 427.41155797993224, 20.313407158280796, 385.1597248347589, 50.362532745071206, 522.5094637377643, 114.4856024690241, 160.78363177326824, 190.9371567412477, 438.9920505245985, 190.75201639925265, 447.03120128482414, 279.8390510857602, 156.94691916781247, 433.0880078644182, 7.603046777812481, 467.41905618068694, 501.1743467655018, 309.53517321364075, 54.21303799698292, 430.338892401605, 484.32659284701253, 67.54344281525842, 531.1102535662144, 289.3495584679379, 268.4816833767984, 489.0162621700619, 539.3378485560845, 209.34337955161973, 502.97089732302004, 540.6787828900797, 294.848923105496, 327.3343810691769, 275.2138468203719, 103.00618753941684, 300.63594609604655, 362.7717625603921, 321.8141135910057, 222.6381412197656, 447.61064523445015, 335.7527982878815, 280.1360861137566, 88.43315790441582, 417.42826588609273, 281.5093378499026, 195.4336726633079, 411.7468225589238, 240.82695731636647, 266.8111553247891, 214.57473102828695, 461.7720402188845, 462.78439673460593, 116.03791902862959, 468.4839902736809, 420.0498356183516, 418.4894988696181, 269.6105248023441, 373.33185909277694, 229.62027747517038, 498.55895059146224, 243.21898150280393, 413.2824213095939, 550.6830610811187, 362.8227220461327, 227.50595276110852, 0.0, 55.40773554107576, 188.62457739166905, 500.57696494152, 338.22049993434257, 12.897801447018246, 499.0200115275997, 515.6528639078857, 228.53693085301964, 304.1323944178022, 237.8238860129234, 478.1968583517227, 203.0880962904439, 285.2683316135706, 282.6474640996488, 396.5796289509424, 330.7128379262114, 413.98113392404144, 378.1579790263227, 261.3531754602715, 67.1202932254536, 422.91024380569286, 325.1682442602847, 372.4189434596622, 404.15748689503243, 252.7595237907382, 536.4305893355462, 400.8002942806582, 228.15304734159736, 500.69983385901173, 540.8082007725023, 90.4974832034524, 196.70547043697806, 176.03339641039815, 53.479131596549806, 357.07904101370303, 283.31830305807233, 168.67286511212708, 575.0686643969707, 385.27180890641637, 260.0416363285536, 251.95725375555347, 115.14839508282469, 123.87406098975616, 453.6154143288936, 596.9817437223649, 388.2988963102607, 280.8224587109196, 417.28817703465563, 419.1531636720777, 3.648552104683069, 292.77176464032306, 292.027865516928, 26.774721676013105, 491.6395212455682, 474.09788660373283, 332.451245553172, 553.4390059469522, 391.39777295268277, 101.61680662416876, 275.951690680057, 300.92196633696676, 436.9669473815158, 327.2497261333255, 372.81986102510496, 407.6770532434531, 436.69672706065825, 114.00080176539072, 231.6225231231817, 220.09885909221458, 353.3411640726124, 211.97435529976514, 380.75635708403047, 219.0598824744743, 479.58012956393685, 468.1103836554334, 450.7916107809718, 238.68907529116268, 442.14964600201137, 397.47399601521374, 405.9375985438375, 118.83027538213982, 345.78649127406567, 485.17147530570094, 206.88992846267803, 385.6523919127443, 383.77452450032496, 408.767412425172, 190.94603071867996, 255.69231020190543]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.399214454865394, "mean_inference_ms": 6.346474409867434, "mean_action_processing_ms": 3.1963160166669313, "mean_env_wait_ms": 17.312303426966714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04187953472137451, "StateBufferConnector_ms": 0.02282083034515381, "ViewRequirementAgentConnector_ms": 0.5571274757385254}, "num_episodes": 23, "episode_return_max": 394.06833918797196, "episode_return_min": 6.644057457597196, "episode_return_mean": 145.98584239790486, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.468700050668716, "num_env_steps_trained_throughput_per_sec": 55.468700050668716, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 73079.682, "restore_workers_time_ms": 0.017, "training_step_time_ms": 73079.616, "sample_time_ms": 4729.995, "learn_time_ms": 68321.502, "learn_throughput": 58.547, "synch_weights_time_ms": 19.011}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "training_iteration": 19, "trial_id": "62684_00000", "date": "2024-08-20_16-30-40", "timestamp": 1724151640, "time_this_iter_s": 72.1785500049591, "time_total_s": 1373.194372177124, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb0c820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1373.194372177124, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 54.0049019607843, "ram_util_percent": 82.82156862745097}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.640463355712011, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.2867614101856315, "policy_loss": -0.020997885328796793, "vf_loss": 6.304916975346018, "vf_explained_var": 0.3951669168387744, "kl": 0.01421162320766598, "entropy": 1.3132512333968007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 54990.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.141018991180198, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.233765777456697, "policy_loss": -0.01821709267324497, "vf_loss": 7.249355331804386, "vf_explained_var": 0.24825686661023944, "kl": 0.013137774489987543, "entropy": 0.9744256044821764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 506.8416172640275, "episode_reward_min": 6.644057457597196, "episode_reward_mean": 144.68734478110633, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -634.7537841208415, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.1776688206403, "predator_policy": 613.5470980856336}, "policy_reward_mean": {"prey_policy": -163.6583389051258, "predator_policy": 317.831180748242}, "custom_metrics": {}, "hist_stats": {"episode_reward": [169.90215016711895, 143.82404722893077, 87.959888556331, 64.50000000000034, 56.73552306361455, 202.43177081651518, 153.646362676101, 146.93319140559933, 210.1380032567985, 191.1600374687302, 74.45989413315175, 124.17790436873538, 95.29404295098422, 298.75439892056795, 205.15047796298893, 216.86210456175093, 260.5834759886364, 212.15653333407775, 19.097260385084954, 210.2980295769356, 151.18222970611646, 18.599362411405444, 102.55078871138198, 10.280646382657675, 133.41402433480638, 159.71568139939632, 160.30986860364987, 74.14634286305832, 107.16866834017846, 359.32543972548314, 144.06017118273607, 114.84431047724013, 151.87523990331522, 235.98850960861665, 178.34295934006948, 31.599931439713586, 20.032710561778906, 50.1688707276878, 36.14380654354164, 86.95083111404813, 149.66420992412407, 129.362323132106, 94.79999999999872, 97.07359969730521, 190.61002079517593, 219.18026405084217, 114.1283693009751, 124.68769837435558, 91.7867891293439, 97.89391665313602, 102.4691978075994, 47.11655719615174, 131.45869678600263, 159.83722863320529, 255.18863968947966, 175.1501530946464, 72.04760995380269, 183.4258274649226, 332.39504894709773, 33.372032820924936, 209.39403311094173, 253.62342839437295, 118.09293431786786, 164.83334459050374, 71.78503514161062, 107.4255409979109, 164.1530882329349, 123.50503437210982, 143.19603498510835, 174.55725902325156, 394.06833918797196, 75.8057161428208, 263.1826780706436, 50.60237718321931, 156.3054676313953, 365.4388941082871, 130.89999999999887, 185.37025356174547, 161.16237926680108, 33.01672580878005, 166.92124234746228, 6.644057457597196, 93.48952737278789, 92.81579341347674, 78.53751642705255, 93.53527350447553, 189.0503911561792, 88.90000000000025, 506.8416172640275, 224.2489252440386, 16.6233654089528, 356.5574327663328, 85.80840442467695, 26.071193390010166, 97.10749610712287, 137.120740977772, 171.82326367097252, 212.14871521550148, 144.19004557910426, 61.46723860408286], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-128.52998611289067, -195.90444100575831, -133.47130934396256, -249.97272126557917, -151.52930639204902, -211.43926933076062, -65.7108559331469, -318.7176325960045, -58.971305319890384, -325.42692981489284, -112.55150443129583, 20.000000000000014, -53.529389643135715, -108.92041308406431, -406.28678850545697, 20.000000000000014, 132.5241714645022, -490.117658162411, -32.0159417196334, 20.000000000000014, -592.0798797922567, 47.33725363671326, -305.85985550094523, 20.000000000000014, -100.95155875478889, -154.9079579467863, -28.804679057335278, 93.82443226011988, 12.517366570006105, -189.29959979379367, 1.754899073533487, 28.978665290951035, -403.998635369546, -22.818940273347494, 18.907139663878354, -307.43255260162425, -581.7010232558026, 20.000000000000014, 20.000000000000014, -89.67983780682417, -129.5215246823117, 166.23497289518696, -104.37043954215504, 3.4528991297230336, -323.67604854842943, -198.06606865549412, -413.23596381882925, 101.2938846654898, -533.8496216356352, 38.00000000000017, 166.39817059204174, 0.2971379128906282, -34.938353605935745, -228.22435393137636, -318.6250101721175, -474.2461438644577, 1.2588944425185036, 61.44513175379811, -217.65258093650127, -118.04645163894925, 63.209398360530066, 18.229388530328894, -482.12659284701203, -531.1142314442735, -266.66147787746513, -4.0847403010083365, -179.38215057799167, 14.54048008087164, -490.1054863383581, -539.2378485560845, -1.714425348004307, -197.4483078209584, -542.5358470672965, -500.77089732301977, 133.07108851202335, -369.3071088607591, -89.93811489884371, -3.222399015673367, 20.000000000000014, -137.03697982732388, -100.87318592881378, 20.000000000000014, -242.73107910434567, -366.53028668903306, 15.285756137202972, -66.97821434498569, -385.59112826280995, -303.35767696133144, -148.02657386002934, 27.346247024511662, 20.46303471508501, -258.6710470667724, 13.69893951625145, -21.62583400810649, -516.0604269287121, -46.40703232193516, 128.56265209285587, -175.5210848528487, -408.3468225589239, -60.58390202595484, 20.000000000000014, -231.06570100658274, -32.4459427577675, -391.7087281371763, -73.84914101215865, -461.8914696409048, 7.560406804900918, -92.89132148751888, -466.7441170602137, -413.80628576931304, 12.049287499273289, -413.27681732749636, -219.65379040166638, -5.000545215112114, -2.2095550235111268, -140.28146395072866, -424.3173110501669, -175.16733107335438, 4.299180684598614, -483.95895059146216, -549.9304115972154, -98.41350429172755, -165.9573565776463, -391.0629549906137, -42.714223526711855, -27.18917315780788, 20.51636545411126, -1.1241009951870011, 20.000000000000014, -498.499287897672, -86.96771378667708, -6.660940951533952, -46.8942788960804, 93.02596995161183, -206.6399716417149, -300.00348717558717, -514.5052407325718, 19.016116523516818, 20.000000000000014, -299.3323944178011, -139.20856155204368, -475.79685835172216, -161.83859424236877, 46.30240660380218, 4.7927706511819075, -379.96814552997006, -21.394263895881977, -151.56773540521408, -276.9474640996491, -152.81797689259218, -123.69343791202286, -302.477937794306, -216.05339833632428, -26.06008190124467, -442.96075700968885, -123.37375837950934, -178.26189790342042, -89.84127821147271, -90.46866413025073, 106.48781107055062, -562.3260880582192, -81.91168209907309, -519.0441847668413, 4.480014186778689, 112.83579958377184, -598.624177694848, -235.60509987610578, 72.14854704939455, 15.550428819748916, -172.49309807431354, -499.86260199224193, -75.19748320345327, -536.8082007725025, 164.12582746492322, 48.73837185992592, 69.678514737195, -158.76070449740092, -218.30502052123123, -178.88111926809808, 20.000000000000014, -240.86422855704922, -119.97286511212747, 118.23995860991934, -448.2060758396088, -118.26000478646061, -140.250964282945, -71.98097635739168, 20.000000000000014, -341.92497940884664, 25.860035034765065, -18.849774025129395, -81.19937249171261, -427.41853626400075, -186.73258981905613, -364.66099682659143, -231.45984634043538, -60.48544107935926, -269.7505266034741, -259.5681488415838, -289.3480660295698, -123.37203760264288, -147.24078223480376, -48.40034491601949, 22.725844777926877, 23.615192240991874, -57.33167302019602, -141.89007142862815, -383.6227752804951, -82.3783339399868, -325.17903960556686, 105.08732187481831, -634.7537841208415, 37.844549933872585, 5.826848494472879, -45.81680662416882, -377.2189053043347, -343.1385807253051, 157.2209581819147, -127.77335640299005, -108.86208317997158, -168.25358162122618, -436.498631530424, 64.09999999999997, -313.09187721024057, -375.19956942692147, 85.76348955964988, 148.21721582452992, -419.2393401019418, 20.000000000000014, -210.92252312318232, -129.89885909221442, -147.00962316367082, -126.42647806684906, -106.50916458011218, -88.81008080952815, -167.1184765227976, -182.72530295937824, -460.4214803792086, 13.997702792385386, -468.2500098237672, -449.80944663748227, -91.41239050438105, 18.662393417190774, -428.17160967303573, -384.2937922511305, -20.51418263546149, 15.458669186555897, -53.51639544539984, -393.22062029434363, -586.8884714565875, -66.64523695090315, -84.60846475879958, -21.861189077672066, -512.1436148706966, 20.000000000000014, -317.83051608253567, 18.11037719934423, -399.28652453782826, -120.62271514381109, -53.05226948340112, -83.91296513719361, 48.79999999999997, -7.374284694912342, 8.746939437895174, -23.71542665478904, -547.6001907102321, 189.1776688206403, -407.75513588067815, 4.74637135302078, 42.66359788658115, -500.43711498758313, 1.7045738608550813, -476.9984728325296, -349.988080884483, 181.85041250625497, -302.0692574558211, 18.900000000000013, -393.94606640413554, 20.000000000000014, -386.2129016299931, -130.00725651924375, -242.6903359319837, -1.079241698041284, -469.65367881461515, -95.71267739649315, -74.29047772960517, 9.781913698779954, -425.2568866871559, -116.74139875871222, -329.43642033970946, -195.38077667540082, -0.393458529159858, -108.85863234300703, -596.6482369163751, -358.97791726072774, 119.849384814421, -386.8990789791497, -191.13223843712132, 8.989086704733044, -612.5617640819324], "policy_predator_policy_reward": [213.8792625450736, 413.92862408465663, 425.35869851337173, 331.40664570394785, 447.3283223410769, 84.03136006429776, 357.6269298148928, 124.85150443129518, 194.44492615193974, 431.0271881443316, 164.66864629633264, 375.3566112180925, 327.37903884604316, 430.3631453419481, 226.3011909971856, 159.15460227264595, 277.0135327777979, 217.78866623791117, 183.27061442267726, 90.84722400972117, 427.41155797993224, 20.313407158280796, 385.1597248347589, 50.362532745071206, 522.5094637377643, 114.4856024690241, 160.78363177326824, 190.9371567412477, 438.9920505245985, 190.75201639925265, 447.03120128482414, 279.8390510857602, 156.94691916781247, 433.0880078644182, 7.603046777812481, 467.41905618068694, 501.1743467655018, 309.53517321364075, 54.21303799698292, 430.338892401605, 484.32659284701253, 67.54344281525842, 531.1102535662144, 289.3495584679379, 268.4816833767984, 489.0162621700619, 539.3378485560845, 209.34337955161973, 502.97089732302004, 540.6787828900797, 294.848923105496, 327.3343810691769, 275.2138468203719, 103.00618753941684, 300.63594609604655, 362.7717625603921, 321.8141135910057, 222.6381412197656, 447.61064523445015, 335.7527982878815, 280.1360861137566, 88.43315790441582, 417.42826588609273, 281.5093378499026, 195.4336726633079, 411.7468225589238, 240.82695731636647, 266.8111553247891, 214.57473102828695, 461.7720402188845, 462.78439673460593, 116.03791902862959, 468.4839902736809, 420.0498356183516, 418.4894988696181, 269.6105248023441, 373.33185909277694, 229.62027747517038, 498.55895059146224, 243.21898150280393, 413.2824213095939, 550.6830610811187, 362.8227220461327, 227.50595276110852, 0.0, 55.40773554107576, 188.62457739166905, 500.57696494152, 338.22049993434257, 12.897801447018246, 499.0200115275997, 515.6528639078857, 228.53693085301964, 304.1323944178022, 237.8238860129234, 478.1968583517227, 203.0880962904439, 285.2683316135706, 282.6474640996488, 396.5796289509424, 330.7128379262114, 413.98113392404144, 378.1579790263227, 261.3531754602715, 67.1202932254536, 422.91024380569286, 325.1682442602847, 372.4189434596622, 404.15748689503243, 252.7595237907382, 536.4305893355462, 400.8002942806582, 228.15304734159736, 500.69983385901173, 540.8082007725023, 90.4974832034524, 196.70547043697806, 176.03339641039815, 53.479131596549806, 357.07904101370303, 283.31830305807233, 168.67286511212708, 575.0686643969707, 385.27180890641637, 260.0416363285536, 251.95725375555347, 115.14839508282469, 123.87406098975616, 453.6154143288936, 596.9817437223649, 388.2988963102607, 280.8224587109196, 417.28817703465563, 419.1531636720777, 3.648552104683069, 292.77176464032306, 292.027865516928, 26.774721676013105, 491.6395212455682, 474.09788660373283, 332.451245553172, 553.4390059469522, 391.39777295268277, 101.61680662416876, 275.951690680057, 300.92196633696676, 436.9669473815158, 327.2497261333255, 372.81986102510496, 407.6770532434531, 436.69672706065825, 114.00080176539072, 231.6225231231817, 220.09885909221458, 353.3411640726124, 211.97435529976514, 380.75635708403047, 219.0598824744743, 479.58012956393685, 468.1103836554334, 450.7916107809718, 238.68907529116268, 442.14964600201137, 397.47399601521374, 405.9375985438375, 118.83027538213982, 345.78649127406567, 485.17147530570094, 206.88992846267803, 385.6523919127443, 383.77452450032496, 408.767412425172, 190.94603071867996, 255.69231020190543, 28.274284694912456, 10.453060562104792, 386.2296489030699, 502.7499169053366, 449.95686703021744, 134.63722485489865, 446.7543158341542, 545.6000635340574, 481.9353607512761, 344.82899784910643, 267.11742292755827, 173.7370479012568, 381.6483455719918, 403.3333418992385, 179.43366674001456, 484.11942727625836, 218.48983581495722, 408.3963558807974, 315.79968773368734, 497.58217171110755, 304.5019449184101, 613.5470980856336, 408.0397397438331, 362.1779172607283, 338.3275147205788, 517.8446396978244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.460493925140767, "mean_inference_ms": 6.440578951793822, "mean_action_processing_ms": 3.1090512879417447, "mean_env_wait_ms": 17.35554063158534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04136502742767334, "StateBufferConnector_ms": 0.022649049758911133, "ViewRequirementAgentConnector_ms": 0.576509952545166}, "num_episodes": 13, "episode_return_max": 506.8416172640275, "episode_return_min": 6.644057457597196, "episode_return_mean": 144.68734478110633, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 52.78736826150837, "num_env_steps_trained_throughput_per_sec": 52.78736826150837, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 73392.823, "restore_workers_time_ms": 0.017, "training_step_time_ms": 73392.756, "sample_time_ms": 4728.36, "learn_time_ms": 68637.36, "learn_throughput": 58.277, "synch_weights_time_ms": 18.541}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 20, "trial_id": "62684_00000", "date": "2024-08-20_16-31-56", "timestamp": 1724151716, "time_this_iter_s": 75.80990815162659, "time_total_s": 1449.0042803287506, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffa2160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1449.0042803287506, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 60.03518518518518, "ram_util_percent": 83.25925925925925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.06334329991476, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.508996607733111, "policy_loss": -0.019538613349522945, "vf_loss": 6.5258652764854705, "vf_explained_var": 0.37306944098032957, "kl": 0.013349752454582522, "entropy": 1.3026544377736167, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 57810.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.397917019595544, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.311193946555809, "policy_loss": -0.021973295186808895, "vf_loss": 7.329783871564915, "vf_explained_var": 0.23765600005154888, "kl": 0.016916853255005897, "entropy": 0.9286810556732158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "env_runners": {"episode_reward_max": 506.8416172640275, "episode_reward_min": 6.644057457597196, "episode_reward_mean": 143.47718706716404, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -753.6425694726457, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.1776688206403, "predator_policy": 714.6800419875382}, "policy_reward_mean": {"prey_policy": -172.14899192163833, "predator_policy": 329.9620814160397}, "custom_metrics": {}, "hist_stats": {"episode_reward": [260.5834759886364, 212.15653333407775, 19.097260385084954, 210.2980295769356, 151.18222970611646, 18.599362411405444, 102.55078871138198, 10.280646382657675, 133.41402433480638, 159.71568139939632, 160.30986860364987, 74.14634286305832, 107.16866834017846, 359.32543972548314, 144.06017118273607, 114.84431047724013, 151.87523990331522, 235.98850960861665, 178.34295934006948, 31.599931439713586, 20.032710561778906, 50.1688707276878, 36.14380654354164, 86.95083111404813, 149.66420992412407, 129.362323132106, 94.79999999999872, 97.07359969730521, 190.61002079517593, 219.18026405084217, 114.1283693009751, 124.68769837435558, 91.7867891293439, 97.89391665313602, 102.4691978075994, 47.11655719615174, 131.45869678600263, 159.83722863320529, 255.18863968947966, 175.1501530946464, 72.04760995380269, 183.4258274649226, 332.39504894709773, 33.372032820924936, 209.39403311094173, 253.62342839437295, 118.09293431786786, 164.83334459050374, 71.78503514161062, 107.4255409979109, 164.1530882329349, 123.50503437210982, 143.19603498510835, 174.55725902325156, 394.06833918797196, 75.8057161428208, 263.1826780706436, 50.60237718321931, 156.3054676313953, 365.4388941082871, 130.89999999999887, 185.37025356174547, 161.16237926680108, 33.01672580878005, 166.92124234746228, 6.644057457597196, 93.48952737278789, 92.81579341347674, 78.53751642705255, 93.53527350447553, 189.0503911561792, 88.90000000000025, 506.8416172640275, 224.2489252440386, 16.6233654089528, 356.5574327663328, 85.80840442467695, 26.071193390010166, 97.10749610712287, 137.120740977772, 171.82326367097252, 212.14871521550148, 144.19004557910426, 61.46723860408286, 199.47513910881796, 326.9010437826144, 115.55176499587415, 22.5049976319897, 150.1246127650514, 71.29022565637696, 98.48361995807286, 394.2004107192811, 26.399903788713964, 206.52171680304392, 112.18138303957225, 80.57938509057776, 175.79529218951254, 221.84834060402036, 38.280237111747994, 80.77595289842249], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-533.8496216356352, 38.00000000000017, 166.39817059204174, 0.2971379128906282, -34.938353605935745, -228.22435393137636, -318.6250101721175, -474.2461438644577, 1.2588944425185036, 61.44513175379811, -217.65258093650127, -118.04645163894925, 63.209398360530066, 18.229388530328894, -482.12659284701203, -531.1142314442735, -266.66147787746513, -4.0847403010083365, -179.38215057799167, 14.54048008087164, -490.1054863383581, -539.2378485560845, -1.714425348004307, -197.4483078209584, -542.5358470672965, -500.77089732301977, 133.07108851202335, -369.3071088607591, -89.93811489884371, -3.222399015673367, 20.000000000000014, -137.03697982732388, -100.87318592881378, 20.000000000000014, -242.73107910434567, -366.53028668903306, 15.285756137202972, -66.97821434498569, -385.59112826280995, -303.35767696133144, -148.02657386002934, 27.346247024511662, 20.46303471508501, -258.6710470667724, 13.69893951625145, -21.62583400810649, -516.0604269287121, -46.40703232193516, 128.56265209285587, -175.5210848528487, -408.3468225589239, -60.58390202595484, 20.000000000000014, -231.06570100658274, -32.4459427577675, -391.7087281371763, -73.84914101215865, -461.8914696409048, 7.560406804900918, -92.89132148751888, -466.7441170602137, -413.80628576931304, 12.049287499273289, -413.27681732749636, -219.65379040166638, -5.000545215112114, -2.2095550235111268, -140.28146395072866, -424.3173110501669, -175.16733107335438, 4.299180684598614, -483.95895059146216, -549.9304115972154, -98.41350429172755, -165.9573565776463, -391.0629549906137, -42.714223526711855, -27.18917315780788, 20.51636545411126, -1.1241009951870011, 20.000000000000014, -498.499287897672, -86.96771378667708, -6.660940951533952, -46.8942788960804, 93.02596995161183, -206.6399716417149, -300.00348717558717, -514.5052407325718, 19.016116523516818, 20.000000000000014, -299.3323944178011, -139.20856155204368, -475.79685835172216, -161.83859424236877, 46.30240660380218, 4.7927706511819075, -379.96814552997006, -21.394263895881977, -151.56773540521408, -276.9474640996491, -152.81797689259218, -123.69343791202286, -302.477937794306, -216.05339833632428, -26.06008190124467, -442.96075700968885, -123.37375837950934, -178.26189790342042, -89.84127821147271, -90.46866413025073, 106.48781107055062, -562.3260880582192, -81.91168209907309, -519.0441847668413, 4.480014186778689, 112.83579958377184, -598.624177694848, -235.60509987610578, 72.14854704939455, 15.550428819748916, -172.49309807431354, -499.86260199224193, -75.19748320345327, -536.8082007725025, 164.12582746492322, 48.73837185992592, 69.678514737195, -158.76070449740092, -218.30502052123123, -178.88111926809808, 20.000000000000014, -240.86422855704922, -119.97286511212747, 118.23995860991934, -448.2060758396088, -118.26000478646061, -140.250964282945, -71.98097635739168, 20.000000000000014, -341.92497940884664, 25.860035034765065, -18.849774025129395, -81.19937249171261, -427.41853626400075, -186.73258981905613, -364.66099682659143, -231.45984634043538, -60.48544107935926, -269.7505266034741, -259.5681488415838, -289.3480660295698, -123.37203760264288, -147.24078223480376, -48.40034491601949, 22.725844777926877, 23.615192240991874, -57.33167302019602, -141.89007142862815, -383.6227752804951, -82.3783339399868, -325.17903960556686, 105.08732187481831, -634.7537841208415, 37.844549933872585, 5.826848494472879, -45.81680662416882, -377.2189053043347, -343.1385807253051, 157.2209581819147, -127.77335640299005, -108.86208317997158, -168.25358162122618, -436.498631530424, 64.09999999999997, -313.09187721024057, -375.19956942692147, 85.76348955964988, 148.21721582452992, -419.2393401019418, 20.000000000000014, -210.92252312318232, -129.89885909221442, -147.00962316367082, -126.42647806684906, -106.50916458011218, -88.81008080952815, -167.1184765227976, -182.72530295937824, -460.4214803792086, 13.997702792385386, -468.2500098237672, -449.80944663748227, -91.41239050438105, 18.662393417190774, -428.17160967303573, -384.2937922511305, -20.51418263546149, 15.458669186555897, -53.51639544539984, -393.22062029434363, -586.8884714565875, -66.64523695090315, -84.60846475879958, -21.861189077672066, -512.1436148706966, 20.000000000000014, -317.83051608253567, 18.11037719934423, -399.28652453782826, -120.62271514381109, -53.05226948340112, -83.91296513719361, 48.79999999999997, -7.374284694912342, 8.746939437895174, -23.71542665478904, -547.6001907102321, 189.1776688206403, -407.75513588067815, 4.74637135302078, 42.66359788658115, -500.43711498758313, 1.7045738608550813, -476.9984728325296, -349.988080884483, 181.85041250625497, -302.0692574558211, 18.900000000000013, -393.94606640413554, 20.000000000000014, -386.2129016299931, -130.00725651924375, -242.6903359319837, -1.079241698041284, -469.65367881461515, -95.71267739649315, -74.29047772960517, 9.781913698779954, -425.2568866871559, -116.74139875871222, -329.43642033970946, -195.38077667540082, -0.393458529159858, -108.85863234300703, -596.6482369163751, -358.97791726072774, 119.849384814421, -386.8990789791497, -191.13223843712132, 8.989086704733044, -612.5617640819324, -358.82041220668924, -326.0165604639055, 172.99999999999983, -58.48173694430761, 137.44223747259807, -230.90352691746725, -518.4496288899278, -170.19474829860513, -131.98958042610278, -234.11448790021822, 6.489630939656864, -459.36393808490857, -398.9886194595275, -614.9063297194355, 139.8691537805047, -576.4800827006399, 31.69673340351376, -46.876782616808626, -409.0609062355271, -289.02291231432383, -58.49357712445691, 161.95766896551515, 179.1695475580893, -512.0279067061598, -420.95713919988424, -40.64475758760891, -184.87678284213393, 40.69455298772636, 31.825380610309082, -555.4291384384364, -533.9527853441193, 20.000000000000014, -140.34096894560648, -3.128771535642547, -33.616613406880575, -44.254851739416885, -753.6425694726457, 0.2715832772506151, 20.000000000000014, 37.37574288341837, -387.81888698166784, 21.80000000000004, -307.9235169884348, -331.1733953428515, 16.8802371117479, 20.000000000000014, -111.79748929470453, -604.5933032261506], "policy_predator_policy_reward": [156.94691916781247, 433.0880078644182, 7.603046777812481, 467.41905618068694, 501.1743467655018, 309.53517321364075, 54.21303799698292, 430.338892401605, 484.32659284701253, 67.54344281525842, 531.1102535662144, 289.3495584679379, 268.4816833767984, 489.0162621700619, 539.3378485560845, 209.34337955161973, 502.97089732302004, 540.6787828900797, 294.848923105496, 327.3343810691769, 275.2138468203719, 103.00618753941684, 300.63594609604655, 362.7717625603921, 321.8141135910057, 222.6381412197656, 447.61064523445015, 335.7527982878815, 280.1360861137566, 88.43315790441582, 417.42826588609273, 281.5093378499026, 195.4336726633079, 411.7468225589238, 240.82695731636647, 266.8111553247891, 214.57473102828695, 461.7720402188845, 462.78439673460593, 116.03791902862959, 468.4839902736809, 420.0498356183516, 418.4894988696181, 269.6105248023441, 373.33185909277694, 229.62027747517038, 498.55895059146224, 243.21898150280393, 413.2824213095939, 550.6830610811187, 362.8227220461327, 227.50595276110852, 0.0, 55.40773554107576, 188.62457739166905, 500.57696494152, 338.22049993434257, 12.897801447018246, 499.0200115275997, 515.6528639078857, 228.53693085301964, 304.1323944178022, 237.8238860129234, 478.1968583517227, 203.0880962904439, 285.2683316135706, 282.6474640996488, 396.5796289509424, 330.7128379262114, 413.98113392404144, 378.1579790263227, 261.3531754602715, 67.1202932254536, 422.91024380569286, 325.1682442602847, 372.4189434596622, 404.15748689503243, 252.7595237907382, 536.4305893355462, 400.8002942806582, 228.15304734159736, 500.69983385901173, 540.8082007725023, 90.4974832034524, 196.70547043697806, 176.03339641039815, 53.479131596549806, 357.07904101370303, 283.31830305807233, 168.67286511212708, 575.0686643969707, 385.27180890641637, 260.0416363285536, 251.95725375555347, 115.14839508282469, 123.87406098975616, 453.6154143288936, 596.9817437223649, 388.2988963102607, 280.8224587109196, 417.28817703465563, 419.1531636720777, 3.648552104683069, 292.77176464032306, 292.027865516928, 26.774721676013105, 491.6395212455682, 474.09788660373283, 332.451245553172, 553.4390059469522, 391.39777295268277, 101.61680662416876, 275.951690680057, 300.92196633696676, 436.9669473815158, 327.2497261333255, 372.81986102510496, 407.6770532434531, 436.69672706065825, 114.00080176539072, 231.6225231231817, 220.09885909221458, 353.3411640726124, 211.97435529976514, 380.75635708403047, 219.0598824744743, 479.58012956393685, 468.1103836554334, 450.7916107809718, 238.68907529116268, 442.14964600201137, 397.47399601521374, 405.9375985438375, 118.83027538213982, 345.78649127406567, 485.17147530570094, 206.88992846267803, 385.6523919127443, 383.77452450032496, 408.767412425172, 190.94603071867996, 255.69231020190543, 28.274284694912456, 10.453060562104792, 386.2296489030699, 502.7499169053366, 449.95686703021744, 134.63722485489865, 446.7543158341542, 545.6000635340574, 481.9353607512761, 344.82899784910643, 267.11742292755827, 173.7370479012568, 381.6483455719918, 403.3333418992385, 179.43366674001456, 484.11942727625836, 218.48983581495722, 408.3963558807974, 315.79968773368734, 497.58217171110755, 304.5019449184101, 613.5470980856336, 408.0397397438331, 362.1779172607283, 338.3275147205788, 517.8446396978244, 261.11424735206424, 450.1978644273491, 326.07529194216727, 152.7687782296218, 523.2236803967709, 412.96204221373904, 247.77827213159114, 461.7155205458692, 612.3228291531193, 411.82757901039093, 74.84978926466317, 588.1005683056488, 427.5534735744531, 427.50754205792816, 167.94180892710176, 397.15929197473446, 467.41034473874043, 205.4682386796005, 542.5724025870782, 146.85851905636795, 483.2525623519593, 283.2225749773385, 70.51661340688031, 91.06300836563705, 194.48623639736937, 714.6800419875382, 506.96104442122333, 43.53044028104765, 332.9733953428516, 327.5235169884361, 187.54691449277448, 589.619830926503]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.40193546819436, "mean_inference_ms": 6.525487065167272, "mean_action_processing_ms": 3.2075094571002905, "mean_env_wait_ms": 17.366472226979752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0607905387878418, "StateBufferConnector_ms": 0.021787166595458984, "ViewRequirementAgentConnector_ms": 0.533703088760376}, "num_episodes": 16, "episode_return_max": 506.8416172640275, "episode_return_min": 6.644057457597196, "episode_return_mean": 143.47718706716404, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 57.974176953950035, "num_env_steps_trained_throughput_per_sec": 57.974176953950035, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 420000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 73171.51, "restore_workers_time_ms": 0.017, "training_step_time_ms": 73171.443, "sample_time_ms": 4574.843, "learn_time_ms": 68568.333, "learn_throughput": 58.336, "synch_weights_time_ms": 18.71}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "training_iteration": 21, "trial_id": "62684_00000", "date": "2024-08-20_16-33-05", "timestamp": 1724151785, "time_this_iter_s": 69.04817771911621, "time_total_s": 1518.0524580478668, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb0ca60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1518.0524580478668, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 52.051020408163254, "ram_util_percent": 83.2734693877551}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.224081197719203, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.043522430480794, "policy_loss": -0.021883923479963544, "vf_loss": 7.062366323437251, "vf_explained_var": 0.40296061315857773, "kl": 0.015200196063403596, "entropy": 1.271709723802323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 60630.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.153030319157101, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.7350981523120215, "policy_loss": -0.017167412787281646, "vf_loss": 7.749809160182085, "vf_explained_var": 0.21146890820649566, "kl": 0.012281952660639214, "entropy": 0.8658756853411438, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "env_runners": {"episode_reward_max": 506.8416172640275, "episode_reward_min": -60.787318657377156, "episode_reward_mean": 145.31259408857466, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -753.6425694726457, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.59999999999997, "predator_policy": 714.6800419875382}, "policy_reward_mean": {"prey_policy": -165.3132786876882, "predator_policy": 320.62621507581986}, "custom_metrics": {}, "hist_stats": {"episode_reward": [129.362323132106, 94.79999999999872, 97.07359969730521, 190.61002079517593, 219.18026405084217, 114.1283693009751, 124.68769837435558, 91.7867891293439, 97.89391665313602, 102.4691978075994, 47.11655719615174, 131.45869678600263, 159.83722863320529, 255.18863968947966, 175.1501530946464, 72.04760995380269, 183.4258274649226, 332.39504894709773, 33.372032820924936, 209.39403311094173, 253.62342839437295, 118.09293431786786, 164.83334459050374, 71.78503514161062, 107.4255409979109, 164.1530882329349, 123.50503437210982, 143.19603498510835, 174.55725902325156, 394.06833918797196, 75.8057161428208, 263.1826780706436, 50.60237718321931, 156.3054676313953, 365.4388941082871, 130.89999999999887, 185.37025356174547, 161.16237926680108, 33.01672580878005, 166.92124234746228, 6.644057457597196, 93.48952737278789, 92.81579341347674, 78.53751642705255, 93.53527350447553, 189.0503911561792, 88.90000000000025, 506.8416172640275, 224.2489252440386, 16.6233654089528, 356.5574327663328, 85.80840442467695, 26.071193390010166, 97.10749610712287, 137.120740977772, 171.82326367097252, 212.14871521550148, 144.19004557910426, 61.46723860408286, 199.47513910881796, 326.9010437826144, 115.55176499587415, 22.5049976319897, 150.1246127650514, 71.29022565637696, 98.48361995807286, 394.2004107192811, 26.399903788713964, 206.52171680304392, 112.18138303957225, 80.57938509057776, 175.79529218951254, 221.84834060402036, 38.280237111747994, 80.77595289842249, 121.62992802617514, 168.63107168722223, 229.48208650107892, 151.21382706035047, -8.461001610251174, 330.9781555085473, 155.0857018171649, 53.19570886438804, 98.88463696973409, 99.5558327322842, 150.98076156177552, 93.5080751843884, -60.787318657377156, 114.07481350609795, 102.09704024226279, 119.92514648073109, 197.77879568234792, 51.60000000000046, 229.86626323641468, 88.68069589785839, 132.39227460134322, 242.31915170040403, 249.576897399721, 117.73193505690466, 132.10012527723745], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-391.0629549906137, -42.714223526711855, -27.18917315780788, 20.51636545411126, -1.1241009951870011, 20.000000000000014, -498.499287897672, -86.96771378667708, -6.660940951533952, -46.8942788960804, 93.02596995161183, -206.6399716417149, -300.00348717558717, -514.5052407325718, 19.016116523516818, 20.000000000000014, -299.3323944178011, -139.20856155204368, -475.79685835172216, -161.83859424236877, 46.30240660380218, 4.7927706511819075, -379.96814552997006, -21.394263895881977, -151.56773540521408, -276.9474640996491, -152.81797689259218, -123.69343791202286, -302.477937794306, -216.05339833632428, -26.06008190124467, -442.96075700968885, -123.37375837950934, -178.26189790342042, -89.84127821147271, -90.46866413025073, 106.48781107055062, -562.3260880582192, -81.91168209907309, -519.0441847668413, 4.480014186778689, 112.83579958377184, -598.624177694848, -235.60509987610578, 72.14854704939455, 15.550428819748916, -172.49309807431354, -499.86260199224193, -75.19748320345327, -536.8082007725025, 164.12582746492322, 48.73837185992592, 69.678514737195, -158.76070449740092, -218.30502052123123, -178.88111926809808, 20.000000000000014, -240.86422855704922, -119.97286511212747, 118.23995860991934, -448.2060758396088, -118.26000478646061, -140.250964282945, -71.98097635739168, 20.000000000000014, -341.92497940884664, 25.860035034765065, -18.849774025129395, -81.19937249171261, -427.41853626400075, -186.73258981905613, -364.66099682659143, -231.45984634043538, -60.48544107935926, -269.7505266034741, -259.5681488415838, -289.3480660295698, -123.37203760264288, -147.24078223480376, -48.40034491601949, 22.725844777926877, 23.615192240991874, -57.33167302019602, -141.89007142862815, -383.6227752804951, -82.3783339399868, -325.17903960556686, 105.08732187481831, -634.7537841208415, 37.844549933872585, 5.826848494472879, -45.81680662416882, -377.2189053043347, -343.1385807253051, 157.2209581819147, -127.77335640299005, -108.86208317997158, -168.25358162122618, -436.498631530424, 64.09999999999997, -313.09187721024057, -375.19956942692147, 85.76348955964988, 148.21721582452992, -419.2393401019418, 20.000000000000014, -210.92252312318232, -129.89885909221442, -147.00962316367082, -126.42647806684906, -106.50916458011218, -88.81008080952815, -167.1184765227976, -182.72530295937824, -460.4214803792086, 13.997702792385386, -468.2500098237672, -449.80944663748227, -91.41239050438105, 18.662393417190774, -428.17160967303573, -384.2937922511305, -20.51418263546149, 15.458669186555897, -53.51639544539984, -393.22062029434363, -586.8884714565875, -66.64523695090315, -84.60846475879958, -21.861189077672066, -512.1436148706966, 20.000000000000014, -317.83051608253567, 18.11037719934423, -399.28652453782826, -120.62271514381109, -53.05226948340112, -83.91296513719361, 48.79999999999997, -7.374284694912342, 8.746939437895174, -23.71542665478904, -547.6001907102321, 189.1776688206403, -407.75513588067815, 4.74637135302078, 42.66359788658115, -500.43711498758313, 1.7045738608550813, -476.9984728325296, -349.988080884483, 181.85041250625497, -302.0692574558211, 18.900000000000013, -393.94606640413554, 20.000000000000014, -386.2129016299931, -130.00725651924375, -242.6903359319837, -1.079241698041284, -469.65367881461515, -95.71267739649315, -74.29047772960517, 9.781913698779954, -425.2568866871559, -116.74139875871222, -329.43642033970946, -195.38077667540082, -0.393458529159858, -108.85863234300703, -596.6482369163751, -358.97791726072774, 119.849384814421, -386.8990789791497, -191.13223843712132, 8.989086704733044, -612.5617640819324, -358.82041220668924, -326.0165604639055, 172.99999999999983, -58.48173694430761, 137.44223747259807, -230.90352691746725, -518.4496288899278, -170.19474829860513, -131.98958042610278, -234.11448790021822, 6.489630939656864, -459.36393808490857, -398.9886194595275, -614.9063297194355, 139.8691537805047, -576.4800827006399, 31.69673340351376, -46.876782616808626, -409.0609062355271, -289.02291231432383, -58.49357712445691, 161.95766896551515, 179.1695475580893, -512.0279067061598, -420.95713919988424, -40.64475758760891, -184.87678284213393, 40.69455298772636, 31.825380610309082, -555.4291384384364, -533.9527853441193, 20.000000000000014, -140.34096894560648, -3.128771535642547, -33.616613406880575, -44.254851739416885, -753.6425694726457, 0.2715832772506151, 20.000000000000014, 37.37574288341837, -387.81888698166784, 21.80000000000004, -307.9235169884348, -331.1733953428515, 16.8802371117479, 20.000000000000014, -111.79748929470453, -604.5933032261506, -175.8297991081668, 58.5233318061485, -245.6401015162189, 22.669567170436522, -429.03249513105743, -178.8800843806158, 128.5375934227036, -2.732630924716996, -418.15427964999606, 20.000000000000014, 20.000000000000014, -233.83178707872673, -20.343286212457457, -36.78687072701428, -208.37034065506836, -22.528025677504655, 20.000000000000014, -603.5955566412615, -257.05354008667206, -137.1112509226622, 20.000000000000014, -239.74023448946812, -215.47889437190304, -181.61702328138568, -245.76964133649784, 17.799999999999976, -288.85100343011413, -600.0623109269346, 112.80130153092769, -605.5889580261323, 20.000000000000014, -155.39174458360705, 18.916807938181226, 2.6756870486867284, -417.64426857811526, 58.27933844125719, -374.1785749605774, -236.4852329655371, -178.24127184972704, 13.159093919561663, 37.59370417313607, -695.4716453723925, -497.52526298996565, -14.816174586750048, -143.4454813083436, 20.000000000000014, 53.29999999999996, -584.3781541717306, -488.5842852785348, 1.8113046633498346, 62.29999999999997, -158.07968502594142, -31.843404989375962, 14.544554549015237, -335.8619461859233, 174.16626323641535, -10.287714341463559, -333.17228932560295, 20.000000000000014, -353.41137050371725, -238.51175732486607, 3.822703568453128, -94.0652832541678, -476.9438788349074, -99.99282256273565, 38.25673138025421, -307.4072597521577, 16.28542072052258, 194.59999999999997, -304.9759196690258, -61.85150326467048, -225.5114037127773, -412.6809515325081, 20.000000000000014, 20.000000000000014], "policy_predator_policy_reward": [362.8227220461327, 227.50595276110852, 0.0, 55.40773554107576, 188.62457739166905, 500.57696494152, 338.22049993434257, 12.897801447018246, 499.0200115275997, 515.6528639078857, 228.53693085301964, 304.1323944178022, 237.8238860129234, 478.1968583517227, 203.0880962904439, 285.2683316135706, 282.6474640996488, 396.5796289509424, 330.7128379262114, 413.98113392404144, 378.1579790263227, 261.3531754602715, 67.1202932254536, 422.91024380569286, 325.1682442602847, 372.4189434596622, 404.15748689503243, 252.7595237907382, 536.4305893355462, 400.8002942806582, 228.15304734159736, 500.69983385901173, 540.8082007725023, 90.4974832034524, 196.70547043697806, 176.03339641039815, 53.479131596549806, 357.07904101370303, 283.31830305807233, 168.67286511212708, 575.0686643969707, 385.27180890641637, 260.0416363285536, 251.95725375555347, 115.14839508282469, 123.87406098975616, 453.6154143288936, 596.9817437223649, 388.2988963102607, 280.8224587109196, 417.28817703465563, 419.1531636720777, 3.648552104683069, 292.77176464032306, 292.027865516928, 26.774721676013105, 491.6395212455682, 474.09788660373283, 332.451245553172, 553.4390059469522, 391.39777295268277, 101.61680662416876, 275.951690680057, 300.92196633696676, 436.9669473815158, 327.2497261333255, 372.81986102510496, 407.6770532434531, 436.69672706065825, 114.00080176539072, 231.6225231231817, 220.09885909221458, 353.3411640726124, 211.97435529976514, 380.75635708403047, 219.0598824744743, 479.58012956393685, 468.1103836554334, 450.7916107809718, 238.68907529116268, 442.14964600201137, 397.47399601521374, 405.9375985438375, 118.83027538213982, 345.78649127406567, 485.17147530570094, 206.88992846267803, 385.6523919127443, 383.77452450032496, 408.767412425172, 190.94603071867996, 255.69231020190543, 28.274284694912456, 10.453060562104792, 386.2296489030699, 502.7499169053366, 449.95686703021744, 134.63722485489865, 446.7543158341542, 545.6000635340574, 481.9353607512761, 344.82899784910643, 267.11742292755827, 173.7370479012568, 381.6483455719918, 403.3333418992385, 179.43366674001456, 484.11942727625836, 218.48983581495722, 408.3963558807974, 315.79968773368734, 497.58217171110755, 304.5019449184101, 613.5470980856336, 408.0397397438331, 362.1779172607283, 338.3275147205788, 517.8446396978244, 261.11424735206424, 450.1978644273491, 326.07529194216727, 152.7687782296218, 523.2236803967709, 412.96204221373904, 247.77827213159114, 461.7155205458692, 612.3228291531193, 411.82757901039093, 74.84978926466317, 588.1005683056488, 427.5534735744531, 427.50754205792816, 167.94180892710176, 397.15929197473446, 467.41034473874043, 205.4682386796005, 542.5724025870782, 146.85851905636795, 483.2525623519593, 283.2225749773385, 70.51661340688031, 91.06300836563705, 194.48623639736937, 714.6800419875382, 506.96104442122333, 43.53044028104765, 332.9733953428516, 327.5235169884361, 187.54691449277448, 589.619830926503, 157.91578298425125, 326.66071386016006, 300.03273841857407, 453.84134560988633, 424.3156767424176, 97.51572691067173, 115.52305450824383, 229.5225596308352, 0.0, 257.03949598428824, 475.87030433515787, 461.23143349215485, 152.65965267125156, 376.59084015525104, 296.50004337115786, 393.5318176359854, 299.8510034301142, 315.85427830623206, 571.0327303686208, 621.3730697858026, 141.65574785588385, 125.79995035131918, 26.453049694446158, 423.74426857811665, 185.22185446731044, 542.8959066511526, 320.88584307210874, 437.90781771368427, 521.2128861314623, 236.67107299586016, 403.6199997937637, 227.3833008586988, 314.90935789755923, 307.34241839997503, 50.243404989376224, 176.73513047692595, 342.16194618592334, 59.68771434146363, 637.713161421373, 117.55119430580747, 155.43443675639384, 305.71217485553024, 327.2257595611329, 453.77336215666014, 105.26383073400547, 240.83490569735153, 434.3158597314123, 275.754901971967, 216.9334201918627, 287.8476566178857]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.543616557949294, "mean_inference_ms": 6.573797199792189, "mean_action_processing_ms": 3.1613428435731925, "mean_env_wait_ms": 17.514056167091027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052765846252441406, "StateBufferConnector_ms": 0.016072750091552734, "ViewRequirementAgentConnector_ms": 0.5326379537582397}, "num_episodes": 25, "episode_return_max": 506.8416172640275, "episode_return_min": -60.787318657377156, "episode_return_mean": 145.31259408857466, "episodes_this_iter": 25}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.93041612062049, "num_env_steps_trained_throughput_per_sec": 54.93041612062049, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 73510.713, "restore_workers_time_ms": 0.017, "training_step_time_ms": 73510.649, "sample_time_ms": 4731.154, "learn_time_ms": 68751.331, "learn_throughput": 58.181, "synch_weights_time_ms": 18.666}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "training_iteration": 22, "trial_id": "62684_00000", "date": "2024-08-20_16-34-18", "timestamp": 1724151858, "time_this_iter_s": 72.88803696632385, "time_total_s": 1590.9404950141907, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffaf3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1590.9404950141907, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 56.95048543689319, "ram_util_percent": 83.32524271844656}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.16543139037511, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.174180736271202, "policy_loss": -0.02043702867722588, "vf_loss": 7.191665763043343, "vf_explained_var": 0.44406652074333625, "kl": 0.01476007038430172, "entropy": 1.2423205037489005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 63450.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.778152318354006, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.909043184663884, "policy_loss": -0.015411037193345172, "vf_loss": 7.9220941255963035, "vf_explained_var": 0.19648646564079972, "kl": 0.01180048623656923, "entropy": 0.8377849957930348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "env_runners": {"episode_reward_max": 506.8416172640275, "episode_reward_min": -60.787318657377156, "episode_reward_mean": 148.08683038264803, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -771.8945519364446, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.59999999999997, "predator_policy": 771.8945519364446}, "policy_reward_mean": {"prey_policy": -173.07669217698432, "predator_policy": 333.65845345680077}, "custom_metrics": {}, "hist_stats": {"episode_reward": [143.19603498510835, 174.55725902325156, 394.06833918797196, 75.8057161428208, 263.1826780706436, 50.60237718321931, 156.3054676313953, 365.4388941082871, 130.89999999999887, 185.37025356174547, 161.16237926680108, 33.01672580878005, 166.92124234746228, 6.644057457597196, 93.48952737278789, 92.81579341347674, 78.53751642705255, 93.53527350447553, 189.0503911561792, 88.90000000000025, 506.8416172640275, 224.2489252440386, 16.6233654089528, 356.5574327663328, 85.80840442467695, 26.071193390010166, 97.10749610712287, 137.120740977772, 171.82326367097252, 212.14871521550148, 144.19004557910426, 61.46723860408286, 199.47513910881796, 326.9010437826144, 115.55176499587415, 22.5049976319897, 150.1246127650514, 71.29022565637696, 98.48361995807286, 394.2004107192811, 26.399903788713964, 206.52171680304392, 112.18138303957225, 80.57938509057776, 175.79529218951254, 221.84834060402036, 38.280237111747994, 80.77595289842249, 121.62992802617514, 168.63107168722223, 229.48208650107892, 151.21382706035047, -8.461001610251174, 330.9781555085473, 155.0857018171649, 53.19570886438804, 98.88463696973409, 99.5558327322842, 150.98076156177552, 93.5080751843884, -60.787318657377156, 114.07481350609795, 102.09704024226279, 119.92514648073109, 197.77879568234792, 51.60000000000046, 229.86626323641468, 88.68069589785839, 132.39227460134322, 242.31915170040403, 249.576897399721, 117.73193505690466, 132.10012527723745, 104.2204365032983, 110.71913027171823, 187.30799052049213, 250.94007408458268, 198.97606165930995, 266.3598064660201, 164.43517117794306, 161.22276751509685, 36.33986601777738, 270.2963811682808, 155.01865916063375, 184.94381692303926, 31.465157445804348, 235.8999999999993, 241.91622757524686, 231.14890963688686, 181.86409920042038, 128.50160409777456, 185.73932982709258, 92.39786746014966, 21.985888692828972, 172.02969617430318, 114.81688529715203, 100.97772086393658, 48.639462049657325, 37.04103060750408, 227.01600169570725], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [23.615192240991874, -57.33167302019602, -141.89007142862815, -383.6227752804951, -82.3783339399868, -325.17903960556686, 105.08732187481831, -634.7537841208415, 37.844549933872585, 5.826848494472879, -45.81680662416882, -377.2189053043347, -343.1385807253051, 157.2209581819147, -127.77335640299005, -108.86208317997158, -168.25358162122618, -436.498631530424, 64.09999999999997, -313.09187721024057, -375.19956942692147, 85.76348955964988, 148.21721582452992, -419.2393401019418, 20.000000000000014, -210.92252312318232, -129.89885909221442, -147.00962316367082, -126.42647806684906, -106.50916458011218, -88.81008080952815, -167.1184765227976, -182.72530295937824, -460.4214803792086, 13.997702792385386, -468.2500098237672, -449.80944663748227, -91.41239050438105, 18.662393417190774, -428.17160967303573, -384.2937922511305, -20.51418263546149, 15.458669186555897, -53.51639544539984, -393.22062029434363, -586.8884714565875, -66.64523695090315, -84.60846475879958, -21.861189077672066, -512.1436148706966, 20.000000000000014, -317.83051608253567, 18.11037719934423, -399.28652453782826, -120.62271514381109, -53.05226948340112, -83.91296513719361, 48.79999999999997, -7.374284694912342, 8.746939437895174, -23.71542665478904, -547.6001907102321, 189.1776688206403, -407.75513588067815, 4.74637135302078, 42.66359788658115, -500.43711498758313, 1.7045738608550813, -476.9984728325296, -349.988080884483, 181.85041250625497, -302.0692574558211, 18.900000000000013, -393.94606640413554, 20.000000000000014, -386.2129016299931, -130.00725651924375, -242.6903359319837, -1.079241698041284, -469.65367881461515, -95.71267739649315, -74.29047772960517, 9.781913698779954, -425.2568866871559, -116.74139875871222, -329.43642033970946, -195.38077667540082, -0.393458529159858, -108.85863234300703, -596.6482369163751, -358.97791726072774, 119.849384814421, -386.8990789791497, -191.13223843712132, 8.989086704733044, -612.5617640819324, -358.82041220668924, -326.0165604639055, 172.99999999999983, -58.48173694430761, 137.44223747259807, -230.90352691746725, -518.4496288899278, -170.19474829860513, -131.98958042610278, -234.11448790021822, 6.489630939656864, -459.36393808490857, -398.9886194595275, -614.9063297194355, 139.8691537805047, -576.4800827006399, 31.69673340351376, -46.876782616808626, -409.0609062355271, -289.02291231432383, -58.49357712445691, 161.95766896551515, 179.1695475580893, -512.0279067061598, -420.95713919988424, -40.64475758760891, -184.87678284213393, 40.69455298772636, 31.825380610309082, -555.4291384384364, -533.9527853441193, 20.000000000000014, -140.34096894560648, -3.128771535642547, -33.616613406880575, -44.254851739416885, -753.6425694726457, 0.2715832772506151, 20.000000000000014, 37.37574288341837, -387.81888698166784, 21.80000000000004, -307.9235169884348, -331.1733953428515, 16.8802371117479, 20.000000000000014, -111.79748929470453, -604.5933032261506, -175.8297991081668, 58.5233318061485, -245.6401015162189, 22.669567170436522, -429.03249513105743, -178.8800843806158, 128.5375934227036, -2.732630924716996, -418.15427964999606, 20.000000000000014, 20.000000000000014, -233.83178707872673, -20.343286212457457, -36.78687072701428, -208.37034065506836, -22.528025677504655, 20.000000000000014, -603.5955566412615, -257.05354008667206, -137.1112509226622, 20.000000000000014, -239.74023448946812, -215.47889437190304, -181.61702328138568, -245.76964133649784, 17.799999999999976, -288.85100343011413, -600.0623109269346, 112.80130153092769, -605.5889580261323, 20.000000000000014, -155.39174458360705, 18.916807938181226, 2.6756870486867284, -417.64426857811526, 58.27933844125719, -374.1785749605774, -236.4852329655371, -178.24127184972704, 13.159093919561663, 37.59370417313607, -695.4716453723925, -497.52526298996565, -14.816174586750048, -143.4454813083436, 20.000000000000014, 53.29999999999996, -584.3781541717306, -488.5842852785348, 1.8113046633498346, 62.29999999999997, -158.07968502594142, -31.843404989375962, 14.544554549015237, -335.8619461859233, 174.16626323641535, -10.287714341463559, -333.17228932560295, 20.000000000000014, -353.41137050371725, -238.51175732486607, 3.822703568453128, -94.0652832541678, -476.9438788349074, -99.99282256273565, 38.25673138025421, -307.4072597521577, 16.28542072052258, 194.59999999999997, -304.9759196690258, -61.85150326467048, -225.5114037127773, -412.6809515325081, 20.000000000000014, 20.000000000000014, -420.8832875294966, 90.12043650329838, -532.0225569774684, -573.8350425926391, -211.26771286830913, -60.59044585941967, -447.5867785963179, -67.36396571029795, 58.512872081948906, -248.04170018893655, -623.2459996159644, 105.54367674246836, 102.73508244371382, 15.467849392240717, -86.2412678998096, -627.0248002571218, 47.01774152420804, 185.46407892443852, 56.31000464511627, 9.201217463647716, -349.3044115806702, -281.84351390026467, 4.554337316208267, -252.07644387331106, -496.3323893573398, -297.3185250637195, -73.63383293040629, -441.4329089705188, -243.55160675758057, 101.63967978112419, -66.02160287975816, 17.918544892722682, -27.545074112034392, -269.6133028111062, 4.030965480798898, -209.40539507194927, 9.67287700534435, -511.48632389466746, -403.12595361960035, 171.87516532762208, -305.8403271784778, -25.00826601363744, -255.2722513074813, 178.83954530793915, -552.6348698482881, -207.48865368632462, -11.827242091980496, -95.4742095564757, 176.22966694430855, -304.68397980749245, -506.3542175843047, 2.8450334422508674, -771.8945519364446, -106.79545678488095, -87.1362435536084, 166.03932982709318, -339.50512852921696, -50.062485140881634, -478.0346774985498, -72.83941344829127, 5.6560691596053605, -384.34742542734875, -493.0698401111274, -216.3460508815271, -157.39366432326952, 133.84395092046177, -214.2383961984103, -8.322496011175149, -555.8765082527143, -48.327659435430405, -564.3762790816853, -55.3518564961093, -371.5373412847144, -299.31134823324254, -164.83630702538898, -281.81929816682396, -114.33907547446539, -210.7771846023683, 19.016116523516814, -467.69587891536173, 30.48932278564167], "policy_predator_policy_reward": [292.027865516928, 26.774721676013105, 491.6395212455682, 474.09788660373283, 332.451245553172, 553.4390059469522, 391.39777295268277, 101.61680662416876, 275.951690680057, 300.92196633696676, 436.9669473815158, 327.2497261333255, 372.81986102510496, 407.6770532434531, 436.69672706065825, 114.00080176539072, 231.6225231231817, 220.09885909221458, 353.3411640726124, 211.97435529976514, 380.75635708403047, 219.0598824744743, 479.58012956393685, 468.1103836554334, 450.7916107809718, 238.68907529116268, 442.14964600201137, 397.47399601521374, 405.9375985438375, 118.83027538213982, 345.78649127406567, 485.17147530570094, 206.88992846267803, 385.6523919127443, 383.77452450032496, 408.767412425172, 190.94603071867996, 255.69231020190543, 28.274284694912456, 10.453060562104792, 386.2296489030699, 502.7499169053366, 449.95686703021744, 134.63722485489865, 446.7543158341542, 545.6000635340574, 481.9353607512761, 344.82899784910643, 267.11742292755827, 173.7370479012568, 381.6483455719918, 403.3333418992385, 179.43366674001456, 484.11942727625836, 218.48983581495722, 408.3963558807974, 315.79968773368734, 497.58217171110755, 304.5019449184101, 613.5470980856336, 408.0397397438331, 362.1779172607283, 338.3275147205788, 517.8446396978244, 261.11424735206424, 450.1978644273491, 326.07529194216727, 152.7687782296218, 523.2236803967709, 412.96204221373904, 247.77827213159114, 461.7155205458692, 612.3228291531193, 411.82757901039093, 74.84978926466317, 588.1005683056488, 427.5534735744531, 427.50754205792816, 167.94180892710176, 397.15929197473446, 467.41034473874043, 205.4682386796005, 542.5724025870782, 146.85851905636795, 483.2525623519593, 283.2225749773385, 70.51661340688031, 91.06300836563705, 194.48623639736937, 714.6800419875382, 506.96104442122333, 43.53044028104765, 332.9733953428516, 327.5235169884361, 187.54691449277448, 589.619830926503, 157.91578298425125, 326.66071386016006, 300.03273841857407, 453.84134560988633, 424.3156767424176, 97.51572691067173, 115.52305450824383, 229.5225596308352, 0.0, 257.03949598428824, 475.87030433515787, 461.23143349215485, 152.65965267125156, 376.59084015525104, 296.50004337115786, 393.5318176359854, 299.8510034301142, 315.85427830623206, 571.0327303686208, 621.3730697858026, 141.65574785588385, 125.79995035131918, 26.453049694446158, 423.74426857811665, 185.22185446731044, 542.8959066511526, 320.88584307210874, 437.90781771368427, 521.2128861314623, 236.67107299586016, 403.6199997937637, 227.3833008586988, 314.90935789755923, 307.34241839997503, 50.243404989376224, 176.73513047692595, 342.16194618592334, 59.68771434146363, 637.713161421373, 117.55119430580747, 155.43443675639384, 305.71217485553024, 327.2257595611329, 453.77336215666014, 105.26383073400547, 240.83490569735153, 434.3158597314123, 275.754901971967, 216.9334201918627, 287.8476566178857, 425.18328752949645, 541.8225569774686, 381.04031791368726, 575.3720136783991, 196.05908414884163, 447.68677859631794, 340.9537722427274, 675.7303249042877, 12.309221650100387, 154.7051760730656, 46.33379756251386, 614.5689887119821, 314.3500803155761, 133.87828033427496, 377.54891354310706, 313.03947442935726, 405.3922240119038, 498.23238935734014, 350.87724803624195, 502.7639690790145, 219.2024630470294, 11.464328212675658, 409.1781904099113, 250.7533589153862, 357.09506610982066, 579.3094918449065, 349.9651618508559, 44.90826601363766, 311.04893357478915, 559.9348698482881, 388.08690514436057, 157.85210982730715, 302.8961789116508, 513.7764507362582, 232.4520274404048, 771.8945519364446, 100.73624355360855, 345.60512852921767, 503.5128532244725, 189.8215903233999, 432.1866604117172, 461.56042465998354, 238.1190898513748, 173.8063706072633, 559.2230462093992, 334.0312395500536, 385.950179627001, 383.0833362501619, 267.0972044603363, 617.227254132668, 335.77734460537135, 308.19924424579006, 237.49692555347528, 407.7095157484355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.549586287754211, "mean_inference_ms": 6.646829577604656, "mean_action_processing_ms": 3.0595357934775245, "mean_env_wait_ms": 17.669812814571866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05099499225616455, "StateBufferConnector_ms": 0.0053337812423706055, "ViewRequirementAgentConnector_ms": 0.3628321886062622}, "num_episodes": 27, "episode_return_max": 506.8416172640275, "episode_return_min": -60.787318657377156, "episode_return_mean": 148.08683038264803, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 57.25955613408605, "num_env_steps_trained_throughput_per_sec": 57.25955613408605, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 460000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 460000, "timers": {"training_iteration_time_ms": 73570.302, "restore_workers_time_ms": 0.016, "training_step_time_ms": 73570.241, "sample_time_ms": 4727.393, "learn_time_ms": 68814.013, "learn_throughput": 58.128, "synch_weights_time_ms": 18.781}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "done": false, "training_iteration": 23, "trial_id": "62684_00000", "date": "2024-08-20_16-35-28", "timestamp": 1724151928, "time_this_iter_s": 69.92551517486572, "time_total_s": 1660.8660101890564, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffa9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1660.8660101890564, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 53.07272727272726, "ram_util_percent": 83.36969696969697}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.491968700437681, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.186612864758106, "policy_loss": -0.02330731958504238, "vf_loss": 7.206627628651071, "vf_explained_var": 0.4034831054033117, "kl": 0.016462818676183093, "entropy": 1.2313892690847952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 66270.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.2501829470906936, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.3820068359375, "policy_loss": -0.01678125880863123, "vf_loss": 8.396437163327738, "vf_explained_var": 0.10972200638402707, "kl": 0.011754642556317979, "entropy": 0.7931303059613263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 506.8416172640275, "episode_reward_min": -60.787318657377156, "episode_reward_mean": 143.23681763940948, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -771.8945519364446, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.59999999999997, "predator_policy": 771.8945519364446}, "policy_reward_mean": {"prey_policy": -180.9327931457401, "predator_policy": 343.01759853831516}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.01672580878005, 166.92124234746228, 6.644057457597196, 93.48952737278789, 92.81579341347674, 78.53751642705255, 93.53527350447553, 189.0503911561792, 88.90000000000025, 506.8416172640275, 224.2489252440386, 16.6233654089528, 356.5574327663328, 85.80840442467695, 26.071193390010166, 97.10749610712287, 137.120740977772, 171.82326367097252, 212.14871521550148, 144.19004557910426, 61.46723860408286, 199.47513910881796, 326.9010437826144, 115.55176499587415, 22.5049976319897, 150.1246127650514, 71.29022565637696, 98.48361995807286, 394.2004107192811, 26.399903788713964, 206.52171680304392, 112.18138303957225, 80.57938509057776, 175.79529218951254, 221.84834060402036, 38.280237111747994, 80.77595289842249, 121.62992802617514, 168.63107168722223, 229.48208650107892, 151.21382706035047, -8.461001610251174, 330.9781555085473, 155.0857018171649, 53.19570886438804, 98.88463696973409, 99.5558327322842, 150.98076156177552, 93.5080751843884, -60.787318657377156, 114.07481350609795, 102.09704024226279, 119.92514648073109, 197.77879568234792, 51.60000000000046, 229.86626323641468, 88.68069589785839, 132.39227460134322, 242.31915170040403, 249.576897399721, 117.73193505690466, 132.10012527723745, 104.2204365032983, 110.71913027171823, 187.30799052049213, 250.94007408458268, 198.97606165930995, 266.3598064660201, 164.43517117794306, 161.22276751509685, 36.33986601777738, 270.2963811682808, 155.01865916063375, 184.94381692303926, 31.465157445804348, 235.8999999999993, 241.91622757524686, 231.14890963688686, 181.86409920042038, 128.50160409777456, 185.73932982709258, 92.39786746014966, 21.985888692828972, 172.02969617430318, 114.81688529715203, 100.97772086393658, 48.639462049657325, 37.04103060750408, 227.01600169570725, 240.13258485306653, 54.49439904690101, 158.90077051895636, 155.0089853189454, 207.42841496854805, 34.14880899349091, 118.81671105177111, 40.67944335037861, 164.65620603083298, 107.64806241081007, 333.67373829368785], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-460.4214803792086, 13.997702792385386, -468.2500098237672, -449.80944663748227, -91.41239050438105, 18.662393417190774, -428.17160967303573, -384.2937922511305, -20.51418263546149, 15.458669186555897, -53.51639544539984, -393.22062029434363, -586.8884714565875, -66.64523695090315, -84.60846475879958, -21.861189077672066, -512.1436148706966, 20.000000000000014, -317.83051608253567, 18.11037719934423, -399.28652453782826, -120.62271514381109, -53.05226948340112, -83.91296513719361, 48.79999999999997, -7.374284694912342, 8.746939437895174, -23.71542665478904, -547.6001907102321, 189.1776688206403, -407.75513588067815, 4.74637135302078, 42.66359788658115, -500.43711498758313, 1.7045738608550813, -476.9984728325296, -349.988080884483, 181.85041250625497, -302.0692574558211, 18.900000000000013, -393.94606640413554, 20.000000000000014, -386.2129016299931, -130.00725651924375, -242.6903359319837, -1.079241698041284, -469.65367881461515, -95.71267739649315, -74.29047772960517, 9.781913698779954, -425.2568866871559, -116.74139875871222, -329.43642033970946, -195.38077667540082, -0.393458529159858, -108.85863234300703, -596.6482369163751, -358.97791726072774, 119.849384814421, -386.8990789791497, -191.13223843712132, 8.989086704733044, -612.5617640819324, -358.82041220668924, -326.0165604639055, 172.99999999999983, -58.48173694430761, 137.44223747259807, -230.90352691746725, -518.4496288899278, -170.19474829860513, -131.98958042610278, -234.11448790021822, 6.489630939656864, -459.36393808490857, -398.9886194595275, -614.9063297194355, 139.8691537805047, -576.4800827006399, 31.69673340351376, -46.876782616808626, -409.0609062355271, -289.02291231432383, -58.49357712445691, 161.95766896551515, 179.1695475580893, -512.0279067061598, -420.95713919988424, -40.64475758760891, -184.87678284213393, 40.69455298772636, 31.825380610309082, -555.4291384384364, -533.9527853441193, 20.000000000000014, -140.34096894560648, -3.128771535642547, -33.616613406880575, -44.254851739416885, -753.6425694726457, 0.2715832772506151, 20.000000000000014, 37.37574288341837, -387.81888698166784, 21.80000000000004, -307.9235169884348, -331.1733953428515, 16.8802371117479, 20.000000000000014, -111.79748929470453, -604.5933032261506, -175.8297991081668, 58.5233318061485, -245.6401015162189, 22.669567170436522, -429.03249513105743, -178.8800843806158, 128.5375934227036, -2.732630924716996, -418.15427964999606, 20.000000000000014, 20.000000000000014, -233.83178707872673, -20.343286212457457, -36.78687072701428, -208.37034065506836, -22.528025677504655, 20.000000000000014, -603.5955566412615, -257.05354008667206, -137.1112509226622, 20.000000000000014, -239.74023448946812, -215.47889437190304, -181.61702328138568, -245.76964133649784, 17.799999999999976, -288.85100343011413, -600.0623109269346, 112.80130153092769, -605.5889580261323, 20.000000000000014, -155.39174458360705, 18.916807938181226, 2.6756870486867284, -417.64426857811526, 58.27933844125719, -374.1785749605774, -236.4852329655371, -178.24127184972704, 13.159093919561663, 37.59370417313607, -695.4716453723925, -497.52526298996565, -14.816174586750048, -143.4454813083436, 20.000000000000014, 53.29999999999996, -584.3781541717306, -488.5842852785348, 1.8113046633498346, 62.29999999999997, -158.07968502594142, -31.843404989375962, 14.544554549015237, -335.8619461859233, 174.16626323641535, -10.287714341463559, -333.17228932560295, 20.000000000000014, -353.41137050371725, -238.51175732486607, 3.822703568453128, -94.0652832541678, -476.9438788349074, -99.99282256273565, 38.25673138025421, -307.4072597521577, 16.28542072052258, 194.59999999999997, -304.9759196690258, -61.85150326467048, -225.5114037127773, -412.6809515325081, 20.000000000000014, 20.000000000000014, -420.8832875294966, 90.12043650329838, -532.0225569774684, -573.8350425926391, -211.26771286830913, -60.59044585941967, -447.5867785963179, -67.36396571029795, 58.512872081948906, -248.04170018893655, -623.2459996159644, 105.54367674246836, 102.73508244371382, 15.467849392240717, -86.2412678998096, -627.0248002571218, 47.01774152420804, 185.46407892443852, 56.31000464511627, 9.201217463647716, -349.3044115806702, -281.84351390026467, 4.554337316208267, -252.07644387331106, -496.3323893573398, -297.3185250637195, -73.63383293040629, -441.4329089705188, -243.55160675758057, 101.63967978112419, -66.02160287975816, 17.918544892722682, -27.545074112034392, -269.6133028111062, 4.030965480798898, -209.40539507194927, 9.67287700534435, -511.48632389466746, -403.12595361960035, 171.87516532762208, -305.8403271784778, -25.00826601363744, -255.2722513074813, 178.83954530793915, -552.6348698482881, -207.48865368632462, -11.827242091980496, -95.4742095564757, 176.22966694430855, -304.68397980749245, -506.3542175843047, 2.8450334422508674, -771.8945519364446, -106.79545678488095, -87.1362435536084, 166.03932982709318, -339.50512852921696, -50.062485140881634, -478.0346774985498, -72.83941344829127, 5.6560691596053605, -384.34742542734875, -493.0698401111274, -216.3460508815271, -157.39366432326952, 133.84395092046177, -214.2383961984103, -8.322496011175149, -555.8765082527143, -48.327659435430405, -564.3762790816853, -55.3518564961093, -371.5373412847144, -299.31134823324254, -164.83630702538898, -281.81929816682396, -114.33907547446539, -210.7771846023683, 19.016116523516814, -467.69587891536173, 30.48932278564167, 60.989899299263755, -493.5099222926729, 48.08196601125006, -545.4961086880431, 14.06177765727314, -225.73156366108122, -106.91121664278761, 10.257362655464872, -324.43323421722386, -16.694079925136858, -304.97110639557025, -129.77636091184715, -462.4074155152254, 156.72494400267448, -524.5617002029367, -417.53366772856515, 30.01243544342404, -553.0020703240277, -34.76755025943874, -500.3542407073093, -292.70192858660187, -527.7788456965277, -568.3409992915455, 19.016116523516814, -33.645919777168906, 91.37876213308078, -432.96564021111067, -452.3325973143251, 20.000000000000014, -71.02746113439524, -311.7568205580717, -393.97053299371873, 65.32408695192798], "policy_predator_policy_reward": [479.58012956393685, 468.1103836554334, 450.7916107809718, 238.68907529116268, 442.14964600201137, 397.47399601521374, 405.9375985438375, 118.83027538213982, 345.78649127406567, 485.17147530570094, 206.88992846267803, 385.6523919127443, 383.77452450032496, 408.767412425172, 190.94603071867996, 255.69231020190543, 28.274284694912456, 10.453060562104792, 386.2296489030699, 502.7499169053366, 449.95686703021744, 134.63722485489865, 446.7543158341542, 545.6000635340574, 481.9353607512761, 344.82899784910643, 267.11742292755827, 173.7370479012568, 381.6483455719918, 403.3333418992385, 179.43366674001456, 484.11942727625836, 218.48983581495722, 408.3963558807974, 315.79968773368734, 497.58217171110755, 304.5019449184101, 613.5470980856336, 408.0397397438331, 362.1779172607283, 338.3275147205788, 517.8446396978244, 261.11424735206424, 450.1978644273491, 326.07529194216727, 152.7687782296218, 523.2236803967709, 412.96204221373904, 247.77827213159114, 461.7155205458692, 612.3228291531193, 411.82757901039093, 74.84978926466317, 588.1005683056488, 427.5534735744531, 427.50754205792816, 167.94180892710176, 397.15929197473446, 467.41034473874043, 205.4682386796005, 542.5724025870782, 146.85851905636795, 483.2525623519593, 283.2225749773385, 70.51661340688031, 91.06300836563705, 194.48623639736937, 714.6800419875382, 506.96104442122333, 43.53044028104765, 332.9733953428516, 327.5235169884361, 187.54691449277448, 589.619830926503, 157.91578298425125, 326.66071386016006, 300.03273841857407, 453.84134560988633, 424.3156767424176, 97.51572691067173, 115.52305450824383, 229.5225596308352, 0.0, 257.03949598428824, 475.87030433515787, 461.23143349215485, 152.65965267125156, 376.59084015525104, 296.50004337115786, 393.5318176359854, 299.8510034301142, 315.85427830623206, 571.0327303686208, 621.3730697858026, 141.65574785588385, 125.79995035131918, 26.453049694446158, 423.74426857811665, 185.22185446731044, 542.8959066511526, 320.88584307210874, 437.90781771368427, 521.2128861314623, 236.67107299586016, 403.6199997937637, 227.3833008586988, 314.90935789755923, 307.34241839997503, 50.243404989376224, 176.73513047692595, 342.16194618592334, 59.68771434146363, 637.713161421373, 117.55119430580747, 155.43443675639384, 305.71217485553024, 327.2257595611329, 453.77336215666014, 105.26383073400547, 240.83490569735153, 434.3158597314123, 275.754901971967, 216.9334201918627, 287.8476566178857, 425.18328752949645, 541.8225569774686, 381.04031791368726, 575.3720136783991, 196.05908414884163, 447.68677859631794, 340.9537722427274, 675.7303249042877, 12.309221650100387, 154.7051760730656, 46.33379756251386, 614.5689887119821, 314.3500803155761, 133.87828033427496, 377.54891354310706, 313.03947442935726, 405.3922240119038, 498.23238935734014, 350.87724803624195, 502.7639690790145, 219.2024630470294, 11.464328212675658, 409.1781904099113, 250.7533589153862, 357.09506610982066, 579.3094918449065, 349.9651618508559, 44.90826601363766, 311.04893357478915, 559.9348698482881, 388.08690514436057, 157.85210982730715, 302.8961789116508, 513.7764507362582, 232.4520274404048, 771.8945519364446, 100.73624355360855, 345.60512852921767, 503.5128532244725, 189.8215903233999, 432.1866604117172, 461.56042465998354, 238.1190898513748, 173.8063706072633, 559.2230462093992, 334.0312395500536, 385.950179627001, 383.0833362501619, 267.0972044603363, 617.227254132668, 335.77734460537135, 308.19924424579006, 237.49692555347528, 407.7095157484355, 440.4285707351337, 184.14207110009397, 261.16291658383915, 550.4973771549127, 430.5785342747387, 149.40932444876472, 213.5870840616672, 392.8634484898333, 568.0457626421654, 469.6268240418704, 559.3441038045701, 415.3280077980904, 502.85424070730977, 443.78618989781256, 528.4788456965279, 589.3043261184071, 440.2656402111123, 99.6233636749222, 496.08117713123477, 114.92694372829547, 501.2374412817113, 472.83956361183857]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.550455038971224, "mean_inference_ms": 6.6357548202996846, "mean_action_processing_ms": 3.0188883464060563, "mean_env_wait_ms": 17.69165630511883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03848743438720703, "StateBufferConnector_ms": 0.005215048789978027, "ViewRequirementAgentConnector_ms": 0.30231595039367676}, "num_episodes": 11, "episode_return_max": 506.8416172640275, "episode_return_min": -60.787318657377156, "episode_return_mean": 143.23681763940948, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 59.14897388463463, "num_env_steps_trained_throughput_per_sec": 59.14897388463463, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 72885.781, "restore_workers_time_ms": 0.016, "training_step_time_ms": 72885.722, "sample_time_ms": 4642.948, "learn_time_ms": 68214.496, "learn_throughput": 58.639, "synch_weights_time_ms": 18.514}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 24, "trial_id": "62684_00000", "date": "2024-08-20_16-36-36", "timestamp": 1724151996, "time_this_iter_s": 67.6806652545929, "time_total_s": 1728.5466754436493, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffaf9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1728.5466754436493, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 51.78541666666666, "ram_util_percent": 83.06666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.430663605108329, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.89654274206635, "policy_loss": -0.02173636425170942, "vf_loss": 6.915122758919465, "vf_explained_var": 0.4503643408100656, "kl": 0.015781788549762456, "entropy": 1.2544603919729274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 69090.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.53148877381017, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.253510759999513, "policy_loss": -0.018094556293790302, "vf_loss": 8.269181813890972, "vf_explained_var": 0.19526459312943553, "kl": 0.01211751389376346, "entropy": 0.7812426629835967, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "env_runners": {"episode_reward_max": 739.9723112417151, "episode_reward_min": -60.787318657377156, "episode_reward_mean": 152.4343516064967, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -771.8945519364446, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.59999999999997, "predator_policy": 771.8945519364446}, "policy_reward_mean": {"prey_policy": -183.2208027871734, "predator_policy": 351.04837998400876}, "custom_metrics": {}, "hist_stats": {"episode_reward": [171.82326367097252, 212.14871521550148, 144.19004557910426, 61.46723860408286, 199.47513910881796, 326.9010437826144, 115.55176499587415, 22.5049976319897, 150.1246127650514, 71.29022565637696, 98.48361995807286, 394.2004107192811, 26.399903788713964, 206.52171680304392, 112.18138303957225, 80.57938509057776, 175.79529218951254, 221.84834060402036, 38.280237111747994, 80.77595289842249, 121.62992802617514, 168.63107168722223, 229.48208650107892, 151.21382706035047, -8.461001610251174, 330.9781555085473, 155.0857018171649, 53.19570886438804, 98.88463696973409, 99.5558327322842, 150.98076156177552, 93.5080751843884, -60.787318657377156, 114.07481350609795, 102.09704024226279, 119.92514648073109, 197.77879568234792, 51.60000000000046, 229.86626323641468, 88.68069589785839, 132.39227460134322, 242.31915170040403, 249.576897399721, 117.73193505690466, 132.10012527723745, 104.2204365032983, 110.71913027171823, 187.30799052049213, 250.94007408458268, 198.97606165930995, 266.3598064660201, 164.43517117794306, 161.22276751509685, 36.33986601777738, 270.2963811682808, 155.01865916063375, 184.94381692303926, 31.465157445804348, 235.8999999999993, 241.91622757524686, 231.14890963688686, 181.86409920042038, 128.50160409777456, 185.73932982709258, 92.39786746014966, 21.985888692828972, 172.02969617430318, 114.81688529715203, 100.97772086393658, 48.639462049657325, 37.04103060750408, 227.01600169570725, 240.13258485306653, 54.49439904690101, 158.90077051895636, 155.0089853189454, 207.42841496854805, 34.14880899349091, 118.81671105177111, 40.67944335037861, 164.65620603083298, 107.64806241081007, 333.67373829368785, 147.10799884969805, 129.08489058462914, 254.85294502500804, 226.8640497893864, 271.29652366873796, 25.132473114090924, 739.9723112417151, 136.57774689048267, 54.200000000000344, 121.77053707207116, 255.84600409928353, 24.33989245002825, 169.41556030393357, 69.1899407491392, 34.63730536067347, 320.6315258685248, 232.12339471206766], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-116.74139875871222, -329.43642033970946, -195.38077667540082, -0.393458529159858, -108.85863234300703, -596.6482369163751, -358.97791726072774, 119.849384814421, -386.8990789791497, -191.13223843712132, 8.989086704733044, -612.5617640819324, -358.82041220668924, -326.0165604639055, 172.99999999999983, -58.48173694430761, 137.44223747259807, -230.90352691746725, -518.4496288899278, -170.19474829860513, -131.98958042610278, -234.11448790021822, 6.489630939656864, -459.36393808490857, -398.9886194595275, -614.9063297194355, 139.8691537805047, -576.4800827006399, 31.69673340351376, -46.876782616808626, -409.0609062355271, -289.02291231432383, -58.49357712445691, 161.95766896551515, 179.1695475580893, -512.0279067061598, -420.95713919988424, -40.64475758760891, -184.87678284213393, 40.69455298772636, 31.825380610309082, -555.4291384384364, -533.9527853441193, 20.000000000000014, -140.34096894560648, -3.128771535642547, -33.616613406880575, -44.254851739416885, -753.6425694726457, 0.2715832772506151, 20.000000000000014, 37.37574288341837, -387.81888698166784, 21.80000000000004, -307.9235169884348, -331.1733953428515, 16.8802371117479, 20.000000000000014, -111.79748929470453, -604.5933032261506, -175.8297991081668, 58.5233318061485, -245.6401015162189, 22.669567170436522, -429.03249513105743, -178.8800843806158, 128.5375934227036, -2.732630924716996, -418.15427964999606, 20.000000000000014, 20.000000000000014, -233.83178707872673, -20.343286212457457, -36.78687072701428, -208.37034065506836, -22.528025677504655, 20.000000000000014, -603.5955566412615, -257.05354008667206, -137.1112509226622, 20.000000000000014, -239.74023448946812, -215.47889437190304, -181.61702328138568, -245.76964133649784, 17.799999999999976, -288.85100343011413, -600.0623109269346, 112.80130153092769, -605.5889580261323, 20.000000000000014, -155.39174458360705, 18.916807938181226, 2.6756870486867284, -417.64426857811526, 58.27933844125719, -374.1785749605774, -236.4852329655371, -178.24127184972704, 13.159093919561663, 37.59370417313607, -695.4716453723925, -497.52526298996565, -14.816174586750048, -143.4454813083436, 20.000000000000014, 53.29999999999996, -584.3781541717306, -488.5842852785348, 1.8113046633498346, 62.29999999999997, -158.07968502594142, -31.843404989375962, 14.544554549015237, -335.8619461859233, 174.16626323641535, -10.287714341463559, -333.17228932560295, 20.000000000000014, -353.41137050371725, -238.51175732486607, 3.822703568453128, -94.0652832541678, -476.9438788349074, -99.99282256273565, 38.25673138025421, -307.4072597521577, 16.28542072052258, 194.59999999999997, -304.9759196690258, -61.85150326467048, -225.5114037127773, -412.6809515325081, 20.000000000000014, 20.000000000000014, -420.8832875294966, 90.12043650329838, -532.0225569774684, -573.8350425926391, -211.26771286830913, -60.59044585941967, -447.5867785963179, -67.36396571029795, 58.512872081948906, -248.04170018893655, -623.2459996159644, 105.54367674246836, 102.73508244371382, 15.467849392240717, -86.2412678998096, -627.0248002571218, 47.01774152420804, 185.46407892443852, 56.31000464511627, 9.201217463647716, -349.3044115806702, -281.84351390026467, 4.554337316208267, -252.07644387331106, -496.3323893573398, -297.3185250637195, -73.63383293040629, -441.4329089705188, -243.55160675758057, 101.63967978112419, -66.02160287975816, 17.918544892722682, -27.545074112034392, -269.6133028111062, 4.030965480798898, -209.40539507194927, 9.67287700534435, -511.48632389466746, -403.12595361960035, 171.87516532762208, -305.8403271784778, -25.00826601363744, -255.2722513074813, 178.83954530793915, -552.6348698482881, -207.48865368632462, -11.827242091980496, -95.4742095564757, 176.22966694430855, -304.68397980749245, -506.3542175843047, 2.8450334422508674, -771.8945519364446, -106.79545678488095, -87.1362435536084, 166.03932982709318, -339.50512852921696, -50.062485140881634, -478.0346774985498, -72.83941344829127, 5.6560691596053605, -384.34742542734875, -493.0698401111274, -216.3460508815271, -157.39366432326952, 133.84395092046177, -214.2383961984103, -8.322496011175149, -555.8765082527143, -48.327659435430405, -564.3762790816853, -55.3518564961093, -371.5373412847144, -299.31134823324254, -164.83630702538898, -281.81929816682396, -114.33907547446539, -210.7771846023683, 19.016116523516814, -467.69587891536173, 30.48932278564167, 60.989899299263755, -493.5099222926729, 48.08196601125006, -545.4961086880431, 14.06177765727314, -225.73156366108122, -106.91121664278761, 10.257362655464872, -324.43323421722386, -16.694079925136858, -304.97110639557025, -129.77636091184715, -462.4074155152254, 156.72494400267448, -524.5617002029367, -417.53366772856515, 30.01243544342404, -553.0020703240277, -34.76755025943874, -500.3542407073093, -292.70192858660187, -527.7788456965277, -568.3409992915455, 19.016116523516814, -33.645919777168906, 91.37876213308078, -432.96564021111067, -452.3325973143251, 20.000000000000014, -71.02746113439524, -311.7568205580717, -393.97053299371873, 65.32408695192798, -17.20770091502298, -481.1665664922431, -394.83111966713267, 3.534364613971236, -82.01332490374915, -137.99016131303787, 91.10872731077964, -587.6867708087938, 15.260651831528921, -79.95263282295427, -198.1572973024943, 3.7087125890787718, -359.0608485996218, 21.43479045897812, 172.47685447463954, -644.900844482486, -25.341878200599673, -449.7773420569483, -728.2305214518462, 192.66098118238477, 137.0, -273.17046773205243, -578.458280203869, 131.280283359223, 20.000000000000014, 20.000000000000014, -449.41627936836954, -388.42421333086594, 13.22074660633909, -573.0005871839493, -90.17719890141572, 155.14464219285955, 18.087126104085065, -364.033683381791, -547.1784648535877, 16.63188099418816, -497.5811755110401, -149.15134075225984, -68.92642141494912, 47.301121979703076, -576.4508805004589, -494.69934499731, -35.495488071856236, -303.4579764353129, -402.50340255159404, -320.8725513299599, 184.09368089702977, -418.28728826887686, -48.64263258556316, -323.05137423246185, -58.70015829674416], "policy_predator_policy_reward": [315.79968773368734, 497.58217171110755, 304.5019449184101, 613.5470980856336, 408.0397397438331, 362.1779172607283, 338.3275147205788, 517.8446396978244, 261.11424735206424, 450.1978644273491, 326.07529194216727, 152.7687782296218, 523.2236803967709, 412.96204221373904, 247.77827213159114, 461.7155205458692, 612.3228291531193, 411.82757901039093, 74.84978926466317, 588.1005683056488, 427.5534735744531, 427.50754205792816, 167.94180892710176, 397.15929197473446, 467.41034473874043, 205.4682386796005, 542.5724025870782, 146.85851905636795, 483.2525623519593, 283.2225749773385, 70.51661340688031, 91.06300836563705, 194.48623639736937, 714.6800419875382, 506.96104442122333, 43.53044028104765, 332.9733953428516, 327.5235169884361, 187.54691449277448, 589.619830926503, 157.91578298425125, 326.66071386016006, 300.03273841857407, 453.84134560988633, 424.3156767424176, 97.51572691067173, 115.52305450824383, 229.5225596308352, 0.0, 257.03949598428824, 475.87030433515787, 461.23143349215485, 152.65965267125156, 376.59084015525104, 296.50004337115786, 393.5318176359854, 299.8510034301142, 315.85427830623206, 571.0327303686208, 621.3730697858026, 141.65574785588385, 125.79995035131918, 26.453049694446158, 423.74426857811665, 185.22185446731044, 542.8959066511526, 320.88584307210874, 437.90781771368427, 521.2128861314623, 236.67107299586016, 403.6199997937637, 227.3833008586988, 314.90935789755923, 307.34241839997503, 50.243404989376224, 176.73513047692595, 342.16194618592334, 59.68771434146363, 637.713161421373, 117.55119430580747, 155.43443675639384, 305.71217485553024, 327.2257595611329, 453.77336215666014, 105.26383073400547, 240.83490569735153, 434.3158597314123, 275.754901971967, 216.9334201918627, 287.8476566178857, 425.18328752949645, 541.8225569774686, 381.04031791368726, 575.3720136783991, 196.05908414884163, 447.68677859631794, 340.9537722427274, 675.7303249042877, 12.309221650100387, 154.7051760730656, 46.33379756251386, 614.5689887119821, 314.3500803155761, 133.87828033427496, 377.54891354310706, 313.03947442935726, 405.3922240119038, 498.23238935734014, 350.87724803624195, 502.7639690790145, 219.2024630470294, 11.464328212675658, 409.1781904099113, 250.7533589153862, 357.09506610982066, 579.3094918449065, 349.9651618508559, 44.90826601363766, 311.04893357478915, 559.9348698482881, 388.08690514436057, 157.85210982730715, 302.8961789116508, 513.7764507362582, 232.4520274404048, 771.8945519364446, 100.73624355360855, 345.60512852921767, 503.5128532244725, 189.8215903233999, 432.1866604117172, 461.56042465998354, 238.1190898513748, 173.8063706072633, 559.2230462093992, 334.0312395500536, 385.950179627001, 383.0833362501619, 267.0972044603363, 617.227254132668, 335.77734460537135, 308.19924424579006, 237.49692555347528, 407.7095157484355, 440.4285707351337, 184.14207110009397, 261.16291658383915, 550.4973771549127, 430.5785342747387, 149.40932444876472, 213.5870840616672, 392.8634484898333, 568.0457626421654, 469.6268240418704, 559.3441038045701, 415.3280077980904, 502.85424070730977, 443.78618989781256, 528.4788456965279, 589.3043261184071, 440.2656402111123, 99.6233636749222, 496.08117713123477, 114.92694372829547, 501.2374412817113, 472.83956361183857, 481.1665664922431, 559.146819431854, 14.76563538602873, 330.7883768014164, 498.402222328574, 237.76811436291925, 281.06786006639, 220.1974072593659, 363.44068804740783, 73.00503928733416, 646.3065892744037, 498.8459485797214, 620.468440924612, 518.0734105865645, 578.5223534814618, 278.4038579857211, 0.0, 463.6162793683702, 557.3612066660512, 512.6133843144991, 56.58542252651315, 116.20601217724239, 430.93815065565144, 487.9820090355679, 400.4177360815616, 484.65676190062186, 483.12483132380385, 609.9142129434017, 410.3553707693035, 365.7388016501331, 526.9656863527923, 348.7319982175391, 326.52226690013185, 335.995292926706]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.485614919025783, "mean_inference_ms": 6.625405848320577, "mean_action_processing_ms": 3.0014771466667494, "mean_env_wait_ms": 17.69488432667511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03867614269256592, "StateBufferConnector_ms": 0.0063135623931884766, "ViewRequirementAgentConnector_ms": 0.2489795684814453}, "num_episodes": 17, "episode_return_max": 739.9723112417151, "episode_return_min": -60.787318657377156, "episode_return_mean": 152.4343516064967, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 58.0907757564681, "num_env_steps_trained_throughput_per_sec": 58.0907757564681, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 500000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 500000, "timers": {"training_iteration_time_ms": 72683.632, "restore_workers_time_ms": 0.016, "training_step_time_ms": 72683.574, "sample_time_ms": 4527.306, "learn_time_ms": 68128.604, "learn_throughput": 58.712, "synch_weights_time_ms": 18.188}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "done": false, "training_iteration": 25, "trial_id": "62684_00000", "date": "2024-08-20_16-37-45", "timestamp": 1724152065, "time_this_iter_s": 68.89929866790771, "time_total_s": 1797.445974111557, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffaf430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1797.445974111557, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 52.077319587628864, "ram_util_percent": 83.2041237113402}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.71817395382739, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.013186482842087, "policy_loss": -0.02356740460014433, "vf_loss": 7.033484915300464, "vf_explained_var": 0.39600669384425413, "kl": 0.016344894521295072, "entropy": 1.2235197062610734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 71910.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.000267517062091, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.091812083582399, "policy_loss": -0.019191122676920955, "vf_loss": 8.108118072893253, "vf_explained_var": 0.22379531611210454, "kl": 0.014425733854264888, "entropy": 0.7870657930613826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "env_runners": {"episode_reward_max": 739.9723112417151, "episode_reward_min": -60.787318657377156, "episode_reward_mean": 155.657503977363, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -771.8945519364446, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.59999999999997, "predator_policy": 771.8945519364446}, "policy_reward_mean": {"prey_policy": -194.9924267200775, "predator_policy": 370.317392068798}, "custom_metrics": {}, "hist_stats": {"episode_reward": [155.0857018171649, 53.19570886438804, 98.88463696973409, 99.5558327322842, 150.98076156177552, 93.5080751843884, -60.787318657377156, 114.07481350609795, 102.09704024226279, 119.92514648073109, 197.77879568234792, 51.60000000000046, 229.86626323641468, 88.68069589785839, 132.39227460134322, 242.31915170040403, 249.576897399721, 117.73193505690466, 132.10012527723745, 104.2204365032983, 110.71913027171823, 187.30799052049213, 250.94007408458268, 198.97606165930995, 266.3598064660201, 164.43517117794306, 161.22276751509685, 36.33986601777738, 270.2963811682808, 155.01865916063375, 184.94381692303926, 31.465157445804348, 235.8999999999993, 241.91622757524686, 231.14890963688686, 181.86409920042038, 128.50160409777456, 185.73932982709258, 92.39786746014966, 21.985888692828972, 172.02969617430318, 114.81688529715203, 100.97772086393658, 48.639462049657325, 37.04103060750408, 227.01600169570725, 240.13258485306653, 54.49439904690101, 158.90077051895636, 155.0089853189454, 207.42841496854805, 34.14880899349091, 118.81671105177111, 40.67944335037861, 164.65620603083298, 107.64806241081007, 333.67373829368785, 147.10799884969805, 129.08489058462914, 254.85294502500804, 226.8640497893864, 271.29652366873796, 25.132473114090924, 739.9723112417151, 136.57774689048267, 54.200000000000344, 121.77053707207116, 255.84600409928353, 24.33989245002825, 169.41556030393357, 69.1899407491392, 34.63730536067347, 320.6315258685248, 232.12339471206766, 28.753125605903058, 78.24312776414294, 231.4568170235965, 173.6096774215957, 158.08142882001698, 41.97744019730606, 29.734629968386837, 18.259770025837085, 328.7922034835411, 151.36340221650926, 147.1117826804293, 26.52363355187665, 56.50060689174151, 254.7980936221621, 156.83569963647196, 252.12471656257017, 347.885183557854, 110.83432886018224, 164.27027651669997, 218.23478981266095, 286.3394757491227, 94.56221582809438, 29.69678328298859, 104.18443046860996, 442.56572370456314, 293.5932302202422], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-257.05354008667206, -137.1112509226622, 20.000000000000014, -239.74023448946812, -215.47889437190304, -181.61702328138568, -245.76964133649784, 17.799999999999976, -288.85100343011413, -600.0623109269346, 112.80130153092769, -605.5889580261323, 20.000000000000014, -155.39174458360705, 18.916807938181226, 2.6756870486867284, -417.64426857811526, 58.27933844125719, -374.1785749605774, -236.4852329655371, -178.24127184972704, 13.159093919561663, 37.59370417313607, -695.4716453723925, -497.52526298996565, -14.816174586750048, -143.4454813083436, 20.000000000000014, 53.29999999999996, -584.3781541717306, -488.5842852785348, 1.8113046633498346, 62.29999999999997, -158.07968502594142, -31.843404989375962, 14.544554549015237, -335.8619461859233, 174.16626323641535, -10.287714341463559, -333.17228932560295, 20.000000000000014, -353.41137050371725, -238.51175732486607, 3.822703568453128, -94.0652832541678, -476.9438788349074, -99.99282256273565, 38.25673138025421, -307.4072597521577, 16.28542072052258, 194.59999999999997, -304.9759196690258, -61.85150326467048, -225.5114037127773, -412.6809515325081, 20.000000000000014, 20.000000000000014, -420.8832875294966, 90.12043650329838, -532.0225569774684, -573.8350425926391, -211.26771286830913, -60.59044585941967, -447.5867785963179, -67.36396571029795, 58.512872081948906, -248.04170018893655, -623.2459996159644, 105.54367674246836, 102.73508244371382, 15.467849392240717, -86.2412678998096, -627.0248002571218, 47.01774152420804, 185.46407892443852, 56.31000464511627, 9.201217463647716, -349.3044115806702, -281.84351390026467, 4.554337316208267, -252.07644387331106, -496.3323893573398, -297.3185250637195, -73.63383293040629, -441.4329089705188, -243.55160675758057, 101.63967978112419, -66.02160287975816, 17.918544892722682, -27.545074112034392, -269.6133028111062, 4.030965480798898, -209.40539507194927, 9.67287700534435, -511.48632389466746, -403.12595361960035, 171.87516532762208, -305.8403271784778, -25.00826601363744, -255.2722513074813, 178.83954530793915, -552.6348698482881, -207.48865368632462, -11.827242091980496, -95.4742095564757, 176.22966694430855, -304.68397980749245, -506.3542175843047, 2.8450334422508674, -771.8945519364446, -106.79545678488095, -87.1362435536084, 166.03932982709318, -339.50512852921696, -50.062485140881634, -478.0346774985498, -72.83941344829127, 5.6560691596053605, -384.34742542734875, -493.0698401111274, -216.3460508815271, -157.39366432326952, 133.84395092046177, -214.2383961984103, -8.322496011175149, -555.8765082527143, -48.327659435430405, -564.3762790816853, -55.3518564961093, -371.5373412847144, -299.31134823324254, -164.83630702538898, -281.81929816682396, -114.33907547446539, -210.7771846023683, 19.016116523516814, -467.69587891536173, 30.48932278564167, 60.989899299263755, -493.5099222926729, 48.08196601125006, -545.4961086880431, 14.06177765727314, -225.73156366108122, -106.91121664278761, 10.257362655464872, -324.43323421722386, -16.694079925136858, -304.97110639557025, -129.77636091184715, -462.4074155152254, 156.72494400267448, -524.5617002029367, -417.53366772856515, 30.01243544342404, -553.0020703240277, -34.76755025943874, -500.3542407073093, -292.70192858660187, -527.7788456965277, -568.3409992915455, 19.016116523516814, -33.645919777168906, 91.37876213308078, -432.96564021111067, -452.3325973143251, 20.000000000000014, -71.02746113439524, -311.7568205580717, -393.97053299371873, 65.32408695192798, -17.20770091502298, -481.1665664922431, -394.83111966713267, 3.534364613971236, -82.01332490374915, -137.99016131303787, 91.10872731077964, -587.6867708087938, 15.260651831528921, -79.95263282295427, -198.1572973024943, 3.7087125890787718, -359.0608485996218, 21.43479045897812, 172.47685447463954, -644.900844482486, -25.341878200599673, -449.7773420569483, -728.2305214518462, 192.66098118238477, 137.0, -273.17046773205243, -578.458280203869, 131.280283359223, 20.000000000000014, 20.000000000000014, -449.41627936836954, -388.42421333086594, 13.22074660633909, -573.0005871839493, -90.17719890141572, 155.14464219285955, 18.087126104085065, -364.033683381791, -547.1784648535877, 16.63188099418816, -497.5811755110401, -149.15134075225984, -68.92642141494912, 47.301121979703076, -576.4508805004589, -494.69934499731, -35.495488071856236, -303.4579764353129, -402.50340255159404, -320.8725513299599, 184.09368089702977, -418.28728826887686, -48.64263258556316, -323.05137423246185, -58.70015829674416, -624.8278087423129, -341.109023188469, -24.63191912017654, -261.7321569843199, -534.7242680167712, -163.55505621678992, -607.9872582596727, -312.06252786449926, 153.39194661737235, -343.5837938291431, -5.447971782730189, -316.6531133505484, 153.25430257698372, -348.6943751315798, -585.9417517232457, -341.42439774849026, -494.37107160887336, 20.000000000000014, -560.5988295146877, -90.61172745541252, -32.17442510688678, 16.32688738663484, -571.4442245475626, -752.7117729335426, -337.63248300820715, -609.5507872125493, 170.05534898457688, 22.72327937243211, -18.854376633651828, -468.96299706642463, -119.35261728704245, -407.9937441962748, 0.46754458391763265, -375.4262563376105, 20.000000000000014, -581.5343224309114, 20.000000000000014, -548.2899584728295, -68.40652143586095, 117.65400870901422, -82.25586609987377, -136.43279950067762, -482.92407725229685, -581.2754578242344, 29.898380867809827, -97.38382653784475, -13.09868357947769, -328.32464190104423, -637.4401925626273, 20.000000000000014, 20.000000000000014, 51.39391631297382, 17.402056730986637, -431.9400978997804, 142.53918087711253, -567.4020845668691, -81.454057421468, -210.19689503107662, -60.10671430918006, -628.0607841693018, 164.65266721076247, -509.84414709986794, 9.982222757155924, 20.000000000000014, 16.753830205352482, -757.589085488761, -561.8130256061725, -329.45827237303513, 20.000000000000014, -652.5550693062708, -97.63243231978053, -150.71886356696075, -461.70364160746806, 186.41203501612137, 178.28932142959985, -343.70034164615447, -97.25805727446658, 164.12008817121753], "policy_predator_policy_reward": [152.65965267125156, 376.59084015525104, 296.50004337115786, 393.5318176359854, 299.8510034301142, 315.85427830623206, 571.0327303686208, 621.3730697858026, 141.65574785588385, 125.79995035131918, 26.453049694446158, 423.74426857811665, 185.22185446731044, 542.8959066511526, 320.88584307210874, 437.90781771368427, 521.2128861314623, 236.67107299586016, 403.6199997937637, 227.3833008586988, 314.90935789755923, 307.34241839997503, 50.243404989376224, 176.73513047692595, 342.16194618592334, 59.68771434146363, 637.713161421373, 117.55119430580747, 155.43443675639384, 305.71217485553024, 327.2257595611329, 453.77336215666014, 105.26383073400547, 240.83490569735153, 434.3158597314123, 275.754901971967, 216.9334201918627, 287.8476566178857, 425.18328752949645, 541.8225569774686, 381.04031791368726, 575.3720136783991, 196.05908414884163, 447.68677859631794, 340.9537722427274, 675.7303249042877, 12.309221650100387, 154.7051760730656, 46.33379756251386, 614.5689887119821, 314.3500803155761, 133.87828033427496, 377.54891354310706, 313.03947442935726, 405.3922240119038, 498.23238935734014, 350.87724803624195, 502.7639690790145, 219.2024630470294, 11.464328212675658, 409.1781904099113, 250.7533589153862, 357.09506610982066, 579.3094918449065, 349.9651618508559, 44.90826601363766, 311.04893357478915, 559.9348698482881, 388.08690514436057, 157.85210982730715, 302.8961789116508, 513.7764507362582, 232.4520274404048, 771.8945519364446, 100.73624355360855, 345.60512852921767, 503.5128532244725, 189.8215903233999, 432.1866604117172, 461.56042465998354, 238.1190898513748, 173.8063706072633, 559.2230462093992, 334.0312395500536, 385.950179627001, 383.0833362501619, 267.0972044603363, 617.227254132668, 335.77734460537135, 308.19924424579006, 237.49692555347528, 407.7095157484355, 440.4285707351337, 184.14207110009397, 261.16291658383915, 550.4973771549127, 430.5785342747387, 149.40932444876472, 213.5870840616672, 392.8634484898333, 568.0457626421654, 469.6268240418704, 559.3441038045701, 415.3280077980904, 502.85424070730977, 443.78618989781256, 528.4788456965279, 589.3043261184071, 440.2656402111123, 99.6233636749222, 496.08117713123477, 114.92694372829547, 501.2374412817113, 472.83956361183857, 481.1665664922431, 559.146819431854, 14.76563538602873, 330.7883768014164, 498.402222328574, 237.76811436291925, 281.06786006639, 220.1974072593659, 363.44068804740783, 73.00503928733416, 646.3065892744037, 498.8459485797214, 620.468440924612, 518.0734105865645, 578.5223534814618, 278.4038579857211, 0.0, 463.6162793683702, 557.3612066660512, 512.6133843144991, 56.58542252651315, 116.20601217724239, 430.93815065565144, 487.9820090355679, 400.4177360815616, 484.65676190062186, 483.12483132380385, 609.9142129434017, 410.3553707693035, 365.7388016501331, 526.9656863527923, 348.7319982175391, 326.52226690013185, 335.995292926706, 394.49406791454857, 624.8278087423129, 610.3341637556033, 427.9204452264202, 608.9872582596727, 389.12739827072585, 495.2657318398855, 344.02882454413293, 586.0527614427624, 353.41049165509776, 363.40183794579576, 494.37107160887336, 560.5988295146877, 152.52078253068558, 573.4716792862068, 752.6172008341008, 577.0461811100662, 528.8739436096557, 162.7194047766051, 453.73809176755026, 535.8461848188854, 138.14441476094385, 377.003461717052, 586.4807506033466, 341.77472542287785, 311.42236137755566, 246.65652455288605, 109.1762259608135, 608.7613960209588, 582.3754578242347, 247.28389764000786, 443.647970940931, 543.4102011600075, 401.9151749604734, 433.34009789978074, 40.63835581622221, 101.28515306105535, 569.3020845668696, 495.6331770809685, 620.9660062412515, 484.3762137782927, 137.17251910277884, 732.7516085720952, 82.64586253940863, 560.6390027042019, 340.32907855799465, 351.1843567839619, 653.9064388776603, 99.12494345641835, 440.4430654098916, 143.78076659576732, 426.65077437387805]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.462576652920491, "mean_inference_ms": 6.634539106198612, "mean_action_processing_ms": 2.9691218668549606, "mean_env_wait_ms": 17.75257169470509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030210018157958984, "StateBufferConnector_ms": 0.0075157880783081055, "ViewRequirementAgentConnector_ms": 0.27270662784576416}, "num_episodes": 26, "episode_return_max": 739.9723112417151, "episode_return_min": -60.787318657377156, "episode_return_mean": 155.657503977363, "episodes_this_iter": 26}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 53.73031427191841, "num_env_steps_trained_throughput_per_sec": 53.73031427191841, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 73065.854, "restore_workers_time_ms": 0.016, "training_step_time_ms": 73065.796, "sample_time_ms": 4666.717, "learn_time_ms": 68371.287, "learn_throughput": 58.504, "synch_weights_time_ms": 18.018}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "training_iteration": 26, "trial_id": "62684_00000", "date": "2024-08-20_16-38-59", "timestamp": 1724152139, "time_this_iter_s": 74.50654482841492, "time_total_s": 1871.952518939972, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ff92e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1871.952518939972, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 59.356603773584915, "ram_util_percent": 83.3056603773585}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.326482557827699, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.687425129464332, "policy_loss": -0.022893905418418042, "vf_loss": 6.707120425312231, "vf_explained_var": 0.457992118618167, "kl": 0.01599298848899359, "entropy": 1.2080633602243789, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 74730.5, "diff_num_grad_updates_vs_sampler_policy": 1448.2749999999942}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.5028682108594, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.125102687512756, "policy_loss": -0.02139308786995354, "vf_loss": 8.143864699520131, "vf_explained_var": 0.17548597669475294, "kl": 0.013155302298674114, "entropy": 0.775492988408558, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "env_runners": {"episode_reward_max": 739.9723112417151, "episode_reward_min": -29.76062184638545, "episode_reward_mean": 158.9840850186872, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -771.8945519364446, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.39999999999998, "predator_policy": 771.8945519364446}, "policy_reward_mean": {"prey_policy": -204.56532406136202, "predator_policy": 386.34002860138685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [266.3598064660201, 164.43517117794306, 161.22276751509685, 36.33986601777738, 270.2963811682808, 155.01865916063375, 184.94381692303926, 31.465157445804348, 235.8999999999993, 241.91622757524686, 231.14890963688686, 181.86409920042038, 128.50160409777456, 185.73932982709258, 92.39786746014966, 21.985888692828972, 172.02969617430318, 114.81688529715203, 100.97772086393658, 48.639462049657325, 37.04103060750408, 227.01600169570725, 240.13258485306653, 54.49439904690101, 158.90077051895636, 155.0089853189454, 207.42841496854805, 34.14880899349091, 118.81671105177111, 40.67944335037861, 164.65620603083298, 107.64806241081007, 333.67373829368785, 147.10799884969805, 129.08489058462914, 254.85294502500804, 226.8640497893864, 271.29652366873796, 25.132473114090924, 739.9723112417151, 136.57774689048267, 54.200000000000344, 121.77053707207116, 255.84600409928353, 24.33989245002825, 169.41556030393357, 69.1899407491392, 34.63730536067347, 320.6315258685248, 232.12339471206766, 28.753125605903058, 78.24312776414294, 231.4568170235965, 173.6096774215957, 158.08142882001698, 41.97744019730606, 29.734629968386837, 18.259770025837085, 328.7922034835411, 151.36340221650926, 147.1117826804293, 26.52363355187665, 56.50060689174151, 254.7980936221621, 156.83569963647196, 252.12471656257017, 347.885183557854, 110.83432886018224, 164.27027651669997, 218.23478981266095, 286.3394757491227, 94.56221582809438, 29.69678328298859, 104.18443046860996, 442.56572370456314, 293.5932302202422, 54.88645946038258, 41.854697964834884, 79.0146791178469, 217.14271579423567, 263.08875973746063, 162.28266005742796, 404.4093825431084, 102.81153447503561, 233.97744124380168, 218.0295181788257, 45.22782439043983, 70.21904326751815, 176.1587512384282, 138.83410061682616, 117.41026760281115, 89.00400770453729, 64.72852168481455, 32.69315585710532, 87.03413854024345, -29.76062184638545, 253.22551222396015, 62.03772167215716, 238.04441454950236, 431.03364865058427], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-627.0248002571218, 47.01774152420804, 185.46407892443852, 56.31000464511627, 9.201217463647716, -349.3044115806702, -281.84351390026467, 4.554337316208267, -252.07644387331106, -496.3323893573398, -297.3185250637195, -73.63383293040629, -441.4329089705188, -243.55160675758057, 101.63967978112419, -66.02160287975816, 17.918544892722682, -27.545074112034392, -269.6133028111062, 4.030965480798898, -209.40539507194927, 9.67287700534435, -511.48632389466746, -403.12595361960035, 171.87516532762208, -305.8403271784778, -25.00826601363744, -255.2722513074813, 178.83954530793915, -552.6348698482881, -207.48865368632462, -11.827242091980496, -95.4742095564757, 176.22966694430855, -304.68397980749245, -506.3542175843047, 2.8450334422508674, -771.8945519364446, -106.79545678488095, -87.1362435536084, 166.03932982709318, -339.50512852921696, -50.062485140881634, -478.0346774985498, -72.83941344829127, 5.6560691596053605, -384.34742542734875, -493.0698401111274, -216.3460508815271, -157.39366432326952, 133.84395092046177, -214.2383961984103, -8.322496011175149, -555.8765082527143, -48.327659435430405, -564.3762790816853, -55.3518564961093, -371.5373412847144, -299.31134823324254, -164.83630702538898, -281.81929816682396, -114.33907547446539, -210.7771846023683, 19.016116523516814, -467.69587891536173, 30.48932278564167, 60.989899299263755, -493.5099222926729, 48.08196601125006, -545.4961086880431, 14.06177765727314, -225.73156366108122, -106.91121664278761, 10.257362655464872, -324.43323421722386, -16.694079925136858, -304.97110639557025, -129.77636091184715, -462.4074155152254, 156.72494400267448, -524.5617002029367, -417.53366772856515, 30.01243544342404, -553.0020703240277, -34.76755025943874, -500.3542407073093, -292.70192858660187, -527.7788456965277, -568.3409992915455, 19.016116523516814, -33.645919777168906, 91.37876213308078, -432.96564021111067, -452.3325973143251, 20.000000000000014, -71.02746113439524, -311.7568205580717, -393.97053299371873, 65.32408695192798, -17.20770091502298, -481.1665664922431, -394.83111966713267, 3.534364613971236, -82.01332490374915, -137.99016131303787, 91.10872731077964, -587.6867708087938, 15.260651831528921, -79.95263282295427, -198.1572973024943, 3.7087125890787718, -359.0608485996218, 21.43479045897812, 172.47685447463954, -644.900844482486, -25.341878200599673, -449.7773420569483, -728.2305214518462, 192.66098118238477, 137.0, -273.17046773205243, -578.458280203869, 131.280283359223, 20.000000000000014, 20.000000000000014, -449.41627936836954, -388.42421333086594, 13.22074660633909, -573.0005871839493, -90.17719890141572, 155.14464219285955, 18.087126104085065, -364.033683381791, -547.1784648535877, 16.63188099418816, -497.5811755110401, -149.15134075225984, -68.92642141494912, 47.301121979703076, -576.4508805004589, -494.69934499731, -35.495488071856236, -303.4579764353129, -402.50340255159404, -320.8725513299599, 184.09368089702977, -418.28728826887686, -48.64263258556316, -323.05137423246185, -58.70015829674416, -624.8278087423129, -341.109023188469, -24.63191912017654, -261.7321569843199, -534.7242680167712, -163.55505621678992, -607.9872582596727, -312.06252786449926, 153.39194661737235, -343.5837938291431, -5.447971782730189, -316.6531133505484, 153.25430257698372, -348.6943751315798, -585.9417517232457, -341.42439774849026, -494.37107160887336, 20.000000000000014, -560.5988295146877, -90.61172745541252, -32.17442510688678, 16.32688738663484, -571.4442245475626, -752.7117729335426, -337.63248300820715, -609.5507872125493, 170.05534898457688, 22.72327937243211, -18.854376633651828, -468.96299706642463, -119.35261728704245, -407.9937441962748, 0.46754458391763265, -375.4262563376105, 20.000000000000014, -581.5343224309114, 20.000000000000014, -548.2899584728295, -68.40652143586095, 117.65400870901422, -82.25586609987377, -136.43279950067762, -482.92407725229685, -581.2754578242344, 29.898380867809827, -97.38382653784475, -13.09868357947769, -328.32464190104423, -637.4401925626273, 20.000000000000014, 20.000000000000014, 51.39391631297382, 17.402056730986637, -431.9400978997804, 142.53918087711253, -567.4020845668691, -81.454057421468, -210.19689503107662, -60.10671430918006, -628.0607841693018, 164.65266721076247, -509.84414709986794, 9.982222757155924, 20.000000000000014, 16.753830205352482, -757.589085488761, -561.8130256061725, -329.45827237303513, 20.000000000000014, -652.5550693062708, -97.63243231978053, -150.71886356696075, -461.70364160746806, 186.41203501612137, 178.28932142959985, -343.70034164615447, -97.25805727446658, 164.12008817121753, -678.2169483159986, -4.003249608115766, -194.1115371377728, 20.000000000000014, -399.1631258036868, -298.15829493260634, -252.03464865363387, -6.329326440060031, -95.11631306455517, 42.62055080667098, 14.68691263114466, -475.17298800077293, -256.3607297427494, -707.4489807360047, 143.23875913903103, 19.100326903475526, -143.13372834926432, -555.6989589192151, 163.81126163527665, -616.1158853070144, -175.05951737757007, 8.907202397934673, -593.849869023456, -151.4496881315473, 20.000000000000014, -539.8424259976995, -181.40570659257807, 196.39999999999998, -502.7228674228096, -277.4878935011668, -18.048643305174814, -31.489908564229644, -581.9906502445408, -609.1247744648981, 61.85200573375671, -456.854637501081, -467.9925032077599, -260.2610927777372, 160.0864109367617, -726.7987890015661, -183.80130682581876, -169.50999299842567, -167.51412023956235, 10.465237797249861, -3.7802291466948366, -233.22879467322315, -46.386863894751144, -236.02082498987136, 17.816915047168436, -530.125815404465, -282.1463358573641, 17.09400576420938, -211.6693868532438, -378.79150062140087, -39.374358523041884, -134.48519993803862, -256.02059813232097, -740.1105766212676, -425.28728527679755, -76.8698936520982, -438.93424023001245, 58.11652130486457, -11.756466432810319, -256.2847953665597, -67.18923391745602, -342.546837408553, -86.86368056833795, 138.52650413694383, -116.90034624824702, 168.96077539736052, 81.91250037652075, -484.84079975022297], "policy_predator_policy_reward": [46.33379756251386, 614.5689887119821, 314.3500803155761, 133.87828033427496, 377.54891354310706, 313.03947442935726, 405.3922240119038, 498.23238935734014, 350.87724803624195, 502.7639690790145, 219.2024630470294, 11.464328212675658, 409.1781904099113, 250.7533589153862, 357.09506610982066, 579.3094918449065, 349.9651618508559, 44.90826601363766, 311.04893357478915, 559.9348698482881, 388.08690514436057, 157.85210982730715, 302.8961789116508, 513.7764507362582, 232.4520274404048, 771.8945519364446, 100.73624355360855, 345.60512852921767, 503.5128532244725, 189.8215903233999, 432.1866604117172, 461.56042465998354, 238.1190898513748, 173.8063706072633, 559.2230462093992, 334.0312395500536, 385.950179627001, 383.0833362501619, 267.0972044603363, 617.227254132668, 335.77734460537135, 308.19924424579006, 237.49692555347528, 407.7095157484355, 440.4285707351337, 184.14207110009397, 261.16291658383915, 550.4973771549127, 430.5785342747387, 149.40932444876472, 213.5870840616672, 392.8634484898333, 568.0457626421654, 469.6268240418704, 559.3441038045701, 415.3280077980904, 502.85424070730977, 443.78618989781256, 528.4788456965279, 589.3043261184071, 440.2656402111123, 99.6233636749222, 496.08117713123477, 114.92694372829547, 501.2374412817113, 472.83956361183857, 481.1665664922431, 559.146819431854, 14.76563538602873, 330.7883768014164, 498.402222328574, 237.76811436291925, 281.06786006639, 220.1974072593659, 363.44068804740783, 73.00503928733416, 646.3065892744037, 498.8459485797214, 620.468440924612, 518.0734105865645, 578.5223534814618, 278.4038579857211, 0.0, 463.6162793683702, 557.3612066660512, 512.6133843144991, 56.58542252651315, 116.20601217724239, 430.93815065565144, 487.9820090355679, 400.4177360815616, 484.65676190062186, 483.12483132380385, 609.9142129434017, 410.3553707693035, 365.7388016501331, 526.9656863527923, 348.7319982175391, 326.52226690013185, 335.995292926706, 394.49406791454857, 624.8278087423129, 610.3341637556033, 427.9204452264202, 608.9872582596727, 389.12739827072585, 495.2657318398855, 344.02882454413293, 586.0527614427624, 353.41049165509776, 363.40183794579576, 494.37107160887336, 560.5988295146877, 152.52078253068558, 573.4716792862068, 752.6172008341008, 577.0461811100662, 528.8739436096557, 162.7194047766051, 453.73809176755026, 535.8461848188854, 138.14441476094385, 377.003461717052, 586.4807506033466, 341.77472542287785, 311.42236137755566, 246.65652455288605, 109.1762259608135, 608.7613960209588, 582.3754578242347, 247.28389764000786, 443.647970940931, 543.4102011600075, 401.9151749604734, 433.34009789978074, 40.63835581622221, 101.28515306105535, 569.3020845668696, 495.6331770809685, 620.9660062412515, 484.3762137782927, 137.17251910277884, 732.7516085720952, 82.64586253940863, 560.6390027042019, 340.32907855799465, 351.1843567839619, 653.9064388776603, 99.12494345641835, 440.4430654098916, 143.78076659576732, 426.65077437387805, 675.9859741186609, 255.23222040360852, 401.66312580368736, 317.5129928974409, 212.29508052272118, 220.19988675337422, 253.85232136544508, 381.1559189917482, 489.42030525847633, 594.2394058187072, 674.8359804296948, 167.17903999273835, 488.13982141785704, 543.6337021745597, 494.0230676478942, 345.18082158421004, 445.5329938803163, 489.6925799537648, 503.32286742280974, 298.51741167999296, 528.2240560823068, 148.53297042207842, 464.7918884891875, 609.5545610105536, 275.86153411153924, 468.4644021756263, 492.1454004410711, 726.7987890015661, 96.27250342854991, 181.96687576326934, 405.2394343709864, 199.4010568913961, 320.21985165266835, 538.9639062468096, 372.8642093680413, 233.195828199499, 144.01322759528998, 372.9010675383555, 472.39655708251024, 740.1105766212676, 509.6708700113594, 136.12882757055925, 404.7463663428896, 323.31222202183676, 128.25529345667712, 175.0266437724671, 371.03459514128997, 293.96657748563496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.465483765989532, "mean_inference_ms": 6.654739962295529, "mean_action_processing_ms": 2.960719157073603, "mean_env_wait_ms": 17.834299983010535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03206837177276611, "StateBufferConnector_ms": 0.011555910110473633, "ViewRequirementAgentConnector_ms": 0.29148542881011963}, "num_episodes": 24, "episode_return_max": 739.9723112417151, "episode_return_min": -29.76062184638545, "episode_return_mean": 158.9840850186872, "episodes_this_iter": 24}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.56420725216658, "num_env_steps_trained_throughput_per_sec": 54.56420725216658, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 540000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 72133.731, "restore_workers_time_ms": 0.025, "training_step_time_ms": 72133.661, "sample_time_ms": 4898.759, "learn_time_ms": 67209.002, "learn_throughput": 59.516, "synch_weights_time_ms": 15.228}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "training_iteration": 27, "trial_id": "62684_00000", "date": "2024-08-20_16-40-13", "timestamp": 1724152213, "time_this_iter_s": 73.40011692047119, "time_total_s": 1945.3526358604431, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ff92a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1945.3526358604431, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 62.95673076923077, "ram_util_percent": 83.59038461538464}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.822574088294456, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.18221540620141, "policy_loss": -0.018148924066051047, "vf_loss": 7.197352343755411, "vf_explained_var": 0.42906057972011835, "kl": 0.015059897892923484, "entropy": 1.1759844064289797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 77550.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.245946641006167, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.386038043259314, "policy_loss": -0.019439264176236024, "vf_loss": 8.403156652652397, "vf_explained_var": 0.14585935498671557, "kl": 0.011603140059572758, "entropy": 0.7643250488730334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 739.9723112417151, "episode_reward_min": -29.76062184638545, "episode_reward_mean": 157.0471574856401, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -757.589085488761, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.39999999999998, "predator_policy": 752.6172008341008}, "policy_reward_mean": {"prey_policy": -207.59502841219765, "predator_policy": 389.9161213611167}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.985888692828972, 172.02969617430318, 114.81688529715203, 100.97772086393658, 48.639462049657325, 37.04103060750408, 227.01600169570725, 240.13258485306653, 54.49439904690101, 158.90077051895636, 155.0089853189454, 207.42841496854805, 34.14880899349091, 118.81671105177111, 40.67944335037861, 164.65620603083298, 107.64806241081007, 333.67373829368785, 147.10799884969805, 129.08489058462914, 254.85294502500804, 226.8640497893864, 271.29652366873796, 25.132473114090924, 739.9723112417151, 136.57774689048267, 54.200000000000344, 121.77053707207116, 255.84600409928353, 24.33989245002825, 169.41556030393357, 69.1899407491392, 34.63730536067347, 320.6315258685248, 232.12339471206766, 28.753125605903058, 78.24312776414294, 231.4568170235965, 173.6096774215957, 158.08142882001698, 41.97744019730606, 29.734629968386837, 18.259770025837085, 328.7922034835411, 151.36340221650926, 147.1117826804293, 26.52363355187665, 56.50060689174151, 254.7980936221621, 156.83569963647196, 252.12471656257017, 347.885183557854, 110.83432886018224, 164.27027651669997, 218.23478981266095, 286.3394757491227, 94.56221582809438, 29.69678328298859, 104.18443046860996, 442.56572370456314, 293.5932302202422, 54.88645946038258, 41.854697964834884, 79.0146791178469, 217.14271579423567, 263.08875973746063, 162.28266005742796, 404.4093825431084, 102.81153447503561, 233.97744124380168, 218.0295181788257, 45.22782439043983, 70.21904326751815, 176.1587512384282, 138.83410061682616, 117.41026760281115, 89.00400770453729, 64.72852168481455, 32.69315585710532, 87.03413854024345, -29.76062184638545, 253.22551222396015, 62.03772167215716, 238.04441454950236, 431.03364865058427, 169.6795340492526, 105.70317620473753, 130.5818914393581, 128.52000381629085, 65.33877888859567, 402.85047298772145, 35.96747426955334, 30.300000000000146, 71.51759745313066, 188.55124585641607, 135.1084024258547, 426.86939736149594, 229.3454210607241, 179.8870006778483, 73.63651387647235], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.6560691596053605, -384.34742542734875, -493.0698401111274, -216.3460508815271, -157.39366432326952, 133.84395092046177, -214.2383961984103, -8.322496011175149, -555.8765082527143, -48.327659435430405, -564.3762790816853, -55.3518564961093, -371.5373412847144, -299.31134823324254, -164.83630702538898, -281.81929816682396, -114.33907547446539, -210.7771846023683, 19.016116523516814, -467.69587891536173, 30.48932278564167, 60.989899299263755, -493.5099222926729, 48.08196601125006, -545.4961086880431, 14.06177765727314, -225.73156366108122, -106.91121664278761, 10.257362655464872, -324.43323421722386, -16.694079925136858, -304.97110639557025, -129.77636091184715, -462.4074155152254, 156.72494400267448, -524.5617002029367, -417.53366772856515, 30.01243544342404, -553.0020703240277, -34.76755025943874, -500.3542407073093, -292.70192858660187, -527.7788456965277, -568.3409992915455, 19.016116523516814, -33.645919777168906, 91.37876213308078, -432.96564021111067, -452.3325973143251, 20.000000000000014, -71.02746113439524, -311.7568205580717, -393.97053299371873, 65.32408695192798, -17.20770091502298, -481.1665664922431, -394.83111966713267, 3.534364613971236, -82.01332490374915, -137.99016131303787, 91.10872731077964, -587.6867708087938, 15.260651831528921, -79.95263282295427, -198.1572973024943, 3.7087125890787718, -359.0608485996218, 21.43479045897812, 172.47685447463954, -644.900844482486, -25.341878200599673, -449.7773420569483, -728.2305214518462, 192.66098118238477, 137.0, -273.17046773205243, -578.458280203869, 131.280283359223, 20.000000000000014, 20.000000000000014, -449.41627936836954, -388.42421333086594, 13.22074660633909, -573.0005871839493, -90.17719890141572, 155.14464219285955, 18.087126104085065, -364.033683381791, -547.1784648535877, 16.63188099418816, -497.5811755110401, -149.15134075225984, -68.92642141494912, 47.301121979703076, -576.4508805004589, -494.69934499731, -35.495488071856236, -303.4579764353129, -402.50340255159404, -320.8725513299599, 184.09368089702977, -418.28728826887686, -48.64263258556316, -323.05137423246185, -58.70015829674416, -624.8278087423129, -341.109023188469, -24.63191912017654, -261.7321569843199, -534.7242680167712, -163.55505621678992, -607.9872582596727, -312.06252786449926, 153.39194661737235, -343.5837938291431, -5.447971782730189, -316.6531133505484, 153.25430257698372, -348.6943751315798, -585.9417517232457, -341.42439774849026, -494.37107160887336, 20.000000000000014, -560.5988295146877, -90.61172745541252, -32.17442510688678, 16.32688738663484, -571.4442245475626, -752.7117729335426, -337.63248300820715, -609.5507872125493, 170.05534898457688, 22.72327937243211, -18.854376633651828, -468.96299706642463, -119.35261728704245, -407.9937441962748, 0.46754458391763265, -375.4262563376105, 20.000000000000014, -581.5343224309114, 20.000000000000014, -548.2899584728295, -68.40652143586095, 117.65400870901422, -82.25586609987377, -136.43279950067762, -482.92407725229685, -581.2754578242344, 29.898380867809827, -97.38382653784475, -13.09868357947769, -328.32464190104423, -637.4401925626273, 20.000000000000014, 20.000000000000014, 51.39391631297382, 17.402056730986637, -431.9400978997804, 142.53918087711253, -567.4020845668691, -81.454057421468, -210.19689503107662, -60.10671430918006, -628.0607841693018, 164.65266721076247, -509.84414709986794, 9.982222757155924, 20.000000000000014, 16.753830205352482, -757.589085488761, -561.8130256061725, -329.45827237303513, 20.000000000000014, -652.5550693062708, -97.63243231978053, -150.71886356696075, -461.70364160746806, 186.41203501612137, 178.28932142959985, -343.70034164615447, -97.25805727446658, 164.12008817121753, -678.2169483159986, -4.003249608115766, -194.1115371377728, 20.000000000000014, -399.1631258036868, -298.15829493260634, -252.03464865363387, -6.329326440060031, -95.11631306455517, 42.62055080667098, 14.68691263114466, -475.17298800077293, -256.3607297427494, -707.4489807360047, 143.23875913903103, 19.100326903475526, -143.13372834926432, -555.6989589192151, 163.81126163527665, -616.1158853070144, -175.05951737757007, 8.907202397934673, -593.849869023456, -151.4496881315473, 20.000000000000014, -539.8424259976995, -181.40570659257807, 196.39999999999998, -502.7228674228096, -277.4878935011668, -18.048643305174814, -31.489908564229644, -581.9906502445408, -609.1247744648981, 61.85200573375671, -456.854637501081, -467.9925032077599, -260.2610927777372, 160.0864109367617, -726.7987890015661, -183.80130682581876, -169.50999299842567, -167.51412023956235, 10.465237797249861, -3.7802291466948366, -233.22879467322315, -46.386863894751144, -236.02082498987136, 17.816915047168436, -530.125815404465, -282.1463358573641, 17.09400576420938, -211.6693868532438, -378.79150062140087, -39.374358523041884, -134.48519993803862, -256.02059813232097, -740.1105766212676, -425.28728527679755, -76.8698936520982, -438.93424023001245, 58.11652130486457, -11.756466432810319, -256.2847953665597, -67.18923391745602, -342.546837408553, -86.86368056833795, 138.52650413694383, -116.90034624824702, 168.96077539736052, 81.91250037652075, -484.84079975022297, -94.59123892792172, -344.12507997554303, -318.88930419924253, -265.203981056024, -220.9196850191393, -547.3249584261854, -23.947637608098667, -275.2596181815987, -59.980822554677744, -569.6209811449044, -73.6337017706384, -272.2464939691981, -281.8550805053841, -132.5230374167493, -603.1573192458407, -485.8851592616174, 99.29840152266115, 18.847824496152864, -9.987249444475369, -216.86959665458534, 1.6183149596482098, -156.74451938307624, 20.000000000000014, -355.6477636614771, -129.47863816730745, -165.6022824975783, -206.15427777678107, 15.552716727117359, -190.18090455614973, -418.5756468108327, -353.5484014041931, -53.543539150227346, -76.08263474389682, 166.41874880331568, 43.761834293897344, -533.4385666618434, -472.3670672896569, 118.3274511928259, -142.20196119879935, -94.35697224937249, -236.11757035836234, -213.69016686878302, 20.000000000000014, -389.83506862874964, -18.079541640952577], "policy_predator_policy_reward": [432.1866604117172, 461.56042465998354, 238.1190898513748, 173.8063706072633, 559.2230462093992, 334.0312395500536, 385.950179627001, 383.0833362501619, 267.0972044603363, 617.227254132668, 335.77734460537135, 308.19924424579006, 237.49692555347528, 407.7095157484355, 440.4285707351337, 184.14207110009397, 261.16291658383915, 550.4973771549127, 430.5785342747387, 149.40932444876472, 213.5870840616672, 392.8634484898333, 568.0457626421654, 469.6268240418704, 559.3441038045701, 415.3280077980904, 502.85424070730977, 443.78618989781256, 528.4788456965279, 589.3043261184071, 440.2656402111123, 99.6233636749222, 496.08117713123477, 114.92694372829547, 501.2374412817113, 472.83956361183857, 481.1665664922431, 559.146819431854, 14.76563538602873, 330.7883768014164, 498.402222328574, 237.76811436291925, 281.06786006639, 220.1974072593659, 363.44068804740783, 73.00503928733416, 646.3065892744037, 498.8459485797214, 620.468440924612, 518.0734105865645, 578.5223534814618, 278.4038579857211, 0.0, 463.6162793683702, 557.3612066660512, 512.6133843144991, 56.58542252651315, 116.20601217724239, 430.93815065565144, 487.9820090355679, 400.4177360815616, 484.65676190062186, 483.12483132380385, 609.9142129434017, 410.3553707693035, 365.7388016501331, 526.9656863527923, 348.7319982175391, 326.52226690013185, 335.995292926706, 394.49406791454857, 624.8278087423129, 610.3341637556033, 427.9204452264202, 608.9872582596727, 389.12739827072585, 495.2657318398855, 344.02882454413293, 586.0527614427624, 353.41049165509776, 363.40183794579576, 494.37107160887336, 560.5988295146877, 152.52078253068558, 573.4716792862068, 752.6172008341008, 577.0461811100662, 528.8739436096557, 162.7194047766051, 453.73809176755026, 535.8461848188854, 138.14441476094385, 377.003461717052, 586.4807506033466, 341.77472542287785, 311.42236137755566, 246.65652455288605, 109.1762259608135, 608.7613960209588, 582.3754578242347, 247.28389764000786, 443.647970940931, 543.4102011600075, 401.9151749604734, 433.34009789978074, 40.63835581622221, 101.28515306105535, 569.3020845668696, 495.6331770809685, 620.9660062412515, 484.3762137782927, 137.17251910277884, 732.7516085720952, 82.64586253940863, 560.6390027042019, 340.32907855799465, 351.1843567839619, 653.9064388776603, 99.12494345641835, 440.4430654098916, 143.78076659576732, 426.65077437387805, 675.9859741186609, 255.23222040360852, 401.66312580368736, 317.5129928974409, 212.29508052272118, 220.19988675337422, 253.85232136544508, 381.1559189917482, 489.42030525847633, 594.2394058187072, 674.8359804296948, 167.17903999273835, 488.13982141785704, 543.6337021745597, 494.0230676478942, 345.18082158421004, 445.5329938803163, 489.6925799537648, 503.32286742280974, 298.51741167999296, 528.2240560823068, 148.53297042207842, 464.7918884891875, 609.5545610105536, 275.86153411153924, 468.4644021756263, 492.1454004410711, 726.7987890015661, 96.27250342854991, 181.96687576326934, 405.2394343709864, 199.4010568913961, 320.21985165266835, 538.9639062468096, 372.8642093680413, 233.195828199499, 144.01322759528998, 372.9010675383555, 472.39655708251024, 740.1105766212676, 509.6708700113594, 136.12882757055925, 404.7463663428896, 323.31222202183676, 128.25529345667712, 175.0266437724671, 371.03459514128997, 293.96657748563496, 455.3566473897478, 471.92850976221524, 484.20178206714735, 654.9500186389374, 264.8188101341656, 224.95115964956858, 566.1529216366793, 477.86825906435524, 479.716896810731, 603.1573192458407, 445.1122100510264, 325.4771961794964, 233.1187559644898, 28.087249444475518, 356.44776366147715, 166.24451938307607, 259.67310916970797, 313.079686725088, 218.2479049643765, 563.5071755319046, 370.6314441270878, 247.65153359708418, 356.3378126217726, 393.7895683043514, 270.0659652626214, 455.52103309373325, 466.3293233020978, 257.72238685226773, 429.0595291609944, 32.49159498518106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.49042163795921, "mean_inference_ms": 6.680516620054342, "mean_action_processing_ms": 2.9343784957947707, "mean_env_wait_ms": 17.85060646786323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03398263454437256, "StateBufferConnector_ms": 0.011895060539245605, "ViewRequirementAgentConnector_ms": 0.2797973155975342}, "num_episodes": 15, "episode_return_max": 739.9723112417151, "episode_return_min": -29.76062184638545, "episode_return_mean": 157.0471574856401, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.84944750279488, "num_env_steps_trained_throughput_per_sec": 56.84944750279488, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 71416.046, "restore_workers_time_ms": 0.025, "training_step_time_ms": 71415.976, "sample_time_ms": 4855.801, "learn_time_ms": 66533.21, "learn_throughput": 60.12, "synch_weights_time_ms": 15.084}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 28, "trial_id": "62684_00000", "date": "2024-08-20_16-41-23", "timestamp": 1724152283, "time_this_iter_s": 70.41031408309937, "time_total_s": 2015.7629499435425, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb01700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2015.7629499435425, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 52.51, "ram_util_percent": 83.389}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.999562717118161, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.324675060502181, "policy_loss": -0.02196756655821768, "vf_loss": 7.343615064215153, "vf_explained_var": 0.4464248211037183, "kl": 0.015137859782805099, "entropy": 1.1498501352807309, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 80370.5, "diff_num_grad_updates_vs_sampler_policy": 1448.2749999999942}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.591552459972876, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.233949865109075, "policy_loss": -0.021990318182688304, "vf_loss": 8.253192458581672, "vf_explained_var": 0.1710776080845525, "kl": 0.013738624983166576, "entropy": 0.7098261441503252, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000}, "env_runners": {"episode_reward_max": 739.9723112417151, "episode_reward_min": -34.04856167869973, "episode_reward_mean": 168.49332129115592, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -757.589085488761, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.39999999999998, "predator_policy": 752.6172008341008}, "policy_reward_mean": {"prey_policy": -204.9202372751843, "predator_policy": 391.62701655835457}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.81671105177111, 40.67944335037861, 164.65620603083298, 107.64806241081007, 333.67373829368785, 147.10799884969805, 129.08489058462914, 254.85294502500804, 226.8640497893864, 271.29652366873796, 25.132473114090924, 739.9723112417151, 136.57774689048267, 54.200000000000344, 121.77053707207116, 255.84600409928353, 24.33989245002825, 169.41556030393357, 69.1899407491392, 34.63730536067347, 320.6315258685248, 232.12339471206766, 28.753125605903058, 78.24312776414294, 231.4568170235965, 173.6096774215957, 158.08142882001698, 41.97744019730606, 29.734629968386837, 18.259770025837085, 328.7922034835411, 151.36340221650926, 147.1117826804293, 26.52363355187665, 56.50060689174151, 254.7980936221621, 156.83569963647196, 252.12471656257017, 347.885183557854, 110.83432886018224, 164.27027651669997, 218.23478981266095, 286.3394757491227, 94.56221582809438, 29.69678328298859, 104.18443046860996, 442.56572370456314, 293.5932302202422, 54.88645946038258, 41.854697964834884, 79.0146791178469, 217.14271579423567, 263.08875973746063, 162.28266005742796, 404.4093825431084, 102.81153447503561, 233.97744124380168, 218.0295181788257, 45.22782439043983, 70.21904326751815, 176.1587512384282, 138.83410061682616, 117.41026760281115, 89.00400770453729, 64.72852168481455, 32.69315585710532, 87.03413854024345, -29.76062184638545, 253.22551222396015, 62.03772167215716, 238.04441454950236, 431.03364865058427, 169.6795340492526, 105.70317620473753, 130.5818914393581, 128.52000381629085, 65.33877888859567, 402.85047298772145, 35.96747426955334, 30.300000000000146, 71.51759745313066, 188.55124585641607, 135.1084024258547, 426.86939736149594, 229.3454210607241, 179.8870006778483, 73.63651387647235, 200.4112352442067, 197.77702481872493, 193.78910902771102, 188.3913667670408, 499.33845351450645, 180.34431557665565, 187.9445629208034, -34.04856167869973, 205.16327513817336, 52.27197824336736, 253.3945915181504, 139.74710279781021, 452.7125757441268], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-34.76755025943874, -500.3542407073093, -292.70192858660187, -527.7788456965277, -568.3409992915455, 19.016116523516814, -33.645919777168906, 91.37876213308078, -432.96564021111067, -452.3325973143251, 20.000000000000014, -71.02746113439524, -311.7568205580717, -393.97053299371873, 65.32408695192798, -17.20770091502298, -481.1665664922431, -394.83111966713267, 3.534364613971236, -82.01332490374915, -137.99016131303787, 91.10872731077964, -587.6867708087938, 15.260651831528921, -79.95263282295427, -198.1572973024943, 3.7087125890787718, -359.0608485996218, 21.43479045897812, 172.47685447463954, -644.900844482486, -25.341878200599673, -449.7773420569483, -728.2305214518462, 192.66098118238477, 137.0, -273.17046773205243, -578.458280203869, 131.280283359223, 20.000000000000014, 20.000000000000014, -449.41627936836954, -388.42421333086594, 13.22074660633909, -573.0005871839493, -90.17719890141572, 155.14464219285955, 18.087126104085065, -364.033683381791, -547.1784648535877, 16.63188099418816, -497.5811755110401, -149.15134075225984, -68.92642141494912, 47.301121979703076, -576.4508805004589, -494.69934499731, -35.495488071856236, -303.4579764353129, -402.50340255159404, -320.8725513299599, 184.09368089702977, -418.28728826887686, -48.64263258556316, -323.05137423246185, -58.70015829674416, -624.8278087423129, -341.109023188469, -24.63191912017654, -261.7321569843199, -534.7242680167712, -163.55505621678992, -607.9872582596727, -312.06252786449926, 153.39194661737235, -343.5837938291431, -5.447971782730189, -316.6531133505484, 153.25430257698372, -348.6943751315798, -585.9417517232457, -341.42439774849026, -494.37107160887336, 20.000000000000014, -560.5988295146877, -90.61172745541252, -32.17442510688678, 16.32688738663484, -571.4442245475626, -752.7117729335426, -337.63248300820715, -609.5507872125493, 170.05534898457688, 22.72327937243211, -18.854376633651828, -468.96299706642463, -119.35261728704245, -407.9937441962748, 0.46754458391763265, -375.4262563376105, 20.000000000000014, -581.5343224309114, 20.000000000000014, -548.2899584728295, -68.40652143586095, 117.65400870901422, -82.25586609987377, -136.43279950067762, -482.92407725229685, -581.2754578242344, 29.898380867809827, -97.38382653784475, -13.09868357947769, -328.32464190104423, -637.4401925626273, 20.000000000000014, 20.000000000000014, 51.39391631297382, 17.402056730986637, -431.9400978997804, 142.53918087711253, -567.4020845668691, -81.454057421468, -210.19689503107662, -60.10671430918006, -628.0607841693018, 164.65266721076247, -509.84414709986794, 9.982222757155924, 20.000000000000014, 16.753830205352482, -757.589085488761, -561.8130256061725, -329.45827237303513, 20.000000000000014, -652.5550693062708, -97.63243231978053, -150.71886356696075, -461.70364160746806, 186.41203501612137, 178.28932142959985, -343.70034164615447, -97.25805727446658, 164.12008817121753, -678.2169483159986, -4.003249608115766, -194.1115371377728, 20.000000000000014, -399.1631258036868, -298.15829493260634, -252.03464865363387, -6.329326440060031, -95.11631306455517, 42.62055080667098, 14.68691263114466, -475.17298800077293, -256.3607297427494, -707.4489807360047, 143.23875913903103, 19.100326903475526, -143.13372834926432, -555.6989589192151, 163.81126163527665, -616.1158853070144, -175.05951737757007, 8.907202397934673, -593.849869023456, -151.4496881315473, 20.000000000000014, -539.8424259976995, -181.40570659257807, 196.39999999999998, -502.7228674228096, -277.4878935011668, -18.048643305174814, -31.489908564229644, -581.9906502445408, -609.1247744648981, 61.85200573375671, -456.854637501081, -467.9925032077599, -260.2610927777372, 160.0864109367617, -726.7987890015661, -183.80130682581876, -169.50999299842567, -167.51412023956235, 10.465237797249861, -3.7802291466948366, -233.22879467322315, -46.386863894751144, -236.02082498987136, 17.816915047168436, -530.125815404465, -282.1463358573641, 17.09400576420938, -211.6693868532438, -378.79150062140087, -39.374358523041884, -134.48519993803862, -256.02059813232097, -740.1105766212676, -425.28728527679755, -76.8698936520982, -438.93424023001245, 58.11652130486457, -11.756466432810319, -256.2847953665597, -67.18923391745602, -342.546837408553, -86.86368056833795, 138.52650413694383, -116.90034624824702, 168.96077539736052, 81.91250037652075, -484.84079975022297, -94.59123892792172, -344.12507997554303, -318.88930419924253, -265.203981056024, -220.9196850191393, -547.3249584261854, -23.947637608098667, -275.2596181815987, -59.980822554677744, -569.6209811449044, -73.6337017706384, -272.2464939691981, -281.8550805053841, -132.5230374167493, -603.1573192458407, -485.8851592616174, 99.29840152266115, 18.847824496152864, -9.987249444475369, -216.86959665458534, 1.6183149596482098, -156.74451938307624, 20.000000000000014, -355.6477636614771, -129.47863816730745, -165.6022824975783, -206.15427777678107, 15.552716727117359, -190.18090455614973, -418.5756468108327, -353.5484014041931, -53.543539150227346, -76.08263474389682, 166.41874880331568, 43.761834293897344, -533.4385666618434, -472.3670672896569, 118.3274511928259, -142.20196119879935, -94.35697224937249, -236.11757035836234, -213.69016686878302, 20.000000000000014, -389.83506862874964, -18.079541640952577, -586.4519288562628, -337.198322245272, 115.33822049437944, -197.62876557513854, -299.1539290402599, 45.60986102960999, -504.74940673516494, 106.03611191255877, -219.26614228190994, 152.551686141962, -515.2441981521167, -356.38887636121945, 20.000000000000014, 184.41555861003746, -579.7959695811024, -14.930376715140987, -353.08110734369393, -250.14824109531045, -20.25777512500775, -147.2103970013805, 147.40836421619173, -378.4559187523446, -569.9904182288583, -106.31461286602156, -265.76290608380486, -558.3448813846509, 63.12529193268147, -213.21647012404543, -483.6391402678796, 20.000000000000014, -397.42634003483266, 62.451862521347884, 59.599999999999966, -12.791299020924802, -382.80893643193946, -91.17942082477607, -142.47228577776184, -525.8307403295291, 131.77797851387908], "policy_predator_policy_reward": [502.85424070730977, 443.78618989781256, 528.4788456965279, 589.3043261184071, 440.2656402111123, 99.6233636749222, 496.08117713123477, 114.92694372829547, 501.2374412817113, 472.83956361183857, 481.1665664922431, 559.146819431854, 14.76563538602873, 330.7883768014164, 498.402222328574, 237.76811436291925, 281.06786006639, 220.1974072593659, 363.44068804740783, 73.00503928733416, 646.3065892744037, 498.8459485797214, 620.468440924612, 518.0734105865645, 578.5223534814618, 278.4038579857211, 0.0, 463.6162793683702, 557.3612066660512, 512.6133843144991, 56.58542252651315, 116.20601217724239, 430.93815065565144, 487.9820090355679, 400.4177360815616, 484.65676190062186, 483.12483132380385, 609.9142129434017, 410.3553707693035, 365.7388016501331, 526.9656863527923, 348.7319982175391, 326.52226690013185, 335.995292926706, 394.49406791454857, 624.8278087423129, 610.3341637556033, 427.9204452264202, 608.9872582596727, 389.12739827072585, 495.2657318398855, 344.02882454413293, 586.0527614427624, 353.41049165509776, 363.40183794579576, 494.37107160887336, 560.5988295146877, 152.52078253068558, 573.4716792862068, 752.6172008341008, 577.0461811100662, 528.8739436096557, 162.7194047766051, 453.73809176755026, 535.8461848188854, 138.14441476094385, 377.003461717052, 586.4807506033466, 341.77472542287785, 311.42236137755566, 246.65652455288605, 109.1762259608135, 608.7613960209588, 582.3754578242347, 247.28389764000786, 443.647970940931, 543.4102011600075, 401.9151749604734, 433.34009789978074, 40.63835581622221, 101.28515306105535, 569.3020845668696, 495.6331770809685, 620.9660062412515, 484.3762137782927, 137.17251910277884, 732.7516085720952, 82.64586253940863, 560.6390027042019, 340.32907855799465, 351.1843567839619, 653.9064388776603, 99.12494345641835, 440.4430654098916, 143.78076659576732, 426.65077437387805, 675.9859741186609, 255.23222040360852, 401.66312580368736, 317.5129928974409, 212.29508052272118, 220.19988675337422, 253.85232136544508, 381.1559189917482, 489.42030525847633, 594.2394058187072, 674.8359804296948, 167.17903999273835, 488.13982141785704, 543.6337021745597, 494.0230676478942, 345.18082158421004, 445.5329938803163, 489.6925799537648, 503.32286742280974, 298.51741167999296, 528.2240560823068, 148.53297042207842, 464.7918884891875, 609.5545610105536, 275.86153411153924, 468.4644021756263, 492.1454004410711, 726.7987890015661, 96.27250342854991, 181.96687576326934, 405.2394343709864, 199.4010568913961, 320.21985165266835, 538.9639062468096, 372.8642093680413, 233.195828199499, 144.01322759528998, 372.9010675383555, 472.39655708251024, 740.1105766212676, 509.6708700113594, 136.12882757055925, 404.7463663428896, 323.31222202183676, 128.25529345667712, 175.0266437724671, 371.03459514128997, 293.96657748563496, 455.3566473897478, 471.92850976221524, 484.20178206714735, 654.9500186389374, 264.8188101341656, 224.95115964956858, 566.1529216366793, 477.86825906435524, 479.716896810731, 603.1573192458407, 445.1122100510264, 325.4771961794964, 233.1187559644898, 28.087249444475518, 356.44776366147715, 166.24451938307607, 259.67310916970797, 313.079686725088, 218.2479049643765, 563.5071755319046, 370.6314441270878, 247.65153359708418, 356.3378126217726, 393.7895683043514, 270.0659652626214, 455.52103309373325, 466.3293233020978, 257.72238685226773, 429.0595291609944, 32.49159498518106, 421.67133699509964, 587.051928856263, 282.8626835215548, 366.08717488295906, 422.44422874849414, 389.3243173837333, 517.3922901942917, 390.080464944123, 382.92633666220905, 491.7925278233605, 505.575769976271, 292.9282707545312, 39.86517493517712, 168.13919589582346, 574.9615326941846, 445.75085547433974, 416.96644395619956, 549.1793267177484, 349.42313188974225, 379.70445674555054, 344.024465520806, 184.74460351083007, 241.81782264351182, 384.7089364319394, 475.26587018232806, 513.9717531552101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.453687336802126, "mean_inference_ms": 6.708593602737656, "mean_action_processing_ms": 2.975196439447223, "mean_env_wait_ms": 17.823444014475886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032894134521484375, "StateBufferConnector_ms": 0.011974215507507324, "ViewRequirementAgentConnector_ms": 0.30156970024108887}, "num_episodes": 13, "episode_return_max": 739.9723112417151, "episode_return_min": -34.04856167869973, "episode_return_mean": 168.49332129115592, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 58.9057043817243, "num_env_steps_trained_throughput_per_sec": 58.9057043817243, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 580000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 580000, "timers": {"training_iteration_time_ms": 70995.285, "restore_workers_time_ms": 0.025, "training_step_time_ms": 70995.218, "sample_time_ms": 4593.617, "learn_time_ms": 66374.007, "learn_throughput": 60.265, "synch_weights_time_ms": 14.938}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000}, "done": false, "training_iteration": 29, "trial_id": "62684_00000", "date": "2024-08-20_16-42-31", "timestamp": 1724152351, "time_this_iter_s": 67.95772910118103, "time_total_s": 2083.7206790447235, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffbe550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2083.7206790447235, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 50.731249999999996, "ram_util_percent": 83.26145833333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.559814354883018, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.087011384963989, "policy_loss": -0.020860810019984074, "vf_loss": 7.10488464849215, "vf_explained_var": 0.5216926425272691, "kl": 0.01493767746658137, "entropy": 1.1576725019208083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 83190.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.637272489512408, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.228769984320989, "policy_loss": -0.020132403790694538, "vf_loss": 8.246007112977367, "vf_explained_var": 0.17542858804975237, "kl": 0.014476367865969973, "entropy": 0.7345018455591151, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": 499.33845351450645, "episode_reward_min": -81.94310135709404, "episode_reward_mean": 163.80141362690736, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -765.8119656613866, "predator_policy": 8.612161672089988}, "policy_reward_max": {"prey_policy": 196.39999999999998, "predator_policy": 740.1105766212676}, "policy_reward_mean": {"prey_policy": -197.21751754601635, "predator_policy": 377.72698313247844}, "custom_metrics": {}, "hist_stats": {"episode_reward": [151.36340221650926, 147.1117826804293, 26.52363355187665, 56.50060689174151, 254.7980936221621, 156.83569963647196, 252.12471656257017, 347.885183557854, 110.83432886018224, 164.27027651669997, 218.23478981266095, 286.3394757491227, 94.56221582809438, 29.69678328298859, 104.18443046860996, 442.56572370456314, 293.5932302202422, 54.88645946038258, 41.854697964834884, 79.0146791178469, 217.14271579423567, 263.08875973746063, 162.28266005742796, 404.4093825431084, 102.81153447503561, 233.97744124380168, 218.0295181788257, 45.22782439043983, 70.21904326751815, 176.1587512384282, 138.83410061682616, 117.41026760281115, 89.00400770453729, 64.72852168481455, 32.69315585710532, 87.03413854024345, -29.76062184638545, 253.22551222396015, 62.03772167215716, 238.04441454950236, 431.03364865058427, 169.6795340492526, 105.70317620473753, 130.5818914393581, 128.52000381629085, 65.33877888859567, 402.85047298772145, 35.96747426955334, 30.300000000000146, 71.51759745313066, 188.55124585641607, 135.1084024258547, 426.86939736149594, 229.3454210607241, 179.8870006778483, 73.63651387647235, 200.4112352442067, 197.77702481872493, 193.78910902771102, 188.3913667670408, 499.33845351450645, 180.34431557665565, 187.9445629208034, -34.04856167869973, 205.16327513817336, 52.27197824336736, 253.3945915181504, 139.74710279781021, 452.7125757441268, 118.13294390663779, 206.27838347378628, 98.08583762235001, 21.046376923939146, 116.12149986640499, 116.38076449221502, 157.04811639482, 332.76179263419573, 140.67816891071564, 34.09108521053589, 226.94963078178026, 178.2972213600259, 230.06245471983488, 262.6501051610772, 59.823591904394384, 183.93471361678849, 182.1948484489038, 86.59469563935443, 233.84219377107556, -81.94310135709404, 214.5999999999989, 205.72081175829675, 100.10703588691638, 164.1220247374294, 259.7341255123619, 203.4162987996431, 73.41747271910542, 38.825927634618594, 169.40750987043083, 39.46830863689526, 226.3838757649883], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [22.72327937243211, -18.854376633651828, -468.96299706642463, -119.35261728704245, -407.9937441962748, 0.46754458391763265, -375.4262563376105, 20.000000000000014, -581.5343224309114, 20.000000000000014, -548.2899584728295, -68.40652143586095, 117.65400870901422, -82.25586609987377, -136.43279950067762, -482.92407725229685, -581.2754578242344, 29.898380867809827, -97.38382653784475, -13.09868357947769, -328.32464190104423, -637.4401925626273, 20.000000000000014, 20.000000000000014, 51.39391631297382, 17.402056730986637, -431.9400978997804, 142.53918087711253, -567.4020845668691, -81.454057421468, -210.19689503107662, -60.10671430918006, -628.0607841693018, 164.65266721076247, -509.84414709986794, 9.982222757155924, 20.000000000000014, 16.753830205352482, -757.589085488761, -561.8130256061725, -329.45827237303513, 20.000000000000014, -652.5550693062708, -97.63243231978053, -150.71886356696075, -461.70364160746806, 186.41203501612137, 178.28932142959985, -343.70034164615447, -97.25805727446658, 164.12008817121753, -678.2169483159986, -4.003249608115766, -194.1115371377728, 20.000000000000014, -399.1631258036868, -298.15829493260634, -252.03464865363387, -6.329326440060031, -95.11631306455517, 42.62055080667098, 14.68691263114466, -475.17298800077293, -256.3607297427494, -707.4489807360047, 143.23875913903103, 19.100326903475526, -143.13372834926432, -555.6989589192151, 163.81126163527665, -616.1158853070144, -175.05951737757007, 8.907202397934673, -593.849869023456, -151.4496881315473, 20.000000000000014, -539.8424259976995, -181.40570659257807, 196.39999999999998, -502.7228674228096, -277.4878935011668, -18.048643305174814, -31.489908564229644, -581.9906502445408, -609.1247744648981, 61.85200573375671, -456.854637501081, -467.9925032077599, -260.2610927777372, 160.0864109367617, -726.7987890015661, -183.80130682581876, -169.50999299842567, -167.51412023956235, 10.465237797249861, -3.7802291466948366, -233.22879467322315, -46.386863894751144, -236.02082498987136, 17.816915047168436, -530.125815404465, -282.1463358573641, 17.09400576420938, -211.6693868532438, -378.79150062140087, -39.374358523041884, -134.48519993803862, -256.02059813232097, -740.1105766212676, -425.28728527679755, -76.8698936520982, -438.93424023001245, 58.11652130486457, -11.756466432810319, -256.2847953665597, -67.18923391745602, -342.546837408553, -86.86368056833795, 138.52650413694383, -116.90034624824702, 168.96077539736052, 81.91250037652075, -484.84079975022297, -94.59123892792172, -344.12507997554303, -318.88930419924253, -265.203981056024, -220.9196850191393, -547.3249584261854, -23.947637608098667, -275.2596181815987, -59.980822554677744, -569.6209811449044, -73.6337017706384, -272.2464939691981, -281.8550805053841, -132.5230374167493, -603.1573192458407, -485.8851592616174, 99.29840152266115, 18.847824496152864, -9.987249444475369, -216.86959665458534, 1.6183149596482098, -156.74451938307624, 20.000000000000014, -355.6477636614771, -129.47863816730745, -165.6022824975783, -206.15427777678107, 15.552716727117359, -190.18090455614973, -418.5756468108327, -353.5484014041931, -53.543539150227346, -76.08263474389682, 166.41874880331568, 43.761834293897344, -533.4385666618434, -472.3670672896569, 118.3274511928259, -142.20196119879935, -94.35697224937249, -236.11757035836234, -213.69016686878302, 20.000000000000014, -389.83506862874964, -18.079541640952577, -586.4519288562628, -337.198322245272, 115.33822049437944, -197.62876557513854, -299.1539290402599, 45.60986102960999, -504.74940673516494, 106.03611191255877, -219.26614228190994, 152.551686141962, -515.2441981521167, -356.38887636121945, 20.000000000000014, 184.41555861003746, -579.7959695811024, -14.930376715140987, -353.08110734369393, -250.14824109531045, -20.25777512500775, -147.2103970013805, 147.40836421619173, -378.4559187523446, -569.9904182288583, -106.31461286602156, -265.76290608380486, -558.3448813846509, 63.12529193268147, -213.21647012404543, -483.6391402678796, 20.000000000000014, -397.42634003483266, 62.451862521347884, 59.599999999999966, -12.791299020924802, -382.80893643193946, -91.17942082477607, -142.47228577776184, -525.8307403295291, 131.77797851387908, -582.9582202633312, -114.21751361804624, 19.03462301093578, -354.44542418183494, 141.4640685730124, -704.2111255785733, -76.30423541669369, 20.000000000000014, -444.4856812904745, -494.97868936225734, -395.1682429841459, 17.010540684528586, -257.368513365068, 20.000000000000014, -21.598333739371274, -215.28910148970988, -21.307834450621037, -282.43889100382927, -149.78842575784216, 20.000000000000014, -233.34208129182687, 117.2492990177963, -765.8119656613866, -35.69291671996878, -414.67601109400533, -466.2146828541689, 20.000000000000014, 3.994976887462703, -577.6560543043266, -323.36032791209317, -410.45256240069097, -16.9950069309229, -113.90655338986203, 20.000000000000014, 66.56017277602784, -529.8978339549974, -468.2099779553647, 87.92405989361134, 10.766182829549582, 129.8955848738505, -418.53070001032364, -132.54877947669536, 5.481519004466984, -183.62904981074638, -352.0931717606113, 172.77834222148687, -220.72777230871432, -555.698611934972, 97.20108382854288, -157.70956965672713, -518.7703475614069, 34.82745120193205, -335.95139298520246, -262.63459741516795, -418.7500884765028, -209.09581873248652, 56.09976734195768, -367.9881500906844, -152.00635042689117, -301.04913554286924, -148.55324269232884, 67.53821266296474, 10.38783832790999, -308.70039835069275, -104.93437913350357, -6.168495957417761, -83.16580861989377, -286.22443192640355, -630.9318208563602, -309.7729269047787, -177.23992913231325, -176.62213714717828, -361.9015105674638, 121.84525826010274, -343.3053816643773, 196.11629879964352, -393.14608657650757, -482.86698170144297, -440.35742786626355, -298.5299080452206, 63.369972613024046, -493.8593296719289, -376.8014262888966, 31.699999999999996, -526.8795708502902, 156.6580956693074, -668.1506495628099, -206.54392446754508, -374.08652738688204, 11.258745072708143, -49.187474701582246, -364.75035571155325, 184.87621111559577], "policy_predator_policy_reward": [162.7194047766051, 453.73809176755026, 535.8461848188854, 138.14441476094385, 377.003461717052, 586.4807506033466, 341.77472542287785, 311.42236137755566, 246.65652455288605, 109.1762259608135, 608.7613960209588, 582.3754578242347, 247.28389764000786, 443.647970940931, 543.4102011600075, 401.9151749604734, 433.34009789978074, 40.63835581622221, 101.28515306105535, 569.3020845668696, 495.6331770809685, 620.9660062412515, 484.3762137782927, 137.17251910277884, 732.7516085720952, 82.64586253940863, 560.6390027042019, 340.32907855799465, 351.1843567839619, 653.9064388776603, 99.12494345641835, 440.4430654098916, 143.78076659576732, 426.65077437387805, 675.9859741186609, 255.23222040360852, 401.66312580368736, 317.5129928974409, 212.29508052272118, 220.19988675337422, 253.85232136544508, 381.1559189917482, 489.42030525847633, 594.2394058187072, 674.8359804296948, 167.17903999273835, 488.13982141785704, 543.6337021745597, 494.0230676478942, 345.18082158421004, 445.5329938803163, 489.6925799537648, 503.32286742280974, 298.51741167999296, 528.2240560823068, 148.53297042207842, 464.7918884891875, 609.5545610105536, 275.86153411153924, 468.4644021756263, 492.1454004410711, 726.7987890015661, 96.27250342854991, 181.96687576326934, 405.2394343709864, 199.4010568913961, 320.21985165266835, 538.9639062468096, 372.8642093680413, 233.195828199499, 144.01322759528998, 372.9010675383555, 472.39655708251024, 740.1105766212676, 509.6708700113594, 136.12882757055925, 404.7463663428896, 323.31222202183676, 128.25529345667712, 175.0266437724671, 371.03459514128997, 293.96657748563496, 455.3566473897478, 471.92850976221524, 484.20178206714735, 654.9500186389374, 264.8188101341656, 224.95115964956858, 566.1529216366793, 477.86825906435524, 479.716896810731, 603.1573192458407, 445.1122100510264, 325.4771961794964, 233.1187559644898, 28.087249444475518, 356.44776366147715, 166.24451938307607, 259.67310916970797, 313.079686725088, 218.2479049643765, 563.5071755319046, 370.6314441270878, 247.65153359708418, 356.3378126217726, 393.7895683043514, 270.0659652626214, 455.52103309373325, 466.3293233020978, 257.72238685226773, 429.0595291609944, 32.49159498518106, 421.67133699509964, 587.051928856263, 282.8626835215548, 366.08717488295906, 422.44422874849414, 389.3243173837333, 517.3922901942917, 390.080464944123, 382.92633666220905, 491.7925278233605, 505.575769976271, 292.9282707545312, 39.86517493517712, 168.13919589582346, 574.9615326941846, 445.75085547433974, 416.96644395619956, 549.1793267177484, 349.42313188974225, 379.70445674555054, 344.024465520806, 184.74460351083007, 241.81782264351182, 384.7089364319394, 475.26587018232806, 513.9717531552101, 213.01583451374887, 583.2582202633313, 728.7757324766218, 394.69513218455967, 452.5040859770539, 146.37166835246623, 496.61452560166794, 397.56824298414585, 82.61907221841975, 292.4692747524258, 385.20758556497805, 250.2090058713991, 38.02126939126318, 482.15735405322675, 475.2985718471103, 541.7188041506436, 373.7516828876853, 627.8171799712065, 577.6560543043266, 353.456436235166, 420.4559821481251, 347.84777135513144, 360.5739260883845, 261.06095645061134, 242.43058342612292, 357.15160652591794, 283.0887305914333, 400.74526918281185, 208.97112271067323, 381.0931717606113, 556.5271232369495, 231.05563240203827, 369.47213741121715, 392.0015444272786, 340.22234621402214, 310.1308886237722, 276.25878765717573, 529.3295459809326, 338.4684609533061, 400.6320737500452, 276.61503002936405, 8.612161672089988, 307.1443080511658, 318.3797771487446, 630.1120127922538, 470.3170844973203, 516.3017790925198, 311.4552388291796, 361.3700763318239, 481.72568315227693, 483.3669817014431, 399.9460865765091, 446.17001500341564, 302.76482101415064, 381.0958146284178, 496.69086896702635, 528.6337102299926, 679.1459243842313, 181.29271610312452, 427.5472993154889, 70.37574591488779, 385.06974914764106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.497179466918984, "mean_inference_ms": 6.730749256106911, "mean_action_processing_ms": 3.056199199161459, "mean_env_wait_ms": 17.831558879257067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02655625343322754, "StateBufferConnector_ms": 0.013596653938293457, "ViewRequirementAgentConnector_ms": 0.3474050760269165}, "num_episodes": 31, "episode_return_max": 499.33845351450645, "episode_return_min": -81.94310135709404, "episode_return_mean": 163.80141362690736, "episodes_this_iter": 31}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.20411600788895, "num_env_steps_trained_throughput_per_sec": 56.20411600788895, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 70534.631, "restore_workers_time_ms": 0.025, "training_step_time_ms": 70534.564, "sample_time_ms": 4567.267, "learn_time_ms": 65939.294, "learn_throughput": 60.662, "synch_weights_time_ms": 15.19}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 30, "trial_id": "62684_00000", "date": "2024-08-20_16-43-43", "timestamp": 1724152423, "time_this_iter_s": 71.21460676193237, "time_total_s": 2154.935285806656, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb01dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2154.935285806656, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 53.79009900990099, "ram_util_percent": 83.33564356435645}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.507199767548988, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.1892751746143855, "policy_loss": -0.019849977242378088, "vf_loss": 7.206263573288072, "vf_explained_var": 0.46333733141845, "kl": 0.014307895012147038, "entropy": 1.163511735369973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 86010.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.121431850377845, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.086062074590613, "policy_loss": -0.02269107199387339, "vf_loss": 8.10583022107523, "vf_explained_var": 0.21637605138556668, "kl": 0.01461449299345197, "entropy": 0.7418076846965407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000}, "env_runners": {"episode_reward_max": 705.2502206433899, "episode_reward_min": -81.94310135709404, "episode_reward_mean": 167.58478482403228, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -765.8119656613866, "predator_policy": 8.612161672089988}, "policy_reward_max": {"prey_policy": 196.39999999999998, "predator_policy": 740.1105766212676}, "policy_reward_mean": {"prey_policy": -195.61113109628647, "predator_policy": 377.20908905644603}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.88645946038258, 41.854697964834884, 79.0146791178469, 217.14271579423567, 263.08875973746063, 162.28266005742796, 404.4093825431084, 102.81153447503561, 233.97744124380168, 218.0295181788257, 45.22782439043983, 70.21904326751815, 176.1587512384282, 138.83410061682616, 117.41026760281115, 89.00400770453729, 64.72852168481455, 32.69315585710532, 87.03413854024345, -29.76062184638545, 253.22551222396015, 62.03772167215716, 238.04441454950236, 431.03364865058427, 169.6795340492526, 105.70317620473753, 130.5818914393581, 128.52000381629085, 65.33877888859567, 402.85047298772145, 35.96747426955334, 30.300000000000146, 71.51759745313066, 188.55124585641607, 135.1084024258547, 426.86939736149594, 229.3454210607241, 179.8870006778483, 73.63651387647235, 200.4112352442067, 197.77702481872493, 193.78910902771102, 188.3913667670408, 499.33845351450645, 180.34431557665565, 187.9445629208034, -34.04856167869973, 205.16327513817336, 52.27197824336736, 253.3945915181504, 139.74710279781021, 452.7125757441268, 118.13294390663779, 206.27838347378628, 98.08583762235001, 21.046376923939146, 116.12149986640499, 116.38076449221502, 157.04811639482, 332.76179263419573, 140.67816891071564, 34.09108521053589, 226.94963078178026, 178.2972213600259, 230.06245471983488, 262.6501051610772, 59.823591904394384, 183.93471361678849, 182.1948484489038, 86.59469563935443, 233.84219377107556, -81.94310135709404, 214.5999999999989, 205.72081175829675, 100.10703588691638, 164.1220247374294, 259.7341255123619, 203.4162987996431, 73.41747271910542, 38.825927634618594, 169.40750987043083, 39.46830863689526, 226.3838757649883, 430.95404481432223, 63.254739215663925, 193.78331023447896, 286.0719454810747, 195.3651507722955, 123.11862173215792, 134.9747102359588, 106.259800375894, 27.24738630997595, 705.2502206433899, 175.81411038933152, 60.69637793597842, 521.9363125500427, 227.28857588508748, 24.778671827675332, 58.013611588006114, 180.95390288393895], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-678.2169483159986, -4.003249608115766, -194.1115371377728, 20.000000000000014, -399.1631258036868, -298.15829493260634, -252.03464865363387, -6.329326440060031, -95.11631306455517, 42.62055080667098, 14.68691263114466, -475.17298800077293, -256.3607297427494, -707.4489807360047, 143.23875913903103, 19.100326903475526, -143.13372834926432, -555.6989589192151, 163.81126163527665, -616.1158853070144, -175.05951737757007, 8.907202397934673, -593.849869023456, -151.4496881315473, 20.000000000000014, -539.8424259976995, -181.40570659257807, 196.39999999999998, -502.7228674228096, -277.4878935011668, -18.048643305174814, -31.489908564229644, -581.9906502445408, -609.1247744648981, 61.85200573375671, -456.854637501081, -467.9925032077599, -260.2610927777372, 160.0864109367617, -726.7987890015661, -183.80130682581876, -169.50999299842567, -167.51412023956235, 10.465237797249861, -3.7802291466948366, -233.22879467322315, -46.386863894751144, -236.02082498987136, 17.816915047168436, -530.125815404465, -282.1463358573641, 17.09400576420938, -211.6693868532438, -378.79150062140087, -39.374358523041884, -134.48519993803862, -256.02059813232097, -740.1105766212676, -425.28728527679755, -76.8698936520982, -438.93424023001245, 58.11652130486457, -11.756466432810319, -256.2847953665597, -67.18923391745602, -342.546837408553, -86.86368056833795, 138.52650413694383, -116.90034624824702, 168.96077539736052, 81.91250037652075, -484.84079975022297, -94.59123892792172, -344.12507997554303, -318.88930419924253, -265.203981056024, -220.9196850191393, -547.3249584261854, -23.947637608098667, -275.2596181815987, -59.980822554677744, -569.6209811449044, -73.6337017706384, -272.2464939691981, -281.8550805053841, -132.5230374167493, -603.1573192458407, -485.8851592616174, 99.29840152266115, 18.847824496152864, -9.987249444475369, -216.86959665458534, 1.6183149596482098, -156.74451938307624, 20.000000000000014, -355.6477636614771, -129.47863816730745, -165.6022824975783, -206.15427777678107, 15.552716727117359, -190.18090455614973, -418.5756468108327, -353.5484014041931, -53.543539150227346, -76.08263474389682, 166.41874880331568, 43.761834293897344, -533.4385666618434, -472.3670672896569, 118.3274511928259, -142.20196119879935, -94.35697224937249, -236.11757035836234, -213.69016686878302, 20.000000000000014, -389.83506862874964, -18.079541640952577, -586.4519288562628, -337.198322245272, 115.33822049437944, -197.62876557513854, -299.1539290402599, 45.60986102960999, -504.74940673516494, 106.03611191255877, -219.26614228190994, 152.551686141962, -515.2441981521167, -356.38887636121945, 20.000000000000014, 184.41555861003746, -579.7959695811024, -14.930376715140987, -353.08110734369393, -250.14824109531045, -20.25777512500775, -147.2103970013805, 147.40836421619173, -378.4559187523446, -569.9904182288583, -106.31461286602156, -265.76290608380486, -558.3448813846509, 63.12529193268147, -213.21647012404543, -483.6391402678796, 20.000000000000014, -397.42634003483266, 62.451862521347884, 59.599999999999966, -12.791299020924802, -382.80893643193946, -91.17942082477607, -142.47228577776184, -525.8307403295291, 131.77797851387908, -582.9582202633312, -114.21751361804624, 19.03462301093578, -354.44542418183494, 141.4640685730124, -704.2111255785733, -76.30423541669369, 20.000000000000014, -444.4856812904745, -494.97868936225734, -395.1682429841459, 17.010540684528586, -257.368513365068, 20.000000000000014, -21.598333739371274, -215.28910148970988, -21.307834450621037, -282.43889100382927, -149.78842575784216, 20.000000000000014, -233.34208129182687, 117.2492990177963, -765.8119656613866, -35.69291671996878, -414.67601109400533, -466.2146828541689, 20.000000000000014, 3.994976887462703, -577.6560543043266, -323.36032791209317, -410.45256240069097, -16.9950069309229, -113.90655338986203, 20.000000000000014, 66.56017277602784, -529.8978339549974, -468.2099779553647, 87.92405989361134, 10.766182829549582, 129.8955848738505, -418.53070001032364, -132.54877947669536, 5.481519004466984, -183.62904981074638, -352.0931717606113, 172.77834222148687, -220.72777230871432, -555.698611934972, 97.20108382854288, -157.70956965672713, -518.7703475614069, 34.82745120193205, -335.95139298520246, -262.63459741516795, -418.7500884765028, -209.09581873248652, 56.09976734195768, -367.9881500906844, -152.00635042689117, -301.04913554286924, -148.55324269232884, 67.53821266296474, 10.38783832790999, -308.70039835069275, -104.93437913350357, -6.168495957417761, -83.16580861989377, -286.22443192640355, -630.9318208563602, -309.7729269047787, -177.23992913231325, -176.62213714717828, -361.9015105674638, 121.84525826010274, -343.3053816643773, 196.11629879964352, -393.14608657650757, -482.86698170144297, -440.35742786626355, -298.5299080452206, 63.369972613024046, -493.8593296719289, -376.8014262888966, 31.699999999999996, -526.8795708502902, 156.6580956693074, -668.1506495628099, -206.54392446754508, -374.08652738688204, 11.258745072708143, -49.187474701582246, -364.75035571155325, 184.87621111559577, -403.12537667052396, 175.29111332926462, 20.000000000000014, -722.4066165234597, 53.19873673230429, -292.0658011064239, -607.4399721536291, -26.580067951443553, -73.57531693488629, -412.7383858357438, -111.2724306089111, 152.03532288011624, -93.84849031525022, -368.9167109182131, 163.9069913720346, 43.829312900066604, -264.51921581042126, -38.551716184958735, -174.4359090677115, 14.365709803408404, -528.6709525410738, -409.6058154389934, -138.7573148052819, -9.26279844193876, 20.000000000000014, -426.28194183851014, -657.932917080682, 195.91595887916904, -491.5554067088029, 181.64331248215305, 82.19169173695506, -388.8595433267233, -220.07896803978628, -523.6129672229546, 34.122286665950625, -320.82863607185783, 64.99999999999997, 150.54419949208676, -510.0787811438798, -496.1645835171373, 60.36839484130023, -325.38826858304674, -580.4952005289308, 20.000000000000014, -367.7453379234512, -10.592098687515671, 13.07544589794816, -304.1740453876617, -261.12026647635963, -24.876146490288278, -45.11591831818449], "policy_predator_policy_reward": [675.9859741186609, 255.23222040360852, 401.66312580368736, 317.5129928974409, 212.29508052272118, 220.19988675337422, 253.85232136544508, 381.1559189917482, 489.42030525847633, 594.2394058187072, 674.8359804296948, 167.17903999273835, 488.13982141785704, 543.6337021745597, 494.0230676478942, 345.18082158421004, 445.5329938803163, 489.6925799537648, 503.32286742280974, 298.51741167999296, 528.2240560823068, 148.53297042207842, 464.7918884891875, 609.5545610105536, 275.86153411153924, 468.4644021756263, 492.1454004410711, 726.7987890015661, 96.27250342854991, 181.96687576326934, 405.2394343709864, 199.4010568913961, 320.21985165266835, 538.9639062468096, 372.8642093680413, 233.195828199499, 144.01322759528998, 372.9010675383555, 472.39655708251024, 740.1105766212676, 509.6708700113594, 136.12882757055925, 404.7463663428896, 323.31222202183676, 128.25529345667712, 175.0266437724671, 371.03459514128997, 293.96657748563496, 455.3566473897478, 471.92850976221524, 484.20178206714735, 654.9500186389374, 264.8188101341656, 224.95115964956858, 566.1529216366793, 477.86825906435524, 479.716896810731, 603.1573192458407, 445.1122100510264, 325.4771961794964, 233.1187559644898, 28.087249444475518, 356.44776366147715, 166.24451938307607, 259.67310916970797, 313.079686725088, 218.2479049643765, 563.5071755319046, 370.6314441270878, 247.65153359708418, 356.3378126217726, 393.7895683043514, 270.0659652626214, 455.52103309373325, 466.3293233020978, 257.72238685226773, 429.0595291609944, 32.49159498518106, 421.67133699509964, 587.051928856263, 282.8626835215548, 366.08717488295906, 422.44422874849414, 389.3243173837333, 517.3922901942917, 390.080464944123, 382.92633666220905, 491.7925278233605, 505.575769976271, 292.9282707545312, 39.86517493517712, 168.13919589582346, 574.9615326941846, 445.75085547433974, 416.96644395619956, 549.1793267177484, 349.42313188974225, 379.70445674555054, 344.024465520806, 184.74460351083007, 241.81782264351182, 384.7089364319394, 475.26587018232806, 513.9717531552101, 213.01583451374887, 583.2582202633313, 728.7757324766218, 394.69513218455967, 452.5040859770539, 146.37166835246623, 496.61452560166794, 397.56824298414585, 82.61907221841975, 292.4692747524258, 385.20758556497805, 250.2090058713991, 38.02126939126318, 482.15735405322675, 475.2985718471103, 541.7188041506436, 373.7516828876853, 627.8171799712065, 577.6560543043266, 353.456436235166, 420.4559821481251, 347.84777135513144, 360.5739260883845, 261.06095645061134, 242.43058342612292, 357.15160652591794, 283.0887305914333, 400.74526918281185, 208.97112271067323, 381.0931717606113, 556.5271232369495, 231.05563240203827, 369.47213741121715, 392.0015444272786, 340.22234621402214, 310.1308886237722, 276.25878765717573, 529.3295459809326, 338.4684609533061, 400.6320737500452, 276.61503002936405, 8.612161672089988, 307.1443080511658, 318.3797771487446, 630.1120127922538, 470.3170844973203, 516.3017790925198, 311.4552388291796, 361.3700763318239, 481.72568315227693, 483.3669817014431, 399.9460865765091, 446.17001500341564, 302.76482101415064, 381.0958146284178, 496.69086896702635, 528.6337102299926, 679.1459243842313, 181.29271610312452, 427.5472993154889, 70.37574591488779, 385.06974914764106, 360.10223223525065, 278.686075920331, 722.4066165234597, 302.1218035897848, 489.0814507506515, 412.29721652378777, 361.48588087063615, 296.56155817497734, 362.1325325510735, 132.09082808265163, 64.51225922763736, 317.84798159983706, 528.6709525410738, 295.04490950026246, 226.77570850553423, 437.1100205565749, 433.6627943953059, 657.7994508338621, 426.39789631136836, 392.8484596795025, 278.41192791519825, 424.1490021036883, 523.2428568208157, 347.7728377440257, 457.124550049638, 359.34634415219665, 663.2690282187029, 325.20400492526835, 371.2666414869456, 581.7525687931131, 25.82725187079219, 333.8770578944441, 83.07555550355254, 428.9906786652195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.457616852349249, "mean_inference_ms": 6.727651923711647, "mean_action_processing_ms": 3.109526003601408, "mean_env_wait_ms": 17.82040841764314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020029783248901367, "StateBufferConnector_ms": 0.012959003448486328, "ViewRequirementAgentConnector_ms": 0.33461737632751465}, "num_episodes": 17, "episode_return_max": 705.2502206433899, "episode_return_min": -81.94310135709404, "episode_return_mean": 167.58478482403228, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.98963972803876, "num_env_steps_trained_throughput_per_sec": 56.98963972803876, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 620000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 620000, "timers": {"training_iteration_time_ms": 70653.827, "restore_workers_time_ms": 0.025, "training_step_time_ms": 70653.76, "sample_time_ms": 4563.715, "learn_time_ms": 66063.266, "learn_throughput": 60.548, "synch_weights_time_ms": 14.943}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000}, "done": false, "training_iteration": 31, "trial_id": "62684_00000", "date": "2024-08-20_16-44-53", "timestamp": 1724152493, "time_this_iter_s": 70.2406210899353, "time_total_s": 2225.175906896591, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffae670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2225.175906896591, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 54.981, "ram_util_percent": 83.23800000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.593248453503804, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.1838548849660455, "policy_loss": -0.02092320916758097, "vf_loss": 7.202007166375505, "vf_explained_var": 0.48406828542550406, "kl": 0.013854688014636966, "entropy": 1.1652863292829365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 88830.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.412759213409727, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.761738414108438, "policy_loss": -0.018075570124620327, "vf_loss": 7.77730632660881, "vf_explained_var": 0.29958037573193746, "kl": 0.012538243335716072, "entropy": 0.7664872111151458, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 705.2502206433899, "episode_reward_min": -81.94310135709404, "episode_reward_mean": 168.33074440062137, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -765.8119656613866, "predator_policy": 8.612161672089988}, "policy_reward_max": {"prey_policy": 196.11629879964352, "predator_policy": 796.9316877195528}, "policy_reward_mean": {"prey_policy": -191.3082943224679, "predator_policy": 371.1278136840127}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.00400770453729, 64.72852168481455, 32.69315585710532, 87.03413854024345, -29.76062184638545, 253.22551222396015, 62.03772167215716, 238.04441454950236, 431.03364865058427, 169.6795340492526, 105.70317620473753, 130.5818914393581, 128.52000381629085, 65.33877888859567, 402.85047298772145, 35.96747426955334, 30.300000000000146, 71.51759745313066, 188.55124585641607, 135.1084024258547, 426.86939736149594, 229.3454210607241, 179.8870006778483, 73.63651387647235, 200.4112352442067, 197.77702481872493, 193.78910902771102, 188.3913667670408, 499.33845351450645, 180.34431557665565, 187.9445629208034, -34.04856167869973, 205.16327513817336, 52.27197824336736, 253.3945915181504, 139.74710279781021, 452.7125757441268, 118.13294390663779, 206.27838347378628, 98.08583762235001, 21.046376923939146, 116.12149986640499, 116.38076449221502, 157.04811639482, 332.76179263419573, 140.67816891071564, 34.09108521053589, 226.94963078178026, 178.2972213600259, 230.06245471983488, 262.6501051610772, 59.823591904394384, 183.93471361678849, 182.1948484489038, 86.59469563935443, 233.84219377107556, -81.94310135709404, 214.5999999999989, 205.72081175829675, 100.10703588691638, 164.1220247374294, 259.7341255123619, 203.4162987996431, 73.41747271910542, 38.825927634618594, 169.40750987043083, 39.46830863689526, 226.3838757649883, 430.95404481432223, 63.254739215663925, 193.78331023447896, 286.0719454810747, 195.3651507722955, 123.11862173215792, 134.9747102359588, 106.259800375894, 27.24738630997595, 705.2502206433899, 175.81411038933152, 60.69637793597842, 521.9363125500427, 227.28857588508748, 24.778671827675332, 58.013611588006114, 180.95390288393895, 63.04453300762394, 240.6682630449338, 51.49426803581369, 36.90000000000009, 130.68614877769022, 328.6067575156943, 197.45989520259673, 222.9570823557362, 93.33247949578126, 200.69672427100159, 127.96469179880074, 348.1330510548571, 58.29307287602752, 46.97506478990532, 252.73176112142633], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-233.22879467322315, -46.386863894751144, -236.02082498987136, 17.816915047168436, -530.125815404465, -282.1463358573641, 17.09400576420938, -211.6693868532438, -378.79150062140087, -39.374358523041884, -134.48519993803862, -256.02059813232097, -740.1105766212676, -425.28728527679755, -76.8698936520982, -438.93424023001245, 58.11652130486457, -11.756466432810319, -256.2847953665597, -67.18923391745602, -342.546837408553, -86.86368056833795, 138.52650413694383, -116.90034624824702, 168.96077539736052, 81.91250037652075, -484.84079975022297, -94.59123892792172, -344.12507997554303, -318.88930419924253, -265.203981056024, -220.9196850191393, -547.3249584261854, -23.947637608098667, -275.2596181815987, -59.980822554677744, -569.6209811449044, -73.6337017706384, -272.2464939691981, -281.8550805053841, -132.5230374167493, -603.1573192458407, -485.8851592616174, 99.29840152266115, 18.847824496152864, -9.987249444475369, -216.86959665458534, 1.6183149596482098, -156.74451938307624, 20.000000000000014, -355.6477636614771, -129.47863816730745, -165.6022824975783, -206.15427777678107, 15.552716727117359, -190.18090455614973, -418.5756468108327, -353.5484014041931, -53.543539150227346, -76.08263474389682, 166.41874880331568, 43.761834293897344, -533.4385666618434, -472.3670672896569, 118.3274511928259, -142.20196119879935, -94.35697224937249, -236.11757035836234, -213.69016686878302, 20.000000000000014, -389.83506862874964, -18.079541640952577, -586.4519288562628, -337.198322245272, 115.33822049437944, -197.62876557513854, -299.1539290402599, 45.60986102960999, -504.74940673516494, 106.03611191255877, -219.26614228190994, 152.551686141962, -515.2441981521167, -356.38887636121945, 20.000000000000014, 184.41555861003746, -579.7959695811024, -14.930376715140987, -353.08110734369393, -250.14824109531045, -20.25777512500775, -147.2103970013805, 147.40836421619173, -378.4559187523446, -569.9904182288583, -106.31461286602156, -265.76290608380486, -558.3448813846509, 63.12529193268147, -213.21647012404543, -483.6391402678796, 20.000000000000014, -397.42634003483266, 62.451862521347884, 59.599999999999966, -12.791299020924802, -382.80893643193946, -91.17942082477607, -142.47228577776184, -525.8307403295291, 131.77797851387908, -582.9582202633312, -114.21751361804624, 19.03462301093578, -354.44542418183494, 141.4640685730124, -704.2111255785733, -76.30423541669369, 20.000000000000014, -444.4856812904745, -494.97868936225734, -395.1682429841459, 17.010540684528586, -257.368513365068, 20.000000000000014, -21.598333739371274, -215.28910148970988, -21.307834450621037, -282.43889100382927, -149.78842575784216, 20.000000000000014, -233.34208129182687, 117.2492990177963, -765.8119656613866, -35.69291671996878, -414.67601109400533, -466.2146828541689, 20.000000000000014, 3.994976887462703, -577.6560543043266, -323.36032791209317, -410.45256240069097, -16.9950069309229, -113.90655338986203, 20.000000000000014, 66.56017277602784, -529.8978339549974, -468.2099779553647, 87.92405989361134, 10.766182829549582, 129.8955848738505, -418.53070001032364, -132.54877947669536, 5.481519004466984, -183.62904981074638, -352.0931717606113, 172.77834222148687, -220.72777230871432, -555.698611934972, 97.20108382854288, -157.70956965672713, -518.7703475614069, 34.82745120193205, -335.95139298520246, -262.63459741516795, -418.7500884765028, -209.09581873248652, 56.09976734195768, -367.9881500906844, -152.00635042689117, -301.04913554286924, -148.55324269232884, 67.53821266296474, 10.38783832790999, -308.70039835069275, -104.93437913350357, -6.168495957417761, -83.16580861989377, -286.22443192640355, -630.9318208563602, -309.7729269047787, -177.23992913231325, -176.62213714717828, -361.9015105674638, 121.84525826010274, -343.3053816643773, 196.11629879964352, -393.14608657650757, -482.86698170144297, -440.35742786626355, -298.5299080452206, 63.369972613024046, -493.8593296719289, -376.8014262888966, 31.699999999999996, -526.8795708502902, 156.6580956693074, -668.1506495628099, -206.54392446754508, -374.08652738688204, 11.258745072708143, -49.187474701582246, -364.75035571155325, 184.87621111559577, -403.12537667052396, 175.29111332926462, 20.000000000000014, -722.4066165234597, 53.19873673230429, -292.0658011064239, -607.4399721536291, -26.580067951443553, -73.57531693488629, -412.7383858357438, -111.2724306089111, 152.03532288011624, -93.84849031525022, -368.9167109182131, 163.9069913720346, 43.829312900066604, -264.51921581042126, -38.551716184958735, -174.4359090677115, 14.365709803408404, -528.6709525410738, -409.6058154389934, -138.7573148052819, -9.26279844193876, 20.000000000000014, -426.28194183851014, -657.932917080682, 195.91595887916904, -491.5554067088029, 181.64331248215305, 82.19169173695506, -388.8595433267233, -220.07896803978628, -523.6129672229546, 34.122286665950625, -320.82863607185783, 64.99999999999997, 150.54419949208676, -510.0787811438798, -496.1645835171373, 60.36839484130023, -325.38826858304674, -580.4952005289308, 20.000000000000014, -367.7453379234512, -10.592098687515671, 13.07544589794816, -304.1740453876617, -261.12026647635963, -24.876146490288278, -45.11591831818449, -352.122391055193, 20.81144898911465, -376.56347662894433, -397.2260823687245, -240.8187205154939, 125.70988309957424, 20.000000000000014, -455.8266007215875, -622.2323293249086, -389.3924082126322, -531.8208317854171, 20.000000000000014, -548.0151843206002, 75.74881662022574, -205.88043917034375, -132.31924744145593, -396.46127219908885, 17.544038338959275, -187.67763918986228, -214.29586921726514, -163.1909686748465, -1.274421702814113, -399.30679469806637, 75.87457702603919, -211.6481503626139, -219.15227190054344, -266.4817986785444, 193.63059291586612, -265.35925182461733, -339.56061616100925, -8.374061406070817, 99.98685028809695, -714.8116369152683, -160.20613678501311, 90.3704937101142, -398.12021706574717, -457.0221032766286, 20.000000000000014, 20.000000000000014, -38.7856406112375, -422.92373115594347, 16.841393373435984, -467.8500927201538, 20.000000000000014, 140.17266052031434], "policy_predator_policy_reward": [405.2394343709864, 199.4010568913961, 320.21985165266835, 538.9639062468096, 372.8642093680413, 233.195828199499, 144.01322759528998, 372.9010675383555, 472.39655708251024, 740.1105766212676, 509.6708700113594, 136.12882757055925, 404.7463663428896, 323.31222202183676, 128.25529345667712, 175.0266437724671, 371.03459514128997, 293.96657748563496, 455.3566473897478, 471.92850976221524, 484.20178206714735, 654.9500186389374, 264.8188101341656, 224.95115964956858, 566.1529216366793, 477.86825906435524, 479.716896810731, 603.1573192458407, 445.1122100510264, 325.4771961794964, 233.1187559644898, 28.087249444475518, 356.44776366147715, 166.24451938307607, 259.67310916970797, 313.079686725088, 218.2479049643765, 563.5071755319046, 370.6314441270878, 247.65153359708418, 356.3378126217726, 393.7895683043514, 270.0659652626214, 455.52103309373325, 466.3293233020978, 257.72238685226773, 429.0595291609944, 32.49159498518106, 421.67133699509964, 587.051928856263, 282.8626835215548, 366.08717488295906, 422.44422874849414, 389.3243173837333, 517.3922901942917, 390.080464944123, 382.92633666220905, 491.7925278233605, 505.575769976271, 292.9282707545312, 39.86517493517712, 168.13919589582346, 574.9615326941846, 445.75085547433974, 416.96644395619956, 549.1793267177484, 349.42313188974225, 379.70445674555054, 344.024465520806, 184.74460351083007, 241.81782264351182, 384.7089364319394, 475.26587018232806, 513.9717531552101, 213.01583451374887, 583.2582202633313, 728.7757324766218, 394.69513218455967, 452.5040859770539, 146.37166835246623, 496.61452560166794, 397.56824298414585, 82.61907221841975, 292.4692747524258, 385.20758556497805, 250.2090058713991, 38.02126939126318, 482.15735405322675, 475.2985718471103, 541.7188041506436, 373.7516828876853, 627.8171799712065, 577.6560543043266, 353.456436235166, 420.4559821481251, 347.84777135513144, 360.5739260883845, 261.06095645061134, 242.43058342612292, 357.15160652591794, 283.0887305914333, 400.74526918281185, 208.97112271067323, 381.0931717606113, 556.5271232369495, 231.05563240203827, 369.47213741121715, 392.0015444272786, 340.22234621402214, 310.1308886237722, 276.25878765717573, 529.3295459809326, 338.4684609533061, 400.6320737500452, 276.61503002936405, 8.612161672089988, 307.1443080511658, 318.3797771487446, 630.1120127922538, 470.3170844973203, 516.3017790925198, 311.4552388291796, 361.3700763318239, 481.72568315227693, 483.3669817014431, 399.9460865765091, 446.17001500341564, 302.76482101415064, 381.0958146284178, 496.69086896702635, 528.6337102299926, 679.1459243842313, 181.29271610312452, 427.5472993154889, 70.37574591488779, 385.06974914764106, 360.10223223525065, 278.686075920331, 722.4066165234597, 302.1218035897848, 489.0814507506515, 412.29721652378777, 361.48588087063615, 296.56155817497734, 362.1325325510735, 132.09082808265163, 64.51225922763736, 317.84798159983706, 528.6709525410738, 295.04490950026246, 226.77570850553423, 437.1100205565749, 433.6627943953059, 657.7994508338621, 426.39789631136836, 392.8484596795025, 278.41192791519825, 424.1490021036883, 523.2428568208157, 347.7728377440257, 457.124550049638, 359.34634415219665, 663.2690282187029, 325.20400492526835, 371.2666414869456, 581.7525687931131, 25.82725187079219, 333.8770578944441, 83.07555550355254, 428.9906786652195, 377.008009636568, 393.91094206607846, 322.4104492423691, 430.592733587209, 796.9316877195528, 312.6215103627563, 532.3208317854171, 405.79240821263295, 544.319984584183, 264.51297106422544, 461.10907869201566, 378.7341601252631, 310.86976889912796, 451.754603385443, 398.99074385761503, 148.67297787296494, 306.59453916198237, 484.02016127550246, 268.8763834741321, 343.10961586663205, 36.35190291677494, 714.8116369152683, 276.52565147327766, 539.563259722223, 368.56400261248996, 106.75117354016608, 121.96523176572528, 369.877811417925, 112.71278457236721, 447.6964087488994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.485752459487653, "mean_inference_ms": 6.724059882862625, "mean_action_processing_ms": 3.0285401059274504, "mean_env_wait_ms": 17.797681434179964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05902540683746338, "StateBufferConnector_ms": 0.012856245040893555, "ViewRequirementAgentConnector_ms": 0.35749638080596924}, "num_episodes": 15, "episode_return_max": 705.2502206433899, "episode_return_min": -81.94310135709404, "episode_return_mean": 168.33074440062137, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 59.18306717099571, "num_env_steps_trained_throughput_per_sec": 59.18306717099571, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 70130.577, "restore_workers_time_ms": 0.025, "training_step_time_ms": 70130.51, "sample_time_ms": 4432.889, "learn_time_ms": 65671.34, "learn_throughput": 60.909, "synch_weights_time_ms": 15.255}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 32, "trial_id": "62684_00000", "date": "2024-08-20_16-46-01", "timestamp": 1724152561, "time_this_iter_s": 67.62453103065491, "time_total_s": 2292.800437927246, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffaf040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2292.800437927246, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 50.91770833333333, "ram_util_percent": 82.41979166666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.095279657925275, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.170740783299115, "policy_loss": -0.02308179296120499, "vf_loss": 7.190803351977193, "vf_explained_var": 0.4567324427425439, "kl": 0.015096080571690455, "entropy": 1.1601368311871874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 91650.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.043247509570349, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.516655515489124, "policy_loss": -0.019059296223586278, "vf_loss": 7.533401458225553, "vf_explained_var": 0.18851284977620242, "kl": 0.011566767890853856, "entropy": 0.793320758632882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "env_runners": {"episode_reward_max": 705.2502206433899, "episode_reward_min": -81.94310135709404, "episode_reward_mean": 177.84458227728896, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -765.8119656613866, "predator_policy": 8.612161672089988}, "policy_reward_max": {"prey_policy": 196.11629879964352, "predator_policy": 796.9316877195528}, "policy_reward_mean": {"prey_policy": -190.33779191318607, "predator_policy": 374.42897900842377}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.63651387647235, 200.4112352442067, 197.77702481872493, 193.78910902771102, 188.3913667670408, 499.33845351450645, 180.34431557665565, 187.9445629208034, -34.04856167869973, 205.16327513817336, 52.27197824336736, 253.3945915181504, 139.74710279781021, 452.7125757441268, 118.13294390663779, 206.27838347378628, 98.08583762235001, 21.046376923939146, 116.12149986640499, 116.38076449221502, 157.04811639482, 332.76179263419573, 140.67816891071564, 34.09108521053589, 226.94963078178026, 178.2972213600259, 230.06245471983488, 262.6501051610772, 59.823591904394384, 183.93471361678849, 182.1948484489038, 86.59469563935443, 233.84219377107556, -81.94310135709404, 214.5999999999989, 205.72081175829675, 100.10703588691638, 164.1220247374294, 259.7341255123619, 203.4162987996431, 73.41747271910542, 38.825927634618594, 169.40750987043083, 39.46830863689526, 226.3838757649883, 430.95404481432223, 63.254739215663925, 193.78331023447896, 286.0719454810747, 195.3651507722955, 123.11862173215792, 134.9747102359588, 106.259800375894, 27.24738630997595, 705.2502206433899, 175.81411038933152, 60.69637793597842, 521.9363125500427, 227.28857588508748, 24.778671827675332, 58.013611588006114, 180.95390288393895, 63.04453300762394, 240.6682630449338, 51.49426803581369, 36.90000000000009, 130.68614877769022, 328.6067575156943, 197.45989520259673, 222.9570823557362, 93.33247949578126, 200.69672427100159, 127.96469179880074, 348.1330510548571, 58.29307287602752, 46.97506478990532, 252.73176112142633, 151.0938306343052, 225.30963896310325, 437.86496620002555, 437.81083470929974, 164.50309768346028, 81.87724684536553, 108.77283390829817, 32.813794704276674, 171.41124803074584, 12.415132173785015, 239.66964194666912, 144.70840211163892, 194.80925814877128, 358.2305792680658, 136.04283248692198, 170.6755435964139, 208.2873794099049, 170.7163306792763, 138.22356734596897, 77.84474382280794, 423.7064685989113, 166.43696144006296, 226.42035048618322], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [20.000000000000014, -389.83506862874964, -18.079541640952577, -586.4519288562628, -337.198322245272, 115.33822049437944, -197.62876557513854, -299.1539290402599, 45.60986102960999, -504.74940673516494, 106.03611191255877, -219.26614228190994, 152.551686141962, -515.2441981521167, -356.38887636121945, 20.000000000000014, 184.41555861003746, -579.7959695811024, -14.930376715140987, -353.08110734369393, -250.14824109531045, -20.25777512500775, -147.2103970013805, 147.40836421619173, -378.4559187523446, -569.9904182288583, -106.31461286602156, -265.76290608380486, -558.3448813846509, 63.12529193268147, -213.21647012404543, -483.6391402678796, 20.000000000000014, -397.42634003483266, 62.451862521347884, 59.599999999999966, -12.791299020924802, -382.80893643193946, -91.17942082477607, -142.47228577776184, -525.8307403295291, 131.77797851387908, -582.9582202633312, -114.21751361804624, 19.03462301093578, -354.44542418183494, 141.4640685730124, -704.2111255785733, -76.30423541669369, 20.000000000000014, -444.4856812904745, -494.97868936225734, -395.1682429841459, 17.010540684528586, -257.368513365068, 20.000000000000014, -21.598333739371274, -215.28910148970988, -21.307834450621037, -282.43889100382927, -149.78842575784216, 20.000000000000014, -233.34208129182687, 117.2492990177963, -765.8119656613866, -35.69291671996878, -414.67601109400533, -466.2146828541689, 20.000000000000014, 3.994976887462703, -577.6560543043266, -323.36032791209317, -410.45256240069097, -16.9950069309229, -113.90655338986203, 20.000000000000014, 66.56017277602784, -529.8978339549974, -468.2099779553647, 87.92405989361134, 10.766182829549582, 129.8955848738505, -418.53070001032364, -132.54877947669536, 5.481519004466984, -183.62904981074638, -352.0931717606113, 172.77834222148687, -220.72777230871432, -555.698611934972, 97.20108382854288, -157.70956965672713, -518.7703475614069, 34.82745120193205, -335.95139298520246, -262.63459741516795, -418.7500884765028, -209.09581873248652, 56.09976734195768, -367.9881500906844, -152.00635042689117, -301.04913554286924, -148.55324269232884, 67.53821266296474, 10.38783832790999, -308.70039835069275, -104.93437913350357, -6.168495957417761, -83.16580861989377, -286.22443192640355, -630.9318208563602, -309.7729269047787, -177.23992913231325, -176.62213714717828, -361.9015105674638, 121.84525826010274, -343.3053816643773, 196.11629879964352, -393.14608657650757, -482.86698170144297, -440.35742786626355, -298.5299080452206, 63.369972613024046, -493.8593296719289, -376.8014262888966, 31.699999999999996, -526.8795708502902, 156.6580956693074, -668.1506495628099, -206.54392446754508, -374.08652738688204, 11.258745072708143, -49.187474701582246, -364.75035571155325, 184.87621111559577, -403.12537667052396, 175.29111332926462, 20.000000000000014, -722.4066165234597, 53.19873673230429, -292.0658011064239, -607.4399721536291, -26.580067951443553, -73.57531693488629, -412.7383858357438, -111.2724306089111, 152.03532288011624, -93.84849031525022, -368.9167109182131, 163.9069913720346, 43.829312900066604, -264.51921581042126, -38.551716184958735, -174.4359090677115, 14.365709803408404, -528.6709525410738, -409.6058154389934, -138.7573148052819, -9.26279844193876, 20.000000000000014, -426.28194183851014, -657.932917080682, 195.91595887916904, -491.5554067088029, 181.64331248215305, 82.19169173695506, -388.8595433267233, -220.07896803978628, -523.6129672229546, 34.122286665950625, -320.82863607185783, 64.99999999999997, 150.54419949208676, -510.0787811438798, -496.1645835171373, 60.36839484130023, -325.38826858304674, -580.4952005289308, 20.000000000000014, -367.7453379234512, -10.592098687515671, 13.07544589794816, -304.1740453876617, -261.12026647635963, -24.876146490288278, -45.11591831818449, -352.122391055193, 20.81144898911465, -376.56347662894433, -397.2260823687245, -240.8187205154939, 125.70988309957424, 20.000000000000014, -455.8266007215875, -622.2323293249086, -389.3924082126322, -531.8208317854171, 20.000000000000014, -548.0151843206002, 75.74881662022574, -205.88043917034375, -132.31924744145593, -396.46127219908885, 17.544038338959275, -187.67763918986228, -214.29586921726514, -163.1909686748465, -1.274421702814113, -399.30679469806637, 75.87457702603919, -211.6481503626139, -219.15227190054344, -266.4817986785444, 193.63059291586612, -265.35925182461733, -339.56061616100925, -8.374061406070817, 99.98685028809695, -714.8116369152683, -160.20613678501311, 90.3704937101142, -398.12021706574717, -457.0221032766286, 20.000000000000014, 20.000000000000014, -38.7856406112375, -422.92373115594347, 16.841393373435984, -467.8500927201538, 20.000000000000014, 140.17266052031434, -20.405905372128494, -324.69651991235355, -186.40657153728117, 40.18499161721368, -378.1761587706334, 16.119940809632507, -313.8501390942448, 185.6231424449984, 18.76775125001943, 8.804289943946422, 107.88120693782449, -378.0785643084179, -120.73086251280591, -154.59924038655964, -171.3746839162659, -306.7869782789516, -46.24458604110984, -202.85397112435803, 88.25223755037372, -126.2484417204264, -546.7706052802638, -340.4432517956414, -91.72689568509128, -563.1512784412282, 169.21124803074594, -423.5974906840663, -383.2238708331233, -26.723500625279254, -89.23899494227877, -534.948649010123, -121.00268464734853, -290.70011576709356, -45.349696945079025, -600.7527205654334, 39.870344792126176, -91.41256011027542, -449.6603384900735, -625.1243603024604, 156.58243010405647, 161.04212287864337, -279.4607186596067, -498.24535741932004, 123.84283248692242, -498.9625806555664, -146.06975269161762, 151.41286547123212, -644.5166242339925, -336.7859527783453, -549.2630610246653, 68.59999999999997, -18.93927807768435, -423.8160968190953, 8.828092150204316, -245.81208739700907, 11.05388230214814, -189.06874435342596, -81.80214437752991, 13.469229920577604, -314.2499932587263, -360.79349725279906, -168.9185923946551, 43.10577784048688, -140.40752777469507, -234.1707804136747, -352.3295702548629, 15.727024620308066, -210.38005593652275, -363.60746184118653, -148.6823521290941], "policy_predator_policy_reward": [429.0595291609944, 32.49159498518106, 421.67133699509964, 587.051928856263, 282.8626835215548, 366.08717488295906, 422.44422874849414, 389.3243173837333, 517.3922901942917, 390.080464944123, 382.92633666220905, 491.7925278233605, 505.575769976271, 292.9282707545312, 39.86517493517712, 168.13919589582346, 574.9615326941846, 445.75085547433974, 416.96644395619956, 549.1793267177484, 349.42313188974225, 379.70445674555054, 344.024465520806, 184.74460351083007, 241.81782264351182, 384.7089364319394, 475.26587018232806, 513.9717531552101, 213.01583451374887, 583.2582202633313, 728.7757324766218, 394.69513218455967, 452.5040859770539, 146.37166835246623, 496.61452560166794, 397.56824298414585, 82.61907221841975, 292.4692747524258, 385.20758556497805, 250.2090058713991, 38.02126939126318, 482.15735405322675, 475.2985718471103, 541.7188041506436, 373.7516828876853, 627.8171799712065, 577.6560543043266, 353.456436235166, 420.4559821481251, 347.84777135513144, 360.5739260883845, 261.06095645061134, 242.43058342612292, 357.15160652591794, 283.0887305914333, 400.74526918281185, 208.97112271067323, 381.0931717606113, 556.5271232369495, 231.05563240203827, 369.47213741121715, 392.0015444272786, 340.22234621402214, 310.1308886237722, 276.25878765717573, 529.3295459809326, 338.4684609533061, 400.6320737500452, 276.61503002936405, 8.612161672089988, 307.1443080511658, 318.3797771487446, 630.1120127922538, 470.3170844973203, 516.3017790925198, 311.4552388291796, 361.3700763318239, 481.72568315227693, 483.3669817014431, 399.9460865765091, 446.17001500341564, 302.76482101415064, 381.0958146284178, 496.69086896702635, 528.6337102299926, 679.1459243842313, 181.29271610312452, 427.5472993154889, 70.37574591488779, 385.06974914764106, 360.10223223525065, 278.686075920331, 722.4066165234597, 302.1218035897848, 489.0814507506515, 412.29721652378777, 361.48588087063615, 296.56155817497734, 362.1325325510735, 132.09082808265163, 64.51225922763736, 317.84798159983706, 528.6709525410738, 295.04490950026246, 226.77570850553423, 437.1100205565749, 433.6627943953059, 657.7994508338621, 426.39789631136836, 392.8484596795025, 278.41192791519825, 424.1490021036883, 523.2428568208157, 347.7728377440257, 457.124550049638, 359.34634415219665, 663.2690282187029, 325.20400492526835, 371.2666414869456, 581.7525687931131, 25.82725187079219, 333.8770578944441, 83.07555550355254, 428.9906786652195, 377.008009636568, 393.91094206607846, 322.4104492423691, 430.592733587209, 796.9316877195528, 312.6215103627563, 532.3208317854171, 405.79240821263295, 544.319984584183, 264.51297106422544, 461.10907869201566, 378.7341601252631, 310.86976889912796, 451.754603385443, 398.99074385761503, 148.67297787296494, 306.59453916198237, 484.02016127550246, 268.8763834741321, 343.10961586663205, 36.35190291677494, 714.8116369152683, 276.52565147327766, 539.563259722223, 368.56400261248996, 106.75117354016608, 121.96523176572528, 369.877811417925, 112.71278457236721, 447.6964087488994, 356.60630754371573, 325.9965199123535, 142.7625441590219, 404.4183211478698, 258.1660123429593, 289.15819925629324, 372.15734128610404, 327.046560849843, 418.0035510183016, 193.20433348079058, 247.46522561319455, 390.29755667659094, 146.3690380783507, 547.1706052802639, 563.1512784412282, 464.9839421850111, 385.0238708331236, 423.9974906840664, 559.7872818091873, 103.53899494227893, 357.26174269859854, 339.46039660759106, 194.25061742978815, 602.7527205654333, 487.8871665347883, 625.1243603024604, 479.40573557362336, 495.48879689472545, 498.9625806555664, 158.26975269161701, 354.9486309035273, 645.6166242339924, 156.32665748758984, 551.5630610246658, 597.4121864906302, 234.10423625454587, 248.5637438420461, 149.4768299327304, 378.5366806931579, 360.8823237205989, 352.377053931091, 337.549756996682, 85.68680198073925, 651.5234855075548, 472.3888870048888, 476.70133338809717]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.405892036799834, "mean_inference_ms": 6.690048051635747, "mean_action_processing_ms": 3.0438663147799887, "mean_env_wait_ms": 17.75148947452861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06887447834014893, "StateBufferConnector_ms": 0.00854790210723877, "ViewRequirementAgentConnector_ms": 0.3620821237564087}, "num_episodes": 23, "episode_return_max": 705.2502206433899, "episode_return_min": -81.94310135709404, "episode_return_mean": 177.84458227728896, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 59.461665670748864, "num_env_steps_trained_throughput_per_sec": 59.461665670748864, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 660000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 69871.867, "restore_workers_time_ms": 0.025, "training_step_time_ms": 69871.799, "sample_time_ms": 4404.85, "learn_time_ms": 65440.895, "learn_throughput": 61.124, "synch_weights_time_ms": 15.393}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "training_iteration": 33, "trial_id": "62684_00000", "date": "2024-08-20_16-47-08", "timestamp": 1724152628, "time_this_iter_s": 67.31984090805054, "time_total_s": 2360.1202788352966, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffa6f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2360.1202788352966, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 50.01157894736843, "ram_util_percent": 83.1421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.979302106343262, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.1842069813545715, "policy_loss": -0.019657332650369286, "vf_loss": 7.201288361075922, "vf_explained_var": 0.5341454439129389, "kl": 0.012879721038142576, "entropy": 1.143177169180931, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 94470.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.0463115994261685, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.886655905133202, "policy_loss": -0.01926824103587519, "vf_loss": 7.903499478133267, "vf_explained_var": 0.2071573345434098, "kl": 0.01212334444921306, "entropy": 0.7419678332313658, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "env_runners": {"episode_reward_max": 705.2502206433899, "episode_reward_min": -81.94310135709404, "episode_reward_mean": 178.45729207608738, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -765.8119656613866, "predator_policy": 8.612161672089988}, "policy_reward_max": {"prey_policy": 196.11629879964352, "predator_policy": 796.9316877195528}, "policy_reward_mean": {"prey_policy": -188.13366910633297, "predator_policy": 371.4291496975433}, "custom_metrics": {}, "hist_stats": {"episode_reward": [157.04811639482, 332.76179263419573, 140.67816891071564, 34.09108521053589, 226.94963078178026, 178.2972213600259, 230.06245471983488, 262.6501051610772, 59.823591904394384, 183.93471361678849, 182.1948484489038, 86.59469563935443, 233.84219377107556, -81.94310135709404, 214.5999999999989, 205.72081175829675, 100.10703588691638, 164.1220247374294, 259.7341255123619, 203.4162987996431, 73.41747271910542, 38.825927634618594, 169.40750987043083, 39.46830863689526, 226.3838757649883, 430.95404481432223, 63.254739215663925, 193.78331023447896, 286.0719454810747, 195.3651507722955, 123.11862173215792, 134.9747102359588, 106.259800375894, 27.24738630997595, 705.2502206433899, 175.81411038933152, 60.69637793597842, 521.9363125500427, 227.28857588508748, 24.778671827675332, 58.013611588006114, 180.95390288393895, 63.04453300762394, 240.6682630449338, 51.49426803581369, 36.90000000000009, 130.68614877769022, 328.6067575156943, 197.45989520259673, 222.9570823557362, 93.33247949578126, 200.69672427100159, 127.96469179880074, 348.1330510548571, 58.29307287602752, 46.97506478990532, 252.73176112142633, 151.0938306343052, 225.30963896310325, 437.86496620002555, 437.81083470929974, 164.50309768346028, 81.87724684536553, 108.77283390829817, 32.813794704276674, 171.41124803074584, 12.415132173785015, 239.66964194666912, 144.70840211163892, 194.80925814877128, 358.2305792680658, 136.04283248692198, 170.6755435964139, 208.2873794099049, 170.7163306792763, 138.22356734596897, 77.84474382280794, 423.7064685989113, 166.43696144006296, 226.42035048618322, 403.561623785607, 167.51767777310505, 229.6721927343113, 108.46505248200323, 120.28344888276712, 206.23802418626445, 291.16433036234383, 152.44787438008757, 77.02307217186231, 121.80902859120246, 101.6441059863894, 180.75041393860948, 128.0861512284203, 133.81168994802886, 118.07315857153826, 269.08378633692473, 93.05946189533476, 342.09552797355065, 156.00937035293506, 127.39433809293716], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-149.78842575784216, 20.000000000000014, -233.34208129182687, 117.2492990177963, -765.8119656613866, -35.69291671996878, -414.67601109400533, -466.2146828541689, 20.000000000000014, 3.994976887462703, -577.6560543043266, -323.36032791209317, -410.45256240069097, -16.9950069309229, -113.90655338986203, 20.000000000000014, 66.56017277602784, -529.8978339549974, -468.2099779553647, 87.92405989361134, 10.766182829549582, 129.8955848738505, -418.53070001032364, -132.54877947669536, 5.481519004466984, -183.62904981074638, -352.0931717606113, 172.77834222148687, -220.72777230871432, -555.698611934972, 97.20108382854288, -157.70956965672713, -518.7703475614069, 34.82745120193205, -335.95139298520246, -262.63459741516795, -418.7500884765028, -209.09581873248652, 56.09976734195768, -367.9881500906844, -152.00635042689117, -301.04913554286924, -148.55324269232884, 67.53821266296474, 10.38783832790999, -308.70039835069275, -104.93437913350357, -6.168495957417761, -83.16580861989377, -286.22443192640355, -630.9318208563602, -309.7729269047787, -177.23992913231325, -176.62213714717828, -361.9015105674638, 121.84525826010274, -343.3053816643773, 196.11629879964352, -393.14608657650757, -482.86698170144297, -440.35742786626355, -298.5299080452206, 63.369972613024046, -493.8593296719289, -376.8014262888966, 31.699999999999996, -526.8795708502902, 156.6580956693074, -668.1506495628099, -206.54392446754508, -374.08652738688204, 11.258745072708143, -49.187474701582246, -364.75035571155325, 184.87621111559577, -403.12537667052396, 175.29111332926462, 20.000000000000014, -722.4066165234597, 53.19873673230429, -292.0658011064239, -607.4399721536291, -26.580067951443553, -73.57531693488629, -412.7383858357438, -111.2724306089111, 152.03532288011624, -93.84849031525022, -368.9167109182131, 163.9069913720346, 43.829312900066604, -264.51921581042126, -38.551716184958735, -174.4359090677115, 14.365709803408404, -528.6709525410738, -409.6058154389934, -138.7573148052819, -9.26279844193876, 20.000000000000014, -426.28194183851014, -657.932917080682, 195.91595887916904, -491.5554067088029, 181.64331248215305, 82.19169173695506, -388.8595433267233, -220.07896803978628, -523.6129672229546, 34.122286665950625, -320.82863607185783, 64.99999999999997, 150.54419949208676, -510.0787811438798, -496.1645835171373, 60.36839484130023, -325.38826858304674, -580.4952005289308, 20.000000000000014, -367.7453379234512, -10.592098687515671, 13.07544589794816, -304.1740453876617, -261.12026647635963, -24.876146490288278, -45.11591831818449, -352.122391055193, 20.81144898911465, -376.56347662894433, -397.2260823687245, -240.8187205154939, 125.70988309957424, 20.000000000000014, -455.8266007215875, -622.2323293249086, -389.3924082126322, -531.8208317854171, 20.000000000000014, -548.0151843206002, 75.74881662022574, -205.88043917034375, -132.31924744145593, -396.46127219908885, 17.544038338959275, -187.67763918986228, -214.29586921726514, -163.1909686748465, -1.274421702814113, -399.30679469806637, 75.87457702603919, -211.6481503626139, -219.15227190054344, -266.4817986785444, 193.63059291586612, -265.35925182461733, -339.56061616100925, -8.374061406070817, 99.98685028809695, -714.8116369152683, -160.20613678501311, 90.3704937101142, -398.12021706574717, -457.0221032766286, 20.000000000000014, 20.000000000000014, -38.7856406112375, -422.92373115594347, 16.841393373435984, -467.8500927201538, 20.000000000000014, 140.17266052031434, -20.405905372128494, -324.69651991235355, -186.40657153728117, 40.18499161721368, -378.1761587706334, 16.119940809632507, -313.8501390942448, 185.6231424449984, 18.76775125001943, 8.804289943946422, 107.88120693782449, -378.0785643084179, -120.73086251280591, -154.59924038655964, -171.3746839162659, -306.7869782789516, -46.24458604110984, -202.85397112435803, 88.25223755037372, -126.2484417204264, -546.7706052802638, -340.4432517956414, -91.72689568509128, -563.1512784412282, 169.21124803074594, -423.5974906840663, -383.2238708331233, -26.723500625279254, -89.23899494227877, -534.948649010123, -121.00268464734853, -290.70011576709356, -45.349696945079025, -600.7527205654334, 39.870344792126176, -91.41256011027542, -449.6603384900735, -625.1243603024604, 156.58243010405647, 161.04212287864337, -279.4607186596067, -498.24535741932004, 123.84283248692242, -498.9625806555664, -146.06975269161762, 151.41286547123212, -644.5166242339925, -336.7859527783453, -549.2630610246653, 68.59999999999997, -18.93927807768435, -423.8160968190953, 8.828092150204316, -245.81208739700907, 11.05388230214814, -189.06874435342596, -81.80214437752991, 13.469229920577604, -314.2499932587263, -360.79349725279906, -168.9185923946551, 43.10577784048688, -140.40752777469507, -234.1707804136747, -352.3295702548629, 15.727024620308066, -210.38005593652275, -363.60746184118653, -148.6823521290941, -108.55980795997507, 171.08488108410666, 49.84976285429541, -599.103302769093, 151.659548672592, -134.10675345605705, -264.5514310015641, -408.7920494077703, 129.19659974386263, -217.7196896887554, -306.8259296962908, 3.6101584032835805, 117.3834488827671, -500.2722381600059, -519.5069099691265, -578.9810296036151, 93.48271351977506, -172.86673490678157, -556.4458540175963, -9.814889491010028, 91.08504630825972, -26.124480402843517, -347.71025691071276, -232.94952112588075, -643.284094225713, 66.7060035783054, -202.68779708642617, 20.000000000000014, -275.77511964675125, 68.59999999999997, 64.14793147809354, -320.9366812122527, -71.98665565983146, -448.97391515800336, -16.954962635814056, -137.66647183416427, -515.9834338419229, 25.433603204819867, -239.41913940373098, -289.7237206174396, -160.89463732645876, -411.4528546060094, -77.4825638026249, -32.275435310896874, -272.17123486654475, 145.6340224656705, -246.63267394114845, -205.22283943844553, -112.84609639457098, -19.283846956192527, -602.292645714756, -445.9833227917968, -39.77406608821495, -45.905822672338466, -370.07466865532797, -158.75276466549047, -22.054362417504773, -247.97745765582846, -279.83067585490517, -174.6070947006088], "policy_predator_policy_reward": [38.02126939126318, 482.15735405322675, 475.2985718471103, 541.7188041506436, 373.7516828876853, 627.8171799712065, 577.6560543043266, 353.456436235166, 420.4559821481251, 347.84777135513144, 360.5739260883845, 261.06095645061134, 242.43058342612292, 357.15160652591794, 283.0887305914333, 400.74526918281185, 208.97112271067323, 381.0931717606113, 556.5271232369495, 231.05563240203827, 369.47213741121715, 392.0015444272786, 340.22234621402214, 310.1308886237722, 276.25878765717573, 529.3295459809326, 338.4684609533061, 400.6320737500452, 276.61503002936405, 8.612161672089988, 307.1443080511658, 318.3797771487446, 630.1120127922538, 470.3170844973203, 516.3017790925198, 311.4552388291796, 361.3700763318239, 481.72568315227693, 483.3669817014431, 399.9460865765091, 446.17001500341564, 302.76482101415064, 381.0958146284178, 496.69086896702635, 528.6337102299926, 679.1459243842313, 181.29271610312452, 427.5472993154889, 70.37574591488779, 385.06974914764106, 360.10223223525065, 278.686075920331, 722.4066165234597, 302.1218035897848, 489.0814507506515, 412.29721652378777, 361.48588087063615, 296.56155817497734, 362.1325325510735, 132.09082808265163, 64.51225922763736, 317.84798159983706, 528.6709525410738, 295.04490950026246, 226.77570850553423, 437.1100205565749, 433.6627943953059, 657.7994508338621, 426.39789631136836, 392.8484596795025, 278.41192791519825, 424.1490021036883, 523.2428568208157, 347.7728377440257, 457.124550049638, 359.34634415219665, 663.2690282187029, 325.20400492526835, 371.2666414869456, 581.7525687931131, 25.82725187079219, 333.8770578944441, 83.07555550355254, 428.9906786652195, 377.008009636568, 393.91094206607846, 322.4104492423691, 430.592733587209, 796.9316877195528, 312.6215103627563, 532.3208317854171, 405.79240821263295, 544.319984584183, 264.51297106422544, 461.10907869201566, 378.7341601252631, 310.86976889912796, 451.754603385443, 398.99074385761503, 148.67297787296494, 306.59453916198237, 484.02016127550246, 268.8763834741321, 343.10961586663205, 36.35190291677494, 714.8116369152683, 276.52565147327766, 539.563259722223, 368.56400261248996, 106.75117354016608, 121.96523176572528, 369.877811417925, 112.71278457236721, 447.6964087488994, 356.60630754371573, 325.9965199123535, 142.7625441590219, 404.4183211478698, 258.1660123429593, 289.15819925629324, 372.15734128610404, 327.046560849843, 418.0035510183016, 193.20433348079058, 247.46522561319455, 390.29755667659094, 146.3690380783507, 547.1706052802639, 563.1512784412282, 464.9839421850111, 385.0238708331236, 423.9974906840664, 559.7872818091873, 103.53899494227893, 357.26174269859854, 339.46039660759106, 194.25061742978815, 602.7527205654333, 487.8871665347883, 625.1243603024604, 479.40573557362336, 495.48879689472545, 498.9625806555664, 158.26975269161701, 354.9486309035273, 645.6166242339924, 156.32665748758984, 551.5630610246658, 597.4121864906302, 234.10423625454587, 248.5637438420461, 149.4768299327304, 378.5366806931579, 360.8823237205989, 352.377053931091, 337.549756996682, 85.68680198073925, 651.5234855075548, 472.3888870048888, 476.70133338809717, 192.834217639678, 98.35257016750225, 146.86488255656997, 602.2033027690932, 472.5758866688154, 301.2431867309688, 289.8229242420634, 339.5775892217031, 500.9722381600059, 521.706909969127, 685.7379571074966, 178.86511806938975, 261.18101719348016, 505.1590103692109, 245.14952112588006, 514.0826116936437, 643.284094225713, 213.00486567998286, 46.91977963887533, 262.06436859908047, 100.45518700141551, 329.9643243789648, 494.8949934338295, 289.45077013276165, 254.29298402527908, 603.7621372439763, 483.0972874957729, 512.7856150021638, 354.550078135233, 145.4523144163729, 299.185474190301, 276.1198030605472, 588.239373840256, 239.2426771205987, 388.8162781731728, 484.94246135272584, 306.4603783209804, 400.43078777027904, 400.32911771547697, 429.4804485888029]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.362239731087838, "mean_inference_ms": 6.670879316579441, "mean_action_processing_ms": 3.0463235148670935, "mean_env_wait_ms": 17.74209427251958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06475114822387695, "StateBufferConnector_ms": 0.008350968360900879, "ViewRequirementAgentConnector_ms": 0.30348730087280273}, "num_episodes": 20, "episode_return_max": 705.2502206433899, "episode_return_min": -81.94310135709404, "episode_return_mean": 178.45729207608738, "episodes_this_iter": 20}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 17.00080172081608, "num_env_steps_trained_throughput_per_sec": 17.00080172081608, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 86637.585, "restore_workers_time_ms": 0.025, "training_step_time_ms": 86637.507, "sample_time_ms": 4413.052, "learn_time_ms": 82173.933, "learn_throughput": 48.677, "synch_weights_time_ms": 35.009}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "training_iteration": 34, "trial_id": "62684_00000", "date": "2024-08-20_16-51-05", "timestamp": 1724152865, "time_this_iter_s": 236.7438199520111, "time_total_s": 2596.8640987873077, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ff8b040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2596.8640987873077, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 59.31919642857143, "ram_util_percent": 86.38125000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.06560069745314, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.067526826114519, "policy_loss": -0.01965308296296032, "vf_loss": 7.084577774325161, "vf_explained_var": 0.574407097697258, "kl": 0.013010652477651544, "entropy": 1.1518073470879955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 97290.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.684147906744921, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.590784544414944, "policy_loss": -0.022032844051028844, "vf_loss": 7.610024403768873, "vf_explained_var": 0.274682365586518, "kl": 0.013964898992950718, "entropy": 0.7456654085053338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000}, "env_runners": {"episode_reward_max": 705.2502206433899, "episode_reward_min": 12.415132173785015, "episode_reward_mean": 187.67162598948886, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -722.4066165234597, "predator_policy": 4.207961155268727}, "policy_reward_max": {"prey_policy": 196.3615708714583, "predator_policy": 796.9316877195528}, "policy_reward_mean": {"prey_policy": -173.36242452846133, "predator_policy": 353.8794497874366}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.46830863689526, 226.3838757649883, 430.95404481432223, 63.254739215663925, 193.78331023447896, 286.0719454810747, 195.3651507722955, 123.11862173215792, 134.9747102359588, 106.259800375894, 27.24738630997595, 705.2502206433899, 175.81411038933152, 60.69637793597842, 521.9363125500427, 227.28857588508748, 24.778671827675332, 58.013611588006114, 180.95390288393895, 63.04453300762394, 240.6682630449338, 51.49426803581369, 36.90000000000009, 130.68614877769022, 328.6067575156943, 197.45989520259673, 222.9570823557362, 93.33247949578126, 200.69672427100159, 127.96469179880074, 348.1330510548571, 58.29307287602752, 46.97506478990532, 252.73176112142633, 151.0938306343052, 225.30963896310325, 437.86496620002555, 437.81083470929974, 164.50309768346028, 81.87724684536553, 108.77283390829817, 32.813794704276674, 171.41124803074584, 12.415132173785015, 239.66964194666912, 144.70840211163892, 194.80925814877128, 358.2305792680658, 136.04283248692198, 170.6755435964139, 208.2873794099049, 170.7163306792763, 138.22356734596897, 77.84474382280794, 423.7064685989113, 166.43696144006296, 226.42035048618322, 403.561623785607, 167.51767777310505, 229.6721927343113, 108.46505248200323, 120.28344888276712, 206.23802418626445, 291.16433036234383, 152.44787438008757, 77.02307217186231, 121.80902859120246, 101.6441059863894, 180.75041393860948, 128.0861512284203, 133.81168994802886, 118.07315857153826, 269.08378633692473, 93.05946189533476, 342.09552797355065, 156.00937035293506, 127.39433809293716, 201.6662175982002, 233.2059733789064, 35.01290703400084, 50.70612538899901, 268.9001631376622, 150.37611965314727, 286.88429177359467, 267.27351379329167, 239.81075456887422, 299.2899863530304, 269.082734112281, 34.458660844056496, 82.85167974771753, 300.95361067750764, 203.75971751817872, 336.73185185464104, 151.45516134916076, 151.8433151852658, 113.97701254009351, 158.2870119868212, 507.7255725591668, 205.28078543572872, 28.236948965034482], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-206.54392446754508, -374.08652738688204, 11.258745072708143, -49.187474701582246, -364.75035571155325, 184.87621111559577, -403.12537667052396, 175.29111332926462, 20.000000000000014, -722.4066165234597, 53.19873673230429, -292.0658011064239, -607.4399721536291, -26.580067951443553, -73.57531693488629, -412.7383858357438, -111.2724306089111, 152.03532288011624, -93.84849031525022, -368.9167109182131, 163.9069913720346, 43.829312900066604, -264.51921581042126, -38.551716184958735, -174.4359090677115, 14.365709803408404, -528.6709525410738, -409.6058154389934, -138.7573148052819, -9.26279844193876, 20.000000000000014, -426.28194183851014, -657.932917080682, 195.91595887916904, -491.5554067088029, 181.64331248215305, 82.19169173695506, -388.8595433267233, -220.07896803978628, -523.6129672229546, 34.122286665950625, -320.82863607185783, 64.99999999999997, 150.54419949208676, -510.0787811438798, -496.1645835171373, 60.36839484130023, -325.38826858304674, -580.4952005289308, 20.000000000000014, -367.7453379234512, -10.592098687515671, 13.07544589794816, -304.1740453876617, -261.12026647635963, -24.876146490288278, -45.11591831818449, -352.122391055193, 20.81144898911465, -376.56347662894433, -397.2260823687245, -240.8187205154939, 125.70988309957424, 20.000000000000014, -455.8266007215875, -622.2323293249086, -389.3924082126322, -531.8208317854171, 20.000000000000014, -548.0151843206002, 75.74881662022574, -205.88043917034375, -132.31924744145593, -396.46127219908885, 17.544038338959275, -187.67763918986228, -214.29586921726514, -163.1909686748465, -1.274421702814113, -399.30679469806637, 75.87457702603919, -211.6481503626139, -219.15227190054344, -266.4817986785444, 193.63059291586612, -265.35925182461733, -339.56061616100925, -8.374061406070817, 99.98685028809695, -714.8116369152683, -160.20613678501311, 90.3704937101142, -398.12021706574717, -457.0221032766286, 20.000000000000014, 20.000000000000014, -38.7856406112375, -422.92373115594347, 16.841393373435984, -467.8500927201538, 20.000000000000014, 140.17266052031434, -20.405905372128494, -324.69651991235355, -186.40657153728117, 40.18499161721368, -378.1761587706334, 16.119940809632507, -313.8501390942448, 185.6231424449984, 18.76775125001943, 8.804289943946422, 107.88120693782449, -378.0785643084179, -120.73086251280591, -154.59924038655964, -171.3746839162659, -306.7869782789516, -46.24458604110984, -202.85397112435803, 88.25223755037372, -126.2484417204264, -546.7706052802638, -340.4432517956414, -91.72689568509128, -563.1512784412282, 169.21124803074594, -423.5974906840663, -383.2238708331233, -26.723500625279254, -89.23899494227877, -534.948649010123, -121.00268464734853, -290.70011576709356, -45.349696945079025, -600.7527205654334, 39.870344792126176, -91.41256011027542, -449.6603384900735, -625.1243603024604, 156.58243010405647, 161.04212287864337, -279.4607186596067, -498.24535741932004, 123.84283248692242, -498.9625806555664, -146.06975269161762, 151.41286547123212, -644.5166242339925, -336.7859527783453, -549.2630610246653, 68.59999999999997, -18.93927807768435, -423.8160968190953, 8.828092150204316, -245.81208739700907, 11.05388230214814, -189.06874435342596, -81.80214437752991, 13.469229920577604, -314.2499932587263, -360.79349725279906, -168.9185923946551, 43.10577784048688, -140.40752777469507, -234.1707804136747, -352.3295702548629, 15.727024620308066, -210.38005593652275, -363.60746184118653, -148.6823521290941, -108.55980795997507, 171.08488108410666, 49.84976285429541, -599.103302769093, 151.659548672592, -134.10675345605705, -264.5514310015641, -408.7920494077703, 129.19659974386263, -217.7196896887554, -306.8259296962908, 3.6101584032835805, 117.3834488827671, -500.2722381600059, -519.5069099691265, -578.9810296036151, 93.48271351977506, -172.86673490678157, -556.4458540175963, -9.814889491010028, 91.08504630825972, -26.124480402843517, -347.71025691071276, -232.94952112588075, -643.284094225713, 66.7060035783054, -202.68779708642617, 20.000000000000014, -275.77511964675125, 68.59999999999997, 64.14793147809354, -320.9366812122527, -71.98665565983146, -448.97391515800336, -16.954962635814056, -137.66647183416427, -515.9834338419229, 25.433603204819867, -239.41913940373098, -289.7237206174396, -160.89463732645876, -411.4528546060094, -77.4825638026249, -32.275435310896874, -272.17123486654475, 145.6340224656705, -246.63267394114845, -205.22283943844553, -112.84609639457098, -19.283846956192527, -602.292645714756, -445.9833227917968, -39.77406608821495, -45.905822672338466, -370.07466865532797, -158.75276466549047, -22.054362417504773, -247.97745765582846, -279.83067585490517, -174.6070947006088, -167.75171086622672, -180.48185238094962, -257.7674481767206, 167.68471558138734, -142.13491932917395, -230.23964250698697, -405.49306699214844, -388.05161840001125, -148.82162594316492, -385.77507251750745, 13.107854384815232, 19.872993148240468, 14.720076878472227, 114.54056856330143, -652.2601165524571, -184.1831861566299, 20.000000000000014, -23.905968054161832, 156.07407986419665, 48.148649363986685, -101.01871641417998, -581.662091183341, -215.96579563917876, 168.35466886559573, -187.11437663748316, -203.0303976066353, -138.14669587396477, 128.48390673345136, -226.25653284837267, -531.6312792514157, 25.597958364327102, -223.06614635545847, -106.98428718824123, 4.256668559914628, -37.08181036948589, -108.35893421902378, 61.338993569055624, -238.87097118967392, -22.141061887760912, -67.91551771844783, 189.92116724016697, -257.48687663865775, 68.34834957055041, -372.35276479202446, -363.67353089784604, -200.4556242954037, 179.81381786589026, 110.3918176192802, 110.64658796733994, -537.5584493525279, -225.82718979256086, -121.97663850828073, -388.7334623152771, 16.307028088860868, -84.41982364009557, -110.5995326773767, -304.08144386195164, -427.25994343505107, -108.16945357855904, -31.82227115015147, 185.53048624742587, -580.6683817260157, 146.36447290386204, -337.5996422955999, -563.1324747233936, 196.3615708714583, -416.2574106585334, -367.2129660158657, 20.000000000000014], "policy_predator_policy_reward": [181.29271610312452, 427.5472993154889, 70.37574591488779, 385.06974914764106, 360.10223223525065, 278.686075920331, 722.4066165234597, 302.1218035897848, 489.0814507506515, 412.29721652378777, 361.48588087063615, 296.56155817497734, 362.1325325510735, 132.09082808265163, 64.51225922763736, 317.84798159983706, 528.6709525410738, 295.04490950026246, 226.77570850553423, 437.1100205565749, 433.6627943953059, 657.7994508338621, 426.39789631136836, 392.8484596795025, 278.41192791519825, 424.1490021036883, 523.2428568208157, 347.7728377440257, 457.124550049638, 359.34634415219665, 663.2690282187029, 325.20400492526835, 371.2666414869456, 581.7525687931131, 25.82725187079219, 333.8770578944441, 83.07555550355254, 428.9906786652195, 377.008009636568, 393.91094206607846, 322.4104492423691, 430.592733587209, 796.9316877195528, 312.6215103627563, 532.3208317854171, 405.79240821263295, 544.319984584183, 264.51297106422544, 461.10907869201566, 378.7341601252631, 310.86976889912796, 451.754603385443, 398.99074385761503, 148.67297787296494, 306.59453916198237, 484.02016127550246, 268.8763834741321, 343.10961586663205, 36.35190291677494, 714.8116369152683, 276.52565147327766, 539.563259722223, 368.56400261248996, 106.75117354016608, 121.96523176572528, 369.877811417925, 112.71278457236721, 447.6964087488994, 356.60630754371573, 325.9965199123535, 142.7625441590219, 404.4183211478698, 258.1660123429593, 289.15819925629324, 372.15734128610404, 327.046560849843, 418.0035510183016, 193.20433348079058, 247.46522561319455, 390.29755667659094, 146.3690380783507, 547.1706052802639, 563.1512784412282, 464.9839421850111, 385.0238708331236, 423.9974906840664, 559.7872818091873, 103.53899494227893, 357.26174269859854, 339.46039660759106, 194.25061742978815, 602.7527205654333, 487.8871665347883, 625.1243603024604, 479.40573557362336, 495.48879689472545, 498.9625806555664, 158.26975269161701, 354.9486309035273, 645.6166242339924, 156.32665748758984, 551.5630610246658, 597.4121864906302, 234.10423625454587, 248.5637438420461, 149.4768299327304, 378.5366806931579, 360.8823237205989, 352.377053931091, 337.549756996682, 85.68680198073925, 651.5234855075548, 472.3888870048888, 476.70133338809717, 192.834217639678, 98.35257016750225, 146.86488255656997, 602.2033027690932, 472.5758866688154, 301.2431867309688, 289.8229242420634, 339.5775892217031, 500.9722381600059, 521.706909969127, 685.7379571074966, 178.86511806938975, 261.18101719348016, 505.1590103692109, 245.14952112588006, 514.0826116936437, 643.284094225713, 213.00486567998286, 46.91977963887533, 262.06436859908047, 100.45518700141551, 329.9643243789648, 494.8949934338295, 289.45077013276165, 254.29298402527908, 603.7621372439763, 483.0972874957729, 512.7856150021638, 354.550078135233, 145.4523144163729, 299.185474190301, 276.1198030605472, 588.239373840256, 239.2426771205987, 388.8162781731728, 484.94246135272584, 306.4603783209804, 400.43078777027904, 400.32911771547697, 429.4804485888029, 404.63416458538313, 403.0330644367131, 69.75111689402674, 368.14470273965327, 542.0505031179937, 435.3287152513326, 394.53336175822864, 8.966988615221958, 556.4956673470566, 235.40396690128847, 326.3583347662876, 12.106939097653132, 16.133833913782816, 167.54644504580892, 647.6808232171439, 248.86590853307246, 253.63621739024774, 514.4660072967097, 471.07472689898094, 457.61916482038595, 288.81018419800193, 284.72502509365086, 24.686558968431743, 150.9561779042194, 4.207961155268727, 278.31675810082777, 58.74845492919015, 377.68638286525726, 426.0197546237717, 445.41790901372735, 214.6556242954035, 32.32621636946975, 565.267022734349, 238.9271897925601, 252.91292560468565, 393.3334623152774, 194.01982364009572, 419.0579890794249, 396.5658693861426, 328.972810764443, 545.5970063397529, 210.9019887941408, 563.6324747233937, 346.01885685987247, 372.2350469866922, 419.4722786527418]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.351500685142305, "mean_inference_ms": 6.644396351420714, "mean_action_processing_ms": 2.9810985524302787, "mean_env_wait_ms": 17.755283253225493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0609058141708374, "StateBufferConnector_ms": 0.0077468156814575195, "ViewRequirementAgentConnector_ms": 0.2758108377456665}, "num_episodes": 23, "episode_return_max": 705.2502206433899, "episode_return_min": 12.415132173785015, "episode_return_mean": 187.67162598948886, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.90645454050853, "num_env_steps_trained_throughput_per_sec": 55.90645454050853, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 700000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 700000, "timers": {"training_iteration_time_ms": 86906.623, "restore_workers_time_ms": 0.03, "training_step_time_ms": 86906.535, "sample_time_ms": 4547.94, "learn_time_ms": 82308.544, "learn_throughput": 48.598, "synch_weights_time_ms": 35.114}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000}, "done": false, "training_iteration": 35, "trial_id": "62684_00000", "date": "2024-08-20_16-52-17", "timestamp": 1724152937, "time_this_iter_s": 71.66643595695496, "time_total_s": 2668.5305347442627, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ac0af3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2668.5305347442627, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 58.03725490196079, "ram_util_percent": 83.56764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.771083239756578, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.681442047687287, "policy_loss": -0.02129510882147918, "vf_loss": 7.700046074813139, "vf_explained_var": 0.5272076222279393, "kl": 0.013455405087930196, "entropy": 1.1142904356227699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 100110.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.738269557776275, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.28052257860779, "policy_loss": -0.021755678181551278, "vf_loss": 8.299636881439774, "vf_explained_var": 0.19408682187398274, "kl": 0.013206802886693922, "entropy": 0.7002752622283955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 507.7255725591668, "episode_reward_min": 12.415132173785015, "episode_reward_mean": 186.62174183768886, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -714.8116369152683, "predator_policy": 4.207961155268727}, "policy_reward_max": {"prey_policy": 199.1, "predator_policy": 796.9316877195528}, "policy_reward_mean": {"prey_policy": -171.13501168079645, "predator_policy": 350.01338844003925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.778671827675332, 58.013611588006114, 180.95390288393895, 63.04453300762394, 240.6682630449338, 51.49426803581369, 36.90000000000009, 130.68614877769022, 328.6067575156943, 197.45989520259673, 222.9570823557362, 93.33247949578126, 200.69672427100159, 127.96469179880074, 348.1330510548571, 58.29307287602752, 46.97506478990532, 252.73176112142633, 151.0938306343052, 225.30963896310325, 437.86496620002555, 437.81083470929974, 164.50309768346028, 81.87724684536553, 108.77283390829817, 32.813794704276674, 171.41124803074584, 12.415132173785015, 239.66964194666912, 144.70840211163892, 194.80925814877128, 358.2305792680658, 136.04283248692198, 170.6755435964139, 208.2873794099049, 170.7163306792763, 138.22356734596897, 77.84474382280794, 423.7064685989113, 166.43696144006296, 226.42035048618322, 403.561623785607, 167.51767777310505, 229.6721927343113, 108.46505248200323, 120.28344888276712, 206.23802418626445, 291.16433036234383, 152.44787438008757, 77.02307217186231, 121.80902859120246, 101.6441059863894, 180.75041393860948, 128.0861512284203, 133.81168994802886, 118.07315857153826, 269.08378633692473, 93.05946189533476, 342.09552797355065, 156.00937035293506, 127.39433809293716, 201.6662175982002, 233.2059733789064, 35.01290703400084, 50.70612538899901, 268.9001631376622, 150.37611965314727, 286.88429177359467, 267.27351379329167, 239.81075456887422, 299.2899863530304, 269.082734112281, 34.458660844056496, 82.85167974771753, 300.95361067750764, 203.75971751817872, 336.73185185464104, 151.45516134916076, 151.8433151852658, 113.97701254009351, 158.2870119868212, 507.7255725591668, 205.28078543572872, 28.236948965034482, 77.86967681999343, 162.4512346323675, 403.11192943807856, 262.79343668545215, 337.77309643369415, 50.24115195568893, 172.8278205027674, 378.8036332704695, 182.91564290100362, 356.583713661299, 102.56108510705182, 250.73628246017313, 352.0269148778576, 121.8660521477613, 148.62329025628938, 51.69411464758591], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-580.4952005289308, 20.000000000000014, -367.7453379234512, -10.592098687515671, 13.07544589794816, -304.1740453876617, -261.12026647635963, -24.876146490288278, -45.11591831818449, -352.122391055193, 20.81144898911465, -376.56347662894433, -397.2260823687245, -240.8187205154939, 125.70988309957424, 20.000000000000014, -455.8266007215875, -622.2323293249086, -389.3924082126322, -531.8208317854171, 20.000000000000014, -548.0151843206002, 75.74881662022574, -205.88043917034375, -132.31924744145593, -396.46127219908885, 17.544038338959275, -187.67763918986228, -214.29586921726514, -163.1909686748465, -1.274421702814113, -399.30679469806637, 75.87457702603919, -211.6481503626139, -219.15227190054344, -266.4817986785444, 193.63059291586612, -265.35925182461733, -339.56061616100925, -8.374061406070817, 99.98685028809695, -714.8116369152683, -160.20613678501311, 90.3704937101142, -398.12021706574717, -457.0221032766286, 20.000000000000014, 20.000000000000014, -38.7856406112375, -422.92373115594347, 16.841393373435984, -467.8500927201538, 20.000000000000014, 140.17266052031434, -20.405905372128494, -324.69651991235355, -186.40657153728117, 40.18499161721368, -378.1761587706334, 16.119940809632507, -313.8501390942448, 185.6231424449984, 18.76775125001943, 8.804289943946422, 107.88120693782449, -378.0785643084179, -120.73086251280591, -154.59924038655964, -171.3746839162659, -306.7869782789516, -46.24458604110984, -202.85397112435803, 88.25223755037372, -126.2484417204264, -546.7706052802638, -340.4432517956414, -91.72689568509128, -563.1512784412282, 169.21124803074594, -423.5974906840663, -383.2238708331233, -26.723500625279254, -89.23899494227877, -534.948649010123, -121.00268464734853, -290.70011576709356, -45.349696945079025, -600.7527205654334, 39.870344792126176, -91.41256011027542, -449.6603384900735, -625.1243603024604, 156.58243010405647, 161.04212287864337, -279.4607186596067, -498.24535741932004, 123.84283248692242, -498.9625806555664, -146.06975269161762, 151.41286547123212, -644.5166242339925, -336.7859527783453, -549.2630610246653, 68.59999999999997, -18.93927807768435, -423.8160968190953, 8.828092150204316, -245.81208739700907, 11.05388230214814, -189.06874435342596, -81.80214437752991, 13.469229920577604, -314.2499932587263, -360.79349725279906, -168.9185923946551, 43.10577784048688, -140.40752777469507, -234.1707804136747, -352.3295702548629, 15.727024620308066, -210.38005593652275, -363.60746184118653, -148.6823521290941, -108.55980795997507, 171.08488108410666, 49.84976285429541, -599.103302769093, 151.659548672592, -134.10675345605705, -264.5514310015641, -408.7920494077703, 129.19659974386263, -217.7196896887554, -306.8259296962908, 3.6101584032835805, 117.3834488827671, -500.2722381600059, -519.5069099691265, -578.9810296036151, 93.48271351977506, -172.86673490678157, -556.4458540175963, -9.814889491010028, 91.08504630825972, -26.124480402843517, -347.71025691071276, -232.94952112588075, -643.284094225713, 66.7060035783054, -202.68779708642617, 20.000000000000014, -275.77511964675125, 68.59999999999997, 64.14793147809354, -320.9366812122527, -71.98665565983146, -448.97391515800336, -16.954962635814056, -137.66647183416427, -515.9834338419229, 25.433603204819867, -239.41913940373098, -289.7237206174396, -160.89463732645876, -411.4528546060094, -77.4825638026249, -32.275435310896874, -272.17123486654475, 145.6340224656705, -246.63267394114845, -205.22283943844553, -112.84609639457098, -19.283846956192527, -602.292645714756, -445.9833227917968, -39.77406608821495, -45.905822672338466, -370.07466865532797, -158.75276466549047, -22.054362417504773, -247.97745765582846, -279.83067585490517, -174.6070947006088, -167.75171086622672, -180.48185238094962, -257.7674481767206, 167.68471558138734, -142.13491932917395, -230.23964250698697, -405.49306699214844, -388.05161840001125, -148.82162594316492, -385.77507251750745, 13.107854384815232, 19.872993148240468, 14.720076878472227, 114.54056856330143, -652.2601165524571, -184.1831861566299, 20.000000000000014, -23.905968054161832, 156.07407986419665, 48.148649363986685, -101.01871641417998, -581.662091183341, -215.96579563917876, 168.35466886559573, -187.11437663748316, -203.0303976066353, -138.14669587396477, 128.48390673345136, -226.25653284837267, -531.6312792514157, 25.597958364327102, -223.06614635545847, -106.98428718824123, 4.256668559914628, -37.08181036948589, -108.35893421902378, 61.338993569055624, -238.87097118967392, -22.141061887760912, -67.91551771844783, 189.92116724016697, -257.48687663865775, 68.34834957055041, -372.35276479202446, -363.67353089784604, -200.4556242954037, 179.81381786589026, 110.3918176192802, 110.64658796733994, -537.5584493525279, -225.82718979256086, -121.97663850828073, -388.7334623152771, 16.307028088860868, -84.41982364009557, -110.5995326773767, -304.08144386195164, -427.25994343505107, -108.16945357855904, -31.82227115015147, 185.53048624742587, -580.6683817260157, 146.36447290386204, -337.5996422955999, -563.1324747233936, 196.3615708714583, -416.2574106585334, -367.2129660158657, 20.000000000000014, 12.546535789989008, -140.54052796744568, -214.4712731623604, -13.146353666784561, -209.7360859488325, -460.1093795729179, -424.842600253576, 45.82262329792875, 150.48046865933205, -172.44538712888962, -18.77616652114928, 199.1, 72.83121792997513, -420.8082344451754, 167.6, -410.65463512418705, -494.09608820843977, -0.9292510328560019, -146.6490929334887, -672.4646424645338, -49.7093034123197, 139.75548569802677, -35.71004879389368, -464.8795059823069, 41.93051053618186, -70.67620373377842, -391.212580887388, -53.12445247008262, 149.1196596559335, -582.4297974726426, -281.75519969316923, -537.1306860784484, 34.902151471539185, 174.6985273267891, 55.724859117873024, -713.2924115913355, -616.899152351619, -30.694876405898015, 158.38456951520155, -107.20064944017787, -172.38247952587903, -51.99516048388552, -391.7528201967318, -37.83510105568486, 73.7845597394792, -699.5458334645758, -102.8758266033766, -40.26070617164828], "policy_predator_policy_reward": [371.2666414869456, 581.7525687931131, 25.82725187079219, 333.8770578944441, 83.07555550355254, 428.9906786652195, 377.008009636568, 393.91094206607846, 322.4104492423691, 430.592733587209, 796.9316877195528, 312.6215103627563, 532.3208317854171, 405.79240821263295, 544.319984584183, 264.51297106422544, 461.10907869201566, 378.7341601252631, 310.86976889912796, 451.754603385443, 398.99074385761503, 148.67297787296494, 306.59453916198237, 484.02016127550246, 268.8763834741321, 343.10961586663205, 36.35190291677494, 714.8116369152683, 276.52565147327766, 539.563259722223, 368.56400261248996, 106.75117354016608, 121.96523176572528, 369.877811417925, 112.71278457236721, 447.6964087488994, 356.60630754371573, 325.9965199123535, 142.7625441590219, 404.4183211478698, 258.1660123429593, 289.15819925629324, 372.15734128610404, 327.046560849843, 418.0035510183016, 193.20433348079058, 247.46522561319455, 390.29755667659094, 146.3690380783507, 547.1706052802639, 563.1512784412282, 464.9839421850111, 385.0238708331236, 423.9974906840664, 559.7872818091873, 103.53899494227893, 357.26174269859854, 339.46039660759106, 194.25061742978815, 602.7527205654333, 487.8871665347883, 625.1243603024604, 479.40573557362336, 495.48879689472545, 498.9625806555664, 158.26975269161701, 354.9486309035273, 645.6166242339924, 156.32665748758984, 551.5630610246658, 597.4121864906302, 234.10423625454587, 248.5637438420461, 149.4768299327304, 378.5366806931579, 360.8823237205989, 352.377053931091, 337.549756996682, 85.68680198073925, 651.5234855075548, 472.3888870048888, 476.70133338809717, 192.834217639678, 98.35257016750225, 146.86488255656997, 602.2033027690932, 472.5758866688154, 301.2431867309688, 289.8229242420634, 339.5775892217031, 500.9722381600059, 521.706909969127, 685.7379571074966, 178.86511806938975, 261.18101719348016, 505.1590103692109, 245.14952112588006, 514.0826116936437, 643.284094225713, 213.00486567998286, 46.91977963887533, 262.06436859908047, 100.45518700141551, 329.9643243789648, 494.8949934338295, 289.45077013276165, 254.29298402527908, 603.7621372439763, 483.0972874957729, 512.7856150021638, 354.550078135233, 145.4523144163729, 299.185474190301, 276.1198030605472, 588.239373840256, 239.2426771205987, 388.8162781731728, 484.94246135272584, 306.4603783209804, 400.43078777027904, 400.32911771547697, 429.4804485888029, 404.63416458538313, 403.0330644367131, 69.75111689402674, 368.14470273965327, 542.0505031179937, 435.3287152513326, 394.53336175822864, 8.966988615221958, 556.4956673470566, 235.40396690128847, 326.3583347662876, 12.106939097653132, 16.133833913782816, 167.54644504580892, 647.6808232171439, 248.86590853307246, 253.63621739024774, 514.4660072967097, 471.07472689898094, 457.61916482038595, 288.81018419800193, 284.72502509365086, 24.686558968431743, 150.9561779042194, 4.207961155268727, 278.31675810082777, 58.74845492919015, 377.68638286525726, 426.0197546237717, 445.41790901372735, 214.6556242954035, 32.32621636946975, 565.267022734349, 238.9271897925601, 252.91292560468565, 393.3334623152774, 194.01982364009572, 419.0579890794249, 396.5658693861426, 328.972810764443, 545.5970063397529, 210.9019887941408, 563.6324747233937, 346.01885685987247, 372.2350469866922, 419.4722786527418, 196.53396050769484, 223.8009816521152, 454.4344246161606, 391.0086292047435, 279.87243627990955, 351.7790014544843, 88.01573018099435, 166.89926015449757, 113.49934983501063, 404.6507631138838, 459.2513062583251, 496.6698200628468, 369.04314383044164, 672.6077154826681, 297.2502715726505, 442.3874307759922, 181.89405874656626, 420.9798582394215, 428.1470976670434, 414.87120628104594, 349.31413332868345, 537.2306860784485, 713.2924115913355, 20.312896015511264, 290.44627550791427, 550.7900986122582, 292.79792637480233, 160.64641522290225, 83.57383157249552, 420.8528201967318, 721.5578089918703, 172.81867189531647]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.327756434657557, "mean_inference_ms": 6.645706113649741, "mean_action_processing_ms": 2.9208300188220386, "mean_env_wait_ms": 17.695558516379393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.061899542808532715, "StateBufferConnector_ms": 0.00785839557647705, "ViewRequirementAgentConnector_ms": 0.2534794807434082}, "num_episodes": 16, "episode_return_max": 507.7255725591668, "episode_return_min": 12.415132173785015, "episode_return_mean": 186.62174183768886, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 59.26879847964648, "num_env_steps_trained_throughput_per_sec": 59.26879847964648, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 86210.95, "restore_workers_time_ms": 0.03, "training_step_time_ms": 86210.861, "sample_time_ms": 4239.306, "learn_time_ms": 81921.038, "learn_throughput": 48.828, "synch_weights_time_ms": 35.155}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 36, "trial_id": "62684_00000", "date": "2024-08-20_16-53-25", "timestamp": 1724153005, "time_this_iter_s": 67.53832197189331, "time_total_s": 2736.068856716156, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3acade1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2736.068856716156, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 51.79375000000001, "ram_util_percent": 83.29270833333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.666982011042588, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.1105490537399945, "policy_loss": -0.01904950138546381, "vf_loss": 7.127063618822301, "vf_explained_var": 0.5767055976052656, "kl": 0.012674669932792003, "entropy": 1.1023094651546883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 102930.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.85336982182094, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.250360797700427, "policy_loss": -0.022722539774304818, "vf_loss": 8.270536491858266, "vf_explained_var": 0.169110691295099, "kl": 0.012734223216299027, "entropy": 0.6755382068258114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 740000}, "env_runners": {"episode_reward_max": 513.2265819045587, "episode_reward_min": -18.093418021775847, "episode_reward_mean": 194.8240247770191, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -764.2883464733677, "predator_policy": 4.207961155268727}, "policy_reward_max": {"prey_policy": 199.1, "predator_policy": 764.2883464733677}, "policy_reward_mean": {"prey_policy": -174.1788385281158, "predator_policy": 358.6802701806833}, "custom_metrics": {}, "hist_stats": {"episode_reward": [437.86496620002555, 437.81083470929974, 164.50309768346028, 81.87724684536553, 108.77283390829817, 32.813794704276674, 171.41124803074584, 12.415132173785015, 239.66964194666912, 144.70840211163892, 194.80925814877128, 358.2305792680658, 136.04283248692198, 170.6755435964139, 208.2873794099049, 170.7163306792763, 138.22356734596897, 77.84474382280794, 423.7064685989113, 166.43696144006296, 226.42035048618322, 403.561623785607, 167.51767777310505, 229.6721927343113, 108.46505248200323, 120.28344888276712, 206.23802418626445, 291.16433036234383, 152.44787438008757, 77.02307217186231, 121.80902859120246, 101.6441059863894, 180.75041393860948, 128.0861512284203, 133.81168994802886, 118.07315857153826, 269.08378633692473, 93.05946189533476, 342.09552797355065, 156.00937035293506, 127.39433809293716, 201.6662175982002, 233.2059733789064, 35.01290703400084, 50.70612538899901, 268.9001631376622, 150.37611965314727, 286.88429177359467, 267.27351379329167, 239.81075456887422, 299.2899863530304, 269.082734112281, 34.458660844056496, 82.85167974771753, 300.95361067750764, 203.75971751817872, 336.73185185464104, 151.45516134916076, 151.8433151852658, 113.97701254009351, 158.2870119868212, 507.7255725591668, 205.28078543572872, 28.236948965034482, 77.86967681999343, 162.4512346323675, 403.11192943807856, 262.79343668545215, 337.77309643369415, 50.24115195568893, 172.8278205027674, 378.8036332704695, 182.91564290100362, 356.583713661299, 102.56108510705182, 250.73628246017313, 352.0269148778576, 121.8660521477613, 148.62329025628938, 51.69411464758591, -18.093418021775847, 247.07788945891102, 127.55876399180869, 134.7389918458943, 199.86349253355277, 118.97224130869056, 129.15849493602443, 109.11112088858007, 177.21416093348174, 418.81908418984364, 513.2265819045587, 196.03458161010505, 76.6095638323377, 182.18390299823625, 112.1034547092712, 465.21042271476813, 410.88787876122956, 118.8022897853096, 26.129949606119126, 114.71229519099572], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-313.8501390942448, 185.6231424449984, 18.76775125001943, 8.804289943946422, 107.88120693782449, -378.0785643084179, -120.73086251280591, -154.59924038655964, -171.3746839162659, -306.7869782789516, -46.24458604110984, -202.85397112435803, 88.25223755037372, -126.2484417204264, -546.7706052802638, -340.4432517956414, -91.72689568509128, -563.1512784412282, 169.21124803074594, -423.5974906840663, -383.2238708331233, -26.723500625279254, -89.23899494227877, -534.948649010123, -121.00268464734853, -290.70011576709356, -45.349696945079025, -600.7527205654334, 39.870344792126176, -91.41256011027542, -449.6603384900735, -625.1243603024604, 156.58243010405647, 161.04212287864337, -279.4607186596067, -498.24535741932004, 123.84283248692242, -498.9625806555664, -146.06975269161762, 151.41286547123212, -644.5166242339925, -336.7859527783453, -549.2630610246653, 68.59999999999997, -18.93927807768435, -423.8160968190953, 8.828092150204316, -245.81208739700907, 11.05388230214814, -189.06874435342596, -81.80214437752991, 13.469229920577604, -314.2499932587263, -360.79349725279906, -168.9185923946551, 43.10577784048688, -140.40752777469507, -234.1707804136747, -352.3295702548629, 15.727024620308066, -210.38005593652275, -363.60746184118653, -148.6823521290941, -108.55980795997507, 171.08488108410666, 49.84976285429541, -599.103302769093, 151.659548672592, -134.10675345605705, -264.5514310015641, -408.7920494077703, 129.19659974386263, -217.7196896887554, -306.8259296962908, 3.6101584032835805, 117.3834488827671, -500.2722381600059, -519.5069099691265, -578.9810296036151, 93.48271351977506, -172.86673490678157, -556.4458540175963, -9.814889491010028, 91.08504630825972, -26.124480402843517, -347.71025691071276, -232.94952112588075, -643.284094225713, 66.7060035783054, -202.68779708642617, 20.000000000000014, -275.77511964675125, 68.59999999999997, 64.14793147809354, -320.9366812122527, -71.98665565983146, -448.97391515800336, -16.954962635814056, -137.66647183416427, -515.9834338419229, 25.433603204819867, -239.41913940373098, -289.7237206174396, -160.89463732645876, -411.4528546060094, -77.4825638026249, -32.275435310896874, -272.17123486654475, 145.6340224656705, -246.63267394114845, -205.22283943844553, -112.84609639457098, -19.283846956192527, -602.292645714756, -445.9833227917968, -39.77406608821495, -45.905822672338466, -370.07466865532797, -158.75276466549047, -22.054362417504773, -247.97745765582846, -279.83067585490517, -174.6070947006088, -167.75171086622672, -180.48185238094962, -257.7674481767206, 167.68471558138734, -142.13491932917395, -230.23964250698697, -405.49306699214844, -388.05161840001125, -148.82162594316492, -385.77507251750745, 13.107854384815232, 19.872993148240468, 14.720076878472227, 114.54056856330143, -652.2601165524571, -184.1831861566299, 20.000000000000014, -23.905968054161832, 156.07407986419665, 48.148649363986685, -101.01871641417998, -581.662091183341, -215.96579563917876, 168.35466886559573, -187.11437663748316, -203.0303976066353, -138.14669587396477, 128.48390673345136, -226.25653284837267, -531.6312792514157, 25.597958364327102, -223.06614635545847, -106.98428718824123, 4.256668559914628, -37.08181036948589, -108.35893421902378, 61.338993569055624, -238.87097118967392, -22.141061887760912, -67.91551771844783, 189.92116724016697, -257.48687663865775, 68.34834957055041, -372.35276479202446, -363.67353089784604, -200.4556242954037, 179.81381786589026, 110.3918176192802, 110.64658796733994, -537.5584493525279, -225.82718979256086, -121.97663850828073, -388.7334623152771, 16.307028088860868, -84.41982364009557, -110.5995326773767, -304.08144386195164, -427.25994343505107, -108.16945357855904, -31.82227115015147, 185.53048624742587, -580.6683817260157, 146.36447290386204, -337.5996422955999, -563.1324747233936, 196.3615708714583, -416.2574106585334, -367.2129660158657, 20.000000000000014, 12.546535789989008, -140.54052796744568, -214.4712731623604, -13.146353666784561, -209.7360859488325, -460.1093795729179, -424.842600253576, 45.82262329792875, 150.48046865933205, -172.44538712888962, -18.77616652114928, 199.1, 72.83121792997513, -420.8082344451754, 167.6, -410.65463512418705, -494.09608820843977, -0.9292510328560019, -146.6490929334887, -672.4646424645338, -49.7093034123197, 139.75548569802677, -35.71004879389368, -464.8795059823069, 41.93051053618186, -70.67620373377842, -391.212580887388, -53.12445247008262, 149.1196596559335, -582.4297974726426, -281.75519969316923, -537.1306860784484, 34.902151471539185, 174.6985273267891, 55.724859117873024, -713.2924115913355, -616.899152351619, -30.694876405898015, 158.38456951520155, -107.20064944017787, -172.38247952587903, -51.99516048388552, -391.7528201967318, -37.83510105568486, 73.7845597394792, -699.5458334645758, -102.8758266033766, -40.26070617164828, -225.73396894627257, -35.67943677795035, -432.3667670632541, -136.26331613733328, -466.41955842587225, 139.7, -443.4353352407789, -295.0484019661141, 14.616116523516762, -679.8738097534534, -260.9172760837825, 126.32124983878919, 1.9742815586290738, 74.11375595933998, -669.0608480334457, -144.48292983544664, -203.04470257836226, -227.3018691609058, 19.01611652351683, -227.39553037547202, -447.48951652714845, -101.8106878495098, -58.890311389695675, -367.47185713084656, -242.15238541453448, -79.09837409644386, 113.93435257209264, 66.04504090598878, -756.178019465923, 177.1463013102479, -632.269003276399, 165.14336054291195, 19.363213071364157, 180.1345816101057, -196.77514525931733, -335.81880658962206, 47.78240227547019, -106.62926914643573, -500.58796811281155, -269.4909733676315, 58.003429423725464, -382.8957832276975, -107.40998413317001, -266.334702510855, -62.47814837679991, 7.655247001599228, -459.6166213612266, 121.49702213183731, -593.3733812009516, 177.7369895295598, -375.27255743415816, 30.306475044444063, -366.9000052858162, -254.70125753822273, -648.389567978118, -764.2883464733677, 20.000000000000014, 77.17493163278317, -632.5041963227703, -137.41572409269526], "policy_predator_policy_reward": [258.1660123429593, 289.15819925629324, 372.15734128610404, 327.046560849843, 418.0035510183016, 193.20433348079058, 247.46522561319455, 390.29755667659094, 146.3690380783507, 547.1706052802639, 563.1512784412282, 464.9839421850111, 385.0238708331236, 423.9974906840664, 559.7872818091873, 103.53899494227893, 357.26174269859854, 339.46039660759106, 194.25061742978815, 602.7527205654333, 487.8871665347883, 625.1243603024604, 479.40573557362336, 495.48879689472545, 498.9625806555664, 158.26975269161701, 354.9486309035273, 645.6166242339924, 156.32665748758984, 551.5630610246658, 597.4121864906302, 234.10423625454587, 248.5637438420461, 149.4768299327304, 378.5366806931579, 360.8823237205989, 352.377053931091, 337.549756996682, 85.68680198073925, 651.5234855075548, 472.3888870048888, 476.70133338809717, 192.834217639678, 98.35257016750225, 146.86488255656997, 602.2033027690932, 472.5758866688154, 301.2431867309688, 289.8229242420634, 339.5775892217031, 500.9722381600059, 521.706909969127, 685.7379571074966, 178.86511806938975, 261.18101719348016, 505.1590103692109, 245.14952112588006, 514.0826116936437, 643.284094225713, 213.00486567998286, 46.91977963887533, 262.06436859908047, 100.45518700141551, 329.9643243789648, 494.8949934338295, 289.45077013276165, 254.29298402527908, 603.7621372439763, 483.0972874957729, 512.7856150021638, 354.550078135233, 145.4523144163729, 299.185474190301, 276.1198030605472, 588.239373840256, 239.2426771205987, 388.8162781731728, 484.94246135272584, 306.4603783209804, 400.43078777027904, 400.32911771547697, 429.4804485888029, 404.63416458538313, 403.0330644367131, 69.75111689402674, 368.14470273965327, 542.0505031179937, 435.3287152513326, 394.53336175822864, 8.966988615221958, 556.4956673470566, 235.40396690128847, 326.3583347662876, 12.106939097653132, 16.133833913782816, 167.54644504580892, 647.6808232171439, 248.86590853307246, 253.63621739024774, 514.4660072967097, 471.07472689898094, 457.61916482038595, 288.81018419800193, 284.72502509365086, 24.686558968431743, 150.9561779042194, 4.207961155268727, 278.31675810082777, 58.74845492919015, 377.68638286525726, 426.0197546237717, 445.41790901372735, 214.6556242954035, 32.32621636946975, 565.267022734349, 238.9271897925601, 252.91292560468565, 393.3334623152774, 194.01982364009572, 419.0579890794249, 396.5658693861426, 328.972810764443, 545.5970063397529, 210.9019887941408, 563.6324747233937, 346.01885685987247, 372.2350469866922, 419.4722786527418, 196.53396050769484, 223.8009816521152, 454.4344246161606, 391.0086292047435, 279.87243627990955, 351.7790014544843, 88.01573018099435, 166.89926015449757, 113.49934983501063, 404.6507631138838, 459.2513062583251, 496.6698200628468, 369.04314383044164, 672.6077154826681, 297.2502715726505, 442.3874307759922, 181.89405874656626, 420.9798582394215, 428.1470976670434, 414.87120628104594, 349.31413332868345, 537.2306860784485, 713.2924115913355, 20.312896015511264, 290.44627550791427, 550.7900986122582, 292.79792637480233, 160.64641522290225, 83.57383157249552, 420.8528201967318, 721.5578089918703, 172.81867189531647, 441.05278581942855, 234.6339689462721, 574.601049571166, 135.45971445095088, 470.1288156125711, 381.2975690626142, 269.3350180908874, 679.8738097534534, 123.77545501558379, 669.0608480334457, 412.70096793944873, 281.1007749439559, 449.5895165271485, 335.4379087879802, 371.61732491908845, 265.66665233954365, 130.1131911925477, 254.4173766798197, 298.5791936316815, 633.2265678078496, 496.5106016694869, 464.47840989719407, 340.61880658962195, 207.87514525931672, 513.5151296696791, 122.52926914643483, 572.5684554297521, 203.99877474008906, 270.29158721924136, 278.0347025108575, 472.48023426570785, 323.1945406768485, 517.3789070056571, 684.4179208611223, 411.2478614144474, 298.8492161504577, 654.519517584237, 764.2883464733677, 174.86788175688898, 632.5894022167892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.271363001297583, "mean_inference_ms": 6.617176605203711, "mean_action_processing_ms": 2.927506080662424, "mean_env_wait_ms": 17.646230145157862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019562125205993652, "StateBufferConnector_ms": 0.0075032711029052734, "ViewRequirementAgentConnector_ms": 0.21593403816223145}, "num_episodes": 20, "episode_return_max": 513.2265819045587, "episode_return_min": -18.093418021775847, "episode_return_mean": 194.8240247770191, "episodes_this_iter": 20}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 740000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 58.58719379073837, "num_env_steps_trained_throughput_per_sec": 58.58719379073837, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 740000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 740000, "timers": {"training_iteration_time_ms": 85707.567, "restore_workers_time_ms": 0.021, "training_step_time_ms": 85707.49, "sample_time_ms": 3976.181, "learn_time_ms": 81681.587, "learn_throughput": 48.971, "synch_weights_time_ms": 35.31}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 740000}, "done": false, "training_iteration": 37, "trial_id": "62684_00000", "date": "2024-08-20_16-54-33", "timestamp": 1724153073, "time_this_iter_s": 68.32720375061035, "time_total_s": 2804.3960604667664, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffaf670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2804.3960604667664, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 50.583333333333336, "ram_util_percent": 83.33125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.912713716300667, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.3121133532084475, "policy_loss": -0.01911788853422032, "vf_loss": 7.328411749745092, "vf_explained_var": 0.5152139431829994, "kl": 0.014097433765782109, "entropy": 1.0908795116006906, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 105750.5, "diff_num_grad_updates_vs_sampler_policy": 1448.2749999999942}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.56349184172494, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.530734256966404, "policy_loss": -0.01991076652914108, "vf_loss": 8.548283255037177, "vf_explained_var": 0.1257139347848438, "kl": 0.01180879064126029, "entropy": 0.6469166318260172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "env_runners": {"episode_reward_max": 513.2265819045587, "episode_reward_min": -18.093418021775847, "episode_reward_mean": 201.13241044695104, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -764.2883464733677, "predator_policy": 4.207961155268727}, "policy_reward_max": {"prey_policy": 199.1, "predator_policy": 764.2883464733677}, "policy_reward_mean": {"prey_policy": -167.8509875549628, "predator_policy": 352.34268655591995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.28344888276712, 206.23802418626445, 291.16433036234383, 152.44787438008757, 77.02307217186231, 121.80902859120246, 101.6441059863894, 180.75041393860948, 128.0861512284203, 133.81168994802886, 118.07315857153826, 269.08378633692473, 93.05946189533476, 342.09552797355065, 156.00937035293506, 127.39433809293716, 201.6662175982002, 233.2059733789064, 35.01290703400084, 50.70612538899901, 268.9001631376622, 150.37611965314727, 286.88429177359467, 267.27351379329167, 239.81075456887422, 299.2899863530304, 269.082734112281, 34.458660844056496, 82.85167974771753, 300.95361067750764, 203.75971751817872, 336.73185185464104, 151.45516134916076, 151.8433151852658, 113.97701254009351, 158.2870119868212, 507.7255725591668, 205.28078543572872, 28.236948965034482, 77.86967681999343, 162.4512346323675, 403.11192943807856, 262.79343668545215, 337.77309643369415, 50.24115195568893, 172.8278205027674, 378.8036332704695, 182.91564290100362, 356.583713661299, 102.56108510705182, 250.73628246017313, 352.0269148778576, 121.8660521477613, 148.62329025628938, 51.69411464758591, -18.093418021775847, 247.07788945891102, 127.55876399180869, 134.7389918458943, 199.86349253355277, 118.97224130869056, 129.15849493602443, 109.11112088858007, 177.21416093348174, 418.81908418984364, 513.2265819045587, 196.03458161010505, 76.6095638323377, 182.18390299823625, 112.1034547092712, 465.21042271476813, 410.88787876122956, 118.8022897853096, 26.129949606119126, 114.71229519099572, 228.35583440121982, 132.45374292740416, 210.28125325605092, 364.8788083252884, 157.20972861021093, 255.07163427144764, 223.84863312741393, 454.31418428555315, 183.26908939736916, 189.09999999999988, 107.87186343052616, 383.1012905043358, 79.07680958682258, 166.33524291891757, 238.92946073834815, 195.86935898117213, 161.78871994498326, 96.2065592368463, 287.9969931952022, 341.2070722365432, 303.0136697258417, 304.54199531710583, 75.49427458414726, 413.98657498313094, 89.0935333791937], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [117.3834488827671, -500.2722381600059, -519.5069099691265, -578.9810296036151, 93.48271351977506, -172.86673490678157, -556.4458540175963, -9.814889491010028, 91.08504630825972, -26.124480402843517, -347.71025691071276, -232.94952112588075, -643.284094225713, 66.7060035783054, -202.68779708642617, 20.000000000000014, -275.77511964675125, 68.59999999999997, 64.14793147809354, -320.9366812122527, -71.98665565983146, -448.97391515800336, -16.954962635814056, -137.66647183416427, -515.9834338419229, 25.433603204819867, -239.41913940373098, -289.7237206174396, -160.89463732645876, -411.4528546060094, -77.4825638026249, -32.275435310896874, -272.17123486654475, 145.6340224656705, -246.63267394114845, -205.22283943844553, -112.84609639457098, -19.283846956192527, -602.292645714756, -445.9833227917968, -39.77406608821495, -45.905822672338466, -370.07466865532797, -158.75276466549047, -22.054362417504773, -247.97745765582846, -279.83067585490517, -174.6070947006088, -167.75171086622672, -180.48185238094962, -257.7674481767206, 167.68471558138734, -142.13491932917395, -230.23964250698697, -405.49306699214844, -388.05161840001125, -148.82162594316492, -385.77507251750745, 13.107854384815232, 19.872993148240468, 14.720076878472227, 114.54056856330143, -652.2601165524571, -184.1831861566299, 20.000000000000014, -23.905968054161832, 156.07407986419665, 48.148649363986685, -101.01871641417998, -581.662091183341, -215.96579563917876, 168.35466886559573, -187.11437663748316, -203.0303976066353, -138.14669587396477, 128.48390673345136, -226.25653284837267, -531.6312792514157, 25.597958364327102, -223.06614635545847, -106.98428718824123, 4.256668559914628, -37.08181036948589, -108.35893421902378, 61.338993569055624, -238.87097118967392, -22.141061887760912, -67.91551771844783, 189.92116724016697, -257.48687663865775, 68.34834957055041, -372.35276479202446, -363.67353089784604, -200.4556242954037, 179.81381786589026, 110.3918176192802, 110.64658796733994, -537.5584493525279, -225.82718979256086, -121.97663850828073, -388.7334623152771, 16.307028088860868, -84.41982364009557, -110.5995326773767, -304.08144386195164, -427.25994343505107, -108.16945357855904, -31.82227115015147, 185.53048624742587, -580.6683817260157, 146.36447290386204, -337.5996422955999, -563.1324747233936, 196.3615708714583, -416.2574106585334, -367.2129660158657, 20.000000000000014, 12.546535789989008, -140.54052796744568, -214.4712731623604, -13.146353666784561, -209.7360859488325, -460.1093795729179, -424.842600253576, 45.82262329792875, 150.48046865933205, -172.44538712888962, -18.77616652114928, 199.1, 72.83121792997513, -420.8082344451754, 167.6, -410.65463512418705, -494.09608820843977, -0.9292510328560019, -146.6490929334887, -672.4646424645338, -49.7093034123197, 139.75548569802677, -35.71004879389368, -464.8795059823069, 41.93051053618186, -70.67620373377842, -391.212580887388, -53.12445247008262, 149.1196596559335, -582.4297974726426, -281.75519969316923, -537.1306860784484, 34.902151471539185, 174.6985273267891, 55.724859117873024, -713.2924115913355, -616.899152351619, -30.694876405898015, 158.38456951520155, -107.20064944017787, -172.38247952587903, -51.99516048388552, -391.7528201967318, -37.83510105568486, 73.7845597394792, -699.5458334645758, -102.8758266033766, -40.26070617164828, -225.73396894627257, -35.67943677795035, -432.3667670632541, -136.26331613733328, -466.41955842587225, 139.7, -443.4353352407789, -295.0484019661141, 14.616116523516762, -679.8738097534534, -260.9172760837825, 126.32124983878919, 1.9742815586290738, 74.11375595933998, -669.0608480334457, -144.48292983544664, -203.04470257836226, -227.3018691609058, 19.01611652351683, -227.39553037547202, -447.48951652714845, -101.8106878495098, -58.890311389695675, -367.47185713084656, -242.15238541453448, -79.09837409644386, 113.93435257209264, 66.04504090598878, -756.178019465923, 177.1463013102479, -632.269003276399, 165.14336054291195, 19.363213071364157, 180.1345816101057, -196.77514525931733, -335.81880658962206, 47.78240227547019, -106.62926914643573, -500.58796811281155, -269.4909733676315, 58.003429423725464, -382.8957832276975, -107.40998413317001, -266.334702510855, -62.47814837679991, 7.655247001599228, -459.6166213612266, 121.49702213183731, -593.3733812009516, 177.7369895295598, -375.27255743415816, 30.306475044444063, -366.9000052858162, -254.70125753822273, -648.389567978118, -764.2883464733677, 20.000000000000014, 77.17493163278317, -632.5041963227703, -137.41572409269526, 63.708424802737724, -90.93593925926129, -150.58594050097204, -557.5462090812887, -298.02415169581946, -135.49422654752357, -55.282590736069096, -477.74542761298267, -98.72271868805068, -509.8462071619568, 55.429644538472495, 27.607544561801042, -77.18757249010639, 67.05748836583723, -396.78083677574114, 185.54666539562248, -133.40414407298005, -621.8600036195904, 20.000000000000014, -524.9988797702541, -95.67559083490654, 144.52760483857054, 119.5492785186537, -388.0477735533925, -270.0386526933299, -53.632381931989585, -32.6822102550535, -384.500857549338, 183.8, -578.7320552029714, 44.78475320510597, -100.45953208208708, -117.7362438401453, 157.6797769343745, -464.40870969041686, -27.073113872240288, -95.65541625011306, -434.1599639117458, -184.49261979754152, -204.38913949728743, -173.52323574490651, 12.435727854025094, -131.05666658706988, -227.77357742231484, 115.18721107386284, -616.0095080627984, -21.87292510327754, -6.563707011198076, 158.04717474445127, -586.9151049184504, -615.2357254759174, 18.02863098808193, -297.9687095510365, -61.22450454371662, 188.98562335017903, -403.3782401911266, 68.80606576906098, -99.20044213339303, -189.5723243722219, 191.72038590270847, -210.2362902841677, -23.112324697921846, 194.79451055996847, 120.99309458408307, -4.234515967378021, -616.8877106906157, -21.475593118733073, -333.4567800671377, -347.0978272814725, 183.63779442030278, 150.37094657934873, -501.87855380190655, -195.70444570218064, -185.6791564741142, -557.2463226119796], "policy_predator_policy_reward": [500.9722381600059, 521.706909969127, 685.7379571074966, 178.86511806938975, 261.18101719348016, 505.1590103692109, 245.14952112588006, 514.0826116936437, 643.284094225713, 213.00486567998286, 46.91977963887533, 262.06436859908047, 100.45518700141551, 329.9643243789648, 494.8949934338295, 289.45077013276165, 254.29298402527908, 603.7621372439763, 483.0972874957729, 512.7856150021638, 354.550078135233, 145.4523144163729, 299.185474190301, 276.1198030605472, 588.239373840256, 239.2426771205987, 388.8162781731728, 484.94246135272584, 306.4603783209804, 400.43078777027904, 400.32911771547697, 429.4804485888029, 404.63416458538313, 403.0330644367131, 69.75111689402674, 368.14470273965327, 542.0505031179937, 435.3287152513326, 394.53336175822864, 8.966988615221958, 556.4956673470566, 235.40396690128847, 326.3583347662876, 12.106939097653132, 16.133833913782816, 167.54644504580892, 647.6808232171439, 248.86590853307246, 253.63621739024774, 514.4660072967097, 471.07472689898094, 457.61916482038595, 288.81018419800193, 284.72502509365086, 24.686558968431743, 150.9561779042194, 4.207961155268727, 278.31675810082777, 58.74845492919015, 377.68638286525726, 426.0197546237717, 445.41790901372735, 214.6556242954035, 32.32621636946975, 565.267022734349, 238.9271897925601, 252.91292560468565, 393.3334623152774, 194.01982364009572, 419.0579890794249, 396.5658693861426, 328.972810764443, 545.5970063397529, 210.9019887941408, 563.6324747233937, 346.01885685987247, 372.2350469866922, 419.4722786527418, 196.53396050769484, 223.8009816521152, 454.4344246161606, 391.0086292047435, 279.87243627990955, 351.7790014544843, 88.01573018099435, 166.89926015449757, 113.49934983501063, 404.6507631138838, 459.2513062583251, 496.6698200628468, 369.04314383044164, 672.6077154826681, 297.2502715726505, 442.3874307759922, 181.89405874656626, 420.9798582394215, 428.1470976670434, 414.87120628104594, 349.31413332868345, 537.2306860784485, 713.2924115913355, 20.312896015511264, 290.44627550791427, 550.7900986122582, 292.79792637480233, 160.64641522290225, 83.57383157249552, 420.8528201967318, 721.5578089918703, 172.81867189531647, 441.05278581942855, 234.6339689462721, 574.601049571166, 135.45971445095088, 470.1288156125711, 381.2975690626142, 269.3350180908874, 679.8738097534534, 123.77545501558379, 669.0608480334457, 412.70096793944873, 281.1007749439559, 449.5895165271485, 335.4379087879802, 371.61732491908845, 265.66665233954365, 130.1131911925477, 254.4173766798197, 298.5791936316815, 633.2265678078496, 496.5106016694869, 464.47840989719407, 340.61880658962195, 207.87514525931672, 513.5151296696791, 122.52926914643483, 572.5684554297521, 203.99877474008906, 270.29158721924136, 278.0347025108575, 472.48023426570785, 323.1945406768485, 517.3789070056571, 684.4179208611223, 411.2478614144474, 298.8492161504577, 654.519517584237, 764.2883464733677, 174.86788175688898, 632.5894022167892, 99.28171277353476, 306.8875765851818, 565.1721211707503, 558.3462090812886, 556.5200442353536, 285.51194605779983, 351.3786584910743, 440.30916789589844, 163.43981273448077, 400.68083677574094, 599.1223792131549, 225.66673735524043, 335.3271261051406, 489.195977627435, 309.415552702402, 268.8695217793168, 144.07409272373513, 395.5482415540069, 389.8008575493384, 578.7320552029714, 53.25284867559827, 228.03003747205383, 263.488456795277, 453.4148803373409, 396.3393742340994, 397.0454353121235, 321.453411643262, 210.35847866382474, 259.01181507873883, 223.56067859513124, 751.9299453905786, 88.3855537678681, 617.8772706764497, 588.0151049184507, 110.8076870538693, 326.56345528964823, 16.805304075962944, 416.7782401911267, 4.298151536949064, 433.96130130249963, 223.13629028416696, 118.4314838637951, 535.9279323626362, 268.7431950283794, 337.3747160589082, 440.1497589925829, 484.293261898516, 97.56312588686997, 557.5463226119797, 470.17713555548835]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.250751744174078, "mean_inference_ms": 6.577772130031827, "mean_action_processing_ms": 2.8971295392835597, "mean_env_wait_ms": 17.595253367077802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010091423988342285, "StateBufferConnector_ms": 0.007801175117492676, "ViewRequirementAgentConnector_ms": 0.20957064628601074}, "num_episodes": 25, "episode_return_max": 513.2265819045587, "episode_return_min": -18.093418021775847, "episode_return_mean": 201.13241044695104, "episodes_this_iter": 25}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 57.74269472679761, "num_env_steps_trained_throughput_per_sec": 57.74269472679761, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 85598.722, "restore_workers_time_ms": 0.021, "training_step_time_ms": 85598.645, "sample_time_ms": 3851.784, "learn_time_ms": 81697.937, "learn_throughput": 48.961, "synch_weights_time_ms": 35.763}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "done": false, "training_iteration": 38, "trial_id": "62684_00000", "date": "2024-08-20_16-55-43", "timestamp": 1724153143, "time_this_iter_s": 69.3280668258667, "time_total_s": 2873.724127292633, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3acade4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2873.724127292633, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 52.69795918367347, "ram_util_percent": 83.25102040816326}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.763878481650183, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.352124443967291, "policy_loss": -0.021355934816508403, "vf_loss": 7.370365669879508, "vf_explained_var": 0.522086856487795, "kl": 0.015573494599352703, "entropy": 1.072365255009198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 108570.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.558033760767135, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.519322533077665, "policy_loss": -0.020599368730283996, "vf_loss": 8.537527103777284, "vf_explained_var": 0.09462509019664986, "kl": 0.011973905769575919, "entropy": 0.6025040257071692, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "env_runners": {"episode_reward_max": 513.2265819045587, "episode_reward_min": -18.093418021775847, "episode_reward_mean": 212.51135502192813, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -764.2883464733677, "predator_policy": 4.207961155268727}, "policy_reward_max": {"prey_policy": 199.1, "predator_policy": 764.2883464733677}, "policy_reward_mean": {"prey_policy": -163.94118322333924, "predator_policy": 352.167452345973}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.70612538899901, 268.9001631376622, 150.37611965314727, 286.88429177359467, 267.27351379329167, 239.81075456887422, 299.2899863530304, 269.082734112281, 34.458660844056496, 82.85167974771753, 300.95361067750764, 203.75971751817872, 336.73185185464104, 151.45516134916076, 151.8433151852658, 113.97701254009351, 158.2870119868212, 507.7255725591668, 205.28078543572872, 28.236948965034482, 77.86967681999343, 162.4512346323675, 403.11192943807856, 262.79343668545215, 337.77309643369415, 50.24115195568893, 172.8278205027674, 378.8036332704695, 182.91564290100362, 356.583713661299, 102.56108510705182, 250.73628246017313, 352.0269148778576, 121.8660521477613, 148.62329025628938, 51.69411464758591, -18.093418021775847, 247.07788945891102, 127.55876399180869, 134.7389918458943, 199.86349253355277, 118.97224130869056, 129.15849493602443, 109.11112088858007, 177.21416093348174, 418.81908418984364, 513.2265819045587, 196.03458161010505, 76.6095638323377, 182.18390299823625, 112.1034547092712, 465.21042271476813, 410.88787876122956, 118.8022897853096, 26.129949606119126, 114.71229519099572, 228.35583440121982, 132.45374292740416, 210.28125325605092, 364.8788083252884, 157.20972861021093, 255.07163427144764, 223.84863312741393, 454.31418428555315, 183.26908939736916, 189.09999999999988, 107.87186343052616, 383.1012905043358, 79.07680958682258, 166.33524291891757, 238.92946073834815, 195.86935898117213, 161.78871994498326, 96.2065592368463, 287.9969931952022, 341.2070722365432, 303.0136697258417, 304.54199531710583, 75.49427458414726, 413.98657498313094, 89.0935333791937, 352.2298335108974, 327.9211857078885, 370.83180741805063, 270.67850034691713, 150.04268106075827, 150.98653787378532, 111.58004854601668, 118.97700089727888, 161.42982761668833, 231.65274038958026, 313.8120074704754, 203.1954223332745, 94.30234783010903, 342.22814323826844, 219.68607540593229, 414.59848310296917, 184.64424213292804, 125.41362107800684, 82.54283244818676], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-385.77507251750745, 13.107854384815232, 19.872993148240468, 14.720076878472227, 114.54056856330143, -652.2601165524571, -184.1831861566299, 20.000000000000014, -23.905968054161832, 156.07407986419665, 48.148649363986685, -101.01871641417998, -581.662091183341, -215.96579563917876, 168.35466886559573, -187.11437663748316, -203.0303976066353, -138.14669587396477, 128.48390673345136, -226.25653284837267, -531.6312792514157, 25.597958364327102, -223.06614635545847, -106.98428718824123, 4.256668559914628, -37.08181036948589, -108.35893421902378, 61.338993569055624, -238.87097118967392, -22.141061887760912, -67.91551771844783, 189.92116724016697, -257.48687663865775, 68.34834957055041, -372.35276479202446, -363.67353089784604, -200.4556242954037, 179.81381786589026, 110.3918176192802, 110.64658796733994, -537.5584493525279, -225.82718979256086, -121.97663850828073, -388.7334623152771, 16.307028088860868, -84.41982364009557, -110.5995326773767, -304.08144386195164, -427.25994343505107, -108.16945357855904, -31.82227115015147, 185.53048624742587, -580.6683817260157, 146.36447290386204, -337.5996422955999, -563.1324747233936, 196.3615708714583, -416.2574106585334, -367.2129660158657, 20.000000000000014, 12.546535789989008, -140.54052796744568, -214.4712731623604, -13.146353666784561, -209.7360859488325, -460.1093795729179, -424.842600253576, 45.82262329792875, 150.48046865933205, -172.44538712888962, -18.77616652114928, 199.1, 72.83121792997513, -420.8082344451754, 167.6, -410.65463512418705, -494.09608820843977, -0.9292510328560019, -146.6490929334887, -672.4646424645338, -49.7093034123197, 139.75548569802677, -35.71004879389368, -464.8795059823069, 41.93051053618186, -70.67620373377842, -391.212580887388, -53.12445247008262, 149.1196596559335, -582.4297974726426, -281.75519969316923, -537.1306860784484, 34.902151471539185, 174.6985273267891, 55.724859117873024, -713.2924115913355, -616.899152351619, -30.694876405898015, 158.38456951520155, -107.20064944017787, -172.38247952587903, -51.99516048388552, -391.7528201967318, -37.83510105568486, 73.7845597394792, -699.5458334645758, -102.8758266033766, -40.26070617164828, -225.73396894627257, -35.67943677795035, -432.3667670632541, -136.26331613733328, -466.41955842587225, 139.7, -443.4353352407789, -295.0484019661141, 14.616116523516762, -679.8738097534534, -260.9172760837825, 126.32124983878919, 1.9742815586290738, 74.11375595933998, -669.0608480334457, -144.48292983544664, -203.04470257836226, -227.3018691609058, 19.01611652351683, -227.39553037547202, -447.48951652714845, -101.8106878495098, -58.890311389695675, -367.47185713084656, -242.15238541453448, -79.09837409644386, 113.93435257209264, 66.04504090598878, -756.178019465923, 177.1463013102479, -632.269003276399, 165.14336054291195, 19.363213071364157, 180.1345816101057, -196.77514525931733, -335.81880658962206, 47.78240227547019, -106.62926914643573, -500.58796811281155, -269.4909733676315, 58.003429423725464, -382.8957832276975, -107.40998413317001, -266.334702510855, -62.47814837679991, 7.655247001599228, -459.6166213612266, 121.49702213183731, -593.3733812009516, 177.7369895295598, -375.27255743415816, 30.306475044444063, -366.9000052858162, -254.70125753822273, -648.389567978118, -764.2883464733677, 20.000000000000014, 77.17493163278317, -632.5041963227703, -137.41572409269526, 63.708424802737724, -90.93593925926129, -150.58594050097204, -557.5462090812887, -298.02415169581946, -135.49422654752357, -55.282590736069096, -477.74542761298267, -98.72271868805068, -509.8462071619568, 55.429644538472495, 27.607544561801042, -77.18757249010639, 67.05748836583723, -396.78083677574114, 185.54666539562248, -133.40414407298005, -621.8600036195904, 20.000000000000014, -524.9988797702541, -95.67559083490654, 144.52760483857054, 119.5492785186537, -388.0477735533925, -270.0386526933299, -53.632381931989585, -32.6822102550535, -384.500857549338, 183.8, -578.7320552029714, 44.78475320510597, -100.45953208208708, -117.7362438401453, 157.6797769343745, -464.40870969041686, -27.073113872240288, -95.65541625011306, -434.1599639117458, -184.49261979754152, -204.38913949728743, -173.52323574490651, 12.435727854025094, -131.05666658706988, -227.77357742231484, 115.18721107386284, -616.0095080627984, -21.87292510327754, -6.563707011198076, 158.04717474445127, -586.9151049184504, -615.2357254759174, 18.02863098808193, -297.9687095510365, -61.22450454371662, 188.98562335017903, -403.3782401911266, 68.80606576906098, -99.20044213339303, -189.5723243722219, 191.72038590270847, -210.2362902841677, -23.112324697921846, 194.79451055996847, 120.99309458408307, -4.234515967378021, -616.8877106906157, -21.475593118733073, -333.4567800671377, -347.0978272814725, 183.63779442030278, 150.37094657934873, -501.87855380190655, -195.70444570218064, -185.6791564741142, -557.2463226119796, -99.67807264630135, 181.2792730054773, -445.93271885193076, 189.8006872039985, -106.45855010677715, -107.33165857223327, 154.31420569873092, -491.7029581214939, 22.427575536366177, -526.08545168496, 9.22556079464358, 2.095729225572202, -355.19502738886644, -304.432572003593, 99.69999999999997, -518.9836407954654, -333.1607360451388, 32.39622409744401, -401.1696047963338, -564.716509394773, 90.74180000038288, 63.24049465983076, 19.09514047488909, -651.7474737304522, -78.86654800786197, -526.5881595844266, -0.1842198643029933, -0.6888027194287076, -139.4170609827449, -675.1768108614275, -28.020269819406888, 182.74195436602912, -268.44815856757884, 39.73357971157727, -199.8433197909263, -191.20580200290067, 95.21223044807482, -448.76153938722604, -753.365552073882, -0.021400855590339773, -383.847051102727, 164.18725580322203, 20.661389749047853, -257.0662678869379, -109.26438079918479, -36.90324520140095, 180.2, -572.4679910695589, -312.3687932891709, -462.8300867136072, 147.8, -480.11626291238605, -181.77409742841118, -75.92073055441321, -51.68607328699245, -423.0677795326107, -51.57979220037026], "policy_predator_policy_reward": [394.53336175822864, 8.966988615221958, 556.4956673470566, 235.40396690128847, 326.3583347662876, 12.106939097653132, 16.133833913782816, 167.54644504580892, 647.6808232171439, 248.86590853307246, 253.63621739024774, 514.4660072967097, 471.07472689898094, 457.61916482038595, 288.81018419800193, 284.72502509365086, 24.686558968431743, 150.9561779042194, 4.207961155268727, 278.31675810082777, 58.74845492919015, 377.68638286525726, 426.0197546237717, 445.41790901372735, 214.6556242954035, 32.32621636946975, 565.267022734349, 238.9271897925601, 252.91292560468565, 393.3334623152774, 194.01982364009572, 419.0579890794249, 396.5658693861426, 328.972810764443, 545.5970063397529, 210.9019887941408, 563.6324747233937, 346.01885685987247, 372.2350469866922, 419.4722786527418, 196.53396050769484, 223.8009816521152, 454.4344246161606, 391.0086292047435, 279.87243627990955, 351.7790014544843, 88.01573018099435, 166.89926015449757, 113.49934983501063, 404.6507631138838, 459.2513062583251, 496.6698200628468, 369.04314383044164, 672.6077154826681, 297.2502715726505, 442.3874307759922, 181.89405874656626, 420.9798582394215, 428.1470976670434, 414.87120628104594, 349.31413332868345, 537.2306860784485, 713.2924115913355, 20.312896015511264, 290.44627550791427, 550.7900986122582, 292.79792637480233, 160.64641522290225, 83.57383157249552, 420.8528201967318, 721.5578089918703, 172.81867189531647, 441.05278581942855, 234.6339689462721, 574.601049571166, 135.45971445095088, 470.1288156125711, 381.2975690626142, 269.3350180908874, 679.8738097534534, 123.77545501558379, 669.0608480334457, 412.70096793944873, 281.1007749439559, 449.5895165271485, 335.4379087879802, 371.61732491908845, 265.66665233954365, 130.1131911925477, 254.4173766798197, 298.5791936316815, 633.2265678078496, 496.5106016694869, 464.47840989719407, 340.61880658962195, 207.87514525931672, 513.5151296696791, 122.52926914643483, 572.5684554297521, 203.99877474008906, 270.29158721924136, 278.0347025108575, 472.48023426570785, 323.1945406768485, 517.3789070056571, 684.4179208611223, 411.2478614144474, 298.8492161504577, 654.519517584237, 764.2883464733677, 174.86788175688898, 632.5894022167892, 99.28171277353476, 306.8875765851818, 565.1721211707503, 558.3462090812886, 556.5200442353536, 285.51194605779983, 351.3786584910743, 440.30916789589844, 163.43981273448077, 400.68083677574094, 599.1223792131549, 225.66673735524043, 335.3271261051406, 489.195977627435, 309.415552702402, 268.8695217793168, 144.07409272373513, 395.5482415540069, 389.8008575493384, 578.7320552029714, 53.25284867559827, 228.03003747205383, 263.488456795277, 453.4148803373409, 396.3393742340994, 397.0454353121235, 321.453411643262, 210.35847866382474, 259.01181507873883, 223.56067859513124, 751.9299453905786, 88.3855537678681, 617.8772706764497, 588.0151049184507, 110.8076870538693, 326.56345528964823, 16.805304075962944, 416.7782401911267, 4.298151536949064, 433.96130130249963, 223.13629028416696, 118.4314838637951, 535.9279323626362, 268.7431950283794, 337.3747160589082, 440.1497589925829, 484.293261898516, 97.56312588686997, 557.5463226119797, 470.17713555548835, 298.87780720447637, 417.68354479917446, 110.2112872934612, 241.69941988943788, 402.77428213688177, 283.01870216756606, 454.0760642313698, 331.3665977802903, 323.800679871966, 386.16960058125284, 683.7244661515823, 287.01022446536376, 565.2165093947731, 421.5078533419693, 35.410855887180205, 652.9779836058312, 526.5881595844266, 240.48059548885314, 584.42192715991, 462.51348779327043, 130.29096213369036, 297.24751935774304, 182.06723004939602, 372.4437343661285, 447.82958988251465, 753.3876189606277, 338.13132715172384, 223.77801224163935, 242.3746505291406, 322.9806838138694, 402.16180793173584, 441.60791144219206, 494.99885094256217, 317.0442711931456, 495.1146661597542, 368.1100458134627, 177.28175432243924, 431.5947231457218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.22307792629083, "mean_inference_ms": 6.57419198389904, "mean_action_processing_ms": 2.909697364591681, "mean_env_wait_ms": 17.538932709085728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009148955345153809, "StateBufferConnector_ms": 0.008040308952331543, "ViewRequirementAgentConnector_ms": 0.21573424339294434}, "num_episodes": 19, "episode_return_max": 513.2265819045587, "episode_return_min": -18.093418021775847, "episode_return_mean": 212.51135502192813, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 58.65121027033829, "num_env_steps_trained_throughput_per_sec": 58.65121027033829, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 780000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 85628.188, "restore_workers_time_ms": 0.024, "training_step_time_ms": 85628.106, "sample_time_ms": 3987.417, "learn_time_ms": 81591.713, "learn_throughput": 49.025, "synch_weights_time_ms": 36.007}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "training_iteration": 39, "trial_id": "62684_00000", "date": "2024-08-20_16-56-51", "timestamp": 1724153211, "time_this_iter_s": 68.25118803977966, "time_total_s": 2941.9753153324127, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb01550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2941.9753153324127, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 52.49270833333333, "ram_util_percent": 83.34791666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.71602879800695, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.31062374368627, "policy_loss": -0.01881278001815609, "vf_loss": 7.326611000426272, "vf_explained_var": 0.49965040381495834, "kl": 0.014127585949237518, "entropy": 1.0783785424545302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 111390.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.718559248737558, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.480202131170444, "policy_loss": -0.022310640543413463, "vf_loss": 8.499786905258421, "vf_explained_var": 0.09844641310197336, "kl": 0.013629259152840528, "entropy": 0.6464604944779129, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 513.2265819045587, "episode_reward_min": -18.093418021775847, "episode_reward_mean": 205.6820521352144, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -764.2883464733677, "predator_policy": 4.298151536949064}, "policy_reward_max": {"prey_policy": 199.1, "predator_policy": 764.2883464733677}, "policy_reward_mean": {"prey_policy": -176.75641548666857, "predator_policy": 367.97564929761023}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.236948965034482, 77.86967681999343, 162.4512346323675, 403.11192943807856, 262.79343668545215, 337.77309643369415, 50.24115195568893, 172.8278205027674, 378.8036332704695, 182.91564290100362, 356.583713661299, 102.56108510705182, 250.73628246017313, 352.0269148778576, 121.8660521477613, 148.62329025628938, 51.69411464758591, -18.093418021775847, 247.07788945891102, 127.55876399180869, 134.7389918458943, 199.86349253355277, 118.97224130869056, 129.15849493602443, 109.11112088858007, 177.21416093348174, 418.81908418984364, 513.2265819045587, 196.03458161010505, 76.6095638323377, 182.18390299823625, 112.1034547092712, 465.21042271476813, 410.88787876122956, 118.8022897853096, 26.129949606119126, 114.71229519099572, 228.35583440121982, 132.45374292740416, 210.28125325605092, 364.8788083252884, 157.20972861021093, 255.07163427144764, 223.84863312741393, 454.31418428555315, 183.26908939736916, 189.09999999999988, 107.87186343052616, 383.1012905043358, 79.07680958682258, 166.33524291891757, 238.92946073834815, 195.86935898117213, 161.78871994498326, 96.2065592368463, 287.9969931952022, 341.2070722365432, 303.0136697258417, 304.54199531710583, 75.49427458414726, 413.98657498313094, 89.0935333791937, 352.2298335108974, 327.9211857078885, 370.83180741805063, 270.67850034691713, 150.04268106075827, 150.98653787378532, 111.58004854601668, 118.97700089727888, 161.42982761668833, 231.65274038958026, 313.8120074704754, 203.1954223332745, 94.30234783010903, 342.22814323826844, 219.68607540593229, 414.59848310296917, 184.64424213292804, 125.41362107800684, 82.54283244818676, 304.04600286734944, 147.20881240719817, 82.01671194556768, 207.8310856340667, 117.4280703940181, 177.22681666747943, 213.0146771847975, 158.19009870659107, 312.3399191134351, 187.74947003841277, 140.06131897939616, 109.73564294686366, 189.25717725106554, 139.87914852810326, 193.67281799478883, 231.07285504583513, 148.44405601733348, 159.79831763305725, 177.74478045248097], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-416.2574106585334, -367.2129660158657, 20.000000000000014, 12.546535789989008, -140.54052796744568, -214.4712731623604, -13.146353666784561, -209.7360859488325, -460.1093795729179, -424.842600253576, 45.82262329792875, 150.48046865933205, -172.44538712888962, -18.77616652114928, 199.1, 72.83121792997513, -420.8082344451754, 167.6, -410.65463512418705, -494.09608820843977, -0.9292510328560019, -146.6490929334887, -672.4646424645338, -49.7093034123197, 139.75548569802677, -35.71004879389368, -464.8795059823069, 41.93051053618186, -70.67620373377842, -391.212580887388, -53.12445247008262, 149.1196596559335, -582.4297974726426, -281.75519969316923, -537.1306860784484, 34.902151471539185, 174.6985273267891, 55.724859117873024, -713.2924115913355, -616.899152351619, -30.694876405898015, 158.38456951520155, -107.20064944017787, -172.38247952587903, -51.99516048388552, -391.7528201967318, -37.83510105568486, 73.7845597394792, -699.5458334645758, -102.8758266033766, -40.26070617164828, -225.73396894627257, -35.67943677795035, -432.3667670632541, -136.26331613733328, -466.41955842587225, 139.7, -443.4353352407789, -295.0484019661141, 14.616116523516762, -679.8738097534534, -260.9172760837825, 126.32124983878919, 1.9742815586290738, 74.11375595933998, -669.0608480334457, -144.48292983544664, -203.04470257836226, -227.3018691609058, 19.01611652351683, -227.39553037547202, -447.48951652714845, -101.8106878495098, -58.890311389695675, -367.47185713084656, -242.15238541453448, -79.09837409644386, 113.93435257209264, 66.04504090598878, -756.178019465923, 177.1463013102479, -632.269003276399, 165.14336054291195, 19.363213071364157, 180.1345816101057, -196.77514525931733, -335.81880658962206, 47.78240227547019, -106.62926914643573, -500.58796811281155, -269.4909733676315, 58.003429423725464, -382.8957832276975, -107.40998413317001, -266.334702510855, -62.47814837679991, 7.655247001599228, -459.6166213612266, 121.49702213183731, -593.3733812009516, 177.7369895295598, -375.27255743415816, 30.306475044444063, -366.9000052858162, -254.70125753822273, -648.389567978118, -764.2883464733677, 20.000000000000014, 77.17493163278317, -632.5041963227703, -137.41572409269526, 63.708424802737724, -90.93593925926129, -150.58594050097204, -557.5462090812887, -298.02415169581946, -135.49422654752357, -55.282590736069096, -477.74542761298267, -98.72271868805068, -509.8462071619568, 55.429644538472495, 27.607544561801042, -77.18757249010639, 67.05748836583723, -396.78083677574114, 185.54666539562248, -133.40414407298005, -621.8600036195904, 20.000000000000014, -524.9988797702541, -95.67559083490654, 144.52760483857054, 119.5492785186537, -388.0477735533925, -270.0386526933299, -53.632381931989585, -32.6822102550535, -384.500857549338, 183.8, -578.7320552029714, 44.78475320510597, -100.45953208208708, -117.7362438401453, 157.6797769343745, -464.40870969041686, -27.073113872240288, -95.65541625011306, -434.1599639117458, -184.49261979754152, -204.38913949728743, -173.52323574490651, 12.435727854025094, -131.05666658706988, -227.77357742231484, 115.18721107386284, -616.0095080627984, -21.87292510327754, -6.563707011198076, 158.04717474445127, -586.9151049184504, -615.2357254759174, 18.02863098808193, -297.9687095510365, -61.22450454371662, 188.98562335017903, -403.3782401911266, 68.80606576906098, -99.20044213339303, -189.5723243722219, 191.72038590270847, -210.2362902841677, -23.112324697921846, 194.79451055996847, 120.99309458408307, -4.234515967378021, -616.8877106906157, -21.475593118733073, -333.4567800671377, -347.0978272814725, 183.63779442030278, 150.37094657934873, -501.87855380190655, -195.70444570218064, -185.6791564741142, -557.2463226119796, -99.67807264630135, 181.2792730054773, -445.93271885193076, 189.8006872039985, -106.45855010677715, -107.33165857223327, 154.31420569873092, -491.7029581214939, 22.427575536366177, -526.08545168496, 9.22556079464358, 2.095729225572202, -355.19502738886644, -304.432572003593, 99.69999999999997, -518.9836407954654, -333.1607360451388, 32.39622409744401, -401.1696047963338, -564.716509394773, 90.74180000038288, 63.24049465983076, 19.09514047488909, -651.7474737304522, -78.86654800786197, -526.5881595844266, -0.1842198643029933, -0.6888027194287076, -139.4170609827449, -675.1768108614275, -28.020269819406888, 182.74195436602912, -268.44815856757884, 39.73357971157727, -199.8433197909263, -191.20580200290067, 95.21223044807482, -448.76153938722604, -753.365552073882, -0.021400855590339773, -383.847051102727, 164.18725580322203, 20.661389749047853, -257.0662678869379, -109.26438079918479, -36.90324520140095, 180.2, -572.4679910695589, -312.3687932891709, -462.8300867136072, 147.8, -480.11626291238605, -181.77409742841118, -75.92073055441321, -51.68607328699245, -423.0677795326107, -51.57979220037026, -476.9485306443023, 54.80092278464382, 1.0801097166674047, -139.74035786179635, -633.7099449712545, 106.54071129805871, -138.5724779649571, -608.9780894678393, -211.16921862766188, 25.47952142745313, -45.83840904996764, -243.2514980938485, -357.3174929006901, 69.29170418249348, -365.8249936759848, -127.70567124421473, -85.5853753464295, -320.7094951953979, -317.6555519556865, 198.2601360824128, -287.1633540310298, -58.099973186347825, -684.9892474320039, -5.09604350255561, -37.35283117327846, -199.65201539070245, 23.49647616043047, 13.036389791995134, -400.49753230675503, -228.68321635745576, -246.9385426277934, -25.026527403260843, -541.4882793704267, -458.2927534085688, 103.62869568974281, -402.7764450860834, -737.8524654308544, 177.86509181845082, -240.51639389781886, -559.9803173042354, 126.65092431177624, -376.36333139893276, 28.47049818925057, -30.806640131111642, 10.690582356436213, 112.18264632178452, -206.064480789273, -260.19064274550016, -443.4073180486234, 6.5064540133999245, -12.187381052738951, -304.7331395026632, -243.43500719046563, -51.58514009586783, 175.3316841972103, -594.7480629137199, -639.952783236914], "policy_predator_policy_reward": [372.2350469866922, 419.4722786527418, 196.53396050769484, 223.8009816521152, 454.4344246161606, 391.0086292047435, 279.87243627990955, 351.7790014544843, 88.01573018099435, 166.89926015449757, 113.49934983501063, 404.6507631138838, 459.2513062583251, 496.6698200628468, 369.04314383044164, 672.6077154826681, 297.2502715726505, 442.3874307759922, 181.89405874656626, 420.9798582394215, 428.1470976670434, 414.87120628104594, 349.31413332868345, 537.2306860784485, 713.2924115913355, 20.312896015511264, 290.44627550791427, 550.7900986122582, 292.79792637480233, 160.64641522290225, 83.57383157249552, 420.8528201967318, 721.5578089918703, 172.81867189531647, 441.05278581942855, 234.6339689462721, 574.601049571166, 135.45971445095088, 470.1288156125711, 381.2975690626142, 269.3350180908874, 679.8738097534534, 123.77545501558379, 669.0608480334457, 412.70096793944873, 281.1007749439559, 449.5895165271485, 335.4379087879802, 371.61732491908845, 265.66665233954365, 130.1131911925477, 254.4173766798197, 298.5791936316815, 633.2265678078496, 496.5106016694869, 464.47840989719407, 340.61880658962195, 207.87514525931672, 513.5151296696791, 122.52926914643483, 572.5684554297521, 203.99877474008906, 270.29158721924136, 278.0347025108575, 472.48023426570785, 323.1945406768485, 517.3789070056571, 684.4179208611223, 411.2478614144474, 298.8492161504577, 654.519517584237, 764.2883464733677, 174.86788175688898, 632.5894022167892, 99.28171277353476, 306.8875765851818, 565.1721211707503, 558.3462090812886, 556.5200442353536, 285.51194605779983, 351.3786584910743, 440.30916789589844, 163.43981273448077, 400.68083677574094, 599.1223792131549, 225.66673735524043, 335.3271261051406, 489.195977627435, 309.415552702402, 268.8695217793168, 144.07409272373513, 395.5482415540069, 389.8008575493384, 578.7320552029714, 53.25284867559827, 228.03003747205383, 263.488456795277, 453.4148803373409, 396.3393742340994, 397.0454353121235, 321.453411643262, 210.35847866382474, 259.01181507873883, 223.56067859513124, 751.9299453905786, 88.3855537678681, 617.8772706764497, 588.0151049184507, 110.8076870538693, 326.56345528964823, 16.805304075962944, 416.7782401911267, 4.298151536949064, 433.96130130249963, 223.13629028416696, 118.4314838637951, 535.9279323626362, 268.7431950283794, 337.3747160589082, 440.1497589925829, 484.293261898516, 97.56312588686997, 557.5463226119797, 470.17713555548835, 298.87780720447637, 417.68354479917446, 110.2112872934612, 241.69941988943788, 402.77428213688177, 283.01870216756606, 454.0760642313698, 331.3665977802903, 323.800679871966, 386.16960058125284, 683.7244661515823, 287.01022446536376, 565.2165093947731, 421.5078533419693, 35.410855887180205, 652.9779836058312, 526.5881595844266, 240.48059548885314, 584.42192715991, 462.51348779327043, 130.29096213369036, 297.24751935774304, 182.06723004939602, 372.4437343661285, 447.82958988251465, 753.3876189606277, 338.13132715172384, 223.77801224163935, 242.3746505291406, 322.9806838138694, 402.16180793173584, 441.60791144219206, 494.99885094256217, 317.0442711931456, 495.1146661597542, 368.1100458134627, 177.28175432243924, 431.5947231457218, 366.1043474482296, 359.0091535621115, 197.81783030361825, 616.3005736385717, 609.0780894678393, 431.658408538186, 208.12306512709037, 263.3184062233411, 402.5140927318598, 368.76476005634294, 251.92828963567155, 459.2990688178512, 304.3099342109382, 315.2635128781641, 684.9892474320039, 221.38611539549424, 149.3305539633469, 376.51773555363775, 456.57893333777344, 347.314895572855, 541.6882793704267, 411.8263890104505, 404.0602837531244, 463.11586199864905, 251.90847933043355, 737.8524654308544, 382.59155561525984, 566.9803173042357, 88.9585454156747, 96.35983216454024, 270.504680187627, 314.64065207119666, 421.59495068812134, 175.9373504171759, 367.1179041878338, 392.43370023422005, 641.7424875304138, 595.3714548754908]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.190961488018862, "mean_inference_ms": 6.5904189206307295, "mean_action_processing_ms": 2.8707712740362927, "mean_env_wait_ms": 17.399923907436513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01320803165435791, "StateBufferConnector_ms": 0.006242156028747559, "ViewRequirementAgentConnector_ms": 0.20938515663146973}, "num_episodes": 19, "episode_return_max": 513.2265819045587, "episode_return_min": -18.093418021775847, "episode_return_mean": 205.6820521352144, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 57.72701184596571, "num_env_steps_trained_throughput_per_sec": 57.72701184596571, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 85440.436, "restore_workers_time_ms": 0.023, "training_step_time_ms": 85440.355, "sample_time_ms": 4080.231, "learn_time_ms": 81311.199, "learn_throughput": 49.194, "synch_weights_time_ms": 35.66}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 40, "trial_id": "62684_00000", "date": "2024-08-20_16-58-00", "timestamp": 1724153280, "time_this_iter_s": 69.33507919311523, "time_total_s": 3011.310394525528, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffb8280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3011.310394525528, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 54.401020408163255, "ram_util_percent": 83.21020408163265}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.784601371592665, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.367050302620475, "policy_loss": -0.020099883120286557, "vf_loss": 7.384333685949339, "vf_explained_var": 0.5395016780770416, "kl": 0.014082500787042346, "entropy": 1.069866300981941, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 114210.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.495765948358667, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.266948015223104, "policy_loss": -0.023260580274527744, "vf_loss": 8.287247457958403, "vf_explained_var": 0.08723486567300463, "kl": 0.01480561533817164, "entropy": 0.6073899334542966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 820000}, "env_runners": {"episode_reward_max": 513.2265819045587, "episode_reward_min": -18.093418021775847, "episode_reward_mean": 206.68214351739877, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -764.2883464733677, "predator_policy": 4.298151536949064}, "policy_reward_max": {"prey_policy": 198.2601360824128, "predator_policy": 764.2883464733677}, "policy_reward_mean": {"prey_policy": -177.32494023380184, "predator_policy": 369.32848210940233}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.0269148778576, 121.8660521477613, 148.62329025628938, 51.69411464758591, -18.093418021775847, 247.07788945891102, 127.55876399180869, 134.7389918458943, 199.86349253355277, 118.97224130869056, 129.15849493602443, 109.11112088858007, 177.21416093348174, 418.81908418984364, 513.2265819045587, 196.03458161010505, 76.6095638323377, 182.18390299823625, 112.1034547092712, 465.21042271476813, 410.88787876122956, 118.8022897853096, 26.129949606119126, 114.71229519099572, 228.35583440121982, 132.45374292740416, 210.28125325605092, 364.8788083252884, 157.20972861021093, 255.07163427144764, 223.84863312741393, 454.31418428555315, 183.26908939736916, 189.09999999999988, 107.87186343052616, 383.1012905043358, 79.07680958682258, 166.33524291891757, 238.92946073834815, 195.86935898117213, 161.78871994498326, 96.2065592368463, 287.9969931952022, 341.2070722365432, 303.0136697258417, 304.54199531710583, 75.49427458414726, 413.98657498313094, 89.0935333791937, 352.2298335108974, 327.9211857078885, 370.83180741805063, 270.67850034691713, 150.04268106075827, 150.98653787378532, 111.58004854601668, 118.97700089727888, 161.42982761668833, 231.65274038958026, 313.8120074704754, 203.1954223332745, 94.30234783010903, 342.22814323826844, 219.68607540593229, 414.59848310296917, 184.64424213292804, 125.41362107800684, 82.54283244818676, 304.04600286734944, 147.20881240719817, 82.01671194556768, 207.8310856340667, 117.4280703940181, 177.22681666747943, 213.0146771847975, 158.19009870659107, 312.3399191134351, 187.74947003841277, 140.06131897939616, 109.73564294686366, 189.25717725106554, 139.87914852810326, 193.67281799478883, 231.07285504583513, 148.44405601733348, 159.79831763305725, 177.74478045248097, 107.53825811815855, 242.15299796462395, 232.11273045590727, 107.11959241604836, 369.00269940131653, 53.161291837867495, 166.79932900931124, 191.9605362447379, 145.78222458330995, 295.0781618211731, 280.9490681501264, 306.3881229915899, 368.86977805734665], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-616.899152351619, -30.694876405898015, 158.38456951520155, -107.20064944017787, -172.38247952587903, -51.99516048388552, -391.7528201967318, -37.83510105568486, 73.7845597394792, -699.5458334645758, -102.8758266033766, -40.26070617164828, -225.73396894627257, -35.67943677795035, -432.3667670632541, -136.26331613733328, -466.41955842587225, 139.7, -443.4353352407789, -295.0484019661141, 14.616116523516762, -679.8738097534534, -260.9172760837825, 126.32124983878919, 1.9742815586290738, 74.11375595933998, -669.0608480334457, -144.48292983544664, -203.04470257836226, -227.3018691609058, 19.01611652351683, -227.39553037547202, -447.48951652714845, -101.8106878495098, -58.890311389695675, -367.47185713084656, -242.15238541453448, -79.09837409644386, 113.93435257209264, 66.04504090598878, -756.178019465923, 177.1463013102479, -632.269003276399, 165.14336054291195, 19.363213071364157, 180.1345816101057, -196.77514525931733, -335.81880658962206, 47.78240227547019, -106.62926914643573, -500.58796811281155, -269.4909733676315, 58.003429423725464, -382.8957832276975, -107.40998413317001, -266.334702510855, -62.47814837679991, 7.655247001599228, -459.6166213612266, 121.49702213183731, -593.3733812009516, 177.7369895295598, -375.27255743415816, 30.306475044444063, -366.9000052858162, -254.70125753822273, -648.389567978118, -764.2883464733677, 20.000000000000014, 77.17493163278317, -632.5041963227703, -137.41572409269526, 63.708424802737724, -90.93593925926129, -150.58594050097204, -557.5462090812887, -298.02415169581946, -135.49422654752357, -55.282590736069096, -477.74542761298267, -98.72271868805068, -509.8462071619568, 55.429644538472495, 27.607544561801042, -77.18757249010639, 67.05748836583723, -396.78083677574114, 185.54666539562248, -133.40414407298005, -621.8600036195904, 20.000000000000014, -524.9988797702541, -95.67559083490654, 144.52760483857054, 119.5492785186537, -388.0477735533925, -270.0386526933299, -53.632381931989585, -32.6822102550535, -384.500857549338, 183.8, -578.7320552029714, 44.78475320510597, -100.45953208208708, -117.7362438401453, 157.6797769343745, -464.40870969041686, -27.073113872240288, -95.65541625011306, -434.1599639117458, -184.49261979754152, -204.38913949728743, -173.52323574490651, 12.435727854025094, -131.05666658706988, -227.77357742231484, 115.18721107386284, -616.0095080627984, -21.87292510327754, -6.563707011198076, 158.04717474445127, -586.9151049184504, -615.2357254759174, 18.02863098808193, -297.9687095510365, -61.22450454371662, 188.98562335017903, -403.3782401911266, 68.80606576906098, -99.20044213339303, -189.5723243722219, 191.72038590270847, -210.2362902841677, -23.112324697921846, 194.79451055996847, 120.99309458408307, -4.234515967378021, -616.8877106906157, -21.475593118733073, -333.4567800671377, -347.0978272814725, 183.63779442030278, 150.37094657934873, -501.87855380190655, -195.70444570218064, -185.6791564741142, -557.2463226119796, -99.67807264630135, 181.2792730054773, -445.93271885193076, 189.8006872039985, -106.45855010677715, -107.33165857223327, 154.31420569873092, -491.7029581214939, 22.427575536366177, -526.08545168496, 9.22556079464358, 2.095729225572202, -355.19502738886644, -304.432572003593, 99.69999999999997, -518.9836407954654, -333.1607360451388, 32.39622409744401, -401.1696047963338, -564.716509394773, 90.74180000038288, 63.24049465983076, 19.09514047488909, -651.7474737304522, -78.86654800786197, -526.5881595844266, -0.1842198643029933, -0.6888027194287076, -139.4170609827449, -675.1768108614275, -28.020269819406888, 182.74195436602912, -268.44815856757884, 39.73357971157727, -199.8433197909263, -191.20580200290067, 95.21223044807482, -448.76153938722604, -753.365552073882, -0.021400855590339773, -383.847051102727, 164.18725580322203, 20.661389749047853, -257.0662678869379, -109.26438079918479, -36.90324520140095, 180.2, -572.4679910695589, -312.3687932891709, -462.8300867136072, 147.8, -480.11626291238605, -181.77409742841118, -75.92073055441321, -51.68607328699245, -423.0677795326107, -51.57979220037026, -476.9485306443023, 54.80092278464382, 1.0801097166674047, -139.74035786179635, -633.7099449712545, 106.54071129805871, -138.5724779649571, -608.9780894678393, -211.16921862766188, 25.47952142745313, -45.83840904996764, -243.2514980938485, -357.3174929006901, 69.29170418249348, -365.8249936759848, -127.70567124421473, -85.5853753464295, -320.7094951953979, -317.6555519556865, 198.2601360824128, -287.1633540310298, -58.099973186347825, -684.9892474320039, -5.09604350255561, -37.35283117327846, -199.65201539070245, 23.49647616043047, 13.036389791995134, -400.49753230675503, -228.68321635745576, -246.9385426277934, -25.026527403260843, -541.4882793704267, -458.2927534085688, 103.62869568974281, -402.7764450860834, -737.8524654308544, 177.86509181845082, -240.51639389781886, -559.9803173042354, 126.65092431177624, -376.36333139893276, 28.47049818925057, -30.806640131111642, 10.690582356436213, 112.18264632178452, -206.064480789273, -260.19064274550016, -443.4073180486234, 6.5064540133999245, -12.187381052738951, -304.7331395026632, -243.43500719046563, -51.58514009586783, 175.3316841972103, -594.7480629137199, -639.952783236914, -136.15613148946207, -327.29746316979777, 25.789600933901937, -430.5651213170471, 147.76752945617105, -38.0507672638314, -466.6849995289993, 185.8956882363979, -247.15862941620955, -597.7645584743207, -77.0353184380655, -114.74161501013, 157.4311241590772, -282.98106906654937, -351.7522997485561, -174.6025338771762, -154.94347441281238, -164.11391825671754, -255.72303737380287, -72.03100490582851, -3.686214175092436, -253.84197972054585, 3.2695843436796146, -301.41517034700917, 30.480218152331602, -379.4668499731448, -142.0423855913709, -3.8026437340831363, -5.038608923293422, -580.7150075370931, 103.67832800213318, -466.83731211892183, -157.62801613886816, -472.5398714775293, -301.65122249647357, 140.01021894920504, -579.8847896241857, 61.06777211591513, 15.656279381288101], "policy_predator_policy_reward": [290.44627550791427, 550.7900986122582, 292.79792637480233, 160.64641522290225, 83.57383157249552, 420.8528201967318, 721.5578089918703, 172.81867189531647, 441.05278581942855, 234.6339689462721, 574.601049571166, 135.45971445095088, 470.1288156125711, 381.2975690626142, 269.3350180908874, 679.8738097534534, 123.77545501558379, 669.0608480334457, 412.70096793944873, 281.1007749439559, 449.5895165271485, 335.4379087879802, 371.61732491908845, 265.66665233954365, 130.1131911925477, 254.4173766798197, 298.5791936316815, 633.2265678078496, 496.5106016694869, 464.47840989719407, 340.61880658962195, 207.87514525931672, 513.5151296696791, 122.52926914643483, 572.5684554297521, 203.99877474008906, 270.29158721924136, 278.0347025108575, 472.48023426570785, 323.1945406768485, 517.3789070056571, 684.4179208611223, 411.2478614144474, 298.8492161504577, 654.519517584237, 764.2883464733677, 174.86788175688898, 632.5894022167892, 99.28171277353476, 306.8875765851818, 565.1721211707503, 558.3462090812886, 556.5200442353536, 285.51194605779983, 351.3786584910743, 440.30916789589844, 163.43981273448077, 400.68083677574094, 599.1223792131549, 225.66673735524043, 335.3271261051406, 489.195977627435, 309.415552702402, 268.8695217793168, 144.07409272373513, 395.5482415540069, 389.8008575493384, 578.7320552029714, 53.25284867559827, 228.03003747205383, 263.488456795277, 453.4148803373409, 396.3393742340994, 397.0454353121235, 321.453411643262, 210.35847866382474, 259.01181507873883, 223.56067859513124, 751.9299453905786, 88.3855537678681, 617.8772706764497, 588.0151049184507, 110.8076870538693, 326.56345528964823, 16.805304075962944, 416.7782401911267, 4.298151536949064, 433.96130130249963, 223.13629028416696, 118.4314838637951, 535.9279323626362, 268.7431950283794, 337.3747160589082, 440.1497589925829, 484.293261898516, 97.56312588686997, 557.5463226119797, 470.17713555548835, 298.87780720447637, 417.68354479917446, 110.2112872934612, 241.69941988943788, 402.77428213688177, 283.01870216756606, 454.0760642313698, 331.3665977802903, 323.800679871966, 386.16960058125284, 683.7244661515823, 287.01022446536376, 565.2165093947731, 421.5078533419693, 35.410855887180205, 652.9779836058312, 526.5881595844266, 240.48059548885314, 584.42192715991, 462.51348779327043, 130.29096213369036, 297.24751935774304, 182.06723004939602, 372.4437343661285, 447.82958988251465, 753.3876189606277, 338.13132715172384, 223.77801224163935, 242.3746505291406, 322.9806838138694, 402.16180793173584, 441.60791144219206, 494.99885094256217, 317.0442711931456, 495.1146661597542, 368.1100458134627, 177.28175432243924, 431.5947231457218, 366.1043474482296, 359.0091535621115, 197.81783030361825, 616.3005736385717, 609.0780894678393, 431.658408538186, 208.12306512709037, 263.3184062233411, 402.5140927318598, 368.76476005634294, 251.92828963567155, 459.2990688178512, 304.3099342109382, 315.2635128781641, 684.9892474320039, 221.38611539549424, 149.3305539633469, 376.51773555363775, 456.57893333777344, 347.314895572855, 541.6882793704267, 411.8263890104505, 404.0602837531244, 463.11586199864905, 251.90847933043355, 737.8524654308544, 382.59155561525984, 566.9803173042357, 88.9585454156747, 96.35983216454024, 270.504680187627, 314.64065207119666, 421.59495068812134, 175.9373504171759, 367.1179041878338, 392.43370023422005, 641.7424875304138, 595.3714548754908, 321.0180163550656, 224.18423548845075, 232.86452226707357, 330.13683482225935, 476.52233937132576, 283.5383317933932, 590.7768460296365, 305.88423830892765, 436.450607911446, 409.8543361459003, 355.7748575200182, 191.04636086455366, 229.71056277833387, 268.52902268570205, 627.350209224147, 116.59789274446617, 379.1683872171852, 257.64285477831, 501.19347035380156, 383.4409516618395, 410.34542953549015, 391.3906388702928, 559.8463790728271, 380.7226189435602, 335.7060090530426, 536.3245071312846]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.188736718222337, "mean_inference_ms": 6.598815236073619, "mean_action_processing_ms": 2.854578176008948, "mean_env_wait_ms": 17.35727952113706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014299273490905762, "StateBufferConnector_ms": 0.006114959716796875, "ViewRequirementAgentConnector_ms": 0.21550488471984863}, "num_episodes": 13, "episode_return_max": 513.2265819045587, "episode_return_min": -18.093418021775847, "episode_return_mean": 206.68214351739877, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 820000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 59.00971728082826, "num_env_steps_trained_throughput_per_sec": 59.00971728082826, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 820000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 820000, "timers": {"training_iteration_time_ms": 85200.161, "restore_workers_time_ms": 0.023, "training_step_time_ms": 85200.081, "sample_time_ms": 4061.275, "learn_time_ms": 81090.353, "learn_throughput": 49.328, "synch_weights_time_ms": 35.417}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 820000}, "done": false, "training_iteration": 41, "trial_id": "62684_00000", "date": "2024-08-20_16-59-08", "timestamp": 1724153348, "time_this_iter_s": 67.79897379875183, "time_total_s": 3079.10936832428, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb01d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3079.10936832428, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 46.411578947368426, "ram_util_percent": 76.95052631578945}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.980380087583622, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.323415113002696, "policy_loss": -0.01738541879272584, "vf_loss": 7.337791836684477, "vf_explained_var": 0.47268600945777084, "kl": 0.015043427153649007, "entropy": 1.056973133188613, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 117030.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.4709301937824835, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.227293463106509, "policy_loss": -0.021313388507921624, "vf_loss": 8.245760170870987, "vf_explained_var": 0.21964995145166993, "kl": 0.014233361715672627, "entropy": 0.6409869131114748, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": 612.7416033708269, "episode_reward_min": 15.244135210371962, "episode_reward_mean": 211.50001607105122, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -753.365552073882, "predator_policy": 4.298151536949064}, "policy_reward_max": {"prey_policy": 198.2601360824128, "predator_policy": 753.3876189606277}, "policy_reward_mean": {"prey_policy": -172.3078439315418, "predator_policy": 364.2117739328384}, "custom_metrics": {}, "hist_stats": {"episode_reward": [223.84863312741393, 454.31418428555315, 183.26908939736916, 189.09999999999988, 107.87186343052616, 383.1012905043358, 79.07680958682258, 166.33524291891757, 238.92946073834815, 195.86935898117213, 161.78871994498326, 96.2065592368463, 287.9969931952022, 341.2070722365432, 303.0136697258417, 304.54199531710583, 75.49427458414726, 413.98657498313094, 89.0935333791937, 352.2298335108974, 327.9211857078885, 370.83180741805063, 270.67850034691713, 150.04268106075827, 150.98653787378532, 111.58004854601668, 118.97700089727888, 161.42982761668833, 231.65274038958026, 313.8120074704754, 203.1954223332745, 94.30234783010903, 342.22814323826844, 219.68607540593229, 414.59848310296917, 184.64424213292804, 125.41362107800684, 82.54283244818676, 304.04600286734944, 147.20881240719817, 82.01671194556768, 207.8310856340667, 117.4280703940181, 177.22681666747943, 213.0146771847975, 158.19009870659107, 312.3399191134351, 187.74947003841277, 140.06131897939616, 109.73564294686366, 189.25717725106554, 139.87914852810326, 193.67281799478883, 231.07285504583513, 148.44405601733348, 159.79831763305725, 177.74478045248097, 107.53825811815855, 242.15299796462395, 232.11273045590727, 107.11959241604836, 369.00269940131653, 53.161291837867495, 166.79932900931124, 191.9605362447379, 145.78222458330995, 295.0781618211731, 280.9490681501264, 306.3881229915899, 368.86977805734665, 310.500000000001, 172.66777874309372, 124.74630390008532, 134.34770280520203, 201.25159620039167, 476.86865497659335, 21.679461440738805, 190.73801783498192, 195.86132655344596, 208.38132168091008, 268.94027868036403, 612.7416033708269, 73.45508748454026, 71.71459600760733, 229.46172471004084, 160.90819502418333, 301.46250569893056, 135.00553996180705, 95.13599710971333, 24.839861492883315, 121.19999999999978, 303.4934915543225, 327.35738478230854, 370.5686110729782, 198.15773448446714, 283.80363360304693, 184.00335226798728, 15.244135210371962, 234.59700789811214, 315.4374677143624], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [20.000000000000014, -524.9988797702541, -95.67559083490654, 144.52760483857054, 119.5492785186537, -388.0477735533925, -270.0386526933299, -53.632381931989585, -32.6822102550535, -384.500857549338, 183.8, -578.7320552029714, 44.78475320510597, -100.45953208208708, -117.7362438401453, 157.6797769343745, -464.40870969041686, -27.073113872240288, -95.65541625011306, -434.1599639117458, -184.49261979754152, -204.38913949728743, -173.52323574490651, 12.435727854025094, -131.05666658706988, -227.77357742231484, 115.18721107386284, -616.0095080627984, -21.87292510327754, -6.563707011198076, 158.04717474445127, -586.9151049184504, -615.2357254759174, 18.02863098808193, -297.9687095510365, -61.22450454371662, 188.98562335017903, -403.3782401911266, 68.80606576906098, -99.20044213339303, -189.5723243722219, 191.72038590270847, -210.2362902841677, -23.112324697921846, 194.79451055996847, 120.99309458408307, -4.234515967378021, -616.8877106906157, -21.475593118733073, -333.4567800671377, -347.0978272814725, 183.63779442030278, 150.37094657934873, -501.87855380190655, -195.70444570218064, -185.6791564741142, -557.2463226119796, -99.67807264630135, 181.2792730054773, -445.93271885193076, 189.8006872039985, -106.45855010677715, -107.33165857223327, 154.31420569873092, -491.7029581214939, 22.427575536366177, -526.08545168496, 9.22556079464358, 2.095729225572202, -355.19502738886644, -304.432572003593, 99.69999999999997, -518.9836407954654, -333.1607360451388, 32.39622409744401, -401.1696047963338, -564.716509394773, 90.74180000038288, 63.24049465983076, 19.09514047488909, -651.7474737304522, -78.86654800786197, -526.5881595844266, -0.1842198643029933, -0.6888027194287076, -139.4170609827449, -675.1768108614275, -28.020269819406888, 182.74195436602912, -268.44815856757884, 39.73357971157727, -199.8433197909263, -191.20580200290067, 95.21223044807482, -448.76153938722604, -753.365552073882, -0.021400855590339773, -383.847051102727, 164.18725580322203, 20.661389749047853, -257.0662678869379, -109.26438079918479, -36.90324520140095, 180.2, -572.4679910695589, -312.3687932891709, -462.8300867136072, 147.8, -480.11626291238605, -181.77409742841118, -75.92073055441321, -51.68607328699245, -423.0677795326107, -51.57979220037026, -476.9485306443023, 54.80092278464382, 1.0801097166674047, -139.74035786179635, -633.7099449712545, 106.54071129805871, -138.5724779649571, -608.9780894678393, -211.16921862766188, 25.47952142745313, -45.83840904996764, -243.2514980938485, -357.3174929006901, 69.29170418249348, -365.8249936759848, -127.70567124421473, -85.5853753464295, -320.7094951953979, -317.6555519556865, 198.2601360824128, -287.1633540310298, -58.099973186347825, -684.9892474320039, -5.09604350255561, -37.35283117327846, -199.65201539070245, 23.49647616043047, 13.036389791995134, -400.49753230675503, -228.68321635745576, -246.9385426277934, -25.026527403260843, -541.4882793704267, -458.2927534085688, 103.62869568974281, -402.7764450860834, -737.8524654308544, 177.86509181845082, -240.51639389781886, -559.9803173042354, 126.65092431177624, -376.36333139893276, 28.47049818925057, -30.806640131111642, 10.690582356436213, 112.18264632178452, -206.064480789273, -260.19064274550016, -443.4073180486234, 6.5064540133999245, -12.187381052738951, -304.7331395026632, -243.43500719046563, -51.58514009586783, 175.3316841972103, -594.7480629137199, -639.952783236914, -136.15613148946207, -327.29746316979777, 25.789600933901937, -430.5651213170471, 147.76752945617105, -38.0507672638314, -466.6849995289993, 185.8956882363979, -247.15862941620955, -597.7645584743207, -77.0353184380655, -114.74161501013, 157.4311241590772, -282.98106906654937, -351.7522997485561, -174.6025338771762, -154.94347441281238, -164.11391825671754, -255.72303737380287, -72.03100490582851, -3.686214175092436, -253.84197972054585, 3.2695843436796146, -301.41517034700917, 30.480218152331602, -379.4668499731448, -142.0423855913709, -3.8026437340831363, -5.038608923293422, -580.7150075370931, 103.67832800213318, -466.83731211892183, -157.62801613886816, -472.5398714775293, -301.65122249647357, 140.01021894920504, -579.8847896241857, 61.06777211591513, 15.656279381288101, 95.52772686898219, 78.54178597536176, -84.01131420030957, -463.0981279590516, 48.77378145807428, -56.58325443781008, 34.16855428359377, -516.8734901630565, 17.80000000000001, 6.640150220166568, -637.1115134738033, -305.5954461899023, -183.30336336725782, -295.2479980885132, 171.49885221013784, -494.41029215555346, 139.88306916301937, 20.000000000000014, -483.027508512436, -610.4426079358162, 17.8794614407389, 181.50654017084796, -408.08531465848597, -432.2228407106809, -593.8005909677975, -511.7156672231121, 184.6183676345686, 93.68186256109728, -267.60265817367525, -157.8943210392677, -32.94670880492267, -347.047779119605, 40.69999999999998, 130.71268336018014, -218.97838843929568, -126.58332683223085, -263.26381076510273, -331.2434456518567, -752.5616853761364, -459.6517713149117, -6.485947362578717, -60.924378698346146, -175.5594321487994, -12.983337556394082, -237.092840309959, -73.92170625523315, -263.19035221732855, -40.27904448059706, -566.0387639003573, 177.56118132213163, -109.76245208302723, -258.6750726190714, 0.7747480372170905, -289.5464221831066, -417.89029305314307, -213.44430589293952, -87.3327249282074, -39.531323823472746, -350.1610246562773, -415.4907741189152, 95.59999999999997, -191.02967928551342, -288.0022333953399, 51.83290126907776, -384.33501856245056, 82.2494840844262, -201.99416385977142, 58.48759827240792, 70.66879220043737, 176.2009262107395, -1.0680629422661712, -404.08625763570325, -143.76863690995881, -296.0954156045232, -333.1874082929129, 180.63240703431362, -76.80188048187172, -160.28995767016212, 15.142138368925508, -275.67567021182117, -312.6598583177147, -477.6732059361204, 14.285404409585203, -433.8563107677998, 139.31900361982986, -185.37855284962532, -589.8565039432056, -89.66589177436664, 120.39365504583886, -621.8552077615676], "policy_predator_policy_reward": [335.3271261051406, 489.195977627435, 309.415552702402, 268.8695217793168, 144.07409272373513, 395.5482415540069, 389.8008575493384, 578.7320552029714, 53.25284867559827, 228.03003747205383, 263.488456795277, 453.4148803373409, 396.3393742340994, 397.0454353121235, 321.453411643262, 210.35847866382474, 259.01181507873883, 223.56067859513124, 751.9299453905786, 88.3855537678681, 617.8772706764497, 588.0151049184507, 110.8076870538693, 326.56345528964823, 16.805304075962944, 416.7782401911267, 4.298151536949064, 433.96130130249963, 223.13629028416696, 118.4314838637951, 535.9279323626362, 268.7431950283794, 337.3747160589082, 440.1497589925829, 484.293261898516, 97.56312588686997, 557.5463226119797, 470.17713555548835, 298.87780720447637, 417.68354479917446, 110.2112872934612, 241.69941988943788, 402.77428213688177, 283.01870216756606, 454.0760642313698, 331.3665977802903, 323.800679871966, 386.16960058125284, 683.7244661515823, 287.01022446536376, 565.2165093947731, 421.5078533419693, 35.410855887180205, 652.9779836058312, 526.5881595844266, 240.48059548885314, 584.42192715991, 462.51348779327043, 130.29096213369036, 297.24751935774304, 182.06723004939602, 372.4437343661285, 447.82958988251465, 753.3876189606277, 338.13132715172384, 223.77801224163935, 242.3746505291406, 322.9806838138694, 402.16180793173584, 441.60791144219206, 494.99885094256217, 317.0442711931456, 495.1146661597542, 368.1100458134627, 177.28175432243924, 431.5947231457218, 366.1043474482296, 359.0091535621115, 197.81783030361825, 616.3005736385717, 609.0780894678393, 431.658408538186, 208.12306512709037, 263.3184062233411, 402.5140927318598, 368.76476005634294, 251.92828963567155, 459.2990688178512, 304.3099342109382, 315.2635128781641, 684.9892474320039, 221.38611539549424, 149.3305539633469, 376.51773555363775, 456.57893333777344, 347.314895572855, 541.6882793704267, 411.8263890104505, 404.0602837531244, 463.11586199864905, 251.90847933043355, 737.8524654308544, 382.59155561525984, 566.9803173042357, 88.9585454156747, 96.35983216454024, 270.504680187627, 314.64065207119666, 421.59495068812134, 175.9373504171759, 367.1179041878338, 392.43370023422005, 641.7424875304138, 595.3714548754908, 321.0180163550656, 224.18423548845075, 232.86452226707357, 330.13683482225935, 476.52233937132576, 283.5383317933932, 590.7768460296365, 305.88423830892765, 436.450607911446, 409.8543361459003, 355.7748575200182, 191.04636086455366, 229.71056277833387, 268.52902268570205, 627.350209224147, 116.59789274446617, 379.1683872171852, 257.64285477831, 501.19347035380156, 383.4409516618395, 410.34542953549015, 391.3906388702928, 559.8463790728271, 380.7226189435602, 335.7060090530426, 536.3245071312846, 56.05821402463819, 164.38358733132674, 473.00441984264364, 170.5709598392376, 516.8506002318213, 72.80063954772749, 433.202998774937, 637.2115134738033, 219.5090165000168, 288.79508894600826, 457.6476381830443, 353.7482397860818, 486.1275085124358, 611.1426079358163, 444.67576786833445, 404.86386516496754, 625.3490143752272, 491.41020273456, 278.0756872249836, 262.1207511077744, 324.8925898560458, 283.3421767488463, 370.6528269388079, 456.9378083433643, 752.5616853761364, 667.9623439015014, 135.5249220685317, 463.2517713149124, 240.22440534717933, 414.87292937801493, 134.31249677192793, 403.98680120541576, 603.8055730338418, 195.8969673263415, 314.7374367817532, 367.7148499450148, 433.4358839693296, 380.36743701467304, 468.0619594352717, 361.96102465627706, 295.70223339533976, 208.92967928551298, 381.79304005737316, 171.9530847058964, 303.78416456527236, 96.41099360396255, 310.8166931800206, 288.70531226018784, 550.1001864914631, 421.10900880039867, 296.24104987738195, 44.02201484338396, 403.7189359324897, 353.4778064961086, 453.54410243380255, 458.94414507090454, 590.7855116033419, 279.72754946777167, 330.85372696326147, 575.7111852411947]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.11015538150435, "mean_inference_ms": 6.613054625091451, "mean_action_processing_ms": 2.889828775228336, "mean_env_wait_ms": 17.216028299163142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02125084400177002, "StateBufferConnector_ms": 0.006192445755004883, "ViewRequirementAgentConnector_ms": 0.20063960552215576}, "num_episodes": 30, "episode_return_max": 612.7416033708269, "episode_return_min": 15.244135210371962, "episode_return_mean": 211.50001607105122, "episodes_this_iter": 30}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.58317148417709, "num_env_steps_trained_throughput_per_sec": 66.58317148417709, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 84448.995, "restore_workers_time_ms": 0.023, "training_step_time_ms": 84448.915, "sample_time_ms": 3846.916, "learn_time_ms": 80553.337, "learn_throughput": 49.657, "synch_weights_time_ms": 35.886}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 42, "trial_id": "62684_00000", "date": "2024-08-20_17-00-08", "timestamp": 1724153408, "time_this_iter_s": 60.1169171333313, "time_total_s": 3139.226285457611, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffbe5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3139.226285457611, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 26.39176470588235, "ram_util_percent": 71.2564705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.783314371447192, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.184818438942551, "policy_loss": -0.016400335705756535, "vf_loss": 7.19849013774953, "vf_explained_var": 0.4481245947433702, "kl": 0.013643155092082864, "entropy": 1.051439773169815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 119850.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.661950481631768, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.668689590534836, "policy_loss": -0.020756379264608892, "vf_loss": 8.686754613704782, "vf_explained_var": 0.0812100160689581, "kl": 0.013456740433093969, "entropy": 0.5968681265437413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 860000}, "env_runners": {"episode_reward_max": 612.7416033708269, "episode_reward_min": -0.0727247380489966, "episode_reward_mean": 209.35089638728172, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -753.365552073882, "predator_policy": 35.410855887180205}, "policy_reward_max": {"prey_policy": 198.2601360824128, "predator_policy": 753.3876189606277}, "policy_reward_mean": {"prey_policy": -174.66211087607726, "predator_policy": 366.66861450775684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.2298335108974, 327.9211857078885, 370.83180741805063, 270.67850034691713, 150.04268106075827, 150.98653787378532, 111.58004854601668, 118.97700089727888, 161.42982761668833, 231.65274038958026, 313.8120074704754, 203.1954223332745, 94.30234783010903, 342.22814323826844, 219.68607540593229, 414.59848310296917, 184.64424213292804, 125.41362107800684, 82.54283244818676, 304.04600286734944, 147.20881240719817, 82.01671194556768, 207.8310856340667, 117.4280703940181, 177.22681666747943, 213.0146771847975, 158.19009870659107, 312.3399191134351, 187.74947003841277, 140.06131897939616, 109.73564294686366, 189.25717725106554, 139.87914852810326, 193.67281799478883, 231.07285504583513, 148.44405601733348, 159.79831763305725, 177.74478045248097, 107.53825811815855, 242.15299796462395, 232.11273045590727, 107.11959241604836, 369.00269940131653, 53.161291837867495, 166.79932900931124, 191.9605362447379, 145.78222458330995, 295.0781618211731, 280.9490681501264, 306.3881229915899, 368.86977805734665, 310.500000000001, 172.66777874309372, 124.74630390008532, 134.34770280520203, 201.25159620039167, 476.86865497659335, 21.679461440738805, 190.73801783498192, 195.86132655344596, 208.38132168091008, 268.94027868036403, 612.7416033708269, 73.45508748454026, 71.71459600760733, 229.46172471004084, 160.90819502418333, 301.46250569893056, 135.00553996180705, 95.13599710971333, 24.839861492883315, 121.19999999999978, 303.4934915543225, 327.35738478230854, 370.5686110729782, 198.15773448446714, 283.80363360304693, 184.00335226798728, 15.244135210371962, 234.59700789811214, 315.4374677143624, 62.67560730824722, -0.0727247380489966, 272.1100850969273, 52.183162346069324, 167.04540565784245, 391.43765313411023, 215.1434831743692, 126.48844572220409, 200.31380204589473, 184.09739029323745, 36.09799901682518, 57.659977123407955, 338.87153705416176, 133.44912119201777, 568.7394395066275, 450.62355213632674, 474.6962007285937, 181.96942803820644, 166.60379235948614], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-99.67807264630135, 181.2792730054773, -445.93271885193076, 189.8006872039985, -106.45855010677715, -107.33165857223327, 154.31420569873092, -491.7029581214939, 22.427575536366177, -526.08545168496, 9.22556079464358, 2.095729225572202, -355.19502738886644, -304.432572003593, 99.69999999999997, -518.9836407954654, -333.1607360451388, 32.39622409744401, -401.1696047963338, -564.716509394773, 90.74180000038288, 63.24049465983076, 19.09514047488909, -651.7474737304522, -78.86654800786197, -526.5881595844266, -0.1842198643029933, -0.6888027194287076, -139.4170609827449, -675.1768108614275, -28.020269819406888, 182.74195436602912, -268.44815856757884, 39.73357971157727, -199.8433197909263, -191.20580200290067, 95.21223044807482, -448.76153938722604, -753.365552073882, -0.021400855590339773, -383.847051102727, 164.18725580322203, 20.661389749047853, -257.0662678869379, -109.26438079918479, -36.90324520140095, 180.2, -572.4679910695589, -312.3687932891709, -462.8300867136072, 147.8, -480.11626291238605, -181.77409742841118, -75.92073055441321, -51.68607328699245, -423.0677795326107, -51.57979220037026, -476.9485306443023, 54.80092278464382, 1.0801097166674047, -139.74035786179635, -633.7099449712545, 106.54071129805871, -138.5724779649571, -608.9780894678393, -211.16921862766188, 25.47952142745313, -45.83840904996764, -243.2514980938485, -357.3174929006901, 69.29170418249348, -365.8249936759848, -127.70567124421473, -85.5853753464295, -320.7094951953979, -317.6555519556865, 198.2601360824128, -287.1633540310298, -58.099973186347825, -684.9892474320039, -5.09604350255561, -37.35283117327846, -199.65201539070245, 23.49647616043047, 13.036389791995134, -400.49753230675503, -228.68321635745576, -246.9385426277934, -25.026527403260843, -541.4882793704267, -458.2927534085688, 103.62869568974281, -402.7764450860834, -737.8524654308544, 177.86509181845082, -240.51639389781886, -559.9803173042354, 126.65092431177624, -376.36333139893276, 28.47049818925057, -30.806640131111642, 10.690582356436213, 112.18264632178452, -206.064480789273, -260.19064274550016, -443.4073180486234, 6.5064540133999245, -12.187381052738951, -304.7331395026632, -243.43500719046563, -51.58514009586783, 175.3316841972103, -594.7480629137199, -639.952783236914, -136.15613148946207, -327.29746316979777, 25.789600933901937, -430.5651213170471, 147.76752945617105, -38.0507672638314, -466.6849995289993, 185.8956882363979, -247.15862941620955, -597.7645584743207, -77.0353184380655, -114.74161501013, 157.4311241590772, -282.98106906654937, -351.7522997485561, -174.6025338771762, -154.94347441281238, -164.11391825671754, -255.72303737380287, -72.03100490582851, -3.686214175092436, -253.84197972054585, 3.2695843436796146, -301.41517034700917, 30.480218152331602, -379.4668499731448, -142.0423855913709, -3.8026437340831363, -5.038608923293422, -580.7150075370931, 103.67832800213318, -466.83731211892183, -157.62801613886816, -472.5398714775293, -301.65122249647357, 140.01021894920504, -579.8847896241857, 61.06777211591513, 15.656279381288101, 95.52772686898219, 78.54178597536176, -84.01131420030957, -463.0981279590516, 48.77378145807428, -56.58325443781008, 34.16855428359377, -516.8734901630565, 17.80000000000001, 6.640150220166568, -637.1115134738033, -305.5954461899023, -183.30336336725782, -295.2479980885132, 171.49885221013784, -494.41029215555346, 139.88306916301937, 20.000000000000014, -483.027508512436, -610.4426079358162, 17.8794614407389, 181.50654017084796, -408.08531465848597, -432.2228407106809, -593.8005909677975, -511.7156672231121, 184.6183676345686, 93.68186256109728, -267.60265817367525, -157.8943210392677, -32.94670880492267, -347.047779119605, 40.69999999999998, 130.71268336018014, -218.97838843929568, -126.58332683223085, -263.26381076510273, -331.2434456518567, -752.5616853761364, -459.6517713149117, -6.485947362578717, -60.924378698346146, -175.5594321487994, -12.983337556394082, -237.092840309959, -73.92170625523315, -263.19035221732855, -40.27904448059706, -566.0387639003573, 177.56118132213163, -109.76245208302723, -258.6750726190714, 0.7747480372170905, -289.5464221831066, -417.89029305314307, -213.44430589293952, -87.3327249282074, -39.531323823472746, -350.1610246562773, -415.4907741189152, 95.59999999999997, -191.02967928551342, -288.0022333953399, 51.83290126907776, -384.33501856245056, 82.2494840844262, -201.99416385977142, 58.48759827240792, 70.66879220043737, 176.2009262107395, -1.0680629422661712, -404.08625763570325, -143.76863690995881, -296.0954156045232, -333.1874082929129, 180.63240703431362, -76.80188048187172, -160.28995767016212, 15.142138368925508, -275.67567021182117, -312.6598583177147, -477.6732059361204, 14.285404409585203, -433.8563107677998, 139.31900361982986, -185.37855284962532, -589.8565039432056, -89.66589177436664, 120.39365504583886, -621.8552077615676, -242.63654486232934, -38.250254319477136, -124.2347852508169, -411.86214969300966, -184.69318721786235, -117.15787040638533, -48.309683073221244, -370.4458302824732, -35.608409592814205, -311.0276855840763, -52.48234672059231, -101.5198117051232, -543.2798120713084, -534.9456502732237, 146.44441876617955, -43.76888640180294, 44.6736548596588, -491.73379758804623, -191.45464081023997, 168.95701165646082, -524.9725374313734, -239.4724012719284, -32.98346756056949, 13.403727754061666, -167.2391144317051, -101.91819369434711, 132.1647801640109, -562.5603972027997, -162.6520276116125, -34.86446426604552, 15.127070403129121, -250.71796162541972, -277.16993960391, -361.90277888824414, 18.899999999999995, -421.7699275012174, -298.29167398508673, -382.94153298452795, -0.17631162112283735, -36.05500229464924, -65.04926482493029, -331.22563195305963, -422.55007299294124, 180.09574653419068, 56.83322819801834, -315.6000510060753, 152.73312868504988, 11.485000343299422, -1.0556525527167646, -263.5794469219125, 192.1956941270084, 134.11279642033824, -406.52511342205486, -213.17772505689464, -544.7202757941486, 83.49347812182494, -104.95626026684491], "policy_predator_policy_reward": [298.87780720447637, 417.68354479917446, 110.2112872934612, 241.69941988943788, 402.77428213688177, 283.01870216756606, 454.0760642313698, 331.3665977802903, 323.800679871966, 386.16960058125284, 683.7244661515823, 287.01022446536376, 565.2165093947731, 421.5078533419693, 35.410855887180205, 652.9779836058312, 526.5881595844266, 240.48059548885314, 584.42192715991, 462.51348779327043, 130.29096213369036, 297.24751935774304, 182.06723004939602, 372.4437343661285, 447.82958988251465, 753.3876189606277, 338.13132715172384, 223.77801224163935, 242.3746505291406, 322.9806838138694, 402.16180793173584, 441.60791144219206, 494.99885094256217, 317.0442711931456, 495.1146661597542, 368.1100458134627, 177.28175432243924, 431.5947231457218, 366.1043474482296, 359.0091535621115, 197.81783030361825, 616.3005736385717, 609.0780894678393, 431.658408538186, 208.12306512709037, 263.3184062233411, 402.5140927318598, 368.76476005634294, 251.92828963567155, 459.2990688178512, 304.3099342109382, 315.2635128781641, 684.9892474320039, 221.38611539549424, 149.3305539633469, 376.51773555363775, 456.57893333777344, 347.314895572855, 541.6882793704267, 411.8263890104505, 404.0602837531244, 463.11586199864905, 251.90847933043355, 737.8524654308544, 382.59155561525984, 566.9803173042357, 88.9585454156747, 96.35983216454024, 270.504680187627, 314.64065207119666, 421.59495068812134, 175.9373504171759, 367.1179041878338, 392.43370023422005, 641.7424875304138, 595.3714548754908, 321.0180163550656, 224.18423548845075, 232.86452226707357, 330.13683482225935, 476.52233937132576, 283.5383317933932, 590.7768460296365, 305.88423830892765, 436.450607911446, 409.8543361459003, 355.7748575200182, 191.04636086455366, 229.71056277833387, 268.52902268570205, 627.350209224147, 116.59789274446617, 379.1683872171852, 257.64285477831, 501.19347035380156, 383.4409516618395, 410.34542953549015, 391.3906388702928, 559.8463790728271, 380.7226189435602, 335.7060090530426, 536.3245071312846, 56.05821402463819, 164.38358733132674, 473.00441984264364, 170.5709598392376, 516.8506002318213, 72.80063954772749, 433.202998774937, 637.2115134738033, 219.5090165000168, 288.79508894600826, 457.6476381830443, 353.7482397860818, 486.1275085124358, 611.1426079358163, 444.67576786833445, 404.86386516496754, 625.3490143752272, 491.41020273456, 278.0756872249836, 262.1207511077744, 324.8925898560458, 283.3421767488463, 370.6528269388079, 456.9378083433643, 752.5616853761364, 667.9623439015014, 135.5249220685317, 463.2517713149124, 240.22440534717933, 414.87292937801493, 134.31249677192793, 403.98680120541576, 603.8055730338418, 195.8969673263415, 314.7374367817532, 367.7148499450148, 433.4358839693296, 380.36743701467304, 468.0619594352717, 361.96102465627706, 295.70223339533976, 208.92967928551298, 381.79304005737316, 171.9530847058964, 303.78416456527236, 96.41099360396255, 310.8166931800206, 288.70531226018784, 550.1001864914631, 421.10900880039867, 296.24104987738195, 44.02201484338396, 403.7189359324897, 353.4778064961086, 453.54410243380255, 458.94414507090454, 590.7855116033419, 279.72754946777167, 330.85372696326147, 575.7111852411947, 74.89337055627227, 392.9038211845979, 411.4143341940264, 302.22614838518155, 367.6471299367442, 358.82687810869294, 147.26517867689586, 369.9478276789647, 546.6798120713091, 552.1466371648869, 426.0862422541463, 456.18044001015346, 274.60336127296836, 488.0102884865534, 190.5651737240482, 194.97541307659301, 166.25658606750198, 171.04974394043438, 357.1092028900085, 587.0650764836864, 292.4755377354703, 256.3832921075568, 401.12614995330983, 421.30653355955945, 497.0268493802481, 523.2542062646512, 460.67905191519367, 105.09996834946348, 423.7877007231014, 330.5728370442574, 262.10585184930113, 339.8996222647506, 286.24431083238017, 260.89129524383446, 400.6588768811184, 266.9005932157006, 180.37166954080413, 552.4151807578515]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.062353670104846, "mean_inference_ms": 6.632940942689947, "mean_action_processing_ms": 2.86124443147211, "mean_env_wait_ms": 17.055554813943886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020917654037475586, "StateBufferConnector_ms": 0.009124159812927246, "ViewRequirementAgentConnector_ms": 0.18027353286743164}, "num_episodes": 19, "episode_return_max": 612.7416033708269, "episode_return_min": -0.0727247380489966, "episode_return_mean": 209.35089638728172, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 860000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.55834079448665, "num_env_steps_trained_throughput_per_sec": 66.55834079448665, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 860000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 860000, "timers": {"training_iteration_time_ms": 83731.737, "restore_workers_time_ms": 0.022, "training_step_time_ms": 83731.659, "sample_time_ms": 3721.451, "learn_time_ms": 79962.606, "learn_throughput": 50.023, "synch_weights_time_ms": 35.644}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 860000}, "done": false, "training_iteration": 43, "trial_id": "62684_00000", "date": "2024-08-20_17-01-09", "timestamp": 1724153469, "time_this_iter_s": 60.102591037750244, "time_total_s": 3199.3288764953613, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ff8bca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3199.3288764953613, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 25.15411764705882, "ram_util_percent": 74.56470588235292}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.142303778981486, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.4961829626813845, "policy_loss": -0.018980722736355895, "vf_loss": 7.512507047213561, "vf_explained_var": 0.4953401507215297, "kl": 0.013283132855509612, "entropy": 1.0094656783426907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 122670.5, "diff_num_grad_updates_vs_sampler_policy": 1448.979999999996}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.43373270526765, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.422435423432203, "policy_loss": -0.02265286017406397, "vf_loss": 8.442387825597532, "vf_explained_var": 0.050724499976193466, "kl": 0.013502415602474853, "entropy": 0.5973047149875177, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 970.9600000000065}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 612.7416033708269, "episode_reward_min": -0.0727247380489966, "episode_reward_mean": 197.91945429183193, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -752.5616853761364, "predator_policy": 16.928089540234676}, "policy_reward_max": {"prey_policy": 198.2601360824128, "predator_policy": 752.5616853761364}, "policy_reward_mean": {"prey_policy": -174.89123367044542, "predator_policy": 361.29657765158424}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.41362107800684, 82.54283244818676, 304.04600286734944, 147.20881240719817, 82.01671194556768, 207.8310856340667, 117.4280703940181, 177.22681666747943, 213.0146771847975, 158.19009870659107, 312.3399191134351, 187.74947003841277, 140.06131897939616, 109.73564294686366, 189.25717725106554, 139.87914852810326, 193.67281799478883, 231.07285504583513, 148.44405601733348, 159.79831763305725, 177.74478045248097, 107.53825811815855, 242.15299796462395, 232.11273045590727, 107.11959241604836, 369.00269940131653, 53.161291837867495, 166.79932900931124, 191.9605362447379, 145.78222458330995, 295.0781618211731, 280.9490681501264, 306.3881229915899, 368.86977805734665, 310.500000000001, 172.66777874309372, 124.74630390008532, 134.34770280520203, 201.25159620039167, 476.86865497659335, 21.679461440738805, 190.73801783498192, 195.86132655344596, 208.38132168091008, 268.94027868036403, 612.7416033708269, 73.45508748454026, 71.71459600760733, 229.46172471004084, 160.90819502418333, 301.46250569893056, 135.00553996180705, 95.13599710971333, 24.839861492883315, 121.19999999999978, 303.4934915543225, 327.35738478230854, 370.5686110729782, 198.15773448446714, 283.80363360304693, 184.00335226798728, 15.244135210371962, 234.59700789811214, 315.4374677143624, 62.67560730824722, -0.0727247380489966, 272.1100850969273, 52.183162346069324, 167.04540565784245, 391.43765313411023, 215.1434831743692, 126.48844572220409, 200.31380204589473, 184.09739029323745, 36.09799901682518, 57.659977123407955, 338.87153705416176, 133.44912119201777, 568.7394395066275, 450.62355213632674, 474.6962007285937, 181.96942803820644, 166.60379235948614, 286.8379205368637, 109.35411885576448, 250.71165110838993, 199.80165346011913, 85.91655097940905, 187.82550100832196, 286.73094544505057, 102.40732339213818, 149.74690184895306, 185.65487738351882, 30.30596250390965, 255.21152442264386, 9.369559474523394, 174.3046288666608, 94.24970221331859, 286.44007167141365, 180.78378216583906], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-480.11626291238605, -181.77409742841118, -75.92073055441321, -51.68607328699245, -423.0677795326107, -51.57979220037026, -476.9485306443023, 54.80092278464382, 1.0801097166674047, -139.74035786179635, -633.7099449712545, 106.54071129805871, -138.5724779649571, -608.9780894678393, -211.16921862766188, 25.47952142745313, -45.83840904996764, -243.2514980938485, -357.3174929006901, 69.29170418249348, -365.8249936759848, -127.70567124421473, -85.5853753464295, -320.7094951953979, -317.6555519556865, 198.2601360824128, -287.1633540310298, -58.099973186347825, -684.9892474320039, -5.09604350255561, -37.35283117327846, -199.65201539070245, 23.49647616043047, 13.036389791995134, -400.49753230675503, -228.68321635745576, -246.9385426277934, -25.026527403260843, -541.4882793704267, -458.2927534085688, 103.62869568974281, -402.7764450860834, -737.8524654308544, 177.86509181845082, -240.51639389781886, -559.9803173042354, 126.65092431177624, -376.36333139893276, 28.47049818925057, -30.806640131111642, 10.690582356436213, 112.18264632178452, -206.064480789273, -260.19064274550016, -443.4073180486234, 6.5064540133999245, -12.187381052738951, -304.7331395026632, -243.43500719046563, -51.58514009586783, 175.3316841972103, -594.7480629137199, -639.952783236914, -136.15613148946207, -327.29746316979777, 25.789600933901937, -430.5651213170471, 147.76752945617105, -38.0507672638314, -466.6849995289993, 185.8956882363979, -247.15862941620955, -597.7645584743207, -77.0353184380655, -114.74161501013, 157.4311241590772, -282.98106906654937, -351.7522997485561, -174.6025338771762, -154.94347441281238, -164.11391825671754, -255.72303737380287, -72.03100490582851, -3.686214175092436, -253.84197972054585, 3.2695843436796146, -301.41517034700917, 30.480218152331602, -379.4668499731448, -142.0423855913709, -3.8026437340831363, -5.038608923293422, -580.7150075370931, 103.67832800213318, -466.83731211892183, -157.62801613886816, -472.5398714775293, -301.65122249647357, 140.01021894920504, -579.8847896241857, 61.06777211591513, 15.656279381288101, 95.52772686898219, 78.54178597536176, -84.01131420030957, -463.0981279590516, 48.77378145807428, -56.58325443781008, 34.16855428359377, -516.8734901630565, 17.80000000000001, 6.640150220166568, -637.1115134738033, -305.5954461899023, -183.30336336725782, -295.2479980885132, 171.49885221013784, -494.41029215555346, 139.88306916301937, 20.000000000000014, -483.027508512436, -610.4426079358162, 17.8794614407389, 181.50654017084796, -408.08531465848597, -432.2228407106809, -593.8005909677975, -511.7156672231121, 184.6183676345686, 93.68186256109728, -267.60265817367525, -157.8943210392677, -32.94670880492267, -347.047779119605, 40.69999999999998, 130.71268336018014, -218.97838843929568, -126.58332683223085, -263.26381076510273, -331.2434456518567, -752.5616853761364, -459.6517713149117, -6.485947362578717, -60.924378698346146, -175.5594321487994, -12.983337556394082, -237.092840309959, -73.92170625523315, -263.19035221732855, -40.27904448059706, -566.0387639003573, 177.56118132213163, -109.76245208302723, -258.6750726190714, 0.7747480372170905, -289.5464221831066, -417.89029305314307, -213.44430589293952, -87.3327249282074, -39.531323823472746, -350.1610246562773, -415.4907741189152, 95.59999999999997, -191.02967928551342, -288.0022333953399, 51.83290126907776, -384.33501856245056, 82.2494840844262, -201.99416385977142, 58.48759827240792, 70.66879220043737, 176.2009262107395, -1.0680629422661712, -404.08625763570325, -143.76863690995881, -296.0954156045232, -333.1874082929129, 180.63240703431362, -76.80188048187172, -160.28995767016212, 15.142138368925508, -275.67567021182117, -312.6598583177147, -477.6732059361204, 14.285404409585203, -433.8563107677998, 139.31900361982986, -185.37855284962532, -589.8565039432056, -89.66589177436664, 120.39365504583886, -621.8552077615676, -242.63654486232934, -38.250254319477136, -124.2347852508169, -411.86214969300966, -184.69318721786235, -117.15787040638533, -48.309683073221244, -370.4458302824732, -35.608409592814205, -311.0276855840763, -52.48234672059231, -101.5198117051232, -543.2798120713084, -534.9456502732237, 146.44441876617955, -43.76888640180294, 44.6736548596588, -491.73379758804623, -191.45464081023997, 168.95701165646082, -524.9725374313734, -239.4724012719284, -32.98346756056949, 13.403727754061666, -167.2391144317051, -101.91819369434711, 132.1647801640109, -562.5603972027997, -162.6520276116125, -34.86446426604552, 15.127070403129121, -250.71796162541972, -277.16993960391, -361.90277888824414, 18.899999999999995, -421.7699275012174, -298.29167398508673, -382.94153298452795, -0.17631162112283735, -36.05500229464924, -65.04926482493029, -331.22563195305963, -422.55007299294124, 180.09574653419068, 56.83322819801834, -315.6000510060753, 152.73312868504988, 11.485000343299422, -1.0556525527167646, -263.5794469219125, 192.1956941270084, 134.11279642033824, -406.52511342205486, -213.17772505689464, -544.7202757941486, 83.49347812182494, -104.95626026684491, -104.11010068132164, 122.97385727310838, -232.3784173120069, -126.51524422162515, 54.634412287966455, -144.2393667972907, -365.02037635794375, 56.8956175263279, -55.242501663594176, -505.72380232803886, 130.11477772756527, -113.68112075844309, 7.29016374959658, -228.8672568526456, -400.31121477068785, 125.85826335221655, -487.2577018058639, -379.32158092792815, -104.26681023475932, -32.185025746835166, -294.02618821226, -148.66150831888717, -57.24984368484952, -220.62214516801723, 64.70476269821143, -407.87508502816695, -12.538076251404783, -53.26587162115177, -341.99167372165624, -15.829551014446345, 30.799999999999997, -386.0624986035971, -294.1318321919187, 139.37066243281902, -329.4981438812363, -656.2862457367976, -210.4449864514639, -342.5841435531567, -18.72158380164054, 62.37480573398332, -360.5600188364833, -331.3167582369781, -387.10598470392415, 0.7567820894587935, -291.8657017888331, -436.21820473258265, 175.4647544847302, -261.2963435708178, -24.041658605638943, -258.681970762993, -277.0564926718684], "policy_predator_policy_reward": [495.1146661597542, 368.1100458134627, 177.28175432243924, 431.5947231457218, 366.1043474482296, 359.0091535621115, 197.81783030361825, 616.3005736385717, 609.0780894678393, 431.658408538186, 208.12306512709037, 263.3184062233411, 402.5140927318598, 368.76476005634294, 251.92828963567155, 459.2990688178512, 304.3099342109382, 315.2635128781641, 684.9892474320039, 221.38611539549424, 149.3305539633469, 376.51773555363775, 456.57893333777344, 347.314895572855, 541.6882793704267, 411.8263890104505, 404.0602837531244, 463.11586199864905, 251.90847933043355, 737.8524654308544, 382.59155561525984, 566.9803173042357, 88.9585454156747, 96.35983216454024, 270.504680187627, 314.64065207119666, 421.59495068812134, 175.9373504171759, 367.1179041878338, 392.43370023422005, 641.7424875304138, 595.3714548754908, 321.0180163550656, 224.18423548845075, 232.86452226707357, 330.13683482225935, 476.52233937132576, 283.5383317933932, 590.7768460296365, 305.88423830892765, 436.450607911446, 409.8543361459003, 355.7748575200182, 191.04636086455366, 229.71056277833387, 268.52902268570205, 627.350209224147, 116.59789274446617, 379.1683872171852, 257.64285477831, 501.19347035380156, 383.4409516618395, 410.34542953549015, 391.3906388702928, 559.8463790728271, 380.7226189435602, 335.7060090530426, 536.3245071312846, 56.05821402463819, 164.38358733132674, 473.00441984264364, 170.5709598392376, 516.8506002318213, 72.80063954772749, 433.202998774937, 637.2115134738033, 219.5090165000168, 288.79508894600826, 457.6476381830443, 353.7482397860818, 486.1275085124358, 611.1426079358163, 444.67576786833445, 404.86386516496754, 625.3490143752272, 491.41020273456, 278.0756872249836, 262.1207511077744, 324.8925898560458, 283.3421767488463, 370.6528269388079, 456.9378083433643, 752.5616853761364, 667.9623439015014, 135.5249220685317, 463.2517713149124, 240.22440534717933, 414.87292937801493, 134.31249677192793, 403.98680120541576, 603.8055730338418, 195.8969673263415, 314.7374367817532, 367.7148499450148, 433.4358839693296, 380.36743701467304, 468.0619594352717, 361.96102465627706, 295.70223339533976, 208.92967928551298, 381.79304005737316, 171.9530847058964, 303.78416456527236, 96.41099360396255, 310.8166931800206, 288.70531226018784, 550.1001864914631, 421.10900880039867, 296.24104987738195, 44.02201484338396, 403.7189359324897, 353.4778064961086, 453.54410243380255, 458.94414507090454, 590.7855116033419, 279.72754946777167, 330.85372696326147, 575.7111852411947, 74.89337055627227, 392.9038211845979, 411.4143341940264, 302.22614838518155, 367.6471299367442, 358.82687810869294, 147.26517867689586, 369.9478276789647, 546.6798120713091, 552.1466371648869, 426.0862422541463, 456.18044001015346, 274.60336127296836, 488.0102884865534, 190.5651737240482, 194.97541307659301, 166.25658606750198, 171.04974394043438, 357.1092028900085, 587.0650764836864, 292.4755377354703, 256.3832921075568, 401.12614995330983, 421.30653355955945, 497.0268493802481, 523.2542062646512, 460.67905191519367, 105.09996834946348, 423.7877007231014, 330.5728370442574, 262.10585184930113, 339.8996222647506, 286.24431083238017, 260.89129524383446, 400.6588768811184, 266.9005932157006, 180.37166954080413, 552.4151807578515, 334.97385410806856, 165.37872714901525, 16.928089540234676, 308.5462280464787, 293.9108895332715, 320.16802207032833, 506.12380232803895, 182.96799649099688, 303.78152168396053, 404.02333716918554, 421.9272095414193, 506.6193108484795, 460.4039144361634, 256.805055202741, 236.21977018566068, 292.7210503782312, 124.85441922029409, 380.60088121002065, 251.55854011176683, 345.18343362900697, 381.4311392326898, 298.26915406673726, 492.9420577424746, 608.6831938653854, 364.94806148709574, 216.17221179368875, 368.8506860890806, 434.9559141170588, 381.82631863088113, 390.6382879857375, 365.40062267670777, 443.08924281337727, 243.34429743915044, 497.21960676719027]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.011501154261445, "mean_inference_ms": 6.60770402977656, "mean_action_processing_ms": 2.8144541399821668, "mean_env_wait_ms": 16.947516609660735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020684123039245605, "StateBufferConnector_ms": 0.008640646934509277, "ViewRequirementAgentConnector_ms": 0.1454704999923706}, "num_episodes": 17, "episode_return_max": 612.7416033708269, "episode_return_min": -0.0727247380489966, "episode_return_mean": 197.91945429183193, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.56638953648073, "num_env_steps_trained_throughput_per_sec": 67.56638953648073, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 66123.536, "restore_workers_time_ms": 0.022, "training_step_time_ms": 66123.471, "sample_time_ms": 3552.383, "learn_time_ms": 62549.313, "learn_throughput": 63.95, "synch_weights_time_ms": 15.785}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 44, "trial_id": "62684_00000", "date": "2024-08-20_17-02-08", "timestamp": 1724153528, "time_this_iter_s": 59.206860065460205, "time_total_s": 3258.5357365608215, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffa6160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3258.5357365608215, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 23.714285714285715, "ram_util_percent": 74.54166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.21752168185322, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.44234649526312, "policy_loss": -0.020437660904317197, "vf_loss": 7.459753495581607, "vf_explained_var": 0.4446107143205954, "kl": 0.015153295891722731, "entropy": 1.031110213348206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 125490.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.45510787585425, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.43974941596783, "policy_loss": -0.02291506544351775, "vf_loss": 8.459954843066988, "vf_explained_var": 0.07919895787718435, "kl": 0.01354829435318058, "entropy": 0.6522360760068137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "env_runners": {"episode_reward_max": 612.7416033708269, "episode_reward_min": -0.0727247380489966, "episode_reward_mean": 198.829286725946, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -752.5616853761364, "predator_policy": 16.928089540234676}, "policy_reward_max": {"prey_policy": 195.98915540393986, "predator_policy": 752.5616853761364}, "policy_reward_mean": {"prey_policy": -169.90962787008647, "predator_policy": 354.2790851681028}, "custom_metrics": {}, "hist_stats": {"episode_reward": [139.87914852810326, 193.67281799478883, 231.07285504583513, 148.44405601733348, 159.79831763305725, 177.74478045248097, 107.53825811815855, 242.15299796462395, 232.11273045590727, 107.11959241604836, 369.00269940131653, 53.161291837867495, 166.79932900931124, 191.9605362447379, 145.78222458330995, 295.0781618211731, 280.9490681501264, 306.3881229915899, 368.86977805734665, 310.500000000001, 172.66777874309372, 124.74630390008532, 134.34770280520203, 201.25159620039167, 476.86865497659335, 21.679461440738805, 190.73801783498192, 195.86132655344596, 208.38132168091008, 268.94027868036403, 612.7416033708269, 73.45508748454026, 71.71459600760733, 229.46172471004084, 160.90819502418333, 301.46250569893056, 135.00553996180705, 95.13599710971333, 24.839861492883315, 121.19999999999978, 303.4934915543225, 327.35738478230854, 370.5686110729782, 198.15773448446714, 283.80363360304693, 184.00335226798728, 15.244135210371962, 234.59700789811214, 315.4374677143624, 62.67560730824722, -0.0727247380489966, 272.1100850969273, 52.183162346069324, 167.04540565784245, 391.43765313411023, 215.1434831743692, 126.48844572220409, 200.31380204589473, 184.09739029323745, 36.09799901682518, 57.659977123407955, 338.87153705416176, 133.44912119201777, 568.7394395066275, 450.62355213632674, 474.6962007285937, 181.96942803820644, 166.60379235948614, 286.8379205368637, 109.35411885576448, 250.71165110838993, 199.80165346011913, 85.91655097940905, 187.82550100832196, 286.73094544505057, 102.40732339213818, 149.74690184895306, 185.65487738351882, 30.30596250390965, 255.21152442264386, 9.369559474523394, 174.3046288666608, 94.24970221331859, 286.44007167141365, 180.78378216583906, 128.759625105136, 161.37680098666917, 293.67542781044654, 124.21967884899873, 330.3513639438809, 32.97233260066624, 80.72417560145833, 114.8647264708299, 191.560671756615, 196.43391425310176, 153.43688897012981, 191.15656354686365, 175.74638247635798, 279.8910235501768, 189.8759251525088], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-559.9803173042354, 126.65092431177624, -376.36333139893276, 28.47049818925057, -30.806640131111642, 10.690582356436213, 112.18264632178452, -206.064480789273, -260.19064274550016, -443.4073180486234, 6.5064540133999245, -12.187381052738951, -304.7331395026632, -243.43500719046563, -51.58514009586783, 175.3316841972103, -594.7480629137199, -639.952783236914, -136.15613148946207, -327.29746316979777, 25.789600933901937, -430.5651213170471, 147.76752945617105, -38.0507672638314, -466.6849995289993, 185.8956882363979, -247.15862941620955, -597.7645584743207, -77.0353184380655, -114.74161501013, 157.4311241590772, -282.98106906654937, -351.7522997485561, -174.6025338771762, -154.94347441281238, -164.11391825671754, -255.72303737380287, -72.03100490582851, -3.686214175092436, -253.84197972054585, 3.2695843436796146, -301.41517034700917, 30.480218152331602, -379.4668499731448, -142.0423855913709, -3.8026437340831363, -5.038608923293422, -580.7150075370931, 103.67832800213318, -466.83731211892183, -157.62801613886816, -472.5398714775293, -301.65122249647357, 140.01021894920504, -579.8847896241857, 61.06777211591513, 15.656279381288101, 95.52772686898219, 78.54178597536176, -84.01131420030957, -463.0981279590516, 48.77378145807428, -56.58325443781008, 34.16855428359377, -516.8734901630565, 17.80000000000001, 6.640150220166568, -637.1115134738033, -305.5954461899023, -183.30336336725782, -295.2479980885132, 171.49885221013784, -494.41029215555346, 139.88306916301937, 20.000000000000014, -483.027508512436, -610.4426079358162, 17.8794614407389, 181.50654017084796, -408.08531465848597, -432.2228407106809, -593.8005909677975, -511.7156672231121, 184.6183676345686, 93.68186256109728, -267.60265817367525, -157.8943210392677, -32.94670880492267, -347.047779119605, 40.69999999999998, 130.71268336018014, -218.97838843929568, -126.58332683223085, -263.26381076510273, -331.2434456518567, -752.5616853761364, -459.6517713149117, -6.485947362578717, -60.924378698346146, -175.5594321487994, -12.983337556394082, -237.092840309959, -73.92170625523315, -263.19035221732855, -40.27904448059706, -566.0387639003573, 177.56118132213163, -109.76245208302723, -258.6750726190714, 0.7747480372170905, -289.5464221831066, -417.89029305314307, -213.44430589293952, -87.3327249282074, -39.531323823472746, -350.1610246562773, -415.4907741189152, 95.59999999999997, -191.02967928551342, -288.0022333953399, 51.83290126907776, -384.33501856245056, 82.2494840844262, -201.99416385977142, 58.48759827240792, 70.66879220043737, 176.2009262107395, -1.0680629422661712, -404.08625763570325, -143.76863690995881, -296.0954156045232, -333.1874082929129, 180.63240703431362, -76.80188048187172, -160.28995767016212, 15.142138368925508, -275.67567021182117, -312.6598583177147, -477.6732059361204, 14.285404409585203, -433.8563107677998, 139.31900361982986, -185.37855284962532, -589.8565039432056, -89.66589177436664, 120.39365504583886, -621.8552077615676, -242.63654486232934, -38.250254319477136, -124.2347852508169, -411.86214969300966, -184.69318721786235, -117.15787040638533, -48.309683073221244, -370.4458302824732, -35.608409592814205, -311.0276855840763, -52.48234672059231, -101.5198117051232, -543.2798120713084, -534.9456502732237, 146.44441876617955, -43.76888640180294, 44.6736548596588, -491.73379758804623, -191.45464081023997, 168.95701165646082, -524.9725374313734, -239.4724012719284, -32.98346756056949, 13.403727754061666, -167.2391144317051, -101.91819369434711, 132.1647801640109, -562.5603972027997, -162.6520276116125, -34.86446426604552, 15.127070403129121, -250.71796162541972, -277.16993960391, -361.90277888824414, 18.899999999999995, -421.7699275012174, -298.29167398508673, -382.94153298452795, -0.17631162112283735, -36.05500229464924, -65.04926482493029, -331.22563195305963, -422.55007299294124, 180.09574653419068, 56.83322819801834, -315.6000510060753, 152.73312868504988, 11.485000343299422, -1.0556525527167646, -263.5794469219125, 192.1956941270084, 134.11279642033824, -406.52511342205486, -213.17772505689464, -544.7202757941486, 83.49347812182494, -104.95626026684491, -104.11010068132164, 122.97385727310838, -232.3784173120069, -126.51524422162515, 54.634412287966455, -144.2393667972907, -365.02037635794375, 56.8956175263279, -55.242501663594176, -505.72380232803886, 130.11477772756527, -113.68112075844309, 7.29016374959658, -228.8672568526456, -400.31121477068785, 125.85826335221655, -487.2577018058639, -379.32158092792815, -104.26681023475932, -32.185025746835166, -294.02618821226, -148.66150831888717, -57.24984368484952, -220.62214516801723, 64.70476269821143, -407.87508502816695, -12.538076251404783, -53.26587162115177, -341.99167372165624, -15.829551014446345, 30.799999999999997, -386.0624986035971, -294.1318321919187, 139.37066243281902, -329.4981438812363, -656.2862457367976, -210.4449864514639, -342.5841435531567, -18.72158380164054, 62.37480573398332, -360.5600188364833, -331.3167582369781, -387.10598470392415, 0.7567820894587935, -291.8657017888331, -436.21820473258265, 175.4647544847302, -261.2963435708178, -24.041658605638943, -258.681970762993, -277.0564926718684, -228.03602070983825, -69.8269737017474, 41.67993606454656, -155.48289177876063, 141.98186950034534, -398.97791448509446, 26.80864447598992, -243.0338312037325, -29.673480482500455, -21.387303790231158, -94.37717378363563, -295.11482563875245, -78.95334209846014, 182.9073051169447, -304.65808259917884, -271.5971967648743, -602.6149476748559, -165.54082762340732, 14.850007167766998, -21.332214525927462, -521.0741991732841, -571.6376821440615, 111.3119216108838, -429.5374262506128, -221.2463716117463, -343.31414511560314, 159.4185741390867, -330.7760015199514, 195.98915540393986, -471.0398902507157, -244.71689591150889, -158.1970699799859, 2.0348642669702315, 8.427742758183223, -46.548956037507715, -513.8657865240218, 142.00853532874328, -485.04341044020975, -379.94006498939643, -349.70665280286926, -34.37619956514693, -12.377581030088118, -110.77590083455775, -466.2532592512512, 20.000000000000014], "policy_predator_policy_reward": [382.59155561525984, 566.9803173042357, 88.9585454156747, 96.35983216454024, 270.504680187627, 314.64065207119666, 421.59495068812134, 175.9373504171759, 367.1179041878338, 392.43370023422005, 641.7424875304138, 595.3714548754908, 321.0180163550656, 224.18423548845075, 232.86452226707357, 330.13683482225935, 476.52233937132576, 283.5383317933932, 590.7768460296365, 305.88423830892765, 436.450607911446, 409.8543361459003, 355.7748575200182, 191.04636086455366, 229.71056277833387, 268.52902268570205, 627.350209224147, 116.59789274446617, 379.1683872171852, 257.64285477831, 501.19347035380156, 383.4409516618395, 410.34542953549015, 391.3906388702928, 559.8463790728271, 380.7226189435602, 335.7060090530426, 536.3245071312846, 56.05821402463819, 164.38358733132674, 473.00441984264364, 170.5709598392376, 516.8506002318213, 72.80063954772749, 433.202998774937, 637.2115134738033, 219.5090165000168, 288.79508894600826, 457.6476381830443, 353.7482397860818, 486.1275085124358, 611.1426079358163, 444.67576786833445, 404.86386516496754, 625.3490143752272, 491.41020273456, 278.0756872249836, 262.1207511077744, 324.8925898560458, 283.3421767488463, 370.6528269388079, 456.9378083433643, 752.5616853761364, 667.9623439015014, 135.5249220685317, 463.2517713149124, 240.22440534717933, 414.87292937801493, 134.31249677192793, 403.98680120541576, 603.8055730338418, 195.8969673263415, 314.7374367817532, 367.7148499450148, 433.4358839693296, 380.36743701467304, 468.0619594352717, 361.96102465627706, 295.70223339533976, 208.92967928551298, 381.79304005737316, 171.9530847058964, 303.78416456527236, 96.41099360396255, 310.8166931800206, 288.70531226018784, 550.1001864914631, 421.10900880039867, 296.24104987738195, 44.02201484338396, 403.7189359324897, 353.4778064961086, 453.54410243380255, 458.94414507090454, 590.7855116033419, 279.72754946777167, 330.85372696326147, 575.7111852411947, 74.89337055627227, 392.9038211845979, 411.4143341940264, 302.22614838518155, 367.6471299367442, 358.82687810869294, 147.26517867689586, 369.9478276789647, 546.6798120713091, 552.1466371648869, 426.0862422541463, 456.18044001015346, 274.60336127296836, 488.0102884865534, 190.5651737240482, 194.97541307659301, 166.25658606750198, 171.04974394043438, 357.1092028900085, 587.0650764836864, 292.4755377354703, 256.3832921075568, 401.12614995330983, 421.30653355955945, 497.0268493802481, 523.2542062646512, 460.67905191519367, 105.09996834946348, 423.7877007231014, 330.5728370442574, 262.10585184930113, 339.8996222647506, 286.24431083238017, 260.89129524383446, 400.6588768811184, 266.9005932157006, 180.37166954080413, 552.4151807578515, 334.97385410806856, 165.37872714901525, 16.928089540234676, 308.5462280464787, 293.9108895332715, 320.16802207032833, 506.12380232803895, 182.96799649099688, 303.78152168396053, 404.02333716918554, 421.9272095414193, 506.6193108484795, 460.4039144361634, 256.805055202741, 236.21977018566068, 292.7210503782312, 124.85441922029409, 380.60088121002065, 251.55854011176683, 345.18343362900697, 381.4311392326898, 298.26915406673726, 492.9420577424746, 608.6831938653854, 364.94806148709574, 216.17221179368875, 368.8506860890806, 434.9559141170588, 381.82631863088113, 390.6382879857375, 365.40062267670777, 443.08924281337727, 243.34429743915044, 497.21960676719027, 206.5927476602822, 178.3499357918921, 171.28289177876042, 402.5728459714196, 378.17097554144317, 161.4031194792451, 314.2791742263578, 220.8198078352605, 182.67038849196916, 348.3850950326081, 448.59859637801856, 624.1267082857847, 522.9741991732845, 85.306382959619, 430.590231110559, 574.1376821440621, 248.38846922927468, 348.3141451156036, 465.74601476324233, 336.5146358565871, 191.02252564616083, 363.2934649484936, 222.80466684758244, 520.3388965026285, 515.2812575878247, 383.44006498939723, 327.05910657788473, 349.2923503703967, 303.8206848287452, 443.0844004095738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.954520474771455, "mean_inference_ms": 6.587882494844471, "mean_action_processing_ms": 2.787680262667326, "mean_env_wait_ms": 16.83699644602798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015295982360839842, "StateBufferConnector_ms": 0.008510828018188477, "ViewRequirementAgentConnector_ms": 0.13897573947906494}, "num_episodes": 15, "episode_return_max": 612.7416033708269, "episode_return_min": -0.0727247380489966, "episode_return_mean": 198.829286725946, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.52990023232732, "num_env_steps_trained_throughput_per_sec": 67.52990023232732, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 900000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 64892.024, "restore_workers_time_ms": 0.017, "training_step_time_ms": 64891.971, "sample_time_ms": 3182.396, "learn_time_ms": 61688.593, "learn_throughput": 64.842, "synch_weights_time_ms": 15.592}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "training_iteration": 45, "trial_id": "62684_00000", "date": "2024-08-20_17-03-07", "timestamp": 1724153587, "time_this_iter_s": 59.28022503852844, "time_total_s": 3317.81596159935, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffb8940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3317.81596159935, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 24.201190476190476, "ram_util_percent": 74.66785714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.46178217263932, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.3369996508808, "policy_loss": -0.018072361592946454, "vf_loss": 7.35209136685581, "vf_explained_var": 0.4289214626694402, "kl": 0.014903230226354291, "entropy": 1.007323226142437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 128310.5, "diff_num_grad_updates_vs_sampler_policy": 1448.979999999996}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.041190960104503, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.429198597347925, "policy_loss": -0.022122538653473373, "vf_loss": 8.448908872705289, "vf_explained_var": -0.1670961387889095, "kl": 0.012061330474045857, "entropy": 0.639977939797457, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 970.9600000000065}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "env_runners": {"episode_reward_max": 568.7394395066275, "episode_reward_min": -0.0727247380489966, "episode_reward_mean": 188.60382364550452, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -752.5616853761364, "predator_policy": 16.928089540234676}, "policy_reward_max": {"prey_policy": 195.98915540393986, "predator_policy": 752.5616853761364}, "policy_reward_mean": {"prey_policy": -171.47890037517752, "predator_policy": 351.52026238551866}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.45508748454026, 71.71459600760733, 229.46172471004084, 160.90819502418333, 301.46250569893056, 135.00553996180705, 95.13599710971333, 24.839861492883315, 121.19999999999978, 303.4934915543225, 327.35738478230854, 370.5686110729782, 198.15773448446714, 283.80363360304693, 184.00335226798728, 15.244135210371962, 234.59700789811214, 315.4374677143624, 62.67560730824722, -0.0727247380489966, 272.1100850969273, 52.183162346069324, 167.04540565784245, 391.43765313411023, 215.1434831743692, 126.48844572220409, 200.31380204589473, 184.09739029323745, 36.09799901682518, 57.659977123407955, 338.87153705416176, 133.44912119201777, 568.7394395066275, 450.62355213632674, 474.6962007285937, 181.96942803820644, 166.60379235948614, 286.8379205368637, 109.35411885576448, 250.71165110838993, 199.80165346011913, 85.91655097940905, 187.82550100832196, 286.73094544505057, 102.40732339213818, 149.74690184895306, 185.65487738351882, 30.30596250390965, 255.21152442264386, 9.369559474523394, 174.3046288666608, 94.24970221331859, 286.44007167141365, 180.78378216583906, 128.759625105136, 161.37680098666917, 293.67542781044654, 124.21967884899873, 330.3513639438809, 32.97233260066624, 80.72417560145833, 114.8647264708299, 191.560671756615, 196.43391425310176, 153.43688897012981, 191.15656354686365, 175.74638247635798, 279.8910235501768, 189.8759251525088, 53.45847141523901, 173.25171865996109, 137.15857397702223, 114.24237361764006, 334.4676362039516, 198.61014303559668, 144.273947953335, 225.40381391655947, 456.22174654227535, 237.913814084225, 33.58430795520932, 232.3393646799271, 408.0957885158421, 135.70726238502797, 181.65053442369228, 194.26713779520534, 29.081960227046, 196.10954984228727, 229.9298655536251, 165.36941085881742, 139.55164769814473, 188.65431109623688, 89.02497150083062, 349.19176653477996, 95.23159497660129, 216.9081700282423, 411.86664530302664, 46.24591597545962, 109.81612386796832, 199.2612645166379, 86.81467172519416], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-263.26381076510273, -331.2434456518567, -752.5616853761364, -459.6517713149117, -6.485947362578717, -60.924378698346146, -175.5594321487994, -12.983337556394082, -237.092840309959, -73.92170625523315, -263.19035221732855, -40.27904448059706, -566.0387639003573, 177.56118132213163, -109.76245208302723, -258.6750726190714, 0.7747480372170905, -289.5464221831066, -417.89029305314307, -213.44430589293952, -87.3327249282074, -39.531323823472746, -350.1610246562773, -415.4907741189152, 95.59999999999997, -191.02967928551342, -288.0022333953399, 51.83290126907776, -384.33501856245056, 82.2494840844262, -201.99416385977142, 58.48759827240792, 70.66879220043737, 176.2009262107395, -1.0680629422661712, -404.08625763570325, -143.76863690995881, -296.0954156045232, -333.1874082929129, 180.63240703431362, -76.80188048187172, -160.28995767016212, 15.142138368925508, -275.67567021182117, -312.6598583177147, -477.6732059361204, 14.285404409585203, -433.8563107677998, 139.31900361982986, -185.37855284962532, -589.8565039432056, -89.66589177436664, 120.39365504583886, -621.8552077615676, -242.63654486232934, -38.250254319477136, -124.2347852508169, -411.86214969300966, -184.69318721786235, -117.15787040638533, -48.309683073221244, -370.4458302824732, -35.608409592814205, -311.0276855840763, -52.48234672059231, -101.5198117051232, -543.2798120713084, -534.9456502732237, 146.44441876617955, -43.76888640180294, 44.6736548596588, -491.73379758804623, -191.45464081023997, 168.95701165646082, -524.9725374313734, -239.4724012719284, -32.98346756056949, 13.403727754061666, -167.2391144317051, -101.91819369434711, 132.1647801640109, -562.5603972027997, -162.6520276116125, -34.86446426604552, 15.127070403129121, -250.71796162541972, -277.16993960391, -361.90277888824414, 18.899999999999995, -421.7699275012174, -298.29167398508673, -382.94153298452795, -0.17631162112283735, -36.05500229464924, -65.04926482493029, -331.22563195305963, -422.55007299294124, 180.09574653419068, 56.83322819801834, -315.6000510060753, 152.73312868504988, 11.485000343299422, -1.0556525527167646, -263.5794469219125, 192.1956941270084, 134.11279642033824, -406.52511342205486, -213.17772505689464, -544.7202757941486, 83.49347812182494, -104.95626026684491, -104.11010068132164, 122.97385727310838, -232.3784173120069, -126.51524422162515, 54.634412287966455, -144.2393667972907, -365.02037635794375, 56.8956175263279, -55.242501663594176, -505.72380232803886, 130.11477772756527, -113.68112075844309, 7.29016374959658, -228.8672568526456, -400.31121477068785, 125.85826335221655, -487.2577018058639, -379.32158092792815, -104.26681023475932, -32.185025746835166, -294.02618821226, -148.66150831888717, -57.24984368484952, -220.62214516801723, 64.70476269821143, -407.87508502816695, -12.538076251404783, -53.26587162115177, -341.99167372165624, -15.829551014446345, 30.799999999999997, -386.0624986035971, -294.1318321919187, 139.37066243281902, -329.4981438812363, -656.2862457367976, -210.4449864514639, -342.5841435531567, -18.72158380164054, 62.37480573398332, -360.5600188364833, -331.3167582369781, -387.10598470392415, 0.7567820894587935, -291.8657017888331, -436.21820473258265, 175.4647544847302, -261.2963435708178, -24.041658605638943, -258.681970762993, -277.0564926718684, -228.03602070983825, -69.8269737017474, 41.67993606454656, -155.48289177876063, 141.98186950034534, -398.97791448509446, 26.80864447598992, -243.0338312037325, -29.673480482500455, -21.387303790231158, -94.37717378363563, -295.11482563875245, -78.95334209846014, 182.9073051169447, -304.65808259917884, -271.5971967648743, -602.6149476748559, -165.54082762340732, 14.850007167766998, -21.332214525927462, -521.0741991732841, -571.6376821440615, 111.3119216108838, -429.5374262506128, -221.2463716117463, -343.31414511560314, 159.4185741390867, -330.7760015199514, 195.98915540393986, -471.0398902507157, -244.71689591150889, -158.1970699799859, 2.0348642669702315, 8.427742758183223, -46.548956037507715, -513.8657865240218, 142.00853532874328, -485.04341044020975, -379.94006498939643, -349.70665280286926, -34.37619956514693, -12.377581030088118, -110.77590083455775, -466.2532592512512, 20.000000000000014, -472.76511878820793, -104.40798648552368, -72.20544754699424, 48.884788953497605, -264.87638648067673, -283.8622150599515, -537.9947212602923, -111.36097382645528, 5.65020203258759, -83.11257810453407, -163.9649116593722, -468.0480215115801, -58.81408311376755, 168.42311448327004, -246.78124595060837, 172.8811239059171, -394.2376307790001, -427.83238850965506, -194.42620445372626, -480.7766802377145, -31.558305633002057, -15.757792339421101, -181.85926369584877, 26.722899839155335, 96.08158392718062, -38.74392019257118, -409.0059030388528, -169.9962121222884, -474.3675792664151, 164.0867585195504, -38.97945019030969, -407.5153625477908, -118.36668837891298, 158.50623280642148, -414.89692096075163, -184.7193513754906, 22.578655270740356, -596.0113850869343, 124.62782914514207, -461.2394869636842, -127.61845602051451, -110.84176676790615, -468.10752366904995, -131.53110786001642, 28.442470958887643, -293.65902548996894, 75.8315895983375, -526.4668938380426, -272.6466149645903, -208.94574963454792, -427.20140479487196, -284.56621135734173, -344.632697004064, 158.20995805018876, -214.58317169401803, -98.37369541969531, -63.80181041689208, -249.03394373746787, -216.57820194371655, 25.61289065760141, -90.98826865838372, -112.75095756297493, -588.9023920693007, -184.2724350245618, 43.53955534217032, -557.7043033195451, 43.98725545823097, 13.563290682055289, -413.91205235711277, -115.26385932111225, 75.79999999999998, -8.59738093352743, 89.55009110042593, -503.8006963646138, -250.21620413808145, -127.43485799851365, 76.52741899362154, -250.97327791187263, 126.12305237718617, -418.5820352166644, -14.971684586994586, -163.0082921932736, -625.1018591409902, -317.04269454844814, -240.96722670625704, -71.56489920567775, -208.84760419172832, -462.5350586737408, -97.04775834605513, -122.60383427963578, -18.66599762354246, -86.5446479867726, -114.4165470998892], "policy_predator_policy_reward": [752.5616853761364, 667.9623439015014, 135.5249220685317, 463.2517713149124, 240.22440534717933, 414.87292937801493, 134.31249677192793, 403.98680120541576, 603.8055730338418, 195.8969673263415, 314.7374367817532, 367.7148499450148, 433.4358839693296, 380.36743701467304, 468.0619594352717, 361.96102465627706, 295.70223339533976, 208.92967928551298, 381.79304005737316, 171.9530847058964, 303.78416456527236, 96.41099360396255, 310.8166931800206, 288.70531226018784, 550.1001864914631, 421.10900880039867, 296.24104987738195, 44.02201484338396, 403.7189359324897, 353.4778064961086, 453.54410243380255, 458.94414507090454, 590.7855116033419, 279.72754946777167, 330.85372696326147, 575.7111852411947, 74.89337055627227, 392.9038211845979, 411.4143341940264, 302.22614838518155, 367.6471299367442, 358.82687810869294, 147.26517867689586, 369.9478276789647, 546.6798120713091, 552.1466371648869, 426.0862422541463, 456.18044001015346, 274.60336127296836, 488.0102884865534, 190.5651737240482, 194.97541307659301, 166.25658606750198, 171.04974394043438, 357.1092028900085, 587.0650764836864, 292.4755377354703, 256.3832921075568, 401.12614995330983, 421.30653355955945, 497.0268493802481, 523.2542062646512, 460.67905191519367, 105.09996834946348, 423.7877007231014, 330.5728370442574, 262.10585184930113, 339.8996222647506, 286.24431083238017, 260.89129524383446, 400.6588768811184, 266.9005932157006, 180.37166954080413, 552.4151807578515, 334.97385410806856, 165.37872714901525, 16.928089540234676, 308.5462280464787, 293.9108895332715, 320.16802207032833, 506.12380232803895, 182.96799649099688, 303.78152168396053, 404.02333716918554, 421.9272095414193, 506.6193108484795, 460.4039144361634, 256.805055202741, 236.21977018566068, 292.7210503782312, 124.85441922029409, 380.60088121002065, 251.55854011176683, 345.18343362900697, 381.4311392326898, 298.26915406673726, 492.9420577424746, 608.6831938653854, 364.94806148709574, 216.17221179368875, 368.8506860890806, 434.9559141170588, 381.82631863088113, 390.6382879857375, 365.40062267670777, 443.08924281337727, 243.34429743915044, 497.21960676719027, 206.5927476602822, 178.3499357918921, 171.28289177876042, 402.5728459714196, 378.17097554144317, 161.4031194792451, 314.2791742263578, 220.8198078352605, 182.67038849196916, 348.3850950326081, 448.59859637801856, 624.1267082857847, 522.9741991732845, 85.306382959619, 430.590231110559, 574.1376821440621, 248.38846922927468, 348.3141451156036, 465.74601476324233, 336.5146358565871, 191.02252564616083, 363.2934649484936, 222.80466684758244, 520.3388965026285, 515.2812575878247, 383.44006498939723, 327.05910657788473, 349.2923503703967, 303.8206848287452, 443.0844004095738, 442.9000556993281, 259.9369685366362, 343.5870084614539, 329.5185227856401, 354.33799326775573, 426.526073763427, 368.53761736309724, 460.83026753002827, 289.2264488692652, 182.41340191579252, 376.8920545921695, 470.9069838261663, 325.4708886702469, 525.5642496075307, 120.23007680218612, 276.06789331048793, 374.18645835905284, 433.70352748746564, 243.42326768696304, 474.76757926641517, 284.7655297267555, 313.68027934546626, 255.95248324899637, 417.4969209607522, 502.17397086729, 354.7267183196013, 288.0540676057517, 547.3529045313818, 478.3140450006374, 274.5326499932346, 540.2668938380432, 398.2945736868366, 480.4234927053469, 457.45223691570976, 318.66580314944014, 348.4326970040644, 303.63768892511774, 303.0508541591135, 276.88829003289936, 328.48037584950083, 623.0756266037155, 309.11763938508903, 478.5046763194659, 408.58681777870726, 28.67442536054573, 416.71205235711284, 172.09574415303496, 225.15726263638456, 494.69353946551377, 265.00486491335647, 146.00226298768968, 372.786623957317, 401.84391573147997, 317.45339699801775, 566.6387343345685, 584.7600275236041, 388.4527659292266, 242.74308804240488, 486.42051778732866, 395.0273980287415, 151.4309365769671, 155.0109278584312]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.849639176288716, "mean_inference_ms": 6.475892265731982, "mean_action_processing_ms": 2.7394084981079576, "mean_env_wait_ms": 16.613472025873836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012986063957214355, "StateBufferConnector_ms": 0.0078355073928833, "ViewRequirementAgentConnector_ms": 0.13750827312469482}, "num_episodes": 31, "episode_return_max": 568.7394395066275, "episode_return_min": -0.0727247380489966, "episode_return_mean": 188.60382364550452, "episodes_this_iter": 31}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.65827909681845, "num_env_steps_trained_throughput_per_sec": 66.65827909681845, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 920000, "timers": {"training_iteration_time_ms": 64143.864, "restore_workers_time_ms": 0.016, "training_step_time_ms": 64143.814, "sample_time_ms": 3047.042, "learn_time_ms": 61077.097, "learn_throughput": 65.491, "synch_weights_time_ms": 15.241}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "done": false, "training_iteration": 46, "trial_id": "62684_00000", "date": "2024-08-20_17-04-07", "timestamp": 1724153647, "time_this_iter_s": 60.05475091934204, "time_total_s": 3377.870712518692, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3acade1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3377.870712518692, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 26.22857142857143, "ram_util_percent": 77.40952380952382}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.777704425103275, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.198255671507924, "policy_loss": -0.01918551916444793, "vf_loss": 7.214376781003695, "vf_explained_var": 0.46032774435712936, "kl": 0.015322061072777402, "entropy": 1.0033815091383373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 131130.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.696117475928453, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.496706991851646, "policy_loss": -0.024920233128414977, "vf_loss": 8.519294211978004, "vf_explained_var": 0.034953739277269476, "kl": 0.011664889195303202, "entropy": 0.5870488559285169, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 940000}, "env_runners": {"episode_reward_max": 636.0323604808955, "episode_reward_min": -0.0727247380489966, "episode_reward_mean": 200.18610509573827, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -656.2862457367976, "predator_policy": 16.928089540234676}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 652.2917053260021}, "policy_reward_mean": {"prey_policy": -161.41124228731582, "predator_policy": 342.20991597884296}, "custom_metrics": {}, "hist_stats": {"episode_reward": [62.67560730824722, -0.0727247380489966, 272.1100850969273, 52.183162346069324, 167.04540565784245, 391.43765313411023, 215.1434831743692, 126.48844572220409, 200.31380204589473, 184.09739029323745, 36.09799901682518, 57.659977123407955, 338.87153705416176, 133.44912119201777, 568.7394395066275, 450.62355213632674, 474.6962007285937, 181.96942803820644, 166.60379235948614, 286.8379205368637, 109.35411885576448, 250.71165110838993, 199.80165346011913, 85.91655097940905, 187.82550100832196, 286.73094544505057, 102.40732339213818, 149.74690184895306, 185.65487738351882, 30.30596250390965, 255.21152442264386, 9.369559474523394, 174.3046288666608, 94.24970221331859, 286.44007167141365, 180.78378216583906, 128.759625105136, 161.37680098666917, 293.67542781044654, 124.21967884899873, 330.3513639438809, 32.97233260066624, 80.72417560145833, 114.8647264708299, 191.560671756615, 196.43391425310176, 153.43688897012981, 191.15656354686365, 175.74638247635798, 279.8910235501768, 189.8759251525088, 53.45847141523901, 173.25171865996109, 137.15857397702223, 114.24237361764006, 334.4676362039516, 198.61014303559668, 144.273947953335, 225.40381391655947, 456.22174654227535, 237.913814084225, 33.58430795520932, 232.3393646799271, 408.0957885158421, 135.70726238502797, 181.65053442369228, 194.26713779520534, 29.081960227046, 196.10954984228727, 229.9298655536251, 165.36941085881742, 139.55164769814473, 188.65431109623688, 89.02497150083062, 349.19176653477996, 95.23159497660129, 216.9081700282423, 411.86664530302664, 46.24591597545962, 109.81612386796832, 199.2612645166379, 86.81467172519416, 159.79393063301686, 169.49495723139555, 308.53403790895254, 429.3471801485321, 249.32486465944683, 337.6588716432942, 138.61195522772064, 255.79589566513482, 142.3999999999998, 59.151416404828666, 372.7827785836509, 114.7867774241404, 381.8995198299119, 77.03597579384065, 225.52966901025212, 636.0323604808955, 224.50027044078072, 321.3940100152448], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-242.63654486232934, -38.250254319477136, -124.2347852508169, -411.86214969300966, -184.69318721786235, -117.15787040638533, -48.309683073221244, -370.4458302824732, -35.608409592814205, -311.0276855840763, -52.48234672059231, -101.5198117051232, -543.2798120713084, -534.9456502732237, 146.44441876617955, -43.76888640180294, 44.6736548596588, -491.73379758804623, -191.45464081023997, 168.95701165646082, -524.9725374313734, -239.4724012719284, -32.98346756056949, 13.403727754061666, -167.2391144317051, -101.91819369434711, 132.1647801640109, -562.5603972027997, -162.6520276116125, -34.86446426604552, 15.127070403129121, -250.71796162541972, -277.16993960391, -361.90277888824414, 18.899999999999995, -421.7699275012174, -298.29167398508673, -382.94153298452795, -0.17631162112283735, -36.05500229464924, -65.04926482493029, -331.22563195305963, -422.55007299294124, 180.09574653419068, 56.83322819801834, -315.6000510060753, 152.73312868504988, 11.485000343299422, -1.0556525527167646, -263.5794469219125, 192.1956941270084, 134.11279642033824, -406.52511342205486, -213.17772505689464, -544.7202757941486, 83.49347812182494, -104.95626026684491, -104.11010068132164, 122.97385727310838, -232.3784173120069, -126.51524422162515, 54.634412287966455, -144.2393667972907, -365.02037635794375, 56.8956175263279, -55.242501663594176, -505.72380232803886, 130.11477772756527, -113.68112075844309, 7.29016374959658, -228.8672568526456, -400.31121477068785, 125.85826335221655, -487.2577018058639, -379.32158092792815, -104.26681023475932, -32.185025746835166, -294.02618821226, -148.66150831888717, -57.24984368484952, -220.62214516801723, 64.70476269821143, -407.87508502816695, -12.538076251404783, -53.26587162115177, -341.99167372165624, -15.829551014446345, 30.799999999999997, -386.0624986035971, -294.1318321919187, 139.37066243281902, -329.4981438812363, -656.2862457367976, -210.4449864514639, -342.5841435531567, -18.72158380164054, 62.37480573398332, -360.5600188364833, -331.3167582369781, -387.10598470392415, 0.7567820894587935, -291.8657017888331, -436.21820473258265, 175.4647544847302, -261.2963435708178, -24.041658605638943, -258.681970762993, -277.0564926718684, -228.03602070983825, -69.8269737017474, 41.67993606454656, -155.48289177876063, 141.98186950034534, -398.97791448509446, 26.80864447598992, -243.0338312037325, -29.673480482500455, -21.387303790231158, -94.37717378363563, -295.11482563875245, -78.95334209846014, 182.9073051169447, -304.65808259917884, -271.5971967648743, -602.6149476748559, -165.54082762340732, 14.850007167766998, -21.332214525927462, -521.0741991732841, -571.6376821440615, 111.3119216108838, -429.5374262506128, -221.2463716117463, -343.31414511560314, 159.4185741390867, -330.7760015199514, 195.98915540393986, -471.0398902507157, -244.71689591150889, -158.1970699799859, 2.0348642669702315, 8.427742758183223, -46.548956037507715, -513.8657865240218, 142.00853532874328, -485.04341044020975, -379.94006498939643, -349.70665280286926, -34.37619956514693, -12.377581030088118, -110.77590083455775, -466.2532592512512, 20.000000000000014, -472.76511878820793, -104.40798648552368, -72.20544754699424, 48.884788953497605, -264.87638648067673, -283.8622150599515, -537.9947212602923, -111.36097382645528, 5.65020203258759, -83.11257810453407, -163.9649116593722, -468.0480215115801, -58.81408311376755, 168.42311448327004, -246.78124595060837, 172.8811239059171, -394.2376307790001, -427.83238850965506, -194.42620445372626, -480.7766802377145, -31.558305633002057, -15.757792339421101, -181.85926369584877, 26.722899839155335, 96.08158392718062, -38.74392019257118, -409.0059030388528, -169.9962121222884, -474.3675792664151, 164.0867585195504, -38.97945019030969, -407.5153625477908, -118.36668837891298, 158.50623280642148, -414.89692096075163, -184.7193513754906, 22.578655270740356, -596.0113850869343, 124.62782914514207, -461.2394869636842, -127.61845602051451, -110.84176676790615, -468.10752366904995, -131.53110786001642, 28.442470958887643, -293.65902548996894, 75.8315895983375, -526.4668938380426, -272.6466149645903, -208.94574963454792, -427.20140479487196, -284.56621135734173, -344.632697004064, 158.20995805018876, -214.58317169401803, -98.37369541969531, -63.80181041689208, -249.03394373746787, -216.57820194371655, 25.61289065760141, -90.98826865838372, -112.75095756297493, -588.9023920693007, -184.2724350245618, 43.53955534217032, -557.7043033195451, 43.98725545823097, 13.563290682055289, -413.91205235711277, -115.26385932111225, 75.79999999999998, -8.59738093352743, 89.55009110042593, -503.8006963646138, -250.21620413808145, -127.43485799851365, 76.52741899362154, -250.97327791187263, 126.12305237718617, -418.5820352166644, -14.971684586994586, -163.0082921932736, -625.1018591409902, -317.04269454844814, -240.96722670625704, -71.56489920567775, -208.84760419172832, -462.5350586737408, -97.04775834605513, -122.60383427963578, -18.66599762354246, -86.5446479867726, -114.4165470998892, -400.008903771805, -21.428524323688894, 83.34537449802544, 115.24321242719421, -40.79954980078856, -365.186314117217, -171.0255405201382, 50.18158693076043, 0.8924041177213096, -116.9372839294758, -380.4190814928898, 175.1897232281098, -94.76613593959853, -294.6104900381702, 108.73235205202293, -449.7171993080354, 189.2, -110.89191317290675, -46.29156002793539, -66.27296707728753, -536.6305704349558, 137.16182054032126, -171.23899825848997, -199.58732603896496, -212.09532283401245, 121.69476543003394, -361.9941120345669, -55.68204907485528, -650.8014830594802, 6.394376762465605, -559.1006401511415, 22.440446252562502, 49.699999999999974, -154.96943966198063, -171.12678678827382, -107.90289102718953, -190.7857719686354, -430.3370945111956, 147.0831986673652, -128.01092220182701, -362.6326920408227, 29.941587454319357, 104.4047120850109, -496.08055003266907, -52.125648004112215, 191.9, -343.5825911806992, 194.6, -242.26487174116826, 200.0, -314.5259195373536, -18.61656230440951, -34.43691529562369, -264.08609810855637], "policy_predator_policy_reward": [74.89337055627227, 392.9038211845979, 411.4143341940264, 302.22614838518155, 367.6471299367442, 358.82687810869294, 147.26517867689586, 369.9478276789647, 546.6798120713091, 552.1466371648869, 426.0862422541463, 456.18044001015346, 274.60336127296836, 488.0102884865534, 190.5651737240482, 194.97541307659301, 166.25658606750198, 171.04974394043438, 357.1092028900085, 587.0650764836864, 292.4755377354703, 256.3832921075568, 401.12614995330983, 421.30653355955945, 497.0268493802481, 523.2542062646512, 460.67905191519367, 105.09996834946348, 423.7877007231014, 330.5728370442574, 262.10585184930113, 339.8996222647506, 286.24431083238017, 260.89129524383446, 400.6588768811184, 266.9005932157006, 180.37166954080413, 552.4151807578515, 334.97385410806856, 165.37872714901525, 16.928089540234676, 308.5462280464787, 293.9108895332715, 320.16802207032833, 506.12380232803895, 182.96799649099688, 303.78152168396053, 404.02333716918554, 421.9272095414193, 506.6193108484795, 460.4039144361634, 256.805055202741, 236.21977018566068, 292.7210503782312, 124.85441922029409, 380.60088121002065, 251.55854011176683, 345.18343362900697, 381.4311392326898, 298.26915406673726, 492.9420577424746, 608.6831938653854, 364.94806148709574, 216.17221179368875, 368.8506860890806, 434.9559141170588, 381.82631863088113, 390.6382879857375, 365.40062267670777, 443.08924281337727, 243.34429743915044, 497.21960676719027, 206.5927476602822, 178.3499357918921, 171.28289177876042, 402.5728459714196, 378.17097554144317, 161.4031194792451, 314.2791742263578, 220.8198078352605, 182.67038849196916, 348.3850950326081, 448.59859637801856, 624.1267082857847, 522.9741991732845, 85.306382959619, 430.590231110559, 574.1376821440621, 248.38846922927468, 348.3141451156036, 465.74601476324233, 336.5146358565871, 191.02252564616083, 363.2934649484936, 222.80466684758244, 520.3388965026285, 515.2812575878247, 383.44006498939723, 327.05910657788473, 349.2923503703967, 303.8206848287452, 443.0844004095738, 442.9000556993281, 259.9369685366362, 343.5870084614539, 329.5185227856401, 354.33799326775573, 426.526073763427, 368.53761736309724, 460.83026753002827, 289.2264488692652, 182.41340191579252, 376.8920545921695, 470.9069838261663, 325.4708886702469, 525.5642496075307, 120.23007680218612, 276.06789331048793, 374.18645835905284, 433.70352748746564, 243.42326768696304, 474.76757926641517, 284.7655297267555, 313.68027934546626, 255.95248324899637, 417.4969209607522, 502.17397086729, 354.7267183196013, 288.0540676057517, 547.3529045313818, 478.3140450006374, 274.5326499932346, 540.2668938380432, 398.2945736868366, 480.4234927053469, 457.45223691570976, 318.66580314944014, 348.4326970040644, 303.63768892511774, 303.0508541591135, 276.88829003289936, 328.48037584950083, 623.0756266037155, 309.11763938508903, 478.5046763194659, 408.58681777870726, 28.67442536054573, 416.71205235711284, 172.09574415303496, 225.15726263638456, 494.69353946551377, 265.00486491335647, 146.00226298768968, 372.786623957317, 401.84391573147997, 317.45339699801775, 566.6387343345685, 584.7600275236041, 388.4527659292266, 242.74308804240488, 486.42051778732866, 395.0273980287415, 151.4309365769671, 155.0109278584312, 402.30890377180486, 95.57708045868127, 342.3958447551648, 117.84176396704399, 256.2767529102941, 172.20883447031062, 386.5882855206157, 364.9255368221716, 323.35528756709795, 206.61385101809503, 423.94925708588215, 285.11872703835326, 570.4772612525555, 217.32979151534352, 247.25928399825798, 242.20111542401074, 367.9941120345683, 226.8005574039784, 652.2917053260021, 106.94886645069607, 422.6009884377222, 437.1419840445059, 253.53317550986597, 295.2527193917184, 509.16760828038855, 346.7715793619885, 367.33269204082285, 170.40531054134792, 206.70364009872526, 462.6275148632978, 281.66432773903307, 311.4506239225609, 271.0581311345743, 310.2329305847283, 437.8710737128325, 200.66251201100363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.764537395138076, "mean_inference_ms": 6.412676408088661, "mean_action_processing_ms": 2.705805205598166, "mean_env_wait_ms": 16.456785720077786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013084173202514648, "StateBufferConnector_ms": 0.007899761199951172, "ViewRequirementAgentConnector_ms": 0.16820263862609863}, "num_episodes": 18, "episode_return_max": 636.0323604808955, "episode_return_min": -0.0727247380489966, "episode_return_mean": 200.18610509573827, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 940000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.26297558439947, "num_env_steps_trained_throughput_per_sec": 67.26297558439947, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 940000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 940000, "timers": {"training_iteration_time_ms": 63263.242, "restore_workers_time_ms": 0.016, "training_step_time_ms": 63263.191, "sample_time_ms": 2890.796, "learn_time_ms": 60352.899, "learn_throughput": 66.277, "synch_weights_time_ms": 15.211}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 940000}, "done": false, "training_iteration": 47, "trial_id": "62684_00000", "date": "2024-08-20_17-05-07", "timestamp": 1724153707, "time_this_iter_s": 59.507123947143555, "time_total_s": 3437.3778364658356, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffb8310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3437.3778364658356, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 24.772941176470585, "ram_util_percent": 78.01058823529408}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.494411612909737, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.2360967889745185, "policy_loss": -0.018734375038349352, "vf_loss": 7.251732026938851, "vf_explained_var": 0.5183397361572752, "kl": 0.015495630903400693, "entropy": 1.0401699094907613, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 133950.5, "diff_num_grad_updates_vs_sampler_policy": 1448.2749999999942}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.352413500238347, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.067322662141589, "policy_loss": -0.02827339559059255, "vf_loss": 8.092561733659613, "vf_explained_var": 0.1694411920176612, "kl": 0.015171506237632856, "entropy": 0.6296278379896961, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 636.0323604808955, "episode_reward_min": 9.369559474523394, "episode_reward_mean": 194.62303695814757, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -719.1012876163554, "predator_policy": 13.361104608342602}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 720.1012876163554}, "policy_reward_mean": {"prey_policy": -162.8255939441203, "predator_policy": 341.54990939525436}, "custom_metrics": {}, "hist_stats": {"episode_reward": [450.62355213632674, 474.6962007285937, 181.96942803820644, 166.60379235948614, 286.8379205368637, 109.35411885576448, 250.71165110838993, 199.80165346011913, 85.91655097940905, 187.82550100832196, 286.73094544505057, 102.40732339213818, 149.74690184895306, 185.65487738351882, 30.30596250390965, 255.21152442264386, 9.369559474523394, 174.3046288666608, 94.24970221331859, 286.44007167141365, 180.78378216583906, 128.759625105136, 161.37680098666917, 293.67542781044654, 124.21967884899873, 330.3513639438809, 32.97233260066624, 80.72417560145833, 114.8647264708299, 191.560671756615, 196.43391425310176, 153.43688897012981, 191.15656354686365, 175.74638247635798, 279.8910235501768, 189.8759251525088, 53.45847141523901, 173.25171865996109, 137.15857397702223, 114.24237361764006, 334.4676362039516, 198.61014303559668, 144.273947953335, 225.40381391655947, 456.22174654227535, 237.913814084225, 33.58430795520932, 232.3393646799271, 408.0957885158421, 135.70726238502797, 181.65053442369228, 194.26713779520534, 29.081960227046, 196.10954984228727, 229.9298655536251, 165.36941085881742, 139.55164769814473, 188.65431109623688, 89.02497150083062, 349.19176653477996, 95.23159497660129, 216.9081700282423, 411.86664530302664, 46.24591597545962, 109.81612386796832, 199.2612645166379, 86.81467172519416, 159.79393063301686, 169.49495723139555, 308.53403790895254, 429.3471801485321, 249.32486465944683, 337.6588716432942, 138.61195522772064, 255.79589566513482, 142.3999999999998, 59.151416404828666, 372.7827785836509, 114.7867774241404, 381.8995198299119, 77.03597579384065, 225.52966901025212, 636.0323604808955, 224.50027044078072, 321.3940100152448, 267.81441263999676, 155.0945889598251, 80.12917130663158, 49.15779316353378, 17.680248026253658, 304.0330704238169, 142.30944297219065, 103.85586881071156, 107.28707805184365, 364.6350165174945, 207.51289448429182, 140.9998862740044, 159.68616781647182, 134.836250093034, 14.90168063472042], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-315.6000510060753, 152.73312868504988, 11.485000343299422, -1.0556525527167646, -263.5794469219125, 192.1956941270084, 134.11279642033824, -406.52511342205486, -213.17772505689464, -544.7202757941486, 83.49347812182494, -104.95626026684491, -104.11010068132164, 122.97385727310838, -232.3784173120069, -126.51524422162515, 54.634412287966455, -144.2393667972907, -365.02037635794375, 56.8956175263279, -55.242501663594176, -505.72380232803886, 130.11477772756527, -113.68112075844309, 7.29016374959658, -228.8672568526456, -400.31121477068785, 125.85826335221655, -487.2577018058639, -379.32158092792815, -104.26681023475932, -32.185025746835166, -294.02618821226, -148.66150831888717, -57.24984368484952, -220.62214516801723, 64.70476269821143, -407.87508502816695, -12.538076251404783, -53.26587162115177, -341.99167372165624, -15.829551014446345, 30.799999999999997, -386.0624986035971, -294.1318321919187, 139.37066243281902, -329.4981438812363, -656.2862457367976, -210.4449864514639, -342.5841435531567, -18.72158380164054, 62.37480573398332, -360.5600188364833, -331.3167582369781, -387.10598470392415, 0.7567820894587935, -291.8657017888331, -436.21820473258265, 175.4647544847302, -261.2963435708178, -24.041658605638943, -258.681970762993, -277.0564926718684, -228.03602070983825, -69.8269737017474, 41.67993606454656, -155.48289177876063, 141.98186950034534, -398.97791448509446, 26.80864447598992, -243.0338312037325, -29.673480482500455, -21.387303790231158, -94.37717378363563, -295.11482563875245, -78.95334209846014, 182.9073051169447, -304.65808259917884, -271.5971967648743, -602.6149476748559, -165.54082762340732, 14.850007167766998, -21.332214525927462, -521.0741991732841, -571.6376821440615, 111.3119216108838, -429.5374262506128, -221.2463716117463, -343.31414511560314, 159.4185741390867, -330.7760015199514, 195.98915540393986, -471.0398902507157, -244.71689591150889, -158.1970699799859, 2.0348642669702315, 8.427742758183223, -46.548956037507715, -513.8657865240218, 142.00853532874328, -485.04341044020975, -379.94006498939643, -349.70665280286926, -34.37619956514693, -12.377581030088118, -110.77590083455775, -466.2532592512512, 20.000000000000014, -472.76511878820793, -104.40798648552368, -72.20544754699424, 48.884788953497605, -264.87638648067673, -283.8622150599515, -537.9947212602923, -111.36097382645528, 5.65020203258759, -83.11257810453407, -163.9649116593722, -468.0480215115801, -58.81408311376755, 168.42311448327004, -246.78124595060837, 172.8811239059171, -394.2376307790001, -427.83238850965506, -194.42620445372626, -480.7766802377145, -31.558305633002057, -15.757792339421101, -181.85926369584877, 26.722899839155335, 96.08158392718062, -38.74392019257118, -409.0059030388528, -169.9962121222884, -474.3675792664151, 164.0867585195504, -38.97945019030969, -407.5153625477908, -118.36668837891298, 158.50623280642148, -414.89692096075163, -184.7193513754906, 22.578655270740356, -596.0113850869343, 124.62782914514207, -461.2394869636842, -127.61845602051451, -110.84176676790615, -468.10752366904995, -131.53110786001642, 28.442470958887643, -293.65902548996894, 75.8315895983375, -526.4668938380426, -272.6466149645903, -208.94574963454792, -427.20140479487196, -284.56621135734173, -344.632697004064, 158.20995805018876, -214.58317169401803, -98.37369541969531, -63.80181041689208, -249.03394373746787, -216.57820194371655, 25.61289065760141, -90.98826865838372, -112.75095756297493, -588.9023920693007, -184.2724350245618, 43.53955534217032, -557.7043033195451, 43.98725545823097, 13.563290682055289, -413.91205235711277, -115.26385932111225, 75.79999999999998, -8.59738093352743, 89.55009110042593, -503.8006963646138, -250.21620413808145, -127.43485799851365, 76.52741899362154, -250.97327791187263, 126.12305237718617, -418.5820352166644, -14.971684586994586, -163.0082921932736, -625.1018591409902, -317.04269454844814, -240.96722670625704, -71.56489920567775, -208.84760419172832, -462.5350586737408, -97.04775834605513, -122.60383427963578, -18.66599762354246, -86.5446479867726, -114.4165470998892, -400.008903771805, -21.428524323688894, 83.34537449802544, 115.24321242719421, -40.79954980078856, -365.186314117217, -171.0255405201382, 50.18158693076043, 0.8924041177213096, -116.9372839294758, -380.4190814928898, 175.1897232281098, -94.76613593959853, -294.6104900381702, 108.73235205202293, -449.7171993080354, 189.2, -110.89191317290675, -46.29156002793539, -66.27296707728753, -536.6305704349558, 137.16182054032126, -171.23899825848997, -199.58732603896496, -212.09532283401245, 121.69476543003394, -361.9941120345669, -55.68204907485528, -650.8014830594802, 6.394376762465605, -559.1006401511415, 22.440446252562502, 49.699999999999974, -154.96943966198063, -171.12678678827382, -107.90289102718953, -190.7857719686354, -430.3370945111956, 147.0831986673652, -128.01092220182701, -362.6326920408227, 29.941587454319357, 104.4047120850109, -496.08055003266907, -52.125648004112215, 191.9, -343.5825911806992, 194.6, -242.26487174116826, 200.0, -314.5259195373536, -18.61656230440951, -34.43691529562369, -264.08609810855637, -550.9076885760913, 6.0963196208154615, 76.69999999999997, -288.2660513566386, -233.10475055334658, -50.51300782820707, 39.76107519101239, -134.7233787950565, -719.1012876163554, -259.6862489785657, -6.221271545495124, -72.2332566053403, -332.3982477393093, -85.35855980423365, -207.9443091337911, -198.19359619540518, 65.45943150905555, -370.08560039892194, -419.2887223514111, -463.95111011093553, 20.000000000000014, -210.36819020859144, -155.54845848621133, -213.1846693676274, -504.6017842614555, 17.275666248744237, 76.65030719475769, -438.77611137249755, 82.96328909621869, -163.12798883679207, -315.8730643113105, 192.59566353141875, -311.9449823566217, 148.67207682559825, -256.1059545024151, -437.94483235005106, -337.21138347344686, -254.34605548066858, 86.993078901772, -213.84367761674682, 46.016116523516786, -176.33479287164724, -1.6551778163383588, -302.1847434136273, -339.78397663168676], "policy_predator_policy_reward": [262.10585184930113, 339.8996222647506, 286.24431083238017, 260.89129524383446, 400.6588768811184, 266.9005932157006, 180.37166954080413, 552.4151807578515, 334.97385410806856, 165.37872714901525, 16.928089540234676, 308.5462280464787, 293.9108895332715, 320.16802207032833, 506.12380232803895, 182.96799649099688, 303.78152168396053, 404.02333716918554, 421.9272095414193, 506.6193108484795, 460.4039144361634, 256.805055202741, 236.21977018566068, 292.7210503782312, 124.85441922029409, 380.60088121002065, 251.55854011176683, 345.18343362900697, 381.4311392326898, 298.26915406673726, 492.9420577424746, 608.6831938653854, 364.94806148709574, 216.17221179368875, 368.8506860890806, 434.9559141170588, 381.82631863088113, 390.6382879857375, 365.40062267670777, 443.08924281337727, 243.34429743915044, 497.21960676719027, 206.5927476602822, 178.3499357918921, 171.28289177876042, 402.5728459714196, 378.17097554144317, 161.4031194792451, 314.2791742263578, 220.8198078352605, 182.67038849196916, 348.3850950326081, 448.59859637801856, 624.1267082857847, 522.9741991732845, 85.306382959619, 430.590231110559, 574.1376821440621, 248.38846922927468, 348.3141451156036, 465.74601476324233, 336.5146358565871, 191.02252564616083, 363.2934649484936, 222.80466684758244, 520.3388965026285, 515.2812575878247, 383.44006498939723, 327.05910657788473, 349.2923503703967, 303.8206848287452, 443.0844004095738, 442.9000556993281, 259.9369685366362, 343.5870084614539, 329.5185227856401, 354.33799326775573, 426.526073763427, 368.53761736309724, 460.83026753002827, 289.2264488692652, 182.41340191579252, 376.8920545921695, 470.9069838261663, 325.4708886702469, 525.5642496075307, 120.23007680218612, 276.06789331048793, 374.18645835905284, 433.70352748746564, 243.42326768696304, 474.76757926641517, 284.7655297267555, 313.68027934546626, 255.95248324899637, 417.4969209607522, 502.17397086729, 354.7267183196013, 288.0540676057517, 547.3529045313818, 478.3140450006374, 274.5326499932346, 540.2668938380432, 398.2945736868366, 480.4234927053469, 457.45223691570976, 318.66580314944014, 348.4326970040644, 303.63768892511774, 303.0508541591135, 276.88829003289936, 328.48037584950083, 623.0756266037155, 309.11763938508903, 478.5046763194659, 408.58681777870726, 28.67442536054573, 416.71205235711284, 172.09574415303496, 225.15726263638456, 494.69353946551377, 265.00486491335647, 146.00226298768968, 372.786623957317, 401.84391573147997, 317.45339699801775, 566.6387343345685, 584.7600275236041, 388.4527659292266, 242.74308804240488, 486.42051778732866, 395.0273980287415, 151.4309365769671, 155.0109278584312, 402.30890377180486, 95.57708045868127, 342.3958447551648, 117.84176396704399, 256.2767529102941, 172.20883447031062, 386.5882855206157, 364.9255368221716, 323.35528756709795, 206.61385101809503, 423.94925708588215, 285.11872703835326, 570.4772612525555, 217.32979151534352, 247.25928399825798, 242.20111542401074, 367.9941120345683, 226.8005574039784, 652.2917053260021, 106.94886645069607, 422.6009884377222, 437.1419840445059, 253.53317550986597, 295.2527193917184, 509.16760828038855, 346.7715793619885, 367.33269204082285, 170.40531054134792, 206.70364009872526, 462.6275148632978, 281.66432773903307, 311.4506239225609, 271.0581311345743, 310.2329305847283, 437.8710737128325, 200.66251201100363, 366.86983291436695, 369.0559486809063, 409.0123473413786, 317.966051356639, 720.1012876163554, 174.09147491067682, 286.95272385747177, 100.34584643546246, 412.90896467526863, 230.47240002832032, 392.2530055702551, 414.599829938833, 465.65106237449004, 539.8982130600485, 253.4159334892534, 429.5412533838877, 504.6017842614555, 13.361104608342602, 492.2420767208387, 391.3337509097256, 317.74498235662304, 324.99029526418514, 385.30715889531916, 301.0714374055539, 393.47800277335216, 270.77252509546275, 234.84367761674656, 244.15492644116526, 314.54160186468675, 343.9839766316875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.710101230563104, "mean_inference_ms": 6.370890422506068, "mean_action_processing_ms": 2.67189472252781, "mean_env_wait_ms": 16.37815195105264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013149857521057129, "StateBufferConnector_ms": 0.004908084869384766, "ViewRequirementAgentConnector_ms": 0.1702653169631958}, "num_episodes": 15, "episode_return_max": 636.0323604808955, "episode_return_min": 9.369559474523394, "episode_return_mean": 194.62303695814757, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.53446892454122, "num_env_steps_trained_throughput_per_sec": 67.53446892454122, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 62258.86, "restore_workers_time_ms": 0.015, "training_step_time_ms": 62258.81, "sample_time_ms": 2694.425, "learn_time_ms": 59545.841, "learn_throughput": 67.175, "synch_weights_time_ms": 14.646}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 48, "trial_id": "62684_00000", "date": "2024-08-20_17-06-06", "timestamp": 1724153766, "time_this_iter_s": 59.27859401702881, "time_total_s": 3496.6564304828644, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffb88b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3496.6564304828644, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 24.73975903614458, "ram_util_percent": 77.81204819277109}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.07483840783437, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.252050378643874, "policy_loss": -0.0176250795173254, "vf_loss": 7.266908307785683, "vf_explained_var": 0.5377991434107435, "kl": 0.013835775797711091, "entropy": 1.0082862383930395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 136770.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.35338271004813, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.582730591738665, "policy_loss": -0.023849817985519717, "vf_loss": 8.60406786348454, "vf_explained_var": -0.037076782612573536, "kl": 0.012562943808980799, "entropy": 0.5941832620157766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 980000}, "env_runners": {"episode_reward_max": 636.0323604808955, "episode_reward_min": 14.90168063472042, "episode_reward_mean": 201.7128121103591, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -719.1012876163554, "predator_policy": 13.361104608342602}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 720.1012876163554}, "policy_reward_mean": {"prey_policy": -160.10613368893723, "predator_policy": 341.0156065885855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [286.44007167141365, 180.78378216583906, 128.759625105136, 161.37680098666917, 293.67542781044654, 124.21967884899873, 330.3513639438809, 32.97233260066624, 80.72417560145833, 114.8647264708299, 191.560671756615, 196.43391425310176, 153.43688897012981, 191.15656354686365, 175.74638247635798, 279.8910235501768, 189.8759251525088, 53.45847141523901, 173.25171865996109, 137.15857397702223, 114.24237361764006, 334.4676362039516, 198.61014303559668, 144.273947953335, 225.40381391655947, 456.22174654227535, 237.913814084225, 33.58430795520932, 232.3393646799271, 408.0957885158421, 135.70726238502797, 181.65053442369228, 194.26713779520534, 29.081960227046, 196.10954984228727, 229.9298655536251, 165.36941085881742, 139.55164769814473, 188.65431109623688, 89.02497150083062, 349.19176653477996, 95.23159497660129, 216.9081700282423, 411.86664530302664, 46.24591597545962, 109.81612386796832, 199.2612645166379, 86.81467172519416, 159.79393063301686, 169.49495723139555, 308.53403790895254, 429.3471801485321, 249.32486465944683, 337.6588716432942, 138.61195522772064, 255.79589566513482, 142.3999999999998, 59.151416404828666, 372.7827785836509, 114.7867774241404, 381.8995198299119, 77.03597579384065, 225.52966901025212, 636.0323604808955, 224.50027044078072, 321.3940100152448, 267.81441263999676, 155.0945889598251, 80.12917130663158, 49.15779316353378, 17.680248026253658, 304.0330704238169, 142.30944297219065, 103.85586881071156, 107.28707805184365, 364.6350165174945, 207.51289448429182, 140.9998862740044, 159.68616781647182, 134.836250093034, 14.90168063472042, 171.64049984063314, 337.71429245818365, 129.24624213866977, 235.3031734162814, 206.5066139602199, 155.37119158133834, 189.84662657249098, 232.20195982486257, 203.62985138412364, 233.78664549432094, 465.07929752712664, 170.48024747299866, 423.08200494342015, 188.51617673093858, 57.705625363244415, 442.2346077591437, 284.55831553637756, 221.42992219534892, 42.96601578362697], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-436.21820473258265, 175.4647544847302, -261.2963435708178, -24.041658605638943, -258.681970762993, -277.0564926718684, -228.03602070983825, -69.8269737017474, 41.67993606454656, -155.48289177876063, 141.98186950034534, -398.97791448509446, 26.80864447598992, -243.0338312037325, -29.673480482500455, -21.387303790231158, -94.37717378363563, -295.11482563875245, -78.95334209846014, 182.9073051169447, -304.65808259917884, -271.5971967648743, -602.6149476748559, -165.54082762340732, 14.850007167766998, -21.332214525927462, -521.0741991732841, -571.6376821440615, 111.3119216108838, -429.5374262506128, -221.2463716117463, -343.31414511560314, 159.4185741390867, -330.7760015199514, 195.98915540393986, -471.0398902507157, -244.71689591150889, -158.1970699799859, 2.0348642669702315, 8.427742758183223, -46.548956037507715, -513.8657865240218, 142.00853532874328, -485.04341044020975, -379.94006498939643, -349.70665280286926, -34.37619956514693, -12.377581030088118, -110.77590083455775, -466.2532592512512, 20.000000000000014, -472.76511878820793, -104.40798648552368, -72.20544754699424, 48.884788953497605, -264.87638648067673, -283.8622150599515, -537.9947212602923, -111.36097382645528, 5.65020203258759, -83.11257810453407, -163.9649116593722, -468.0480215115801, -58.81408311376755, 168.42311448327004, -246.78124595060837, 172.8811239059171, -394.2376307790001, -427.83238850965506, -194.42620445372626, -480.7766802377145, -31.558305633002057, -15.757792339421101, -181.85926369584877, 26.722899839155335, 96.08158392718062, -38.74392019257118, -409.0059030388528, -169.9962121222884, -474.3675792664151, 164.0867585195504, -38.97945019030969, -407.5153625477908, -118.36668837891298, 158.50623280642148, -414.89692096075163, -184.7193513754906, 22.578655270740356, -596.0113850869343, 124.62782914514207, -461.2394869636842, -127.61845602051451, -110.84176676790615, -468.10752366904995, -131.53110786001642, 28.442470958887643, -293.65902548996894, 75.8315895983375, -526.4668938380426, -272.6466149645903, -208.94574963454792, -427.20140479487196, -284.56621135734173, -344.632697004064, 158.20995805018876, -214.58317169401803, -98.37369541969531, -63.80181041689208, -249.03394373746787, -216.57820194371655, 25.61289065760141, -90.98826865838372, -112.75095756297493, -588.9023920693007, -184.2724350245618, 43.53955534217032, -557.7043033195451, 43.98725545823097, 13.563290682055289, -413.91205235711277, -115.26385932111225, 75.79999999999998, -8.59738093352743, 89.55009110042593, -503.8006963646138, -250.21620413808145, -127.43485799851365, 76.52741899362154, -250.97327791187263, 126.12305237718617, -418.5820352166644, -14.971684586994586, -163.0082921932736, -625.1018591409902, -317.04269454844814, -240.96722670625704, -71.56489920567775, -208.84760419172832, -462.5350586737408, -97.04775834605513, -122.60383427963578, -18.66599762354246, -86.5446479867726, -114.4165470998892, -400.008903771805, -21.428524323688894, 83.34537449802544, 115.24321242719421, -40.79954980078856, -365.186314117217, -171.0255405201382, 50.18158693076043, 0.8924041177213096, -116.9372839294758, -380.4190814928898, 175.1897232281098, -94.76613593959853, -294.6104900381702, 108.73235205202293, -449.7171993080354, 189.2, -110.89191317290675, -46.29156002793539, -66.27296707728753, -536.6305704349558, 137.16182054032126, -171.23899825848997, -199.58732603896496, -212.09532283401245, 121.69476543003394, -361.9941120345669, -55.68204907485528, -650.8014830594802, 6.394376762465605, -559.1006401511415, 22.440446252562502, 49.699999999999974, -154.96943966198063, -171.12678678827382, -107.90289102718953, -190.7857719686354, -430.3370945111956, 147.0831986673652, -128.01092220182701, -362.6326920408227, 29.941587454319357, 104.4047120850109, -496.08055003266907, -52.125648004112215, 191.9, -343.5825911806992, 194.6, -242.26487174116826, 200.0, -314.5259195373536, -18.61656230440951, -34.43691529562369, -264.08609810855637, -550.9076885760913, 6.0963196208154615, 76.69999999999997, -288.2660513566386, -233.10475055334658, -50.51300782820707, 39.76107519101239, -134.7233787950565, -719.1012876163554, -259.6862489785657, -6.221271545495124, -72.2332566053403, -332.3982477393093, -85.35855980423365, -207.9443091337911, -198.19359619540518, 65.45943150905555, -370.08560039892194, -419.2887223514111, -463.95111011093553, 20.000000000000014, -210.36819020859144, -155.54845848621133, -213.1846693676274, -504.6017842614555, 17.275666248744237, 76.65030719475769, -438.77611137249755, 82.96328909621869, -163.12798883679207, -315.8730643113105, 192.59566353141875, -311.9449823566217, 148.67207682559825, -256.1059545024151, -437.94483235005106, -337.21138347344686, -254.34605548066858, 86.993078901772, -213.84367761674682, 46.016116523516786, -176.33479287164724, -1.6551778163383588, -302.1847434136273, -339.78397663168676, -375.25369237857234, 100.65003181402656, -291.0805432068379, -259.41001064028137, 90.62547818922377, -14.730629653143296, -592.351468503145, 22.21839616037881, -80.1433279386415, 19.410356642510017, -402.5762578403113, 92.1061371892593, -225.56916351171554, 184.77742541715347, -284.88611881634336, -162.3091689615944, -112.80494087478831, -81.90491390492635, -139.59243222609103, -235.84341484608993, 51.32451598219523, 35.79999999999996, -329.7328527065415, 136.39684016113517, -324.2255456366198, 175.0925361729279, -279.5749508491995, -536.6030088188189, -200.21652117303262, 155.01260364043404, -443.31702601891715, 194.1474450634856, -66.43376857135546, -140.1777155173587, -56.532058406968105, -271.69685335763717, 20.80571604399788, 138.80530232588887, -534.8270294526869, -219.98315969777957, -530.3148591669014, -159.60924185847642, -123.66291279871703, -137.2550592775292, 18.005625363244068, -463.3052265039162, 49.69999999999997, -105.06071243897918, -231.43140586459057, 177.7062617973236, -117.78492551848483, -320.1615157502878, -219.27721017514025, 128.89999999999998, -472.34127650801724, -105.04147988075528, -248.20287987479736], "policy_predator_policy_reward": [365.40062267670777, 443.08924281337727, 243.34429743915044, 497.21960676719027, 206.5927476602822, 178.3499357918921, 171.28289177876042, 402.5728459714196, 378.17097554144317, 161.4031194792451, 314.2791742263578, 220.8198078352605, 182.67038849196916, 348.3850950326081, 448.59859637801856, 624.1267082857847, 522.9741991732845, 85.306382959619, 430.590231110559, 574.1376821440621, 248.38846922927468, 348.3141451156036, 465.74601476324233, 336.5146358565871, 191.02252564616083, 363.2934649484936, 222.80466684758244, 520.3388965026285, 515.2812575878247, 383.44006498939723, 327.05910657788473, 349.2923503703967, 303.8206848287452, 443.0844004095738, 442.9000556993281, 259.9369685366362, 343.5870084614539, 329.5185227856401, 354.33799326775573, 426.526073763427, 368.53761736309724, 460.83026753002827, 289.2264488692652, 182.41340191579252, 376.8920545921695, 470.9069838261663, 325.4708886702469, 525.5642496075307, 120.23007680218612, 276.06789331048793, 374.18645835905284, 433.70352748746564, 243.42326768696304, 474.76757926641517, 284.7655297267555, 313.68027934546626, 255.95248324899637, 417.4969209607522, 502.17397086729, 354.7267183196013, 288.0540676057517, 547.3529045313818, 478.3140450006374, 274.5326499932346, 540.2668938380432, 398.2945736868366, 480.4234927053469, 457.45223691570976, 318.66580314944014, 348.4326970040644, 303.63768892511774, 303.0508541591135, 276.88829003289936, 328.48037584950083, 623.0756266037155, 309.11763938508903, 478.5046763194659, 408.58681777870726, 28.67442536054573, 416.71205235711284, 172.09574415303496, 225.15726263638456, 494.69353946551377, 265.00486491335647, 146.00226298768968, 372.786623957317, 401.84391573147997, 317.45339699801775, 566.6387343345685, 584.7600275236041, 388.4527659292266, 242.74308804240488, 486.42051778732866, 395.0273980287415, 151.4309365769671, 155.0109278584312, 402.30890377180486, 95.57708045868127, 342.3958447551648, 117.84176396704399, 256.2767529102941, 172.20883447031062, 386.5882855206157, 364.9255368221716, 323.35528756709795, 206.61385101809503, 423.94925708588215, 285.11872703835326, 570.4772612525555, 217.32979151534352, 247.25928399825798, 242.20111542401074, 367.9941120345683, 226.8005574039784, 652.2917053260021, 106.94886645069607, 422.6009884377222, 437.1419840445059, 253.53317550986597, 295.2527193917184, 509.16760828038855, 346.7715793619885, 367.33269204082285, 170.40531054134792, 206.70364009872526, 462.6275148632978, 281.66432773903307, 311.4506239225609, 271.0581311345743, 310.2329305847283, 437.8710737128325, 200.66251201100363, 366.86983291436695, 369.0559486809063, 409.0123473413786, 317.966051356639, 720.1012876163554, 174.09147491067682, 286.95272385747177, 100.34584643546246, 412.90896467526863, 230.47240002832032, 392.2530055702551, 414.599829938833, 465.65106237449004, 539.8982130600485, 253.4159334892534, 429.5412533838877, 504.6017842614555, 13.361104608342602, 492.2420767208387, 391.3337509097256, 317.74498235662304, 324.99029526418514, 385.30715889531916, 301.0714374055539, 393.47800277335216, 270.77252509546275, 234.84367761674656, 244.15492644116526, 314.54160186468675, 343.9839766316875, 402.0491950218169, 335.2755085902005, 189.66663125884156, 331.5628233035428, 212.29648804193772, 567.226154378139, 331.66370947086205, 194.6992279539623, 211.85936455839297, 320.32510631273243, 227.55614423960816, 284.83407108303936, 152.15752483991548, 361.80043282256156, 288.3884371812057, 101.34953518906421, 349.15686443748285, 283.18094725953364, 347.41195208193983, 468.181619763799, 349.4881176682076, 431.1945293857041, 279.33027219318825, 359.5566025617746, 497.29668791737896, 301.0013281088413, 541.9018362776159, 556.5216011764802, 163.6550592775286, 136.9629127987164, 544.8689817432728, 416.0315649587651, 232.12887767522614, 223.9395074469025, 235.68699546601715, 396.2816526547599, 570.8409411986029, 297.710710848594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.630200224111317, "mean_inference_ms": 6.318256130921071, "mean_action_processing_ms": 2.6431552683109705, "mean_env_wait_ms": 16.228547497712203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013860106468200684, "StateBufferConnector_ms": 0.01037895679473877, "ViewRequirementAgentConnector_ms": 0.18017828464508057}, "num_episodes": 19, "episode_return_max": 636.0323604808955, "episode_return_min": 14.90168063472042, "episode_return_mean": 201.7128121103591, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 980000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.11926184756838, "num_env_steps_trained_throughput_per_sec": 67.11926184756838, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 980000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 980000, "timers": {"training_iteration_time_ms": 61398.422, "restore_workers_time_ms": 0.013, "training_step_time_ms": 61398.376, "sample_time_ms": 2413.788, "learn_time_ms": 58967.9, "learn_throughput": 67.834, "synch_weights_time_ms": 13.941}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 980000}, "done": false, "training_iteration": 49, "trial_id": "62684_00000", "date": "2024-08-20_17-07-06", "timestamp": 1724153826, "time_this_iter_s": 59.64047384262085, "time_total_s": 3556.2969043254852, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3acade9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3556.2969043254852, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 24.485714285714288, "ram_util_percent": 78.04285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.751497084282814, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.393161142295134, "policy_loss": -0.01825377916131195, "vf_loss": 7.408921869426754, "vf_explained_var": 0.4993494366711759, "kl": 0.01246523538964358, "entropy": 0.9462669402995008, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 139590.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.28349872266174, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.759986341062676, "policy_loss": -0.022102313225955836, "vf_loss": 8.779557930224787, "vf_explained_var": -0.13125622534247303, "kl": 0.01265364840944549, "entropy": 0.5527982681989669, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "env_runners": {"episode_reward_max": 636.0323604808955, "episode_reward_min": -53.61800590458047, "episode_reward_mean": 206.49531313530917, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -719.1012876163554, "predator_policy": 13.361104608342602}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 720.1012876163554}, "policy_reward_mean": {"prey_policy": -162.1210872659739, "predator_policy": 346.42928746661534}, "custom_metrics": {}, "hist_stats": {"episode_reward": [456.22174654227535, 237.913814084225, 33.58430795520932, 232.3393646799271, 408.0957885158421, 135.70726238502797, 181.65053442369228, 194.26713779520534, 29.081960227046, 196.10954984228727, 229.9298655536251, 165.36941085881742, 139.55164769814473, 188.65431109623688, 89.02497150083062, 349.19176653477996, 95.23159497660129, 216.9081700282423, 411.86664530302664, 46.24591597545962, 109.81612386796832, 199.2612645166379, 86.81467172519416, 159.79393063301686, 169.49495723139555, 308.53403790895254, 429.3471801485321, 249.32486465944683, 337.6588716432942, 138.61195522772064, 255.79589566513482, 142.3999999999998, 59.151416404828666, 372.7827785836509, 114.7867774241404, 381.8995198299119, 77.03597579384065, 225.52966901025212, 636.0323604808955, 224.50027044078072, 321.3940100152448, 267.81441263999676, 155.0945889598251, 80.12917130663158, 49.15779316353378, 17.680248026253658, 304.0330704238169, 142.30944297219065, 103.85586881071156, 107.28707805184365, 364.6350165174945, 207.51289448429182, 140.9998862740044, 159.68616781647182, 134.836250093034, 14.90168063472042, 171.64049984063314, 337.71429245818365, 129.24624213866977, 235.3031734162814, 206.5066139602199, 155.37119158133834, 189.84662657249098, 232.20195982486257, 203.62985138412364, 233.78664549432094, 465.07929752712664, 170.48024747299866, 423.08200494342015, 188.51617673093858, 57.705625363244415, 442.2346077591437, 284.55831553637756, 221.42992219534892, 42.96601578362697, 101.18170504326554, 205.86019436791963, 91.33756606053859, 159.72640835371834, 467.0043190338292, 321.9411310191968, 68.81110306333497, 247.07787027993876, 476.3137201399906, 140.90807667267273, 326.79062824481935, 132.11265016137386, -22.231542425771295, 191.83290467975985, 323.25773962823087, 256.4656518669597, 102.17703816387069, 354.075580939375, -53.61800590458047, 191.5546532218238, 142.26097845384203, 293.09348106789446, 222.77600669186612, 174.57216381220417, 56.10411354933076], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [96.08158392718062, -38.74392019257118, -409.0059030388528, -169.9962121222884, -474.3675792664151, 164.0867585195504, -38.97945019030969, -407.5153625477908, -118.36668837891298, 158.50623280642148, -414.89692096075163, -184.7193513754906, 22.578655270740356, -596.0113850869343, 124.62782914514207, -461.2394869636842, -127.61845602051451, -110.84176676790615, -468.10752366904995, -131.53110786001642, 28.442470958887643, -293.65902548996894, 75.8315895983375, -526.4668938380426, -272.6466149645903, -208.94574963454792, -427.20140479487196, -284.56621135734173, -344.632697004064, 158.20995805018876, -214.58317169401803, -98.37369541969531, -63.80181041689208, -249.03394373746787, -216.57820194371655, 25.61289065760141, -90.98826865838372, -112.75095756297493, -588.9023920693007, -184.2724350245618, 43.53955534217032, -557.7043033195451, 43.98725545823097, 13.563290682055289, -413.91205235711277, -115.26385932111225, 75.79999999999998, -8.59738093352743, 89.55009110042593, -503.8006963646138, -250.21620413808145, -127.43485799851365, 76.52741899362154, -250.97327791187263, 126.12305237718617, -418.5820352166644, -14.971684586994586, -163.0082921932736, -625.1018591409902, -317.04269454844814, -240.96722670625704, -71.56489920567775, -208.84760419172832, -462.5350586737408, -97.04775834605513, -122.60383427963578, -18.66599762354246, -86.5446479867726, -114.4165470998892, -400.008903771805, -21.428524323688894, 83.34537449802544, 115.24321242719421, -40.79954980078856, -365.186314117217, -171.0255405201382, 50.18158693076043, 0.8924041177213096, -116.9372839294758, -380.4190814928898, 175.1897232281098, -94.76613593959853, -294.6104900381702, 108.73235205202293, -449.7171993080354, 189.2, -110.89191317290675, -46.29156002793539, -66.27296707728753, -536.6305704349558, 137.16182054032126, -171.23899825848997, -199.58732603896496, -212.09532283401245, 121.69476543003394, -361.9941120345669, -55.68204907485528, -650.8014830594802, 6.394376762465605, -559.1006401511415, 22.440446252562502, 49.699999999999974, -154.96943966198063, -171.12678678827382, -107.90289102718953, -190.7857719686354, -430.3370945111956, 147.0831986673652, -128.01092220182701, -362.6326920408227, 29.941587454319357, 104.4047120850109, -496.08055003266907, -52.125648004112215, 191.9, -343.5825911806992, 194.6, -242.26487174116826, 200.0, -314.5259195373536, -18.61656230440951, -34.43691529562369, -264.08609810855637, -550.9076885760913, 6.0963196208154615, 76.69999999999997, -288.2660513566386, -233.10475055334658, -50.51300782820707, 39.76107519101239, -134.7233787950565, -719.1012876163554, -259.6862489785657, -6.221271545495124, -72.2332566053403, -332.3982477393093, -85.35855980423365, -207.9443091337911, -198.19359619540518, 65.45943150905555, -370.08560039892194, -419.2887223514111, -463.95111011093553, 20.000000000000014, -210.36819020859144, -155.54845848621133, -213.1846693676274, -504.6017842614555, 17.275666248744237, 76.65030719475769, -438.77611137249755, 82.96328909621869, -163.12798883679207, -315.8730643113105, 192.59566353141875, -311.9449823566217, 148.67207682559825, -256.1059545024151, -437.94483235005106, -337.21138347344686, -254.34605548066858, 86.993078901772, -213.84367761674682, 46.016116523516786, -176.33479287164724, -1.6551778163383588, -302.1847434136273, -339.78397663168676, -375.25369237857234, 100.65003181402656, -291.0805432068379, -259.41001064028137, 90.62547818922377, -14.730629653143296, -592.351468503145, 22.21839616037881, -80.1433279386415, 19.410356642510017, -402.5762578403113, 92.1061371892593, -225.56916351171554, 184.77742541715347, -284.88611881634336, -162.3091689615944, -112.80494087478831, -81.90491390492635, -139.59243222609103, -235.84341484608993, 51.32451598219523, 35.79999999999996, -329.7328527065415, 136.39684016113517, -324.2255456366198, 175.0925361729279, -279.5749508491995, -536.6030088188189, -200.21652117303262, 155.01260364043404, -443.31702601891715, 194.1474450634856, -66.43376857135546, -140.1777155173587, -56.532058406968105, -271.69685335763717, 20.80571604399788, 138.80530232588887, -534.8270294526869, -219.98315969777957, -530.3148591669014, -159.60924185847642, -123.66291279871703, -137.2550592775292, 18.005625363244068, -463.3052265039162, 49.69999999999997, -105.06071243897918, -231.43140586459057, 177.7062617973236, -117.78492551848483, -320.1615157502878, -219.27721017514025, 128.89999999999998, -472.34127650801724, -105.04147988075528, -248.20287987479736, -237.1570986245277, -192.14088399624652, 20.000000000000014, -214.5590675723423, -139.83353933876606, -203.1232958919695, -266.09386966287263, 6.074721992020173, -219.46362437633937, 4.239360886810649, -265.3265766155296, -362.64396292535747, 127.08554372478292, -527.7456193393313, 111.79999999999971, -45.80772735850021, -502.46023377152665, 5.620677562089529, -290.8217202259608, -193.3375402993057, -33.76004304864766, -196.9501409737288, -480.44134485921575, -15.36779907022183, 116.5408058416091, 176.26426066828012, -374.783406130984, -216.45254208087707, -651.1380063820623, 108.0578944987829, 63.03223304703359, -307.6695091982752, -21.30374643827932, -398.67546618788833, -251.50047652361573, -39.16329979228541, -131.36781000853313, -323.4903893298606, -139.76834651963398, -49.89915955986947, -385.6633727462756, -170.90514395140593, -152.27925481887638, -376.33668765388563, 59.72549178882289, -361.4412715887934, -216.64921608038244, 109.02199699352782, -24.229385797164877, -398.9536684905411, -86.21672364301847, 5.272204392200628, -506.6978019062426, 70.39999999999996, -321.1257347228948, -109.45828304006791, -345.244610663288, -554.3328541327063, 90.80368889326847, -204.89517238900314, -258.51624544147967, -498.5217421141257, -179.3263689816547, 120.46720037538387, -9.351461007954754, -251.77022795646639, -271.9625797655764, 69.68471491532397, -94.57571742887973, -14.485259269727855, -552.6569732475338, -204.58629592478079, -639.149898538995, -198.41561172317455, -66.1087661046707], "policy_predator_policy_reward": [374.18645835905284, 433.70352748746564, 243.42326768696304, 474.76757926641517, 284.7655297267555, 313.68027934546626, 255.95248324899637, 417.4969209607522, 502.17397086729, 354.7267183196013, 288.0540676057517, 547.3529045313818, 478.3140450006374, 274.5326499932346, 540.2668938380432, 398.2945736868366, 480.4234927053469, 457.45223691570976, 318.66580314944014, 348.4326970040644, 303.63768892511774, 303.0508541591135, 276.88829003289936, 328.48037584950083, 623.0756266037155, 309.11763938508903, 478.5046763194659, 408.58681777870726, 28.67442536054573, 416.71205235711284, 172.09574415303496, 225.15726263638456, 494.69353946551377, 265.00486491335647, 146.00226298768968, 372.786623957317, 401.84391573147997, 317.45339699801775, 566.6387343345685, 584.7600275236041, 388.4527659292266, 242.74308804240488, 486.42051778732866, 395.0273980287415, 151.4309365769671, 155.0109278584312, 402.30890377180486, 95.57708045868127, 342.3958447551648, 117.84176396704399, 256.2767529102941, 172.20883447031062, 386.5882855206157, 364.9255368221716, 323.35528756709795, 206.61385101809503, 423.94925708588215, 285.11872703835326, 570.4772612525555, 217.32979151534352, 247.25928399825798, 242.20111542401074, 367.9941120345683, 226.8005574039784, 652.2917053260021, 106.94886645069607, 422.6009884377222, 437.1419840445059, 253.53317550986597, 295.2527193917184, 509.16760828038855, 346.7715793619885, 367.33269204082285, 170.40531054134792, 206.70364009872526, 462.6275148632978, 281.66432773903307, 311.4506239225609, 271.0581311345743, 310.2329305847283, 437.8710737128325, 200.66251201100363, 366.86983291436695, 369.0559486809063, 409.0123473413786, 317.966051356639, 720.1012876163554, 174.09147491067682, 286.95272385747177, 100.34584643546246, 412.90896467526863, 230.47240002832032, 392.2530055702551, 414.599829938833, 465.65106237449004, 539.8982130600485, 253.4159334892534, 429.5412533838877, 504.6017842614555, 13.361104608342602, 492.2420767208387, 391.3337509097256, 317.74498235662304, 324.99029526418514, 385.30715889531916, 301.0714374055539, 393.47800277335216, 270.77252509546275, 234.84367761674656, 244.15492644116526, 314.54160186468675, 343.9839766316875, 402.0491950218169, 335.2755085902005, 189.66663125884156, 331.5628233035428, 212.29648804193772, 567.226154378139, 331.66370947086205, 194.6992279539623, 211.85936455839297, 320.32510631273243, 227.55614423960816, 284.83407108303936, 152.15752483991548, 361.80043282256156, 288.3884371812057, 101.34953518906421, 349.15686443748285, 283.18094725953364, 347.41195208193983, 468.181619763799, 349.4881176682076, 431.1945293857041, 279.33027219318825, 359.5566025617746, 497.29668791737896, 301.0013281088413, 541.9018362776159, 556.5216011764802, 163.6550592775286, 136.9629127987164, 544.8689817432728, 416.0315649587651, 232.12887767522614, 223.9395074469025, 235.68699546601715, 396.2816526547599, 570.8409411986029, 297.710710848594, 122.2944095400369, 388.185278124002, 354.84474380941447, 408.53135336158374, 227.8073805594115, 343.0129575483196, 416.4136240824376, 367.043962925358, 304.07104463812817, 451.7933500102473, 275.4696371755174, 589.1187774116173, 293.9217202259615, 292.8086864112879, 517.6640739831588, 422.17308119994624, 192.35235914761708, 365.9397006134676, 231.28031291295108, 669.1604177238781, 300.6586892926819, 292.0729615416576, 401.7574532496733, 419.69443941549025, 409.12665691262333, 163.26834651963338, 388.96337274627615, 409.3372081910348, 448.5100522733646, 343.6381380388061, 230.6447033047046, 494.8894392379038, 413.7536684905414, 197.82314760405382, 492.43245302317524, 292.6687254302411, 261.34482528555003, 460.8657972361207, 545.0571949942002, 314.92179585606493, 500.2217421141261, 578.4035928769757, 151.34837952214326, 282.3995901347883, 302.3566204461932, 217.27296852480538, 434.51009826875196, 511.7905939854945, 380.6646458287628, 579.1137440874078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.55933195485164, "mean_inference_ms": 6.2440502906513045, "mean_action_processing_ms": 2.6315092474381525, "mean_env_wait_ms": 16.081058347473267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013812661170959473, "StateBufferConnector_ms": 0.010514020919799805, "ViewRequirementAgentConnector_ms": 0.1832728385925293}, "num_episodes": 25, "episode_return_max": 636.0323604808955, "episode_return_min": -53.61800590458047, "episode_return_mean": 206.49531313530917, "episodes_this_iter": 25}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.39938576629451, "num_env_steps_trained_throughput_per_sec": 66.39938576629451, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 1000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1000000, "timers": {"training_iteration_time_ms": 60493.409, "restore_workers_time_ms": 0.013, "training_step_time_ms": 60493.363, "sample_time_ms": 2149.828, "learn_time_ms": 58327.675, "learn_throughput": 68.578, "synch_weights_time_ms": 14.12}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "done": false, "training_iteration": 50, "trial_id": "62684_00000", "date": "2024-08-20_17-08-06", "timestamp": 1724153886, "time_this_iter_s": 60.2795352935791, "time_total_s": 3616.5764396190643, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3acaefc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3616.5764396190643, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 25.87093023255814, "ram_util_percent": 80.06279069767442}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.394254995576034, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.04599622581022, "policy_loss": -0.02157386502297265, "vf_loss": 7.064863923255434, "vf_explained_var": 0.5318382148835676, "kl": 0.01353088025728584, "entropy": 0.9945423711487588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 142410.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.250373436344994, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.272161900051056, "policy_loss": -0.027548011917147845, "vf_loss": 8.297102718504648, "vf_explained_var": -0.06643692948830822, "kl": 0.013035961201108953, "entropy": 0.5859531606158251, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "env_runners": {"episode_reward_max": 636.0323604808955, "episode_reward_min": -53.61800590458047, "episode_reward_mean": 208.42665299888046, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -719.1012876163554, "predator_policy": 13.361104608342602}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 720.1012876163554}, "policy_reward_mean": {"prey_policy": -162.3638333437688, "predator_policy": 347.75907651509345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [349.19176653477996, 95.23159497660129, 216.9081700282423, 411.86664530302664, 46.24591597545962, 109.81612386796832, 199.2612645166379, 86.81467172519416, 159.79393063301686, 169.49495723139555, 308.53403790895254, 429.3471801485321, 249.32486465944683, 337.6588716432942, 138.61195522772064, 255.79589566513482, 142.3999999999998, 59.151416404828666, 372.7827785836509, 114.7867774241404, 381.8995198299119, 77.03597579384065, 225.52966901025212, 636.0323604808955, 224.50027044078072, 321.3940100152448, 267.81441263999676, 155.0945889598251, 80.12917130663158, 49.15779316353378, 17.680248026253658, 304.0330704238169, 142.30944297219065, 103.85586881071156, 107.28707805184365, 364.6350165174945, 207.51289448429182, 140.9998862740044, 159.68616781647182, 134.836250093034, 14.90168063472042, 171.64049984063314, 337.71429245818365, 129.24624213866977, 235.3031734162814, 206.5066139602199, 155.37119158133834, 189.84662657249098, 232.20195982486257, 203.62985138412364, 233.78664549432094, 465.07929752712664, 170.48024747299866, 423.08200494342015, 188.51617673093858, 57.705625363244415, 442.2346077591437, 284.55831553637756, 221.42992219534892, 42.96601578362697, 101.18170504326554, 205.86019436791963, 91.33756606053859, 159.72640835371834, 467.0043190338292, 321.9411310191968, 68.81110306333497, 247.07787027993876, 476.3137201399906, 140.90807667267273, 326.79062824481935, 132.11265016137386, -22.231542425771295, 191.83290467975985, 323.25773962823087, 256.4656518669597, 102.17703816387069, 354.075580939375, -53.61800590458047, 191.5546532218238, 142.26097845384203, 293.09348106789446, 222.77600669186612, 174.57216381220417, 56.10411354933076, 221.90852174165056, 425.08215125529404, 252.70173608443483, 73.7347874043037, 291.485871687561, 100.34422676845446, 173.96119194711818, 420.0829137250211, 148.84912593995816, 187.27235107511916, 18.940264011414968, 214.6178705531004, 132.29999999999976, 353.5876846212582, 95.76696270083193], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-115.26385932111225, 75.79999999999998, -8.59738093352743, 89.55009110042593, -503.8006963646138, -250.21620413808145, -127.43485799851365, 76.52741899362154, -250.97327791187263, 126.12305237718617, -418.5820352166644, -14.971684586994586, -163.0082921932736, -625.1018591409902, -317.04269454844814, -240.96722670625704, -71.56489920567775, -208.84760419172832, -462.5350586737408, -97.04775834605513, -122.60383427963578, -18.66599762354246, -86.5446479867726, -114.4165470998892, -400.008903771805, -21.428524323688894, 83.34537449802544, 115.24321242719421, -40.79954980078856, -365.186314117217, -171.0255405201382, 50.18158693076043, 0.8924041177213096, -116.9372839294758, -380.4190814928898, 175.1897232281098, -94.76613593959853, -294.6104900381702, 108.73235205202293, -449.7171993080354, 189.2, -110.89191317290675, -46.29156002793539, -66.27296707728753, -536.6305704349558, 137.16182054032126, -171.23899825848997, -199.58732603896496, -212.09532283401245, 121.69476543003394, -361.9941120345669, -55.68204907485528, -650.8014830594802, 6.394376762465605, -559.1006401511415, 22.440446252562502, 49.699999999999974, -154.96943966198063, -171.12678678827382, -107.90289102718953, -190.7857719686354, -430.3370945111956, 147.0831986673652, -128.01092220182701, -362.6326920408227, 29.941587454319357, 104.4047120850109, -496.08055003266907, -52.125648004112215, 191.9, -343.5825911806992, 194.6, -242.26487174116826, 200.0, -314.5259195373536, -18.61656230440951, -34.43691529562369, -264.08609810855637, -550.9076885760913, 6.0963196208154615, 76.69999999999997, -288.2660513566386, -233.10475055334658, -50.51300782820707, 39.76107519101239, -134.7233787950565, -719.1012876163554, -259.6862489785657, -6.221271545495124, -72.2332566053403, -332.3982477393093, -85.35855980423365, -207.9443091337911, -198.19359619540518, 65.45943150905555, -370.08560039892194, -419.2887223514111, -463.95111011093553, 20.000000000000014, -210.36819020859144, -155.54845848621133, -213.1846693676274, -504.6017842614555, 17.275666248744237, 76.65030719475769, -438.77611137249755, 82.96328909621869, -163.12798883679207, -315.8730643113105, 192.59566353141875, -311.9449823566217, 148.67207682559825, -256.1059545024151, -437.94483235005106, -337.21138347344686, -254.34605548066858, 86.993078901772, -213.84367761674682, 46.016116523516786, -176.33479287164724, -1.6551778163383588, -302.1847434136273, -339.78397663168676, -375.25369237857234, 100.65003181402656, -291.0805432068379, -259.41001064028137, 90.62547818922377, -14.730629653143296, -592.351468503145, 22.21839616037881, -80.1433279386415, 19.410356642510017, -402.5762578403113, 92.1061371892593, -225.56916351171554, 184.77742541715347, -284.88611881634336, -162.3091689615944, -112.80494087478831, -81.90491390492635, -139.59243222609103, -235.84341484608993, 51.32451598219523, 35.79999999999996, -329.7328527065415, 136.39684016113517, -324.2255456366198, 175.0925361729279, -279.5749508491995, -536.6030088188189, -200.21652117303262, 155.01260364043404, -443.31702601891715, 194.1474450634856, -66.43376857135546, -140.1777155173587, -56.532058406968105, -271.69685335763717, 20.80571604399788, 138.80530232588887, -534.8270294526869, -219.98315969777957, -530.3148591669014, -159.60924185847642, -123.66291279871703, -137.2550592775292, 18.005625363244068, -463.3052265039162, 49.69999999999997, -105.06071243897918, -231.43140586459057, 177.7062617973236, -117.78492551848483, -320.1615157502878, -219.27721017514025, 128.89999999999998, -472.34127650801724, -105.04147988075528, -248.20287987479736, -237.1570986245277, -192.14088399624652, 20.000000000000014, -214.5590675723423, -139.83353933876606, -203.1232958919695, -266.09386966287263, 6.074721992020173, -219.46362437633937, 4.239360886810649, -265.3265766155296, -362.64396292535747, 127.08554372478292, -527.7456193393313, 111.79999999999971, -45.80772735850021, -502.46023377152665, 5.620677562089529, -290.8217202259608, -193.3375402993057, -33.76004304864766, -196.9501409737288, -480.44134485921575, -15.36779907022183, 116.5408058416091, 176.26426066828012, -374.783406130984, -216.45254208087707, -651.1380063820623, 108.0578944987829, 63.03223304703359, -307.6695091982752, -21.30374643827932, -398.67546618788833, -251.50047652361573, -39.16329979228541, -131.36781000853313, -323.4903893298606, -139.76834651963398, -49.89915955986947, -385.6633727462756, -170.90514395140593, -152.27925481887638, -376.33668765388563, 59.72549178882289, -361.4412715887934, -216.64921608038244, 109.02199699352782, -24.229385797164877, -398.9536684905411, -86.21672364301847, 5.272204392200628, -506.6978019062426, 70.39999999999996, -321.1257347228948, -109.45828304006791, -345.244610663288, -554.3328541327063, 90.80368889326847, -204.89517238900314, -258.51624544147967, -498.5217421141257, -179.3263689816547, 120.46720037538387, -9.351461007954754, -251.77022795646639, -271.9625797655764, 69.68471491532397, -94.57571742887973, -14.485259269727855, -552.6569732475338, -204.58629592478079, -639.149898538995, -198.41561172317455, -66.1087661046707, -375.53427854101307, -148.77597587334958, 116.01183291524632, -82.155382939358, 139.5558365879308, -438.21430441774964, -469.03989906329343, 192.3152763255589, -367.13695774475855, -395.3941093442854, -262.66662905007206, -59.75518689270649, -238.3866736647068, 192.56925457137368, -335.785209068956, -37.529177002300806, -308.0152239666531, -413.8030778781786, -459.1939249478397, -330.63003063169214, 162.77568249609573, -447.01461846275964, -67.88425320297723, 154.8404819131316, 31.480038117025032, -240.34242772339013, -488.0846159357606, -297.2111606805337, 57.39066100911374, -200.89222302445654, -474.73208845785604, -311.2830390617414, -49.779957004226276, -321.61384511851367, 14.280072067377997, -13.310909323585252, -319.50472328035477, -33.77177019838825, -262.4607096578426, -54.49331510144629, 97.20794703348828, -513.8157222580672, -220.99100921166945, -166.32567140072052, -371.6156795556838], "policy_predator_policy_reward": [172.09574415303496, 225.15726263638456, 494.69353946551377, 265.00486491335647, 146.00226298768968, 372.786623957317, 401.84391573147997, 317.45339699801775, 566.6387343345685, 584.7600275236041, 388.4527659292266, 242.74308804240488, 486.42051778732866, 395.0273980287415, 151.4309365769671, 155.0109278584312, 402.30890377180486, 95.57708045868127, 342.3958447551648, 117.84176396704399, 256.2767529102941, 172.20883447031062, 386.5882855206157, 364.9255368221716, 323.35528756709795, 206.61385101809503, 423.94925708588215, 285.11872703835326, 570.4772612525555, 217.32979151534352, 247.25928399825798, 242.20111542401074, 367.9941120345683, 226.8005574039784, 652.2917053260021, 106.94886645069607, 422.6009884377222, 437.1419840445059, 253.53317550986597, 295.2527193917184, 509.16760828038855, 346.7715793619885, 367.33269204082285, 170.40531054134792, 206.70364009872526, 462.6275148632978, 281.66432773903307, 311.4506239225609, 271.0581311345743, 310.2329305847283, 437.8710737128325, 200.66251201100363, 366.86983291436695, 369.0559486809063, 409.0123473413786, 317.966051356639, 720.1012876163554, 174.09147491067682, 286.95272385747177, 100.34584643546246, 412.90896467526863, 230.47240002832032, 392.2530055702551, 414.599829938833, 465.65106237449004, 539.8982130600485, 253.4159334892534, 429.5412533838877, 504.6017842614555, 13.361104608342602, 492.2420767208387, 391.3337509097256, 317.74498235662304, 324.99029526418514, 385.30715889531916, 301.0714374055539, 393.47800277335216, 270.77252509546275, 234.84367761674656, 244.15492644116526, 314.54160186468675, 343.9839766316875, 402.0491950218169, 335.2755085902005, 189.66663125884156, 331.5628233035428, 212.29648804193772, 567.226154378139, 331.66370947086205, 194.6992279539623, 211.85936455839297, 320.32510631273243, 227.55614423960816, 284.83407108303936, 152.15752483991548, 361.80043282256156, 288.3884371812057, 101.34953518906421, 349.15686443748285, 283.18094725953364, 347.41195208193983, 468.181619763799, 349.4881176682076, 431.1945293857041, 279.33027219318825, 359.5566025617746, 497.29668791737896, 301.0013281088413, 541.9018362776159, 556.5216011764802, 163.6550592775286, 136.9629127987164, 544.8689817432728, 416.0315649587651, 232.12887767522614, 223.9395074469025, 235.68699546601715, 396.2816526547599, 570.8409411986029, 297.710710848594, 122.2944095400369, 388.185278124002, 354.84474380941447, 408.53135336158374, 227.8073805594115, 343.0129575483196, 416.4136240824376, 367.043962925358, 304.07104463812817, 451.7933500102473, 275.4696371755174, 589.1187774116173, 293.9217202259615, 292.8086864112879, 517.6640739831588, 422.17308119994624, 192.35235914761708, 365.9397006134676, 231.28031291295108, 669.1604177238781, 300.6586892926819, 292.0729615416576, 401.7574532496733, 419.69443941549025, 409.12665691262333, 163.26834651963338, 388.96337274627615, 409.3372081910348, 448.5100522733646, 343.6381380388061, 230.6447033047046, 494.8894392379038, 413.7536684905414, 197.82314760405382, 492.43245302317524, 292.6687254302411, 261.34482528555003, 460.8657972361207, 545.0571949942002, 314.92179585606493, 500.2217421141261, 578.4035928769757, 151.34837952214326, 282.3995901347883, 302.3566204461932, 217.27296852480538, 434.51009826875196, 511.7905939854945, 380.6646458287628, 579.1137440874078, 250.9726646997542, 379.2342785410134, 415.2725710704352, 390.6234309540363, 373.7265714937134, 522.8367450732153, 453.32230508200075, 338.22840760936674, 380.7502655457708, 292.33823430407944, 480.95269196782584, 378.7390136477634, 433.4700608615047, 367.53940416905056, 431.7762675286081, 348.36503594901717, 498.9337418757194, 346.8623896063643, 275.61294705723736, 352.3721267137582, 329.6960706772664, 525.039277857974, 165.0371194921104, 370.22543343571243, 558.2507546796473, 189.78644845693836, 391.90034331395293, 432.7884316333301, 380.62974227727915, 474.0695805916264]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.513354791671329, "mean_inference_ms": 6.216488142588949, "mean_action_processing_ms": 2.5710428901015923, "mean_env_wait_ms": 16.008523932828805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004696011543273926, "StateBufferConnector_ms": 0.01013326644897461, "ViewRequirementAgentConnector_ms": 0.17848873138427734}, "num_episodes": 15, "episode_return_max": 636.0323604808955, "episode_return_min": -53.61800590458047, "episode_return_mean": 208.42665299888046, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.45811333173192, "num_env_steps_trained_throughput_per_sec": 66.45811333173192, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 1020000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 59733.693, "restore_workers_time_ms": 0.013, "training_step_time_ms": 59733.645, "sample_time_ms": 2059.173, "learn_time_ms": 57657.845, "learn_throughput": 69.375, "synch_weights_time_ms": 14.414}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "training_iteration": 51, "trial_id": "62684_00000", "date": "2024-08-20_17-09-06", "timestamp": 1724153946, "time_this_iter_s": 60.24133491516113, "time_total_s": 3676.8177745342255, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffbeaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3676.8177745342255, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 26.4, "ram_util_percent": 80.20705882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.336389281394634, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.158052933977006, "policy_loss": -0.019609601573576056, "vf_loss": 7.17473462304325, "vf_explained_var": 0.5605286666687499, "kl": 0.014639521488946275, "entropy": 0.9840669451664525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 145230.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.49791352938092, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.222998365018734, "policy_loss": -0.026571272947103593, "vf_loss": 8.246531193344682, "vf_explained_var": -0.015132025783024137, "kl": 0.015192325694718097, "entropy": 0.604999196734378, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 684.7161192428201, "episode_reward_min": -53.61800590458047, "episode_reward_mean": 210.55139988038346, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -719.1012876163554, "predator_policy": 13.361104608342602}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 720.1012876163554}, "policy_reward_mean": {"prey_policy": -163.09458440268787, "predator_policy": 349.9175765442236}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.03597579384065, 225.52966901025212, 636.0323604808955, 224.50027044078072, 321.3940100152448, 267.81441263999676, 155.0945889598251, 80.12917130663158, 49.15779316353378, 17.680248026253658, 304.0330704238169, 142.30944297219065, 103.85586881071156, 107.28707805184365, 364.6350165174945, 207.51289448429182, 140.9998862740044, 159.68616781647182, 134.836250093034, 14.90168063472042, 171.64049984063314, 337.71429245818365, 129.24624213866977, 235.3031734162814, 206.5066139602199, 155.37119158133834, 189.84662657249098, 232.20195982486257, 203.62985138412364, 233.78664549432094, 465.07929752712664, 170.48024747299866, 423.08200494342015, 188.51617673093858, 57.705625363244415, 442.2346077591437, 284.55831553637756, 221.42992219534892, 42.96601578362697, 101.18170504326554, 205.86019436791963, 91.33756606053859, 159.72640835371834, 467.0043190338292, 321.9411310191968, 68.81110306333497, 247.07787027993876, 476.3137201399906, 140.90807667267273, 326.79062824481935, 132.11265016137386, -22.231542425771295, 191.83290467975985, 323.25773962823087, 256.4656518669597, 102.17703816387069, 354.075580939375, -53.61800590458047, 191.5546532218238, 142.26097845384203, 293.09348106789446, 222.77600669186612, 174.57216381220417, 56.10411354933076, 221.90852174165056, 425.08215125529404, 252.70173608443483, 73.7347874043037, 291.485871687561, 100.34422676845446, 173.96119194711818, 420.0829137250211, 148.84912593995816, 187.27235107511916, 18.940264011414968, 214.6178705531004, 132.29999999999976, 353.5876846212582, 95.76696270083193, 50.09380683277642, 193.8613037848417, 274.4138208936915, 279.31659081098337, 497.03480068606257, 684.7161192428201, 169.3410067943197, 215.0229089610337, 210.57979942349934, 233.63934027252625, 292.92799852377357, 320.60511524047246, 244.89999999999944, 96.32841530467009, 133.21690981924738, 309.6628897645108, 226.97492493994912, 76.05699423238005, 132.9701000954929, 87.5301808151855, 118.1999999999998], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-128.01092220182701, -362.6326920408227, 29.941587454319357, 104.4047120850109, -496.08055003266907, -52.125648004112215, 191.9, -343.5825911806992, 194.6, -242.26487174116826, 200.0, -314.5259195373536, -18.61656230440951, -34.43691529562369, -264.08609810855637, -550.9076885760913, 6.0963196208154615, 76.69999999999997, -288.2660513566386, -233.10475055334658, -50.51300782820707, 39.76107519101239, -134.7233787950565, -719.1012876163554, -259.6862489785657, -6.221271545495124, -72.2332566053403, -332.3982477393093, -85.35855980423365, -207.9443091337911, -198.19359619540518, 65.45943150905555, -370.08560039892194, -419.2887223514111, -463.95111011093553, 20.000000000000014, -210.36819020859144, -155.54845848621133, -213.1846693676274, -504.6017842614555, 17.275666248744237, 76.65030719475769, -438.77611137249755, 82.96328909621869, -163.12798883679207, -315.8730643113105, 192.59566353141875, -311.9449823566217, 148.67207682559825, -256.1059545024151, -437.94483235005106, -337.21138347344686, -254.34605548066858, 86.993078901772, -213.84367761674682, 46.016116523516786, -176.33479287164724, -1.6551778163383588, -302.1847434136273, -339.78397663168676, -375.25369237857234, 100.65003181402656, -291.0805432068379, -259.41001064028137, 90.62547818922377, -14.730629653143296, -592.351468503145, 22.21839616037881, -80.1433279386415, 19.410356642510017, -402.5762578403113, 92.1061371892593, -225.56916351171554, 184.77742541715347, -284.88611881634336, -162.3091689615944, -112.80494087478831, -81.90491390492635, -139.59243222609103, -235.84341484608993, 51.32451598219523, 35.79999999999996, -329.7328527065415, 136.39684016113517, -324.2255456366198, 175.0925361729279, -279.5749508491995, -536.6030088188189, -200.21652117303262, 155.01260364043404, -443.31702601891715, 194.1474450634856, -66.43376857135546, -140.1777155173587, -56.532058406968105, -271.69685335763717, 20.80571604399788, 138.80530232588887, -534.8270294526869, -219.98315969777957, -530.3148591669014, -159.60924185847642, -123.66291279871703, -137.2550592775292, 18.005625363244068, -463.3052265039162, 49.69999999999997, -105.06071243897918, -231.43140586459057, 177.7062617973236, -117.78492551848483, -320.1615157502878, -219.27721017514025, 128.89999999999998, -472.34127650801724, -105.04147988075528, -248.20287987479736, -237.1570986245277, -192.14088399624652, 20.000000000000014, -214.5590675723423, -139.83353933876606, -203.1232958919695, -266.09386966287263, 6.074721992020173, -219.46362437633937, 4.239360886810649, -265.3265766155296, -362.64396292535747, 127.08554372478292, -527.7456193393313, 111.79999999999971, -45.80772735850021, -502.46023377152665, 5.620677562089529, -290.8217202259608, -193.3375402993057, -33.76004304864766, -196.9501409737288, -480.44134485921575, -15.36779907022183, 116.5408058416091, 176.26426066828012, -374.783406130984, -216.45254208087707, -651.1380063820623, 108.0578944987829, 63.03223304703359, -307.6695091982752, -21.30374643827932, -398.67546618788833, -251.50047652361573, -39.16329979228541, -131.36781000853313, -323.4903893298606, -139.76834651963398, -49.89915955986947, -385.6633727462756, -170.90514395140593, -152.27925481887638, -376.33668765388563, 59.72549178882289, -361.4412715887934, -216.64921608038244, 109.02199699352782, -24.229385797164877, -398.9536684905411, -86.21672364301847, 5.272204392200628, -506.6978019062426, 70.39999999999996, -321.1257347228948, -109.45828304006791, -345.244610663288, -554.3328541327063, 90.80368889326847, -204.89517238900314, -258.51624544147967, -498.5217421141257, -179.3263689816547, 120.46720037538387, -9.351461007954754, -251.77022795646639, -271.9625797655764, 69.68471491532397, -94.57571742887973, -14.485259269727855, -552.6569732475338, -204.58629592478079, -639.149898538995, -198.41561172317455, -66.1087661046707, -375.53427854101307, -148.77597587334958, 116.01183291524632, -82.155382939358, 139.5558365879308, -438.21430441774964, -469.03989906329343, 192.3152763255589, -367.13695774475855, -395.3941093442854, -262.66662905007206, -59.75518689270649, -238.3866736647068, 192.56925457137368, -335.785209068956, -37.529177002300806, -308.0152239666531, -413.8030778781786, -459.1939249478397, -330.63003063169214, 162.77568249609573, -447.01461846275964, -67.88425320297723, 154.8404819131316, 31.480038117025032, -240.34242772339013, -488.0846159357606, -297.2111606805337, 57.39066100911374, -200.89222302445654, -474.73208845785604, -311.2830390617414, -49.779957004226276, -321.61384511851367, 14.280072067377997, -13.310909323585252, -319.50472328035477, -33.77177019838825, -262.4607096578426, -54.49331510144629, 97.20794703348828, -513.8157222580672, -220.99100921166945, -166.32567140072052, -371.6156795556838, -264.7136493521711, -252.18106160616136, -157.2947476774731, -345.4969734190346, -1.8135655463963616, -102.20382596613487, -285.9854264969885, 9.705372287376335, 200.0, -218.26108206250015, 198.2, -396.29800169171676, -366.30783889716616, 60.70455051827934, 196.47956317757854, 199.1, -435.9478316270812, 193.7, -15.952901090500141, -317.9246584034794, -377.4120538068238, 47.54753520161904, 74.52222171296748, -351.0921653597729, -123.99052230338282, -207.49320894705852, -41.79947726320263, 54.634976191055244, 24.96993699957323, -307.6820923757914, 77.0878129833419, -512.3113144734743, -164.33782656681683, 183.41372669702253, -436.2859337223574, -145.63097103380608, 200.0, -201.4951454755323, -154.56418967660932, -308.6033151386389, -205.60062914485826, -100.67033137480684, -242.12871739418486, -78.53166443938935, -374.642243484852, -18.9720573668429, 40.28351219776732, -281.9839908675521, -105.1989153102576, -386.9630338732307, -115.6677538141613, -476.895216278946, 40.250713856394086, -192.0201482491764, -229.86394818660605, -320.27027424513193, -160.83548466029532, -96.37071376570277, -381.8043562170835, -126.42468263179717, -416.3177409457132, 99.19999999999997, -318.3180997213022], "policy_predator_policy_reward": [367.33269204082285, 170.40531054134792, 206.70364009872526, 462.6275148632978, 281.66432773903307, 311.4506239225609, 271.0581311345743, 310.2329305847283, 437.8710737128325, 200.66251201100363, 366.86983291436695, 369.0559486809063, 409.0123473413786, 317.966051356639, 720.1012876163554, 174.09147491067682, 286.95272385747177, 100.34584643546246, 412.90896467526863, 230.47240002832032, 392.2530055702551, 414.599829938833, 465.65106237449004, 539.8982130600485, 253.4159334892534, 429.5412533838877, 504.6017842614555, 13.361104608342602, 492.2420767208387, 391.3337509097256, 317.74498235662304, 324.99029526418514, 385.30715889531916, 301.0714374055539, 393.47800277335216, 270.77252509546275, 234.84367761674656, 244.15492644116526, 314.54160186468675, 343.9839766316875, 402.0491950218169, 335.2755085902005, 189.66663125884156, 331.5628233035428, 212.29648804193772, 567.226154378139, 331.66370947086205, 194.6992279539623, 211.85936455839297, 320.32510631273243, 227.55614423960816, 284.83407108303936, 152.15752483991548, 361.80043282256156, 288.3884371812057, 101.34953518906421, 349.15686443748285, 283.18094725953364, 347.41195208193983, 468.181619763799, 349.4881176682076, 431.1945293857041, 279.33027219318825, 359.5566025617746, 497.29668791737896, 301.0013281088413, 541.9018362776159, 556.5216011764802, 163.6550592775286, 136.9629127987164, 544.8689817432728, 416.0315649587651, 232.12887767522614, 223.9395074469025, 235.68699546601715, 396.2816526547599, 570.8409411986029, 297.710710848594, 122.2944095400369, 388.185278124002, 354.84474380941447, 408.53135336158374, 227.8073805594115, 343.0129575483196, 416.4136240824376, 367.043962925358, 304.07104463812817, 451.7933500102473, 275.4696371755174, 589.1187774116173, 293.9217202259615, 292.8086864112879, 517.6640739831588, 422.17308119994624, 192.35235914761708, 365.9397006134676, 231.28031291295108, 669.1604177238781, 300.6586892926819, 292.0729615416576, 401.7574532496733, 419.69443941549025, 409.12665691262333, 163.26834651963338, 388.96337274627615, 409.3372081910348, 448.5100522733646, 343.6381380388061, 230.6447033047046, 494.8894392379038, 413.7536684905414, 197.82314760405382, 492.43245302317524, 292.6687254302411, 261.34482528555003, 460.8657972361207, 545.0571949942002, 314.92179585606493, 500.2217421141261, 578.4035928769757, 151.34837952214326, 282.3995901347883, 302.3566204461932, 217.27296852480538, 434.51009826875196, 511.7905939854945, 380.6646458287628, 579.1137440874078, 250.9726646997542, 379.2342785410134, 415.2725710704352, 390.6234309540363, 373.7265714937134, 522.8367450732153, 453.32230508200075, 338.22840760936674, 380.7502655457708, 292.33823430407944, 480.95269196782584, 378.7390136477634, 433.4700608615047, 367.53940416905056, 431.7762675286081, 348.36503594901717, 498.9337418757194, 346.8623896063643, 275.61294705723736, 352.3721267137582, 329.6960706772664, 525.039277857974, 165.0371194921104, 370.22543343571243, 558.2507546796473, 189.78644845693836, 391.90034331395293, 432.7884316333301, 380.62974227727915, 474.0695805916264, 311.73038667457314, 412.5528787940076, 246.25712721332704, 397.1185415030805, 293.9854264969881, 56.70844860631601, 230.6727512751932, 465.00292329000797, 317.39222075511026, 288.76630513226127, 382.5411896305269, 345.32276123937476, 414.48507434056233, 466.14554575456356, 362.51493255613417, 81.53038485008622, 291.24738702391073, 292.61562091323225, 141.9344270818984, 319.78209237579136, 509.0265954622676, 383.4627311184548, 340.9591440379161, 378.1491492616967, 241.09338947541897, 159.86594567672202, 306.5026484114237, 404.7000425515513, 398.367337736938, 430.1521974007361, 351.75042234581446, 218.58500345532374, 449.08310722925444, 385.72152070834437, 216.86252838760174, 487.8591165165076, 518.6140720374709, 325.32573515005436, 300.51785491447714, 391.61207851529065, 325.21809972130194, 428.41774094571406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.425874692862396, "mean_inference_ms": 6.1488461602663405, "mean_action_processing_ms": 2.5705731061261035, "mean_env_wait_ms": 15.87602922375393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004911065101623535, "StateBufferConnector_ms": 0.01034998893737793, "ViewRequirementAgentConnector_ms": 0.16121184825897217}, "num_episodes": 21, "episode_return_max": 684.7161192428201, "episode_return_min": -53.61800590458047, "episode_return_mean": 210.55139988038346, "episodes_this_iter": 21}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.9954096855323, "num_env_steps_trained_throughput_per_sec": 66.9954096855323, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 59696.727, "restore_workers_time_ms": 0.013, "training_step_time_ms": 59696.679, "sample_time_ms": 2088.869, "learn_time_ms": 57592.05, "learn_throughput": 69.454, "synch_weights_time_ms": 13.561}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 52, "trial_id": "62684_00000", "date": "2024-08-20_17-10-06", "timestamp": 1724154006, "time_this_iter_s": 59.75675392150879, "time_total_s": 3736.5745284557343, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3acaefd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3736.5745284557343, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 24.740476190476187, "ram_util_percent": 80.44761904761903}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.479574409528826, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.062049754629744, "policy_loss": -0.02030572269210123, "vf_loss": 7.079551146216426, "vf_explained_var": 0.5466288138788643, "kl": 0.014021676838404586, "entropy": 0.9822588884238656, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 148050.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.462827112750402, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.458307065156403, "policy_loss": -0.023722567061386094, "vf_loss": 8.479565037873687, "vf_explained_var": -0.046962710757734914, "kl": 0.012322949864729135, "entropy": 0.5860378600459881, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 1060000, "num_agent_steps_trained": 1060000}, "env_runners": {"episode_reward_max": 684.7161192428201, "episode_reward_min": -53.61800590458047, "episode_reward_mean": 214.45914496393735, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -663.7195984072588, "predator_policy": 13.182998217791328}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 669.1604177238781}, "policy_reward_mean": {"prey_policy": -159.4280066885821, "predator_policy": 346.37158251484186}, "custom_metrics": {}, "hist_stats": {"episode_reward": [206.5066139602199, 155.37119158133834, 189.84662657249098, 232.20195982486257, 203.62985138412364, 233.78664549432094, 465.07929752712664, 170.48024747299866, 423.08200494342015, 188.51617673093858, 57.705625363244415, 442.2346077591437, 284.55831553637756, 221.42992219534892, 42.96601578362697, 101.18170504326554, 205.86019436791963, 91.33756606053859, 159.72640835371834, 467.0043190338292, 321.9411310191968, 68.81110306333497, 247.07787027993876, 476.3137201399906, 140.90807667267273, 326.79062824481935, 132.11265016137386, -22.231542425771295, 191.83290467975985, 323.25773962823087, 256.4656518669597, 102.17703816387069, 354.075580939375, -53.61800590458047, 191.5546532218238, 142.26097845384203, 293.09348106789446, 222.77600669186612, 174.57216381220417, 56.10411354933076, 221.90852174165056, 425.08215125529404, 252.70173608443483, 73.7347874043037, 291.485871687561, 100.34422676845446, 173.96119194711818, 420.0829137250211, 148.84912593995816, 187.27235107511916, 18.940264011414968, 214.6178705531004, 132.29999999999976, 353.5876846212582, 95.76696270083193, 50.09380683277642, 193.8613037848417, 274.4138208936915, 279.31659081098337, 497.03480068606257, 684.7161192428201, 169.3410067943197, 215.0229089610337, 210.57979942349934, 233.63934027252625, 292.92799852377357, 320.60511524047246, 244.89999999999944, 96.32841530467009, 133.21690981924738, 309.6628897645108, 226.97492493994912, 76.05699423238005, 132.9701000954929, 87.5301808151855, 118.1999999999998, 226.77894235503226, 93.36558122069802, 231.8435596712774, 343.19191780340407, 340.98561620276064, 168.45485535164045, 88.72781264325147, 147.5950604957256, 184.42935042488583, 224.2208695700216, 443.1370039291982, 65.00229119766612, 108.8053807142111, 76.12454706975687, 278.31718283261387, 192.7578862211433, 112.48200613444347, 266.15268890133507, 234.86639165661677, 206.2181028254903, 151.59999999999943, 437.6658418022187, 183.830109017911, 192.5515740836908], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-225.56916351171554, 184.77742541715347, -284.88611881634336, -162.3091689615944, -112.80494087478831, -81.90491390492635, -139.59243222609103, -235.84341484608993, 51.32451598219523, 35.79999999999996, -329.7328527065415, 136.39684016113517, -324.2255456366198, 175.0925361729279, -279.5749508491995, -536.6030088188189, -200.21652117303262, 155.01260364043404, -443.31702601891715, 194.1474450634856, -66.43376857135546, -140.1777155173587, -56.532058406968105, -271.69685335763717, 20.80571604399788, 138.80530232588887, -534.8270294526869, -219.98315969777957, -530.3148591669014, -159.60924185847642, -123.66291279871703, -137.2550592775292, 18.005625363244068, -463.3052265039162, 49.69999999999997, -105.06071243897918, -231.43140586459057, 177.7062617973236, -117.78492551848483, -320.1615157502878, -219.27721017514025, 128.89999999999998, -472.34127650801724, -105.04147988075528, -248.20287987479736, -237.1570986245277, -192.14088399624652, 20.000000000000014, -214.5590675723423, -139.83353933876606, -203.1232958919695, -266.09386966287263, 6.074721992020173, -219.46362437633937, 4.239360886810649, -265.3265766155296, -362.64396292535747, 127.08554372478292, -527.7456193393313, 111.79999999999971, -45.80772735850021, -502.46023377152665, 5.620677562089529, -290.8217202259608, -193.3375402993057, -33.76004304864766, -196.9501409737288, -480.44134485921575, -15.36779907022183, 116.5408058416091, 176.26426066828012, -374.783406130984, -216.45254208087707, -651.1380063820623, 108.0578944987829, 63.03223304703359, -307.6695091982752, -21.30374643827932, -398.67546618788833, -251.50047652361573, -39.16329979228541, -131.36781000853313, -323.4903893298606, -139.76834651963398, -49.89915955986947, -385.6633727462756, -170.90514395140593, -152.27925481887638, -376.33668765388563, 59.72549178882289, -361.4412715887934, -216.64921608038244, 109.02199699352782, -24.229385797164877, -398.9536684905411, -86.21672364301847, 5.272204392200628, -506.6978019062426, 70.39999999999996, -321.1257347228948, -109.45828304006791, -345.244610663288, -554.3328541327063, 90.80368889326847, -204.89517238900314, -258.51624544147967, -498.5217421141257, -179.3263689816547, 120.46720037538387, -9.351461007954754, -251.77022795646639, -271.9625797655764, 69.68471491532397, -94.57571742887973, -14.485259269727855, -552.6569732475338, -204.58629592478079, -639.149898538995, -198.41561172317455, -66.1087661046707, -375.53427854101307, -148.77597587334958, 116.01183291524632, -82.155382939358, 139.5558365879308, -438.21430441774964, -469.03989906329343, 192.3152763255589, -367.13695774475855, -395.3941093442854, -262.66662905007206, -59.75518689270649, -238.3866736647068, 192.56925457137368, -335.785209068956, -37.529177002300806, -308.0152239666531, -413.8030778781786, -459.1939249478397, -330.63003063169214, 162.77568249609573, -447.01461846275964, -67.88425320297723, 154.8404819131316, 31.480038117025032, -240.34242772339013, -488.0846159357606, -297.2111606805337, 57.39066100911374, -200.89222302445654, -474.73208845785604, -311.2830390617414, -49.779957004226276, -321.61384511851367, 14.280072067377997, -13.310909323585252, -319.50472328035477, -33.77177019838825, -262.4607096578426, -54.49331510144629, 97.20794703348828, -513.8157222580672, -220.99100921166945, -166.32567140072052, -371.6156795556838, -264.7136493521711, -252.18106160616136, -157.2947476774731, -345.4969734190346, -1.8135655463963616, -102.20382596613487, -285.9854264969885, 9.705372287376335, 200.0, -218.26108206250015, 198.2, -396.29800169171676, -366.30783889716616, 60.70455051827934, 196.47956317757854, 199.1, -435.9478316270812, 193.7, -15.952901090500141, -317.9246584034794, -377.4120538068238, 47.54753520161904, 74.52222171296748, -351.0921653597729, -123.99052230338282, -207.49320894705852, -41.79947726320263, 54.634976191055244, 24.96993699957323, -307.6820923757914, 77.0878129833419, -512.3113144734743, -164.33782656681683, 183.41372669702253, -436.2859337223574, -145.63097103380608, 200.0, -201.4951454755323, -154.56418967660932, -308.6033151386389, -205.60062914485826, -100.67033137480684, -242.12871739418486, -78.53166443938935, -374.642243484852, -18.9720573668429, 40.28351219776732, -281.9839908675521, -105.1989153102576, -386.9630338732307, -115.6677538141613, -476.895216278946, 40.250713856394086, -192.0201482491764, -229.86394818660605, -320.27027424513193, -160.83548466029532, -96.37071376570277, -381.8043562170835, -126.42468263179717, -416.3177409457132, 99.19999999999997, -318.3180997213022, -450.10572192082634, 142.9178498306811, -44.31689335374365, -18.67578817304971, -135.53472055161544, -208.60599302423086, -272.83514153437557, 200.0, -412.9703800163431, -328.78867829086494, -5.481316284973418, 126.35463863949484, 82.0047561522433, -408.503906170865, 191.0, -126.05904591488714, -262.03339463716895, 33.171368675551626, -346.811126082104, -42.1510712970621, 18.369104468460918, -255.95712143468225, 95.00416800077575, -118.86513001573852, -22.121910502210127, -167.6285384585343, -549.3061508983782, -305.06631288444976, 68.61382089369215, -123.07808518077985, 147.6246614859979, -396.24658452782404, 97.67934244363519, -75.24203548037866, 30.575240362968124, -209.59898327389146, -175.89969695914144, -245.20175897001525, -231.26311529291934, -54.278031874898005, -111.39087646237466, -413.6692954480503, -277.95889401848945, 192.8, -418.1896308982531, -184.34579974895937, 0.6238795093067022, -80.39019840409256, -238.0845598364717, -50.12809227335032, -203.4731890473017, -532.9074727885994, -192.5789608936346, 175.0548368779604, 22.635888053053456, -161.73419620675003, -456.79518287347435, -183.37533773772626, -235.54524015852172, 26.655728030312684, -190.85791104540243, -54.34037897753569, -175.99808851927355, -0.8264106074092741, -663.7195984072588, 21.366854287704975, -188.08013093223104, -410.2072638192238, -183.64865587634915, -338.8820469346177, 92.45880101763441, -116.86548695381894], "policy_predator_policy_reward": [211.85936455839297, 320.32510631273243, 227.55614423960816, 284.83407108303936, 152.15752483991548, 361.80043282256156, 288.3884371812057, 101.34953518906421, 349.15686443748285, 283.18094725953364, 347.41195208193983, 468.181619763799, 349.4881176682076, 431.1945293857041, 279.33027219318825, 359.5566025617746, 497.29668791737896, 301.0013281088413, 541.9018362776159, 556.5216011764802, 163.6550592775286, 136.9629127987164, 544.8689817432728, 416.0315649587651, 232.12887767522614, 223.9395074469025, 235.68699546601715, 396.2816526547599, 570.8409411986029, 297.710710848594, 122.2944095400369, 388.185278124002, 354.84474380941447, 408.53135336158374, 227.8073805594115, 343.0129575483196, 416.4136240824376, 367.043962925358, 304.07104463812817, 451.7933500102473, 275.4696371755174, 589.1187774116173, 293.9217202259615, 292.8086864112879, 517.6640739831588, 422.17308119994624, 192.35235914761708, 365.9397006134676, 231.28031291295108, 669.1604177238781, 300.6586892926819, 292.0729615416576, 401.7574532496733, 419.69443941549025, 409.12665691262333, 163.26834651963338, 388.96337274627615, 409.3372081910348, 448.5100522733646, 343.6381380388061, 230.6447033047046, 494.8894392379038, 413.7536684905414, 197.82314760405382, 492.43245302317524, 292.6687254302411, 261.34482528555003, 460.8657972361207, 545.0571949942002, 314.92179585606493, 500.2217421141261, 578.4035928769757, 151.34837952214326, 282.3995901347883, 302.3566204461932, 217.27296852480538, 434.51009826875196, 511.7905939854945, 380.6646458287628, 579.1137440874078, 250.9726646997542, 379.2342785410134, 415.2725710704352, 390.6234309540363, 373.7265714937134, 522.8367450732153, 453.32230508200075, 338.22840760936674, 380.7502655457708, 292.33823430407944, 480.95269196782584, 378.7390136477634, 433.4700608615047, 367.53940416905056, 431.7762675286081, 348.36503594901717, 498.9337418757194, 346.8623896063643, 275.61294705723736, 352.3721267137582, 329.6960706772664, 525.039277857974, 165.0371194921104, 370.22543343571243, 558.2507546796473, 189.78644845693836, 391.90034331395293, 432.7884316333301, 380.62974227727915, 474.0695805916264, 311.73038667457314, 412.5528787940076, 246.25712721332704, 397.1185415030805, 293.9854264969881, 56.70844860631601, 230.6727512751932, 465.00292329000797, 317.39222075511026, 288.76630513226127, 382.5411896305269, 345.32276123937476, 414.48507434056233, 466.14554575456356, 362.51493255613417, 81.53038485008622, 291.24738702391073, 292.61562091323225, 141.9344270818984, 319.78209237579136, 509.0265954622676, 383.4627311184548, 340.9591440379161, 378.1491492616967, 241.09338947541897, 159.86594567672202, 306.5026484114237, 404.7000425515513, 398.367337736938, 430.1521974007361, 351.75042234581446, 218.58500345532374, 449.08310722925444, 385.72152070834437, 216.86252838760174, 487.8591165165076, 518.6140720374709, 325.32573515005436, 300.51785491447714, 391.61207851529065, 325.21809972130194, 428.41774094571406, 419.76166079355437, 158.52204700536677, 254.2314735049568, 201.95060946463636, 374.2108424089333, 343.4382388130628, 122.6899891067698, 428.41728463297704, 112.27049511002423, 364.2142711113579, 288.068647178931, 235.30728004921406, 356.4787687509193, 102.84213680303726, 163.3236324145379, 264.089511530833, 542.8937212444197, 380.59222903958863, 305.2771661177216, 278.47428062383926, 360.79574380747243, 233.28384071991672, 13.182998217791328, 306.08507137117675, 280.60787847491224, 480.5620734613743, 308.1266418094128, 347.33610904566774, 321.6162329292459, 460.0494748201127, 175.97703244147783, 280.89297242341223, 342.76787223699296, 261.39997505457376, 288.8409812736729, 527.7433044319364, 452.9988385236195, 377.7610441601689, 278.9992013614559, 319.48375132996955, 359.029246903527, 213.76713163868433, 641.1239845870238, 439.72101194215554, 551.7220170124951, 414.0441426332208, 252.76402204130707, 303.07628491318627]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.345191477841424, "mean_inference_ms": 6.085152165492751, "mean_action_processing_ms": 2.556721320906368, "mean_env_wait_ms": 15.704417458431905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004893183708190918, "StateBufferConnector_ms": 0.010326743125915527, "ViewRequirementAgentConnector_ms": 0.13608670234680176}, "num_episodes": 24, "episode_return_max": 684.7161192428201, "episode_return_min": -53.61800590458047, "episode_return_mean": 214.45914496393735, "episodes_this_iter": 24}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1060000, "num_agent_steps_trained": 1060000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.01633106684679, "num_env_steps_trained_throughput_per_sec": 67.01633106684679, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 1060000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1060000, "timers": {"training_iteration_time_ms": 59655.656, "restore_workers_time_ms": 0.013, "training_step_time_ms": 59655.606, "sample_time_ms": 2097.276, "learn_time_ms": 57542.354, "learn_throughput": 69.514, "synch_weights_time_ms": 13.641}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 1060000, "num_agent_steps_trained": 1060000}, "done": false, "training_iteration": 53, "trial_id": "62684_00000", "date": "2024-08-20_17-11-06", "timestamp": 1724154066, "time_this_iter_s": 59.733623027801514, "time_total_s": 3796.3081514835358, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3acae6ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3796.3081514835358, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 24.844705882352944, "ram_util_percent": 80.35999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.926659103910973, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.181826134100028, "policy_loss": -0.017667277548247484, "vf_loss": 7.196718353751703, "vf_explained_var": 0.4721152761303787, "kl": 0.013875302443353473, "entropy": 0.9595500351478022, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 150870.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.093656281188682, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.424115082826564, "policy_loss": -0.02508282163660855, "vf_loss": 8.446900183309323, "vf_explained_var": -0.21534299519326952, "kl": 0.011488580643864614, "entropy": 0.565097403557843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "env_runners": {"episode_reward_max": 684.7161192428201, "episode_reward_min": -53.61800590458047, "episode_reward_mean": 212.11749312073815, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -663.7195984072588, "predator_policy": 13.182998217791328}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 669.1604177238781}, "policy_reward_mean": {"prey_policy": -160.14517277053437, "predator_policy": 346.2765057161707}, "custom_metrics": {}, "hist_stats": {"episode_reward": [68.81110306333497, 247.07787027993876, 476.3137201399906, 140.90807667267273, 326.79062824481935, 132.11265016137386, -22.231542425771295, 191.83290467975985, 323.25773962823087, 256.4656518669597, 102.17703816387069, 354.075580939375, -53.61800590458047, 191.5546532218238, 142.26097845384203, 293.09348106789446, 222.77600669186612, 174.57216381220417, 56.10411354933076, 221.90852174165056, 425.08215125529404, 252.70173608443483, 73.7347874043037, 291.485871687561, 100.34422676845446, 173.96119194711818, 420.0829137250211, 148.84912593995816, 187.27235107511916, 18.940264011414968, 214.6178705531004, 132.29999999999976, 353.5876846212582, 95.76696270083193, 50.09380683277642, 193.8613037848417, 274.4138208936915, 279.31659081098337, 497.03480068606257, 684.7161192428201, 169.3410067943197, 215.0229089610337, 210.57979942349934, 233.63934027252625, 292.92799852377357, 320.60511524047246, 244.89999999999944, 96.32841530467009, 133.21690981924738, 309.6628897645108, 226.97492493994912, 76.05699423238005, 132.9701000954929, 87.5301808151855, 118.1999999999998, 226.77894235503226, 93.36558122069802, 231.8435596712774, 343.19191780340407, 340.98561620276064, 168.45485535164045, 88.72781264325147, 147.5950604957256, 184.42935042488583, 224.2208695700216, 443.1370039291982, 65.00229119766612, 108.8053807142111, 76.12454706975687, 278.31718283261387, 192.7578862211433, 112.48200613444347, 266.15268890133507, 234.86639165661677, 206.2181028254903, 151.59999999999943, 437.6658418022187, 183.830109017911, 192.5515740836908, 31.139152836093402, 184.77825442986673, 309.9003077837916, 170.21534608232088, 397.14736362910975, 468.5157386950712, 95.83927796185934, 19.532843072234805, 582.558719230543, 414.18539758205026, 462.4975701564894, 208.76903127302208, 26.281430770217206, 170.9044117548485, 177.09049461931613, 73.01481339144209, 182.04548087605934, 1.9872086894081846, 68.7170748963813, 293.5220408258192, 291.63928313218787], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-290.8217202259608, -193.3375402993057, -33.76004304864766, -196.9501409737288, -480.44134485921575, -15.36779907022183, 116.5408058416091, 176.26426066828012, -374.783406130984, -216.45254208087707, -651.1380063820623, 108.0578944987829, 63.03223304703359, -307.6695091982752, -21.30374643827932, -398.67546618788833, -251.50047652361573, -39.16329979228541, -131.36781000853313, -323.4903893298606, -139.76834651963398, -49.89915955986947, -385.6633727462756, -170.90514395140593, -152.27925481887638, -376.33668765388563, 59.72549178882289, -361.4412715887934, -216.64921608038244, 109.02199699352782, -24.229385797164877, -398.9536684905411, -86.21672364301847, 5.272204392200628, -506.6978019062426, 70.39999999999996, -321.1257347228948, -109.45828304006791, -345.244610663288, -554.3328541327063, 90.80368889326847, -204.89517238900314, -258.51624544147967, -498.5217421141257, -179.3263689816547, 120.46720037538387, -9.351461007954754, -251.77022795646639, -271.9625797655764, 69.68471491532397, -94.57571742887973, -14.485259269727855, -552.6569732475338, -204.58629592478079, -639.149898538995, -198.41561172317455, -66.1087661046707, -375.53427854101307, -148.77597587334958, 116.01183291524632, -82.155382939358, 139.5558365879308, -438.21430441774964, -469.03989906329343, 192.3152763255589, -367.13695774475855, -395.3941093442854, -262.66662905007206, -59.75518689270649, -238.3866736647068, 192.56925457137368, -335.785209068956, -37.529177002300806, -308.0152239666531, -413.8030778781786, -459.1939249478397, -330.63003063169214, 162.77568249609573, -447.01461846275964, -67.88425320297723, 154.8404819131316, 31.480038117025032, -240.34242772339013, -488.0846159357606, -297.2111606805337, 57.39066100911374, -200.89222302445654, -474.73208845785604, -311.2830390617414, -49.779957004226276, -321.61384511851367, 14.280072067377997, -13.310909323585252, -319.50472328035477, -33.77177019838825, -262.4607096578426, -54.49331510144629, 97.20794703348828, -513.8157222580672, -220.99100921166945, -166.32567140072052, -371.6156795556838, -264.7136493521711, -252.18106160616136, -157.2947476774731, -345.4969734190346, -1.8135655463963616, -102.20382596613487, -285.9854264969885, 9.705372287376335, 200.0, -218.26108206250015, 198.2, -396.29800169171676, -366.30783889716616, 60.70455051827934, 196.47956317757854, 199.1, -435.9478316270812, 193.7, -15.952901090500141, -317.9246584034794, -377.4120538068238, 47.54753520161904, 74.52222171296748, -351.0921653597729, -123.99052230338282, -207.49320894705852, -41.79947726320263, 54.634976191055244, 24.96993699957323, -307.6820923757914, 77.0878129833419, -512.3113144734743, -164.33782656681683, 183.41372669702253, -436.2859337223574, -145.63097103380608, 200.0, -201.4951454755323, -154.56418967660932, -308.6033151386389, -205.60062914485826, -100.67033137480684, -242.12871739418486, -78.53166443938935, -374.642243484852, -18.9720573668429, 40.28351219776732, -281.9839908675521, -105.1989153102576, -386.9630338732307, -115.6677538141613, -476.895216278946, 40.250713856394086, -192.0201482491764, -229.86394818660605, -320.27027424513193, -160.83548466029532, -96.37071376570277, -381.8043562170835, -126.42468263179717, -416.3177409457132, 99.19999999999997, -318.3180997213022, -450.10572192082634, 142.9178498306811, -44.31689335374365, -18.67578817304971, -135.53472055161544, -208.60599302423086, -272.83514153437557, 200.0, -412.9703800163431, -328.78867829086494, -5.481316284973418, 126.35463863949484, 82.0047561522433, -408.503906170865, 191.0, -126.05904591488714, -262.03339463716895, 33.171368675551626, -346.811126082104, -42.1510712970621, 18.369104468460918, -255.95712143468225, 95.00416800077575, -118.86513001573852, -22.121910502210127, -167.6285384585343, -549.3061508983782, -305.06631288444976, 68.61382089369215, -123.07808518077985, 147.6246614859979, -396.24658452782404, 97.67934244363519, -75.24203548037866, 30.575240362968124, -209.59898327389146, -175.89969695914144, -245.20175897001525, -231.26311529291934, -54.278031874898005, -111.39087646237466, -413.6692954480503, -277.95889401848945, 192.8, -418.1896308982531, -184.34579974895937, 0.6238795093067022, -80.39019840409256, -238.0845598364717, -50.12809227335032, -203.4731890473017, -532.9074727885994, -192.5789608936346, 175.0548368779604, 22.635888053053456, -161.73419620675003, -456.79518287347435, -183.37533773772626, -235.54524015852172, 26.655728030312684, -190.85791104540243, -54.34037897753569, -175.99808851927355, -0.8264106074092741, -663.7195984072588, 21.366854287704975, -188.08013093223104, -410.2072638192238, -183.64865587634915, -338.8820469346177, 92.45880101763441, -116.86548695381894, -143.9924477819814, -493.42186184640383, -110.77292142449075, 144.84180543226105, -323.89777477440003, -253.67186217095679, 178.4, 7.930379481616773, -352.021815498669, -302.62098925630653, 26.236233974895352, -48.59231067873295, 76.64987470064233, 159.64823217227408, -204.69155688093787, 45.69674315843711, -89.36649173960137, -658.9145238143317, -118.60420764961954, -111.81636059093945, -275.8271281386059, -490.850421029345, -294.81058264451957, 0.5024118881420596, 190.99999999999994, -402.4850288321554, 111.9258487719162, -45.32243880923451, -246.5859760373506, 117.51446733195537, 18.615988446245446, 121.54766086059733, -458.9251033019653, 124.53746262048688, -51.1278144511894, -508.9003096887851, -246.17633716914014, -425.53111442148673, -104.35105687436791, -285.21030523230337, 174.51141819374726, -259.8730040272173, -195.27944377456194, -200.6062734350264, -149.82658277766507, -134.19302569071695, -162.58027544036355, -315.22412765487, -394.3547086890918, 0.8839760864005726, -135.84595050656776, -132.18283296686502, -244.5112994094609, -98.56485378338792, -273.71006840152603, -440.6220616410089, -133.03382453635044, -156.82833937139483, -420.0623943109255, 76.94116132086032, -18.849638791142993, 128.83450288047672, -321.47081826553597], "policy_predator_policy_reward": [293.9217202259615, 292.8086864112879, 517.6640739831588, 422.17308119994624, 192.35235914761708, 365.9397006134676, 231.28031291295108, 669.1604177238781, 300.6586892926819, 292.0729615416576, 401.7574532496733, 419.69443941549025, 409.12665691262333, 163.26834651963338, 388.96337274627615, 409.3372081910348, 448.5100522733646, 343.6381380388061, 230.6447033047046, 494.8894392379038, 413.7536684905414, 197.82314760405382, 492.43245302317524, 292.6687254302411, 261.34482528555003, 460.8657972361207, 545.0571949942002, 314.92179585606493, 500.2217421141261, 578.4035928769757, 151.34837952214326, 282.3995901347883, 302.3566204461932, 217.27296852480538, 434.51009826875196, 511.7905939854945, 380.6646458287628, 579.1137440874078, 250.9726646997542, 379.2342785410134, 415.2725710704352, 390.6234309540363, 373.7265714937134, 522.8367450732153, 453.32230508200075, 338.22840760936674, 380.7502655457708, 292.33823430407944, 480.95269196782584, 378.7390136477634, 433.4700608615047, 367.53940416905056, 431.7762675286081, 348.36503594901717, 498.9337418757194, 346.8623896063643, 275.61294705723736, 352.3721267137582, 329.6960706772664, 525.039277857974, 165.0371194921104, 370.22543343571243, 558.2507546796473, 189.78644845693836, 391.90034331395293, 432.7884316333301, 380.62974227727915, 474.0695805916264, 311.73038667457314, 412.5528787940076, 246.25712721332704, 397.1185415030805, 293.9854264969881, 56.70844860631601, 230.6727512751932, 465.00292329000797, 317.39222075511026, 288.76630513226127, 382.5411896305269, 345.32276123937476, 414.48507434056233, 466.14554575456356, 362.51493255613417, 81.53038485008622, 291.24738702391073, 292.61562091323225, 141.9344270818984, 319.78209237579136, 509.0265954622676, 383.4627311184548, 340.9591440379161, 378.1491492616967, 241.09338947541897, 159.86594567672202, 306.5026484114237, 404.7000425515513, 398.367337736938, 430.1521974007361, 351.75042234581446, 218.58500345532374, 449.08310722925444, 385.72152070834437, 216.86252838760174, 487.8591165165076, 518.6140720374709, 325.32573515005436, 300.51785491447714, 391.61207851529065, 325.21809972130194, 428.41774094571406, 419.76166079355437, 158.52204700536677, 254.2314735049568, 201.95060946463636, 374.2108424089333, 343.4382388130628, 122.6899891067698, 428.41728463297704, 112.27049511002423, 364.2142711113579, 288.068647178931, 235.30728004921406, 356.4787687509193, 102.84213680303726, 163.3236324145379, 264.089511530833, 542.8937212444197, 380.59222903958863, 305.2771661177216, 278.47428062383926, 360.79574380747243, 233.28384071991672, 13.182998217791328, 306.08507137117675, 280.60787847491224, 480.5620734613743, 308.1266418094128, 347.33610904566774, 321.6162329292459, 460.0494748201127, 175.97703244147783, 280.89297242341223, 342.76787223699296, 261.39997505457376, 288.8409812736729, 527.7433044319364, 452.9988385236195, 377.7610441601689, 278.9992013614559, 319.48375132996955, 359.029246903527, 213.76713163868433, 641.1239845870238, 439.72101194215554, 551.7220170124951, 414.0441426332208, 252.76402204130707, 303.07628491318627, 289.1698822336878, 490.15650165528075, 300.65426694137574, 316.8518190015884, 312.077644104957, 163.51409969588656, 337.6771708592875, 157.51524118318017, 271.7336031883049, 93.80721044882473, 608.1799960789053, 562.9200150116613, 284.4748868261464, 317.6120875148785, 490.850421029345, 313.84101382861456, 301.19505534305915, 380.92284394772287, 306.39580414482015, 282.1835409518602, 418.5945581624196, 362.6644659891927, 517.647963360079, 126.61172943243116, 428.09242551293715, 374.2475137222738, 343.8460319045484, 197.63027091607356, 299.27776799673967, 423.5250266098301, 346.16985349226434, 338.84238868512733, 319.5917124188691, 391.7704515664506, 331.76336188225633, 145.48283296686498, 553.1172239524832, 362.9658055227855, 385.68065232644176, 407.79096086083746, 218.61150988229744, 284.51372742609226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.264045207907957, "mean_inference_ms": 6.03555817742425, "mean_action_processing_ms": 2.5589802076883092, "mean_env_wait_ms": 15.611789381957966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004318833351135254, "StateBufferConnector_ms": 0.004918694496154785, "ViewRequirementAgentConnector_ms": 0.13115286827087402}, "num_episodes": 21, "episode_return_max": 684.7161192428201, "episode_return_min": -53.61800590458047, "episode_return_mean": 212.11749312073815, "episodes_this_iter": 21}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.97036606839299, "num_env_steps_trained_throughput_per_sec": 66.97036606839299, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 59708.344, "restore_workers_time_ms": 0.013, "training_step_time_ms": 59708.294, "sample_time_ms": 2128.459, "learn_time_ms": 57563.815, "learn_throughput": 69.488, "synch_weights_time_ms": 13.694}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "training_iteration": 54, "trial_id": "62684_00000", "date": "2024-08-20_17-12-06", "timestamp": 1724154126, "time_this_iter_s": 59.76727771759033, "time_total_s": 3856.075429201126, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffb8310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3856.075429201126, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 24.08452380952381, "ram_util_percent": 80.49047619047617}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.314688608916939, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.45763985079231, "policy_loss": -0.017407080505153903, "vf_loss": 7.472376608172207, "vf_explained_var": 0.5018742724301967, "kl": 0.013351573093946204, "entropy": 0.9285179094853976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 153690.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.175482642839825, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.606220020314373, "policy_loss": -0.0282245858605685, "vf_loss": 8.631409418772137, "vf_explained_var": -0.3484758998035754, "kl": 0.015176032910433908, "entropy": 0.5733210279670342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 1100000, "num_agent_steps_trained": 1100000}, "env_runners": {"episode_reward_max": 684.7161192428201, "episode_reward_min": 1.9872086894081846, "episode_reward_mean": 218.01347132805446, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -663.7195984072588, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 641.1239845870238}, "policy_reward_mean": {"prey_policy": -152.97995645525873, "predator_policy": 338.4766703469155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [293.09348106789446, 222.77600669186612, 174.57216381220417, 56.10411354933076, 221.90852174165056, 425.08215125529404, 252.70173608443483, 73.7347874043037, 291.485871687561, 100.34422676845446, 173.96119194711818, 420.0829137250211, 148.84912593995816, 187.27235107511916, 18.940264011414968, 214.6178705531004, 132.29999999999976, 353.5876846212582, 95.76696270083193, 50.09380683277642, 193.8613037848417, 274.4138208936915, 279.31659081098337, 497.03480068606257, 684.7161192428201, 169.3410067943197, 215.0229089610337, 210.57979942349934, 233.63934027252625, 292.92799852377357, 320.60511524047246, 244.89999999999944, 96.32841530467009, 133.21690981924738, 309.6628897645108, 226.97492493994912, 76.05699423238005, 132.9701000954929, 87.5301808151855, 118.1999999999998, 226.77894235503226, 93.36558122069802, 231.8435596712774, 343.19191780340407, 340.98561620276064, 168.45485535164045, 88.72781264325147, 147.5950604957256, 184.42935042488583, 224.2208695700216, 443.1370039291982, 65.00229119766612, 108.8053807142111, 76.12454706975687, 278.31718283261387, 192.7578862211433, 112.48200613444347, 266.15268890133507, 234.86639165661677, 206.2181028254903, 151.59999999999943, 437.6658418022187, 183.830109017911, 192.5515740836908, 31.139152836093402, 184.77825442986673, 309.9003077837916, 170.21534608232088, 397.14736362910975, 468.5157386950712, 95.83927796185934, 19.532843072234805, 582.558719230543, 414.18539758205026, 462.4975701564894, 208.76903127302208, 26.281430770217206, 170.9044117548485, 177.09049461931613, 73.01481339144209, 182.04548087605934, 1.9872086894081846, 68.7170748963813, 293.5220408258192, 291.63928313218787, 441.01117460288566, 162.27374642204856, 190.6814389723839, 217.00533114435427, 250.23426951796836, 184.66858956015545, 21.641232973749844, 602.1249814555235, 280.94515506100436, 56.81153279882276, 261.3797002439526, 75.33018397745901, 35.05893654574372, 494.84650687349466, 193.37408776772233], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [120.46720037538387, -9.351461007954754, -251.77022795646639, -271.9625797655764, 69.68471491532397, -94.57571742887973, -14.485259269727855, -552.6569732475338, -204.58629592478079, -639.149898538995, -198.41561172317455, -66.1087661046707, -375.53427854101307, -148.77597587334958, 116.01183291524632, -82.155382939358, 139.5558365879308, -438.21430441774964, -469.03989906329343, 192.3152763255589, -367.13695774475855, -395.3941093442854, -262.66662905007206, -59.75518689270649, -238.3866736647068, 192.56925457137368, -335.785209068956, -37.529177002300806, -308.0152239666531, -413.8030778781786, -459.1939249478397, -330.63003063169214, 162.77568249609573, -447.01461846275964, -67.88425320297723, 154.8404819131316, 31.480038117025032, -240.34242772339013, -488.0846159357606, -297.2111606805337, 57.39066100911374, -200.89222302445654, -474.73208845785604, -311.2830390617414, -49.779957004226276, -321.61384511851367, 14.280072067377997, -13.310909323585252, -319.50472328035477, -33.77177019838825, -262.4607096578426, -54.49331510144629, 97.20794703348828, -513.8157222580672, -220.99100921166945, -166.32567140072052, -371.6156795556838, -264.7136493521711, -252.18106160616136, -157.2947476774731, -345.4969734190346, -1.8135655463963616, -102.20382596613487, -285.9854264969885, 9.705372287376335, 200.0, -218.26108206250015, 198.2, -396.29800169171676, -366.30783889716616, 60.70455051827934, 196.47956317757854, 199.1, -435.9478316270812, 193.7, -15.952901090500141, -317.9246584034794, -377.4120538068238, 47.54753520161904, 74.52222171296748, -351.0921653597729, -123.99052230338282, -207.49320894705852, -41.79947726320263, 54.634976191055244, 24.96993699957323, -307.6820923757914, 77.0878129833419, -512.3113144734743, -164.33782656681683, 183.41372669702253, -436.2859337223574, -145.63097103380608, 200.0, -201.4951454755323, -154.56418967660932, -308.6033151386389, -205.60062914485826, -100.67033137480684, -242.12871739418486, -78.53166443938935, -374.642243484852, -18.9720573668429, 40.28351219776732, -281.9839908675521, -105.1989153102576, -386.9630338732307, -115.6677538141613, -476.895216278946, 40.250713856394086, -192.0201482491764, -229.86394818660605, -320.27027424513193, -160.83548466029532, -96.37071376570277, -381.8043562170835, -126.42468263179717, -416.3177409457132, 99.19999999999997, -318.3180997213022, -450.10572192082634, 142.9178498306811, -44.31689335374365, -18.67578817304971, -135.53472055161544, -208.60599302423086, -272.83514153437557, 200.0, -412.9703800163431, -328.78867829086494, -5.481316284973418, 126.35463863949484, 82.0047561522433, -408.503906170865, 191.0, -126.05904591488714, -262.03339463716895, 33.171368675551626, -346.811126082104, -42.1510712970621, 18.369104468460918, -255.95712143468225, 95.00416800077575, -118.86513001573852, -22.121910502210127, -167.6285384585343, -549.3061508983782, -305.06631288444976, 68.61382089369215, -123.07808518077985, 147.6246614859979, -396.24658452782404, 97.67934244363519, -75.24203548037866, 30.575240362968124, -209.59898327389146, -175.89969695914144, -245.20175897001525, -231.26311529291934, -54.278031874898005, -111.39087646237466, -413.6692954480503, -277.95889401848945, 192.8, -418.1896308982531, -184.34579974895937, 0.6238795093067022, -80.39019840409256, -238.0845598364717, -50.12809227335032, -203.4731890473017, -532.9074727885994, -192.5789608936346, 175.0548368779604, 22.635888053053456, -161.73419620675003, -456.79518287347435, -183.37533773772626, -235.54524015852172, 26.655728030312684, -190.85791104540243, -54.34037897753569, -175.99808851927355, -0.8264106074092741, -663.7195984072588, 21.366854287704975, -188.08013093223104, -410.2072638192238, -183.64865587634915, -338.8820469346177, 92.45880101763441, -116.86548695381894, -143.9924477819814, -493.42186184640383, -110.77292142449075, 144.84180543226105, -323.89777477440003, -253.67186217095679, 178.4, 7.930379481616773, -352.021815498669, -302.62098925630653, 26.236233974895352, -48.59231067873295, 76.64987470064233, 159.64823217227408, -204.69155688093787, 45.69674315843711, -89.36649173960137, -658.9145238143317, -118.60420764961954, -111.81636059093945, -275.8271281386059, -490.850421029345, -294.81058264451957, 0.5024118881420596, 190.99999999999994, -402.4850288321554, 111.9258487719162, -45.32243880923451, -246.5859760373506, 117.51446733195537, 18.615988446245446, 121.54766086059733, -458.9251033019653, 124.53746262048688, -51.1278144511894, -508.9003096887851, -246.17633716914014, -425.53111442148673, -104.35105687436791, -285.21030523230337, 174.51141819374726, -259.8730040272173, -195.27944377456194, -200.6062734350264, -149.82658277766507, -134.19302569071695, -162.58027544036355, -315.22412765487, -394.3547086890918, 0.8839760864005726, -135.84595050656776, -132.18283296686502, -244.5112994094609, -98.56485378338792, -273.71006840152603, -440.6220616410089, -133.03382453635044, -156.82833937139483, -420.0623943109255, 76.94116132086032, -18.849638791142993, 128.83450288047672, -321.47081826553597, -7.640647523229295, -260.24943456705944, 132.7493284363485, -227.86738120645458, 73.81543499688908, -362.9224427732894, -430.35010338148976, -358.6163472319058, 35.850225313596404, -36.56176181021737, 79.47739224317438, -285.8188531446928, -33.68175928620953, -449.68573288388916, -63.1515854255411, -230.92100086402144, -102.08014093510029, -139.25726403371064, -96.44729700371289, 2.91315732577765, -148.88451512184582, 107.92126752846198, -493.7401040137036, 179.91267288405155, -127.78245987566567, 30.498534092702478, -82.72290888762438, 49.63571682843153, -373.2180442984725, -521.0040536501324, -196.19594143558595, -106.63106896324217, 143.88469889402674, -151.42448289713673, -160.38603591719797, -305.8843579663245, -127.1361185990231, -232.1529677534665, -174.48435537631477, 53.20627472704039, -457.0271278148917, 137.16451933031243, 184.35749611491832, -401.3881108941786, -384.07312726524077], "policy_predator_policy_reward": [151.34837952214326, 282.3995901347883, 302.3566204461932, 217.27296852480538, 434.51009826875196, 511.7905939854945, 380.6646458287628, 579.1137440874078, 250.9726646997542, 379.2342785410134, 415.2725710704352, 390.6234309540363, 373.7265714937134, 522.8367450732153, 453.32230508200075, 338.22840760936674, 380.7502655457708, 292.33823430407944, 480.95269196782584, 378.7390136477634, 433.4700608615047, 367.53940416905056, 431.7762675286081, 348.36503594901717, 498.9337418757194, 346.8623896063643, 275.61294705723736, 352.3721267137582, 329.6960706772664, 525.039277857974, 165.0371194921104, 370.22543343571243, 558.2507546796473, 189.78644845693836, 391.90034331395293, 432.7884316333301, 380.62974227727915, 474.0695805916264, 311.73038667457314, 412.5528787940076, 246.25712721332704, 397.1185415030805, 293.9854264969881, 56.70844860631601, 230.6727512751932, 465.00292329000797, 317.39222075511026, 288.76630513226127, 382.5411896305269, 345.32276123937476, 414.48507434056233, 466.14554575456356, 362.51493255613417, 81.53038485008622, 291.24738702391073, 292.61562091323225, 141.9344270818984, 319.78209237579136, 509.0265954622676, 383.4627311184548, 340.9591440379161, 378.1491492616967, 241.09338947541897, 159.86594567672202, 306.5026484114237, 404.7000425515513, 398.367337736938, 430.1521974007361, 351.75042234581446, 218.58500345532374, 449.08310722925444, 385.72152070834437, 216.86252838760174, 487.8591165165076, 518.6140720374709, 325.32573515005436, 300.51785491447714, 391.61207851529065, 325.21809972130194, 428.41774094571406, 419.76166079355437, 158.52204700536677, 254.2314735049568, 201.95060946463636, 374.2108424089333, 343.4382388130628, 122.6899891067698, 428.41728463297704, 112.27049511002423, 364.2142711113579, 288.068647178931, 235.30728004921406, 356.4787687509193, 102.84213680303726, 163.3236324145379, 264.089511530833, 542.8937212444197, 380.59222903958863, 305.2771661177216, 278.47428062383926, 360.79574380747243, 233.28384071991672, 13.182998217791328, 306.08507137117675, 280.60787847491224, 480.5620734613743, 308.1266418094128, 347.33610904566774, 321.6162329292459, 460.0494748201127, 175.97703244147783, 280.89297242341223, 342.76787223699296, 261.39997505457376, 288.8409812736729, 527.7433044319364, 452.9988385236195, 377.7610441601689, 278.9992013614559, 319.48375132996955, 359.029246903527, 213.76713163868433, 641.1239845870238, 439.72101194215554, 551.7220170124951, 414.0441426332208, 252.76402204130707, 303.07628491318627, 289.1698822336878, 490.15650165528075, 300.65426694137574, 316.8518190015884, 312.077644104957, 163.51409969588656, 337.6771708592875, 157.51524118318017, 271.7336031883049, 93.80721044882473, 608.1799960789053, 562.9200150116613, 284.4748868261464, 317.6120875148785, 490.850421029345, 313.84101382861456, 301.19505534305915, 380.92284394772287, 306.39580414482015, 282.1835409518602, 418.5945581624196, 362.6644659891927, 517.647963360079, 126.61172943243116, 428.09242551293715, 374.2475137222738, 343.8460319045484, 197.63027091607356, 299.27776799673967, 423.5250266098301, 346.16985349226434, 338.84238868512733, 319.5917124188691, 391.7704515664506, 331.76336188225633, 145.48283296686498, 553.1172239524832, 362.9658055227855, 385.68065232644176, 407.79096086083746, 218.61150988229744, 284.51372742609226, 251.0173656494532, 325.13456260737104, 269.0514524723049, 410.1966829326014, 470.31142640299544, 473.48623786918796, 319.1559228682698, 140.75263098782366, 540.2648253225307, 256.48852179107826, 256.13445226831124, 400.7925431246763, 0.0, 264.05988777353, 394.4171366745122, 413.61400838220106, 282.28159125195305, 178.67039847963574, 519.3798696205238, 382.01804429847266, 184.32607031316823, 235.99594143558593, 324.9667501418381, 368.05831061628066, 353.10461451871777, 215.7277637558297, 312.6057489598357, 448.8970916711982, 396.47919901774065, 397.9986307944842]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.23572040408201, "mean_inference_ms": 5.989062006402612, "mean_action_processing_ms": 2.5124233051827565, "mean_env_wait_ms": 15.559548414117426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004377603530883789, "StateBufferConnector_ms": 0.004698395729064941, "ViewRequirementAgentConnector_ms": 0.13699817657470703}, "num_episodes": 15, "episode_return_max": 684.7161192428201, "episode_return_min": 1.9872086894081846, "episode_return_mean": 218.01347132805446, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1100000, "num_agent_steps_trained": 1100000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.03476912898635, "num_env_steps_trained_throughput_per_sec": 67.03476912898635, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 1100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1100000, "timers": {"training_iteration_time_ms": 59752.095, "restore_workers_time_ms": 0.013, "training_step_time_ms": 59752.043, "sample_time_ms": 2169.934, "learn_time_ms": 57565.762, "learn_throughput": 69.486, "synch_weights_time_ms": 13.999}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 1100000, "num_agent_steps_trained": 1100000}, "done": false, "training_iteration": 55, "trial_id": "62684_00000", "date": "2024-08-20_17-13-05", "timestamp": 1724154185, "time_this_iter_s": 59.715269804000854, "time_total_s": 3915.790699005127, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3acada3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3915.790699005127, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 24.277380952380952, "ram_util_percent": 80.59761904761903}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.328420514333333, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.385371550938761, "policy_loss": -0.022421245507116543, "vf_loss": 7.404951255879504, "vf_explained_var": 0.4554358963425278, "kl": 0.014207670387336389, "entropy": 0.903642151076743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 156510.5, "diff_num_grad_updates_vs_sampler_policy": 1487.7550000000044}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.122143756586407, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.566722504802481, "policy_loss": -0.028923325000389938, "vf_loss": 8.592689090557199, "vf_explained_var": -0.2554307538365561, "kl": 0.01478368279772993, "entropy": 0.5442949782761316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 996.9474999999948}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 684.7161192428201, "episode_reward_min": 1.9872086894081846, "episode_reward_mean": 219.53180814888864, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -663.7195984072588, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 641.1239845870238}, "policy_reward_mean": {"prey_policy": -146.59794365821182, "predator_policy": 329.66281956176215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [274.4138208936915, 279.31659081098337, 497.03480068606257, 684.7161192428201, 169.3410067943197, 215.0229089610337, 210.57979942349934, 233.63934027252625, 292.92799852377357, 320.60511524047246, 244.89999999999944, 96.32841530467009, 133.21690981924738, 309.6628897645108, 226.97492493994912, 76.05699423238005, 132.9701000954929, 87.5301808151855, 118.1999999999998, 226.77894235503226, 93.36558122069802, 231.8435596712774, 343.19191780340407, 340.98561620276064, 168.45485535164045, 88.72781264325147, 147.5950604957256, 184.42935042488583, 224.2208695700216, 443.1370039291982, 65.00229119766612, 108.8053807142111, 76.12454706975687, 278.31718283261387, 192.7578862211433, 112.48200613444347, 266.15268890133507, 234.86639165661677, 206.2181028254903, 151.59999999999943, 437.6658418022187, 183.830109017911, 192.5515740836908, 31.139152836093402, 184.77825442986673, 309.9003077837916, 170.21534608232088, 397.14736362910975, 468.5157386950712, 95.83927796185934, 19.532843072234805, 582.558719230543, 414.18539758205026, 462.4975701564894, 208.76903127302208, 26.281430770217206, 170.9044117548485, 177.09049461931613, 73.01481339144209, 182.04548087605934, 1.9872086894081846, 68.7170748963813, 293.5220408258192, 291.63928313218787, 441.01117460288566, 162.27374642204856, 190.6814389723839, 217.00533114435427, 250.23426951796836, 184.66858956015545, 21.641232973749844, 602.1249814555235, 280.94515506100436, 56.81153279882276, 261.3797002439526, 75.33018397745901, 35.05893654574372, 494.84650687349466, 193.37408776772233, 133.07084359228844, 110.14463773439459, 169.69400154683132, 278.48826094257856, 107.5666895123155, 202.45635044265805, 77.42142553432184, 332.30824544812987, 191.91997789390712, 43.48220284031382, 442.9987523329002, 133.773103485499, 196.00608052083206, 34.53571331843847, 131.01102804512078, 296.2970811042041, 154.45051874592906, 408.0734524686448, 442.02153861794284, 188.04431971094175, 179.20599349966224], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-285.9854264969885, 9.705372287376335, 200.0, -218.26108206250015, 198.2, -396.29800169171676, -366.30783889716616, 60.70455051827934, 196.47956317757854, 199.1, -435.9478316270812, 193.7, -15.952901090500141, -317.9246584034794, -377.4120538068238, 47.54753520161904, 74.52222171296748, -351.0921653597729, -123.99052230338282, -207.49320894705852, -41.79947726320263, 54.634976191055244, 24.96993699957323, -307.6820923757914, 77.0878129833419, -512.3113144734743, -164.33782656681683, 183.41372669702253, -436.2859337223574, -145.63097103380608, 200.0, -201.4951454755323, -154.56418967660932, -308.6033151386389, -205.60062914485826, -100.67033137480684, -242.12871739418486, -78.53166443938935, -374.642243484852, -18.9720573668429, 40.28351219776732, -281.9839908675521, -105.1989153102576, -386.9630338732307, -115.6677538141613, -476.895216278946, 40.250713856394086, -192.0201482491764, -229.86394818660605, -320.27027424513193, -160.83548466029532, -96.37071376570277, -381.8043562170835, -126.42468263179717, -416.3177409457132, 99.19999999999997, -318.3180997213022, -450.10572192082634, 142.9178498306811, -44.31689335374365, -18.67578817304971, -135.53472055161544, -208.60599302423086, -272.83514153437557, 200.0, -412.9703800163431, -328.78867829086494, -5.481316284973418, 126.35463863949484, 82.0047561522433, -408.503906170865, 191.0, -126.05904591488714, -262.03339463716895, 33.171368675551626, -346.811126082104, -42.1510712970621, 18.369104468460918, -255.95712143468225, 95.00416800077575, -118.86513001573852, -22.121910502210127, -167.6285384585343, -549.3061508983782, -305.06631288444976, 68.61382089369215, -123.07808518077985, 147.6246614859979, -396.24658452782404, 97.67934244363519, -75.24203548037866, 30.575240362968124, -209.59898327389146, -175.89969695914144, -245.20175897001525, -231.26311529291934, -54.278031874898005, -111.39087646237466, -413.6692954480503, -277.95889401848945, 192.8, -418.1896308982531, -184.34579974895937, 0.6238795093067022, -80.39019840409256, -238.0845598364717, -50.12809227335032, -203.4731890473017, -532.9074727885994, -192.5789608936346, 175.0548368779604, 22.635888053053456, -161.73419620675003, -456.79518287347435, -183.37533773772626, -235.54524015852172, 26.655728030312684, -190.85791104540243, -54.34037897753569, -175.99808851927355, -0.8264106074092741, -663.7195984072588, 21.366854287704975, -188.08013093223104, -410.2072638192238, -183.64865587634915, -338.8820469346177, 92.45880101763441, -116.86548695381894, -143.9924477819814, -493.42186184640383, -110.77292142449075, 144.84180543226105, -323.89777477440003, -253.67186217095679, 178.4, 7.930379481616773, -352.021815498669, -302.62098925630653, 26.236233974895352, -48.59231067873295, 76.64987470064233, 159.64823217227408, -204.69155688093787, 45.69674315843711, -89.36649173960137, -658.9145238143317, -118.60420764961954, -111.81636059093945, -275.8271281386059, -490.850421029345, -294.81058264451957, 0.5024118881420596, 190.99999999999994, -402.4850288321554, 111.9258487719162, -45.32243880923451, -246.5859760373506, 117.51446733195537, 18.615988446245446, 121.54766086059733, -458.9251033019653, 124.53746262048688, -51.1278144511894, -508.9003096887851, -246.17633716914014, -425.53111442148673, -104.35105687436791, -285.21030523230337, 174.51141819374726, -259.8730040272173, -195.27944377456194, -200.6062734350264, -149.82658277766507, -134.19302569071695, -162.58027544036355, -315.22412765487, -394.3547086890918, 0.8839760864005726, -135.84595050656776, -132.18283296686502, -244.5112994094609, -98.56485378338792, -273.71006840152603, -440.6220616410089, -133.03382453635044, -156.82833937139483, -420.0623943109255, 76.94116132086032, -18.849638791142993, 128.83450288047672, -321.47081826553597, -7.640647523229295, -260.24943456705944, 132.7493284363485, -227.86738120645458, 73.81543499688908, -362.9224427732894, -430.35010338148976, -358.6163472319058, 35.850225313596404, -36.56176181021737, 79.47739224317438, -285.8188531446928, -33.68175928620953, -449.68573288388916, -63.1515854255411, -230.92100086402144, -102.08014093510029, -139.25726403371064, -96.44729700371289, 2.91315732577765, -148.88451512184582, 107.92126752846198, -493.7401040137036, 179.91267288405155, -127.78245987566567, 30.498534092702478, -82.72290888762438, 49.63571682843153, -373.2180442984725, -521.0040536501324, -196.19594143558595, -106.63106896324217, 143.88469889402674, -151.42448289713673, -160.38603591719797, -305.8843579663245, -127.1361185990231, -232.1529677534665, -174.48435537631477, 53.20627472704039, -457.0271278148917, 137.16451933031243, 184.35749611491832, -401.3881108941786, -384.07312726524077, 11.72609969072736, -199.02446035783765, -86.17186247546506, -159.89695452510392, -289.4789257014521, -190.14734878220258, -521.6384508966587, -43.78058192309559, -163.9739394092064, 60.056922970108815, -477.93559794050924, -208.7067702642067, -421.8093888980578, 106.39999999999998, -431.39024070064926, 75.24282371991052, -176.89204902055974, -324.28204153185936, -33.124479801680586, -87.373207148308, -287.6260100942855, 126.13560821320007, -426.66071029739527, 79.0430328008151, -224.76879055837324, 32.51422789000074, -159.16318230464015, -464.89574380649094, 20.000000000000014, -243.90622786164323, -39.20776696586813, -300.86819544096534, -42.51226203479766, -372.4086637912578, -163.93082634542438, 110.89999999999998, 111.973868236714, -295.2370096592138, -398.3041126806333, -347.35773734849954, -171.63185173448056, -7.9502083160077675, 3.846543341926041, -479.71090028761193, -23.549284872248613, -387.26080381852483, -88.5989072579014, 131.0939663505556, 62.50114464051638, -326.6305269499292, -222.67702089247123, 85.69999999999997, -61.545930949870005, -586.2305168866585, -346.9063357767724, 76.16649893396985, 190.06561315064073, -76.1241478067644, -132.47300076682882, -129.90397766118116, -57.636398100681355, 64.15603070224907, -406.9465867779586], "policy_predator_policy_reward": [293.9854264969881, 56.70844860631601, 230.6727512751932, 465.00292329000797, 317.39222075511026, 288.76630513226127, 382.5411896305269, 345.32276123937476, 414.48507434056233, 466.14554575456356, 362.51493255613417, 81.53038485008622, 291.24738702391073, 292.61562091323225, 141.9344270818984, 319.78209237579136, 509.0265954622676, 383.4627311184548, 340.9591440379161, 378.1491492616967, 241.09338947541897, 159.86594567672202, 306.5026484114237, 404.7000425515513, 398.367337736938, 430.1521974007361, 351.75042234581446, 218.58500345532374, 449.08310722925444, 385.72152070834437, 216.86252838760174, 487.8591165165076, 518.6140720374709, 325.32573515005436, 300.51785491447714, 391.61207851529065, 325.21809972130194, 428.41774094571406, 419.76166079355437, 158.52204700536677, 254.2314735049568, 201.95060946463636, 374.2108424089333, 343.4382388130628, 122.6899891067698, 428.41728463297704, 112.27049511002423, 364.2142711113579, 288.068647178931, 235.30728004921406, 356.4787687509193, 102.84213680303726, 163.3236324145379, 264.089511530833, 542.8937212444197, 380.59222903958863, 305.2771661177216, 278.47428062383926, 360.79574380747243, 233.28384071991672, 13.182998217791328, 306.08507137117675, 280.60787847491224, 480.5620734613743, 308.1266418094128, 347.33610904566774, 321.6162329292459, 460.0494748201127, 175.97703244147783, 280.89297242341223, 342.76787223699296, 261.39997505457376, 288.8409812736729, 527.7433044319364, 452.9988385236195, 377.7610441601689, 278.9992013614559, 319.48375132996955, 359.029246903527, 213.76713163868433, 641.1239845870238, 439.72101194215554, 551.7220170124951, 414.0441426332208, 252.76402204130707, 303.07628491318627, 289.1698822336878, 490.15650165528075, 300.65426694137574, 316.8518190015884, 312.077644104957, 163.51409969588656, 337.6771708592875, 157.51524118318017, 271.7336031883049, 93.80721044882473, 608.1799960789053, 562.9200150116613, 284.4748868261464, 317.6120875148785, 490.850421029345, 313.84101382861456, 301.19505534305915, 380.92284394772287, 306.39580414482015, 282.1835409518602, 418.5945581624196, 362.6644659891927, 517.647963360079, 126.61172943243116, 428.09242551293715, 374.2475137222738, 343.8460319045484, 197.63027091607356, 299.27776799673967, 423.5250266098301, 346.16985349226434, 338.84238868512733, 319.5917124188691, 391.7704515664506, 331.76336188225633, 145.48283296686498, 553.1172239524832, 362.9658055227855, 385.68065232644176, 407.79096086083746, 218.61150988229744, 284.51372742609226, 251.0173656494532, 325.13456260737104, 269.0514524723049, 410.1966829326014, 470.31142640299544, 473.48623786918796, 319.1559228682698, 140.75263098782366, 540.2648253225307, 256.48852179107826, 256.13445226831124, 400.7925431246763, 0.0, 264.05988777353, 394.4171366745122, 413.61400838220106, 282.28159125195305, 178.67039847963574, 519.3798696205238, 382.01804429847266, 184.32607031316823, 235.99594143558593, 324.9667501418381, 368.05831061628066, 353.10461451871777, 215.7277637558297, 312.6057489598357, 448.8970916711982, 396.47919901774065, 397.9986307944842, 158.85048250201754, 247.69058423284704, 295.67892570145176, 453.98894104170074, 323.73148617037157, 575.3554876054206, 411.5428590390829, 493.5308471381042, 422.40938889805795, 431.95693021296483, 264.66893275486166, 363.7186845203058, 215.2850673249138, 270.2600552536851, 408.6882477922434, 145.1020669392661, 341.65056890756364, 201.68715395935632, 366.24332225689466, 366.04085225155296, 474.90996600111686, 350.6770107734142, 221.52148576514668, 337.69110785703486, 389.9777095501196, 387.59562507384527, 181.93185173448, 379.5436589829458, 524.1965702665942, 106.22809959646227, 323.65135194633376, 317.4114738837405, 393.35446927270567, 247.90245267510915, 488.9051112909014, 481.24478901427216, 218.68491864274617, 304.01084366736, 304.1544353638321, 222.39101058188436, 302.7497183146167, 276.8832293614368]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.159964959067517, "mean_inference_ms": 5.941773876167538, "mean_action_processing_ms": 2.4979710770557144, "mean_env_wait_ms": 15.419408229993762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004545450210571289, "StateBufferConnector_ms": 0.004788398742675781, "ViewRequirementAgentConnector_ms": 0.16752827167510986}, "num_episodes": 21, "episode_return_max": 684.7161192428201, "episode_return_min": 1.9872086894081846, "episode_return_mean": 219.53180814888864, "episodes_this_iter": 21}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.2586662679974, "num_env_steps_trained_throughput_per_sec": 67.2586662679974, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 59698.529, "restore_workers_time_ms": 0.014, "training_step_time_ms": 59698.476, "sample_time_ms": 2180.682, "learn_time_ms": 57500.601, "learn_throughput": 69.564, "synch_weights_time_ms": 14.723}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 56, "trial_id": "62684_00000", "date": "2024-08-20_17-14-05", "timestamp": 1724154245, "time_this_iter_s": 59.49953269958496, "time_total_s": 3975.290231704712, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffb83a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3975.290231704712, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 24.123809523809523, "ram_util_percent": 80.99523809523808}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.130841023786694, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.157681531770855, "policy_loss": -0.019180019084877726, "vf_loss": 7.174273065810508, "vf_explained_var": 0.5070944169100294, "kl": 0.012942406264668766, "entropy": 0.9441555373000761, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 159330.5, "diff_num_grad_updates_vs_sampler_policy": 1448.2749999999942}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.800202014458874, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.927026322531321, "policy_loss": -0.027161828216002694, "vf_loss": 7.951098473362191, "vf_explained_var": -0.16506192949083115, "kl": 0.015448411517387265, "entropy": 0.5668659379557958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "env_runners": {"episode_reward_max": 602.1249814555235, "episode_reward_min": 1.9872086894081846, "episode_reward_mean": 211.38056339127309, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -663.7195984072588, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 641.1239845870238}, "policy_reward_mean": {"prey_policy": -145.67835771437845, "predator_policy": 324.2078182672044}, "custom_metrics": {}, "hist_stats": {"episode_reward": [93.36558122069802, 231.8435596712774, 343.19191780340407, 340.98561620276064, 168.45485535164045, 88.72781264325147, 147.5950604957256, 184.42935042488583, 224.2208695700216, 443.1370039291982, 65.00229119766612, 108.8053807142111, 76.12454706975687, 278.31718283261387, 192.7578862211433, 112.48200613444347, 266.15268890133507, 234.86639165661677, 206.2181028254903, 151.59999999999943, 437.6658418022187, 183.830109017911, 192.5515740836908, 31.139152836093402, 184.77825442986673, 309.9003077837916, 170.21534608232088, 397.14736362910975, 468.5157386950712, 95.83927796185934, 19.532843072234805, 582.558719230543, 414.18539758205026, 462.4975701564894, 208.76903127302208, 26.281430770217206, 170.9044117548485, 177.09049461931613, 73.01481339144209, 182.04548087605934, 1.9872086894081846, 68.7170748963813, 293.5220408258192, 291.63928313218787, 441.01117460288566, 162.27374642204856, 190.6814389723839, 217.00533114435427, 250.23426951796836, 184.66858956015545, 21.641232973749844, 602.1249814555235, 280.94515506100436, 56.81153279882276, 261.3797002439526, 75.33018397745901, 35.05893654574372, 494.84650687349466, 193.37408776772233, 133.07084359228844, 110.14463773439459, 169.69400154683132, 278.48826094257856, 107.5666895123155, 202.45635044265805, 77.42142553432184, 332.30824544812987, 191.91997789390712, 43.48220284031382, 442.9987523329002, 133.773103485499, 196.00608052083206, 34.53571331843847, 131.01102804512078, 296.2970811042041, 154.45051874592906, 408.0734524686448, 442.02153861794284, 188.04431971094175, 179.20599349966224, 88.29999999999914, 173.7913321509393, 181.9012383815168, 112.3318081273725, 295.25174409816884, 116.56361847605243, 269.67906204532557, 135.22249328790093, 234.69826390116668, 205.6904580278337, 35.48313284214017, 181.58685107578793, 69.84931994183201, 262.7522821108086, 294.295698447413, 250.6189165899407, 147.7984614917724, 532.1057364173745, 230.7925028575873, 196.37946214315812], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.67578817304971, -135.53472055161544, -208.60599302423086, -272.83514153437557, 200.0, -412.9703800163431, -328.78867829086494, -5.481316284973418, 126.35463863949484, 82.0047561522433, -408.503906170865, 191.0, -126.05904591488714, -262.03339463716895, 33.171368675551626, -346.811126082104, -42.1510712970621, 18.369104468460918, -255.95712143468225, 95.00416800077575, -118.86513001573852, -22.121910502210127, -167.6285384585343, -549.3061508983782, -305.06631288444976, 68.61382089369215, -123.07808518077985, 147.6246614859979, -396.24658452782404, 97.67934244363519, -75.24203548037866, 30.575240362968124, -209.59898327389146, -175.89969695914144, -245.20175897001525, -231.26311529291934, -54.278031874898005, -111.39087646237466, -413.6692954480503, -277.95889401848945, 192.8, -418.1896308982531, -184.34579974895937, 0.6238795093067022, -80.39019840409256, -238.0845598364717, -50.12809227335032, -203.4731890473017, -532.9074727885994, -192.5789608936346, 175.0548368779604, 22.635888053053456, -161.73419620675003, -456.79518287347435, -183.37533773772626, -235.54524015852172, 26.655728030312684, -190.85791104540243, -54.34037897753569, -175.99808851927355, -0.8264106074092741, -663.7195984072588, 21.366854287704975, -188.08013093223104, -410.2072638192238, -183.64865587634915, -338.8820469346177, 92.45880101763441, -116.86548695381894, -143.9924477819814, -493.42186184640383, -110.77292142449075, 144.84180543226105, -323.89777477440003, -253.67186217095679, 178.4, 7.930379481616773, -352.021815498669, -302.62098925630653, 26.236233974895352, -48.59231067873295, 76.64987470064233, 159.64823217227408, -204.69155688093787, 45.69674315843711, -89.36649173960137, -658.9145238143317, -118.60420764961954, -111.81636059093945, -275.8271281386059, -490.850421029345, -294.81058264451957, 0.5024118881420596, 190.99999999999994, -402.4850288321554, 111.9258487719162, -45.32243880923451, -246.5859760373506, 117.51446733195537, 18.615988446245446, 121.54766086059733, -458.9251033019653, 124.53746262048688, -51.1278144511894, -508.9003096887851, -246.17633716914014, -425.53111442148673, -104.35105687436791, -285.21030523230337, 174.51141819374726, -259.8730040272173, -195.27944377456194, -200.6062734350264, -149.82658277766507, -134.19302569071695, -162.58027544036355, -315.22412765487, -394.3547086890918, 0.8839760864005726, -135.84595050656776, -132.18283296686502, -244.5112994094609, -98.56485378338792, -273.71006840152603, -440.6220616410089, -133.03382453635044, -156.82833937139483, -420.0623943109255, 76.94116132086032, -18.849638791142993, 128.83450288047672, -321.47081826553597, -7.640647523229295, -260.24943456705944, 132.7493284363485, -227.86738120645458, 73.81543499688908, -362.9224427732894, -430.35010338148976, -358.6163472319058, 35.850225313596404, -36.56176181021737, 79.47739224317438, -285.8188531446928, -33.68175928620953, -449.68573288388916, -63.1515854255411, -230.92100086402144, -102.08014093510029, -139.25726403371064, -96.44729700371289, 2.91315732577765, -148.88451512184582, 107.92126752846198, -493.7401040137036, 179.91267288405155, -127.78245987566567, 30.498534092702478, -82.72290888762438, 49.63571682843153, -373.2180442984725, -521.0040536501324, -196.19594143558595, -106.63106896324217, 143.88469889402674, -151.42448289713673, -160.38603591719797, -305.8843579663245, -127.1361185990231, -232.1529677534665, -174.48435537631477, 53.20627472704039, -457.0271278148917, 137.16451933031243, 184.35749611491832, -401.3881108941786, -384.07312726524077, 11.72609969072736, -199.02446035783765, -86.17186247546506, -159.89695452510392, -289.4789257014521, -190.14734878220258, -521.6384508966587, -43.78058192309559, -163.9739394092064, 60.056922970108815, -477.93559794050924, -208.7067702642067, -421.8093888980578, 106.39999999999998, -431.39024070064926, 75.24282371991052, -176.89204902055974, -324.28204153185936, -33.124479801680586, -87.373207148308, -287.6260100942855, 126.13560821320007, -426.66071029739527, 79.0430328008151, -224.76879055837324, 32.51422789000074, -159.16318230464015, -464.89574380649094, 20.000000000000014, -243.90622786164323, -39.20776696586813, -300.86819544096534, -42.51226203479766, -372.4086637912578, -163.93082634542438, 110.89999999999998, 111.973868236714, -295.2370096592138, -398.3041126806333, -347.35773734849954, -171.63185173448056, -7.9502083160077675, 3.846543341926041, -479.71090028761193, -23.549284872248613, -387.26080381852483, -88.5989072579014, 131.0939663505556, 62.50114464051638, -326.6305269499292, -222.67702089247123, 85.69999999999997, -61.545930949870005, -586.2305168866585, -346.9063357767724, 76.16649893396985, 190.06561315064073, -76.1241478067644, -132.47300076682882, -129.90397766118116, -57.636398100681355, 64.15603070224907, -406.9465867779586, -321.3093997024437, -353.19396481245195, -68.66526279147541, -143.03049180171374, -215.72584972166678, 17.910221333742903, 108.69657189124366, -357.7414254600154, -16.011595425840643, -121.60572419767834, -330.85494975584714, -72.55129384673201, -182.20129722820423, -197.6421851078675, -15.531794631252815, -78.7625401241958, -183.20088704605996, -232.31036020883047, 94.55305225168388, 54.45694406401155, -350.5034280495777, -186.40116153482728, 90.28072857420239, -231.8946165220408, -139.97986954745045, -67.07159028205422, 124.54368661175049, -117.95149411661555, -417.4945053378235, -155.2422725095025, -323.053166844958, 27.572202693778195, -302.1911149955394, -470.56393462244, -11.667249593079227, -126.12621842221506, -25.262803557455573, -62.85699198047945, -574.4627423675703, 1.3951744859306217, -38.399343830851606, -289.99490379137706, -365.1926491621681, 139.76256370366485, -130.0710946317551, -171.81549379548963, 0.8134391671086476, -59.37262943135761, -219.31288219573895, -335.45269122215507, 77.85439634723377, -418.8576029966119, 64.75493912700902, 173.18049498221376, -98.82030425455656, -55.38417423322195, -89.54579341893832, 109.51742372391388, -175.8376199683813, -358.85749273447937], "policy_predator_policy_reward": [254.2314735049568, 201.95060946463636, 374.2108424089333, 343.4382388130628, 122.6899891067698, 428.41728463297704, 112.27049511002423, 364.2142711113579, 288.068647178931, 235.30728004921406, 356.4787687509193, 102.84213680303726, 163.3236324145379, 264.089511530833, 542.8937212444197, 380.59222903958863, 305.2771661177216, 278.47428062383926, 360.79574380747243, 233.28384071991672, 13.182998217791328, 306.08507137117675, 280.60787847491224, 480.5620734613743, 308.1266418094128, 347.33610904566774, 321.6162329292459, 460.0494748201127, 175.97703244147783, 280.89297242341223, 342.76787223699296, 261.39997505457376, 288.8409812736729, 527.7433044319364, 452.9988385236195, 377.7610441601689, 278.9992013614559, 319.48375132996955, 359.029246903527, 213.76713163868433, 641.1239845870238, 439.72101194215554, 551.7220170124951, 414.0441426332208, 252.76402204130707, 303.07628491318627, 289.1698822336878, 490.15650165528075, 300.65426694137574, 316.8518190015884, 312.077644104957, 163.51409969588656, 337.6771708592875, 157.51524118318017, 271.7336031883049, 93.80721044882473, 608.1799960789053, 562.9200150116613, 284.4748868261464, 317.6120875148785, 490.850421029345, 313.84101382861456, 301.19505534305915, 380.92284394772287, 306.39580414482015, 282.1835409518602, 418.5945581624196, 362.6644659891927, 517.647963360079, 126.61172943243116, 428.09242551293715, 374.2475137222738, 343.8460319045484, 197.63027091607356, 299.27776799673967, 423.5250266098301, 346.16985349226434, 338.84238868512733, 319.5917124188691, 391.7704515664506, 331.76336188225633, 145.48283296686498, 553.1172239524832, 362.9658055227855, 385.68065232644176, 407.79096086083746, 218.61150988229744, 284.51372742609226, 251.0173656494532, 325.13456260737104, 269.0514524723049, 410.1966829326014, 470.31142640299544, 473.48623786918796, 319.1559228682698, 140.75263098782366, 540.2648253225307, 256.48852179107826, 256.13445226831124, 400.7925431246763, 0.0, 264.05988777353, 394.4171366745122, 413.61400838220106, 282.28159125195305, 178.67039847963574, 519.3798696205238, 382.01804429847266, 184.32607031316823, 235.99594143558593, 324.9667501418381, 368.05831061628066, 353.10461451871777, 215.7277637558297, 312.6057489598357, 448.8970916711982, 396.47919901774065, 397.9986307944842, 158.85048250201754, 247.69058423284704, 295.67892570145176, 453.98894104170074, 323.73148617037157, 575.3554876054206, 411.5428590390829, 493.5308471381042, 422.40938889805795, 431.95693021296483, 264.66893275486166, 363.7186845203058, 215.2850673249138, 270.2600552536851, 408.6882477922434, 145.1020669392661, 341.65056890756364, 201.68715395935632, 366.24332225689466, 366.04085225155296, 474.90996600111686, 350.6770107734142, 221.52148576514668, 337.69110785703486, 389.9777095501196, 387.59562507384527, 181.93185173448, 379.5436589829458, 524.1965702665942, 106.22809959646227, 323.65135194633376, 317.4114738837405, 393.35446927270567, 247.90245267510915, 488.9051112909014, 481.24478901427216, 218.68491864274617, 304.01084366736, 304.1544353638321, 222.39101058188436, 302.7497183146167, 276.8832293614368, 506.359227603927, 325.10939970244414, 244.23049180171407, 270.4069605388638, 366.8414254600149, 80.11626191611454, 254.95432387866643, 382.38945204896413, 428.7827759883978, 261.84424507709747, 191.68546399401112, 419.1519418611286, 115.16906572963018, 356.00342804957893, 245.00204112808535, 218.23550164248095, 226.284806293484, 90.92123082543694, 467.33647640433605, 429.04225358743764, 371.4518313330238, 261.70338065583684, 382.7235577181691, 407.2206959953529, 574.6627423675703, 157.76911547976692, 238.30372367296118, 351.44763157414553, 304.26242736984386, 345.5344511678269, 203.81667092856895, 277.1769297211099, 235.20725701039063, 389.5023815520427, 330.2369165958814, 382.79098870888123, 245.05562809540672, 229.4871466688971, 291.68398648115385, 329.8731646409506]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.094194626344521, "mean_inference_ms": 5.890043799125664, "mean_action_processing_ms": 2.4851929020986163, "mean_env_wait_ms": 15.293529190552611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045233964920043945, "StateBufferConnector_ms": 0.004660487174987793, "ViewRequirementAgentConnector_ms": 0.16387057304382324}, "num_episodes": 20, "episode_return_max": 602.1249814555235, "episode_return_min": 1.9872086894081846, "episode_return_mean": 211.38056339127309, "episodes_this_iter": 20}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.04068014218004, "num_env_steps_trained_throughput_per_sec": 67.04068014218004, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 1140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 59718.247, "restore_workers_time_ms": 0.014, "training_step_time_ms": 59718.194, "sample_time_ms": 2203.102, "learn_time_ms": 57497.999, "learn_throughput": 69.568, "synch_weights_time_ms": 14.589}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "training_iteration": 57, "trial_id": "62684_00000", "date": "2024-08-20_17-15-05", "timestamp": 1724154305, "time_this_iter_s": 59.71732711791992, "time_total_s": 4035.007558822632, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3acae6d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4035.007558822632, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 24.66235294117648, "ram_util_percent": 80.94117647058822}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.285291903661498, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.946622547359332, "policy_loss": -0.02044127138310066, "vf_loss": 6.964710160857397, "vf_explained_var": 0.5010298603181298, "kl": 0.011768247323533428, "entropy": 0.930630498701799, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 162150.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.252492468066947, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.118520504835422, "policy_loss": -0.026553965115577238, "vf_loss": 8.142298036151463, "vf_explained_var": -0.12097554254153418, "kl": 0.013882320159405628, "entropy": 0.603787579817116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "env_runners": {"episode_reward_max": 602.1249814555235, "episode_reward_min": 1.9872086894081846, "episode_reward_mean": 212.08020737419244, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -663.7195984072588, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.99999999999994, "predator_policy": 641.1239845870238}, "policy_reward_mean": {"prey_policy": -149.2701468707736, "predator_policy": 329.94532399325675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [234.86639165661677, 206.2181028254903, 151.59999999999943, 437.6658418022187, 183.830109017911, 192.5515740836908, 31.139152836093402, 184.77825442986673, 309.9003077837916, 170.21534608232088, 397.14736362910975, 468.5157386950712, 95.83927796185934, 19.532843072234805, 582.558719230543, 414.18539758205026, 462.4975701564894, 208.76903127302208, 26.281430770217206, 170.9044117548485, 177.09049461931613, 73.01481339144209, 182.04548087605934, 1.9872086894081846, 68.7170748963813, 293.5220408258192, 291.63928313218787, 441.01117460288566, 162.27374642204856, 190.6814389723839, 217.00533114435427, 250.23426951796836, 184.66858956015545, 21.641232973749844, 602.1249814555235, 280.94515506100436, 56.81153279882276, 261.3797002439526, 75.33018397745901, 35.05893654574372, 494.84650687349466, 193.37408776772233, 133.07084359228844, 110.14463773439459, 169.69400154683132, 278.48826094257856, 107.5666895123155, 202.45635044265805, 77.42142553432184, 332.30824544812987, 191.91997789390712, 43.48220284031382, 442.9987523329002, 133.773103485499, 196.00608052083206, 34.53571331843847, 131.01102804512078, 296.2970811042041, 154.45051874592906, 408.0734524686448, 442.02153861794284, 188.04431971094175, 179.20599349966224, 88.29999999999914, 173.7913321509393, 181.9012383815168, 112.3318081273725, 295.25174409816884, 116.56361847605243, 269.67906204532557, 135.22249328790093, 234.69826390116668, 205.6904580278337, 35.48313284214017, 181.58685107578793, 69.84931994183201, 262.7522821108086, 294.295698447413, 250.6189165899407, 147.7984614917724, 532.1057364173745, 230.7925028575873, 196.37946214315812, 140.544854173718, 13.52969421210344, 421.24988152040976, 274.2309352131775, 177.3980306473103, 133.4532021319625, 173.69851943482072, 167.38009629483568, 154.23429155856755, 106.2158561650171, 207.2038681090065, 115.16904015336928, 201.91278317692166, 363.0854422289946, 342.934061028582, 176.69846603453144, 266.61898659264045], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [22.635888053053456, -161.73419620675003, -456.79518287347435, -183.37533773772626, -235.54524015852172, 26.655728030312684, -190.85791104540243, -54.34037897753569, -175.99808851927355, -0.8264106074092741, -663.7195984072588, 21.366854287704975, -188.08013093223104, -410.2072638192238, -183.64865587634915, -338.8820469346177, 92.45880101763441, -116.86548695381894, -143.9924477819814, -493.42186184640383, -110.77292142449075, 144.84180543226105, -323.89777477440003, -253.67186217095679, 178.4, 7.930379481616773, -352.021815498669, -302.62098925630653, 26.236233974895352, -48.59231067873295, 76.64987470064233, 159.64823217227408, -204.69155688093787, 45.69674315843711, -89.36649173960137, -658.9145238143317, -118.60420764961954, -111.81636059093945, -275.8271281386059, -490.850421029345, -294.81058264451957, 0.5024118881420596, 190.99999999999994, -402.4850288321554, 111.9258487719162, -45.32243880923451, -246.5859760373506, 117.51446733195537, 18.615988446245446, 121.54766086059733, -458.9251033019653, 124.53746262048688, -51.1278144511894, -508.9003096887851, -246.17633716914014, -425.53111442148673, -104.35105687436791, -285.21030523230337, 174.51141819374726, -259.8730040272173, -195.27944377456194, -200.6062734350264, -149.82658277766507, -134.19302569071695, -162.58027544036355, -315.22412765487, -394.3547086890918, 0.8839760864005726, -135.84595050656776, -132.18283296686502, -244.5112994094609, -98.56485378338792, -273.71006840152603, -440.6220616410089, -133.03382453635044, -156.82833937139483, -420.0623943109255, 76.94116132086032, -18.849638791142993, 128.83450288047672, -321.47081826553597, -7.640647523229295, -260.24943456705944, 132.7493284363485, -227.86738120645458, 73.81543499688908, -362.9224427732894, -430.35010338148976, -358.6163472319058, 35.850225313596404, -36.56176181021737, 79.47739224317438, -285.8188531446928, -33.68175928620953, -449.68573288388916, -63.1515854255411, -230.92100086402144, -102.08014093510029, -139.25726403371064, -96.44729700371289, 2.91315732577765, -148.88451512184582, 107.92126752846198, -493.7401040137036, 179.91267288405155, -127.78245987566567, 30.498534092702478, -82.72290888762438, 49.63571682843153, -373.2180442984725, -521.0040536501324, -196.19594143558595, -106.63106896324217, 143.88469889402674, -151.42448289713673, -160.38603591719797, -305.8843579663245, -127.1361185990231, -232.1529677534665, -174.48435537631477, 53.20627472704039, -457.0271278148917, 137.16451933031243, 184.35749611491832, -401.3881108941786, -384.07312726524077, 11.72609969072736, -199.02446035783765, -86.17186247546506, -159.89695452510392, -289.4789257014521, -190.14734878220258, -521.6384508966587, -43.78058192309559, -163.9739394092064, 60.056922970108815, -477.93559794050924, -208.7067702642067, -421.8093888980578, 106.39999999999998, -431.39024070064926, 75.24282371991052, -176.89204902055974, -324.28204153185936, -33.124479801680586, -87.373207148308, -287.6260100942855, 126.13560821320007, -426.66071029739527, 79.0430328008151, -224.76879055837324, 32.51422789000074, -159.16318230464015, -464.89574380649094, 20.000000000000014, -243.90622786164323, -39.20776696586813, -300.86819544096534, -42.51226203479766, -372.4086637912578, -163.93082634542438, 110.89999999999998, 111.973868236714, -295.2370096592138, -398.3041126806333, -347.35773734849954, -171.63185173448056, -7.9502083160077675, 3.846543341926041, -479.71090028761193, -23.549284872248613, -387.26080381852483, -88.5989072579014, 131.0939663505556, 62.50114464051638, -326.6305269499292, -222.67702089247123, 85.69999999999997, -61.545930949870005, -586.2305168866585, -346.9063357767724, 76.16649893396985, 190.06561315064073, -76.1241478067644, -132.47300076682882, -129.90397766118116, -57.636398100681355, 64.15603070224907, -406.9465867779586, -321.3093997024437, -353.19396481245195, -68.66526279147541, -143.03049180171374, -215.72584972166678, 17.910221333742903, 108.69657189124366, -357.7414254600154, -16.011595425840643, -121.60572419767834, -330.85494975584714, -72.55129384673201, -182.20129722820423, -197.6421851078675, -15.531794631252815, -78.7625401241958, -183.20088704605996, -232.31036020883047, 94.55305225168388, 54.45694406401155, -350.5034280495777, -186.40116153482728, 90.28072857420239, -231.8946165220408, -139.97986954745045, -67.07159028205422, 124.54368661175049, -117.95149411661555, -417.4945053378235, -155.2422725095025, -323.053166844958, 27.572202693778195, -302.1911149955394, -470.56393462244, -11.667249593079227, -126.12621842221506, -25.262803557455573, -62.85699198047945, -574.4627423675703, 1.3951744859306217, -38.399343830851606, -289.99490379137706, -365.1926491621681, 139.76256370366485, -130.0710946317551, -171.81549379548963, 0.8134391671086476, -59.37262943135761, -219.31288219573895, -335.45269122215507, 77.85439634723377, -418.8576029966119, 64.75493912700902, 173.18049498221376, -98.82030425455656, -55.38417423322195, -89.54579341893832, 109.51742372391388, -175.8376199683813, -358.85749273447937, 5.65600427379154, -59.36157826720082, -387.96116917713545, -317.83118144019824, 0.9064477443130627, -305.69543937324636, -212.78699161402434, -208.0088233185653, 93.93900469123993, -92.87660861845363, -205.05116356171823, -44.79758877043312, -344.97011458227877, 55.62995763829722, -173.2626244919361, -5.0866175507933615, -223.86359592076408, -291.5785025454969, 50.85093160351818, -1.3938158448234965, -344.72529028580755, -525.9725085010725, 16.45253932356118, -65.24309128134436, -276.56356435326376, -112.6657596004055, -11.646558674063245, -174.11959275893497, 84.61368360794486, -279.77094381672896, -269.12757352604905, 41.01349859029016, -476.89809214070823, -51.60181455003743, 74.25624070209219, -116.58990836799373, -537.7294888585312, -326.55975261822704, 121.55879797347322, 190.04436425039577, -132.29625149721548, -444.2943814683265, -439.725855666187, -214.91369243971806, -31.39976584235349, -119.15478674314582, 135.7164316029286, -409.06916219794493, -107.57244841654114, 74.89999999999998, -423.3537202795962], "policy_predator_policy_reward": [452.9988385236195, 377.7610441601689, 278.9992013614559, 319.48375132996955, 359.029246903527, 213.76713163868433, 641.1239845870238, 439.72101194215554, 551.7220170124951, 414.0441426332208, 252.76402204130707, 303.07628491318627, 289.1698822336878, 490.15650165528075, 300.65426694137574, 316.8518190015884, 312.077644104957, 163.51409969588656, 337.6771708592875, 157.51524118318017, 271.7336031883049, 93.80721044882473, 608.1799960789053, 562.9200150116613, 284.4748868261464, 317.6120875148785, 490.850421029345, 313.84101382861456, 301.19505534305915, 380.92284394772287, 306.39580414482015, 282.1835409518602, 418.5945581624196, 362.6644659891927, 517.647963360079, 126.61172943243116, 428.09242551293715, 374.2475137222738, 343.8460319045484, 197.63027091607356, 299.27776799673967, 423.5250266098301, 346.16985349226434, 338.84238868512733, 319.5917124188691, 391.7704515664506, 331.76336188225633, 145.48283296686498, 553.1172239524832, 362.9658055227855, 385.68065232644176, 407.79096086083746, 218.61150988229744, 284.51372742609226, 251.0173656494532, 325.13456260737104, 269.0514524723049, 410.1966829326014, 470.31142640299544, 473.48623786918796, 319.1559228682698, 140.75263098782366, 540.2648253225307, 256.48852179107826, 256.13445226831124, 400.7925431246763, 0.0, 264.05988777353, 394.4171366745122, 413.61400838220106, 282.28159125195305, 178.67039847963574, 519.3798696205238, 382.01804429847266, 184.32607031316823, 235.99594143558593, 324.9667501418381, 368.05831061628066, 353.10461451871777, 215.7277637558297, 312.6057489598357, 448.8970916711982, 396.47919901774065, 397.9986307944842, 158.85048250201754, 247.69058423284704, 295.67892570145176, 453.98894104170074, 323.73148617037157, 575.3554876054206, 411.5428590390829, 493.5308471381042, 422.40938889805795, 431.95693021296483, 264.66893275486166, 363.7186845203058, 215.2850673249138, 270.2600552536851, 408.6882477922434, 145.1020669392661, 341.65056890756364, 201.68715395935632, 366.24332225689466, 366.04085225155296, 474.90996600111686, 350.6770107734142, 221.52148576514668, 337.69110785703486, 389.9777095501196, 387.59562507384527, 181.93185173448, 379.5436589829458, 524.1965702665942, 106.22809959646227, 323.65135194633376, 317.4114738837405, 393.35446927270567, 247.90245267510915, 488.9051112909014, 481.24478901427216, 218.68491864274617, 304.01084366736, 304.1544353638321, 222.39101058188436, 302.7497183146167, 276.8832293614368, 506.359227603927, 325.10939970244414, 244.23049180171407, 270.4069605388638, 366.8414254600149, 80.11626191611454, 254.95432387866643, 382.38945204896413, 428.7827759883978, 261.84424507709747, 191.68546399401112, 419.1519418611286, 115.16906572963018, 356.00342804957893, 245.00204112808535, 218.23550164248095, 226.284806293484, 90.92123082543694, 467.33647640433605, 429.04225358743764, 371.4518313330238, 261.70338065583684, 382.7235577181691, 407.2206959953529, 574.6627423675703, 157.76911547976692, 238.30372367296118, 351.44763157414553, 304.26242736984386, 345.5344511678269, 203.81667092856895, 277.1769297211099, 235.20725701039063, 389.5023815520427, 330.2369165958814, 382.79098870888123, 245.05562809540672, 229.4871466688971, 291.68398648115385, 329.8731646409506, 386.5080050562604, 195.70359228800322, 262.9917534350259, 373.1581138462092, 245.1140957205569, 502.99259604119925, 379.2233564536242, 237.73293971015812, 347.97752393864, 292.02328814458804, 302.8541907783359, 351.1277273706819, 120.4166008754553, 348.55009308647897, 345.2419734026613, 396.9011833510309, 157.59679656928537, 397.5133776170149, 154.6069708048023, 320.8857383279336, 494.31406120458433, 417.9019739808911, 112.53834154602289, 96.56618082328488, 446.25234948106623, 498.39087719914124, 438.8884526887892, 310.7432582553521, 442.97261212845837, 586.0007628483829, 160.03682117474858, 409.16916219794496, 318.4447251696986, 404.2004301190797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.056874165893001, "mean_inference_ms": 5.849300843573647, "mean_action_processing_ms": 2.4349465503809444, "mean_env_wait_ms": 15.231273079626904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004487037658691406, "StateBufferConnector_ms": 0.004704952239990234, "ViewRequirementAgentConnector_ms": 0.1744006872177124}, "num_episodes": 17, "episode_return_max": 602.1249814555235, "episode_return_min": 1.9872086894081846, "episode_return_mean": 212.08020737419244, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.30774492470351, "num_env_steps_trained_throughput_per_sec": 67.30774492470351, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 1160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1160000, "timers": {"training_iteration_time_ms": 59738.2, "restore_workers_time_ms": 0.014, "training_step_time_ms": 59738.14, "sample_time_ms": 2212.636, "learn_time_ms": 57508.526, "learn_throughput": 69.555, "synch_weights_time_ms": 14.351}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "done": false, "training_iteration": 58, "trial_id": "62684_00000", "date": "2024-08-20_17-16-04", "timestamp": 1724154364, "time_this_iter_s": 59.4695930480957, "time_total_s": 4094.4771518707275, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3acadae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4094.4771518707275, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 24.203571428571426, "ram_util_percent": 80.98333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.55539130006276, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.112208834269368, "policy_loss": -0.021602796356037676, "vf_loss": 7.131128148660592, "vf_explained_var": 0.4623997914452925, "kl": 0.013417454944438044, "entropy": 0.89510960851578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 164970.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.604657490543588, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.141961509714681, "policy_loss": -0.023998480118323295, "vf_loss": 8.163293104070835, "vf_explained_var": -0.1595730246690215, "kl": 0.013334353058722126, "entropy": 0.5687129501470183, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 1180000, "num_agent_steps_trained": 1180000}, "env_runners": {"episode_reward_max": 602.1249814555235, "episode_reward_min": 13.52969421210344, "episode_reward_mean": 218.25093773012588, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -586.2305168866585, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 586.0007628483829}, "policy_reward_mean": {"prey_policy": -135.4679593642244, "predator_policy": 312.3274079113997}, "custom_metrics": {}, "hist_stats": {"episode_reward": [293.5220408258192, 291.63928313218787, 441.01117460288566, 162.27374642204856, 190.6814389723839, 217.00533114435427, 250.23426951796836, 184.66858956015545, 21.641232973749844, 602.1249814555235, 280.94515506100436, 56.81153279882276, 261.3797002439526, 75.33018397745901, 35.05893654574372, 494.84650687349466, 193.37408776772233, 133.07084359228844, 110.14463773439459, 169.69400154683132, 278.48826094257856, 107.5666895123155, 202.45635044265805, 77.42142553432184, 332.30824544812987, 191.91997789390712, 43.48220284031382, 442.9987523329002, 133.773103485499, 196.00608052083206, 34.53571331843847, 131.01102804512078, 296.2970811042041, 154.45051874592906, 408.0734524686448, 442.02153861794284, 188.04431971094175, 179.20599349966224, 88.29999999999914, 173.7913321509393, 181.9012383815168, 112.3318081273725, 295.25174409816884, 116.56361847605243, 269.67906204532557, 135.22249328790093, 234.69826390116668, 205.6904580278337, 35.48313284214017, 181.58685107578793, 69.84931994183201, 262.7522821108086, 294.295698447413, 250.6189165899407, 147.7984614917724, 532.1057364173745, 230.7925028575873, 196.37946214315812, 140.544854173718, 13.52969421210344, 421.24988152040976, 274.2309352131775, 177.3980306473103, 133.4532021319625, 173.69851943482072, 167.38009629483568, 154.23429155856755, 106.2158561650171, 207.2038681090065, 115.16904015336928, 201.91278317692166, 363.0854422289946, 342.934061028582, 176.69846603453144, 266.61898659264045, 183.67852570253467, 396.6865603599967, 124.22870981005495, 57.134335324714286, 258.6126468856111, 134.79999999999978, 238.99999999999952, 192.3018031865639, 207.02067718757132, 267.31230439743814, 194.154963369352, 548.3627213094748, 313.46264485221604, 253.21967566909632, 188.9430854917956, 225.7649742007156, 452.01994857335126, 197.0545452346665, 428.3248823577814, 316.5072531422796, 133.45333164356566, 312.3921658095859, 229.61941600850642, 195.92701163913517, 18.94279055339244], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-156.82833937139483, -420.0623943109255, 76.94116132086032, -18.849638791142993, 128.83450288047672, -321.47081826553597, -7.640647523229295, -260.24943456705944, 132.7493284363485, -227.86738120645458, 73.81543499688908, -362.9224427732894, -430.35010338148976, -358.6163472319058, 35.850225313596404, -36.56176181021737, 79.47739224317438, -285.8188531446928, -33.68175928620953, -449.68573288388916, -63.1515854255411, -230.92100086402144, -102.08014093510029, -139.25726403371064, -96.44729700371289, 2.91315732577765, -148.88451512184582, 107.92126752846198, -493.7401040137036, 179.91267288405155, -127.78245987566567, 30.498534092702478, -82.72290888762438, 49.63571682843153, -373.2180442984725, -521.0040536501324, -196.19594143558595, -106.63106896324217, 143.88469889402674, -151.42448289713673, -160.38603591719797, -305.8843579663245, -127.1361185990231, -232.1529677534665, -174.48435537631477, 53.20627472704039, -457.0271278148917, 137.16451933031243, 184.35749611491832, -401.3881108941786, -384.07312726524077, 11.72609969072736, -199.02446035783765, -86.17186247546506, -159.89695452510392, -289.4789257014521, -190.14734878220258, -521.6384508966587, -43.78058192309559, -163.9739394092064, 60.056922970108815, -477.93559794050924, -208.7067702642067, -421.8093888980578, 106.39999999999998, -431.39024070064926, 75.24282371991052, -176.89204902055974, -324.28204153185936, -33.124479801680586, -87.373207148308, -287.6260100942855, 126.13560821320007, -426.66071029739527, 79.0430328008151, -224.76879055837324, 32.51422789000074, -159.16318230464015, -464.89574380649094, 20.000000000000014, -243.90622786164323, -39.20776696586813, -300.86819544096534, -42.51226203479766, -372.4086637912578, -163.93082634542438, 110.89999999999998, 111.973868236714, -295.2370096592138, -398.3041126806333, -347.35773734849954, -171.63185173448056, -7.9502083160077675, 3.846543341926041, -479.71090028761193, -23.549284872248613, -387.26080381852483, -88.5989072579014, 131.0939663505556, 62.50114464051638, -326.6305269499292, -222.67702089247123, 85.69999999999997, -61.545930949870005, -586.2305168866585, -346.9063357767724, 76.16649893396985, 190.06561315064073, -76.1241478067644, -132.47300076682882, -129.90397766118116, -57.636398100681355, 64.15603070224907, -406.9465867779586, -321.3093997024437, -353.19396481245195, -68.66526279147541, -143.03049180171374, -215.72584972166678, 17.910221333742903, 108.69657189124366, -357.7414254600154, -16.011595425840643, -121.60572419767834, -330.85494975584714, -72.55129384673201, -182.20129722820423, -197.6421851078675, -15.531794631252815, -78.7625401241958, -183.20088704605996, -232.31036020883047, 94.55305225168388, 54.45694406401155, -350.5034280495777, -186.40116153482728, 90.28072857420239, -231.8946165220408, -139.97986954745045, -67.07159028205422, 124.54368661175049, -117.95149411661555, -417.4945053378235, -155.2422725095025, -323.053166844958, 27.572202693778195, -302.1911149955394, -470.56393462244, -11.667249593079227, -126.12621842221506, -25.262803557455573, -62.85699198047945, -574.4627423675703, 1.3951744859306217, -38.399343830851606, -289.99490379137706, -365.1926491621681, 139.76256370366485, -130.0710946317551, -171.81549379548963, 0.8134391671086476, -59.37262943135761, -219.31288219573895, -335.45269122215507, 77.85439634723377, -418.8576029966119, 64.75493912700902, 173.18049498221376, -98.82030425455656, -55.38417423322195, -89.54579341893832, 109.51742372391388, -175.8376199683813, -358.85749273447937, 5.65600427379154, -59.36157826720082, -387.96116917713545, -317.83118144019824, 0.9064477443130627, -305.69543937324636, -212.78699161402434, -208.0088233185653, 93.93900469123993, -92.87660861845363, -205.05116356171823, -44.79758877043312, -344.97011458227877, 55.62995763829722, -173.2626244919361, -5.0866175507933615, -223.86359592076408, -291.5785025454969, 50.85093160351818, -1.3938158448234965, -344.72529028580755, -525.9725085010725, 16.45253932356118, -65.24309128134436, -276.56356435326376, -112.6657596004055, -11.646558674063245, -174.11959275893497, 84.61368360794486, -279.77094381672896, -269.12757352604905, 41.01349859029016, -476.89809214070823, -51.60181455003743, 74.25624070209219, -116.58990836799373, -537.7294888585312, -326.55975261822704, 121.55879797347322, 190.04436425039577, -132.29625149721548, -444.2943814683265, -439.725855666187, -214.91369243971806, -31.39976584235349, -119.15478674314582, 135.7164316029286, -409.06916219794493, -107.57244841654114, 74.89999999999998, -423.3537202795962, -317.0059421583752, -319.01141097381026, 31.992156827675682, -140.8946403007761, 80.10880938366792, -56.06936029561531, 44.3271319971075, -172.05797207106448, -280.1851497326118, -39.817017805369616, -274.84649796748585, 10.836788972315059, -137.1552384112107, 188.29999999999998, -160.0236354492729, -273.2823915462621, -226.7195433837505, 63.98972408564058, -173.44234633226276, 40.40371431275671, 99.57819226192937, -235.43379626556685, -357.8036362147129, 174.34324456694773, 92.93959855661981, -112.64398239436207, -83.86056635673283, -25.046615153087387, 153.2, -469.31941764095046, -37.95606011919049, 114.7564446442249, -386.27276217984695, -386.2700042165936, 200.0, 186.49999999999997, -178.00883648535847, -57.237505540173004, 194.47802956001038, -24.22831375983285, -43.23871701106373, -245.27941652513002, -86.63023828354024, -272.9314825201076, 24.108146135664096, 182.0003961858592, -290.7683733257916, -335.2091839240494, -26.758012004389297, 134.08022975338932, -124.10943280254125, -34.435454091859555, -279.8019373099052, -392.34071965043984, 145.57592519773198, -420.0316333453019, 19.330796821579632, -31.289318809362456, -189.64098912641072, -93.3283492420707, -262.11159035082676, -25.731804611477028, -118.92561669156495, 137.05578613327106, -52.36432669293361, -418.6028537902354, -50.350815939567376, 84.66034630404258, -438.2812229793889, -330.2263122394268, -194.1091191046757, 113.81541936784205, -309.4560152655897, -10.164632979467022, -391.22764574589155], "policy_predator_policy_reward": [385.68065232644176, 407.79096086083746, 218.61150988229744, 284.51372742609226, 251.0173656494532, 325.13456260737104, 269.0514524723049, 410.1966829326014, 470.31142640299544, 473.48623786918796, 319.1559228682698, 140.75263098782366, 540.2648253225307, 256.48852179107826, 256.13445226831124, 400.7925431246763, 0.0, 264.05988777353, 394.4171366745122, 413.61400838220106, 282.28159125195305, 178.67039847963574, 519.3798696205238, 382.01804429847266, 184.32607031316823, 235.99594143558593, 324.9667501418381, 368.05831061628066, 353.10461451871777, 215.7277637558297, 312.6057489598357, 448.8970916711982, 396.47919901774065, 397.9986307944842, 158.85048250201754, 247.69058423284704, 295.67892570145176, 453.98894104170074, 323.73148617037157, 575.3554876054206, 411.5428590390829, 493.5308471381042, 422.40938889805795, 431.95693021296483, 264.66893275486166, 363.7186845203058, 215.2850673249138, 270.2600552536851, 408.6882477922434, 145.1020669392661, 341.65056890756364, 201.68715395935632, 366.24332225689466, 366.04085225155296, 474.90996600111686, 350.6770107734142, 221.52148576514668, 337.69110785703486, 389.9777095501196, 387.59562507384527, 181.93185173448, 379.5436589829458, 524.1965702665942, 106.22809959646227, 323.65135194633376, 317.4114738837405, 393.35446927270567, 247.90245267510915, 488.9051112909014, 481.24478901427216, 218.68491864274617, 304.01084366736, 304.1544353638321, 222.39101058188436, 302.7497183146167, 276.8832293614368, 506.359227603927, 325.10939970244414, 244.23049180171407, 270.4069605388638, 366.8414254600149, 80.11626191611454, 254.95432387866643, 382.38945204896413, 428.7827759883978, 261.84424507709747, 191.68546399401112, 419.1519418611286, 115.16906572963018, 356.00342804957893, 245.00204112808535, 218.23550164248095, 226.284806293484, 90.92123082543694, 467.33647640433605, 429.04225358743764, 371.4518313330238, 261.70338065583684, 382.7235577181691, 407.2206959953529, 574.6627423675703, 157.76911547976692, 238.30372367296118, 351.44763157414553, 304.26242736984386, 345.5344511678269, 203.81667092856895, 277.1769297211099, 235.20725701039063, 389.5023815520427, 330.2369165958814, 382.79098870888123, 245.05562809540672, 229.4871466688971, 291.68398648115385, 329.8731646409506, 386.5080050562604, 195.70359228800322, 262.9917534350259, 373.1581138462092, 245.1140957205569, 502.99259604119925, 379.2233564536242, 237.73293971015812, 347.97752393864, 292.02328814458804, 302.8541907783359, 351.1277273706819, 120.4166008754553, 348.55009308647897, 345.2419734026613, 396.9011833510309, 157.59679656928537, 397.5133776170149, 154.6069708048023, 320.8857383279336, 494.31406120458433, 417.9019739808911, 112.53834154602289, 96.56618082328488, 446.25234948106623, 498.39087719914124, 438.8884526887892, 310.7432582553521, 442.97261212845837, 586.0007628483829, 160.03682117474858, 409.16916219794496, 318.4447251696986, 404.2004301190797, 511.89178384000377, 275.81193816704223, 298.52875611110625, 215.012995461611, 240.28989424541797, 291.85480537120554, 133.90699515640924, 227.05406696884648, 121.77079705773554, 245.72072368835973, 285.24338950582836, 285.56882133854486, 211.62827752528716, 60.8321622322896, 249.19235488518316, 362.0036362147133, 160.74745635307593, 149.83817102897083, 135.5589195505255, 472.91941764095026, 209.20312488873554, 294.4242161354286, 384.18979839036143, 163.94292713570658, 217.1349510456525, 137.0960062720841, 366.19457506203526, 199.7715479030872, 246.18594650114036, 278.2107136586397, 316.3765433369094, 353.3655919277894, 160.64968816442678, 308.1574754624644, 458.15003200232104, 445.4826242845522, 387.26532364922855, 296.1844700345436, 237.53366486758514, 393.2322454525385, 244.3114894776199, 295.91085381981844, 328.4764682148405, 317.82709194464303, 199.26364003311835, 434.3274685903029, 369.94264367703295, 236.50437993836312, 337.1638427392671, 392.62724180507473]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.987186404563053, "mean_inference_ms": 5.786750831087805, "mean_action_processing_ms": 2.4107232279145525, "mean_env_wait_ms": 15.105082141952302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004483461380004883, "StateBufferConnector_ms": 0.004697084426879883, "ViewRequirementAgentConnector_ms": 0.17076802253723145}, "num_episodes": 25, "episode_return_max": 602.1249814555235, "episode_return_min": 13.52969421210344, "episode_return_mean": 218.25093773012588, "episodes_this_iter": 25}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1180000, "num_agent_steps_trained": 1180000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.98199795245412, "num_env_steps_trained_throughput_per_sec": 66.98199795245412, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 1180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1180000, "timers": {"training_iteration_time_ms": 59750.413, "restore_workers_time_ms": 0.015, "training_step_time_ms": 59750.354, "sample_time_ms": 2231.57, "learn_time_ms": 57501.713, "learn_throughput": 69.563, "synch_weights_time_ms": 14.418}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 1180000, "num_agent_steps_trained": 1180000}, "done": false, "training_iteration": 59, "trial_id": "62684_00000", "date": "2024-08-20_17-17-04", "timestamp": 1724154424, "time_this_iter_s": 59.7672860622406, "time_total_s": 4154.244437932968, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffb89d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4154.244437932968, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 25.81904761904762, "ram_util_percent": 81.17738095238094}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.982284203573322, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.391141905852243, "policy_loss": -0.022436379519595057, "vf_loss": 7.4103705397734405, "vf_explained_var": 0.5294876954656966, "kl": 0.0160387168613639, "entropy": 0.9273818874612768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 167790.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.14519586676643, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.412257019678751, "policy_loss": -0.02417629814260792, "vf_loss": 8.433844195219574, "vf_explained_var": -0.20785809790015852, "kl": 0.012945557254238458, "entropy": 0.5516952815352294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 548.3627213094748, "episode_reward_min": 13.52969421210344, "episode_reward_mean": 213.46467381548177, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -586.2305168866585, "predator_policy": 42.58440820239263}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 586.0007628483829}, "policy_reward_mean": {"prey_policy": -131.6894207917958, "predator_policy": 304.26646809543485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [133.07084359228844, 110.14463773439459, 169.69400154683132, 278.48826094257856, 107.5666895123155, 202.45635044265805, 77.42142553432184, 332.30824544812987, 191.91997789390712, 43.48220284031382, 442.9987523329002, 133.773103485499, 196.00608052083206, 34.53571331843847, 131.01102804512078, 296.2970811042041, 154.45051874592906, 408.0734524686448, 442.02153861794284, 188.04431971094175, 179.20599349966224, 88.29999999999914, 173.7913321509393, 181.9012383815168, 112.3318081273725, 295.25174409816884, 116.56361847605243, 269.67906204532557, 135.22249328790093, 234.69826390116668, 205.6904580278337, 35.48313284214017, 181.58685107578793, 69.84931994183201, 262.7522821108086, 294.295698447413, 250.6189165899407, 147.7984614917724, 532.1057364173745, 230.7925028575873, 196.37946214315812, 140.544854173718, 13.52969421210344, 421.24988152040976, 274.2309352131775, 177.3980306473103, 133.4532021319625, 173.69851943482072, 167.38009629483568, 154.23429155856755, 106.2158561650171, 207.2038681090065, 115.16904015336928, 201.91278317692166, 363.0854422289946, 342.934061028582, 176.69846603453144, 266.61898659264045, 183.67852570253467, 396.6865603599967, 124.22870981005495, 57.134335324714286, 258.6126468856111, 134.79999999999978, 238.99999999999952, 192.3018031865639, 207.02067718757132, 267.31230439743814, 194.154963369352, 548.3627213094748, 313.46264485221604, 253.21967566909632, 188.9430854917956, 225.7649742007156, 452.01994857335126, 197.0545452346665, 428.3248823577814, 316.5072531422796, 133.45333164356566, 312.3921658095859, 229.61941600850642, 195.92701163913517, 18.94279055339244, 102.93902616269438, 39.52340278649524, 158.09999999999934, 358.7084001670207, 284.5601736524134, 150.27916031318273, 19.693637061909605, 194.76934815717172, 470.4831574214022, 194.91040196216147, 130.87946080534434, 221.0915659841063, 398.85198793096447, 237.61124123289898, 172.02454821984375, 347.2914367235978, 92.20485182965754], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [11.72609969072736, -199.02446035783765, -86.17186247546506, -159.89695452510392, -289.4789257014521, -190.14734878220258, -521.6384508966587, -43.78058192309559, -163.9739394092064, 60.056922970108815, -477.93559794050924, -208.7067702642067, -421.8093888980578, 106.39999999999998, -431.39024070064926, 75.24282371991052, -176.89204902055974, -324.28204153185936, -33.124479801680586, -87.373207148308, -287.6260100942855, 126.13560821320007, -426.66071029739527, 79.0430328008151, -224.76879055837324, 32.51422789000074, -159.16318230464015, -464.89574380649094, 20.000000000000014, -243.90622786164323, -39.20776696586813, -300.86819544096534, -42.51226203479766, -372.4086637912578, -163.93082634542438, 110.89999999999998, 111.973868236714, -295.2370096592138, -398.3041126806333, -347.35773734849954, -171.63185173448056, -7.9502083160077675, 3.846543341926041, -479.71090028761193, -23.549284872248613, -387.26080381852483, -88.5989072579014, 131.0939663505556, 62.50114464051638, -326.6305269499292, -222.67702089247123, 85.69999999999997, -61.545930949870005, -586.2305168866585, -346.9063357767724, 76.16649893396985, 190.06561315064073, -76.1241478067644, -132.47300076682882, -129.90397766118116, -57.636398100681355, 64.15603070224907, -406.9465867779586, -321.3093997024437, -353.19396481245195, -68.66526279147541, -143.03049180171374, -215.72584972166678, 17.910221333742903, 108.69657189124366, -357.7414254600154, -16.011595425840643, -121.60572419767834, -330.85494975584714, -72.55129384673201, -182.20129722820423, -197.6421851078675, -15.531794631252815, -78.7625401241958, -183.20088704605996, -232.31036020883047, 94.55305225168388, 54.45694406401155, -350.5034280495777, -186.40116153482728, 90.28072857420239, -231.8946165220408, -139.97986954745045, -67.07159028205422, 124.54368661175049, -117.95149411661555, -417.4945053378235, -155.2422725095025, -323.053166844958, 27.572202693778195, -302.1911149955394, -470.56393462244, -11.667249593079227, -126.12621842221506, -25.262803557455573, -62.85699198047945, -574.4627423675703, 1.3951744859306217, -38.399343830851606, -289.99490379137706, -365.1926491621681, 139.76256370366485, -130.0710946317551, -171.81549379548963, 0.8134391671086476, -59.37262943135761, -219.31288219573895, -335.45269122215507, 77.85439634723377, -418.8576029966119, 64.75493912700902, 173.18049498221376, -98.82030425455656, -55.38417423322195, -89.54579341893832, 109.51742372391388, -175.8376199683813, -358.85749273447937, 5.65600427379154, -59.36157826720082, -387.96116917713545, -317.83118144019824, 0.9064477443130627, -305.69543937324636, -212.78699161402434, -208.0088233185653, 93.93900469123993, -92.87660861845363, -205.05116356171823, -44.79758877043312, -344.97011458227877, 55.62995763829722, -173.2626244919361, -5.0866175507933615, -223.86359592076408, -291.5785025454969, 50.85093160351818, -1.3938158448234965, -344.72529028580755, -525.9725085010725, 16.45253932356118, -65.24309128134436, -276.56356435326376, -112.6657596004055, -11.646558674063245, -174.11959275893497, 84.61368360794486, -279.77094381672896, -269.12757352604905, 41.01349859029016, -476.89809214070823, -51.60181455003743, 74.25624070209219, -116.58990836799373, -537.7294888585312, -326.55975261822704, 121.55879797347322, 190.04436425039577, -132.29625149721548, -444.2943814683265, -439.725855666187, -214.91369243971806, -31.39976584235349, -119.15478674314582, 135.7164316029286, -409.06916219794493, -107.57244841654114, 74.89999999999998, -423.3537202795962, -317.0059421583752, -319.01141097381026, 31.992156827675682, -140.8946403007761, 80.10880938366792, -56.06936029561531, 44.3271319971075, -172.05797207106448, -280.1851497326118, -39.817017805369616, -274.84649796748585, 10.836788972315059, -137.1552384112107, 188.29999999999998, -160.0236354492729, -273.2823915462621, -226.7195433837505, 63.98972408564058, -173.44234633226276, 40.40371431275671, 99.57819226192937, -235.43379626556685, -357.8036362147129, 174.34324456694773, 92.93959855661981, -112.64398239436207, -83.86056635673283, -25.046615153087387, 153.2, -469.31941764095046, -37.95606011919049, 114.7564446442249, -386.27276217984695, -386.2700042165936, 200.0, 186.49999999999997, -178.00883648535847, -57.237505540173004, 194.47802956001038, -24.22831375983285, -43.23871701106373, -245.27941652513002, -86.63023828354024, -272.9314825201076, 24.108146135664096, 182.0003961858592, -290.7683733257916, -335.2091839240494, -26.758012004389297, 134.08022975338932, -124.10943280254125, -34.435454091859555, -279.8019373099052, -392.34071965043984, 145.57592519773198, -420.0316333453019, 19.330796821579632, -31.289318809362456, -189.64098912641072, -93.3283492420707, -262.11159035082676, -25.731804611477028, -118.92561669156495, 137.05578613327106, -52.36432669293361, -418.6028537902354, -50.350815939567376, 84.66034630404258, -438.2812229793889, -330.2263122394268, -194.1091191046757, 113.81541936784205, -309.4560152655897, -10.164632979467022, -391.22764574589155, -1.5676529389315066, -336.2854479198803, -34.71657714927342, -287.8441356621535, -0.41645846085549865, -11.934915277202272, -64.1643497584179, -301.74658412406717, 63.19999999999996, 183.5014250589688, -127.8019182314753, -426.58061347743666, -184.85033856380943, -233.34042141131263, 73.99486453860041, 24.82433989451188, -206.89515086749321, -287.4999974352093, -300.9158418283585, -46.006278614950354, -84.29121596332357, -35.80789021641745, -58.543650460658085, 11.171435348498665, 157.74161587195547, 162.44639773201277, -54.59592756686014, -105.55304195684208, -95.21885805264174, 40.18979665495225, -414.64542940063404, -394.2900520026513, 100.98559742203335, -488.70880233444336, 92.76192121098899, -300.6016631363154, 22.78411490959894, 152.9412443259227, -447.8274408930712, -456.1207282175407, -63.90749548682552, 25.113518947265366, -23.2994903587034, -290.72079441556326, -181.38985461690916, 137.9503412306957, -242.96690333755868, -238.02380628521652, 22.061913880555014, -224.21284584311914, -114.25072365436253], "policy_predator_policy_reward": [158.85048250201754, 247.69058423284704, 295.67892570145176, 453.98894104170074, 323.73148617037157, 575.3554876054206, 411.5428590390829, 493.5308471381042, 422.40938889805795, 431.95693021296483, 264.66893275486166, 363.7186845203058, 215.2850673249138, 270.2600552536851, 408.6882477922434, 145.1020669392661, 341.65056890756364, 201.68715395935632, 366.24332225689466, 366.04085225155296, 474.90996600111686, 350.6770107734142, 221.52148576514668, 337.69110785703486, 389.9777095501196, 387.59562507384527, 181.93185173448, 379.5436589829458, 524.1965702665942, 106.22809959646227, 323.65135194633376, 317.4114738837405, 393.35446927270567, 247.90245267510915, 488.9051112909014, 481.24478901427216, 218.68491864274617, 304.01084366736, 304.1544353638321, 222.39101058188436, 302.7497183146167, 276.8832293614368, 506.359227603927, 325.10939970244414, 244.23049180171407, 270.4069605388638, 366.8414254600149, 80.11626191611454, 254.95432387866643, 382.38945204896413, 428.7827759883978, 261.84424507709747, 191.68546399401112, 419.1519418611286, 115.16906572963018, 356.00342804957893, 245.00204112808535, 218.23550164248095, 226.284806293484, 90.92123082543694, 467.33647640433605, 429.04225358743764, 371.4518313330238, 261.70338065583684, 382.7235577181691, 407.2206959953529, 574.6627423675703, 157.76911547976692, 238.30372367296118, 351.44763157414553, 304.26242736984386, 345.5344511678269, 203.81667092856895, 277.1769297211099, 235.20725701039063, 389.5023815520427, 330.2369165958814, 382.79098870888123, 245.05562809540672, 229.4871466688971, 291.68398648115385, 329.8731646409506, 386.5080050562604, 195.70359228800322, 262.9917534350259, 373.1581138462092, 245.1140957205569, 502.99259604119925, 379.2233564536242, 237.73293971015812, 347.97752393864, 292.02328814458804, 302.8541907783359, 351.1277273706819, 120.4166008754553, 348.55009308647897, 345.2419734026613, 396.9011833510309, 157.59679656928537, 397.5133776170149, 154.6069708048023, 320.8857383279336, 494.31406120458433, 417.9019739808911, 112.53834154602289, 96.56618082328488, 446.25234948106623, 498.39087719914124, 438.8884526887892, 310.7432582553521, 442.97261212845837, 586.0007628483829, 160.03682117474858, 409.16916219794496, 318.4447251696986, 404.2004301190797, 511.89178384000377, 275.81193816704223, 298.52875611110625, 215.012995461611, 240.28989424541797, 291.85480537120554, 133.90699515640924, 227.05406696884648, 121.77079705773554, 245.72072368835973, 285.24338950582836, 285.56882133854486, 211.62827752528716, 60.8321622322896, 249.19235488518316, 362.0036362147133, 160.74745635307593, 149.83817102897083, 135.5589195505255, 472.91941764095026, 209.20312488873554, 294.4242161354286, 384.18979839036143, 163.94292713570658, 217.1349510456525, 137.0960062720841, 366.19457506203526, 199.7715479030872, 246.18594650114036, 278.2107136586397, 316.3765433369094, 353.3655919277894, 160.64968816442678, 308.1574754624644, 458.15003200232104, 445.4826242845522, 387.26532364922855, 296.1844700345436, 237.53366486758514, 393.2322454525385, 244.3114894776199, 295.91085381981844, 328.4764682148405, 317.82709194464303, 199.26364003311835, 434.3274685903029, 369.94264367703295, 236.50437993836312, 337.1638427392671, 392.62724180507473, 132.55883244539294, 342.9498717253863, 82.665940984712, 257.0529712019942, 154.86434975841766, 305.94658412406744, 356.3530108302506, 373.2364959867133, 258.92856882481226, 369.82750026412214, 324.75576030766496, 295.0942084137096, 184.51890341337588, 266.3880700551676, 235.36504528335664, 42.58440820239263, 139.92644255264437, 64.9646288316496, 172.68082711166912, 182.8116782050243, 431.8440639906705, 406.9852807959266, 334.64339866484886, 582.9967115790288, 334.2981019543961, 336.65596763411753, 337.6431262402065, 394.8828197497942, 328.34465929701594, 339.090028314005, 452.33875337599704, 237.99305173968008, 231.61284584311872, 176.9936616034658]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.929995174191274, "mean_inference_ms": 5.766028313001134, "mean_action_processing_ms": 2.4002047119798178, "mean_env_wait_ms": 14.992522727091165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004608154296875, "StateBufferConnector_ms": 0.005179643630981445, "ViewRequirementAgentConnector_ms": 0.16283273696899414}, "num_episodes": 17, "episode_return_max": 548.3627213094748, "episode_return_min": 13.52969421210344, "episode_return_mean": 213.46467381548177, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.93450069663727, "num_env_steps_trained_throughput_per_sec": 66.93450069663727, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 59702.252, "restore_workers_time_ms": 0.014, "training_step_time_ms": 59702.193, "sample_time_ms": 2193.817, "learn_time_ms": 57491.448, "learn_throughput": 69.576, "synch_weights_time_ms": 14.183}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 60, "trial_id": "62684_00000", "date": "2024-08-20_17-18-04", "timestamp": 1724154484, "time_this_iter_s": 59.81639099121094, "time_total_s": 4214.060828924179, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ff9b310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4214.060828924179, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 25.236904761904757, "ram_util_percent": 81.70476190476191}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.054748767191636, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.692017356047393, "policy_loss": -0.018368055729826267, "vf_loss": 7.707456507243164, "vf_explained_var": 0.5574235543291619, "kl": 0.014644476489811237, "entropy": 0.9236697778211418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 170610.5, "diff_num_grad_updates_vs_sampler_policy": 1448.9800000000105}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.692258689453993, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.65140320586149, "policy_loss": -0.024523507054678345, "vf_loss": 8.67314004141187, "vf_explained_var": -0.021302356606438047, "kl": 0.01393327862443156, "entropy": 0.5359643525232083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 970.9600000000065}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 1220000, "num_agent_steps_trained": 1220000}, "env_runners": {"episode_reward_max": 548.3627213094748, "episode_reward_min": -18.429156325679102, "episode_reward_mean": 223.09539641644517, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -574.4627423675703, "predator_policy": 19.571437137953886}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 678.3863984946718}, "policy_reward_mean": {"prey_policy": -124.2686111019898, "predator_policy": 297.95061486120744}, "custom_metrics": {}, "hist_stats": {"episode_reward": [188.04431971094175, 179.20599349966224, 88.29999999999914, 173.7913321509393, 181.9012383815168, 112.3318081273725, 295.25174409816884, 116.56361847605243, 269.67906204532557, 135.22249328790093, 234.69826390116668, 205.6904580278337, 35.48313284214017, 181.58685107578793, 69.84931994183201, 262.7522821108086, 294.295698447413, 250.6189165899407, 147.7984614917724, 532.1057364173745, 230.7925028575873, 196.37946214315812, 140.544854173718, 13.52969421210344, 421.24988152040976, 274.2309352131775, 177.3980306473103, 133.4532021319625, 173.69851943482072, 167.38009629483568, 154.23429155856755, 106.2158561650171, 207.2038681090065, 115.16904015336928, 201.91278317692166, 363.0854422289946, 342.934061028582, 176.69846603453144, 266.61898659264045, 183.67852570253467, 396.6865603599967, 124.22870981005495, 57.134335324714286, 258.6126468856111, 134.79999999999978, 238.99999999999952, 192.3018031865639, 207.02067718757132, 267.31230439743814, 194.154963369352, 548.3627213094748, 313.46264485221604, 253.21967566909632, 188.9430854917956, 225.7649742007156, 452.01994857335126, 197.0545452346665, 428.3248823577814, 316.5072531422796, 133.45333164356566, 312.3921658095859, 229.61941600850642, 195.92701163913517, 18.94279055339244, 102.93902616269438, 39.52340278649524, 158.09999999999934, 358.7084001670207, 284.5601736524134, 150.27916031318273, 19.693637061909605, 194.76934815717172, 470.4831574214022, 194.91040196216147, 130.87946080534434, 221.0915659841063, 398.85198793096447, 237.61124123289898, 172.02454821984375, 347.2914367235978, 92.20485182965754, 70.49675775193283, -18.429156325679102, 437.7261328883766, 240.11442630239776, 207.3400724554442, 252.1324333689829, 260.61502372478554, 476.6092463168157, 175.42491401047914, 302.8315752646348, 185.10626358357428, 311.7216380115574, 151.6254721956924, 518.5442034243447, 133.21541103376512, 243.85410040037158, 349.77624950596305, 92.80060890934098, 457.28679140081533], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-76.1241478067644, -132.47300076682882, -129.90397766118116, -57.636398100681355, 64.15603070224907, -406.9465867779586, -321.3093997024437, -353.19396481245195, -68.66526279147541, -143.03049180171374, -215.72584972166678, 17.910221333742903, 108.69657189124366, -357.7414254600154, -16.011595425840643, -121.60572419767834, -330.85494975584714, -72.55129384673201, -182.20129722820423, -197.6421851078675, -15.531794631252815, -78.7625401241958, -183.20088704605996, -232.31036020883047, 94.55305225168388, 54.45694406401155, -350.5034280495777, -186.40116153482728, 90.28072857420239, -231.8946165220408, -139.97986954745045, -67.07159028205422, 124.54368661175049, -117.95149411661555, -417.4945053378235, -155.2422725095025, -323.053166844958, 27.572202693778195, -302.1911149955394, -470.56393462244, -11.667249593079227, -126.12621842221506, -25.262803557455573, -62.85699198047945, -574.4627423675703, 1.3951744859306217, -38.399343830851606, -289.99490379137706, -365.1926491621681, 139.76256370366485, -130.0710946317551, -171.81549379548963, 0.8134391671086476, -59.37262943135761, -219.31288219573895, -335.45269122215507, 77.85439634723377, -418.8576029966119, 64.75493912700902, 173.18049498221376, -98.82030425455656, -55.38417423322195, -89.54579341893832, 109.51742372391388, -175.8376199683813, -358.85749273447937, 5.65600427379154, -59.36157826720082, -387.96116917713545, -317.83118144019824, 0.9064477443130627, -305.69543937324636, -212.78699161402434, -208.0088233185653, 93.93900469123993, -92.87660861845363, -205.05116356171823, -44.79758877043312, -344.97011458227877, 55.62995763829722, -173.2626244919361, -5.0866175507933615, -223.86359592076408, -291.5785025454969, 50.85093160351818, -1.3938158448234965, -344.72529028580755, -525.9725085010725, 16.45253932356118, -65.24309128134436, -276.56356435326376, -112.6657596004055, -11.646558674063245, -174.11959275893497, 84.61368360794486, -279.77094381672896, -269.12757352604905, 41.01349859029016, -476.89809214070823, -51.60181455003743, 74.25624070209219, -116.58990836799373, -537.7294888585312, -326.55975261822704, 121.55879797347322, 190.04436425039577, -132.29625149721548, -444.2943814683265, -439.725855666187, -214.91369243971806, -31.39976584235349, -119.15478674314582, 135.7164316029286, -409.06916219794493, -107.57244841654114, 74.89999999999998, -423.3537202795962, -317.0059421583752, -319.01141097381026, 31.992156827675682, -140.8946403007761, 80.10880938366792, -56.06936029561531, 44.3271319971075, -172.05797207106448, -280.1851497326118, -39.817017805369616, -274.84649796748585, 10.836788972315059, -137.1552384112107, 188.29999999999998, -160.0236354492729, -273.2823915462621, -226.7195433837505, 63.98972408564058, -173.44234633226276, 40.40371431275671, 99.57819226192937, -235.43379626556685, -357.8036362147129, 174.34324456694773, 92.93959855661981, -112.64398239436207, -83.86056635673283, -25.046615153087387, 153.2, -469.31941764095046, -37.95606011919049, 114.7564446442249, -386.27276217984695, -386.2700042165936, 200.0, 186.49999999999997, -178.00883648535847, -57.237505540173004, 194.47802956001038, -24.22831375983285, -43.23871701106373, -245.27941652513002, -86.63023828354024, -272.9314825201076, 24.108146135664096, 182.0003961858592, -290.7683733257916, -335.2091839240494, -26.758012004389297, 134.08022975338932, -124.10943280254125, -34.435454091859555, -279.8019373099052, -392.34071965043984, 145.57592519773198, -420.0316333453019, 19.330796821579632, -31.289318809362456, -189.64098912641072, -93.3283492420707, -262.11159035082676, -25.731804611477028, -118.92561669156495, 137.05578613327106, -52.36432669293361, -418.6028537902354, -50.350815939567376, 84.66034630404258, -438.2812229793889, -330.2263122394268, -194.1091191046757, 113.81541936784205, -309.4560152655897, -10.164632979467022, -391.22764574589155, -1.5676529389315066, -336.2854479198803, -34.71657714927342, -287.8441356621535, -0.41645846085549865, -11.934915277202272, -64.1643497584179, -301.74658412406717, 63.19999999999996, 183.5014250589688, -127.8019182314753, -426.58061347743666, -184.85033856380943, -233.34042141131263, 73.99486453860041, 24.82433989451188, -206.89515086749321, -287.4999974352093, -300.9158418283585, -46.006278614950354, -84.29121596332357, -35.80789021641745, -58.543650460658085, 11.171435348498665, 157.74161587195547, 162.44639773201277, -54.59592756686014, -105.55304195684208, -95.21885805264174, 40.18979665495225, -414.64542940063404, -394.2900520026513, 100.98559742203335, -488.70880233444336, 92.76192121098899, -300.6016631363154, 22.78411490959894, 152.9412443259227, -447.8274408930712, -456.1207282175407, -63.90749548682552, 25.113518947265366, -23.2994903587034, -290.72079441556326, -181.38985461690916, 137.9503412306957, -242.96690333755868, -238.02380628521652, 22.061913880555014, -224.21284584311914, -114.25072365436253, -35.44894094028132, -130.19501881536212, -66.70813028829672, -286.3508603582835, -411.3255905903912, -18.86985719281402, -392.5797361452392, -287.4571248853936, 25.754184703613248, -232.37636793277125, -264.80380471905295, 175.51442630239794, -223.6124552225745, 190.63402040208737, -204.11042229995462, 42.40405240281474, -132.21022193413788, -88.20969486237108, 98.47014336858994, -266.9020330364965, -148.1917562206577, 147.49859861375063, 174.62054058926404, -232.75274283085722, 67.8496582114378, -182.81732468561668, -222.74686347446823, -175.73340963367662, -255.79353252339013, 84.86021502115042, -356.74854128300365, -99.8838854408288, -110.08892941850387, -88.85845979203208, 35.03824699619557, -318.2874789870164, -103.7891144200481, -358.26913312254646, 22.957300598691873, 26.362580728919355, -468.56793881303247, 167.6, -394.5897941454148, -22.402434892301095, 0.05508829850292263, 21.573586067315848, 35.036518045582454, -333.83594260048153, 106.25267844150724, -464.65466536948793, -13.320435851188167, -404.5566822546191, -114.75292145275995, -193.3814656120076, 149.00100547352076, -383.8324216470795, 141.97672000117007], "policy_predator_policy_reward": [304.1544353638321, 222.39101058188436, 302.7497183146167, 276.8832293614368, 506.359227603927, 325.10939970244414, 244.23049180171407, 270.4069605388638, 366.8414254600149, 80.11626191611454, 254.95432387866643, 382.38945204896413, 428.7827759883978, 261.84424507709747, 191.68546399401112, 419.1519418611286, 115.16906572963018, 356.00342804957893, 245.00204112808535, 218.23550164248095, 226.284806293484, 90.92123082543694, 467.33647640433605, 429.04225358743764, 371.4518313330238, 261.70338065583684, 382.7235577181691, 407.2206959953529, 574.6627423675703, 157.76911547976692, 238.30372367296118, 351.44763157414553, 304.26242736984386, 345.5344511678269, 203.81667092856895, 277.1769297211099, 235.20725701039063, 389.5023815520427, 330.2369165958814, 382.79098870888123, 245.05562809540672, 229.4871466688971, 291.68398648115385, 329.8731646409506, 386.5080050562604, 195.70359228800322, 262.9917534350259, 373.1581138462092, 245.1140957205569, 502.99259604119925, 379.2233564536242, 237.73293971015812, 347.97752393864, 292.02328814458804, 302.8541907783359, 351.1277273706819, 120.4166008754553, 348.55009308647897, 345.2419734026613, 396.9011833510309, 157.59679656928537, 397.5133776170149, 154.6069708048023, 320.8857383279336, 494.31406120458433, 417.9019739808911, 112.53834154602289, 96.56618082328488, 446.25234948106623, 498.39087719914124, 438.8884526887892, 310.7432582553521, 442.97261212845837, 586.0007628483829, 160.03682117474858, 409.16916219794496, 318.4447251696986, 404.2004301190797, 511.89178384000377, 275.81193816704223, 298.52875611110625, 215.012995461611, 240.28989424541797, 291.85480537120554, 133.90699515640924, 227.05406696884648, 121.77079705773554, 245.72072368835973, 285.24338950582836, 285.56882133854486, 211.62827752528716, 60.8321622322896, 249.19235488518316, 362.0036362147133, 160.74745635307593, 149.83817102897083, 135.5589195505255, 472.91941764095026, 209.20312488873554, 294.4242161354286, 384.18979839036143, 163.94292713570658, 217.1349510456525, 137.0960062720841, 366.19457506203526, 199.7715479030872, 246.18594650114036, 278.2107136586397, 316.3765433369094, 353.3655919277894, 160.64968816442678, 308.1574754624644, 458.15003200232104, 445.4826242845522, 387.26532364922855, 296.1844700345436, 237.53366486758514, 393.2322454525385, 244.3114894776199, 295.91085381981844, 328.4764682148405, 317.82709194464303, 199.26364003311835, 434.3274685903029, 369.94264367703295, 236.50437993836312, 337.1638427392671, 392.62724180507473, 132.55883244539294, 342.9498717253863, 82.665940984712, 257.0529712019942, 154.86434975841766, 305.94658412406744, 356.3530108302506, 373.2364959867133, 258.92856882481226, 369.82750026412214, 324.75576030766496, 295.0942084137096, 184.51890341337588, 266.3880700551676, 235.36504528335664, 42.58440820239263, 139.92644255264437, 64.9646288316496, 172.68082711166912, 182.8116782050243, 431.8440639906705, 406.9852807959266, 334.64339866484886, 582.9967115790288, 334.2981019543961, 336.65596763411753, 337.6431262402065, 394.8828197497942, 328.34465929701594, 339.090028314005, 452.33875337599704, 237.99305173968008, 231.61284584311872, 176.9936616034658, 19.571437137953886, 283.27741065791867, 288.25080475385386, 409.866347061956, 413.622410720726, 678.3863984946718, 266.576367932772, 295.2038047190534, 226.89337890313672, 217.53555067274922, 78.20406863497861, 351.94422912770005, 310.80263489293486, 266.43603472041343, 183.61356208074886, 203.629287863909, 311.3549821892981, 201.78446176982808, 220.10398270801215, 429.39431969253803, 338.52556936480516, 413.3020503611055, 359.57838032508084, 324.25094946932865, 229.4572860170493, 361.26913312254675, 392.6986880079548, 400.450873500503, 353.5358189983051, 196.6167327746737, 272.6105182763668, 248.46942061158967, 312.4620045397892, 409.0366677453413, 357.6945520710292, 447.79712615769813, 208.28434652952694, 341.85714104367685]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.879032600818132, "mean_inference_ms": 5.720639853059437, "mean_action_processing_ms": 2.3857726732703153, "mean_env_wait_ms": 14.91582299277356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004595041275024414, "StateBufferConnector_ms": 0.005190134048461914, "ViewRequirementAgentConnector_ms": 0.16856002807617188}, "num_episodes": 19, "episode_return_max": 548.3627213094748, "episode_return_min": -18.429156325679102, "episode_return_mean": 223.09539641644517, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1220000, "num_agent_steps_trained": 1220000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.37224281366929, "num_env_steps_trained_throughput_per_sec": 66.37224281366929, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 1220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1220000, "timers": {"training_iteration_time_ms": 59710.039, "restore_workers_time_ms": 0.014, "training_step_time_ms": 59709.982, "sample_time_ms": 2203.012, "learn_time_ms": 57490.531, "learn_throughput": 69.577, "synch_weights_time_ms": 13.92}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 1220000, "num_agent_steps_trained": 1220000}, "done": false, "training_iteration": 61, "trial_id": "62684_00000", "date": "2024-08-20_17-19-04", "timestamp": 1724154544, "time_this_iter_s": 60.30909967422485, "time_total_s": 4274.369928598404, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3acae6b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4274.369928598404, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 25.324418604651157, "ram_util_percent": 82.41395348837209}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.68620158099959, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.582623116344425, "policy_loss": -0.019278069462706434, "vf_loss": 7.599035866209801, "vf_explained_var": 0.49765022883178495, "kl": 0.014326564841639541, "entropy": 0.8951678117750385, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 173430.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.463268853369213, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.705677220682619, "policy_loss": -0.024828019656398623, "vf_loss": 8.727754400142286, "vf_explained_var": -0.1251187559158083, "kl": 0.01375411270080361, "entropy": 0.5392485921187375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "env_runners": {"episode_reward_max": 548.3627213094748, "episode_reward_min": -59.3330375558688, "episode_reward_mean": 228.9988406081909, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -566.2332703671892, "predator_policy": 19.571437137953886}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 678.3863984946718}, "policy_reward_mean": {"prey_policy": -129.36734754394024, "predator_policy": 308.5504416200059}, "custom_metrics": {}, "hist_stats": {"episode_reward": [421.24988152040976, 274.2309352131775, 177.3980306473103, 133.4532021319625, 173.69851943482072, 167.38009629483568, 154.23429155856755, 106.2158561650171, 207.2038681090065, 115.16904015336928, 201.91278317692166, 363.0854422289946, 342.934061028582, 176.69846603453144, 266.61898659264045, 183.67852570253467, 396.6865603599967, 124.22870981005495, 57.134335324714286, 258.6126468856111, 134.79999999999978, 238.99999999999952, 192.3018031865639, 207.02067718757132, 267.31230439743814, 194.154963369352, 548.3627213094748, 313.46264485221604, 253.21967566909632, 188.9430854917956, 225.7649742007156, 452.01994857335126, 197.0545452346665, 428.3248823577814, 316.5072531422796, 133.45333164356566, 312.3921658095859, 229.61941600850642, 195.92701163913517, 18.94279055339244, 102.93902616269438, 39.52340278649524, 158.09999999999934, 358.7084001670207, 284.5601736524134, 150.27916031318273, 19.693637061909605, 194.76934815717172, 470.4831574214022, 194.91040196216147, 130.87946080534434, 221.0915659841063, 398.85198793096447, 237.61124123289898, 172.02454821984375, 347.2914367235978, 92.20485182965754, 70.49675775193283, -18.429156325679102, 437.7261328883766, 240.11442630239776, 207.3400724554442, 252.1324333689829, 260.61502372478554, 476.6092463168157, 175.42491401047914, 302.8315752646348, 185.10626358357428, 311.7216380115574, 151.6254721956924, 518.5442034243447, 133.21541103376512, 243.85410040037158, 349.77624950596305, 92.80060890934098, 457.28679140081533, 170.80721795569238, 174.7130526383783, 299.9174961254466, 500.91627656093254, 386.4508033757407, 108.10000000000002, 89.45648695377326, 426.86372554265716, 211.27451725027223, -59.3330375558688, -17.26945062767941, 143.10164455700823, 428.01784539292913, 200.80603486963335, 50.853589078107134, 412.39803040302735, 81.98761016778427, 314.7178928828444, 161.10993527126533, 316.17414752525667, 162.5807060619148, 162.81760781401192, 285.40908401027735, 114.89044693167989], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-212.78699161402434, -208.0088233185653, 93.93900469123993, -92.87660861845363, -205.05116356171823, -44.79758877043312, -344.97011458227877, 55.62995763829722, -173.2626244919361, -5.0866175507933615, -223.86359592076408, -291.5785025454969, 50.85093160351818, -1.3938158448234965, -344.72529028580755, -525.9725085010725, 16.45253932356118, -65.24309128134436, -276.56356435326376, -112.6657596004055, -11.646558674063245, -174.11959275893497, 84.61368360794486, -279.77094381672896, -269.12757352604905, 41.01349859029016, -476.89809214070823, -51.60181455003743, 74.25624070209219, -116.58990836799373, -537.7294888585312, -326.55975261822704, 121.55879797347322, 190.04436425039577, -132.29625149721548, -444.2943814683265, -439.725855666187, -214.91369243971806, -31.39976584235349, -119.15478674314582, 135.7164316029286, -409.06916219794493, -107.57244841654114, 74.89999999999998, -423.3537202795962, -317.0059421583752, -319.01141097381026, 31.992156827675682, -140.8946403007761, 80.10880938366792, -56.06936029561531, 44.3271319971075, -172.05797207106448, -280.1851497326118, -39.817017805369616, -274.84649796748585, 10.836788972315059, -137.1552384112107, 188.29999999999998, -160.0236354492729, -273.2823915462621, -226.7195433837505, 63.98972408564058, -173.44234633226276, 40.40371431275671, 99.57819226192937, -235.43379626556685, -357.8036362147129, 174.34324456694773, 92.93959855661981, -112.64398239436207, -83.86056635673283, -25.046615153087387, 153.2, -469.31941764095046, -37.95606011919049, 114.7564446442249, -386.27276217984695, -386.2700042165936, 200.0, 186.49999999999997, -178.00883648535847, -57.237505540173004, 194.47802956001038, -24.22831375983285, -43.23871701106373, -245.27941652513002, -86.63023828354024, -272.9314825201076, 24.108146135664096, 182.0003961858592, -290.7683733257916, -335.2091839240494, -26.758012004389297, 134.08022975338932, -124.10943280254125, -34.435454091859555, -279.8019373099052, -392.34071965043984, 145.57592519773198, -420.0316333453019, 19.330796821579632, -31.289318809362456, -189.64098912641072, -93.3283492420707, -262.11159035082676, -25.731804611477028, -118.92561669156495, 137.05578613327106, -52.36432669293361, -418.6028537902354, -50.350815939567376, 84.66034630404258, -438.2812229793889, -330.2263122394268, -194.1091191046757, 113.81541936784205, -309.4560152655897, -10.164632979467022, -391.22764574589155, -1.5676529389315066, -336.2854479198803, -34.71657714927342, -287.8441356621535, -0.41645846085549865, -11.934915277202272, -64.1643497584179, -301.74658412406717, 63.19999999999996, 183.5014250589688, -127.8019182314753, -426.58061347743666, -184.85033856380943, -233.34042141131263, 73.99486453860041, 24.82433989451188, -206.89515086749321, -287.4999974352093, -300.9158418283585, -46.006278614950354, -84.29121596332357, -35.80789021641745, -58.543650460658085, 11.171435348498665, 157.74161587195547, 162.44639773201277, -54.59592756686014, -105.55304195684208, -95.21885805264174, 40.18979665495225, -414.64542940063404, -394.2900520026513, 100.98559742203335, -488.70880233444336, 92.76192121098899, -300.6016631363154, 22.78411490959894, 152.9412443259227, -447.8274408930712, -456.1207282175407, -63.90749548682552, 25.113518947265366, -23.2994903587034, -290.72079441556326, -181.38985461690916, 137.9503412306957, -242.96690333755868, -238.02380628521652, 22.061913880555014, -224.21284584311914, -114.25072365436253, -35.44894094028132, -130.19501881536212, -66.70813028829672, -286.3508603582835, -411.3255905903912, -18.86985719281402, -392.5797361452392, -287.4571248853936, 25.754184703613248, -232.37636793277125, -264.80380471905295, 175.51442630239794, -223.6124552225745, 190.63402040208737, -204.11042229995462, 42.40405240281474, -132.21022193413788, -88.20969486237108, 98.47014336858994, -266.9020330364965, -148.1917562206577, 147.49859861375063, 174.62054058926404, -232.75274283085722, 67.8496582114378, -182.81732468561668, -222.74686347446823, -175.73340963367662, -255.79353252339013, 84.86021502115042, -356.74854128300365, -99.8838854408288, -110.08892941850387, -88.85845979203208, 35.03824699619557, -318.2874789870164, -103.7891144200481, -358.26913312254646, 22.957300598691873, 26.362580728919355, -468.56793881303247, 167.6, -394.5897941454148, -22.402434892301095, 0.05508829850292263, 21.573586067315848, 35.036518045582454, -333.83594260048153, 106.25267844150724, -464.65466536948793, -13.320435851188167, -404.5566822546191, -114.75292145275995, -193.3814656120076, 149.00100547352076, -383.8324216470795, 141.97672000117007, -271.24130862664254, 121.65297454161696, -232.34742466887147, -134.58492786276844, -157.20683590918262, -69.78196376848359, -176.3421642979213, 121.21627700958169, -551.4887460336582, 185.62900457269978, 36.06825669396281, -415.2219055955925, 55.08979245489617, -87.76013050411605, -244.57124365789048, -188.63873912591154, -146.81362926749696, -169.78068925453636, -397.3908823818839, -244.72870790113288, -198.72235475085705, -433.921636892162, 162.95331517240191, -104.97861036182417, 84.3265899114784, -265.45360798390686, 37.90355076166007, -306.0774725776612, -244.71417413422853, -168.47831169104688, -368.10075405303417, -101.40217138579874, -366.45168797009416, -195.4459439450142, -58.09673047196101, -256.0444364577696, 74.75741254195214, 28.556753331194216, -546.979110731054, 198.2, -523.6627791855501, -531.3628207388412, -100.18307658240965, -303.21618226368594, -108.77717662352521, 178.09831804445483, -255.3830937365263, -305.73709981219514, -130.75062556234613, 20.587835573569237, -343.71870074014424, -136.60063608059625, -159.9053363306118, 36.537245678116605, -178.06983377895187, 21.826810626297338, -327.20629484474756, -4.733468863739461, -566.2332703671892, -39.66342965808028, -191.64001608188377, -132.80331756743252, -56.873529267988744, -271.97724019523605, -107.71766395819535, -122.78808353507182, -32.293391981628105, 60.90332515613258, -489.6512974030707, 31.210259949622635, -239.59084151854017, -199.73316117042168], "policy_predator_policy_reward": [245.1140957205569, 502.99259604119925, 379.2233564536242, 237.73293971015812, 347.97752393864, 292.02328814458804, 302.8541907783359, 351.1277273706819, 120.4166008754553, 348.55009308647897, 345.2419734026613, 396.9011833510309, 157.59679656928537, 397.5133776170149, 154.6069708048023, 320.8857383279336, 494.31406120458433, 417.9019739808911, 112.53834154602289, 96.56618082328488, 446.25234948106623, 498.39087719914124, 438.8884526887892, 310.7432582553521, 442.97261212845837, 586.0007628483829, 160.03682117474858, 409.16916219794496, 318.4447251696986, 404.2004301190797, 511.89178384000377, 275.81193816704223, 298.52875611110625, 215.012995461611, 240.28989424541797, 291.85480537120554, 133.90699515640924, 227.05406696884648, 121.77079705773554, 245.72072368835973, 285.24338950582836, 285.56882133854486, 211.62827752528716, 60.8321622322896, 249.19235488518316, 362.0036362147133, 160.74745635307593, 149.83817102897083, 135.5589195505255, 472.91941764095026, 209.20312488873554, 294.4242161354286, 384.18979839036143, 163.94292713570658, 217.1349510456525, 137.0960062720841, 366.19457506203526, 199.7715479030872, 246.18594650114036, 278.2107136586397, 316.3765433369094, 353.3655919277894, 160.64968816442678, 308.1574754624644, 458.15003200232104, 445.4826242845522, 387.26532364922855, 296.1844700345436, 237.53366486758514, 393.2322454525385, 244.3114894776199, 295.91085381981844, 328.4764682148405, 317.82709194464303, 199.26364003311835, 434.3274685903029, 369.94264367703295, 236.50437993836312, 337.1638427392671, 392.62724180507473, 132.55883244539294, 342.9498717253863, 82.665940984712, 257.0529712019942, 154.86434975841766, 305.94658412406744, 356.3530108302506, 373.2364959867133, 258.92856882481226, 369.82750026412214, 324.75576030766496, 295.0942084137096, 184.51890341337588, 266.3880700551676, 235.36504528335664, 42.58440820239263, 139.92644255264437, 64.9646288316496, 172.68082711166912, 182.8116782050243, 431.8440639906705, 406.9852807959266, 334.64339866484886, 582.9967115790288, 334.2981019543961, 336.65596763411753, 337.6431262402065, 394.8828197497942, 328.34465929701594, 339.090028314005, 452.33875337599704, 237.99305173968008, 231.61284584311872, 176.9936616034658, 19.571437137953886, 283.27741065791867, 288.25080475385386, 409.866347061956, 413.622410720726, 678.3863984946718, 266.576367932772, 295.2038047190534, 226.89337890313672, 217.53555067274922, 78.20406863497861, 351.94422912770005, 310.80263489293486, 266.43603472041343, 183.61356208074886, 203.629287863909, 311.3549821892981, 201.78446176982808, 220.10398270801215, 429.39431969253803, 338.52556936480516, 413.3020503611055, 359.57838032508084, 324.25094946932865, 229.4572860170493, 361.26913312254675, 392.6986880079548, 400.450873500503, 353.5358189983051, 196.6167327746737, 272.6105182763668, 248.46942061158967, 312.4620045397892, 409.0366677453413, 357.6945520710292, 447.79712615769813, 208.28434652952694, 341.85714104367685, 272.0309715642941, 280.7120051452951, 234.0804307008443, 302.2063494779682, 414.58591895713585, 491.9462104903071, 373.8958745615615, 320.5450463283002, 365.89964012211493, 297.7927449607344, 197.23873912591097, 416.09431852203284, 409.4137296841633, 520.8847023034848, 376.0223850125393, 426.7882726117022, 191.5144860256301, 162.98349853541117, 297.7594293824635, 362.17749146460443, 322.7710872794109, 495.91407550183743, 353.90719768625587, 298.78155774549657, 498.0177978472058, 373.6649924036306, 533.055740465324, 524.5758943287011, 319.99964637161133, 243.03037817611627, 384.08759096659793, 411.33231494069616, 241.76293177314528, 294.1061691235602, 252.98601522703186, 321.70060438890295, 279.2267688172142, 365.3324844514545, 521.2500009432242, 405.5543154710431, 308.2321607165789, 235.66540826264153, 286.27724019523635, 379.0233553072791, 290.33760718510524, 456.1128410537392, 231.01705959483405, 291.98713007618454]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.834015019345755, "mean_inference_ms": 5.679872110195707, "mean_action_processing_ms": 2.3624337656300525, "mean_env_wait_ms": 14.829942723753373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008340239524841309, "StateBufferConnector_ms": 0.0051271915435791016, "ViewRequirementAgentConnector_ms": 0.16195595264434814}, "num_episodes": 24, "episode_return_max": 548.3627213094748, "episode_return_min": -59.3330375558688, "episode_return_mean": 228.9988406081909, "episodes_this_iter": 24}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.93597800758724, "num_env_steps_trained_throughput_per_sec": 66.93597800758724, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 1240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1240000, "timers": {"training_iteration_time_ms": 59715.34, "restore_workers_time_ms": 0.015, "training_step_time_ms": 59715.284, "sample_time_ms": 2256.644, "learn_time_ms": 57442.172, "learn_throughput": 69.635, "synch_weights_time_ms": 14.002}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "done": false, "training_iteration": 62, "trial_id": "62684_00000", "date": "2024-08-20_17-20-04", "timestamp": 1724154604, "time_this_iter_s": 59.804198026657104, "time_total_s": 4334.174126625061, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3acade670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4334.174126625061, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 24.701190476190472, "ram_util_percent": 82.67261904761902}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.941902698143155, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.4939429210432875, "policy_loss": -0.018991609024963878, "vf_loss": 7.509986371520563, "vf_explained_var": 0.5398059653263565, "kl": 0.014740842488323544, "entropy": 0.8839037398497264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 176250.5, "diff_num_grad_updates_vs_sampler_policy": 1448.9800000000105}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.917451269601388, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.58183957760927, "policy_loss": -0.029049523783818122, "vf_loss": 8.60802328069374, "vf_explained_var": -0.19353797908813233, "kl": 0.01432907794055248, "entropy": 0.526588639758882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 970.9600000000065}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "env_runners": {"episode_reward_max": 548.3627213094748, "episode_reward_min": -59.3330375558688, "episode_reward_mean": 221.2983298817674, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -625.2119859200237, "predator_policy": 19.571437137953886}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 678.3863984946718}, "policy_reward_mean": {"prey_policy": -137.67559539032305, "predator_policy": 317.1625580263684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [238.99999999999952, 192.3018031865639, 207.02067718757132, 267.31230439743814, 194.154963369352, 548.3627213094748, 313.46264485221604, 253.21967566909632, 188.9430854917956, 225.7649742007156, 452.01994857335126, 197.0545452346665, 428.3248823577814, 316.5072531422796, 133.45333164356566, 312.3921658095859, 229.61941600850642, 195.92701163913517, 18.94279055339244, 102.93902616269438, 39.52340278649524, 158.09999999999934, 358.7084001670207, 284.5601736524134, 150.27916031318273, 19.693637061909605, 194.76934815717172, 470.4831574214022, 194.91040196216147, 130.87946080534434, 221.0915659841063, 398.85198793096447, 237.61124123289898, 172.02454821984375, 347.2914367235978, 92.20485182965754, 70.49675775193283, -18.429156325679102, 437.7261328883766, 240.11442630239776, 207.3400724554442, 252.1324333689829, 260.61502372478554, 476.6092463168157, 175.42491401047914, 302.8315752646348, 185.10626358357428, 311.7216380115574, 151.6254721956924, 518.5442034243447, 133.21541103376512, 243.85410040037158, 349.77624950596305, 92.80060890934098, 457.28679140081533, 170.80721795569238, 174.7130526383783, 299.9174961254466, 500.91627656093254, 386.4508033757407, 108.10000000000002, 89.45648695377326, 426.86372554265716, 211.27451725027223, -59.3330375558688, -17.26945062767941, 143.10164455700823, 428.01784539292913, 200.80603486963335, 50.853589078107134, 412.39803040302735, 81.98761016778427, 314.7178928828444, 161.10993527126533, 316.17414752525667, 162.5807060619148, 162.81760781401192, 285.40908401027735, 114.89044693167989, 230.15790577407728, 102.10918432754636, 174.24616110955276, 152.37708200717697, 113.196020446235, 168.24152874804236, 168.4364173736883, 25.910020049542307, 174.28140173280917, 214.94915701187963, 95.00684825886759, 36.82194556916006, 207.5774413880433, 280.30783060057695, 305.863407296074, 179.238436747789, 384.932298401532, 163.89203017276262, 207.21155810838425, 202.29647997196255, 79.52001063500639], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-173.44234633226276, 40.40371431275671, 99.57819226192937, -235.43379626556685, -357.8036362147129, 174.34324456694773, 92.93959855661981, -112.64398239436207, -83.86056635673283, -25.046615153087387, 153.2, -469.31941764095046, -37.95606011919049, 114.7564446442249, -386.27276217984695, -386.2700042165936, 200.0, 186.49999999999997, -178.00883648535847, -57.237505540173004, 194.47802956001038, -24.22831375983285, -43.23871701106373, -245.27941652513002, -86.63023828354024, -272.9314825201076, 24.108146135664096, 182.0003961858592, -290.7683733257916, -335.2091839240494, -26.758012004389297, 134.08022975338932, -124.10943280254125, -34.435454091859555, -279.8019373099052, -392.34071965043984, 145.57592519773198, -420.0316333453019, 19.330796821579632, -31.289318809362456, -189.64098912641072, -93.3283492420707, -262.11159035082676, -25.731804611477028, -118.92561669156495, 137.05578613327106, -52.36432669293361, -418.6028537902354, -50.350815939567376, 84.66034630404258, -438.2812229793889, -330.2263122394268, -194.1091191046757, 113.81541936784205, -309.4560152655897, -10.164632979467022, -391.22764574589155, -1.5676529389315066, -336.2854479198803, -34.71657714927342, -287.8441356621535, -0.41645846085549865, -11.934915277202272, -64.1643497584179, -301.74658412406717, 63.19999999999996, 183.5014250589688, -127.8019182314753, -426.58061347743666, -184.85033856380943, -233.34042141131263, 73.99486453860041, 24.82433989451188, -206.89515086749321, -287.4999974352093, -300.9158418283585, -46.006278614950354, -84.29121596332357, -35.80789021641745, -58.543650460658085, 11.171435348498665, 157.74161587195547, 162.44639773201277, -54.59592756686014, -105.55304195684208, -95.21885805264174, 40.18979665495225, -414.64542940063404, -394.2900520026513, 100.98559742203335, -488.70880233444336, 92.76192121098899, -300.6016631363154, 22.78411490959894, 152.9412443259227, -447.8274408930712, -456.1207282175407, -63.90749548682552, 25.113518947265366, -23.2994903587034, -290.72079441556326, -181.38985461690916, 137.9503412306957, -242.96690333755868, -238.02380628521652, 22.061913880555014, -224.21284584311914, -114.25072365436253, -35.44894094028132, -130.19501881536212, -66.70813028829672, -286.3508603582835, -411.3255905903912, -18.86985719281402, -392.5797361452392, -287.4571248853936, 25.754184703613248, -232.37636793277125, -264.80380471905295, 175.51442630239794, -223.6124552225745, 190.63402040208737, -204.11042229995462, 42.40405240281474, -132.21022193413788, -88.20969486237108, 98.47014336858994, -266.9020330364965, -148.1917562206577, 147.49859861375063, 174.62054058926404, -232.75274283085722, 67.8496582114378, -182.81732468561668, -222.74686347446823, -175.73340963367662, -255.79353252339013, 84.86021502115042, -356.74854128300365, -99.8838854408288, -110.08892941850387, -88.85845979203208, 35.03824699619557, -318.2874789870164, -103.7891144200481, -358.26913312254646, 22.957300598691873, 26.362580728919355, -468.56793881303247, 167.6, -394.5897941454148, -22.402434892301095, 0.05508829850292263, 21.573586067315848, 35.036518045582454, -333.83594260048153, 106.25267844150724, -464.65466536948793, -13.320435851188167, -404.5566822546191, -114.75292145275995, -193.3814656120076, 149.00100547352076, -383.8324216470795, 141.97672000117007, -271.24130862664254, 121.65297454161696, -232.34742466887147, -134.58492786276844, -157.20683590918262, -69.78196376848359, -176.3421642979213, 121.21627700958169, -551.4887460336582, 185.62900457269978, 36.06825669396281, -415.2219055955925, 55.08979245489617, -87.76013050411605, -244.57124365789048, -188.63873912591154, -146.81362926749696, -169.78068925453636, -397.3908823818839, -244.72870790113288, -198.72235475085705, -433.921636892162, 162.95331517240191, -104.97861036182417, 84.3265899114784, -265.45360798390686, 37.90355076166007, -306.0774725776612, -244.71417413422853, -168.47831169104688, -368.10075405303417, -101.40217138579874, -366.45168797009416, -195.4459439450142, -58.09673047196101, -256.0444364577696, 74.75741254195214, 28.556753331194216, -546.979110731054, 198.2, -523.6627791855501, -531.3628207388412, -100.18307658240965, -303.21618226368594, -108.77717662352521, 178.09831804445483, -255.3830937365263, -305.73709981219514, -130.75062556234613, 20.587835573569237, -343.71870074014424, -136.60063608059625, -159.9053363306118, 36.537245678116605, -178.06983377895187, 21.826810626297338, -327.20629484474756, -4.733468863739461, -566.2332703671892, -39.66342965808028, -191.64001608188377, -132.80331756743252, -56.873529267988744, -271.97724019523605, -107.71766395819535, -122.78808353507182, -32.293391981628105, 60.90332515613258, -489.6512974030707, 31.210259949622635, -239.59084151854017, -199.73316117042168, 196.4, -254.6077058559925, -314.21574662135254, -157.75032189560176, -106.21214506384177, -265.6376482813048, -105.62712814970821, -625.2119859200237, 151.06873446129444, -313.18866257154417, 8.463953007720177, -141.79368013909598, -365.3021812932898, -124.79988712440986, -6.284700201125752, -565.5709701153572, -59.93455725266348, -143.22231112751558, -328.8068274462995, 149.5999999999997, -324.14207355718116, -566.8297149569253, 18.71002004954218, -483.66039909060737, -207.1693666099595, 171.16235387286127, -348.88114225960084, -413.0755022978961, 186.28737040289303, -146.465062459342, -391.84611900754993, -240.12316507926835, 6.596152546646678, 33.2938385703542, -346.39129485999825, -516.6790942844158, -172.15543225309148, -4.075195516355857, -123.05237368960815, 157.57701892817158, -587.8948451122162, -314.1959515674259, -60.747030726861915, -437.67664936064944, 169.63490216890347, -350.9477255568437, -1.4299675777654484, -86.55975687484818, 182.9, 143.3, -270.7591760467839, -122.320055900812, -56.18744697045452, -460.774739694729, -382.67671910493254, -252.85454000094703, -82.3321889812698, -291.8200689467954, 127.87369613242714, -311.94074940996126, -199.86002171600094, -396.1677492977656, -98.69380577660493], "policy_predator_policy_reward": [211.62827752528716, 60.8321622322896, 249.19235488518316, 362.0036362147133, 160.74745635307593, 149.83817102897083, 135.5589195505255, 472.91941764095026, 209.20312488873554, 294.4242161354286, 384.18979839036143, 163.94292713570658, 217.1349510456525, 137.0960062720841, 366.19457506203526, 199.7715479030872, 246.18594650114036, 278.2107136586397, 316.3765433369094, 353.3655919277894, 160.64968816442678, 308.1574754624644, 458.15003200232104, 445.4826242845522, 387.26532364922855, 296.1844700345436, 237.53366486758514, 393.2322454525385, 244.3114894776199, 295.91085381981844, 328.4764682148405, 317.82709194464303, 199.26364003311835, 434.3274685903029, 369.94264367703295, 236.50437993836312, 337.1638427392671, 392.62724180507473, 132.55883244539294, 342.9498717253863, 82.665940984712, 257.0529712019942, 154.86434975841766, 305.94658412406744, 356.3530108302506, 373.2364959867133, 258.92856882481226, 369.82750026412214, 324.75576030766496, 295.0942084137096, 184.51890341337588, 266.3880700551676, 235.36504528335664, 42.58440820239263, 139.92644255264437, 64.9646288316496, 172.68082711166912, 182.8116782050243, 431.8440639906705, 406.9852807959266, 334.64339866484886, 582.9967115790288, 334.2981019543961, 336.65596763411753, 337.6431262402065, 394.8828197497942, 328.34465929701594, 339.090028314005, 452.33875337599704, 237.99305173968008, 231.61284584311872, 176.9936616034658, 19.571437137953886, 283.27741065791867, 288.25080475385386, 409.866347061956, 413.622410720726, 678.3863984946718, 266.576367932772, 295.2038047190534, 226.89337890313672, 217.53555067274922, 78.20406863497861, 351.94422912770005, 310.80263489293486, 266.43603472041343, 183.61356208074886, 203.629287863909, 311.3549821892981, 201.78446176982808, 220.10398270801215, 429.39431969253803, 338.52556936480516, 413.3020503611055, 359.57838032508084, 324.25094946932865, 229.4572860170493, 361.26913312254675, 392.6986880079548, 400.450873500503, 353.5358189983051, 196.6167327746737, 272.6105182763668, 248.46942061158967, 312.4620045397892, 409.0366677453413, 357.6945520710292, 447.79712615769813, 208.28434652952694, 341.85714104367685, 272.0309715642941, 280.7120051452951, 234.0804307008443, 302.2063494779682, 414.58591895713585, 491.9462104903071, 373.8958745615615, 320.5450463283002, 365.89964012211493, 297.7927449607344, 197.23873912591097, 416.09431852203284, 409.4137296841633, 520.8847023034848, 376.0223850125393, 426.7882726117022, 191.5144860256301, 162.98349853541117, 297.7594293824635, 362.17749146460443, 322.7710872794109, 495.91407550183743, 353.90719768625587, 298.78155774549657, 498.0177978472058, 373.6649924036306, 533.055740465324, 524.5758943287011, 319.99964637161133, 243.03037817611627, 384.08759096659793, 411.33231494069616, 241.76293177314528, 294.1061691235602, 252.98601522703186, 321.70060438890295, 279.2267688172142, 365.3324844514545, 521.2500009432242, 405.5543154710431, 308.2321607165789, 235.66540826264153, 286.27724019523635, 379.0233553072791, 290.33760718510524, 456.1128410537392, 231.01705959483405, 291.98713007618454, 286.9443139560261, 315.6370442953968, 328.4462541653433, 303.26304540295195, 583.1436474006941, 170.8728933172972, 240.58191373300195, 358.3135579770944, 255.45025530097848, 354.13253376408227, 418.4029451281029, 518.5664221154761, 326.9420735571811, 344.84324481998846, 483.8603990906074, 573.8297149569252, 326.6478954383347, 232.52166129117418, 416.0755022978959, 172.12684906832882, 395.199106284597, 325.1808735144415, 324.42149733666236, 542.1769988065597, 238.02278962905604, 268.83765321804253, 508.140981022711, 516.680627329335, 430.22255204979666, 204.42963316488556, 380.9477255568437, 237.2281612004031, 141.83726502961082, 187.65420941870542, 527.0585249554665, 276.11574778329197, 537.303961464657, 387.7710447308782, 295.2331394932503, 382.9504627030436, 405.2004241219859, 369.0411633033926]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.804731059499337, "mean_inference_ms": 5.66214115732967, "mean_action_processing_ms": 2.357003651375377, "mean_env_wait_ms": 14.770838985607945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008299112319946289, "StateBufferConnector_ms": 0.005158662796020508, "ViewRequirementAgentConnector_ms": 0.15394222736358643}, "num_episodes": 21, "episode_return_max": 548.3627213094748, "episode_return_min": -59.3330375558688, "episode_return_mean": 221.2983298817674, "episodes_this_iter": 21}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.26330761745547, "num_env_steps_trained_throughput_per_sec": 66.26330761745547, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 59783.169, "restore_workers_time_ms": 0.014, "training_step_time_ms": 59783.115, "sample_time_ms": 2274.524, "learn_time_ms": 57492.259, "learn_throughput": 69.575, "synch_weights_time_ms": 13.762}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "training_iteration": 63, "trial_id": "62684_00000", "date": "2024-08-20_17-21-04", "timestamp": 1724154664, "time_this_iter_s": 60.43003869056702, "time_total_s": 4394.604165315628, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ff9b4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4394.604165315628, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 25.31529411764706, "ram_util_percent": 82.83647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.732809090107045, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.121770460385803, "policy_loss": -0.01878185298364834, "vf_loss": 7.137737975729273, "vf_explained_var": 0.4753391888124723, "kl": 0.014071602805299645, "entropy": 0.8831085873199693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 179070.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.494104212995559, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.353910916444486, "policy_loss": -0.02673095313883904, "vf_loss": 8.377699814397822, "vf_explained_var": -0.35615702012859324, "kl": 0.014710425048396385, "entropy": 0.5244735316467033, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 518.5442034243447, "episode_reward_min": -59.3330375558688, "episode_reward_mean": 212.2435117789902, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -625.2119859200237, "predator_policy": 19.571437137953886}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 678.3863984946718}, "policy_reward_mean": {"prey_policy": -144.7872229840642, "predator_policy": 323.3025903655916}, "custom_metrics": {}, "hist_stats": {"episode_reward": [133.45333164356566, 312.3921658095859, 229.61941600850642, 195.92701163913517, 18.94279055339244, 102.93902616269438, 39.52340278649524, 158.09999999999934, 358.7084001670207, 284.5601736524134, 150.27916031318273, 19.693637061909605, 194.76934815717172, 470.4831574214022, 194.91040196216147, 130.87946080534434, 221.0915659841063, 398.85198793096447, 237.61124123289898, 172.02454821984375, 347.2914367235978, 92.20485182965754, 70.49675775193283, -18.429156325679102, 437.7261328883766, 240.11442630239776, 207.3400724554442, 252.1324333689829, 260.61502372478554, 476.6092463168157, 175.42491401047914, 302.8315752646348, 185.10626358357428, 311.7216380115574, 151.6254721956924, 518.5442034243447, 133.21541103376512, 243.85410040037158, 349.77624950596305, 92.80060890934098, 457.28679140081533, 170.80721795569238, 174.7130526383783, 299.9174961254466, 500.91627656093254, 386.4508033757407, 108.10000000000002, 89.45648695377326, 426.86372554265716, 211.27451725027223, -59.3330375558688, -17.26945062767941, 143.10164455700823, 428.01784539292913, 200.80603486963335, 50.853589078107134, 412.39803040302735, 81.98761016778427, 314.7178928828444, 161.10993527126533, 316.17414752525667, 162.5807060619148, 162.81760781401192, 285.40908401027735, 114.89044693167989, 230.15790577407728, 102.10918432754636, 174.24616110955276, 152.37708200717697, 113.196020446235, 168.24152874804236, 168.4364173736883, 25.910020049542307, 174.28140173280917, 214.94915701187963, 95.00684825886759, 36.82194556916006, 207.5774413880433, 280.30783060057695, 305.863407296074, 179.238436747789, 384.932298401532, 163.89203017276262, 207.21155810838425, 202.29647997196255, 79.52001063500639, 135.81926266646883, 411.8987543347936, 206.64243580015122, 182.93656189637932, 176.91462132264613, 202.71477753173693, 278.60232408293376, 120.7583249582679, 263.12044085048205, 339.61109903595184, 148.31453288056122, 406.1109442363754, 109.61542047213054, 134.90816862570418], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-262.11159035082676, -25.731804611477028, -118.92561669156495, 137.05578613327106, -52.36432669293361, -418.6028537902354, -50.350815939567376, 84.66034630404258, -438.2812229793889, -330.2263122394268, -194.1091191046757, 113.81541936784205, -309.4560152655897, -10.164632979467022, -391.22764574589155, -1.5676529389315066, -336.2854479198803, -34.71657714927342, -287.8441356621535, -0.41645846085549865, -11.934915277202272, -64.1643497584179, -301.74658412406717, 63.19999999999996, 183.5014250589688, -127.8019182314753, -426.58061347743666, -184.85033856380943, -233.34042141131263, 73.99486453860041, 24.82433989451188, -206.89515086749321, -287.4999974352093, -300.9158418283585, -46.006278614950354, -84.29121596332357, -35.80789021641745, -58.543650460658085, 11.171435348498665, 157.74161587195547, 162.44639773201277, -54.59592756686014, -105.55304195684208, -95.21885805264174, 40.18979665495225, -414.64542940063404, -394.2900520026513, 100.98559742203335, -488.70880233444336, 92.76192121098899, -300.6016631363154, 22.78411490959894, 152.9412443259227, -447.8274408930712, -456.1207282175407, -63.90749548682552, 25.113518947265366, -23.2994903587034, -290.72079441556326, -181.38985461690916, 137.9503412306957, -242.96690333755868, -238.02380628521652, 22.061913880555014, -224.21284584311914, -114.25072365436253, -35.44894094028132, -130.19501881536212, -66.70813028829672, -286.3508603582835, -411.3255905903912, -18.86985719281402, -392.5797361452392, -287.4571248853936, 25.754184703613248, -232.37636793277125, -264.80380471905295, 175.51442630239794, -223.6124552225745, 190.63402040208737, -204.11042229995462, 42.40405240281474, -132.21022193413788, -88.20969486237108, 98.47014336858994, -266.9020330364965, -148.1917562206577, 147.49859861375063, 174.62054058926404, -232.75274283085722, 67.8496582114378, -182.81732468561668, -222.74686347446823, -175.73340963367662, -255.79353252339013, 84.86021502115042, -356.74854128300365, -99.8838854408288, -110.08892941850387, -88.85845979203208, 35.03824699619557, -318.2874789870164, -103.7891144200481, -358.26913312254646, 22.957300598691873, 26.362580728919355, -468.56793881303247, 167.6, -394.5897941454148, -22.402434892301095, 0.05508829850292263, 21.573586067315848, 35.036518045582454, -333.83594260048153, 106.25267844150724, -464.65466536948793, -13.320435851188167, -404.5566822546191, -114.75292145275995, -193.3814656120076, 149.00100547352076, -383.8324216470795, 141.97672000117007, -271.24130862664254, 121.65297454161696, -232.34742466887147, -134.58492786276844, -157.20683590918262, -69.78196376848359, -176.3421642979213, 121.21627700958169, -551.4887460336582, 185.62900457269978, 36.06825669396281, -415.2219055955925, 55.08979245489617, -87.76013050411605, -244.57124365789048, -188.63873912591154, -146.81362926749696, -169.78068925453636, -397.3908823818839, -244.72870790113288, -198.72235475085705, -433.921636892162, 162.95331517240191, -104.97861036182417, 84.3265899114784, -265.45360798390686, 37.90355076166007, -306.0774725776612, -244.71417413422853, -168.47831169104688, -368.10075405303417, -101.40217138579874, -366.45168797009416, -195.4459439450142, -58.09673047196101, -256.0444364577696, 74.75741254195214, 28.556753331194216, -546.979110731054, 198.2, -523.6627791855501, -531.3628207388412, -100.18307658240965, -303.21618226368594, -108.77717662352521, 178.09831804445483, -255.3830937365263, -305.73709981219514, -130.75062556234613, 20.587835573569237, -343.71870074014424, -136.60063608059625, -159.9053363306118, 36.537245678116605, -178.06983377895187, 21.826810626297338, -327.20629484474756, -4.733468863739461, -566.2332703671892, -39.66342965808028, -191.64001608188377, -132.80331756743252, -56.873529267988744, -271.97724019523605, -107.71766395819535, -122.78808353507182, -32.293391981628105, 60.90332515613258, -489.6512974030707, 31.210259949622635, -239.59084151854017, -199.73316117042168, 196.4, -254.6077058559925, -314.21574662135254, -157.75032189560176, -106.21214506384177, -265.6376482813048, -105.62712814970821, -625.2119859200237, 151.06873446129444, -313.18866257154417, 8.463953007720177, -141.79368013909598, -365.3021812932898, -124.79988712440986, -6.284700201125752, -565.5709701153572, -59.93455725266348, -143.22231112751558, -328.8068274462995, 149.5999999999997, -324.14207355718116, -566.8297149569253, 18.71002004954218, -483.66039909060737, -207.1693666099595, 171.16235387286127, -348.88114225960084, -413.0755022978961, 186.28737040289303, -146.465062459342, -391.84611900754993, -240.12316507926835, 6.596152546646678, 33.2938385703542, -346.39129485999825, -516.6790942844158, -172.15543225309148, -4.075195516355857, -123.05237368960815, 157.57701892817158, -587.8948451122162, -314.1959515674259, -60.747030726861915, -437.67664936064944, 169.63490216890347, -350.9477255568437, -1.4299675777654484, -86.55975687484818, 182.9, 143.3, -270.7591760467839, -122.320055900812, -56.18744697045452, -460.774739694729, -382.67671910493254, -252.85454000094703, -82.3321889812698, -291.8200689467954, 127.87369613242714, -311.94074940996126, -199.86002171600094, -396.1677492977656, -98.69380577660493, -192.78299490751536, 8.796973479196188, -256.3424308682713, -328.1562029461385, 69.65545220875917, 176.11638332298952, -450.5184483115567, 91.34493213415337, -239.67003602421852, -328.457712636796, -168.1164009114479, 9.993994601245568, -227.30618307318184, -158.53653491431132, -73.61574391237896, -192.06083517008577, -53.360415346818904, -187.64991442445532, -24.56960739389526, 91.02081712012294, -345.22437396955837, -35.53722970898697, 24.427636460530252, -205.15199986010694, 163.33790722036758, -524.0596383513163, -93.41106133398054, 143.304751304445, -50.3380082078322, -417.80140942497854, -114.87828188666518, -468.9786389687057, -151.81053226430564, 200.0, 164.89999999999992, -338.0160218016045, -265.1899338312965, 40.30180714637318, -479.7182711501951, 113.26411774862672, -332.19282058040613, -358.5237513220669], "policy_predator_policy_reward": [244.3114894776199, 295.91085381981844, 328.4764682148405, 317.82709194464303, 199.26364003311835, 434.3274685903029, 369.94264367703295, 236.50437993836312, 337.1638427392671, 392.62724180507473, 132.55883244539294, 342.9498717253863, 82.665940984712, 257.0529712019942, 154.86434975841766, 305.94658412406744, 356.3530108302506, 373.2364959867133, 258.92856882481226, 369.82750026412214, 324.75576030766496, 295.0942084137096, 184.51890341337588, 266.3880700551676, 235.36504528335664, 42.58440820239263, 139.92644255264437, 64.9646288316496, 172.68082711166912, 182.8116782050243, 431.8440639906705, 406.9852807959266, 334.64339866484886, 582.9967115790288, 334.2981019543961, 336.65596763411753, 337.6431262402065, 394.8828197497942, 328.34465929701594, 339.090028314005, 452.33875337599704, 237.99305173968008, 231.61284584311872, 176.9936616034658, 19.571437137953886, 283.27741065791867, 288.25080475385386, 409.866347061956, 413.622410720726, 678.3863984946718, 266.576367932772, 295.2038047190534, 226.89337890313672, 217.53555067274922, 78.20406863497861, 351.94422912770005, 310.80263489293486, 266.43603472041343, 183.61356208074886, 203.629287863909, 311.3549821892981, 201.78446176982808, 220.10398270801215, 429.39431969253803, 338.52556936480516, 413.3020503611055, 359.57838032508084, 324.25094946932865, 229.4572860170493, 361.26913312254675, 392.6986880079548, 400.450873500503, 353.5358189983051, 196.6167327746737, 272.6105182763668, 248.46942061158967, 312.4620045397892, 409.0366677453413, 357.6945520710292, 447.79712615769813, 208.28434652952694, 341.85714104367685, 272.0309715642941, 280.7120051452951, 234.0804307008443, 302.2063494779682, 414.58591895713585, 491.9462104903071, 373.8958745615615, 320.5450463283002, 365.89964012211493, 297.7927449607344, 197.23873912591097, 416.09431852203284, 409.4137296841633, 520.8847023034848, 376.0223850125393, 426.7882726117022, 191.5144860256301, 162.98349853541117, 297.7594293824635, 362.17749146460443, 322.7710872794109, 495.91407550183743, 353.90719768625587, 298.78155774549657, 498.0177978472058, 373.6649924036306, 533.055740465324, 524.5758943287011, 319.99964637161133, 243.03037817611627, 384.08759096659793, 411.33231494069616, 241.76293177314528, 294.1061691235602, 252.98601522703186, 321.70060438890295, 279.2267688172142, 365.3324844514545, 521.2500009432242, 405.5543154710431, 308.2321607165789, 235.66540826264153, 286.27724019523635, 379.0233553072791, 290.33760718510524, 456.1128410537392, 231.01705959483405, 291.98713007618454, 286.9443139560261, 315.6370442953968, 328.4462541653433, 303.26304540295195, 583.1436474006941, 170.8728933172972, 240.58191373300195, 358.3135579770944, 255.45025530097848, 354.13253376408227, 418.4029451281029, 518.5664221154761, 326.9420735571811, 344.84324481998846, 483.8603990906074, 573.8297149569252, 326.6478954383347, 232.52166129117418, 416.0755022978959, 172.12684906832882, 395.199106284597, 325.1808735144415, 324.42149733666236, 542.1769988065597, 238.02278962905604, 268.83765321804253, 508.140981022711, 516.680627329335, 430.22255204979666, 204.42963316488556, 380.9477255568437, 237.2281612004031, 141.83726502961082, 187.65420941870542, 527.0585249554665, 276.11574778329197, 537.303961464657, 387.7710447308782, 295.2331394932503, 382.9504627030436, 405.2004241219859, 369.0411633033926, 209.45809790592992, 366.68961705712974, 290.9894487197717, 203.2936730294113, 351.6919140163442, 453.7940739854308, 329.7906282559197, 339.72605258745773, 304.47944333543484, 331.8936398870844, 373.1543388666714, 262.63160360642576, 395.53140588676985, 161.84408243949758, 87.46280797944925, 249.55711008738308, 455.50790026713406, 261.74533304827787, 255.51924813720467, 408.9265172271131, 474.55506307422183, 409.42692292601686, 260.8051818104332, 118.42178422754664, 292.8417569827092, 521.3800613245404, 336.29282058040627, 376.06780219914424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.781189429390968, "mean_inference_ms": 5.648021099700007, "mean_action_processing_ms": 2.313957016339463, "mean_env_wait_ms": 14.70849106310231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01280677318572998, "StateBufferConnector_ms": 0.005227804183959961, "ViewRequirementAgentConnector_ms": 0.16868078708648682}, "num_episodes": 14, "episode_return_max": 518.5442034243447, "episode_return_min": -59.3330375558688, "episode_return_mean": 212.2435117789902, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.17088502761432, "num_env_steps_trained_throughput_per_sec": 67.17088502761432, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 59765.339, "restore_workers_time_ms": 0.014, "training_step_time_ms": 59765.285, "sample_time_ms": 2275.751, "learn_time_ms": 57473.403, "learn_throughput": 69.597, "synch_weights_time_ms": 13.381}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 64, "trial_id": "62684_00000", "date": "2024-08-20_17-22-04", "timestamp": 1724154724, "time_this_iter_s": 59.61475610733032, "time_total_s": 4454.218921422958, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3acaef9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4454.218921422958, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 23.954761904761902, "ram_util_percent": 82.75714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.372856174884959, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.012999710292681, "policy_loss": -0.020216252667175486, "vf_loss": 7.030141667947701, "vf_explained_var": 0.5056551614763043, "kl": 0.015371471436707475, "entropy": 0.8964894622987044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 181890.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.538634587469556, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.362859830402193, "policy_loss": -0.027459021223765655, "vf_loss": 8.387455173018118, "vf_explained_var": -0.29357305765151975, "kl": 0.014318353414816397, "entropy": 0.5463839538986721, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1300000, "num_agent_steps_trained": 1300000}, "env_runners": {"episode_reward_max": 523.9600011608837, "episode_reward_min": -59.3330375558688, "episode_reward_mean": 217.54270276674285, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -625.2119859200237, "predator_policy": 19.571437137953886}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 678.3863984946718}, "policy_reward_mean": {"prey_policy": -145.88315950851484, "predator_policy": 327.5960906461438}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.49675775193283, -18.429156325679102, 437.7261328883766, 240.11442630239776, 207.3400724554442, 252.1324333689829, 260.61502372478554, 476.6092463168157, 175.42491401047914, 302.8315752646348, 185.10626358357428, 311.7216380115574, 151.6254721956924, 518.5442034243447, 133.21541103376512, 243.85410040037158, 349.77624950596305, 92.80060890934098, 457.28679140081533, 170.80721795569238, 174.7130526383783, 299.9174961254466, 500.91627656093254, 386.4508033757407, 108.10000000000002, 89.45648695377326, 426.86372554265716, 211.27451725027223, -59.3330375558688, -17.26945062767941, 143.10164455700823, 428.01784539292913, 200.80603486963335, 50.853589078107134, 412.39803040302735, 81.98761016778427, 314.7178928828444, 161.10993527126533, 316.17414752525667, 162.5807060619148, 162.81760781401192, 285.40908401027735, 114.89044693167989, 230.15790577407728, 102.10918432754636, 174.24616110955276, 152.37708200717697, 113.196020446235, 168.24152874804236, 168.4364173736883, 25.910020049542307, 174.28140173280917, 214.94915701187963, 95.00684825886759, 36.82194556916006, 207.5774413880433, 280.30783060057695, 305.863407296074, 179.238436747789, 384.932298401532, 163.89203017276262, 207.21155810838425, 202.29647997196255, 79.52001063500639, 135.81926266646883, 411.8987543347936, 206.64243580015122, 182.93656189637932, 176.91462132264613, 202.71477753173693, 278.60232408293376, 120.7583249582679, 263.12044085048205, 339.61109903595184, 148.31453288056122, 406.1109442363754, 109.61542047213054, 134.90816862570418, 143.4657118301791, 23.625991087922817, 84.0795645833912, 127.49999999999973, 201.24371871979486, 101.34034386345768, 151.99297380985072, 351.7423533987234, 523.9600011608837, 124.31727638549845, 467.9803641620349, 328.69344016691724, 180.7310974277418, 158.64277722705867, 400.13436861028845, 103.40314584828666, 398.5134683789435, 213.82776347573892, 371.84193730530035, 246.08049320855363, 112.10919742594156, 178.9496267638092], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-35.44894094028132, -130.19501881536212, -66.70813028829672, -286.3508603582835, -411.3255905903912, -18.86985719281402, -392.5797361452392, -287.4571248853936, 25.754184703613248, -232.37636793277125, -264.80380471905295, 175.51442630239794, -223.6124552225745, 190.63402040208737, -204.11042229995462, 42.40405240281474, -132.21022193413788, -88.20969486237108, 98.47014336858994, -266.9020330364965, -148.1917562206577, 147.49859861375063, 174.62054058926404, -232.75274283085722, 67.8496582114378, -182.81732468561668, -222.74686347446823, -175.73340963367662, -255.79353252339013, 84.86021502115042, -356.74854128300365, -99.8838854408288, -110.08892941850387, -88.85845979203208, 35.03824699619557, -318.2874789870164, -103.7891144200481, -358.26913312254646, 22.957300598691873, 26.362580728919355, -468.56793881303247, 167.6, -394.5897941454148, -22.402434892301095, 0.05508829850292263, 21.573586067315848, 35.036518045582454, -333.83594260048153, 106.25267844150724, -464.65466536948793, -13.320435851188167, -404.5566822546191, -114.75292145275995, -193.3814656120076, 149.00100547352076, -383.8324216470795, 141.97672000117007, -271.24130862664254, 121.65297454161696, -232.34742466887147, -134.58492786276844, -157.20683590918262, -69.78196376848359, -176.3421642979213, 121.21627700958169, -551.4887460336582, 185.62900457269978, 36.06825669396281, -415.2219055955925, 55.08979245489617, -87.76013050411605, -244.57124365789048, -188.63873912591154, -146.81362926749696, -169.78068925453636, -397.3908823818839, -244.72870790113288, -198.72235475085705, -433.921636892162, 162.95331517240191, -104.97861036182417, 84.3265899114784, -265.45360798390686, 37.90355076166007, -306.0774725776612, -244.71417413422853, -168.47831169104688, -368.10075405303417, -101.40217138579874, -366.45168797009416, -195.4459439450142, -58.09673047196101, -256.0444364577696, 74.75741254195214, 28.556753331194216, -546.979110731054, 198.2, -523.6627791855501, -531.3628207388412, -100.18307658240965, -303.21618226368594, -108.77717662352521, 178.09831804445483, -255.3830937365263, -305.73709981219514, -130.75062556234613, 20.587835573569237, -343.71870074014424, -136.60063608059625, -159.9053363306118, 36.537245678116605, -178.06983377895187, 21.826810626297338, -327.20629484474756, -4.733468863739461, -566.2332703671892, -39.66342965808028, -191.64001608188377, -132.80331756743252, -56.873529267988744, -271.97724019523605, -107.71766395819535, -122.78808353507182, -32.293391981628105, 60.90332515613258, -489.6512974030707, 31.210259949622635, -239.59084151854017, -199.73316117042168, 196.4, -254.6077058559925, -314.21574662135254, -157.75032189560176, -106.21214506384177, -265.6376482813048, -105.62712814970821, -625.2119859200237, 151.06873446129444, -313.18866257154417, 8.463953007720177, -141.79368013909598, -365.3021812932898, -124.79988712440986, -6.284700201125752, -565.5709701153572, -59.93455725266348, -143.22231112751558, -328.8068274462995, 149.5999999999997, -324.14207355718116, -566.8297149569253, 18.71002004954218, -483.66039909060737, -207.1693666099595, 171.16235387286127, -348.88114225960084, -413.0755022978961, 186.28737040289303, -146.465062459342, -391.84611900754993, -240.12316507926835, 6.596152546646678, 33.2938385703542, -346.39129485999825, -516.6790942844158, -172.15543225309148, -4.075195516355857, -123.05237368960815, 157.57701892817158, -587.8948451122162, -314.1959515674259, -60.747030726861915, -437.67664936064944, 169.63490216890347, -350.9477255568437, -1.4299675777654484, -86.55975687484818, 182.9, 143.3, -270.7591760467839, -122.320055900812, -56.18744697045452, -460.774739694729, -382.67671910493254, -252.85454000094703, -82.3321889812698, -291.8200689467954, 127.87369613242714, -311.94074940996126, -199.86002171600094, -396.1677492977656, -98.69380577660493, -192.78299490751536, 8.796973479196188, -256.3424308682713, -328.1562029461385, 69.65545220875917, 176.11638332298952, -450.5184483115567, 91.34493213415337, -239.67003602421852, -328.457712636796, -168.1164009114479, 9.993994601245568, -227.30618307318184, -158.53653491431132, -73.61574391237896, -192.06083517008577, -53.360415346818904, -187.64991442445532, -24.56960739389526, 91.02081712012294, -345.22437396955837, -35.53722970898697, 24.427636460530252, -205.15199986010694, 163.33790722036758, -524.0596383513163, -93.41106133398054, 143.304751304445, -50.3380082078322, -417.80140942497854, -114.87828188666518, -468.9786389687057, -151.81053226430564, 200.0, 164.89999999999992, -338.0160218016045, -265.1899338312965, 40.30180714637318, -479.7182711501951, 113.26411774862672, -332.19282058040613, -358.5237513220669, -99.61316599720479, -224.40388597559254, -66.96777035778446, -118.46387224422793, -236.0379171664511, -54.59130180250553, 70.02637206923552, -428.96811000470404, -205.1106089246064, -55.26512127766145, -338.4236252354635, 42.78272539507383, -371.529303106436, -191.70090939151876, 117.5164887561597, -93.52522365203575, -211.21636147261017, -223.48616480171523, -141.35285842096437, -6.7543851551797145, -394.4993956934857, -195.90960230191476, 138.32332823452026, -305.2698681915428, -309.561563942135, 99.23699831036605, 124.37250098763828, 62.59834563750193, -130.96807702736757, -236.68460845666667, 153.50977832824526, -361.9790600405201, 74.65650787638009, -130.545401419776, -142.75457382088806, 12.163347402136932, -33.816037230315324, -312.73247724428745, -43.46076128019776, 97.09221444507622, -145.93618760649878, -86.64810204373407, -268.7148366416487, 145.03780550687458, -21.880387525677584, -411.11421166170436, -135.04608225153257, 94.30314584828677, -123.64787888667458, -565.0105105058545, 148.9896184156206, -13.083515789336852, -153.53609593242956, -152.85608876624343, -345.8456298813725, 194.62532530022065, -259.4737591610354, 194.59999999999997, -423.4560363790251, -159.40569872179805, -72.23496706009378, -286.0779208992198, -233.90069919456394, 177.57136569645016, -540.8513697214803, -373.77000875910556], "policy_predator_policy_reward": [19.571437137953886, 283.27741065791867, 288.25080475385386, 409.866347061956, 413.622410720726, 678.3863984946718, 266.576367932772, 295.2038047190534, 226.89337890313672, 217.53555067274922, 78.20406863497861, 351.94422912770005, 310.80263489293486, 266.43603472041343, 183.61356208074886, 203.629287863909, 311.3549821892981, 201.78446176982808, 220.10398270801215, 429.39431969253803, 338.52556936480516, 413.3020503611055, 359.57838032508084, 324.25094946932865, 229.4572860170493, 361.26913312254675, 392.6986880079548, 400.450873500503, 353.5358189983051, 196.6167327746737, 272.6105182763668, 248.46942061158967, 312.4620045397892, 409.0366677453413, 357.6945520710292, 447.79712615769813, 208.28434652952694, 341.85714104367685, 272.0309715642941, 280.7120051452951, 234.0804307008443, 302.2063494779682, 414.58591895713585, 491.9462104903071, 373.8958745615615, 320.5450463283002, 365.89964012211493, 297.7927449607344, 197.23873912591097, 416.09431852203284, 409.4137296841633, 520.8847023034848, 376.0223850125393, 426.7882726117022, 191.5144860256301, 162.98349853541117, 297.7594293824635, 362.17749146460443, 322.7710872794109, 495.91407550183743, 353.90719768625587, 298.78155774549657, 498.0177978472058, 373.6649924036306, 533.055740465324, 524.5758943287011, 319.99964637161133, 243.03037817611627, 384.08759096659793, 411.33231494069616, 241.76293177314528, 294.1061691235602, 252.98601522703186, 321.70060438890295, 279.2267688172142, 365.3324844514545, 521.2500009432242, 405.5543154710431, 308.2321607165789, 235.66540826264153, 286.27724019523635, 379.0233553072791, 290.33760718510524, 456.1128410537392, 231.01705959483405, 291.98713007618454, 286.9443139560261, 315.6370442953968, 328.4462541653433, 303.26304540295195, 583.1436474006941, 170.8728933172972, 240.58191373300195, 358.3135579770944, 255.45025530097848, 354.13253376408227, 418.4029451281029, 518.5664221154761, 326.9420735571811, 344.84324481998846, 483.8603990906074, 573.8297149569252, 326.6478954383347, 232.52166129117418, 416.0755022978959, 172.12684906832882, 395.199106284597, 325.1808735144415, 324.42149733666236, 542.1769988065597, 238.02278962905604, 268.83765321804253, 508.140981022711, 516.680627329335, 430.22255204979666, 204.42963316488556, 380.9477255568437, 237.2281612004031, 141.83726502961082, 187.65420941870542, 527.0585249554665, 276.11574778329197, 537.303961464657, 387.7710447308782, 295.2331394932503, 382.9504627030436, 405.2004241219859, 369.0411633033926, 209.45809790592992, 366.68961705712974, 290.9894487197717, 203.2936730294113, 351.6919140163442, 453.7940739854308, 329.7906282559197, 339.72605258745773, 304.47944333543484, 331.8936398870844, 373.1543388666714, 262.63160360642576, 395.53140588676985, 161.84408243949758, 87.46280797944925, 249.55711008738308, 455.50790026713406, 261.74533304827787, 255.51924813720467, 408.9265172271131, 474.55506307422183, 409.42692292601686, 260.8051818104332, 118.42178422754664, 292.8417569827092, 521.3800613245404, 336.29282058040627, 376.06780219914424, 353.3480065487709, 181.1025276119914, 191.15452548390283, 241.56455681720433, 432.69985902523774, 215.43205241822915, 138.98239588258747, 339.4236252354637, 384.87549680709924, 262.08194565449185, 329.64315416286263, 299.9249396269551, 361.1307258560167, 333.46888722346426, 369.3040160444296, 345.2944796132301, 325.12543885647784, 284.7866269485356, 131.99355619704846, 297.37806003498287, 318.4352007612321, 283.3579372366979, 356.00051125825786, 233.8295567471852, 268.42112119647237, 302.31925198607104, 156.1361876064983, 137.99866482571696, 306.8738185116501, 238.81796875908822, 411.7142116617045, 143.54608225153248, 447.2644756835404, 490.9177636723123, 269.5803733062918, 263.72309065745713, 462.5358510428963, 320.0001500045912, 236.39505608530473, 397.94717222407206, 431.71738968321205, 272.6053948966069, 540.8513697214803, 375.14826982646457]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.720601466763784, "mean_inference_ms": 5.601186396744242, "mean_action_processing_ms": 2.331887696969576, "mean_env_wait_ms": 14.622354917294142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012722373008728027, "StateBufferConnector_ms": 0.004966020584106445, "ViewRequirementAgentConnector_ms": 0.16513001918792725}, "num_episodes": 22, "episode_return_max": 523.9600011608837, "episode_return_min": -59.3330375558688, "episode_return_mean": 217.54270276674285, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1300000, "num_agent_steps_trained": 1300000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.72746316603558, "num_env_steps_trained_throughput_per_sec": 66.72746316603558, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1300000, "timers": {"training_iteration_time_ms": 59792.82, "restore_workers_time_ms": 0.014, "training_step_time_ms": 59792.767, "sample_time_ms": 2282.163, "learn_time_ms": 57494.475, "learn_throughput": 69.572, "synch_weights_time_ms": 13.235}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1300000, "num_agent_steps_trained": 1300000}, "done": false, "training_iteration": 65, "trial_id": "62684_00000", "date": "2024-08-20_17-23-04", "timestamp": 1724154784, "time_this_iter_s": 60.01800298690796, "time_total_s": 4514.236924409866, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ac0afdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4514.236924409866, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 26.322352941176465, "ram_util_percent": 82.70117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.994096654315367, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.088884904536795, "policy_loss": -0.018504871299790865, "vf_loss": 7.104799512937559, "vf_explained_var": 0.47850089030908355, "kl": 0.012951291499639604, "entropy": 0.8813773680663278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 184710.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.683458864562725, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.433902664285489, "policy_loss": -0.027486256331269426, "vf_loss": 8.458283600983796, "vf_explained_var": -0.308493134678987, "kl": 0.015526617958244901, "entropy": 0.531358090563426, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "env_runners": {"episode_reward_max": 570.5373986627648, "episode_reward_min": -59.3330375558688, "episode_reward_mean": 216.92111841102357, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -625.2119859200237, "predator_policy": 24.731966798380665}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 583.1436474006941}, "policy_reward_mean": {"prey_policy": -143.64466973419016, "predator_policy": 323.92756380679714}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.91627656093254, 386.4508033757407, 108.10000000000002, 89.45648695377326, 426.86372554265716, 211.27451725027223, -59.3330375558688, -17.26945062767941, 143.10164455700823, 428.01784539292913, 200.80603486963335, 50.853589078107134, 412.39803040302735, 81.98761016778427, 314.7178928828444, 161.10993527126533, 316.17414752525667, 162.5807060619148, 162.81760781401192, 285.40908401027735, 114.89044693167989, 230.15790577407728, 102.10918432754636, 174.24616110955276, 152.37708200717697, 113.196020446235, 168.24152874804236, 168.4364173736883, 25.910020049542307, 174.28140173280917, 214.94915701187963, 95.00684825886759, 36.82194556916006, 207.5774413880433, 280.30783060057695, 305.863407296074, 179.238436747789, 384.932298401532, 163.89203017276262, 207.21155810838425, 202.29647997196255, 79.52001063500639, 135.81926266646883, 411.8987543347936, 206.64243580015122, 182.93656189637932, 176.91462132264613, 202.71477753173693, 278.60232408293376, 120.7583249582679, 263.12044085048205, 339.61109903595184, 148.31453288056122, 406.1109442363754, 109.61542047213054, 134.90816862570418, 143.4657118301791, 23.625991087922817, 84.0795645833912, 127.49999999999973, 201.24371871979486, 101.34034386345768, 151.99297380985072, 351.7423533987234, 523.9600011608837, 124.31727638549845, 467.9803641620349, 328.69344016691724, 180.7310974277418, 158.64277722705867, 400.13436861028845, 103.40314584828666, 398.5134683789435, 213.82776347573892, 371.84193730530035, 246.08049320855363, 112.10919742594156, 178.9496267638092, 230.09535430891006, 278.21781838657444, 567.0771251488904, 85.8010017462768, 212.13197894270508, 70.74419666232518, 180.9822123106532, 179.10327947754854, 570.5373986627648, 141.31823623966528, 278.9878193533946, 114.41955695705798, 366.2270776282451, 264.64215110669494, 279.6699716740239, 217.38398823022024, 348.0434902032237, 278.3276498529914, 30.588646384382074, 347.94464178404996, 105.89558606176534, 283.9323142488199], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [185.62900457269978, 36.06825669396281, -415.2219055955925, 55.08979245489617, -87.76013050411605, -244.57124365789048, -188.63873912591154, -146.81362926749696, -169.78068925453636, -397.3908823818839, -244.72870790113288, -198.72235475085705, -433.921636892162, 162.95331517240191, -104.97861036182417, 84.3265899114784, -265.45360798390686, 37.90355076166007, -306.0774725776612, -244.71417413422853, -168.47831169104688, -368.10075405303417, -101.40217138579874, -366.45168797009416, -195.4459439450142, -58.09673047196101, -256.0444364577696, 74.75741254195214, 28.556753331194216, -546.979110731054, 198.2, -523.6627791855501, -531.3628207388412, -100.18307658240965, -303.21618226368594, -108.77717662352521, 178.09831804445483, -255.3830937365263, -305.73709981219514, -130.75062556234613, 20.587835573569237, -343.71870074014424, -136.60063608059625, -159.9053363306118, 36.537245678116605, -178.06983377895187, 21.826810626297338, -327.20629484474756, -4.733468863739461, -566.2332703671892, -39.66342965808028, -191.64001608188377, -132.80331756743252, -56.873529267988744, -271.97724019523605, -107.71766395819535, -122.78808353507182, -32.293391981628105, 60.90332515613258, -489.6512974030707, 31.210259949622635, -239.59084151854017, -199.73316117042168, 196.4, -254.6077058559925, -314.21574662135254, -157.75032189560176, -106.21214506384177, -265.6376482813048, -105.62712814970821, -625.2119859200237, 151.06873446129444, -313.18866257154417, 8.463953007720177, -141.79368013909598, -365.3021812932898, -124.79988712440986, -6.284700201125752, -565.5709701153572, -59.93455725266348, -143.22231112751558, -328.8068274462995, 149.5999999999997, -324.14207355718116, -566.8297149569253, 18.71002004954218, -483.66039909060737, -207.1693666099595, 171.16235387286127, -348.88114225960084, -413.0755022978961, 186.28737040289303, -146.465062459342, -391.84611900754993, -240.12316507926835, 6.596152546646678, 33.2938385703542, -346.39129485999825, -516.6790942844158, -172.15543225309148, -4.075195516355857, -123.05237368960815, 157.57701892817158, -587.8948451122162, -314.1959515674259, -60.747030726861915, -437.67664936064944, 169.63490216890347, -350.9477255568437, -1.4299675777654484, -86.55975687484818, 182.9, 143.3, -270.7591760467839, -122.320055900812, -56.18744697045452, -460.774739694729, -382.67671910493254, -252.85454000094703, -82.3321889812698, -291.8200689467954, 127.87369613242714, -311.94074940996126, -199.86002171600094, -396.1677492977656, -98.69380577660493, -192.78299490751536, 8.796973479196188, -256.3424308682713, -328.1562029461385, 69.65545220875917, 176.11638332298952, -450.5184483115567, 91.34493213415337, -239.67003602421852, -328.457712636796, -168.1164009114479, 9.993994601245568, -227.30618307318184, -158.53653491431132, -73.61574391237896, -192.06083517008577, -53.360415346818904, -187.64991442445532, -24.56960739389526, 91.02081712012294, -345.22437396955837, -35.53722970898697, 24.427636460530252, -205.15199986010694, 163.33790722036758, -524.0596383513163, -93.41106133398054, 143.304751304445, -50.3380082078322, -417.80140942497854, -114.87828188666518, -468.9786389687057, -151.81053226430564, 200.0, 164.89999999999992, -338.0160218016045, -265.1899338312965, 40.30180714637318, -479.7182711501951, 113.26411774862672, -332.19282058040613, -358.5237513220669, -99.61316599720479, -224.40388597559254, -66.96777035778446, -118.46387224422793, -236.0379171664511, -54.59130180250553, 70.02637206923552, -428.96811000470404, -205.1106089246064, -55.26512127766145, -338.4236252354635, 42.78272539507383, -371.529303106436, -191.70090939151876, 117.5164887561597, -93.52522365203575, -211.21636147261017, -223.48616480171523, -141.35285842096437, -6.7543851551797145, -394.4993956934857, -195.90960230191476, 138.32332823452026, -305.2698681915428, -309.561563942135, 99.23699831036605, 124.37250098763828, 62.59834563750193, -130.96807702736757, -236.68460845666667, 153.50977832824526, -361.9790600405201, 74.65650787638009, -130.545401419776, -142.75457382088806, 12.163347402136932, -33.816037230315324, -312.73247724428745, -43.46076128019776, 97.09221444507622, -145.93618760649878, -86.64810204373407, -268.7148366416487, 145.03780550687458, -21.880387525677584, -411.11421166170436, -135.04608225153257, 94.30314584828677, -123.64787888667458, -565.0105105058545, 148.9896184156206, -13.083515789336852, -153.53609593242956, -152.85608876624343, -345.8456298813725, 194.62532530022065, -259.4737591610354, 194.59999999999997, -423.4560363790251, -159.40569872179805, -72.23496706009378, -286.0779208992198, -233.90069919456394, 177.57136569645016, -540.8513697214803, -373.77000875910556, -325.6707765156525, -276.6263875585287, 200.0, -88.81743127346495, -307.62573047937184, 154.5478004779131, 20.000000000000014, 191.9, -520.219503320664, -365.83636688512684, -100.17553499630138, -166.52401934718574, -311.4638183337709, -111.1087171191302, -23.618836075895068, -29.792530112845668, -427.3811325513393, 6.907441385591944, -247.0385040673669, -120.30215767301686, -50.55931227477177, -128.03134632750312, -37.4294519796118, -258.2881326215009, -0.26140810288140415, -299.13220276846346, 192.79999999999995, 86.5982265452434, -437.5740918339261, -202.84736215620256, 14.709840261072063, -310.4649888413363, 10.437248020374845, -187.55708620214455, -290.5179976099356, 13.893346151808782, -1.6942610509172482, -303.59814030368426, 173.18447818927757, -266.7494035218537, -171.13739109803726, 81.80495309121113, -235.39829358772243, 161.16282647927864, -255.9131873942081, -453.9794540923587, 160.39999999999998, -264.57634389569847, -180.35883195715286, 185.09209458786773, -72.54315321288928, -118.2355456992928, 125.19568305461091, -4.118272340696336, -100.63897223297616, -118.314613475465, -290.7324603862701, 108.10082564838714, -242.51586722527966, 3.851734032539507, -259.73182318255243, -89.00152575221915, 29.172000656913234, 117.49726181230646, -401.2506478594914, -36.03650184454163], "policy_predator_policy_reward": [373.8958745615615, 320.5450463283002, 365.89964012211493, 297.7927449607344, 197.23873912591097, 416.09431852203284, 409.4137296841633, 520.8847023034848, 376.0223850125393, 426.7882726117022, 191.5144860256301, 162.98349853541117, 297.7594293824635, 362.17749146460443, 322.7710872794109, 495.91407550183743, 353.90719768625587, 298.78155774549657, 498.0177978472058, 373.6649924036306, 533.055740465324, 524.5758943287011, 319.99964637161133, 243.03037817611627, 384.08759096659793, 411.33231494069616, 241.76293177314528, 294.1061691235602, 252.98601522703186, 321.70060438890295, 279.2267688172142, 365.3324844514545, 521.2500009432242, 405.5543154710431, 308.2321607165789, 235.66540826264153, 286.27724019523635, 379.0233553072791, 290.33760718510524, 456.1128410537392, 231.01705959483405, 291.98713007618454, 286.9443139560261, 315.6370442953968, 328.4462541653433, 303.26304540295195, 583.1436474006941, 170.8728933172972, 240.58191373300195, 358.3135579770944, 255.45025530097848, 354.13253376408227, 418.4029451281029, 518.5664221154761, 326.9420735571811, 344.84324481998846, 483.8603990906074, 573.8297149569252, 326.6478954383347, 232.52166129117418, 416.0755022978959, 172.12684906832882, 395.199106284597, 325.1808735144415, 324.42149733666236, 542.1769988065597, 238.02278962905604, 268.83765321804253, 508.140981022711, 516.680627329335, 430.22255204979666, 204.42963316488556, 380.9477255568437, 237.2281612004031, 141.83726502961082, 187.65420941870542, 527.0585249554665, 276.11574778329197, 537.303961464657, 387.7710447308782, 295.2331394932503, 382.9504627030436, 405.2004241219859, 369.0411633033926, 209.45809790592992, 366.68961705712974, 290.9894487197717, 203.2936730294113, 351.6919140163442, 453.7940739854308, 329.7906282559197, 339.72605258745773, 304.47944333543484, 331.8936398870844, 373.1543388666714, 262.63160360642576, 395.53140588676985, 161.84408243949758, 87.46280797944925, 249.55711008738308, 455.50790026713406, 261.74533304827787, 255.51924813720467, 408.9265172271131, 474.55506307422183, 409.42692292601686, 260.8051818104332, 118.42178422754664, 292.8417569827092, 521.3800613245404, 336.29282058040627, 376.06780219914424, 353.3480065487709, 181.1025276119914, 191.15452548390283, 241.56455681720433, 432.69985902523774, 215.43205241822915, 138.98239588258747, 339.4236252354637, 384.87549680709924, 262.08194565449185, 329.64315416286263, 299.9249396269551, 361.1307258560167, 333.46888722346426, 369.3040160444296, 345.2944796132301, 325.12543885647784, 284.7866269485356, 131.99355619704846, 297.37806003498287, 318.4352007612321, 283.3579372366979, 356.00051125825786, 233.8295567471852, 268.42112119647237, 302.31925198607104, 156.1361876064983, 137.99866482571696, 306.8738185116501, 238.81796875908822, 411.7142116617045, 143.54608225153248, 447.2644756835404, 490.9177636723123, 269.5803733062918, 263.72309065745713, 462.5358510428963, 320.0001500045912, 236.39505608530473, 397.94717222407206, 431.71738968321205, 272.6053948966069, 540.8513697214803, 375.14826982646457, 390.21116194041406, 242.18135644267866, 301.495805189124, 218.6173744723738, 420.2148433182367, 455.1817851513162, 354.71742930102505, 363.6194936738658, 283.0256419074868, 375.2977085640157, 427.47903150417375, 93.53138643674497, 335.38148416220986, 263.50070216359853, 263.46668291041334, 339.38552749575115, 225.2328678380464, 451.8981416960624, 439.7740918339266, 255.36737185062427, 246.20509460641438, 318.1006253068705, 248.78395900901515, 329.81733560831356, 239.03152244275879, 259.3034783508114, 225.6268799590372, 395.09711267634054, 221.8195882898236, 387.99903788685134, 331.46658144442495, 444.07320477385247, 227.73590978505268, 188.11747100034376, 250.75381803998837, 24.731966798380665, 246.95240410786695, 293.3222883712256, 156.89782838827355, 321.61012094013165, 134.63226165868312, 290.8246726809402, 204.37998514894852, 399.34221699159855]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.686871638301188, "mean_inference_ms": 5.576295806582823, "mean_action_processing_ms": 2.3150463102315144, "mean_env_wait_ms": 14.578325209238397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016286492347717285, "StateBufferConnector_ms": 0.004873156547546387, "ViewRequirementAgentConnector_ms": 0.12671923637390137}, "num_episodes": 22, "episode_return_max": 570.5373986627648, "episode_return_min": -59.3330375558688, "episode_return_mean": 216.92111841102357, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.14271628326657, "num_env_steps_trained_throughput_per_sec": 67.14271628326657, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 59803.09, "restore_workers_time_ms": 0.013, "training_step_time_ms": 59803.039, "sample_time_ms": 2300.009, "learn_time_ms": 57487.509, "learn_throughput": 69.58, "synch_weights_time_ms": 12.573}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "training_iteration": 66, "trial_id": "62684_00000", "date": "2024-08-20_17-24-04", "timestamp": 1724154844, "time_this_iter_s": 59.63780117034912, "time_total_s": 4573.874725580215, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb0c790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4573.874725580215, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 24.327380952380956, "ram_util_percent": 82.58690476190475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.051737266778947, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.5501562999495375, "policy_loss": -0.016074368808705834, "vf_loss": 7.563681629194435, "vf_explained_var": 0.4426585906574912, "kl": 0.012745193143933351, "entropy": 0.8723918185377797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 187530.5, "diff_num_grad_updates_vs_sampler_policy": 1448.9800000000105}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.091921834718613, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.688823174168824, "policy_loss": -0.025827052599563208, "vf_loss": 8.711760753550857, "vf_explained_var": -0.3180182421964312, "kl": 0.014447487600236422, "entropy": 0.5206926263514019, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 970.9600000000065}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1340000, "num_agent_steps_trained": 1340000}, "env_runners": {"episode_reward_max": 570.5373986627648, "episode_reward_min": 23.625991087922817, "episode_reward_mean": 216.99820940673763, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -625.2119859200237, "predator_policy": 24.731966798380665}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 583.1436474006941}, "policy_reward_mean": {"prey_policy": -135.78095834770167, "predator_policy": 312.17054222492146}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.10918432754636, 174.24616110955276, 152.37708200717697, 113.196020446235, 168.24152874804236, 168.4364173736883, 25.910020049542307, 174.28140173280917, 214.94915701187963, 95.00684825886759, 36.82194556916006, 207.5774413880433, 280.30783060057695, 305.863407296074, 179.238436747789, 384.932298401532, 163.89203017276262, 207.21155810838425, 202.29647997196255, 79.52001063500639, 135.81926266646883, 411.8987543347936, 206.64243580015122, 182.93656189637932, 176.91462132264613, 202.71477753173693, 278.60232408293376, 120.7583249582679, 263.12044085048205, 339.61109903595184, 148.31453288056122, 406.1109442363754, 109.61542047213054, 134.90816862570418, 143.4657118301791, 23.625991087922817, 84.0795645833912, 127.49999999999973, 201.24371871979486, 101.34034386345768, 151.99297380985072, 351.7423533987234, 523.9600011608837, 124.31727638549845, 467.9803641620349, 328.69344016691724, 180.7310974277418, 158.64277722705867, 400.13436861028845, 103.40314584828666, 398.5134683789435, 213.82776347573892, 371.84193730530035, 246.08049320855363, 112.10919742594156, 178.9496267638092, 230.09535430891006, 278.21781838657444, 567.0771251488904, 85.8010017462768, 212.13197894270508, 70.74419666232518, 180.9822123106532, 179.10327947754854, 570.5373986627648, 141.31823623966528, 278.9878193533946, 114.41955695705798, 366.2270776282451, 264.64215110669494, 279.6699716740239, 217.38398823022024, 348.0434902032237, 278.3276498529914, 30.588646384382074, 347.94464178404996, 105.89558606176534, 283.9323142488199, 98.60585257557898, 292.4542759358132, 205.6454425561737, 457.6568957303509, 99.63966635908758, 236.86161095077674, 98.0232365590006, 181.50970885275513, 141.6703669991627, 421.4459465596214, 189.14142953338387, 398.0903335573368, 381.35630638898317, 425.98493558842677, 160.5724739625745, 128.4358339399611, 89.7778592828374, 148.97202640808214, 129.49030321834454, 168.7821916807156, 189.34870150979904, 75.72550366228513], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-157.75032189560176, -106.21214506384177, -265.6376482813048, -105.62712814970821, -625.2119859200237, 151.06873446129444, -313.18866257154417, 8.463953007720177, -141.79368013909598, -365.3021812932898, -124.79988712440986, -6.284700201125752, -565.5709701153572, -59.93455725266348, -143.22231112751558, -328.8068274462995, 149.5999999999997, -324.14207355718116, -566.8297149569253, 18.71002004954218, -483.66039909060737, -207.1693666099595, 171.16235387286127, -348.88114225960084, -413.0755022978961, 186.28737040289303, -146.465062459342, -391.84611900754993, -240.12316507926835, 6.596152546646678, 33.2938385703542, -346.39129485999825, -516.6790942844158, -172.15543225309148, -4.075195516355857, -123.05237368960815, 157.57701892817158, -587.8948451122162, -314.1959515674259, -60.747030726861915, -437.67664936064944, 169.63490216890347, -350.9477255568437, -1.4299675777654484, -86.55975687484818, 182.9, 143.3, -270.7591760467839, -122.320055900812, -56.18744697045452, -460.774739694729, -382.67671910493254, -252.85454000094703, -82.3321889812698, -291.8200689467954, 127.87369613242714, -311.94074940996126, -199.86002171600094, -396.1677492977656, -98.69380577660493, -192.78299490751536, 8.796973479196188, -256.3424308682713, -328.1562029461385, 69.65545220875917, 176.11638332298952, -450.5184483115567, 91.34493213415337, -239.67003602421852, -328.457712636796, -168.1164009114479, 9.993994601245568, -227.30618307318184, -158.53653491431132, -73.61574391237896, -192.06083517008577, -53.360415346818904, -187.64991442445532, -24.56960739389526, 91.02081712012294, -345.22437396955837, -35.53722970898697, 24.427636460530252, -205.15199986010694, 163.33790722036758, -524.0596383513163, -93.41106133398054, 143.304751304445, -50.3380082078322, -417.80140942497854, -114.87828188666518, -468.9786389687057, -151.81053226430564, 200.0, 164.89999999999992, -338.0160218016045, -265.1899338312965, 40.30180714637318, -479.7182711501951, 113.26411774862672, -332.19282058040613, -358.5237513220669, -99.61316599720479, -224.40388597559254, -66.96777035778446, -118.46387224422793, -236.0379171664511, -54.59130180250553, 70.02637206923552, -428.96811000470404, -205.1106089246064, -55.26512127766145, -338.4236252354635, 42.78272539507383, -371.529303106436, -191.70090939151876, 117.5164887561597, -93.52522365203575, -211.21636147261017, -223.48616480171523, -141.35285842096437, -6.7543851551797145, -394.4993956934857, -195.90960230191476, 138.32332823452026, -305.2698681915428, -309.561563942135, 99.23699831036605, 124.37250098763828, 62.59834563750193, -130.96807702736757, -236.68460845666667, 153.50977832824526, -361.9790600405201, 74.65650787638009, -130.545401419776, -142.75457382088806, 12.163347402136932, -33.816037230315324, -312.73247724428745, -43.46076128019776, 97.09221444507622, -145.93618760649878, -86.64810204373407, -268.7148366416487, 145.03780550687458, -21.880387525677584, -411.11421166170436, -135.04608225153257, 94.30314584828677, -123.64787888667458, -565.0105105058545, 148.9896184156206, -13.083515789336852, -153.53609593242956, -152.85608876624343, -345.8456298813725, 194.62532530022065, -259.4737591610354, 194.59999999999997, -423.4560363790251, -159.40569872179805, -72.23496706009378, -286.0779208992198, -233.90069919456394, 177.57136569645016, -540.8513697214803, -373.77000875910556, -325.6707765156525, -276.6263875585287, 200.0, -88.81743127346495, -307.62573047937184, 154.5478004779131, 20.000000000000014, 191.9, -520.219503320664, -365.83636688512684, -100.17553499630138, -166.52401934718574, -311.4638183337709, -111.1087171191302, -23.618836075895068, -29.792530112845668, -427.3811325513393, 6.907441385591944, -247.0385040673669, -120.30215767301686, -50.55931227477177, -128.03134632750312, -37.4294519796118, -258.2881326215009, -0.26140810288140415, -299.13220276846346, 192.79999999999995, 86.5982265452434, -437.5740918339261, -202.84736215620256, 14.709840261072063, -310.4649888413363, 10.437248020374845, -187.55708620214455, -290.5179976099356, 13.893346151808782, -1.6942610509172482, -303.59814030368426, 173.18447818927757, -266.7494035218537, -171.13739109803726, 81.80495309121113, -235.39829358772243, 161.16282647927864, -255.9131873942081, -453.9794540923587, 160.39999999999998, -264.57634389569847, -180.35883195715286, 185.09209458786773, -72.54315321288928, -118.2355456992928, 125.19568305461091, -4.118272340696336, -100.63897223297616, -118.314613475465, -290.7324603862701, 108.10082564838714, -242.51586722527966, 3.851734032539507, -259.73182318255243, -89.00152575221915, 29.172000656913234, 117.49726181230646, -401.2506478594914, -36.03650184454163, -166.97683024508055, -97.30176187636644, -110.82324267700648, -200.85741423970734, -276.1905182421189, 97.32514328280217, -149.51616224453016, -100.13426461066378, -84.71232043724113, 184.95206467355877, -363.6316601895437, 60.290367898761225, -273.3358599733656, -96.06259194365299, 12.218573313022475, 150.6467507686737, -186.82339562565735, -28.968862496882196, -235.14006964039461, -132.07701900828656, -11.926527385435776, 104.35865292669891, -217.81601073716493, -73.16225272811512, -131.5319322603809, 0.09268495279229372, -244.43260441794072, -118.49025599435961, -83.05192085732956, -207.37495749979766, 32.18524349924094, -191.47209918287422, -182.39514649289063, 181.1, -117.94825870118461, -462.44946827120435, 52.70047616845418, 3.2011625205798246, -243.5514887168907, -147.61258693787715, -398.7857885172238, 150.11928493831215, 154.73118572314172, -311.0093421361234, -445.68616764624005, -102.25700129712033, -254.73790227412672, 35.39259625203436, -295.40205773788176, -61.80793587886608, -90.11250822171155, -275.3119018226217, 35.76338681823183, -112.90805360213454, -355.05571063930176, -83.23745984485957, -35.43033149077103, -335.78277789179083, 5.499276403086093, -146.76357519699906, -418.8396223202925, 40.68997253019599, -135.66265129853565, 16.277514650671762, -320.0323615596387, -373.6605693160224], "policy_predator_policy_reward": [328.4462541653433, 303.26304540295195, 583.1436474006941, 170.8728933172972, 240.58191373300195, 358.3135579770944, 255.45025530097848, 354.13253376408227, 418.4029451281029, 518.5664221154761, 326.9420735571811, 344.84324481998846, 483.8603990906074, 573.8297149569252, 326.6478954383347, 232.52166129117418, 416.0755022978959, 172.12684906832882, 395.199106284597, 325.1808735144415, 324.42149733666236, 542.1769988065597, 238.02278962905604, 268.83765321804253, 508.140981022711, 516.680627329335, 430.22255204979666, 204.42963316488556, 380.9477255568437, 237.2281612004031, 141.83726502961082, 187.65420941870542, 527.0585249554665, 276.11574778329197, 537.303961464657, 387.7710447308782, 295.2331394932503, 382.9504627030436, 405.2004241219859, 369.0411633033926, 209.45809790592992, 366.68961705712974, 290.9894487197717, 203.2936730294113, 351.6919140163442, 453.7940739854308, 329.7906282559197, 339.72605258745773, 304.47944333543484, 331.8936398870844, 373.1543388666714, 262.63160360642576, 395.53140588676985, 161.84408243949758, 87.46280797944925, 249.55711008738308, 455.50790026713406, 261.74533304827787, 255.51924813720467, 408.9265172271131, 474.55506307422183, 409.42692292601686, 260.8051818104332, 118.42178422754664, 292.8417569827092, 521.3800613245404, 336.29282058040627, 376.06780219914424, 353.3480065487709, 181.1025276119914, 191.15452548390283, 241.56455681720433, 432.69985902523774, 215.43205241822915, 138.98239588258747, 339.4236252354637, 384.87549680709924, 262.08194565449185, 329.64315416286263, 299.9249396269551, 361.1307258560167, 333.46888722346426, 369.3040160444296, 345.2944796132301, 325.12543885647784, 284.7866269485356, 131.99355619704846, 297.37806003498287, 318.4352007612321, 283.3579372366979, 356.00051125825786, 233.8295567471852, 268.42112119647237, 302.31925198607104, 156.1361876064983, 137.99866482571696, 306.8738185116501, 238.81796875908822, 411.7142116617045, 143.54608225153248, 447.2644756835404, 490.9177636723123, 269.5803733062918, 263.72309065745713, 462.5358510428963, 320.0001500045912, 236.39505608530473, 397.94717222407206, 431.71738968321205, 272.6053948966069, 540.8513697214803, 375.14826982646457, 390.21116194041406, 242.18135644267866, 301.495805189124, 218.6173744723738, 420.2148433182367, 455.1817851513162, 354.71742930102505, 363.6194936738658, 283.0256419074868, 375.2977085640157, 427.47903150417375, 93.53138643674497, 335.38148416220986, 263.50070216359853, 263.46668291041334, 339.38552749575115, 225.2328678380464, 451.8981416960624, 439.7740918339266, 255.36737185062427, 246.20509460641438, 318.1006253068705, 248.78395900901515, 329.81733560831356, 239.03152244275879, 259.3034783508114, 225.6268799590372, 395.09711267634054, 221.8195882898236, 387.99903788685134, 331.46658144442495, 444.07320477385247, 227.73590978505268, 188.11747100034376, 250.75381803998837, 24.731966798380665, 246.95240410786695, 293.3222883712256, 156.89782838827355, 321.61012094013165, 134.63226165868312, 290.8246726809402, 204.37998514894852, 399.34221699159855, 125.82324267700575, 347.88444469702716, 310.8238610755009, 361.3532040593361, 302.807113865392, 237.2010759832172, 227.34317985887907, 348.7029434886958, 150.6134816717066, 306.2060632913769, 70.62404954376449, 231.38306876087825, 244.29826149375455, 232.86859109936444, 238.16787651625222, 129.9614428750836, 218.6979381101432, 298.84428061455, 479.4874716461698, 350.8756092649378, 320.4023365151473, 210.42109519476043, 407.1417900018626, 390.24627052786275, 250.3782466403409, 318.62790977649655, 372.3559522717362, 449.9080738334804, 314.05914044833884, 448.4776575734575, 249.11490071047905, 200.92324054869485, 301.99801053323506, 235.10235058806177, 266.0535952192246, 235.37499979538288, 284.48747779596914, 318.7263273973085, 244.1677433281853, 401.66152503823366, 369.9966012541131, 333.16440134432094, 428.1085583276372, 325.0323615596387]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.640520573528372, "mean_inference_ms": 5.542910300132894, "mean_action_processing_ms": 2.2987043179593925, "mean_env_wait_ms": 14.49912167167045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012572050094604492, "StateBufferConnector_ms": 0.004861593246459961, "ViewRequirementAgentConnector_ms": 0.12833094596862793}, "num_episodes": 22, "episode_return_max": 570.5373986627648, "episode_return_min": 23.625991087922817, "episode_return_mean": 216.99820940673763, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1340000, "num_agent_steps_trained": 1340000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.94065819172216, "num_env_steps_trained_throughput_per_sec": 66.94065819172216, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1340000, "timers": {"training_iteration_time_ms": 59812.005, "restore_workers_time_ms": 0.013, "training_step_time_ms": 59811.954, "sample_time_ms": 2308.341, "learn_time_ms": 57488.407, "learn_throughput": 69.579, "synch_weights_time_ms": 12.319}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1340000, "num_agent_steps_trained": 1340000}, "done": false, "training_iteration": 67, "trial_id": "62684_00000", "date": "2024-08-20_17-25-04", "timestamp": 1724154904, "time_this_iter_s": 59.77488613128662, "time_total_s": 4633.649611711502, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3acadf700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4633.649611711502, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 23.919999999999995, "ram_util_percent": 81.66823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.721603026669076, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.5056435040548335, "policy_loss": -0.016677199910867115, "vf_loss": 7.519814360733573, "vf_explained_var": 0.46940764425494147, "kl": 0.012531733625826049, "entropy": 0.8612935090530003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 190350.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.23971369165592, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.716991701580229, "policy_loss": -0.028017671517017617, "vf_loss": 8.742070155925852, "vf_explained_var": -0.30766071901119574, "kl": 0.014695927899123894, "entropy": 0.48880592616146834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 570.5373986627648, "episode_reward_min": 10.415072787629967, "episode_reward_mean": 224.823305607395, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -565.0105105058545, "predator_policy": 24.731966798380665}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 540.8513697214803}, "policy_reward_mean": {"prey_policy": -131.57684821490034, "predator_policy": 309.7769251260481}, "custom_metrics": {}, "hist_stats": {"episode_reward": [163.89203017276262, 207.21155810838425, 202.29647997196255, 79.52001063500639, 135.81926266646883, 411.8987543347936, 206.64243580015122, 182.93656189637932, 176.91462132264613, 202.71477753173693, 278.60232408293376, 120.7583249582679, 263.12044085048205, 339.61109903595184, 148.31453288056122, 406.1109442363754, 109.61542047213054, 134.90816862570418, 143.4657118301791, 23.625991087922817, 84.0795645833912, 127.49999999999973, 201.24371871979486, 101.34034386345768, 151.99297380985072, 351.7423533987234, 523.9600011608837, 124.31727638549845, 467.9803641620349, 328.69344016691724, 180.7310974277418, 158.64277722705867, 400.13436861028845, 103.40314584828666, 398.5134683789435, 213.82776347573892, 371.84193730530035, 246.08049320855363, 112.10919742594156, 178.9496267638092, 230.09535430891006, 278.21781838657444, 567.0771251488904, 85.8010017462768, 212.13197894270508, 70.74419666232518, 180.9822123106532, 179.10327947754854, 570.5373986627648, 141.31823623966528, 278.9878193533946, 114.41955695705798, 366.2270776282451, 264.64215110669494, 279.6699716740239, 217.38398823022024, 348.0434902032237, 278.3276498529914, 30.588646384382074, 347.94464178404996, 105.89558606176534, 283.9323142488199, 98.60585257557898, 292.4542759358132, 205.6454425561737, 457.6568957303509, 99.63966635908758, 236.86161095077674, 98.0232365590006, 181.50970885275513, 141.6703669991627, 421.4459465596214, 189.14142953338387, 398.0903335573368, 381.35630638898317, 425.98493558842677, 160.5724739625745, 128.4358339399611, 89.7778592828374, 148.97202640808214, 129.49030321834454, 168.7821916807156, 189.34870150979904, 75.72550366228513, 268.8039695164377, 270.30711675495695, 156.90958497292783, 139.3926777570972, 105.17815715304489, 141.27497190056593, 329.4032893882187, 393.90566849374795, 373.27054114690577, 360.5014577233983, 158.99696789897368, 193.58118735754442, 148.5310305840682, 397.74358936191254, 10.415072787629967, 117.78951833682453], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-122.320055900812, -56.18744697045452, -460.774739694729, -382.67671910493254, -252.85454000094703, -82.3321889812698, -291.8200689467954, 127.87369613242714, -311.94074940996126, -199.86002171600094, -396.1677492977656, -98.69380577660493, -192.78299490751536, 8.796973479196188, -256.3424308682713, -328.1562029461385, 69.65545220875917, 176.11638332298952, -450.5184483115567, 91.34493213415337, -239.67003602421852, -328.457712636796, -168.1164009114479, 9.993994601245568, -227.30618307318184, -158.53653491431132, -73.61574391237896, -192.06083517008577, -53.360415346818904, -187.64991442445532, -24.56960739389526, 91.02081712012294, -345.22437396955837, -35.53722970898697, 24.427636460530252, -205.15199986010694, 163.33790722036758, -524.0596383513163, -93.41106133398054, 143.304751304445, -50.3380082078322, -417.80140942497854, -114.87828188666518, -468.9786389687057, -151.81053226430564, 200.0, 164.89999999999992, -338.0160218016045, -265.1899338312965, 40.30180714637318, -479.7182711501951, 113.26411774862672, -332.19282058040613, -358.5237513220669, -99.61316599720479, -224.40388597559254, -66.96777035778446, -118.46387224422793, -236.0379171664511, -54.59130180250553, 70.02637206923552, -428.96811000470404, -205.1106089246064, -55.26512127766145, -338.4236252354635, 42.78272539507383, -371.529303106436, -191.70090939151876, 117.5164887561597, -93.52522365203575, -211.21636147261017, -223.48616480171523, -141.35285842096437, -6.7543851551797145, -394.4993956934857, -195.90960230191476, 138.32332823452026, -305.2698681915428, -309.561563942135, 99.23699831036605, 124.37250098763828, 62.59834563750193, -130.96807702736757, -236.68460845666667, 153.50977832824526, -361.9790600405201, 74.65650787638009, -130.545401419776, -142.75457382088806, 12.163347402136932, -33.816037230315324, -312.73247724428745, -43.46076128019776, 97.09221444507622, -145.93618760649878, -86.64810204373407, -268.7148366416487, 145.03780550687458, -21.880387525677584, -411.11421166170436, -135.04608225153257, 94.30314584828677, -123.64787888667458, -565.0105105058545, 148.9896184156206, -13.083515789336852, -153.53609593242956, -152.85608876624343, -345.8456298813725, 194.62532530022065, -259.4737591610354, 194.59999999999997, -423.4560363790251, -159.40569872179805, -72.23496706009378, -286.0779208992198, -233.90069919456394, 177.57136569645016, -540.8513697214803, -373.77000875910556, -325.6707765156525, -276.6263875585287, 200.0, -88.81743127346495, -307.62573047937184, 154.5478004779131, 20.000000000000014, 191.9, -520.219503320664, -365.83636688512684, -100.17553499630138, -166.52401934718574, -311.4638183337709, -111.1087171191302, -23.618836075895068, -29.792530112845668, -427.3811325513393, 6.907441385591944, -247.0385040673669, -120.30215767301686, -50.55931227477177, -128.03134632750312, -37.4294519796118, -258.2881326215009, -0.26140810288140415, -299.13220276846346, 192.79999999999995, 86.5982265452434, -437.5740918339261, -202.84736215620256, 14.709840261072063, -310.4649888413363, 10.437248020374845, -187.55708620214455, -290.5179976099356, 13.893346151808782, -1.6942610509172482, -303.59814030368426, 173.18447818927757, -266.7494035218537, -171.13739109803726, 81.80495309121113, -235.39829358772243, 161.16282647927864, -255.9131873942081, -453.9794540923587, 160.39999999999998, -264.57634389569847, -180.35883195715286, 185.09209458786773, -72.54315321288928, -118.2355456992928, 125.19568305461091, -4.118272340696336, -100.63897223297616, -118.314613475465, -290.7324603862701, 108.10082564838714, -242.51586722527966, 3.851734032539507, -259.73182318255243, -89.00152575221915, 29.172000656913234, 117.49726181230646, -401.2506478594914, -36.03650184454163, -166.97683024508055, -97.30176187636644, -110.82324267700648, -200.85741423970734, -276.1905182421189, 97.32514328280217, -149.51616224453016, -100.13426461066378, -84.71232043724113, 184.95206467355877, -363.6316601895437, 60.290367898761225, -273.3358599733656, -96.06259194365299, 12.218573313022475, 150.6467507686737, -186.82339562565735, -28.968862496882196, -235.14006964039461, -132.07701900828656, -11.926527385435776, 104.35865292669891, -217.81601073716493, -73.16225272811512, -131.5319322603809, 0.09268495279229372, -244.43260441794072, -118.49025599435961, -83.05192085732956, -207.37495749979766, 32.18524349924094, -191.47209918287422, -182.39514649289063, 181.1, -117.94825870118461, -462.44946827120435, 52.70047616845418, 3.2011625205798246, -243.5514887168907, -147.61258693787715, -398.7857885172238, 150.11928493831215, 154.73118572314172, -311.0093421361234, -445.68616764624005, -102.25700129712033, -254.73790227412672, 35.39259625203436, -295.40205773788176, -61.80793587886608, -90.11250822171155, -275.3119018226217, 35.76338681823183, -112.90805360213454, -355.05571063930176, -83.23745984485957, -35.43033149077103, -335.78277789179083, 5.499276403086093, -146.76357519699906, -418.8396223202925, 40.68997253019599, -135.66265129853565, 16.277514650671762, -320.0323615596387, -373.6605693160224, -307.9193143208805, 118.97974614042255, -173.06233926908413, 167.0844246554783, -253.80781744935882, -511.8986064840262, -57.726968689205215, -201.45811542820735, -234.57472179390817, -75.40572622593064, -252.21119429936792, -275.4206624170865, -437.95364884345236, 21.117174979024757, -364.44374746603194, 93.98112553108527, -405.65662096127693, -202.07845372477453, 164.7346731230546, 52.041201207643184, -402.5710455126017, 90.77020187788203, -217.34696363764832, -37.71071638267689, -309.0621618926404, 66.62983916630958, -66.14708736545208, -45.982212676313026, 123.58101426664132, -383.9295111892684, -364.69524942602794, -64.97300172629787, -17.71946255712389, -313.3758435721207, 187.08118735754448, -396.65347233989434, -249.6306806577597, -126.29571283763755, -88.46757650415103, -241.01106484771364, 135.4916735824495, -17.1207042216893, -25.049965714194343, -324.7888773397899, -202.79810080275354, -271.8624699240607, -449.30340262023736, 84.34829775491646], "policy_predator_policy_reward": [527.0585249554665, 276.11574778329197, 537.303961464657, 387.7710447308782, 295.2331394932503, 382.9504627030436, 405.2004241219859, 369.0411633033926, 209.45809790592992, 366.68961705712974, 290.9894487197717, 203.2936730294113, 351.6919140163442, 453.7940739854308, 329.7906282559197, 339.72605258745773, 304.47944333543484, 331.8936398870844, 373.1543388666714, 262.63160360642576, 395.53140588676985, 161.84408243949758, 87.46280797944925, 249.55711008738308, 455.50790026713406, 261.74533304827787, 255.51924813720467, 408.9265172271131, 474.55506307422183, 409.42692292601686, 260.8051818104332, 118.42178422754664, 292.8417569827092, 521.3800613245404, 336.29282058040627, 376.06780219914424, 353.3480065487709, 181.1025276119914, 191.15452548390283, 241.56455681720433, 432.69985902523774, 215.43205241822915, 138.98239588258747, 339.4236252354637, 384.87549680709924, 262.08194565449185, 329.64315416286263, 299.9249396269551, 361.1307258560167, 333.46888722346426, 369.3040160444296, 345.2944796132301, 325.12543885647784, 284.7866269485356, 131.99355619704846, 297.37806003498287, 318.4352007612321, 283.3579372366979, 356.00051125825786, 233.8295567471852, 268.42112119647237, 302.31925198607104, 156.1361876064983, 137.99866482571696, 306.8738185116501, 238.81796875908822, 411.7142116617045, 143.54608225153248, 447.2644756835404, 490.9177636723123, 269.5803733062918, 263.72309065745713, 462.5358510428963, 320.0001500045912, 236.39505608530473, 397.94717222407206, 431.71738968321205, 272.6053948966069, 540.8513697214803, 375.14826982646457, 390.21116194041406, 242.18135644267866, 301.495805189124, 218.6173744723738, 420.2148433182367, 455.1817851513162, 354.71742930102505, 363.6194936738658, 283.0256419074868, 375.2977085640157, 427.47903150417375, 93.53138643674497, 335.38148416220986, 263.50070216359853, 263.46668291041334, 339.38552749575115, 225.2328678380464, 451.8981416960624, 439.7740918339266, 255.36737185062427, 246.20509460641438, 318.1006253068705, 248.78395900901515, 329.81733560831356, 239.03152244275879, 259.3034783508114, 225.6268799590372, 395.09711267634054, 221.8195882898236, 387.99903788685134, 331.46658144442495, 444.07320477385247, 227.73590978505268, 188.11747100034376, 250.75381803998837, 24.731966798380665, 246.95240410786695, 293.3222883712256, 156.89782838827355, 321.61012094013165, 134.63226165868312, 290.8246726809402, 204.37998514894852, 399.34221699159855, 125.82324267700575, 347.88444469702716, 310.8238610755009, 361.3532040593361, 302.807113865392, 237.2010759832172, 227.34317985887907, 348.7029434886958, 150.6134816717066, 306.2060632913769, 70.62404954376449, 231.38306876087825, 244.29826149375455, 232.86859109936444, 238.16787651625222, 129.9614428750836, 218.6979381101432, 298.84428061455, 479.4874716461698, 350.8756092649378, 320.4023365151473, 210.42109519476043, 407.1417900018626, 390.24627052786275, 250.3782466403409, 318.62790977649655, 372.3559522717362, 449.9080738334804, 314.05914044833884, 448.4776575734575, 249.11490071047905, 200.92324054869485, 301.99801053323506, 235.10235058806177, 266.0535952192246, 235.37499979538288, 284.48747779596914, 318.7263273973085, 244.1677433281853, 401.66152503823366, 369.9966012541131, 333.16440134432094, 428.1085583276372, 325.0323615596387, 388.714069127588, 242.09180783839122, 353.8929771843251, 515.0361388485392, 366.2359300539646, 284.4334608302852, 451.2660947949463, 291.1641659045359, 438.45364884345247, 448.00472964005337, 248.77125086442598, 406.25767019110606, 351.7978287668691, 163.4006318032527, 310.4746758322125, 247.71847080397907, 361.2718135777334, 320.5781376609549, 376.7290220054816, 290.10314531685503, 243.81139600959872, 362.5732855988249, 317.37584357212046, 399.15347233989417, 346.93314924087076, 265.99185134274575, 320.20522427203827, 200.1784605768246, 223.05823355780745, 339.99378308656014, 453.9389992036486, 300.6680939225566]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.620402079094503, "mean_inference_ms": 5.520461930105313, "mean_action_processing_ms": 2.262550002347626, "mean_env_wait_ms": 14.442819531325346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012654304504394531, "StateBufferConnector_ms": 0.004942536354064941, "ViewRequirementAgentConnector_ms": 0.14456510543823242}, "num_episodes": 16, "episode_return_max": 570.5373986627648, "episode_return_min": 10.415072787629967, "episode_return_mean": 224.823305607395, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.9359061700981, "num_env_steps_trained_throughput_per_sec": 66.9359061700981, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 59845.017, "restore_workers_time_ms": 0.013, "training_step_time_ms": 59844.971, "sample_time_ms": 2310.62, "learn_time_ms": 57518.788, "learn_throughput": 69.542, "synch_weights_time_ms": 12.715}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 68, "trial_id": "62684_00000", "date": "2024-08-20_17-26-04", "timestamp": 1724154964, "time_this_iter_s": 59.79852914810181, "time_total_s": 4693.448140859604, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3acadfa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4693.448140859604, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 24.448809523809523, "ram_util_percent": 81.89999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.763535387761204, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.468163759826768, "policy_loss": -0.018554289534253296, "vf_loss": 7.484082410859723, "vf_explained_var": 0.44475344392002053, "kl": 0.013178162230343841, "entropy": 0.8033989202046226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 193170.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.576202749764478, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.853579457096322, "policy_loss": -0.02795697538830123, "vf_loss": 8.878478871956073, "vf_explained_var": -0.5252723132807111, "kl": 0.015287834916648174, "entropy": 0.4906518228785702, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "env_runners": {"episode_reward_max": 570.5373986627648, "episode_reward_min": -0.1675560626932402, "episode_reward_mean": 229.81582137456536, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -565.0105105058545, "predator_policy": 24.731966798380665}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 540.8513697214803}, "policy_reward_mean": {"prey_policy": -124.95259439515324, "predator_policy": 302.33680228001253}, "custom_metrics": {}, "hist_stats": {"episode_reward": [127.49999999999973, 201.24371871979486, 101.34034386345768, 151.99297380985072, 351.7423533987234, 523.9600011608837, 124.31727638549845, 467.9803641620349, 328.69344016691724, 180.7310974277418, 158.64277722705867, 400.13436861028845, 103.40314584828666, 398.5134683789435, 213.82776347573892, 371.84193730530035, 246.08049320855363, 112.10919742594156, 178.9496267638092, 230.09535430891006, 278.21781838657444, 567.0771251488904, 85.8010017462768, 212.13197894270508, 70.74419666232518, 180.9822123106532, 179.10327947754854, 570.5373986627648, 141.31823623966528, 278.9878193533946, 114.41955695705798, 366.2270776282451, 264.64215110669494, 279.6699716740239, 217.38398823022024, 348.0434902032237, 278.3276498529914, 30.588646384382074, 347.94464178404996, 105.89558606176534, 283.9323142488199, 98.60585257557898, 292.4542759358132, 205.6454425561737, 457.6568957303509, 99.63966635908758, 236.86161095077674, 98.0232365590006, 181.50970885275513, 141.6703669991627, 421.4459465596214, 189.14142953338387, 398.0903335573368, 381.35630638898317, 425.98493558842677, 160.5724739625745, 128.4358339399611, 89.7778592828374, 148.97202640808214, 129.49030321834454, 168.7821916807156, 189.34870150979904, 75.72550366228513, 268.8039695164377, 270.30711675495695, 156.90958497292783, 139.3926777570972, 105.17815715304489, 141.27497190056593, 329.4032893882187, 393.90566849374795, 373.27054114690577, 360.5014577233983, 158.99696789897368, 193.58118735754442, 148.5310305840682, 397.74358936191254, 10.415072787629967, 117.78951833682453, 85.24571605363985, 129.47080002700574, 432.42736068484834, -0.1675560626932402, 232.43249393586157, 135.96210285773913, 141.08984211721534, 306.9276707940671, 405.5679367118536, 222.62410654695168, 212.9130138467029, 388.3559199684505, 185.1637542108724, 137.08535774929018, 191.65859225719896, 168.11663153357244, 386.3535731342524, 26.254237479822795, 174.90443582546763, 459.07169241802774, 99.85290971107523], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-55.26512127766145, -338.4236252354635, 42.78272539507383, -371.529303106436, -191.70090939151876, 117.5164887561597, -93.52522365203575, -211.21636147261017, -223.48616480171523, -141.35285842096437, -6.7543851551797145, -394.4993956934857, -195.90960230191476, 138.32332823452026, -305.2698681915428, -309.561563942135, 99.23699831036605, 124.37250098763828, 62.59834563750193, -130.96807702736757, -236.68460845666667, 153.50977832824526, -361.9790600405201, 74.65650787638009, -130.545401419776, -142.75457382088806, 12.163347402136932, -33.816037230315324, -312.73247724428745, -43.46076128019776, 97.09221444507622, -145.93618760649878, -86.64810204373407, -268.7148366416487, 145.03780550687458, -21.880387525677584, -411.11421166170436, -135.04608225153257, 94.30314584828677, -123.64787888667458, -565.0105105058545, 148.9896184156206, -13.083515789336852, -153.53609593242956, -152.85608876624343, -345.8456298813725, 194.62532530022065, -259.4737591610354, 194.59999999999997, -423.4560363790251, -159.40569872179805, -72.23496706009378, -286.0779208992198, -233.90069919456394, 177.57136569645016, -540.8513697214803, -373.77000875910556, -325.6707765156525, -276.6263875585287, 200.0, -88.81743127346495, -307.62573047937184, 154.5478004779131, 20.000000000000014, 191.9, -520.219503320664, -365.83636688512684, -100.17553499630138, -166.52401934718574, -311.4638183337709, -111.1087171191302, -23.618836075895068, -29.792530112845668, -427.3811325513393, 6.907441385591944, -247.0385040673669, -120.30215767301686, -50.55931227477177, -128.03134632750312, -37.4294519796118, -258.2881326215009, -0.26140810288140415, -299.13220276846346, 192.79999999999995, 86.5982265452434, -437.5740918339261, -202.84736215620256, 14.709840261072063, -310.4649888413363, 10.437248020374845, -187.55708620214455, -290.5179976099356, 13.893346151808782, -1.6942610509172482, -303.59814030368426, 173.18447818927757, -266.7494035218537, -171.13739109803726, 81.80495309121113, -235.39829358772243, 161.16282647927864, -255.9131873942081, -453.9794540923587, 160.39999999999998, -264.57634389569847, -180.35883195715286, 185.09209458786773, -72.54315321288928, -118.2355456992928, 125.19568305461091, -4.118272340696336, -100.63897223297616, -118.314613475465, -290.7324603862701, 108.10082564838714, -242.51586722527966, 3.851734032539507, -259.73182318255243, -89.00152575221915, 29.172000656913234, 117.49726181230646, -401.2506478594914, -36.03650184454163, -166.97683024508055, -97.30176187636644, -110.82324267700648, -200.85741423970734, -276.1905182421189, 97.32514328280217, -149.51616224453016, -100.13426461066378, -84.71232043724113, 184.95206467355877, -363.6316601895437, 60.290367898761225, -273.3358599733656, -96.06259194365299, 12.218573313022475, 150.6467507686737, -186.82339562565735, -28.968862496882196, -235.14006964039461, -132.07701900828656, -11.926527385435776, 104.35865292669891, -217.81601073716493, -73.16225272811512, -131.5319322603809, 0.09268495279229372, -244.43260441794072, -118.49025599435961, -83.05192085732956, -207.37495749979766, 32.18524349924094, -191.47209918287422, -182.39514649289063, 181.1, -117.94825870118461, -462.44946827120435, 52.70047616845418, 3.2011625205798246, -243.5514887168907, -147.61258693787715, -398.7857885172238, 150.11928493831215, 154.73118572314172, -311.0093421361234, -445.68616764624005, -102.25700129712033, -254.73790227412672, 35.39259625203436, -295.40205773788176, -61.80793587886608, -90.11250822171155, -275.3119018226217, 35.76338681823183, -112.90805360213454, -355.05571063930176, -83.23745984485957, -35.43033149077103, -335.78277789179083, 5.499276403086093, -146.76357519699906, -418.8396223202925, 40.68997253019599, -135.66265129853565, 16.277514650671762, -320.0323615596387, -373.6605693160224, -307.9193143208805, 118.97974614042255, -173.06233926908413, 167.0844246554783, -253.80781744935882, -511.8986064840262, -57.726968689205215, -201.45811542820735, -234.57472179390817, -75.40572622593064, -252.21119429936792, -275.4206624170865, -437.95364884345236, 21.117174979024757, -364.44374746603194, 93.98112553108527, -405.65662096127693, -202.07845372477453, 164.7346731230546, 52.041201207643184, -402.5710455126017, 90.77020187788203, -217.34696363764832, -37.71071638267689, -309.0621618926404, 66.62983916630958, -66.14708736545208, -45.982212676313026, 123.58101426664132, -383.9295111892684, -364.69524942602794, -64.97300172629787, -17.71946255712389, -313.3758435721207, 187.08118735754448, -396.65347233989434, -249.6306806577597, -126.29571283763755, -88.46757650415103, -241.01106484771364, 135.4916735824495, -17.1207042216893, -25.049965714194343, -324.7888773397899, -202.79810080275354, -271.8624699240607, -449.30340262023736, 84.34829775491646, -83.56752266468412, -286.85853444886885, -209.6048497898869, -410.9837835840131, -146.52806850770128, 22.46401691899072, 162.35167108969904, 46.19672299464099, -467.3243830521691, -499.35728533159727, -25.655580425840594, -231.30588005480305, 110.4036073030572, -434.78797347400484, -83.2306338814162, 128.8621028577394, -377.7804642774824, -301.26078833121227, -194.10371220002475, -78.92435682946544, 2.673444609880162, 63.70075564427016, -384.45911915608104, 37.52643293737131, 121.57360088208074, 106.39088187824062, -230.86159984926925, -258.9981724808583, 126.67977546678236, -251.72102751291914, 1.1455267262476634, -153.5227585858598, 18.346753696843045, -433.1527781942362, -78.64303971488464, 141.98637127510818, -468.50480670486115, 198.2, -135.26253094632176, -17.066239710167018, -89.42605765465535, -415.12563623715624, -13.743368796076053, -42.93644601679781, -253.42599704494404, -28.490946278656644, -5.439029106917324, -355.45760842869146, 194.72069038359686, -185.46629498581157, 23.08971338229138, -118.32870448466862, -80.01242707028871, -155.18588838548453, -55.690860177352434, -231.0743557321048, 6.8275662876483, 177.57425054768197, 80.5449703884594, -373.7575607618665, 99.23494327987468, -473.0451311956397, -420.5407613885887], "policy_predator_policy_reward": [138.98239588258747, 339.4236252354637, 384.87549680709924, 262.08194565449185, 329.64315416286263, 299.9249396269551, 361.1307258560167, 333.46888722346426, 369.3040160444296, 345.2944796132301, 325.12543885647784, 284.7866269485356, 131.99355619704846, 297.37806003498287, 318.4352007612321, 283.3579372366979, 356.00051125825786, 233.8295567471852, 268.42112119647237, 302.31925198607104, 156.1361876064983, 137.99866482571696, 306.8738185116501, 238.81796875908822, 411.7142116617045, 143.54608225153248, 447.2644756835404, 490.9177636723123, 269.5803733062918, 263.72309065745713, 462.5358510428963, 320.0001500045912, 236.39505608530473, 397.94717222407206, 431.71738968321205, 272.6053948966069, 540.8513697214803, 375.14826982646457, 390.21116194041406, 242.18135644267866, 301.495805189124, 218.6173744723738, 420.2148433182367, 455.1817851513162, 354.71742930102505, 363.6194936738658, 283.0256419074868, 375.2977085640157, 427.47903150417375, 93.53138643674497, 335.38148416220986, 263.50070216359853, 263.46668291041334, 339.38552749575115, 225.2328678380464, 451.8981416960624, 439.7740918339266, 255.36737185062427, 246.20509460641438, 318.1006253068705, 248.78395900901515, 329.81733560831356, 239.03152244275879, 259.3034783508114, 225.6268799590372, 395.09711267634054, 221.8195882898236, 387.99903788685134, 331.46658144442495, 444.07320477385247, 227.73590978505268, 188.11747100034376, 250.75381803998837, 24.731966798380665, 246.95240410786695, 293.3222883712256, 156.89782838827355, 321.61012094013165, 134.63226165868312, 290.8246726809402, 204.37998514894852, 399.34221699159855, 125.82324267700575, 347.88444469702716, 310.8238610755009, 361.3532040593361, 302.807113865392, 237.2010759832172, 227.34317985887907, 348.7029434886958, 150.6134816717066, 306.2060632913769, 70.62404954376449, 231.38306876087825, 244.29826149375455, 232.86859109936444, 238.16787651625222, 129.9614428750836, 218.6979381101432, 298.84428061455, 479.4874716461698, 350.8756092649378, 320.4023365151473, 210.42109519476043, 407.1417900018626, 390.24627052786275, 250.3782466403409, 318.62790977649655, 372.3559522717362, 449.9080738334804, 314.05914044833884, 448.4776575734575, 249.11490071047905, 200.92324054869485, 301.99801053323506, 235.10235058806177, 266.0535952192246, 235.37499979538288, 284.48747779596914, 318.7263273973085, 244.1677433281853, 401.66152503823366, 369.9966012541131, 333.16440134432094, 428.1085583276372, 325.0323615596387, 388.714069127588, 242.09180783839122, 353.8929771843251, 515.0361388485392, 366.2359300539646, 284.4334608302852, 451.2660947949463, 291.1641659045359, 438.45364884345247, 448.00472964005337, 248.77125086442598, 406.25767019110606, 351.7978287668691, 163.4006318032527, 310.4746758322125, 247.71847080397907, 361.2718135777334, 320.5781376609549, 376.7290220054816, 290.10314531685503, 243.81139600959872, 362.5732855988249, 317.37584357212046, 399.15347233989417, 346.93314924087076, 265.99185134274575, 320.20522427203827, 200.1784605768246, 223.05823355780745, 339.99378308656014, 453.9389992036486, 300.6680939225566, 324.5789044002362, 340.69771855684417, 253.62776023287594, 410.8908749668543, 297.5307394422013, 393.6726102104736, 269.1075114144806, 487.0436783350674, 309.2036757882401, 330.8438181999863, 379.4804642774823, 306.66078833121344, 215.71475603915493, 195.7297104976707, 415.48783768686445, 174.6717636816421, 217.14233689026176, 191.32271691053566, 352.17450768814035, 254.48902338580535, 206.42181634319505, 140.5216756662773, 401.32319103985094, 356.8421755626107, 116.86000073727466, 473.87109112478106, 417.52563623715673, 241.1776551141123, 261.40295749837793, 240.3614466166403, 316.31990812235426, 241.18430722548436, 120.78618160534876, 233.22328274882636, 174.77793499873837, 205.00332242152479, 208.618110997036, 246.22397445024086, 276.6617658408675, 298.04826640288593, 420.5407613885887, 473.66309762684045]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.568249960898718, "mean_inference_ms": 5.482771711224799, "mean_action_processing_ms": 2.2759637436489193, "mean_env_wait_ms": 14.381611895933613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008089542388916016, "StateBufferConnector_ms": 0.004943490028381348, "ViewRequirementAgentConnector_ms": 0.14068114757537842}, "num_episodes": 21, "episode_return_max": 570.5373986627648, "episode_return_min": -0.1675560626932402, "episode_return_mean": 229.81582137456536, "episodes_this_iter": 21}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.05271164537055, "num_env_steps_trained_throughput_per_sec": 67.05271164537055, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1380000, "timers": {"training_iteration_time_ms": 59838.719, "restore_workers_time_ms": 0.013, "training_step_time_ms": 59838.672, "sample_time_ms": 2313.733, "learn_time_ms": 57508.62, "learn_throughput": 69.555, "synch_weights_time_ms": 12.954}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "done": false, "training_iteration": 69, "trial_id": "62684_00000", "date": "2024-08-20_17-27-03", "timestamp": 1724155023, "time_this_iter_s": 59.708693981170654, "time_total_s": 4753.1568348407745, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffb83a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4753.1568348407745, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 25.71647058823529, "ram_util_percent": 82.24352941176473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.058022403463404, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.372982899347941, "policy_loss": -0.018757935680797016, "vf_loss": 7.389283337322532, "vf_explained_var": 0.46507416532394735, "kl": 0.01228747236920547, "entropy": 0.8287761903400962, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 195990.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.791507818143835, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.57974562039451, "policy_loss": -0.027615220425280904, "vf_loss": 8.604380250607848, "vf_explained_var": -0.48730732420134165, "kl": 0.014902794138139124, "entropy": 0.5148493879528904, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "env_runners": {"episode_reward_max": 570.5373986627648, "episode_reward_min": -0.1675560626932402, "episode_reward_mean": 219.70675541168194, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -511.8986064840262, "predator_policy": 24.731966798380665}, "policy_reward_max": {"prey_policy": 198.2, "predator_policy": 515.0361388485392}, "policy_reward_mean": {"prey_policy": -127.30679490702182, "predator_policy": 300.81357006637376}, "custom_metrics": {}, "hist_stats": {"episode_reward": [212.13197894270508, 70.74419666232518, 180.9822123106532, 179.10327947754854, 570.5373986627648, 141.31823623966528, 278.9878193533946, 114.41955695705798, 366.2270776282451, 264.64215110669494, 279.6699716740239, 217.38398823022024, 348.0434902032237, 278.3276498529914, 30.588646384382074, 347.94464178404996, 105.89558606176534, 283.9323142488199, 98.60585257557898, 292.4542759358132, 205.6454425561737, 457.6568957303509, 99.63966635908758, 236.86161095077674, 98.0232365590006, 181.50970885275513, 141.6703669991627, 421.4459465596214, 189.14142953338387, 398.0903335573368, 381.35630638898317, 425.98493558842677, 160.5724739625745, 128.4358339399611, 89.7778592828374, 148.97202640808214, 129.49030321834454, 168.7821916807156, 189.34870150979904, 75.72550366228513, 268.8039695164377, 270.30711675495695, 156.90958497292783, 139.3926777570972, 105.17815715304489, 141.27497190056593, 329.4032893882187, 393.90566849374795, 373.27054114690577, 360.5014577233983, 158.99696789897368, 193.58118735754442, 148.5310305840682, 397.74358936191254, 10.415072787629967, 117.78951833682453, 85.24571605363985, 129.47080002700574, 432.42736068484834, -0.1675560626932402, 232.43249393586157, 135.96210285773913, 141.08984211721534, 306.9276707940671, 405.5679367118536, 222.62410654695168, 212.9130138467029, 388.3559199684505, 185.1637542108724, 137.08535774929018, 191.65859225719896, 168.11663153357244, 386.3535731342524, 26.254237479822795, 174.90443582546763, 459.07169241802774, 99.85290971107523, 407.7128755773218, 318.3812903009793, 130.65457000835065, 203.88666098291955, 145.37417177638363, 209.7195153693803, 170.06365912720813, 225.13089857918536, 126.43420023087887, 245.10555165708976, 186.53983694505297, 81.59805063007727, 243.20023769049723, 102.80941519128993, 186.15652356563282, 192.028441341325, 151.38992143721129, 78.36864107766577, 326.27547268617644, 230.71561457812317, 453.2215596501567, 227.41102903630235, 251.11091320193074], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-311.4638183337709, -111.1087171191302, -23.618836075895068, -29.792530112845668, -427.3811325513393, 6.907441385591944, -247.0385040673669, -120.30215767301686, -50.55931227477177, -128.03134632750312, -37.4294519796118, -258.2881326215009, -0.26140810288140415, -299.13220276846346, 192.79999999999995, 86.5982265452434, -437.5740918339261, -202.84736215620256, 14.709840261072063, -310.4649888413363, 10.437248020374845, -187.55708620214455, -290.5179976099356, 13.893346151808782, -1.6942610509172482, -303.59814030368426, 173.18447818927757, -266.7494035218537, -171.13739109803726, 81.80495309121113, -235.39829358772243, 161.16282647927864, -255.9131873942081, -453.9794540923587, 160.39999999999998, -264.57634389569847, -180.35883195715286, 185.09209458786773, -72.54315321288928, -118.2355456992928, 125.19568305461091, -4.118272340696336, -100.63897223297616, -118.314613475465, -290.7324603862701, 108.10082564838714, -242.51586722527966, 3.851734032539507, -259.73182318255243, -89.00152575221915, 29.172000656913234, 117.49726181230646, -401.2506478594914, -36.03650184454163, -166.97683024508055, -97.30176187636644, -110.82324267700648, -200.85741423970734, -276.1905182421189, 97.32514328280217, -149.51616224453016, -100.13426461066378, -84.71232043724113, 184.95206467355877, -363.6316601895437, 60.290367898761225, -273.3358599733656, -96.06259194365299, 12.218573313022475, 150.6467507686737, -186.82339562565735, -28.968862496882196, -235.14006964039461, -132.07701900828656, -11.926527385435776, 104.35865292669891, -217.81601073716493, -73.16225272811512, -131.5319322603809, 0.09268495279229372, -244.43260441794072, -118.49025599435961, -83.05192085732956, -207.37495749979766, 32.18524349924094, -191.47209918287422, -182.39514649289063, 181.1, -117.94825870118461, -462.44946827120435, 52.70047616845418, 3.2011625205798246, -243.5514887168907, -147.61258693787715, -398.7857885172238, 150.11928493831215, 154.73118572314172, -311.0093421361234, -445.68616764624005, -102.25700129712033, -254.73790227412672, 35.39259625203436, -295.40205773788176, -61.80793587886608, -90.11250822171155, -275.3119018226217, 35.76338681823183, -112.90805360213454, -355.05571063930176, -83.23745984485957, -35.43033149077103, -335.78277789179083, 5.499276403086093, -146.76357519699906, -418.8396223202925, 40.68997253019599, -135.66265129853565, 16.277514650671762, -320.0323615596387, -373.6605693160224, -307.9193143208805, 118.97974614042255, -173.06233926908413, 167.0844246554783, -253.80781744935882, -511.8986064840262, -57.726968689205215, -201.45811542820735, -234.57472179390817, -75.40572622593064, -252.21119429936792, -275.4206624170865, -437.95364884345236, 21.117174979024757, -364.44374746603194, 93.98112553108527, -405.65662096127693, -202.07845372477453, 164.7346731230546, 52.041201207643184, -402.5710455126017, 90.77020187788203, -217.34696363764832, -37.71071638267689, -309.0621618926404, 66.62983916630958, -66.14708736545208, -45.982212676313026, 123.58101426664132, -383.9295111892684, -364.69524942602794, -64.97300172629787, -17.71946255712389, -313.3758435721207, 187.08118735754448, -396.65347233989434, -249.6306806577597, -126.29571283763755, -88.46757650415103, -241.01106484771364, 135.4916735824495, -17.1207042216893, -25.049965714194343, -324.7888773397899, -202.79810080275354, -271.8624699240607, -449.30340262023736, 84.34829775491646, -83.56752266468412, -286.85853444886885, -209.6048497898869, -410.9837835840131, -146.52806850770128, 22.46401691899072, 162.35167108969904, 46.19672299464099, -467.3243830521691, -499.35728533159727, -25.655580425840594, -231.30588005480305, 110.4036073030572, -434.78797347400484, -83.2306338814162, 128.8621028577394, -377.7804642774824, -301.26078833121227, -194.10371220002475, -78.92435682946544, 2.673444609880162, 63.70075564427016, -384.45911915608104, 37.52643293737131, 121.57360088208074, 106.39088187824062, -230.86159984926925, -258.9981724808583, 126.67977546678236, -251.72102751291914, 1.1455267262476634, -153.5227585858598, 18.346753696843045, -433.1527781942362, -78.64303971488464, 141.98637127510818, -468.50480670486115, 198.2, -135.26253094632176, -17.066239710167018, -89.42605765465535, -415.12563623715624, -13.743368796076053, -42.93644601679781, -253.42599704494404, -28.490946278656644, -5.439029106917324, -355.45760842869146, 194.72069038359686, -185.46629498581157, 23.08971338229138, -118.32870448466862, -80.01242707028871, -155.18588838548453, -55.690860177352434, -231.0743557321048, 6.8275662876483, 177.57425054768197, 80.5449703884594, -373.7575607618665, 99.23494327987468, -473.0451311956397, -420.5407613885887, 70.67386673906239, 172.8951844632728, -358.78632894082705, -381.8850842898664, -80.26163332153688, 167.8016479149083, 115.72006276610963, -356.9473666151488, -440.3548423728755, -418.8004336207564, 166.00549680288162, -218.28926621270097, 111.16083303935473, -330.5000238255019, -224.53287629903883, 48.93463975322342, -171.73347609309525, -277.13055692275526, -298.70990995045315, -43.57343265632869, -104.13583104569989, -262.3768613647171, 57.322940764582, -264.56436931534085, -107.77572117750933, -340.6695799244588, 11.010685687365298, -326.3816258653317, 26.774084515720656, -204.2942635789147, 58.019957298463105, -173.9365947483928, -489.48376380325175, -426.617161974343, -110.0504264386436, 11.103676724928688, 89.66588041026924, -134.15826537476562, -362.4941543646843, -91.73082394147427, -158.47767579905442, -221.56952988993612, -393.6689540451966, -243.0362755480901, 43.34383586501522, -46.133959816828856, -236.29864692800987, -97.4455518906592, 71.6923269938421, -231.56845635596198, -30.129078897489876, -213.95577061399018, -281.9020511393106, -60.15235618239176, -370.7791669524772, -98.2008386512, 179.6778472911666, 175.051651233999, -222.8442529951346, -322.1930078764997, -57.64616260902729, -284.665973221043, 160.30860496908906, -84.4361354789871, 29.43492999438004, -242.09366667477107, -123.91130302078028, -152.14691916577348, -11.021719306723284], "policy_predator_policy_reward": [283.0256419074868, 375.2977085640157, 427.47903150417375, 93.53138643674497, 335.38148416220986, 263.50070216359853, 263.46668291041334, 339.38552749575115, 225.2328678380464, 451.8981416960624, 439.7740918339266, 255.36737185062427, 246.20509460641438, 318.1006253068705, 248.78395900901515, 329.81733560831356, 239.03152244275879, 259.3034783508114, 225.6268799590372, 395.09711267634054, 221.8195882898236, 387.99903788685134, 331.46658144442495, 444.07320477385247, 227.73590978505268, 188.11747100034376, 250.75381803998837, 24.731966798380665, 246.95240410786695, 293.3222883712256, 156.89782838827355, 321.61012094013165, 134.63226165868312, 290.8246726809402, 204.37998514894852, 399.34221699159855, 125.82324267700575, 347.88444469702716, 310.8238610755009, 361.3532040593361, 302.807113865392, 237.2010759832172, 227.34317985887907, 348.7029434886958, 150.6134816717066, 306.2060632913769, 70.62404954376449, 231.38306876087825, 244.29826149375455, 232.86859109936444, 238.16787651625222, 129.9614428750836, 218.6979381101432, 298.84428061455, 479.4874716461698, 350.8756092649378, 320.4023365151473, 210.42109519476043, 407.1417900018626, 390.24627052786275, 250.3782466403409, 318.62790977649655, 372.3559522717362, 449.9080738334804, 314.05914044833884, 448.4776575734575, 249.11490071047905, 200.92324054869485, 301.99801053323506, 235.10235058806177, 266.0535952192246, 235.37499979538288, 284.48747779596914, 318.7263273973085, 244.1677433281853, 401.66152503823366, 369.9966012541131, 333.16440134432094, 428.1085583276372, 325.0323615596387, 388.714069127588, 242.09180783839122, 353.8929771843251, 515.0361388485392, 366.2359300539646, 284.4334608302852, 451.2660947949463, 291.1641659045359, 438.45364884345247, 448.00472964005337, 248.77125086442598, 406.25767019110606, 351.7978287668691, 163.4006318032527, 310.4746758322125, 247.71847080397907, 361.2718135777334, 320.5781376609549, 376.7290220054816, 290.10314531685503, 243.81139600959872, 362.5732855988249, 317.37584357212046, 399.15347233989417, 346.93314924087076, 265.99185134274575, 320.20522427203827, 200.1784605768246, 223.05823355780745, 339.99378308656014, 453.9389992036486, 300.6680939225566, 324.5789044002362, 340.69771855684417, 253.62776023287594, 410.8908749668543, 297.5307394422013, 393.6726102104736, 269.1075114144806, 487.0436783350674, 309.2036757882401, 330.8438181999863, 379.4804642774823, 306.66078833121344, 215.71475603915493, 195.7297104976707, 415.48783768686445, 174.6717636816421, 217.14233689026176, 191.32271691053566, 352.17450768814035, 254.48902338580535, 206.42181634319505, 140.5216756662773, 401.32319103985094, 356.8421755626107, 116.86000073727466, 473.87109112478106, 417.52563623715673, 241.1776551141123, 261.40295749837793, 240.3614466166403, 316.31990812235426, 241.18430722548436, 120.78618160534876, 233.22328274882636, 174.77793499873837, 205.00332242152479, 208.618110997036, 246.22397445024086, 276.6617658408675, 298.04826640288593, 420.5407613885887, 473.66309762684045, 339.99056298225156, 182.93959033356128, 287.6143558435505, 325.11200415392426, 361.3473666151498, 450.8893496151178, 293.6625186728845, 381.30834534061097, 295.09668167409046, 294.14955718747984, 336.90516331715736, 272.74374531485006, 319.13420893211037, 297.34862384757884, 408.0890414868088, 286.6601470078534, 345.6781229316114, 218.1906927138706, 388.08936529547367, 360.91799129014123, 282.8901098867334, 509.05012831150117, 180.54480034379196, 426.617161974343, 269.34772150513766, 380.83905551453967, 324.06691116392324, 250.52053365783232, 314.37107978764624, 465.1468375062571, 296.91195292360237, 274.9946470532211, 86.78993778663256, 254.60519191018903, 291.4020511393111, 342.9767678740479, 355.87339282946357, 259.7042381692228, 264.5047779409236, 336.1964462748358, 338.3550902367744, 296.8700002743618, 242.2616719576914, 282.2442292379887, 280.7302572402451, 257.46059745496274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.532292041868395, "mean_inference_ms": 5.451598467923294, "mean_action_processing_ms": 2.247752710719587, "mean_env_wait_ms": 14.350951628718716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005759239196777344, "StateBufferConnector_ms": 0.0045920610427856445, "ViewRequirementAgentConnector_ms": 0.13442063331604004}, "num_episodes": 23, "episode_return_max": 570.5373986627648, "episode_return_min": -0.1675560626932402, "episode_return_mean": 219.70675541168194, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.50443419354815, "num_env_steps_trained_throughput_per_sec": 66.50443419354815, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1400000, "timers": {"training_iteration_time_ms": 59877.364, "restore_workers_time_ms": 0.013, "training_step_time_ms": 59877.317, "sample_time_ms": 2304.586, "learn_time_ms": 57556.298, "learn_throughput": 69.497, "synch_weights_time_ms": 13.108}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "done": false, "training_iteration": 70, "trial_id": "62684_00000", "date": "2024-08-20_17-28-03", "timestamp": 1724155083, "time_this_iter_s": 60.21477293968201, "time_total_s": 4813.3716077804565, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3acba13a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4813.3716077804565, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 25.58, "ram_util_percent": 82.59294117647057}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.080396002150597, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.2148440702587155, "policy_loss": -0.021522848716458546, "vf_loss": 7.2336499812755175, "vf_explained_var": 0.48965255833686666, "kl": 0.013584734691828753, "entropy": 0.8333473130109462, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 198810.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.15116680513614, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.730233683914104, "policy_loss": -0.024883543363052898, "vf_loss": 8.752156697631513, "vf_explained_var": -0.32614891948523345, "kl": 0.014802629350827485, "entropy": 0.48350134089825647, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1420000, "num_agent_steps_trained": 1420000}, "env_runners": {"episode_reward_max": 610.8193737248024, "episode_reward_min": -0.1675560626932402, "episode_reward_mean": 225.22515539554308, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -521.2741225947744, "predator_policy": 70.62404954376449}, "policy_reward_max": {"prey_policy": 198.2, "predator_policy": 522.0741225947746}, "policy_reward_mean": {"prey_policy": -127.68935651078388, "predator_policy": 304.14661246394735}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.60585257557898, 292.4542759358132, 205.6454425561737, 457.6568957303509, 99.63966635908758, 236.86161095077674, 98.0232365590006, 181.50970885275513, 141.6703669991627, 421.4459465596214, 189.14142953338387, 398.0903335573368, 381.35630638898317, 425.98493558842677, 160.5724739625745, 128.4358339399611, 89.7778592828374, 148.97202640808214, 129.49030321834454, 168.7821916807156, 189.34870150979904, 75.72550366228513, 268.8039695164377, 270.30711675495695, 156.90958497292783, 139.3926777570972, 105.17815715304489, 141.27497190056593, 329.4032893882187, 393.90566849374795, 373.27054114690577, 360.5014577233983, 158.99696789897368, 193.58118735754442, 148.5310305840682, 397.74358936191254, 10.415072787629967, 117.78951833682453, 85.24571605363985, 129.47080002700574, 432.42736068484834, -0.1675560626932402, 232.43249393586157, 135.96210285773913, 141.08984211721534, 306.9276707940671, 405.5679367118536, 222.62410654695168, 212.9130138467029, 388.3559199684505, 185.1637542108724, 137.08535774929018, 191.65859225719896, 168.11663153357244, 386.3535731342524, 26.254237479822795, 174.90443582546763, 459.07169241802774, 99.85290971107523, 407.7128755773218, 318.3812903009793, 130.65457000835065, 203.88666098291955, 145.37417177638363, 209.7195153693803, 170.06365912720813, 225.13089857918536, 126.43420023087887, 245.10555165708976, 186.53983694505297, 81.59805063007727, 243.20023769049723, 102.80941519128993, 186.15652356563282, 192.028441341325, 151.38992143721129, 78.36864107766577, 326.27547268617644, 230.71561457812317, 453.2215596501567, 227.41102903630235, 251.11091320193074, 239.66011675805345, 169.4425004845182, 167.84296935772863, 500.532914223662, 185.79999999999993, 610.8193737248024, 402.56209429129365, 206.2601215286292, 360.3681471626928, 446.7886062895803, 353.0544348555237, 191.91988503257974, 122.81789397853942, 100.59999999999984, 304.57179673204956, 93.49716620929632, 210.00416393220195, 156.1780096054897], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-166.97683024508055, -97.30176187636644, -110.82324267700648, -200.85741423970734, -276.1905182421189, 97.32514328280217, -149.51616224453016, -100.13426461066378, -84.71232043724113, 184.95206467355877, -363.6316601895437, 60.290367898761225, -273.3358599733656, -96.06259194365299, 12.218573313022475, 150.6467507686737, -186.82339562565735, -28.968862496882196, -235.14006964039461, -132.07701900828656, -11.926527385435776, 104.35865292669891, -217.81601073716493, -73.16225272811512, -131.5319322603809, 0.09268495279229372, -244.43260441794072, -118.49025599435961, -83.05192085732956, -207.37495749979766, 32.18524349924094, -191.47209918287422, -182.39514649289063, 181.1, -117.94825870118461, -462.44946827120435, 52.70047616845418, 3.2011625205798246, -243.5514887168907, -147.61258693787715, -398.7857885172238, 150.11928493831215, 154.73118572314172, -311.0093421361234, -445.68616764624005, -102.25700129712033, -254.73790227412672, 35.39259625203436, -295.40205773788176, -61.80793587886608, -90.11250822171155, -275.3119018226217, 35.76338681823183, -112.90805360213454, -355.05571063930176, -83.23745984485957, -35.43033149077103, -335.78277789179083, 5.499276403086093, -146.76357519699906, -418.8396223202925, 40.68997253019599, -135.66265129853565, 16.277514650671762, -320.0323615596387, -373.6605693160224, -307.9193143208805, 118.97974614042255, -173.06233926908413, 167.0844246554783, -253.80781744935882, -511.8986064840262, -57.726968689205215, -201.45811542820735, -234.57472179390817, -75.40572622593064, -252.21119429936792, -275.4206624170865, -437.95364884345236, 21.117174979024757, -364.44374746603194, 93.98112553108527, -405.65662096127693, -202.07845372477453, 164.7346731230546, 52.041201207643184, -402.5710455126017, 90.77020187788203, -217.34696363764832, -37.71071638267689, -309.0621618926404, 66.62983916630958, -66.14708736545208, -45.982212676313026, 123.58101426664132, -383.9295111892684, -364.69524942602794, -64.97300172629787, -17.71946255712389, -313.3758435721207, 187.08118735754448, -396.65347233989434, -249.6306806577597, -126.29571283763755, -88.46757650415103, -241.01106484771364, 135.4916735824495, -17.1207042216893, -25.049965714194343, -324.7888773397899, -202.79810080275354, -271.8624699240607, -449.30340262023736, 84.34829775491646, -83.56752266468412, -286.85853444886885, -209.6048497898869, -410.9837835840131, -146.52806850770128, 22.46401691899072, 162.35167108969904, 46.19672299464099, -467.3243830521691, -499.35728533159727, -25.655580425840594, -231.30588005480305, 110.4036073030572, -434.78797347400484, -83.2306338814162, 128.8621028577394, -377.7804642774824, -301.26078833121227, -194.10371220002475, -78.92435682946544, 2.673444609880162, 63.70075564427016, -384.45911915608104, 37.52643293737131, 121.57360088208074, 106.39088187824062, -230.86159984926925, -258.9981724808583, 126.67977546678236, -251.72102751291914, 1.1455267262476634, -153.5227585858598, 18.346753696843045, -433.1527781942362, -78.64303971488464, 141.98637127510818, -468.50480670486115, 198.2, -135.26253094632176, -17.066239710167018, -89.42605765465535, -415.12563623715624, -13.743368796076053, -42.93644601679781, -253.42599704494404, -28.490946278656644, -5.439029106917324, -355.45760842869146, 194.72069038359686, -185.46629498581157, 23.08971338229138, -118.32870448466862, -80.01242707028871, -155.18588838548453, -55.690860177352434, -231.0743557321048, 6.8275662876483, 177.57425054768197, 80.5449703884594, -373.7575607618665, 99.23494327987468, -473.0451311956397, -420.5407613885887, 70.67386673906239, 172.8951844632728, -358.78632894082705, -381.8850842898664, -80.26163332153688, 167.8016479149083, 115.72006276610963, -356.9473666151488, -440.3548423728755, -418.8004336207564, 166.00549680288162, -218.28926621270097, 111.16083303935473, -330.5000238255019, -224.53287629903883, 48.93463975322342, -171.73347609309525, -277.13055692275526, -298.70990995045315, -43.57343265632869, -104.13583104569989, -262.3768613647171, 57.322940764582, -264.56436931534085, -107.77572117750933, -340.6695799244588, 11.010685687365298, -326.3816258653317, 26.774084515720656, -204.2942635789147, 58.019957298463105, -173.9365947483928, -489.48376380325175, -426.617161974343, -110.0504264386436, 11.103676724928688, 89.66588041026924, -134.15826537476562, -362.4941543646843, -91.73082394147427, -158.47767579905442, -221.56952988993612, -393.6689540451966, -243.0362755480901, 43.34383586501522, -46.133959816828856, -236.29864692800987, -97.4455518906592, 71.6923269938421, -231.56845635596198, -30.129078897489876, -213.95577061399018, -281.9020511393106, -60.15235618239176, -370.7791669524772, -98.2008386512, 179.6778472911666, 175.051651233999, -222.8442529951346, -322.1930078764997, -57.64616260902729, -284.665973221043, 160.30860496908906, -84.4361354789871, 29.43492999438004, -242.09366667477107, -123.91130302078028, -152.14691916577348, -11.021719306723284, -131.4308532091199, -59.04519089994326, 7.4515890745239055, -220.79453634193254, -245.75699467563066, 98.2161165235168, -172.63070808524685, -69.26903681403603, -162.50128536600866, -340.83902116626444, 126.84311303241478, 178.4, -276.48350469615224, -457.4296656413174, 182.9, -441.03621479893445, 159.2611615390297, 175.43339508029968, -252.15211134596575, -19.78412618580855, 115.64865296364272, -194.5223631247076, -264.86416489676816, 2.518639772150294, -379.05699762576756, 182.9355954270425, -195.3066449465623, -39.70704416733203, -107.29096038453889, 158.62965633673085, -289.66730161468763, 64.61953480482019, -87.48788021113259, -136.77679250630027, 77.08410417928002, -208.30448323918912, -271.63493799706066, 14.411546201826319, -205.19280920411816, -157.75054916778274, -124.21600533162089, -521.2741225947744, -165.84030483199786, -141.95173960793335, 71.99414538613652, -305.5718283226825, -110.26049201877781, 51.499999999999964, 106.0041639322023, -59.38213304801246, -353.4784668457203, 29.749450617451668, -411.55559052710976, -207.20829140721838], "policy_predator_policy_reward": [125.82324267700575, 347.88444469702716, 310.8238610755009, 361.3532040593361, 302.807113865392, 237.2010759832172, 227.34317985887907, 348.7029434886958, 150.6134816717066, 306.2060632913769, 70.62404954376449, 231.38306876087825, 244.29826149375455, 232.86859109936444, 238.16787651625222, 129.9614428750836, 218.6979381101432, 298.84428061455, 479.4874716461698, 350.8756092649378, 320.4023365151473, 210.42109519476043, 407.1417900018626, 390.24627052786275, 250.3782466403409, 318.62790977649655, 372.3559522717362, 449.9080738334804, 314.05914044833884, 448.4776575734575, 249.11490071047905, 200.92324054869485, 301.99801053323506, 235.10235058806177, 266.0535952192246, 235.37499979538288, 284.48747779596914, 318.7263273973085, 244.1677433281853, 401.66152503823366, 369.9966012541131, 333.16440134432094, 428.1085583276372, 325.0323615596387, 388.714069127588, 242.09180783839122, 353.8929771843251, 515.0361388485392, 366.2359300539646, 284.4334608302852, 451.2660947949463, 291.1641659045359, 438.45364884345247, 448.00472964005337, 248.77125086442598, 406.25767019110606, 351.7978287668691, 163.4006318032527, 310.4746758322125, 247.71847080397907, 361.2718135777334, 320.5781376609549, 376.7290220054816, 290.10314531685503, 243.81139600959872, 362.5732855988249, 317.37584357212046, 399.15347233989417, 346.93314924087076, 265.99185134274575, 320.20522427203827, 200.1784605768246, 223.05823355780745, 339.99378308656014, 453.9389992036486, 300.6680939225566, 324.5789044002362, 340.69771855684417, 253.62776023287594, 410.8908749668543, 297.5307394422013, 393.6726102104736, 269.1075114144806, 487.0436783350674, 309.2036757882401, 330.8438181999863, 379.4804642774823, 306.66078833121344, 215.71475603915493, 195.7297104976707, 415.48783768686445, 174.6717636816421, 217.14233689026176, 191.32271691053566, 352.17450768814035, 254.48902338580535, 206.42181634319505, 140.5216756662773, 401.32319103985094, 356.8421755626107, 116.86000073727466, 473.87109112478106, 417.52563623715673, 241.1776551141123, 261.40295749837793, 240.3614466166403, 316.31990812235426, 241.18430722548436, 120.78618160534876, 233.22328274882636, 174.77793499873837, 205.00332242152479, 208.618110997036, 246.22397445024086, 276.6617658408675, 298.04826640288593, 420.5407613885887, 473.66309762684045, 339.99056298225156, 182.93959033356128, 287.6143558435505, 325.11200415392426, 361.3473666151498, 450.8893496151178, 293.6625186728845, 381.30834534061097, 295.09668167409046, 294.14955718747984, 336.90516331715736, 272.74374531485006, 319.13420893211037, 297.34862384757884, 408.0890414868088, 286.6601470078534, 345.6781229316114, 218.1906927138706, 388.08936529547367, 360.91799129014123, 282.8901098867334, 509.05012831150117, 180.54480034379196, 426.617161974343, 269.34772150513766, 380.83905551453967, 324.06691116392324, 250.52053365783232, 314.37107978764624, 465.1468375062571, 296.91195292360237, 274.9946470532211, 86.78993778663256, 254.60519191018903, 291.4020511393111, 342.9767678740479, 355.87339282946357, 259.7042381692228, 264.5047779409236, 336.1964462748358, 338.3550902367744, 296.8700002743618, 242.2616719576914, 282.2442292379887, 280.7302572402451, 257.46059745496274, 297.711600498227, 124.97297129436589, 288.7509163645073, 249.0269986140567, 356.3056216768411, 215.938377946179, 244.13577057206356, 291.99305178544773, 458.92966564131774, 277.88350469615216, 380.14231304381127, 337.018718860595, 256.238727096719, 302.6109517627046, 261.93757203656037, 401.19043774139556, 412.262279048341, 339.5339152596387, 220.34473211906007, 214.81222238565942, 242.84295855302963, 422.7471233234944, 208.69807192013099, 251.2189846786582, 355.50692318615995, 229.7271717917328, 522.0741225947746, 381.7665544994025, 268.43608539662677, 271.9336103892171, 309.17182832268236, 148.65765822807404, 159.58213304801217, 357.2784668457201, 411.7152038544841, 333.4772370678822]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.485111931306408, "mean_inference_ms": 5.421532465166373, "mean_action_processing_ms": 2.2422921358336616, "mean_env_wait_ms": 14.255929343746935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005761981010437012, "StateBufferConnector_ms": 0.004594564437866211, "ViewRequirementAgentConnector_ms": 0.13433623313903809}, "num_episodes": 18, "episode_return_max": 610.8193737248024, "episode_return_min": -0.1675560626932402, "episode_return_mean": 225.22515539554308, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1420000, "num_agent_steps_trained": 1420000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.85502163351951, "num_env_steps_trained_throughput_per_sec": 66.85502163351951, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1420000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1420000, "timers": {"training_iteration_time_ms": 59833.844, "restore_workers_time_ms": 0.013, "training_step_time_ms": 59833.797, "sample_time_ms": 2273.054, "learn_time_ms": 57543.7, "learn_throughput": 69.512, "synch_weights_time_ms": 13.525}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1420000, "num_agent_steps_trained": 1420000}, "done": false, "training_iteration": 71, "trial_id": "62684_00000", "date": "2024-08-20_17-29-03", "timestamp": 1724155143, "time_this_iter_s": 59.88428974151611, "time_total_s": 4873.255897521973, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ff9bf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4873.255897521973, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 24.860714285714284, "ram_util_percent": 82.7202380952381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.107287793886577, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.522471471543008, "policy_loss": -0.020584737685185376, "vf_loss": 7.540085165382277, "vf_explained_var": 0.48167871849756716, "kl": 0.014855186093321189, "entropy": 0.8318690312669632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 201630.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.15454657080943, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.856652044114613, "policy_loss": -0.026781111818900895, "vf_loss": 8.880736174154533, "vf_explained_var": -0.40529817383756084, "kl": 0.013484918751886912, "entropy": 0.4911904599300768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 610.8193737248024, "episode_reward_min": -0.1675560626932402, "episode_reward_mean": 224.19826439578577, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -605.388786232089, "predator_policy": 86.78993778663256}, "policy_reward_max": {"prey_policy": 198.2, "predator_policy": 560.0686525919806}, "policy_reward_mean": {"prey_policy": -130.77374174048066, "predator_policy": 308.25974480861385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [168.7821916807156, 189.34870150979904, 75.72550366228513, 268.8039695164377, 270.30711675495695, 156.90958497292783, 139.3926777570972, 105.17815715304489, 141.27497190056593, 329.4032893882187, 393.90566849374795, 373.27054114690577, 360.5014577233983, 158.99696789897368, 193.58118735754442, 148.5310305840682, 397.74358936191254, 10.415072787629967, 117.78951833682453, 85.24571605363985, 129.47080002700574, 432.42736068484834, -0.1675560626932402, 232.43249393586157, 135.96210285773913, 141.08984211721534, 306.9276707940671, 405.5679367118536, 222.62410654695168, 212.9130138467029, 388.3559199684505, 185.1637542108724, 137.08535774929018, 191.65859225719896, 168.11663153357244, 386.3535731342524, 26.254237479822795, 174.90443582546763, 459.07169241802774, 99.85290971107523, 407.7128755773218, 318.3812903009793, 130.65457000835065, 203.88666098291955, 145.37417177638363, 209.7195153693803, 170.06365912720813, 225.13089857918536, 126.43420023087887, 245.10555165708976, 186.53983694505297, 81.59805063007727, 243.20023769049723, 102.80941519128993, 186.15652356563282, 192.028441341325, 151.38992143721129, 78.36864107766577, 326.27547268617644, 230.71561457812317, 453.2215596501567, 227.41102903630235, 251.11091320193074, 239.66011675805345, 169.4425004845182, 167.84296935772863, 500.532914223662, 185.79999999999993, 610.8193737248024, 402.56209429129365, 206.2601215286292, 360.3681471626928, 446.7886062895803, 353.0544348555237, 191.91988503257974, 122.81789397853942, 100.59999999999984, 304.57179673204956, 93.49716620929632, 210.00416393220195, 156.1780096054897, 123.91527742118022, 228.2978054521489, 163.1999999999996, 182.4539696034487, 149.31341115105488, 226.93991894324023, 93.8630410873135, 256.2215461171333, 344.91099520825315, 249.4130241518358, 22.00082780179506, 305.87309452909693, 139.70221874469254, 241.89453337195363, 175.7480380999682, 346.31532943078344, 322.12120880685745, 223.67141014048656, 386.7897549212741], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-335.78277789179083, 5.499276403086093, -146.76357519699906, -418.8396223202925, 40.68997253019599, -135.66265129853565, 16.277514650671762, -320.0323615596387, -373.6605693160224, -307.9193143208805, 118.97974614042255, -173.06233926908413, 167.0844246554783, -253.80781744935882, -511.8986064840262, -57.726968689205215, -201.45811542820735, -234.57472179390817, -75.40572622593064, -252.21119429936792, -275.4206624170865, -437.95364884345236, 21.117174979024757, -364.44374746603194, 93.98112553108527, -405.65662096127693, -202.07845372477453, 164.7346731230546, 52.041201207643184, -402.5710455126017, 90.77020187788203, -217.34696363764832, -37.71071638267689, -309.0621618926404, 66.62983916630958, -66.14708736545208, -45.982212676313026, 123.58101426664132, -383.9295111892684, -364.69524942602794, -64.97300172629787, -17.71946255712389, -313.3758435721207, 187.08118735754448, -396.65347233989434, -249.6306806577597, -126.29571283763755, -88.46757650415103, -241.01106484771364, 135.4916735824495, -17.1207042216893, -25.049965714194343, -324.7888773397899, -202.79810080275354, -271.8624699240607, -449.30340262023736, 84.34829775491646, -83.56752266468412, -286.85853444886885, -209.6048497898869, -410.9837835840131, -146.52806850770128, 22.46401691899072, 162.35167108969904, 46.19672299464099, -467.3243830521691, -499.35728533159727, -25.655580425840594, -231.30588005480305, 110.4036073030572, -434.78797347400484, -83.2306338814162, 128.8621028577394, -377.7804642774824, -301.26078833121227, -194.10371220002475, -78.92435682946544, 2.673444609880162, 63.70075564427016, -384.45911915608104, 37.52643293737131, 121.57360088208074, 106.39088187824062, -230.86159984926925, -258.9981724808583, 126.67977546678236, -251.72102751291914, 1.1455267262476634, -153.5227585858598, 18.346753696843045, -433.1527781942362, -78.64303971488464, 141.98637127510818, -468.50480670486115, 198.2, -135.26253094632176, -17.066239710167018, -89.42605765465535, -415.12563623715624, -13.743368796076053, -42.93644601679781, -253.42599704494404, -28.490946278656644, -5.439029106917324, -355.45760842869146, 194.72069038359686, -185.46629498581157, 23.08971338229138, -118.32870448466862, -80.01242707028871, -155.18588838548453, -55.690860177352434, -231.0743557321048, 6.8275662876483, 177.57425054768197, 80.5449703884594, -373.7575607618665, 99.23494327987468, -473.0451311956397, -420.5407613885887, 70.67386673906239, 172.8951844632728, -358.78632894082705, -381.8850842898664, -80.26163332153688, 167.8016479149083, 115.72006276610963, -356.9473666151488, -440.3548423728755, -418.8004336207564, 166.00549680288162, -218.28926621270097, 111.16083303935473, -330.5000238255019, -224.53287629903883, 48.93463975322342, -171.73347609309525, -277.13055692275526, -298.70990995045315, -43.57343265632869, -104.13583104569989, -262.3768613647171, 57.322940764582, -264.56436931534085, -107.77572117750933, -340.6695799244588, 11.010685687365298, -326.3816258653317, 26.774084515720656, -204.2942635789147, 58.019957298463105, -173.9365947483928, -489.48376380325175, -426.617161974343, -110.0504264386436, 11.103676724928688, 89.66588041026924, -134.15826537476562, -362.4941543646843, -91.73082394147427, -158.47767579905442, -221.56952988993612, -393.6689540451966, -243.0362755480901, 43.34383586501522, -46.133959816828856, -236.29864692800987, -97.4455518906592, 71.6923269938421, -231.56845635596198, -30.129078897489876, -213.95577061399018, -281.9020511393106, -60.15235618239176, -370.7791669524772, -98.2008386512, 179.6778472911666, 175.051651233999, -222.8442529951346, -322.1930078764997, -57.64616260902729, -284.665973221043, 160.30860496908906, -84.4361354789871, 29.43492999438004, -242.09366667477107, -123.91130302078028, -152.14691916577348, -11.021719306723284, -131.4308532091199, -59.04519089994326, 7.4515890745239055, -220.79453634193254, -245.75699467563066, 98.2161165235168, -172.63070808524685, -69.26903681403603, -162.50128536600866, -340.83902116626444, 126.84311303241478, 178.4, -276.48350469615224, -457.4296656413174, 182.9, -441.03621479893445, 159.2611615390297, 175.43339508029968, -252.15211134596575, -19.78412618580855, 115.64865296364272, -194.5223631247076, -264.86416489676816, 2.518639772150294, -379.05699762576756, 182.9355954270425, -195.3066449465623, -39.70704416733203, -107.29096038453889, 158.62965633673085, -289.66730161468763, 64.61953480482019, -87.48788021113259, -136.77679250630027, 77.08410417928002, -208.30448323918912, -271.63493799706066, 14.411546201826319, -205.19280920411816, -157.75054916778274, -124.21600533162089, -521.2741225947744, -165.84030483199786, -141.95173960793335, 71.99414538613652, -305.5718283226825, -110.26049201877781, 51.499999999999964, 106.0041639322023, -59.38213304801246, -353.4784668457203, 29.749450617451668, -411.55559052710976, -207.20829140721838, -29.352724745378907, -310.6856347550737, -14.21818664493108, -155.76411994787748, 89.56824874085427, -350.7996666122326, -29.831007822137583, -186.10416286569443, -52.383587076326066, -7.18462274792752, -63.88755298087277, -439.1319052057033, -109.88742342982374, -139.68731006521423, -79.21494956816986, -294.4908146776187, -215.10707251914795, 31.868001110706345, -112.63701096970408, -331.04610599190494, -141.73257582189171, -45.329663807613755, -259.2766116209185, 149.49932878855248, -12.526182611907785, 153.20909314721547, -378.08268067740863, 95.51142077521351, -19.641054905573448, -228.33237991636008, -98.14557128144033, -326.74455177917713, -246.97307012299618, -265.8154849607251, -67.16841498286617, 46.171294873002964, -32.436978873422106, -44.32408943638497, -400.7210064180496, 1.3641532236034735, -6.1980726256731415, -430.06589734345744, -267.84472427561144, -420.1365004986756, 15.163756248939961, -37.47538785994237, 185.6, -409.17529874445006, -216.28163370961644, -295.37039925051704, 164.90897643909807, -321.9246400392828, -198.12872068512573, 197.97141014048705, -605.388786232089, 150.63472313251242, -12.563809428924896], "policy_predator_policy_reward": [244.1677433281853, 401.66152503823366, 369.9966012541131, 333.16440134432094, 428.1085583276372, 325.0323615596387, 388.714069127588, 242.09180783839122, 353.8929771843251, 515.0361388485392, 366.2359300539646, 284.4334608302852, 451.2660947949463, 291.1641659045359, 438.45364884345247, 448.00472964005337, 248.77125086442598, 406.25767019110606, 351.7978287668691, 163.4006318032527, 310.4746758322125, 247.71847080397907, 361.2718135777334, 320.5781376609549, 376.7290220054816, 290.10314531685503, 243.81139600959872, 362.5732855988249, 317.37584357212046, 399.15347233989417, 346.93314924087076, 265.99185134274575, 320.20522427203827, 200.1784605768246, 223.05823355780745, 339.99378308656014, 453.9389992036486, 300.6680939225566, 324.5789044002362, 340.69771855684417, 253.62776023287594, 410.8908749668543, 297.5307394422013, 393.6726102104736, 269.1075114144806, 487.0436783350674, 309.2036757882401, 330.8438181999863, 379.4804642774823, 306.66078833121344, 215.71475603915493, 195.7297104976707, 415.48783768686445, 174.6717636816421, 217.14233689026176, 191.32271691053566, 352.17450768814035, 254.48902338580535, 206.42181634319505, 140.5216756662773, 401.32319103985094, 356.8421755626107, 116.86000073727466, 473.87109112478106, 417.52563623715673, 241.1776551141123, 261.40295749837793, 240.3614466166403, 316.31990812235426, 241.18430722548436, 120.78618160534876, 233.22328274882636, 174.77793499873837, 205.00332242152479, 208.618110997036, 246.22397445024086, 276.6617658408675, 298.04826640288593, 420.5407613885887, 473.66309762684045, 339.99056298225156, 182.93959033356128, 287.6143558435505, 325.11200415392426, 361.3473666151498, 450.8893496151178, 293.6625186728845, 381.30834534061097, 295.09668167409046, 294.14955718747984, 336.90516331715736, 272.74374531485006, 319.13420893211037, 297.34862384757884, 408.0890414868088, 286.6601470078534, 345.6781229316114, 218.1906927138706, 388.08936529547367, 360.91799129014123, 282.8901098867334, 509.05012831150117, 180.54480034379196, 426.617161974343, 269.34772150513766, 380.83905551453967, 324.06691116392324, 250.52053365783232, 314.37107978764624, 465.1468375062571, 296.91195292360237, 274.9946470532211, 86.78993778663256, 254.60519191018903, 291.4020511393111, 342.9767678740479, 355.87339282946357, 259.7042381692228, 264.5047779409236, 336.1964462748358, 338.3550902367744, 296.8700002743618, 242.2616719576914, 282.2442292379887, 280.7302572402451, 257.46059745496274, 297.711600498227, 124.97297129436589, 288.7509163645073, 249.0269986140567, 356.3056216768411, 215.938377946179, 244.13577057206356, 291.99305178544773, 458.92966564131774, 277.88350469615216, 380.14231304381127, 337.018718860595, 256.238727096719, 302.6109517627046, 261.93757203656037, 401.19043774139556, 412.262279048341, 339.5339152596387, 220.34473211906007, 214.81222238565942, 242.84295855302963, 422.7471233234944, 208.69807192013099, 251.2189846786582, 355.50692318615995, 229.7271717917328, 522.0741225947746, 381.7665544994025, 268.43608539662677, 271.9336103892171, 309.17182832268236, 148.65765822807404, 159.58213304801217, 357.2784668457201, 411.7152038544841, 333.4772370678822, 326.49731173455075, 151.67451183201467, 357.4544799030621, 287.8388633683424, 164.7237193062998, 266.79503845785746, 437.9919074913539, 254.6661430465985, 215.73884331491377, 262.3642508993468, 313.9125178373665, 390.7572871919338, 405.6441048503888, 273.634629020426, 191.102385930778, 220.22610682633587, 365.59883366488106, 216.711931685473, 242.9500299812828, 158.92500821727427, 340.9445517791783, 352.91946920623053, 328.6603325745711, 264.02536702511327, 403.12100641805, 214.0632870545006, 446.123837576645, 230.67051254083623, 420.7365004986757, 427.8290061266392, 415.6426059630849, 191.72341007209056, 368.7458107176941, 300.1184546101989, 325.0246400392828, 220.72872068512535, 560.0686525919806, 294.03897485779294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.47415554761908, "mean_inference_ms": 5.412939240140895, "mean_action_processing_ms": 2.198917219807974, "mean_env_wait_ms": 14.231189858764015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005626797676086426, "StateBufferConnector_ms": 0.00460970401763916, "ViewRequirementAgentConnector_ms": 0.1330113410949707}, "num_episodes": 19, "episode_return_max": 610.8193737248024, "episode_return_min": -0.1675560626932402, "episode_return_mean": 224.19826439578577, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.17484339988674, "num_env_steps_trained_throughput_per_sec": 67.17484339988674, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 59812.594, "restore_workers_time_ms": 0.013, "training_step_time_ms": 59812.547, "sample_time_ms": 2217.284, "learn_time_ms": 57578.464, "learn_throughput": 69.47, "synch_weights_time_ms": 13.341}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 72, "trial_id": "62684_00000", "date": "2024-08-20_17-30-03", "timestamp": 1724155203, "time_this_iter_s": 59.587406158447266, "time_total_s": 4932.84330368042, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3acba1f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4932.84330368042, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 24.325, "ram_util_percent": 82.06785714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.815669277416053, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.414983669916789, "policy_loss": -0.018468094757776245, "vf_loss": 7.430882592235051, "vf_explained_var": 0.44949740801297183, "kl": 0.01284579633692187, "entropy": 0.8118907983421434, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 204450.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.900612964012005, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.7838884048361, "policy_loss": -0.026204717980707608, "vf_loss": 8.807260922023229, "vf_explained_var": -0.5621649397113336, "kl": 0.014160946983518817, "entropy": 0.47859245201267264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1460000, "num_agent_steps_trained": 1460000}, "env_runners": {"episode_reward_max": 610.8193737248024, "episode_reward_min": -0.1675560626932402, "episode_reward_mean": 219.21086735676235, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -605.388786232089, "predator_policy": 86.78993778663256}, "policy_reward_max": {"prey_policy": 198.2, "predator_policy": 560.0686525919806}, "policy_reward_mean": {"prey_policy": -126.00903835404696, "predator_policy": 298.6189912094516}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.415072787629967, 117.78951833682453, 85.24571605363985, 129.47080002700574, 432.42736068484834, -0.1675560626932402, 232.43249393586157, 135.96210285773913, 141.08984211721534, 306.9276707940671, 405.5679367118536, 222.62410654695168, 212.9130138467029, 388.3559199684505, 185.1637542108724, 137.08535774929018, 191.65859225719896, 168.11663153357244, 386.3535731342524, 26.254237479822795, 174.90443582546763, 459.07169241802774, 99.85290971107523, 407.7128755773218, 318.3812903009793, 130.65457000835065, 203.88666098291955, 145.37417177638363, 209.7195153693803, 170.06365912720813, 225.13089857918536, 126.43420023087887, 245.10555165708976, 186.53983694505297, 81.59805063007727, 243.20023769049723, 102.80941519128993, 186.15652356563282, 192.028441341325, 151.38992143721129, 78.36864107766577, 326.27547268617644, 230.71561457812317, 453.2215596501567, 227.41102903630235, 251.11091320193074, 239.66011675805345, 169.4425004845182, 167.84296935772863, 500.532914223662, 185.79999999999993, 610.8193737248024, 402.56209429129365, 206.2601215286292, 360.3681471626928, 446.7886062895803, 353.0544348555237, 191.91988503257974, 122.81789397853942, 100.59999999999984, 304.57179673204956, 93.49716620929632, 210.00416393220195, 156.1780096054897, 123.91527742118022, 228.2978054521489, 163.1999999999996, 182.4539696034487, 149.31341115105488, 226.93991894324023, 93.8630410873135, 256.2215461171333, 344.91099520825315, 249.4130241518358, 22.00082780179506, 305.87309452909693, 139.70221874469254, 241.89453337195363, 175.7480380999682, 346.31532943078344, 322.12120880685745, 223.67141014048656, 386.7897549212741, 247.49164661184568, 100.62232172223281, 204.01759275553317, 90.19464413643162, 346.6195011759353, 229.7616963808766, 160.71555834544208, 178.556330699957, 31.718854661155437, 221.02227132685744, 126.79284922614795, 578.0411201581885, 302.4767749543399, 194.7965060813859, 119.79311950480941, 64.51328251212547, 175.78283270699788], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-25.049965714194343, -324.7888773397899, -202.79810080275354, -271.8624699240607, -449.30340262023736, 84.34829775491646, -83.56752266468412, -286.85853444886885, -209.6048497898869, -410.9837835840131, -146.52806850770128, 22.46401691899072, 162.35167108969904, 46.19672299464099, -467.3243830521691, -499.35728533159727, -25.655580425840594, -231.30588005480305, 110.4036073030572, -434.78797347400484, -83.2306338814162, 128.8621028577394, -377.7804642774824, -301.26078833121227, -194.10371220002475, -78.92435682946544, 2.673444609880162, 63.70075564427016, -384.45911915608104, 37.52643293737131, 121.57360088208074, 106.39088187824062, -230.86159984926925, -258.9981724808583, 126.67977546678236, -251.72102751291914, 1.1455267262476634, -153.5227585858598, 18.346753696843045, -433.1527781942362, -78.64303971488464, 141.98637127510818, -468.50480670486115, 198.2, -135.26253094632176, -17.066239710167018, -89.42605765465535, -415.12563623715624, -13.743368796076053, -42.93644601679781, -253.42599704494404, -28.490946278656644, -5.439029106917324, -355.45760842869146, 194.72069038359686, -185.46629498581157, 23.08971338229138, -118.32870448466862, -80.01242707028871, -155.18588838548453, -55.690860177352434, -231.0743557321048, 6.8275662876483, 177.57425054768197, 80.5449703884594, -373.7575607618665, 99.23494327987468, -473.0451311956397, -420.5407613885887, 70.67386673906239, 172.8951844632728, -358.78632894082705, -381.8850842898664, -80.26163332153688, 167.8016479149083, 115.72006276610963, -356.9473666151488, -440.3548423728755, -418.8004336207564, 166.00549680288162, -218.28926621270097, 111.16083303935473, -330.5000238255019, -224.53287629903883, 48.93463975322342, -171.73347609309525, -277.13055692275526, -298.70990995045315, -43.57343265632869, -104.13583104569989, -262.3768613647171, 57.322940764582, -264.56436931534085, -107.77572117750933, -340.6695799244588, 11.010685687365298, -326.3816258653317, 26.774084515720656, -204.2942635789147, 58.019957298463105, -173.9365947483928, -489.48376380325175, -426.617161974343, -110.0504264386436, 11.103676724928688, 89.66588041026924, -134.15826537476562, -362.4941543646843, -91.73082394147427, -158.47767579905442, -221.56952988993612, -393.6689540451966, -243.0362755480901, 43.34383586501522, -46.133959816828856, -236.29864692800987, -97.4455518906592, 71.6923269938421, -231.56845635596198, -30.129078897489876, -213.95577061399018, -281.9020511393106, -60.15235618239176, -370.7791669524772, -98.2008386512, 179.6778472911666, 175.051651233999, -222.8442529951346, -322.1930078764997, -57.64616260902729, -284.665973221043, 160.30860496908906, -84.4361354789871, 29.43492999438004, -242.09366667477107, -123.91130302078028, -152.14691916577348, -11.021719306723284, -131.4308532091199, -59.04519089994326, 7.4515890745239055, -220.79453634193254, -245.75699467563066, 98.2161165235168, -172.63070808524685, -69.26903681403603, -162.50128536600866, -340.83902116626444, 126.84311303241478, 178.4, -276.48350469615224, -457.4296656413174, 182.9, -441.03621479893445, 159.2611615390297, 175.43339508029968, -252.15211134596575, -19.78412618580855, 115.64865296364272, -194.5223631247076, -264.86416489676816, 2.518639772150294, -379.05699762576756, 182.9355954270425, -195.3066449465623, -39.70704416733203, -107.29096038453889, 158.62965633673085, -289.66730161468763, 64.61953480482019, -87.48788021113259, -136.77679250630027, 77.08410417928002, -208.30448323918912, -271.63493799706066, 14.411546201826319, -205.19280920411816, -157.75054916778274, -124.21600533162089, -521.2741225947744, -165.84030483199786, -141.95173960793335, 71.99414538613652, -305.5718283226825, -110.26049201877781, 51.499999999999964, 106.0041639322023, -59.38213304801246, -353.4784668457203, 29.749450617451668, -411.55559052710976, -207.20829140721838, -29.352724745378907, -310.6856347550737, -14.21818664493108, -155.76411994787748, 89.56824874085427, -350.7996666122326, -29.831007822137583, -186.10416286569443, -52.383587076326066, -7.18462274792752, -63.88755298087277, -439.1319052057033, -109.88742342982374, -139.68731006521423, -79.21494956816986, -294.4908146776187, -215.10707251914795, 31.868001110706345, -112.63701096970408, -331.04610599190494, -141.73257582189171, -45.329663807613755, -259.2766116209185, 149.49932878855248, -12.526182611907785, 153.20909314721547, -378.08268067740863, 95.51142077521351, -19.641054905573448, -228.33237991636008, -98.14557128144033, -326.74455177917713, -246.97307012299618, -265.8154849607251, -67.16841498286617, 46.171294873002964, -32.436978873422106, -44.32408943638497, -400.7210064180496, 1.3641532236034735, -6.1980726256731415, -430.06589734345744, -267.84472427561144, -420.1365004986756, 15.163756248939961, -37.47538785994237, 185.6, -409.17529874445006, -216.28163370961644, -295.37039925051704, 164.90897643909807, -321.9246400392828, -198.12872068512573, 197.97141014048705, -605.388786232089, 150.63472313251242, -12.563809428924896, -28.100956199464292, 22.058330727203227, -354.37392698353943, -204.15905586639857, -273.5721889842311, 98.63537814749249, 97.63001300266376, -232.4845895700271, -211.72600621931414, -309.7516490758127, 31.814277688011828, -283.15302953460497, 181.86471871095384, -59.60256183618296, -267.7404125582943, -176.5174688988505, 198.2, -295.6547308909767, 27.8422575561479, -177.94326868766223, -287.2250034378274, -349.4696212069467, -73.26041046051294, 44.32208431349487, 20.000000000000014, -244.6541621626519, -387.27695324430124, -209.5762803028061, 45.34081281940147, -64.73077069806466, -191.02458119934914, 64.9703767504727, -324.4480276440871, 168.5, -475.42353720453895, 192.52521094854222, -118.4924462145617, -88.42371597711137, 11.525142029178813, 27.29894189205602, -154.6837817265879, -177.76469565389408, -37.12787769160419, -149.23628254312058, -117.99512172568194, -34.40421136601826, -324.8999081868405, -279.6595253198597, -212.5647972716152, 67.6676798150782, -236.755588758642], "policy_predator_policy_reward": [223.05823355780745, 339.99378308656014, 453.9389992036486, 300.6680939225566, 324.5789044002362, 340.69771855684417, 253.62776023287594, 410.8908749668543, 297.5307394422013, 393.6726102104736, 269.1075114144806, 487.0436783350674, 309.2036757882401, 330.8438181999863, 379.4804642774823, 306.66078833121344, 215.71475603915493, 195.7297104976707, 415.48783768686445, 174.6717636816421, 217.14233689026176, 191.32271691053566, 352.17450768814035, 254.48902338580535, 206.42181634319505, 140.5216756662773, 401.32319103985094, 356.8421755626107, 116.86000073727466, 473.87109112478106, 417.52563623715673, 241.1776551141123, 261.40295749837793, 240.3614466166403, 316.31990812235426, 241.18430722548436, 120.78618160534876, 233.22328274882636, 174.77793499873837, 205.00332242152479, 208.618110997036, 246.22397445024086, 276.6617658408675, 298.04826640288593, 420.5407613885887, 473.66309762684045, 339.99056298225156, 182.93959033356128, 287.6143558435505, 325.11200415392426, 361.3473666151498, 450.8893496151178, 293.6625186728845, 381.30834534061097, 295.09668167409046, 294.14955718747984, 336.90516331715736, 272.74374531485006, 319.13420893211037, 297.34862384757884, 408.0890414868088, 286.6601470078534, 345.6781229316114, 218.1906927138706, 388.08936529547367, 360.91799129014123, 282.8901098867334, 509.05012831150117, 180.54480034379196, 426.617161974343, 269.34772150513766, 380.83905551453967, 324.06691116392324, 250.52053365783232, 314.37107978764624, 465.1468375062571, 296.91195292360237, 274.9946470532211, 86.78993778663256, 254.60519191018903, 291.4020511393111, 342.9767678740479, 355.87339282946357, 259.7042381692228, 264.5047779409236, 336.1964462748358, 338.3550902367744, 296.8700002743618, 242.2616719576914, 282.2442292379887, 280.7302572402451, 257.46059745496274, 297.711600498227, 124.97297129436589, 288.7509163645073, 249.0269986140567, 356.3056216768411, 215.938377946179, 244.13577057206356, 291.99305178544773, 458.92966564131774, 277.88350469615216, 380.14231304381127, 337.018718860595, 256.238727096719, 302.6109517627046, 261.93757203656037, 401.19043774139556, 412.262279048341, 339.5339152596387, 220.34473211906007, 214.81222238565942, 242.84295855302963, 422.7471233234944, 208.69807192013099, 251.2189846786582, 355.50692318615995, 229.7271717917328, 522.0741225947746, 381.7665544994025, 268.43608539662677, 271.9336103892171, 309.17182832268236, 148.65765822807404, 159.58213304801217, 357.2784668457201, 411.7152038544841, 333.4772370678822, 326.49731173455075, 151.67451183201467, 357.4544799030621, 287.8388633683424, 164.7237193062998, 266.79503845785746, 437.9919074913539, 254.6661430465985, 215.73884331491377, 262.3642508993468, 313.9125178373665, 390.7572871919338, 405.6441048503888, 273.634629020426, 191.102385930778, 220.22610682633587, 365.59883366488106, 216.711931685473, 242.9500299812828, 158.92500821727427, 340.9445517791783, 352.91946920623053, 328.6603325745711, 264.02536702511327, 403.12100641805, 214.0632870545006, 446.123837576645, 230.67051254083623, 420.7365004986757, 427.8290061266392, 415.6426059630849, 191.72341007209056, 368.7458107176941, 300.1184546101989, 325.0246400392828, 220.72872068512535, 560.0686525919806, 294.03897485779294, 322.3068695810255, 285.6013294866215, 276.3660443370689, 203.35214408830046, 260.0878340381004, 290.51034150411095, 338.93339598302623, 312.35164907581327, 186.3325363582504, 305.76522050120815, 216.45752269248658, 287.2763734782169, 302.04558070057044, 295.9959922142144, 208.59427454397772, 348.3700035099454, 365.25815638651613, 278.39181368159325, 334.33774966315883, 115.65075984516827, 344.7245617307164, 232.57051958839537, 397.8717530389907, 294.56769337519535, 179.8108601217466, 318.05693499508675, 270.5559506748738, 229.3900908949375, 264.1161189220955, 160.03628254312048, 370.2982007572182, 333.17872662762625, 277.93043528607654, 279.5051036361004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.436059857863222, "mean_inference_ms": 5.377796139659291, "mean_action_processing_ms": 2.1971977321438954, "mean_env_wait_ms": 14.16750139178258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005627155303955078, "StateBufferConnector_ms": 0.004578948020935059, "ViewRequirementAgentConnector_ms": 0.15499544143676758}, "num_episodes": 17, "episode_return_max": 610.8193737248024, "episode_return_min": -0.1675560626932402, "episode_return_mean": 219.21086735676235, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1460000, "num_agent_steps_trained": 1460000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.00396901848569, "num_env_steps_trained_throughput_per_sec": 67.00396901848569, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1460000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1460000, "timers": {"training_iteration_time_ms": 59745.866, "restore_workers_time_ms": 0.013, "training_step_time_ms": 59745.819, "sample_time_ms": 2203.69, "learn_time_ms": 57525.24, "learn_throughput": 69.535, "synch_weights_time_ms": 13.613}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1460000, "num_agent_steps_trained": 1460000}, "done": false, "training_iteration": 73, "trial_id": "62684_00000", "date": "2024-08-20_17-31-03", "timestamp": 1724155263, "time_this_iter_s": 59.74739193916321, "time_total_s": 4992.590695619583, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ac0a5c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4992.590695619583, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 24.189411764705888, "ram_util_percent": 81.44352941176473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.054568521519924, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.76549751555666, "policy_loss": -0.018475522086476737, "vf_loss": 7.781476355444455, "vf_explained_var": 0.38736511726751394, "kl": 0.012483405728381892, "entropy": 0.797366626719211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 207270.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.02826414682247, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.764832774924223, "policy_loss": -0.027295482962850542, "vf_loss": 8.788994816875963, "vf_explained_var": -0.439204151636709, "kl": 0.015667325763583734, "entropy": 0.4929509579346924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "env_runners": {"episode_reward_max": 610.8193737248024, "episode_reward_min": 22.00082780179506, "episode_reward_mean": 226.04300359687102, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -605.388786232089, "predator_policy": 86.78993778663256}, "policy_reward_max": {"prey_policy": 198.2, "predator_policy": 560.0686525919806}, "policy_reward_mean": {"prey_policy": -127.78267214238542, "predator_policy": 304.69551001201364}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.65457000835065, 203.88666098291955, 145.37417177638363, 209.7195153693803, 170.06365912720813, 225.13089857918536, 126.43420023087887, 245.10555165708976, 186.53983694505297, 81.59805063007727, 243.20023769049723, 102.80941519128993, 186.15652356563282, 192.028441341325, 151.38992143721129, 78.36864107766577, 326.27547268617644, 230.71561457812317, 453.2215596501567, 227.41102903630235, 251.11091320193074, 239.66011675805345, 169.4425004845182, 167.84296935772863, 500.532914223662, 185.79999999999993, 610.8193737248024, 402.56209429129365, 206.2601215286292, 360.3681471626928, 446.7886062895803, 353.0544348555237, 191.91988503257974, 122.81789397853942, 100.59999999999984, 304.57179673204956, 93.49716620929632, 210.00416393220195, 156.1780096054897, 123.91527742118022, 228.2978054521489, 163.1999999999996, 182.4539696034487, 149.31341115105488, 226.93991894324023, 93.8630410873135, 256.2215461171333, 344.91099520825315, 249.4130241518358, 22.00082780179506, 305.87309452909693, 139.70221874469254, 241.89453337195363, 175.7480380999682, 346.31532943078344, 322.12120880685745, 223.67141014048656, 386.7897549212741, 247.49164661184568, 100.62232172223281, 204.01759275553317, 90.19464413643162, 346.6195011759353, 229.7616963808766, 160.71555834544208, 178.556330699957, 31.718854661155437, 221.02227132685744, 126.79284922614795, 578.0411201581885, 302.4767749543399, 194.7965060813859, 119.79311950480941, 64.51328251212547, 175.78283270699788, 26.336804789229568, 221.64595172697497, 232.75515941171008, 442.53339117359326, 218.38198840914592, 266.1796202316339, 146.64443018850562, 184.7034522807982, 242.7652133833079, 255.47895313212715, 52.2742419748239, 207.85747869758424, 232.1551733566721, 505.4977135048466, 323.38799829275854, 105.4396252922918, 117.48902229362912, 226.08330281497177, 355.0732374144421, 284.4730805098745, 288.6036041597769, 367.41931321882925, 357.73313849208273, 267.79596173017916, 130.11511633505614], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [115.72006276610963, -356.9473666151488, -440.3548423728755, -418.8004336207564, 166.00549680288162, -218.28926621270097, 111.16083303935473, -330.5000238255019, -224.53287629903883, 48.93463975322342, -171.73347609309525, -277.13055692275526, -298.70990995045315, -43.57343265632869, -104.13583104569989, -262.3768613647171, 57.322940764582, -264.56436931534085, -107.77572117750933, -340.6695799244588, 11.010685687365298, -326.3816258653317, 26.774084515720656, -204.2942635789147, 58.019957298463105, -173.9365947483928, -489.48376380325175, -426.617161974343, -110.0504264386436, 11.103676724928688, 89.66588041026924, -134.15826537476562, -362.4941543646843, -91.73082394147427, -158.47767579905442, -221.56952988993612, -393.6689540451966, -243.0362755480901, 43.34383586501522, -46.133959816828856, -236.29864692800987, -97.4455518906592, 71.6923269938421, -231.56845635596198, -30.129078897489876, -213.95577061399018, -281.9020511393106, -60.15235618239176, -370.7791669524772, -98.2008386512, 179.6778472911666, 175.051651233999, -222.8442529951346, -322.1930078764997, -57.64616260902729, -284.665973221043, 160.30860496908906, -84.4361354789871, 29.43492999438004, -242.09366667477107, -123.91130302078028, -152.14691916577348, -11.021719306723284, -131.4308532091199, -59.04519089994326, 7.4515890745239055, -220.79453634193254, -245.75699467563066, 98.2161165235168, -172.63070808524685, -69.26903681403603, -162.50128536600866, -340.83902116626444, 126.84311303241478, 178.4, -276.48350469615224, -457.4296656413174, 182.9, -441.03621479893445, 159.2611615390297, 175.43339508029968, -252.15211134596575, -19.78412618580855, 115.64865296364272, -194.5223631247076, -264.86416489676816, 2.518639772150294, -379.05699762576756, 182.9355954270425, -195.3066449465623, -39.70704416733203, -107.29096038453889, 158.62965633673085, -289.66730161468763, 64.61953480482019, -87.48788021113259, -136.77679250630027, 77.08410417928002, -208.30448323918912, -271.63493799706066, 14.411546201826319, -205.19280920411816, -157.75054916778274, -124.21600533162089, -521.2741225947744, -165.84030483199786, -141.95173960793335, 71.99414538613652, -305.5718283226825, -110.26049201877781, 51.499999999999964, 106.0041639322023, -59.38213304801246, -353.4784668457203, 29.749450617451668, -411.55559052710976, -207.20829140721838, -29.352724745378907, -310.6856347550737, -14.21818664493108, -155.76411994787748, 89.56824874085427, -350.7996666122326, -29.831007822137583, -186.10416286569443, -52.383587076326066, -7.18462274792752, -63.88755298087277, -439.1319052057033, -109.88742342982374, -139.68731006521423, -79.21494956816986, -294.4908146776187, -215.10707251914795, 31.868001110706345, -112.63701096970408, -331.04610599190494, -141.73257582189171, -45.329663807613755, -259.2766116209185, 149.49932878855248, -12.526182611907785, 153.20909314721547, -378.08268067740863, 95.51142077521351, -19.641054905573448, -228.33237991636008, -98.14557128144033, -326.74455177917713, -246.97307012299618, -265.8154849607251, -67.16841498286617, 46.171294873002964, -32.436978873422106, -44.32408943638497, -400.7210064180496, 1.3641532236034735, -6.1980726256731415, -430.06589734345744, -267.84472427561144, -420.1365004986756, 15.163756248939961, -37.47538785994237, 185.6, -409.17529874445006, -216.28163370961644, -295.37039925051704, 164.90897643909807, -321.9246400392828, -198.12872068512573, 197.97141014048705, -605.388786232089, 150.63472313251242, -12.563809428924896, -28.100956199464292, 22.058330727203227, -354.37392698353943, -204.15905586639857, -273.5721889842311, 98.63537814749249, 97.63001300266376, -232.4845895700271, -211.72600621931414, -309.7516490758127, 31.814277688011828, -283.15302953460497, 181.86471871095384, -59.60256183618296, -267.7404125582943, -176.5174688988505, 198.2, -295.6547308909767, 27.8422575561479, -177.94326868766223, -287.2250034378274, -349.4696212069467, -73.26041046051294, 44.32208431349487, 20.000000000000014, -244.6541621626519, -387.27695324430124, -209.5762803028061, 45.34081281940147, -64.73077069806466, -191.02458119934914, 64.9703767504727, -324.4480276440871, 168.5, -475.42353720453895, 192.52521094854222, -118.4924462145617, -88.42371597711137, 11.525142029178813, 27.29894189205602, -154.6837817265879, -177.76469565389408, -37.12787769160419, -149.23628254312058, -117.99512172568194, -34.40421136601826, -324.8999081868405, -279.6595253198597, -212.5647972716152, 67.6676798150782, -236.755588758642, -348.8597714135104, -248.35016486630997, -53.91084335556864, 121.01331342010344, -304.5613709236701, -314.0237265107602, -183.47075356033918, 151.64336655210877, -332.6311924589262, -361.14939532303, -11.345602635824164, 177.50743181819587, -101.39661172748873, -138.4114143747848, -61.397654105385506, -173.38710204123547, -341.3402244375049, 141.27691584874339, -331.8916490734976, -22.462200562947086, -19.530259061008266, 82.72558819426443, -447.60413468695, -125.69889136512747, -200.42670137575277, 179.55728988997316, -352.3174524469719, 24.165264418070436, -143.22383809949451, -207.35988978195036, -268.7586385528481, -519.7141057260046, 76.81885481840229, -165.78030277868422, 136.77250417289503, -322.0578834889276, -433.1534601556312, -12.231450661320462, -14.350872627957507, 184.69789654825937, 69.70564794184779, -380.31635330993925, 20.000000000000014, -390.02502451345197, 150.85946558480245, -431.08774045643617, 31.94271823550384, -326.8543885212897, -10.233657408305074, -419.46881454536356, -106.75457120093807, 179.88330281497215, -354.58259851392904, -244.79677219637648, 94.19881075650136, -36.83261358640196, -385.3047730826584, -234.59060799295162, -179.31830441796444, 29.98939526213857, -235.23180929619852, 83.05260544655103, -153.343328677209, 181.92291550124241, -138.5445427284967, 9.816413128370119, 179.69232589800455, -114.71738989286467, -602.8228807218497, -113.59860248802326, -377.6122953253298, 119.917409020624, -136.8767171505995, -166.101133788763, -128.57312476328994], "policy_predator_policy_reward": [361.3473666151498, 450.8893496151178, 293.6625186728845, 381.30834534061097, 295.09668167409046, 294.14955718747984, 336.90516331715736, 272.74374531485006, 319.13420893211037, 297.34862384757884, 408.0890414868088, 286.6601470078534, 345.6781229316114, 218.1906927138706, 388.08936529547367, 360.91799129014123, 282.8901098867334, 509.05012831150117, 180.54480034379196, 426.617161974343, 269.34772150513766, 380.83905551453967, 324.06691116392324, 250.52053365783232, 314.37107978764624, 465.1468375062571, 296.91195292360237, 274.9946470532211, 86.78993778663256, 254.60519191018903, 291.4020511393111, 342.9767678740479, 355.87339282946357, 259.7042381692228, 264.5047779409236, 336.1964462748358, 338.3550902367744, 296.8700002743618, 242.2616719576914, 282.2442292379887, 280.7302572402451, 257.46059745496274, 297.711600498227, 124.97297129436589, 288.7509163645073, 249.0269986140567, 356.3056216768411, 215.938377946179, 244.13577057206356, 291.99305178544773, 458.92966564131774, 277.88350469615216, 380.14231304381127, 337.018718860595, 256.238727096719, 302.6109517627046, 261.93757203656037, 401.19043774139556, 412.262279048341, 339.5339152596387, 220.34473211906007, 214.81222238565942, 242.84295855302963, 422.7471233234944, 208.69807192013099, 251.2189846786582, 355.50692318615995, 229.7271717917328, 522.0741225947746, 381.7665544994025, 268.43608539662677, 271.9336103892171, 309.17182832268236, 148.65765822807404, 159.58213304801217, 357.2784668457201, 411.7152038544841, 333.4772370678822, 326.49731173455075, 151.67451183201467, 357.4544799030621, 287.8388633683424, 164.7237193062998, 266.79503845785746, 437.9919074913539, 254.6661430465985, 215.73884331491377, 262.3642508993468, 313.9125178373665, 390.7572871919338, 405.6441048503888, 273.634629020426, 191.102385930778, 220.22610682633587, 365.59883366488106, 216.711931685473, 242.9500299812828, 158.92500821727427, 340.9445517791783, 352.91946920623053, 328.6603325745711, 264.02536702511327, 403.12100641805, 214.0632870545006, 446.123837576645, 230.67051254083623, 420.7365004986757, 427.8290061266392, 415.6426059630849, 191.72341007209056, 368.7458107176941, 300.1184546101989, 325.0246400392828, 220.72872068512535, 560.0686525919806, 294.03897485779294, 322.3068695810255, 285.6013294866215, 276.3660443370689, 203.35214408830046, 260.0878340381004, 290.51034150411095, 338.93339598302623, 312.35164907581327, 186.3325363582504, 305.76522050120815, 216.45752269248658, 287.2763734782169, 302.04558070057044, 295.9959922142144, 208.59427454397772, 348.3700035099454, 365.25815638651613, 278.39181368159325, 334.33774966315883, 115.65075984516827, 344.7245617307164, 232.57051958839537, 397.8717530389907, 294.56769337519535, 179.8108601217466, 318.05693499508675, 270.5559506748738, 229.3900908949375, 264.1161189220955, 160.03628254312048, 370.2982007572182, 333.17872662762625, 277.93043528607654, 279.5051036361004, 349.3429897944742, 328.1145946301439, 369.17166657115524, 350.04606917014615, 251.05141063191428, 346.16232824695226, 310.0261995230688, 327.494757791183, 282.7805635220882, 236.8071050947168, 375.21544904477537, 264.4145818168558, 204.6936581214464, 315.83488076451334, 232.55666933462714, 442.72422080398513, 270.47967874519355, 345.472398570866, 293.71342728651854, 288.1839893089837, 476.9747130457445, 286.9534183895305, 232.97931448817218, 325.9438463041285, 314.0336351885799, 377.85732161300257, 317.2015894934, 314.2089328312783, 241.2227780396338, 301.33077918177315, 281.6886865127594, 549.7503495217545, 438.48541051639927, 215.460654931837, 286.2967721963761, 359.2825985139295, 303.81661578856875, 379.19519753843133, 323.3510210312755, 345.0415766273768, 321.73674669551536, 272.38938999111855, 134.1791352387813, 180.04539207893006, 448.4355267581138, 447.1455564506777, 364.3986412748766, 274.6908092480308, 346.1782701661918, 215.48782187151653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.387836663462382, "mean_inference_ms": 5.35709850516849, "mean_action_processing_ms": 2.1979391481133526, "mean_env_wait_ms": 14.11307030363369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058176517486572266, "StateBufferConnector_ms": 0.006798744201660156, "ViewRequirementAgentConnector_ms": 0.16593420505523682}, "num_episodes": 25, "episode_return_max": 610.8193737248024, "episode_return_min": 22.00082780179506, "episode_return_mean": 226.04300359687102, "episodes_this_iter": 25}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 31.215464720225068, "num_env_steps_trained_throughput_per_sec": 31.215464720225068, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1480000, "timers": {"training_iteration_time_ms": 66605.067, "restore_workers_time_ms": 0.014, "training_step_time_ms": 66605.019, "sample_time_ms": 2220.281, "learn_time_ms": 64365.912, "learn_throughput": 62.145, "synch_weights_time_ms": 15.584}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "done": false, "training_iteration": 74, "trial_id": "62684_00000", "date": "2024-08-20_17-33-11", "timestamp": 1724155391, "time_this_iter_s": 128.22449779510498, "time_total_s": 5120.815193414688, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f928ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5120.815193414688, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 30.99090909090909, "ram_util_percent": 82.44318181818181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.204713367781741, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.807860233935904, "policy_loss": -0.019672828941054456, "vf_loss": 7.824852435977746, "vf_explained_var": 0.4168771153434794, "kl": 0.013403088992943736, "entropy": 0.7971866994884843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 210090.5, "diff_num_grad_updates_vs_sampler_policy": 1448.9800000000105}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.926005198842002, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.798551266029397, "policy_loss": -0.029916738230419695, "vf_loss": 8.824787555169808, "vf_explained_var": -0.41526823923701334, "kl": 0.018402260659932695, "entropy": 0.5361918656756638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "env_runners": {"episode_reward_max": 610.8193737248024, "episode_reward_min": 22.00082780179506, "episode_reward_mean": 235.22166308895584, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -605.388786232089, "predator_policy": 67.4253169500919}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 560.0686525919806}, "policy_reward_mean": {"prey_policy": -119.79825111536489, "predator_policy": 297.30820821752525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [326.27547268617644, 230.71561457812317, 453.2215596501567, 227.41102903630235, 251.11091320193074, 239.66011675805345, 169.4425004845182, 167.84296935772863, 500.532914223662, 185.79999999999993, 610.8193737248024, 402.56209429129365, 206.2601215286292, 360.3681471626928, 446.7886062895803, 353.0544348555237, 191.91988503257974, 122.81789397853942, 100.59999999999984, 304.57179673204956, 93.49716620929632, 210.00416393220195, 156.1780096054897, 123.91527742118022, 228.2978054521489, 163.1999999999996, 182.4539696034487, 149.31341115105488, 226.93991894324023, 93.8630410873135, 256.2215461171333, 344.91099520825315, 249.4130241518358, 22.00082780179506, 305.87309452909693, 139.70221874469254, 241.89453337195363, 175.7480380999682, 346.31532943078344, 322.12120880685745, 223.67141014048656, 386.7897549212741, 247.49164661184568, 100.62232172223281, 204.01759275553317, 90.19464413643162, 346.6195011759353, 229.7616963808766, 160.71555834544208, 178.556330699957, 31.718854661155437, 221.02227132685744, 126.79284922614795, 578.0411201581885, 302.4767749543399, 194.7965060813859, 119.79311950480941, 64.51328251212547, 175.78283270699788, 26.336804789229568, 221.64595172697497, 232.75515941171008, 442.53339117359326, 218.38198840914592, 266.1796202316339, 146.64443018850562, 184.7034522807982, 242.7652133833079, 255.47895313212715, 52.2742419748239, 207.85747869758424, 232.1551733566721, 505.4977135048466, 323.38799829275854, 105.4396252922918, 117.48902229362912, 226.08330281497177, 355.0732374144421, 284.4730805098745, 288.6036041597769, 367.41931321882925, 357.73313849208273, 267.79596173017916, 130.11511633505614, 226.22432968084541, 322.25869622883573, 123.14929485315412, 412.42135292401406, 308.27479404525496, 39.40815233401085, 146.69112043151952, 241.5879059023656, 226.31774896220242, 443.34661378030296, 214.48817966848281, 260.21340444490585, 178.2585042786454, 182.3706733823465, 103.57064433796515, 167.74482956377886], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-370.7791669524772, -98.2008386512, 179.6778472911666, 175.051651233999, -222.8442529951346, -322.1930078764997, -57.64616260902729, -284.665973221043, 160.30860496908906, -84.4361354789871, 29.43492999438004, -242.09366667477107, -123.91130302078028, -152.14691916577348, -11.021719306723284, -131.4308532091199, -59.04519089994326, 7.4515890745239055, -220.79453634193254, -245.75699467563066, 98.2161165235168, -172.63070808524685, -69.26903681403603, -162.50128536600866, -340.83902116626444, 126.84311303241478, 178.4, -276.48350469615224, -457.4296656413174, 182.9, -441.03621479893445, 159.2611615390297, 175.43339508029968, -252.15211134596575, -19.78412618580855, 115.64865296364272, -194.5223631247076, -264.86416489676816, 2.518639772150294, -379.05699762576756, 182.9355954270425, -195.3066449465623, -39.70704416733203, -107.29096038453889, 158.62965633673085, -289.66730161468763, 64.61953480482019, -87.48788021113259, -136.77679250630027, 77.08410417928002, -208.30448323918912, -271.63493799706066, 14.411546201826319, -205.19280920411816, -157.75054916778274, -124.21600533162089, -521.2741225947744, -165.84030483199786, -141.95173960793335, 71.99414538613652, -305.5718283226825, -110.26049201877781, 51.499999999999964, 106.0041639322023, -59.38213304801246, -353.4784668457203, 29.749450617451668, -411.55559052710976, -207.20829140721838, -29.352724745378907, -310.6856347550737, -14.21818664493108, -155.76411994787748, 89.56824874085427, -350.7996666122326, -29.831007822137583, -186.10416286569443, -52.383587076326066, -7.18462274792752, -63.88755298087277, -439.1319052057033, -109.88742342982374, -139.68731006521423, -79.21494956816986, -294.4908146776187, -215.10707251914795, 31.868001110706345, -112.63701096970408, -331.04610599190494, -141.73257582189171, -45.329663807613755, -259.2766116209185, 149.49932878855248, -12.526182611907785, 153.20909314721547, -378.08268067740863, 95.51142077521351, -19.641054905573448, -228.33237991636008, -98.14557128144033, -326.74455177917713, -246.97307012299618, -265.8154849607251, -67.16841498286617, 46.171294873002964, -32.436978873422106, -44.32408943638497, -400.7210064180496, 1.3641532236034735, -6.1980726256731415, -430.06589734345744, -267.84472427561144, -420.1365004986756, 15.163756248939961, -37.47538785994237, 185.6, -409.17529874445006, -216.28163370961644, -295.37039925051704, 164.90897643909807, -321.9246400392828, -198.12872068512573, 197.97141014048705, -605.388786232089, 150.63472313251242, -12.563809428924896, -28.100956199464292, 22.058330727203227, -354.37392698353943, -204.15905586639857, -273.5721889842311, 98.63537814749249, 97.63001300266376, -232.4845895700271, -211.72600621931414, -309.7516490758127, 31.814277688011828, -283.15302953460497, 181.86471871095384, -59.60256183618296, -267.7404125582943, -176.5174688988505, 198.2, -295.6547308909767, 27.8422575561479, -177.94326868766223, -287.2250034378274, -349.4696212069467, -73.26041046051294, 44.32208431349487, 20.000000000000014, -244.6541621626519, -387.27695324430124, -209.5762803028061, 45.34081281940147, -64.73077069806466, -191.02458119934914, 64.9703767504727, -324.4480276440871, 168.5, -475.42353720453895, 192.52521094854222, -118.4924462145617, -88.42371597711137, 11.525142029178813, 27.29894189205602, -154.6837817265879, -177.76469565389408, -37.12787769160419, -149.23628254312058, -117.99512172568194, -34.40421136601826, -324.8999081868405, -279.6595253198597, -212.5647972716152, 67.6676798150782, -236.755588758642, -348.8597714135104, -248.35016486630997, -53.91084335556864, 121.01331342010344, -304.5613709236701, -314.0237265107602, -183.47075356033918, 151.64336655210877, -332.6311924589262, -361.14939532303, -11.345602635824164, 177.50743181819587, -101.39661172748873, -138.4114143747848, -61.397654105385506, -173.38710204123547, -341.3402244375049, 141.27691584874339, -331.8916490734976, -22.462200562947086, -19.530259061008266, 82.72558819426443, -447.60413468695, -125.69889136512747, -200.42670137575277, 179.55728988997316, -352.3174524469719, 24.165264418070436, -143.22383809949451, -207.35988978195036, -268.7586385528481, -519.7141057260046, 76.81885481840229, -165.78030277868422, 136.77250417289503, -322.0578834889276, -433.1534601556312, -12.231450661320462, -14.350872627957507, 184.69789654825937, 69.70564794184779, -380.31635330993925, 20.000000000000014, -390.02502451345197, 150.85946558480245, -431.08774045643617, 31.94271823550384, -326.8543885212897, -10.233657408305074, -419.46881454536356, -106.75457120093807, 179.88330281497215, -354.58259851392904, -244.79677219637648, 94.19881075650136, -36.83261358640196, -385.3047730826584, -234.59060799295162, -179.31830441796444, 29.98939526213857, -235.23180929619852, 83.05260544655103, -153.343328677209, 181.92291550124241, -138.5445427284967, 9.816413128370119, 179.69232589800455, -114.71738989286467, -602.8228807218497, -113.59860248802326, -377.6122953253298, 119.917409020624, -136.8767171505995, -166.101133788763, -128.57312476328994, -169.4353451359837, -164.97052188089967, 146.89999999999998, -247.12876376103958, -25.37792339152621, 113.88366888700324, -68.69127378874269, -205.7167479371031, -260.11000224807333, 172.756810800985, -22.700239951441517, -350.63333850191964, -438.39469585828635, 156.78218534267296, -108.84943479952645, -283.91039955060126, -254.5199213104436, -143.0125106098352, -136.57348645865238, -12.68329033857232, -101.05949390471369, -116.57170380050407, -296.09501983115484, 125.23738090125275, 22.784205121406284, -130.76546433339016, -172.53191753271852, -259.7809196746442, -154.54948919763245, 188.19516619723709, 36.671037402600334, -145.9923524417558, -24.05232615334107, -274.186514717698, -389.772178086085, 200.0, -197.3991067386585, -174.34383174535188, 34.39435476496797, -103.76198630600004, -202.36175770553507, 36.99826071341991, -59.54853907178587, -225.37848227999234, -148.00438727344064, -147.22460146347905, 47.12437514383084, -253.13868336004077], "policy_predator_policy_reward": [355.87339282946357, 259.7042381692228, 264.5047779409236, 336.1964462748358, 338.3550902367744, 296.8700002743618, 242.2616719576914, 282.2442292379887, 280.7302572402451, 257.46059745496274, 297.711600498227, 124.97297129436589, 288.7509163645073, 249.0269986140567, 356.3056216768411, 215.938377946179, 244.13577057206356, 291.99305178544773, 458.92966564131774, 277.88350469615216, 380.14231304381127, 337.018718860595, 256.238727096719, 302.6109517627046, 261.93757203656037, 401.19043774139556, 412.262279048341, 339.5339152596387, 220.34473211906007, 214.81222238565942, 242.84295855302963, 422.7471233234944, 208.69807192013099, 251.2189846786582, 355.50692318615995, 229.7271717917328, 522.0741225947746, 381.7665544994025, 268.43608539662677, 271.9336103892171, 309.17182832268236, 148.65765822807404, 159.58213304801217, 357.2784668457201, 411.7152038544841, 333.4772370678822, 326.49731173455075, 151.67451183201467, 357.4544799030621, 287.8388633683424, 164.7237193062998, 266.79503845785746, 437.9919074913539, 254.6661430465985, 215.73884331491377, 262.3642508993468, 313.9125178373665, 390.7572871919338, 405.6441048503888, 273.634629020426, 191.102385930778, 220.22610682633587, 365.59883366488106, 216.711931685473, 242.9500299812828, 158.92500821727427, 340.9445517791783, 352.91946920623053, 328.6603325745711, 264.02536702511327, 403.12100641805, 214.0632870545006, 446.123837576645, 230.67051254083623, 420.7365004986757, 427.8290061266392, 415.6426059630849, 191.72341007209056, 368.7458107176941, 300.1184546101989, 325.0246400392828, 220.72872068512535, 560.0686525919806, 294.03897485779294, 322.3068695810255, 285.6013294866215, 276.3660443370689, 203.35214408830046, 260.0878340381004, 290.51034150411095, 338.93339598302623, 312.35164907581327, 186.3325363582504, 305.76522050120815, 216.45752269248658, 287.2763734782169, 302.04558070057044, 295.9959922142144, 208.59427454397772, 348.3700035099454, 365.25815638651613, 278.39181368159325, 334.33774966315883, 115.65075984516827, 344.7245617307164, 232.57051958839537, 397.8717530389907, 294.56769337519535, 179.8108601217466, 318.05693499508675, 270.5559506748738, 229.3900908949375, 264.1161189220955, 160.03628254312048, 370.2982007572182, 333.17872662762625, 277.93043528607654, 279.5051036361004, 349.3429897944742, 328.1145946301439, 369.17166657115524, 350.04606917014615, 251.05141063191428, 346.16232824695226, 310.0261995230688, 327.494757791183, 282.7805635220882, 236.8071050947168, 375.21544904477537, 264.4145818168558, 204.6936581214464, 315.83488076451334, 232.55666933462714, 442.72422080398513, 270.47967874519355, 345.472398570866, 293.71342728651854, 288.1839893089837, 476.9747130457445, 286.9534183895305, 232.97931448817218, 325.9438463041285, 314.0336351885799, 377.85732161300257, 317.2015894934, 314.2089328312783, 241.2227780396338, 301.33077918177315, 281.6886865127594, 549.7503495217545, 438.48541051639927, 215.460654931837, 286.2967721963761, 359.2825985139295, 303.81661578856875, 379.19519753843133, 323.3510210312755, 345.0415766273768, 321.73674669551536, 272.38938999111855, 134.1791352387813, 180.04539207893006, 448.4355267581138, 447.1455564506777, 364.3986412748766, 274.6908092480308, 346.1782701661918, 215.48782187151653, 239.4637895368996, 174.2664071608295, 231.30816934949058, 249.57354514490774, 364.045672531657, 293.6216462954171, 278.3791797112461, 334.61894086514303, 413.02929554730866, 285.70744381308583, 429.56219550671545, 291.2887882981749, 89.13186062697035, 307.87553050648796, 289.7131895151853, 239.30405911758655, 343.4024626894158, 163.42846301748867, 242.66291010167834, 426.8189463536647, 105.52180463390967, 242.34001622706973, 377.9982975132685, 346.1737997354209, 302.5364388432483, 213.07064915444045, 67.4253169500919, 384.07083973036924, 230.87116001837876, 305.63089294480477, 227.36199428469592, 293.6217449587718]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.374870471301968, "mean_inference_ms": 5.334603521304416, "mean_action_processing_ms": 2.1771288778852043, "mean_env_wait_ms": 14.046177656180411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004854440689086914, "StateBufferConnector_ms": 0.006949663162231445, "ViewRequirementAgentConnector_ms": 0.18238866329193115}, "num_episodes": 16, "episode_return_max": 610.8193737248024, "episode_return_min": 22.00082780179506, "episode_return_mean": 235.22166308895584, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 64.9612243556749, "num_env_steps_trained_throughput_per_sec": 64.9612243556749, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1500000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1500000, "timers": {"training_iteration_time_ms": 66768.053, "restore_workers_time_ms": 0.014, "training_step_time_ms": 66768.005, "sample_time_ms": 2264.786, "learn_time_ms": 64484.205, "learn_throughput": 62.031, "synch_weights_time_ms": 15.613}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "done": false, "training_iteration": 75, "trial_id": "62684_00000", "date": "2024-08-20_17-34-13", "timestamp": 1724155453, "time_this_iter_s": 61.628230810165405, "time_total_s": 5182.4434242248535, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3acba1310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5182.4434242248535, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 29.49770114942529, "ram_util_percent": 83.31264367816092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.489348823381654, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.64843450252046, "policy_loss": -0.01716021244537584, "vf_loss": 7.662869843185371, "vf_explained_var": 0.317265303887374, "kl": 0.013624331397367708, "entropy": 0.7781425022698464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 212910.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.634998717194511, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.80365183063285, "policy_loss": -0.02777443694680062, "vf_loss": 8.828348891697233, "vf_explained_var": -0.4987349193247538, "kl": 0.015386800179947858, "entropy": 0.5070605556800882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 578.0411201581885, "episode_reward_min": 22.00082780179506, "episode_reward_mean": 214.64843826278357, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -605.388786232089, "predator_policy": 67.4253169500919}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 560.0686525919806}, "policy_reward_mean": {"prey_policy": -126.2514433380276, "predator_policy": 296.7013841384333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [228.2978054521489, 163.1999999999996, 182.4539696034487, 149.31341115105488, 226.93991894324023, 93.8630410873135, 256.2215461171333, 344.91099520825315, 249.4130241518358, 22.00082780179506, 305.87309452909693, 139.70221874469254, 241.89453337195363, 175.7480380999682, 346.31532943078344, 322.12120880685745, 223.67141014048656, 386.7897549212741, 247.49164661184568, 100.62232172223281, 204.01759275553317, 90.19464413643162, 346.6195011759353, 229.7616963808766, 160.71555834544208, 178.556330699957, 31.718854661155437, 221.02227132685744, 126.79284922614795, 578.0411201581885, 302.4767749543399, 194.7965060813859, 119.79311950480941, 64.51328251212547, 175.78283270699788, 26.336804789229568, 221.64595172697497, 232.75515941171008, 442.53339117359326, 218.38198840914592, 266.1796202316339, 146.64443018850562, 184.7034522807982, 242.7652133833079, 255.47895313212715, 52.2742419748239, 207.85747869758424, 232.1551733566721, 505.4977135048466, 323.38799829275854, 105.4396252922918, 117.48902229362912, 226.08330281497177, 355.0732374144421, 284.4730805098745, 288.6036041597769, 367.41931321882925, 357.73313849208273, 267.79596173017916, 130.11511633505614, 226.22432968084541, 322.25869622883573, 123.14929485315412, 412.42135292401406, 308.27479404525496, 39.40815233401085, 146.69112043151952, 241.5879059023656, 226.31774896220242, 443.34661378030296, 214.48817966848281, 260.21340444490585, 178.2585042786454, 182.3706733823465, 103.57064433796515, 167.74482956377886, 298.07840911537215, 41.39044394574714, 98.43094205090753, 226.01486752917037, 125.6971891841062, 124.89917337129354, 87.82698727476719, 64.93428838984636, 76.61532148480947, 161.93845798896106, 188.0426703865825, 211.759548302903, 165.6418896116156, 182.12224237171236, 158.66971882292407, 161.9441434440066, 193.0417811349299, 261.4330171109046, 149.69692722772456, 174.00328271597056, 400.4035168596845, 297.2708786975843, 437.38422576563755, 90.80765533612312], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-155.76411994787748, 89.56824874085427, -350.7996666122326, -29.831007822137583, -186.10416286569443, -52.383587076326066, -7.18462274792752, -63.88755298087277, -439.1319052057033, -109.88742342982374, -139.68731006521423, -79.21494956816986, -294.4908146776187, -215.10707251914795, 31.868001110706345, -112.63701096970408, -331.04610599190494, -141.73257582189171, -45.329663807613755, -259.2766116209185, 149.49932878855248, -12.526182611907785, 153.20909314721547, -378.08268067740863, 95.51142077521351, -19.641054905573448, -228.33237991636008, -98.14557128144033, -326.74455177917713, -246.97307012299618, -265.8154849607251, -67.16841498286617, 46.171294873002964, -32.436978873422106, -44.32408943638497, -400.7210064180496, 1.3641532236034735, -6.1980726256731415, -430.06589734345744, -267.84472427561144, -420.1365004986756, 15.163756248939961, -37.47538785994237, 185.6, -409.17529874445006, -216.28163370961644, -295.37039925051704, 164.90897643909807, -321.9246400392828, -198.12872068512573, 197.97141014048705, -605.388786232089, 150.63472313251242, -12.563809428924896, -28.100956199464292, 22.058330727203227, -354.37392698353943, -204.15905586639857, -273.5721889842311, 98.63537814749249, 97.63001300266376, -232.4845895700271, -211.72600621931414, -309.7516490758127, 31.814277688011828, -283.15302953460497, 181.86471871095384, -59.60256183618296, -267.7404125582943, -176.5174688988505, 198.2, -295.6547308909767, 27.8422575561479, -177.94326868766223, -287.2250034378274, -349.4696212069467, -73.26041046051294, 44.32208431349487, 20.000000000000014, -244.6541621626519, -387.27695324430124, -209.5762803028061, 45.34081281940147, -64.73077069806466, -191.02458119934914, 64.9703767504727, -324.4480276440871, 168.5, -475.42353720453895, 192.52521094854222, -118.4924462145617, -88.42371597711137, 11.525142029178813, 27.29894189205602, -154.6837817265879, -177.76469565389408, -37.12787769160419, -149.23628254312058, -117.99512172568194, -34.40421136601826, -324.8999081868405, -279.6595253198597, -212.5647972716152, 67.6676798150782, -236.755588758642, -348.8597714135104, -248.35016486630997, -53.91084335556864, 121.01331342010344, -304.5613709236701, -314.0237265107602, -183.47075356033918, 151.64336655210877, -332.6311924589262, -361.14939532303, -11.345602635824164, 177.50743181819587, -101.39661172748873, -138.4114143747848, -61.397654105385506, -173.38710204123547, -341.3402244375049, 141.27691584874339, -331.8916490734976, -22.462200562947086, -19.530259061008266, 82.72558819426443, -447.60413468695, -125.69889136512747, -200.42670137575277, 179.55728988997316, -352.3174524469719, 24.165264418070436, -143.22383809949451, -207.35988978195036, -268.7586385528481, -519.7141057260046, 76.81885481840229, -165.78030277868422, 136.77250417289503, -322.0578834889276, -433.1534601556312, -12.231450661320462, -14.350872627957507, 184.69789654825937, 69.70564794184779, -380.31635330993925, 20.000000000000014, -390.02502451345197, 150.85946558480245, -431.08774045643617, 31.94271823550384, -326.8543885212897, -10.233657408305074, -419.46881454536356, -106.75457120093807, 179.88330281497215, -354.58259851392904, -244.79677219637648, 94.19881075650136, -36.83261358640196, -385.3047730826584, -234.59060799295162, -179.31830441796444, 29.98939526213857, -235.23180929619852, 83.05260544655103, -153.343328677209, 181.92291550124241, -138.5445427284967, 9.816413128370119, 179.69232589800455, -114.71738989286467, -602.8228807218497, -113.59860248802326, -377.6122953253298, 119.917409020624, -136.8767171505995, -166.101133788763, -128.57312476328994, -169.4353451359837, -164.97052188089967, 146.89999999999998, -247.12876376103958, -25.37792339152621, 113.88366888700324, -68.69127378874269, -205.7167479371031, -260.11000224807333, 172.756810800985, -22.700239951441517, -350.63333850191964, -438.39469585828635, 156.78218534267296, -108.84943479952645, -283.91039955060126, -254.5199213104436, -143.0125106098352, -136.57348645865238, -12.68329033857232, -101.05949390471369, -116.57170380050407, -296.09501983115484, 125.23738090125275, 22.784205121406284, -130.76546433339016, -172.53191753271852, -259.7809196746442, -154.54948919763245, 188.19516619723709, 36.671037402600334, -145.9923524417558, -24.05232615334107, -274.186514717698, -389.772178086085, 200.0, -197.3991067386585, -174.34383174535188, 34.39435476496797, -103.76198630600004, -202.36175770553507, 36.99826071341991, -59.54853907178587, -225.37848227999234, -148.00438727344064, -147.22460146347905, 47.12437514383084, -253.13868336004077, -371.26401562529895, 138.53250917434556, 22.86096013502307, -270.4261111573161, -77.34861619972729, -70.58122223021088, -5.652747817336319, -241.0836149023182, -174.6636295523856, 52.699370198357855, -230.98361479950952, -107.65998156597321, -260.2523795336529, -267.7568727924218, 9.882505424380103, 82.60345470927251, -216.95141097760373, -257.3839389013132, 35.51808934675918, -311.8858409221582, -294.7418038609905, -180.4732592666865, -173.4140313606632, -228.84419229769733, -356.23657972153654, -116.41295977646016, -193.09147655751593, 88.15724120759378, -310.36695087686206, -194.7322568227327, 4.818362913559536, -162.40465020529734, -96.69362399578995, -14.782359763726006, -14.433213111395848, -218.13056292830717, -294.735638392654, -102.99088238158821, -26.72964680983493, -25.695475275373767, -193.96497627357002, -37.915538590706646, -396.22887046435363, 59.097664963976364, -6.007327762054423, -444.2980205818614, -435.50814323672887, 156.68132592054621, 157.7, -366.10349458182804, -405.8597468705202, -142.8000739444539, -24.664652008433293, -82.34227583174008, -367.01593561405986, 84.99242638146079, -121.88636051382939, -354.7270074611666, -133.42470587993182, -20.348272271818047, -355.1017533541016, -32.98934809659193, 158.224161636479, -27.669625155765594, 142.80643445336625, -259.5814486441115, -306.868065449379, 14.957794296140127, 48.05845510925316, -305.97280828380394, -287.84262065065536, 20.799262648224083], "policy_predator_policy_reward": [357.4544799030621, 287.8388633683424, 164.7237193062998, 266.79503845785746, 437.9919074913539, 254.6661430465985, 215.73884331491377, 262.3642508993468, 313.9125178373665, 390.7572871919338, 405.6441048503888, 273.634629020426, 191.102385930778, 220.22610682633587, 365.59883366488106, 216.711931685473, 242.9500299812828, 158.92500821727427, 340.9445517791783, 352.91946920623053, 328.6603325745711, 264.02536702511327, 403.12100641805, 214.0632870545006, 446.123837576645, 230.67051254083623, 420.7365004986757, 427.8290061266392, 415.6426059630849, 191.72341007209056, 368.7458107176941, 300.1184546101989, 325.0246400392828, 220.72872068512535, 560.0686525919806, 294.03897485779294, 322.3068695810255, 285.6013294866215, 276.3660443370689, 203.35214408830046, 260.0878340381004, 290.51034150411095, 338.93339598302623, 312.35164907581327, 186.3325363582504, 305.76522050120815, 216.45752269248658, 287.2763734782169, 302.04558070057044, 295.9959922142144, 208.59427454397772, 348.3700035099454, 365.25815638651613, 278.39181368159325, 334.33774966315883, 115.65075984516827, 344.7245617307164, 232.57051958839537, 397.8717530389907, 294.56769337519535, 179.8108601217466, 318.05693499508675, 270.5559506748738, 229.3900908949375, 264.1161189220955, 160.03628254312048, 370.2982007572182, 333.17872662762625, 277.93043528607654, 279.5051036361004, 349.3429897944742, 328.1145946301439, 369.17166657115524, 350.04606917014615, 251.05141063191428, 346.16232824695226, 310.0261995230688, 327.494757791183, 282.7805635220882, 236.8071050947168, 375.21544904477537, 264.4145818168558, 204.6936581214464, 315.83488076451334, 232.55666933462714, 442.72422080398513, 270.47967874519355, 345.472398570866, 293.71342728651854, 288.1839893089837, 476.9747130457445, 286.9534183895305, 232.97931448817218, 325.9438463041285, 314.0336351885799, 377.85732161300257, 317.2015894934, 314.2089328312783, 241.2227780396338, 301.33077918177315, 281.6886865127594, 549.7503495217545, 438.48541051639927, 215.460654931837, 286.2967721963761, 359.2825985139295, 303.81661578856875, 379.19519753843133, 323.3510210312755, 345.0415766273768, 321.73674669551536, 272.38938999111855, 134.1791352387813, 180.04539207893006, 448.4355267581138, 447.1455564506777, 364.3986412748766, 274.6908092480308, 346.1782701661918, 215.48782187151653, 239.4637895368996, 174.2664071608295, 231.30816934949058, 249.57354514490774, 364.045672531657, 293.6216462954171, 278.3791797112461, 334.61894086514303, 413.02929554730866, 285.70744381308583, 429.56219550671545, 291.2887882981749, 89.13186062697035, 307.87553050648796, 289.7131895151853, 239.30405911758655, 343.4024626894158, 163.42846301748867, 242.66291010167834, 426.8189463536647, 105.52180463390967, 242.34001622706973, 377.9982975132685, 346.1737997354209, 302.5364388432483, 213.07064915444045, 67.4253169500919, 384.07083973036924, 230.87116001837876, 305.63089294480477, 227.36199428469592, 293.6217449587718, 243.86337872895913, 264.08557670234256, 284.59520748758274, 175.15118604541928, 230.2934686948954, 289.5374656280518, 173.45998156597292, 338.49911213032254, 365.9150528508018, 277.90888323499917, 260.5350285090559, 256.0960400318818, 351.1547178400606, 307.78182487109586, 357.01873992339563, 290.64703139149634, 385.5197578187861, 356.83657972153657, 226.0242241712452, 352.85620030971774, 220.94896946300224, 221.37361221110828, 257.08334108121574, 202.0223430251165, 275.02163728412427, 315.07641991156817, 231.57329797656985, 208.12493453479289, 139.648702805112, 362.1595492802456, 448.70363224234, 436.36534909971044, 363.49719659297045, 443.8078259943085, 280.4775138960484, 230.7625049994841, 375.96385496219915, 177.6429420119546, 296.44337637079025, 386.0598919580965, 347.3227229110849, 282.9477337628136, 155.86858187071428, 285.8469361733812, 290.48798799398253, 390.74805381564084, 308.41194607979503, 355.4118755425636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.341676347261341, "mean_inference_ms": 5.313895622018806, "mean_action_processing_ms": 2.159308908828779, "mean_env_wait_ms": 13.993220120513596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048018693923950195, "StateBufferConnector_ms": 0.007005095481872559, "ViewRequirementAgentConnector_ms": 0.18156063556671143}, "num_episodes": 24, "episode_return_max": 578.0411201581885, "episode_return_min": 22.00082780179506, "episode_return_mean": 214.64843826278357, "episodes_this_iter": 24}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.00313045233345, "num_env_steps_trained_throughput_per_sec": 66.00313045233345, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 66870.912, "restore_workers_time_ms": 0.014, "training_step_time_ms": 66870.862, "sample_time_ms": 2261.873, "learn_time_ms": 64589.712, "learn_throughput": 61.929, "synch_weights_time_ms": 15.807}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 76, "trial_id": "62684_00000", "date": "2024-08-20_17-35-13", "timestamp": 1724155513, "time_this_iter_s": 60.64524483680725, "time_total_s": 5243.088669061661, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3acadf310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5243.088669061661, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 26.861176470588227, "ram_util_percent": 83.04470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.699732498750619, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.480707830232931, "policy_loss": -0.018455220215560883, "vf_loss": 7.496600956612445, "vf_explained_var": 0.38927376143475795, "kl": 0.012810458742983718, "entropy": 0.8162185581017893, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 215730.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.309761971456034, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.53665042983161, "policy_loss": -0.02530348368664149, "vf_loss": 8.559366495142537, "vf_explained_var": -0.30326946847653263, "kl": 0.012937107115796712, "entropy": 0.5357694439156345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1540000, "num_agent_steps_trained": 1540000}, "env_runners": {"episode_reward_max": 578.0411201581885, "episode_reward_min": -9.859602123211346, "episode_reward_mean": 215.1220839050277, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -605.388786232089, "predator_policy": 67.4253169500919}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 560.0686525919806}, "policy_reward_mean": {"prey_policy": -127.65251390815278, "predator_policy": 299.0398128147431}, "custom_metrics": {}, "hist_stats": {"episode_reward": [175.7480380999682, 346.31532943078344, 322.12120880685745, 223.67141014048656, 386.7897549212741, 247.49164661184568, 100.62232172223281, 204.01759275553317, 90.19464413643162, 346.6195011759353, 229.7616963808766, 160.71555834544208, 178.556330699957, 31.718854661155437, 221.02227132685744, 126.79284922614795, 578.0411201581885, 302.4767749543399, 194.7965060813859, 119.79311950480941, 64.51328251212547, 175.78283270699788, 26.336804789229568, 221.64595172697497, 232.75515941171008, 442.53339117359326, 218.38198840914592, 266.1796202316339, 146.64443018850562, 184.7034522807982, 242.7652133833079, 255.47895313212715, 52.2742419748239, 207.85747869758424, 232.1551733566721, 505.4977135048466, 323.38799829275854, 105.4396252922918, 117.48902229362912, 226.08330281497177, 355.0732374144421, 284.4730805098745, 288.6036041597769, 367.41931321882925, 357.73313849208273, 267.79596173017916, 130.11511633505614, 226.22432968084541, 322.25869622883573, 123.14929485315412, 412.42135292401406, 308.27479404525496, 39.40815233401085, 146.69112043151952, 241.5879059023656, 226.31774896220242, 443.34661378030296, 214.48817966848281, 260.21340444490585, 178.2585042786454, 182.3706733823465, 103.57064433796515, 167.74482956377886, 298.07840911537215, 41.39044394574714, 98.43094205090753, 226.01486752917037, 125.6971891841062, 124.89917337129354, 87.82698727476719, 64.93428838984636, 76.61532148480947, 161.93845798896106, 188.0426703865825, 211.759548302903, 165.6418896116156, 182.12224237171236, 158.66971882292407, 161.9441434440066, 193.0417811349299, 261.4330171109046, 149.69692722772456, 174.00328271597056, 400.4035168596845, 297.2708786975843, 437.38422576563755, 90.80765533612312, 108.7367236274906, 442.5423111706648, -9.859602123211346, 275.76123558513314, 168.40547582698386, 183.7894895540417, 188.81246177338048, -5.6092022003227875, 138.9704950975576, 228.34300966208872, 450.3362312363747, 260.1306778198773, 221.08964335631222], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-267.84472427561144, -420.1365004986756, 15.163756248939961, -37.47538785994237, 185.6, -409.17529874445006, -216.28163370961644, -295.37039925051704, 164.90897643909807, -321.9246400392828, -198.12872068512573, 197.97141014048705, -605.388786232089, 150.63472313251242, -12.563809428924896, -28.100956199464292, 22.058330727203227, -354.37392698353943, -204.15905586639857, -273.5721889842311, 98.63537814749249, 97.63001300266376, -232.4845895700271, -211.72600621931414, -309.7516490758127, 31.814277688011828, -283.15302953460497, 181.86471871095384, -59.60256183618296, -267.7404125582943, -176.5174688988505, 198.2, -295.6547308909767, 27.8422575561479, -177.94326868766223, -287.2250034378274, -349.4696212069467, -73.26041046051294, 44.32208431349487, 20.000000000000014, -244.6541621626519, -387.27695324430124, -209.5762803028061, 45.34081281940147, -64.73077069806466, -191.02458119934914, 64.9703767504727, -324.4480276440871, 168.5, -475.42353720453895, 192.52521094854222, -118.4924462145617, -88.42371597711137, 11.525142029178813, 27.29894189205602, -154.6837817265879, -177.76469565389408, -37.12787769160419, -149.23628254312058, -117.99512172568194, -34.40421136601826, -324.8999081868405, -279.6595253198597, -212.5647972716152, 67.6676798150782, -236.755588758642, -348.8597714135104, -248.35016486630997, -53.91084335556864, 121.01331342010344, -304.5613709236701, -314.0237265107602, -183.47075356033918, 151.64336655210877, -332.6311924589262, -361.14939532303, -11.345602635824164, 177.50743181819587, -101.39661172748873, -138.4114143747848, -61.397654105385506, -173.38710204123547, -341.3402244375049, 141.27691584874339, -331.8916490734976, -22.462200562947086, -19.530259061008266, 82.72558819426443, -447.60413468695, -125.69889136512747, -200.42670137575277, 179.55728988997316, -352.3174524469719, 24.165264418070436, -143.22383809949451, -207.35988978195036, -268.7586385528481, -519.7141057260046, 76.81885481840229, -165.78030277868422, 136.77250417289503, -322.0578834889276, -433.1534601556312, -12.231450661320462, -14.350872627957507, 184.69789654825937, 69.70564794184779, -380.31635330993925, 20.000000000000014, -390.02502451345197, 150.85946558480245, -431.08774045643617, 31.94271823550384, -326.8543885212897, -10.233657408305074, -419.46881454536356, -106.75457120093807, 179.88330281497215, -354.58259851392904, -244.79677219637648, 94.19881075650136, -36.83261358640196, -385.3047730826584, -234.59060799295162, -179.31830441796444, 29.98939526213857, -235.23180929619852, 83.05260544655103, -153.343328677209, 181.92291550124241, -138.5445427284967, 9.816413128370119, 179.69232589800455, -114.71738989286467, -602.8228807218497, -113.59860248802326, -377.6122953253298, 119.917409020624, -136.8767171505995, -166.101133788763, -128.57312476328994, -169.4353451359837, -164.97052188089967, 146.89999999999998, -247.12876376103958, -25.37792339152621, 113.88366888700324, -68.69127378874269, -205.7167479371031, -260.11000224807333, 172.756810800985, -22.700239951441517, -350.63333850191964, -438.39469585828635, 156.78218534267296, -108.84943479952645, -283.91039955060126, -254.5199213104436, -143.0125106098352, -136.57348645865238, -12.68329033857232, -101.05949390471369, -116.57170380050407, -296.09501983115484, 125.23738090125275, 22.784205121406284, -130.76546433339016, -172.53191753271852, -259.7809196746442, -154.54948919763245, 188.19516619723709, 36.671037402600334, -145.9923524417558, -24.05232615334107, -274.186514717698, -389.772178086085, 200.0, -197.3991067386585, -174.34383174535188, 34.39435476496797, -103.76198630600004, -202.36175770553507, 36.99826071341991, -59.54853907178587, -225.37848227999234, -148.00438727344064, -147.22460146347905, 47.12437514383084, -253.13868336004077, -371.26401562529895, 138.53250917434556, 22.86096013502307, -270.4261111573161, -77.34861619972729, -70.58122223021088, -5.652747817336319, -241.0836149023182, -174.6636295523856, 52.699370198357855, -230.98361479950952, -107.65998156597321, -260.2523795336529, -267.7568727924218, 9.882505424380103, 82.60345470927251, -216.95141097760373, -257.3839389013132, 35.51808934675918, -311.8858409221582, -294.7418038609905, -180.4732592666865, -173.4140313606632, -228.84419229769733, -356.23657972153654, -116.41295977646016, -193.09147655751593, 88.15724120759378, -310.36695087686206, -194.7322568227327, 4.818362913559536, -162.40465020529734, -96.69362399578995, -14.782359763726006, -14.433213111395848, -218.13056292830717, -294.735638392654, -102.99088238158821, -26.72964680983493, -25.695475275373767, -193.96497627357002, -37.915538590706646, -396.22887046435363, 59.097664963976364, -6.007327762054423, -444.2980205818614, -435.50814323672887, 156.68132592054621, 157.7, -366.10349458182804, -405.8597468705202, -142.8000739444539, -24.664652008433293, -82.34227583174008, -367.01593561405986, 84.99242638146079, -121.88636051382939, -354.7270074611666, -133.42470587993182, -20.348272271818047, -355.1017533541016, -32.98934809659193, 158.224161636479, -27.669625155765594, 142.80643445336625, -259.5814486441115, -306.868065449379, 14.957794296140127, 48.05845510925316, -305.97280828380394, -287.84262065065536, 20.799262648224083, 12.273415263064791, -215.07307714510014, -246.52724434850808, 61.36302298571398, -164.3703853106352, 163.75166150376458, -281.75986686161946, -113.16151060100934, -214.3619631176903, -178.4462948880988, -172.64756719809162, 4.423648331689545, -116.15364933961911, 53.03448882970324, -162.48285107339404, -268.4768644643143, -21.18299419732658, -244.76191380232888, -195.02956058284207, -123.2378224809713, -250.42233241228485, -172.88000823472387, -259.8638903711788, -211.3433194851208, -22.402561684546782, -325.1899235075273, -139.31296094319958, 127.64546005205214, -294.6586586283767, -249.42420490315592, -61.35675715629338, -326.51654859943744, 142.8288812892216, -298.9680945746407, -184.3175858353512, -4.557876894565088, -288.47867191702136, -361.05484774086256, 179.3], "policy_predator_policy_reward": [420.7365004986757, 427.8290061266392, 415.6426059630849, 191.72341007209056, 368.7458107176941, 300.1184546101989, 325.0246400392828, 220.72872068512535, 560.0686525919806, 294.03897485779294, 322.3068695810255, 285.6013294866215, 276.3660443370689, 203.35214408830046, 260.0878340381004, 290.51034150411095, 338.93339598302623, 312.35164907581327, 186.3325363582504, 305.76522050120815, 216.45752269248658, 287.2763734782169, 302.04558070057044, 295.9959922142144, 208.59427454397772, 348.3700035099454, 365.25815638651613, 278.39181368159325, 334.33774966315883, 115.65075984516827, 344.7245617307164, 232.57051958839537, 397.8717530389907, 294.56769337519535, 179.8108601217466, 318.05693499508675, 270.5559506748738, 229.3900908949375, 264.1161189220955, 160.03628254312048, 370.2982007572182, 333.17872662762625, 277.93043528607654, 279.5051036361004, 349.3429897944742, 328.1145946301439, 369.17166657115524, 350.04606917014615, 251.05141063191428, 346.16232824695226, 310.0261995230688, 327.494757791183, 282.7805635220882, 236.8071050947168, 375.21544904477537, 264.4145818168558, 204.6936581214464, 315.83488076451334, 232.55666933462714, 442.72422080398513, 270.47967874519355, 345.472398570866, 293.71342728651854, 288.1839893089837, 476.9747130457445, 286.9534183895305, 232.97931448817218, 325.9438463041285, 314.0336351885799, 377.85732161300257, 317.2015894934, 314.2089328312783, 241.2227780396338, 301.33077918177315, 281.6886865127594, 549.7503495217545, 438.48541051639927, 215.460654931837, 286.2967721963761, 359.2825985139295, 303.81661578856875, 379.19519753843133, 323.3510210312755, 345.0415766273768, 321.73674669551536, 272.38938999111855, 134.1791352387813, 180.04539207893006, 448.4355267581138, 447.1455564506777, 364.3986412748766, 274.6908092480308, 346.1782701661918, 215.48782187151653, 239.4637895368996, 174.2664071608295, 231.30816934949058, 249.57354514490774, 364.045672531657, 293.6216462954171, 278.3791797112461, 334.61894086514303, 413.02929554730866, 285.70744381308583, 429.56219550671545, 291.2887882981749, 89.13186062697035, 307.87553050648796, 289.7131895151853, 239.30405911758655, 343.4024626894158, 163.42846301748867, 242.66291010167834, 426.8189463536647, 105.52180463390967, 242.34001622706973, 377.9982975132685, 346.1737997354209, 302.5364388432483, 213.07064915444045, 67.4253169500919, 384.07083973036924, 230.87116001837876, 305.63089294480477, 227.36199428469592, 293.6217449587718, 243.86337872895913, 264.08557670234256, 284.59520748758274, 175.15118604541928, 230.2934686948954, 289.5374656280518, 173.45998156597292, 338.49911213032254, 365.9150528508018, 277.90888323499917, 260.5350285090559, 256.0960400318818, 351.1547178400606, 307.78182487109586, 357.01873992339563, 290.64703139149634, 385.5197578187861, 356.83657972153657, 226.0242241712452, 352.85620030971774, 220.94896946300224, 221.37361221110828, 257.08334108121574, 202.0223430251165, 275.02163728412427, 315.07641991156817, 231.57329797656985, 208.12493453479289, 139.648702805112, 362.1595492802456, 448.70363224234, 436.36534909971044, 363.49719659297045, 443.8078259943085, 280.4775138960484, 230.7625049994841, 375.96385496219915, 177.6429420119546, 296.44337637079025, 386.0598919580965, 347.3227229110849, 282.9477337628136, 155.86858187071428, 285.8469361733812, 290.48798799398253, 390.74805381564084, 308.41194607979503, 355.4118755425636, 252.36308882871296, 305.70054102932045, 208.52357298412417, 173.27443900769646, 261.67198582265956, 337.75175263444777, 225.27430700899546, 397.1571423306375, 178.4090953069238, 215.59839210337043, 347.35257691934993, 370.85868509866106, 356.79359502855095, 400.70858222092755, 255.89834093211454, 382.57967495858543, 350.56646968075586, 275.30947155207593, 298.813631802171, 345.9667813393991, 313.3810287633544, 381.9996269395284, 335.67756692317283, 412.2966682012617, 297.9195285140064, 393.40363450019174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.32810346682289, "mean_inference_ms": 5.290450317327669, "mean_action_processing_ms": 2.136131984908655, "mean_env_wait_ms": 13.9633199929982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004868626594543457, "StateBufferConnector_ms": 0.007054567337036133, "ViewRequirementAgentConnector_ms": 0.1806584596633911}, "num_episodes": 13, "episode_return_max": 578.0411201581885, "episode_return_min": -9.859602123211346, "episode_return_mean": 215.1220839050277, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1540000, "num_agent_steps_trained": 1540000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.32609536124377, "num_env_steps_trained_throughput_per_sec": 66.32609536124377, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1540000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1540000, "timers": {"training_iteration_time_ms": 66926.279, "restore_workers_time_ms": 0.014, "training_step_time_ms": 66926.229, "sample_time_ms": 2245.167, "learn_time_ms": 64661.342, "learn_throughput": 61.861, "synch_weights_time_ms": 15.966}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1540000, "num_agent_steps_trained": 1540000}, "done": false, "training_iteration": 77, "trial_id": "62684_00000", "date": "2024-08-20_17-36-14", "timestamp": 1724155574, "time_this_iter_s": 60.34712791442871, "time_total_s": 5303.4357969760895, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffb88b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5303.4357969760895, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 26.061627906976746, "ram_util_percent": 83.24767441860466}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.62235094351126, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.4843122303063145, "policy_loss": -0.019707812234661906, "vf_loss": 7.501545494329845, "vf_explained_var": 0.42021726232471196, "kl": 0.01237285018787911, "entropy": 0.8100302478734484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 218550.5, "diff_num_grad_updates_vs_sampler_policy": 1448.9800000000105}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.13214056769376, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.698364475542906, "policy_loss": -0.0246483342860032, "vf_loss": 8.720418987576924, "vf_explained_var": -0.4149119633215445, "kl": 0.012968993986212703, "entropy": 0.5019146955990917, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "env_runners": {"episode_reward_max": 505.4977135048466, "episode_reward_min": -9.859602123211346, "episode_reward_mean": 208.26563129244664, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -602.8228807218497, "predator_policy": 67.4253169500919}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 549.7503495217545}, "policy_reward_mean": {"prey_policy": -128.22842440727598, "predator_policy": 296.4754522571373}, "custom_metrics": {}, "hist_stats": {"episode_reward": [442.53339117359326, 218.38198840914592, 266.1796202316339, 146.64443018850562, 184.7034522807982, 242.7652133833079, 255.47895313212715, 52.2742419748239, 207.85747869758424, 232.1551733566721, 505.4977135048466, 323.38799829275854, 105.4396252922918, 117.48902229362912, 226.08330281497177, 355.0732374144421, 284.4730805098745, 288.6036041597769, 367.41931321882925, 357.73313849208273, 267.79596173017916, 130.11511633505614, 226.22432968084541, 322.25869622883573, 123.14929485315412, 412.42135292401406, 308.27479404525496, 39.40815233401085, 146.69112043151952, 241.5879059023656, 226.31774896220242, 443.34661378030296, 214.48817966848281, 260.21340444490585, 178.2585042786454, 182.3706733823465, 103.57064433796515, 167.74482956377886, 298.07840911537215, 41.39044394574714, 98.43094205090753, 226.01486752917037, 125.6971891841062, 124.89917337129354, 87.82698727476719, 64.93428838984636, 76.61532148480947, 161.93845798896106, 188.0426703865825, 211.759548302903, 165.6418896116156, 182.12224237171236, 158.66971882292407, 161.9441434440066, 193.0417811349299, 261.4330171109046, 149.69692722772456, 174.00328271597056, 400.4035168596845, 297.2708786975843, 437.38422576563755, 90.80765533612312, 108.7367236274906, 442.5423111706648, -9.859602123211346, 275.76123558513314, 168.40547582698386, 183.7894895540417, 188.81246177338048, -5.6092022003227875, 138.9704950975576, 228.34300966208872, 450.3362312363747, 260.1306778198773, 221.08964335631222, 249.50054027664623, 392.07345255619646, 239.02780734609127, 28.26121863143654, 130.76459355280466, 385.3705337613762, 292.39405687579534, 36.71035410499609, 170.02404165123778, 278.6180397747419, 116.70727507579576, 47.11099556417047, 101.19482145701282, 132.80683381324803, 83.2260527532662, 232.76701376268647, 66.44896953601472, 141.0120843284151, 389.22551335364585, 79.96131154901931, 102.80566379505194, 138.45938048587502, 344.92962294048465, 359.58748199617696, 83.66764008726103], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-361.14939532303, -11.345602635824164, 177.50743181819587, -101.39661172748873, -138.4114143747848, -61.397654105385506, -173.38710204123547, -341.3402244375049, 141.27691584874339, -331.8916490734976, -22.462200562947086, -19.530259061008266, 82.72558819426443, -447.60413468695, -125.69889136512747, -200.42670137575277, 179.55728988997316, -352.3174524469719, 24.165264418070436, -143.22383809949451, -207.35988978195036, -268.7586385528481, -519.7141057260046, 76.81885481840229, -165.78030277868422, 136.77250417289503, -322.0578834889276, -433.1534601556312, -12.231450661320462, -14.350872627957507, 184.69789654825937, 69.70564794184779, -380.31635330993925, 20.000000000000014, -390.02502451345197, 150.85946558480245, -431.08774045643617, 31.94271823550384, -326.8543885212897, -10.233657408305074, -419.46881454536356, -106.75457120093807, 179.88330281497215, -354.58259851392904, -244.79677219637648, 94.19881075650136, -36.83261358640196, -385.3047730826584, -234.59060799295162, -179.31830441796444, 29.98939526213857, -235.23180929619852, 83.05260544655103, -153.343328677209, 181.92291550124241, -138.5445427284967, 9.816413128370119, 179.69232589800455, -114.71738989286467, -602.8228807218497, -113.59860248802326, -377.6122953253298, 119.917409020624, -136.8767171505995, -166.101133788763, -128.57312476328994, -169.4353451359837, -164.97052188089967, 146.89999999999998, -247.12876376103958, -25.37792339152621, 113.88366888700324, -68.69127378874269, -205.7167479371031, -260.11000224807333, 172.756810800985, -22.700239951441517, -350.63333850191964, -438.39469585828635, 156.78218534267296, -108.84943479952645, -283.91039955060126, -254.5199213104436, -143.0125106098352, -136.57348645865238, -12.68329033857232, -101.05949390471369, -116.57170380050407, -296.09501983115484, 125.23738090125275, 22.784205121406284, -130.76546433339016, -172.53191753271852, -259.7809196746442, -154.54948919763245, 188.19516619723709, 36.671037402600334, -145.9923524417558, -24.05232615334107, -274.186514717698, -389.772178086085, 200.0, -197.3991067386585, -174.34383174535188, 34.39435476496797, -103.76198630600004, -202.36175770553507, 36.99826071341991, -59.54853907178587, -225.37848227999234, -148.00438727344064, -147.22460146347905, 47.12437514383084, -253.13868336004077, -371.26401562529895, 138.53250917434556, 22.86096013502307, -270.4261111573161, -77.34861619972729, -70.58122223021088, -5.652747817336319, -241.0836149023182, -174.6636295523856, 52.699370198357855, -230.98361479950952, -107.65998156597321, -260.2523795336529, -267.7568727924218, 9.882505424380103, 82.60345470927251, -216.95141097760373, -257.3839389013132, 35.51808934675918, -311.8858409221582, -294.7418038609905, -180.4732592666865, -173.4140313606632, -228.84419229769733, -356.23657972153654, -116.41295977646016, -193.09147655751593, 88.15724120759378, -310.36695087686206, -194.7322568227327, 4.818362913559536, -162.40465020529734, -96.69362399578995, -14.782359763726006, -14.433213111395848, -218.13056292830717, -294.735638392654, -102.99088238158821, -26.72964680983493, -25.695475275373767, -193.96497627357002, -37.915538590706646, -396.22887046435363, 59.097664963976364, -6.007327762054423, -444.2980205818614, -435.50814323672887, 156.68132592054621, 157.7, -366.10349458182804, -405.8597468705202, -142.8000739444539, -24.664652008433293, -82.34227583174008, -367.01593561405986, 84.99242638146079, -121.88636051382939, -354.7270074611666, -133.42470587993182, -20.348272271818047, -355.1017533541016, -32.98934809659193, 158.224161636479, -27.669625155765594, 142.80643445336625, -259.5814486441115, -306.868065449379, 14.957794296140127, 48.05845510925316, -305.97280828380394, -287.84262065065536, 20.799262648224083, 12.273415263064791, -215.07307714510014, -246.52724434850808, 61.36302298571398, -164.3703853106352, 163.75166150376458, -281.75986686161946, -113.16151060100934, -214.3619631176903, -178.4462948880988, -172.64756719809162, 4.423648331689545, -116.15364933961911, 53.03448882970324, -162.48285107339404, -268.4768644643143, -21.18299419732658, -244.76191380232888, -195.02956058284207, -123.2378224809713, -250.42233241228485, -172.88000823472387, -259.8638903711788, -211.3433194851208, -22.402561684546782, -325.1899235075273, -139.31296094319958, 127.64546005205214, -294.6586586283767, -249.42420490315592, -61.35675715629338, -326.51654859943744, 142.8288812892216, -298.9680945746407, -184.3175858353512, -4.557876894565088, -288.47867191702136, -361.05484774086256, 179.3, -190.2669125379184, -167.70833182757178, -12.271543222342876, -213.64809550414617, 158.0109183417522, -104.42530578221304, -98.7943419652345, -64.82801655372705, -1.8650382960456966, -32.8287374782377, -287.4646808486195, -344.1511702624705, -15.697589458072507, -100.22589158179181, -316.4884806364825, -366.6194243047367, 147.77474594756546, 60.86807653669447, -343.65396180140414, -247.9476327424348, 102.40317043248461, 15.110354104995766, -309.74334994961885, -233.8235573545764, -263.5704882478956, -246.63764101440935, 71.88076071193007, 186.95933983491818, -184.4262951270269, 20.000000000000014, 99.0525402022695, -381.3119164457917, -282.33799164747495, -302.5037464914388, -435.7089144576607, 41.71099556417038, -169.80270481388524, -43.16464161958257, -205.06570361099597, -305.2157728994377, 59.59999999999999, -340.05032451643274, 49.31230389347239, -323.7675716683272, -165.7289894822499, -185.38964397707494, -45.542843556884236, -85.27005275314501, -5.824635876691129, -235.6512602142277, -223.20335549822897, -73.95524340143123, -299.1588571187433, -47.60175965258721, 80.23519384890713, 127.35443215024353, -380.52600073637547, -154.33266381215452, -134.67970703541656, -61.39547639724689, -191.53414554361532, -43.87542681159234, -84.25633493105207, -47.1008889867794, -145.9825110551877, -180.65228932317544, -98.50484227772166, 194.51924911331656, -512.8979969972955, 65.31083719694375, -421.6903880898801, 9.60435614252261, -226.37995188506596, -122.53497320156502, -249.63850925710858], "policy_predator_policy_reward": [310.0261995230688, 327.494757791183, 282.7805635220882, 236.8071050947168, 375.21544904477537, 264.4145818168558, 204.6936581214464, 315.83488076451334, 232.55666933462714, 442.72422080398513, 270.47967874519355, 345.472398570866, 293.71342728651854, 288.1839893089837, 476.9747130457445, 286.9534183895305, 232.97931448817218, 325.9438463041285, 314.0336351885799, 377.85732161300257, 317.2015894934, 314.2089328312783, 241.2227780396338, 301.33077918177315, 281.6886865127594, 549.7503495217545, 438.48541051639927, 215.460654931837, 286.2967721963761, 359.2825985139295, 303.81661578856875, 379.19519753843133, 323.3510210312755, 345.0415766273768, 321.73674669551536, 272.38938999111855, 134.1791352387813, 180.04539207893006, 448.4355267581138, 447.1455564506777, 364.3986412748766, 274.6908092480308, 346.1782701661918, 215.48782187151653, 239.4637895368996, 174.2664071608295, 231.30816934949058, 249.57354514490774, 364.045672531657, 293.6216462954171, 278.3791797112461, 334.61894086514303, 413.02929554730866, 285.70744381308583, 429.56219550671545, 291.2887882981749, 89.13186062697035, 307.87553050648796, 289.7131895151853, 239.30405911758655, 343.4024626894158, 163.42846301748867, 242.66291010167834, 426.8189463536647, 105.52180463390967, 242.34001622706973, 377.9982975132685, 346.1737997354209, 302.5364388432483, 213.07064915444045, 67.4253169500919, 384.07083973036924, 230.87116001837876, 305.63089294480477, 227.36199428469592, 293.6217449587718, 243.86337872895913, 264.08557670234256, 284.59520748758274, 175.15118604541928, 230.2934686948954, 289.5374656280518, 173.45998156597292, 338.49911213032254, 365.9150528508018, 277.90888323499917, 260.5350285090559, 256.0960400318818, 351.1547178400606, 307.78182487109586, 357.01873992339563, 290.64703139149634, 385.5197578187861, 356.83657972153657, 226.0242241712452, 352.85620030971774, 220.94896946300224, 221.37361221110828, 257.08334108121574, 202.0223430251165, 275.02163728412427, 315.07641991156817, 231.57329797656985, 208.12493453479289, 139.648702805112, 362.1595492802456, 448.70363224234, 436.36534909971044, 363.49719659297045, 443.8078259943085, 280.4775138960484, 230.7625049994841, 375.96385496219915, 177.6429420119546, 296.44337637079025, 386.0598919580965, 347.3227229110849, 282.9477337628136, 155.86858187071428, 285.8469361733812, 290.48798799398253, 390.74805381564084, 308.41194607979503, 355.4118755425636, 252.36308882871296, 305.70054102932045, 208.52357298412417, 173.27443900769646, 261.67198582265956, 337.75175263444777, 225.27430700899546, 397.1571423306375, 178.4090953069238, 215.59839210337043, 347.35257691934993, 370.85868509866106, 356.79359502855095, 400.70858222092755, 255.89834093211454, 382.57967495858543, 350.56646968075586, 275.30947155207593, 298.813631802171, 345.9667813393991, 313.3810287633544, 381.9996269395284, 335.67756692317283, 412.2966682012617, 297.9195285140064, 393.40363450019174, 319.1495557189011, 300.59777214557835, 153.64134888058751, 398.49458662021493, 154.96608035924015, 249.54912380185812, 283.42013024689373, 409.2856769738712, 251.4744634724873, 311.7020917566644, 340.58904007658015, 202.75809550527285, 442.533294414433, 339.0591865727158, 239.22355735457637, 325.9433499496191, 327.0682818485039, 281.2831283531084, 91.80538726028502, 164.27960780656585, 292.7634781419791, 388.5411648248145, 436.00891445766075, 307.6037464914392, 219.43740989273695, 299.79046160873867, 342.66502221829285, 375.807909010826, 158.3442981203644, 365.06601189000725, 145.95300377841554, 403.01655027137497, 292.98429262172056, 238.143928503441, 194.00064128570133, 367.7273032154753, 210.54492398537528, 351.61696410549695, 203.69055351082616, 226.6786052830108, 216.57877250456175, 205.8927985767506, 218.26098252335814, 293.9340873276596, 478.04014686254357, 283.773066239641, 411.5199420049716, 294.8427347416179, 320.19124751069063, 362.0298269203104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.278397062708677, "mean_inference_ms": 5.273724077942306, "mean_action_processing_ms": 2.1471413634702894, "mean_env_wait_ms": 13.88751960067904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004737138748168945, "StateBufferConnector_ms": 0.006948947906494141, "ViewRequirementAgentConnector_ms": 0.14324688911437988}, "num_episodes": 25, "episode_return_max": 505.4977135048466, "episode_return_min": -9.859602123211346, "episode_return_mean": 208.26563129244664, "episodes_this_iter": 25}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.79048072459585, "num_env_steps_trained_throughput_per_sec": 66.79048072459585, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1560000, "timers": {"training_iteration_time_ms": 66939.291, "restore_workers_time_ms": 0.014, "training_step_time_ms": 66939.242, "sample_time_ms": 2234.129, "learn_time_ms": 64685.586, "learn_throughput": 61.838, "synch_weights_time_ms": 15.916}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "done": false, "training_iteration": 78, "trial_id": "62684_00000", "date": "2024-08-20_17-37-14", "timestamp": 1724155634, "time_this_iter_s": 59.912399768829346, "time_total_s": 5363.348196744919, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffb8160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5363.348196744919, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 24.189285714285717, "ram_util_percent": 82.82619047619049}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.428679244822645, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.423959605913636, "policy_loss": -0.016606869870507412, "vf_loss": 7.438058231739288, "vf_explained_var": 0.3588389553076832, "kl": 0.012541216938485596, "entropy": 0.7628897841517807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 221370.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.878110604626793, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.761028669498584, "policy_loss": -0.029138222797009995, "vf_loss": 8.787187260925455, "vf_explained_var": -0.5161260941671947, "kl": 0.014898205535959393, "entropy": 0.4944535422577429, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1580000, "num_agent_steps_trained": 1580000}, "env_runners": {"episode_reward_max": 623.7705769984901, "episode_reward_min": -9.859602123211346, "episode_reward_mean": 205.74262599624538, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -512.8979969972955, "predator_policy": 67.4253169500919}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 478.04014686254357}, "policy_reward_mean": {"prey_policy": -125.19263394476125, "predator_policy": 290.6602639152645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.11511633505614, 226.22432968084541, 322.25869622883573, 123.14929485315412, 412.42135292401406, 308.27479404525496, 39.40815233401085, 146.69112043151952, 241.5879059023656, 226.31774896220242, 443.34661378030296, 214.48817966848281, 260.21340444490585, 178.2585042786454, 182.3706733823465, 103.57064433796515, 167.74482956377886, 298.07840911537215, 41.39044394574714, 98.43094205090753, 226.01486752917037, 125.6971891841062, 124.89917337129354, 87.82698727476719, 64.93428838984636, 76.61532148480947, 161.93845798896106, 188.0426703865825, 211.759548302903, 165.6418896116156, 182.12224237171236, 158.66971882292407, 161.9441434440066, 193.0417811349299, 261.4330171109046, 149.69692722772456, 174.00328271597056, 400.4035168596845, 297.2708786975843, 437.38422576563755, 90.80765533612312, 108.7367236274906, 442.5423111706648, -9.859602123211346, 275.76123558513314, 168.40547582698386, 183.7894895540417, 188.81246177338048, -5.6092022003227875, 138.9704950975576, 228.34300966208872, 450.3362312363747, 260.1306778198773, 221.08964335631222, 249.50054027664623, 392.07345255619646, 239.02780734609127, 28.26121863143654, 130.76459355280466, 385.3705337613762, 292.39405687579534, 36.71035410499609, 170.02404165123778, 278.6180397747419, 116.70727507579576, 47.11099556417047, 101.19482145701282, 132.80683381324803, 83.2260527532662, 232.76701376268647, 66.44896953601472, 141.0120843284151, 389.22551335364585, 79.96131154901931, 102.80566379505194, 138.45938048587502, 344.92962294048465, 359.58748199617696, 83.66764008726103, 172.67354501779513, 134.58511083800653, 77.77538383322971, 201.83426402920082, 327.09986698485017, 309.6655910318172, 120.69681944832975, 232.38024667131708, 25.21589581688499, 270.6870948405076, 480.4227560351004, 456.5704264869229, 26.570361926649944, 279.0448327310804, 183.51364998344832, 220.44040549979184, 49.33411768345309, 187.4666359861816, 623.7705769984901, 446.91864107981417, 369.0031880088783], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-136.8767171505995, -166.101133788763, -128.57312476328994, -169.4353451359837, -164.97052188089967, 146.89999999999998, -247.12876376103958, -25.37792339152621, 113.88366888700324, -68.69127378874269, -205.7167479371031, -260.11000224807333, 172.756810800985, -22.700239951441517, -350.63333850191964, -438.39469585828635, 156.78218534267296, -108.84943479952645, -283.91039955060126, -254.5199213104436, -143.0125106098352, -136.57348645865238, -12.68329033857232, -101.05949390471369, -116.57170380050407, -296.09501983115484, 125.23738090125275, 22.784205121406284, -130.76546433339016, -172.53191753271852, -259.7809196746442, -154.54948919763245, 188.19516619723709, 36.671037402600334, -145.9923524417558, -24.05232615334107, -274.186514717698, -389.772178086085, 200.0, -197.3991067386585, -174.34383174535188, 34.39435476496797, -103.76198630600004, -202.36175770553507, 36.99826071341991, -59.54853907178587, -225.37848227999234, -148.00438727344064, -147.22460146347905, 47.12437514383084, -253.13868336004077, -371.26401562529895, 138.53250917434556, 22.86096013502307, -270.4261111573161, -77.34861619972729, -70.58122223021088, -5.652747817336319, -241.0836149023182, -174.6636295523856, 52.699370198357855, -230.98361479950952, -107.65998156597321, -260.2523795336529, -267.7568727924218, 9.882505424380103, 82.60345470927251, -216.95141097760373, -257.3839389013132, 35.51808934675918, -311.8858409221582, -294.7418038609905, -180.4732592666865, -173.4140313606632, -228.84419229769733, -356.23657972153654, -116.41295977646016, -193.09147655751593, 88.15724120759378, -310.36695087686206, -194.7322568227327, 4.818362913559536, -162.40465020529734, -96.69362399578995, -14.782359763726006, -14.433213111395848, -218.13056292830717, -294.735638392654, -102.99088238158821, -26.72964680983493, -25.695475275373767, -193.96497627357002, -37.915538590706646, -396.22887046435363, 59.097664963976364, -6.007327762054423, -444.2980205818614, -435.50814323672887, 156.68132592054621, 157.7, -366.10349458182804, -405.8597468705202, -142.8000739444539, -24.664652008433293, -82.34227583174008, -367.01593561405986, 84.99242638146079, -121.88636051382939, -354.7270074611666, -133.42470587993182, -20.348272271818047, -355.1017533541016, -32.98934809659193, 158.224161636479, -27.669625155765594, 142.80643445336625, -259.5814486441115, -306.868065449379, 14.957794296140127, 48.05845510925316, -305.97280828380394, -287.84262065065536, 20.799262648224083, 12.273415263064791, -215.07307714510014, -246.52724434850808, 61.36302298571398, -164.3703853106352, 163.75166150376458, -281.75986686161946, -113.16151060100934, -214.3619631176903, -178.4462948880988, -172.64756719809162, 4.423648331689545, -116.15364933961911, 53.03448882970324, -162.48285107339404, -268.4768644643143, -21.18299419732658, -244.76191380232888, -195.02956058284207, -123.2378224809713, -250.42233241228485, -172.88000823472387, -259.8638903711788, -211.3433194851208, -22.402561684546782, -325.1899235075273, -139.31296094319958, 127.64546005205214, -294.6586586283767, -249.42420490315592, -61.35675715629338, -326.51654859943744, 142.8288812892216, -298.9680945746407, -184.3175858353512, -4.557876894565088, -288.47867191702136, -361.05484774086256, 179.3, -190.2669125379184, -167.70833182757178, -12.271543222342876, -213.64809550414617, 158.0109183417522, -104.42530578221304, -98.7943419652345, -64.82801655372705, -1.8650382960456966, -32.8287374782377, -287.4646808486195, -344.1511702624705, -15.697589458072507, -100.22589158179181, -316.4884806364825, -366.6194243047367, 147.77474594756546, 60.86807653669447, -343.65396180140414, -247.9476327424348, 102.40317043248461, 15.110354104995766, -309.74334994961885, -233.8235573545764, -263.5704882478956, -246.63764101440935, 71.88076071193007, 186.95933983491818, -184.4262951270269, 20.000000000000014, 99.0525402022695, -381.3119164457917, -282.33799164747495, -302.5037464914388, -435.7089144576607, 41.71099556417038, -169.80270481388524, -43.16464161958257, -205.06570361099597, -305.2157728994377, 59.59999999999999, -340.05032451643274, 49.31230389347239, -323.7675716683272, -165.7289894822499, -185.38964397707494, -45.542843556884236, -85.27005275314501, -5.824635876691129, -235.6512602142277, -223.20335549822897, -73.95524340143123, -299.1588571187433, -47.60175965258721, 80.23519384890713, 127.35443215024353, -380.52600073637547, -154.33266381215452, -134.67970703541656, -61.39547639724689, -191.53414554361532, -43.87542681159234, -84.25633493105207, -47.1008889867794, -145.9825110551877, -180.65228932317544, -98.50484227772166, 194.51924911331656, -512.8979969972955, 65.31083719694375, -421.6903880898801, 9.60435614252261, -226.37995188506596, -122.53497320156502, -249.63850925710858, 95.7301775491259, -99.20809327529771, -213.9997816054321, 41.729027415162896, -453.53960376864075, -138.06725459297255, -235.77379875291265, -157.84400478336113, 56.275086000943475, -137.47431676031388, -168.6138572007724, 92.12833756596848, 13.194186957699493, -41.96710245078316, -122.03398037808925, 174.87060014065645, -310.22000407204905, -184.5536213336813, -294.4978529870235, -246.78127037516572, 127.09999999999967, -218.28572528946393, -484.7323642864437, 90.75840360731382, -238.82071767357277, -81.39645947583439, -237.7193686902665, 139.08812133642007, -382.9714772827571, -76.35791971047084, 188.47069860481162, -398.36784093739954, 11.352006402625223, 85.41509635517491, 32.12997214466962, -212.1697312990791, -357.7062563455499, -3.095242597085926, -193.86827279261544, -463.8728220803374, 35.13349519414468, 80.11874721369094, -187.6052591498874, -144.19609982497815, -238.97814670173042, -9.182328359581737, 111.38747791952699, -442.37889412926154, -188.81766406308023, -155.97217097598616, -234.79831237138848, -257.1268862133032, -5.067083263727991, -114.8624401995869, -383.4519428248203, 151.24133595249089, 196.52861537745304, 105.92201081984072, -387.3956810098569, 126.65729780758451, -221.19684199295173, 175.91370491539865, 48.03718268428591], "policy_predator_policy_reward": [346.1782701661918, 215.48782187151653, 239.4637895368996, 174.2664071608295, 231.30816934949058, 249.57354514490774, 364.045672531657, 293.6216462954171, 278.3791797112461, 334.61894086514303, 413.02929554730866, 285.70744381308583, 429.56219550671545, 291.2887882981749, 89.13186062697035, 307.87553050648796, 289.7131895151853, 239.30405911758655, 343.4024626894158, 163.42846301748867, 242.66291010167834, 426.8189463536647, 105.52180463390967, 242.34001622706973, 377.9982975132685, 346.1737997354209, 302.5364388432483, 213.07064915444045, 67.4253169500919, 384.07083973036924, 230.87116001837876, 305.63089294480477, 227.36199428469592, 293.6217449587718, 243.86337872895913, 264.08557670234256, 284.59520748758274, 175.15118604541928, 230.2934686948954, 289.5374656280518, 173.45998156597292, 338.49911213032254, 365.9150528508018, 277.90888323499917, 260.5350285090559, 256.0960400318818, 351.1547178400606, 307.78182487109586, 357.01873992339563, 290.64703139149634, 385.5197578187861, 356.83657972153657, 226.0242241712452, 352.85620030971774, 220.94896946300224, 221.37361221110828, 257.08334108121574, 202.0223430251165, 275.02163728412427, 315.07641991156817, 231.57329797656985, 208.12493453479289, 139.648702805112, 362.1595492802456, 448.70363224234, 436.36534909971044, 363.49719659297045, 443.8078259943085, 280.4775138960484, 230.7625049994841, 375.96385496219915, 177.6429420119546, 296.44337637079025, 386.0598919580965, 347.3227229110849, 282.9477337628136, 155.86858187071428, 285.8469361733812, 290.48798799398253, 390.74805381564084, 308.41194607979503, 355.4118755425636, 252.36308882871296, 305.70054102932045, 208.52357298412417, 173.27443900769646, 261.67198582265956, 337.75175263444777, 225.27430700899546, 397.1571423306375, 178.4090953069238, 215.59839210337043, 347.35257691934993, 370.85868509866106, 356.79359502855095, 400.70858222092755, 255.89834093211454, 382.57967495858543, 350.56646968075586, 275.30947155207593, 298.813631802171, 345.9667813393991, 313.3810287633544, 381.9996269395284, 335.67756692317283, 412.2966682012617, 297.9195285140064, 393.40363450019174, 319.1495557189011, 300.59777214557835, 153.64134888058751, 398.49458662021493, 154.96608035924015, 249.54912380185812, 283.42013024689373, 409.2856769738712, 251.4744634724873, 311.7020917566644, 340.58904007658015, 202.75809550527285, 442.533294414433, 339.0591865727158, 239.22355735457637, 325.9433499496191, 327.0682818485039, 281.2831283531084, 91.80538726028502, 164.27960780656585, 292.7634781419791, 388.5411648248145, 436.00891445766075, 307.6037464914392, 219.43740989273695, 299.79046160873867, 342.66502221829285, 375.807909010826, 158.3442981203644, 365.06601189000725, 145.95300377841554, 403.01655027137497, 292.98429262172056, 238.143928503441, 194.00064128570133, 367.7273032154753, 210.54492398537528, 351.61696410549695, 203.69055351082616, 226.6786052830108, 216.57877250456175, 205.8927985767506, 218.26098252335814, 293.9340873276596, 478.04014686254357, 283.773066239641, 411.5199420049716, 294.8427347416179, 320.19124751069063, 362.0298269203104, 320.2544529773016, 69.89678937209693, 453.53960376864075, 230.92333801581586, 101.45959538645755, 313.65850598210307, 221.27454916324444, 194.5195512610743, 200.80856587931913, 277.0981969767038, 234.69396717501593, 394.8746491218765, 269.34747179210586, 265.5284710184138, 406.1328719965814, 438.50706064333014, 342.0819040312417, 241.07053762531606, 255.48702043169274, 335.4413500656231, 376.22955999251474, 302.7383319725477, 347.13838900149153, 204.05670028466525, 217.7607095291337, 363.4794241327668, 425.20362078321244, 202.46179162037038, 335.5514579795482, 418.74169768049615, 432.42297350142513, 128.19117656768327, 243.5028334859669, 385.41943160794057, 360.3623402342275, 204.16070542857221, 312.73768795792637, 346.7148805354395, 358.3596121174452, 243.37540134479744, 90.76281731571386, 275.4863250864315]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.255531315889914, "mean_inference_ms": 5.238939145589186, "mean_action_processing_ms": 2.1201097412588417, "mean_env_wait_ms": 13.83727024644564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008507251739501953, "StateBufferConnector_ms": 0.004864096641540527, "ViewRequirementAgentConnector_ms": 0.12967443466186523}, "num_episodes": 21, "episode_return_max": 623.7705769984901, "episode_return_min": -9.859602123211346, "episode_return_mean": 205.74262599624538, "episodes_this_iter": 21}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1580000, "num_agent_steps_trained": 1580000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.78035673354918, "num_env_steps_trained_throughput_per_sec": 66.78035673354918, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1580000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1580000, "timers": {"training_iteration_time_ms": 66963.621, "restore_workers_time_ms": 0.014, "training_step_time_ms": 66963.572, "sample_time_ms": 2231.346, "learn_time_ms": 64713.399, "learn_throughput": 61.811, "synch_weights_time_ms": 15.773}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1580000, "num_agent_steps_trained": 1580000}, "done": false, "training_iteration": 79, "trial_id": "62684_00000", "date": "2024-08-20_17-38-14", "timestamp": 1724155694, "time_this_iter_s": 59.94998598098755, "time_total_s": 5423.298182725906, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ac0a5790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5423.298182725906, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 24.984705882352937, "ram_util_percent": 83.17529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.390850649488733, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.6679332876881805, "policy_loss": -0.021238756722337996, "vf_loss": 7.686669652681824, "vf_explained_var": 0.41612652977730363, "kl": 0.012512005524171503, "entropy": 0.7791825944438894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 224190.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.760530555878997, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.860528459498491, "policy_loss": -0.028416720572267733, "vf_loss": 8.885808130546852, "vf_explained_var": -0.3843953857661555, "kl": 0.015685199855989408, "entropy": 0.5293002903303772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 623.7705769984901, "episode_reward_min": -9.859602123211346, "episode_reward_mean": 210.52715678694958, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -512.8979969972955, "predator_policy": 69.89678937209693}, "policy_reward_max": {"prey_policy": 196.52861537745304, "predator_policy": 478.04014686254357}, "policy_reward_mean": {"prey_policy": -125.94196557067231, "predator_policy": 294.17652674948323}, "custom_metrics": {}, "hist_stats": {"episode_reward": [124.89917337129354, 87.82698727476719, 64.93428838984636, 76.61532148480947, 161.93845798896106, 188.0426703865825, 211.759548302903, 165.6418896116156, 182.12224237171236, 158.66971882292407, 161.9441434440066, 193.0417811349299, 261.4330171109046, 149.69692722772456, 174.00328271597056, 400.4035168596845, 297.2708786975843, 437.38422576563755, 90.80765533612312, 108.7367236274906, 442.5423111706648, -9.859602123211346, 275.76123558513314, 168.40547582698386, 183.7894895540417, 188.81246177338048, -5.6092022003227875, 138.9704950975576, 228.34300966208872, 450.3362312363747, 260.1306778198773, 221.08964335631222, 249.50054027664623, 392.07345255619646, 239.02780734609127, 28.26121863143654, 130.76459355280466, 385.3705337613762, 292.39405687579534, 36.71035410499609, 170.02404165123778, 278.6180397747419, 116.70727507579576, 47.11099556417047, 101.19482145701282, 132.80683381324803, 83.2260527532662, 232.76701376268647, 66.44896953601472, 141.0120843284151, 389.22551335364585, 79.96131154901931, 102.80566379505194, 138.45938048587502, 344.92962294048465, 359.58748199617696, 83.66764008726103, 172.67354501779513, 134.58511083800653, 77.77538383322971, 201.83426402920082, 327.09986698485017, 309.6655910318172, 120.69681944832975, 232.38024667131708, 25.21589581688499, 270.6870948405076, 480.4227560351004, 456.5704264869229, 26.570361926649944, 279.0448327310804, 183.51364998344832, 220.44040549979184, 49.33411768345309, 187.4666359861816, 623.7705769984901, 446.91864107981417, 369.0031880088783, 272.09295196145246, 347.2326602117413, 355.35448750333086, 240.46471107244685, 205.82467987392675, 123.94889458331913, 106.99753470980806, 112.29336398458535, 41.39429096358863, 409.58941198273, 259.78380211354687, 322.6807353685935, 149.5939598259057, 132.0750369074593, 213.2642638880485, 165.42319009189976, 479.67470395271454, 52.4567588896727, 308.420830638489, 186.44903397886569, 358.8226710505459, 150.66831849674048], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [82.60345470927251, -216.95141097760373, -257.3839389013132, 35.51808934675918, -311.8858409221582, -294.7418038609905, -180.4732592666865, -173.4140313606632, -228.84419229769733, -356.23657972153654, -116.41295977646016, -193.09147655751593, 88.15724120759378, -310.36695087686206, -194.7322568227327, 4.818362913559536, -162.40465020529734, -96.69362399578995, -14.782359763726006, -14.433213111395848, -218.13056292830717, -294.735638392654, -102.99088238158821, -26.72964680983493, -25.695475275373767, -193.96497627357002, -37.915538590706646, -396.22887046435363, 59.097664963976364, -6.007327762054423, -444.2980205818614, -435.50814323672887, 156.68132592054621, 157.7, -366.10349458182804, -405.8597468705202, -142.8000739444539, -24.664652008433293, -82.34227583174008, -367.01593561405986, 84.99242638146079, -121.88636051382939, -354.7270074611666, -133.42470587993182, -20.348272271818047, -355.1017533541016, -32.98934809659193, 158.224161636479, -27.669625155765594, 142.80643445336625, -259.5814486441115, -306.868065449379, 14.957794296140127, 48.05845510925316, -305.97280828380394, -287.84262065065536, 20.799262648224083, 12.273415263064791, -215.07307714510014, -246.52724434850808, 61.36302298571398, -164.3703853106352, 163.75166150376458, -281.75986686161946, -113.16151060100934, -214.3619631176903, -178.4462948880988, -172.64756719809162, 4.423648331689545, -116.15364933961911, 53.03448882970324, -162.48285107339404, -268.4768644643143, -21.18299419732658, -244.76191380232888, -195.02956058284207, -123.2378224809713, -250.42233241228485, -172.88000823472387, -259.8638903711788, -211.3433194851208, -22.402561684546782, -325.1899235075273, -139.31296094319958, 127.64546005205214, -294.6586586283767, -249.42420490315592, -61.35675715629338, -326.51654859943744, 142.8288812892216, -298.9680945746407, -184.3175858353512, -4.557876894565088, -288.47867191702136, -361.05484774086256, 179.3, -190.2669125379184, -167.70833182757178, -12.271543222342876, -213.64809550414617, 158.0109183417522, -104.42530578221304, -98.7943419652345, -64.82801655372705, -1.8650382960456966, -32.8287374782377, -287.4646808486195, -344.1511702624705, -15.697589458072507, -100.22589158179181, -316.4884806364825, -366.6194243047367, 147.77474594756546, 60.86807653669447, -343.65396180140414, -247.9476327424348, 102.40317043248461, 15.110354104995766, -309.74334994961885, -233.8235573545764, -263.5704882478956, -246.63764101440935, 71.88076071193007, 186.95933983491818, -184.4262951270269, 20.000000000000014, 99.0525402022695, -381.3119164457917, -282.33799164747495, -302.5037464914388, -435.7089144576607, 41.71099556417038, -169.80270481388524, -43.16464161958257, -205.06570361099597, -305.2157728994377, 59.59999999999999, -340.05032451643274, 49.31230389347239, -323.7675716683272, -165.7289894822499, -185.38964397707494, -45.542843556884236, -85.27005275314501, -5.824635876691129, -235.6512602142277, -223.20335549822897, -73.95524340143123, -299.1588571187433, -47.60175965258721, 80.23519384890713, 127.35443215024353, -380.52600073637547, -154.33266381215452, -134.67970703541656, -61.39547639724689, -191.53414554361532, -43.87542681159234, -84.25633493105207, -47.1008889867794, -145.9825110551877, -180.65228932317544, -98.50484227772166, 194.51924911331656, -512.8979969972955, 65.31083719694375, -421.6903880898801, 9.60435614252261, -226.37995188506596, -122.53497320156502, -249.63850925710858, 95.7301775491259, -99.20809327529771, -213.9997816054321, 41.729027415162896, -453.53960376864075, -138.06725459297255, -235.77379875291265, -157.84400478336113, 56.275086000943475, -137.47431676031388, -168.6138572007724, 92.12833756596848, 13.194186957699493, -41.96710245078316, -122.03398037808925, 174.87060014065645, -310.22000407204905, -184.5536213336813, -294.4978529870235, -246.78127037516572, 127.09999999999967, -218.28572528946393, -484.7323642864437, 90.75840360731382, -238.82071767357277, -81.39645947583439, -237.7193686902665, 139.08812133642007, -382.9714772827571, -76.35791971047084, 188.47069860481162, -398.36784093739954, 11.352006402625223, 85.41509635517491, 32.12997214466962, -212.1697312990791, -357.7062563455499, -3.095242597085926, -193.86827279261544, -463.8728220803374, 35.13349519414468, 80.11874721369094, -187.6052591498874, -144.19609982497815, -238.97814670173042, -9.182328359581737, 111.38747791952699, -442.37889412926154, -188.81766406308023, -155.97217097598616, -234.79831237138848, -257.1268862133032, -5.067083263727991, -114.8624401995869, -383.4519428248203, 151.24133595249089, 196.52861537745304, 105.92201081984072, -387.3956810098569, 126.65729780758451, -221.19684199295173, 175.91370491539865, 48.03718268428591, 111.02194450411234, -51.35301246598854, -356.3689005277752, 59.0397840259603, -120.12449023559645, 3.1447941052483017, -98.06880543091006, -169.4088120237841, 166.5500050526456, 92.05987265088203, -331.18027555984924, -53.72505804915167, -120.60069220996604, -134.15997976340267, -31.117491475757056, 16.562522821339016, -359.963926424108, -298.70501819116913, -172.34093773541068, -61.51676426669712, 41.30299567675739, -131.04312801358748, -236.18791200202156, -117.04268703142672, -22.54351962701967, -154.99797030414427, -283.3653516874579, -421.1746851579329, -185.01834493034744, 182.09787674666677, -31.8577928153043, -128.92423805195844, -115.7437004547037, -238.99221999751407, 20.000000000000014, 168.27531980828155, -3.6542580969028933, -238.5531668381834, -135.19591653871896, -168.71538383366516, -290.0951699702822, 56.90000000000019, -312.5713060487169, -17.181491782064032, 22.59621631977509, 152.7730586462819, -422.0957648407241, -324.8258159333925, 93.80000000000017, 179.7372670504974, -417.5817471968982, -33.51909602735791, -243.650752226393, -295.0139728336625, -239.0791864984087, 112.6337249393649, -294.22312309110725, -412.1931017023376, -315.24883365093297, 150.0350809166788, 52.19587034204357, -345.53636742779526, 99.79765063316711, -256.66199376528164, -392.3650686126073, 105.4161165235168], "policy_predator_policy_reward": [260.5350285090559, 256.0960400318818, 351.1547178400606, 307.78182487109586, 357.01873992339563, 290.64703139149634, 385.5197578187861, 356.83657972153657, 226.0242241712452, 352.85620030971774, 220.94896946300224, 221.37361221110828, 257.08334108121574, 202.0223430251165, 275.02163728412427, 315.07641991156817, 231.57329797656985, 208.12493453479289, 139.648702805112, 362.1595492802456, 448.70363224234, 436.36534909971044, 363.49719659297045, 443.8078259943085, 280.4775138960484, 230.7625049994841, 375.96385496219915, 177.6429420119546, 296.44337637079025, 386.0598919580965, 347.3227229110849, 282.9477337628136, 155.86858187071428, 285.8469361733812, 290.48798799398253, 390.74805381564084, 308.41194607979503, 355.4118755425636, 252.36308882871296, 305.70054102932045, 208.52357298412417, 173.27443900769646, 261.67198582265956, 337.75175263444777, 225.27430700899546, 397.1571423306375, 178.4090953069238, 215.59839210337043, 347.35257691934993, 370.85868509866106, 356.79359502855095, 400.70858222092755, 255.89834093211454, 382.57967495858543, 350.56646968075586, 275.30947155207593, 298.813631802171, 345.9667813393991, 313.3810287633544, 381.9996269395284, 335.67756692317283, 412.2966682012617, 297.9195285140064, 393.40363450019174, 319.1495557189011, 300.59777214557835, 153.64134888058751, 398.49458662021493, 154.96608035924015, 249.54912380185812, 283.42013024689373, 409.2856769738712, 251.4744634724873, 311.7020917566644, 340.58904007658015, 202.75809550527285, 442.533294414433, 339.0591865727158, 239.22355735457637, 325.9433499496191, 327.0682818485039, 281.2831283531084, 91.80538726028502, 164.27960780656585, 292.7634781419791, 388.5411648248145, 436.00891445766075, 307.6037464914392, 219.43740989273695, 299.79046160873867, 342.66502221829285, 375.807909010826, 158.3442981203644, 365.06601189000725, 145.95300377841554, 403.01655027137497, 292.98429262172056, 238.143928503441, 194.00064128570133, 367.7273032154753, 210.54492398537528, 351.61696410549695, 203.69055351082616, 226.6786052830108, 216.57877250456175, 205.8927985767506, 218.26098252335814, 293.9340873276596, 478.04014686254357, 283.773066239641, 411.5199420049716, 294.8427347416179, 320.19124751069063, 362.0298269203104, 320.2544529773016, 69.89678937209693, 453.53960376864075, 230.92333801581586, 101.45959538645755, 313.65850598210307, 221.27454916324444, 194.5195512610743, 200.80856587931913, 277.0981969767038, 234.69396717501593, 394.8746491218765, 269.34747179210586, 265.5284710184138, 406.1328719965814, 438.50706064333014, 342.0819040312417, 241.07053762531606, 255.48702043169274, 335.4413500656231, 376.22955999251474, 302.7383319725477, 347.13838900149153, 204.05670028466525, 217.7607095291337, 363.4794241327668, 425.20362078321244, 202.46179162037038, 335.5514579795482, 418.74169768049615, 432.42297350142513, 128.19117656768327, 243.5028334859669, 385.41943160794057, 360.3623402342275, 204.16070542857221, 312.73768795792637, 346.7148805354395, 358.3596121174452, 243.37540134479744, 90.76281731571386, 275.4863250864315, 255.8756083571192, 312.91731209398563, 247.74235695572617, 157.43021536040277, 193.47916669953855, 262.80293320584167, 319.1303118162454, 214.17986021432023, 225.61871798550456, 266.08412533754887, 360.85321243789133, 405.20210393936566, 107.0552917095711, 192.49694932558862, 357.42687168604857, 239.14021934557266, 285.0310139450117, 217.27011863719866, 381.3282420542973, 452.3563232700465, 229.0171056588848, 307.2924277766288, 243.81637508257214, 129.58126047525326, 298.22707074071656, 228.7702305589941, 226.53765405603878, 307.4479366553698, 218.94767010150255, 301.47317529755173, 338.853441305018, 420.7182709147174, 353.4609725291623, 270.25821156995295, 296.9695801571489, 327.6709998199373, 320.15195113566983, 408.9374641529706, 330.670643953691, 433.1852444617662, 269.41677098572876, 282.94874651740133, 371.9060270422726, 322.3732373088398]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.238064116656131, "mean_inference_ms": 5.230168562071607, "mean_action_processing_ms": 2.088640863008517, "mean_env_wait_ms": 13.797362864008878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008063554763793945, "StateBufferConnector_ms": 0.005246520042419434, "ViewRequirementAgentConnector_ms": 0.11986732482910156}, "num_episodes": 22, "episode_return_max": 623.7705769984901, "episode_return_min": -9.859602123211346, "episode_return_mean": 210.52715678694958, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.27404354073153, "num_env_steps_trained_throughput_per_sec": 66.27404354073153, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 66984.53, "restore_workers_time_ms": 0.015, "training_step_time_ms": 66984.481, "sample_time_ms": 2239.76, "learn_time_ms": 64725.849, "learn_throughput": 61.799, "synch_weights_time_ms": 15.753}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 80, "trial_id": "62684_00000", "date": "2024-08-20_17-39-14", "timestamp": 1724155754, "time_this_iter_s": 60.391639947891235, "time_total_s": 5483.689822673798, "pid": 81446, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 4, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3acbbbc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5483.689822673798, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 25.212941176470586, "ram_util_percent": 83.02235294117646}}
