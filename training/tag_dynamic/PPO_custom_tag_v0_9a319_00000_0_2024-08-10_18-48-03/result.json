{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.765675874804774, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.767925955386872, "policy_loss": -0.004293486841290476, "vf_loss": 6.770790564591158, "vf_explained_var": 0.006384242574373881, "kl": 0.007144332221950102, "entropy": 1.6022201449313063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 1410.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.564096658769995, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.20784907117486, "policy_loss": -0.013189130304575277, "vf_loss": 5.217803330967824, "vf_explained_var": -0.0036308847988645236, "kl": 0.016174298924596542, "entropy": 1.5931581359356641, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 25.19258892299178, "episode_reward_min": -26.694987482900927, "episode_reward_mean": 6.607834746362495, "episode_len_mean": 325.2, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 3252, "policy_reward_min": {"prey_policy": -12.59629446149588, "predator_policy": -22.98567782717149}, "policy_reward_max": {"prey_policy": 13.347493741450467, "predator_policy": 25.09291313248358}, "policy_reward_mean": {"prey_policy": -3.3039173731812452, "predator_policy": 3.303917373181248}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.399067801846464, 25.19258892299178, 2.81361424521326, -26.694987482900927, 7.541850631181996, 13.763506021302002, 20.055257425936666, 21.845488106416607, 9.29573822725704, 11.664359168073004], "episode_lengths": [400, 400, 400, 400, 400, 400, 271, 85, 400, 96], "policy_prey_policy_reward": [9.699533900923235, -12.59629446149588, -1.4068071226066277, 13.347493741450467, -3.7709253155909943, -6.881753010651001, -10.027628712968326, -10.9227440532083, -4.6478691136285235, -5.832179584036503], "policy_predator_policy_reward": [-12.384188832108844, 1.8723479280387636, -18.586760798699636, -3.0354770430048283, 25.09291313248358, 15.731447295008952, 12.480009990794414, -2.4094422688296433, -5.85014635414489, -6.063146823895341, -22.98567782717149, -10.993656573284579, 9.985604085604955, 4.593111068473387, -3.2659392073053617, 6.556168726004897, 8.198023030591358, 5.891067275356763, 8.067990221309186, 11.65870735755984, 10.356188560035989, 3.556640527940395, 11.300145573090074, 17.911446058594436, 2.803319496907072, 13.167729211756301, -2.027441367777808, 9.298926504823928, -4.929656591058002, 13.127268838343584]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7692949244638123, "mean_inference_ms": 1.7082230513922458, "mean_action_processing_ms": 0.3039192007357644, "mean_env_wait_ms": 1.2274817664322817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007004737854003906, "StateBufferConnector_ms": 0.004025697708129883, "ViewRequirementAgentConnector_ms": 0.12319326400756836}, "num_episodes": 10, "episode_return_max": 25.19258892299178, "episode_return_min": -26.694987482900927, "episode_return_mean": 6.607834746362495}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.2166762421433, "num_env_steps_trained_throughput_per_sec": 274.2166762421433, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 14587.012, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14586.968, "sample_time_ms": 1894.107, "learn_time_ms": 12675.571, "learn_throughput": 315.568, "synch_weights_time_ms": 14.379}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "9a319_00000", "date": "2024-08-10_18-48-28", "timestamp": 1723330108, "time_this_iter_s": 14.631853103637695, "time_total_s": 14.631853103637695, "pid": 68380, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 3, "grid_size": 50, "max_steps": 400, "screen_size": 600, "render_mode": "human"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3be851280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14.631853103637695, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 36.980952380952374, "ram_util_percent": 83.2904761904762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.411635731065527, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.191334323511056, "policy_loss": -0.004235794510880604, "vf_loss": 6.194082599666947, "vf_explained_var": 0.002156366693212631, "kl": 0.007437625662461806, "entropy": 1.587641099496936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 4230.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9236909340446195, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.315221936007341, "policy_loss": -0.013412103940693972, "vf_loss": 5.324987368534009, "vf_explained_var": 0.01934766781826814, "kl": 0.01823326865282782, "entropy": 1.5368911838779846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 25.19258892299178, "episode_reward_min": -35.306790498381964, "episode_reward_mean": 2.713027127253574, "episode_len_mean": 360.63157894736844, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 6852, "policy_reward_min": {"prey_policy": -12.59629446149588, "predator_policy": -36.43826202340203}, "policy_reward_max": {"prey_policy": 17.65339524919098, "predator_policy": 25.09291313248358}, "policy_reward_mean": {"prey_policy": -1.3565135636267867, "predator_policy": 1.3565135636267884}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.399067801846464, 25.19258892299178, 2.81361424521326, -26.694987482900927, 7.541850631181996, 13.763506021302002, 20.055257425936666, 21.845488106416607, 9.29573822725704, 11.664359168073004, -35.306790498381964, 14.212913505964641, 2.187960565163185, 6.5327498484682955, 15.091528812391044, -18.546224654586464, -0.8102276091124914, -5.818737415590853, 7.925995399877564], "episode_lengths": [400, 400, 400, 400, 400, 400, 271, 85, 400, 96, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [9.699533900923235, -12.59629446149588, -1.4068071226066277, 13.347493741450467, -3.7709253155909943, -6.881753010651001, -10.027628712968326, -10.9227440532083, -4.6478691136285235, -5.832179584036503, 17.65339524919098, -7.106456752982309, -1.093980282581596, -3.26637492423415, -7.545764406195533, 9.27311232729323, 0.4051138045562521, 2.9093687077954242, -3.9629976999387835], "policy_predator_policy_reward": [-12.384188832108844, 1.8723479280387636, -18.586760798699636, -3.0354770430048283, 25.09291313248358, 15.731447295008952, 12.480009990794414, -2.4094422688296433, -5.85014635414489, -6.063146823895341, -22.98567782717149, -10.993656573284579, 9.985604085604955, 4.593111068473387, -3.2659392073053617, 6.556168726004897, 8.198023030591358, 5.891067275356763, 8.067990221309186, 11.65870735755984, 10.356188560035989, 3.556640527940395, 11.300145573090074, 17.911446058594436, 2.803319496907072, 13.167729211756301, -2.027441367777808, 9.298926504823928, -4.929656591058002, 13.127268838343584, -14.80941699346409, -18.99619254205564, -19.154576212053207, 5.515910915820712, 19.6860277146767, -3.8825683715504837, 13.639265723735548, 3.7561504835136788, -14.11347535950443, 7.080450842023836, 3.596680164991639, -0.8780062343130197, 6.817754674684744, 2.367905686767461, 13.451632857134388, -36.43826202340203, 5.982046313893953, 2.636878727628389, 4.941815580256019, -1.6158412152691177, -4.541315778655623, -8.57002532848578, -6.761698317764029, 6.603617522863535, 13.01360611801206, -13.90845743480632, 12.783844416610606]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7719997110072824, "mean_inference_ms": 1.700614172969419, "mean_action_processing_ms": 0.30020308387283196, "mean_env_wait_ms": 1.1997766474609597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006925432305586965, "StateBufferConnector_ms": 0.003882458335474918, "ViewRequirementAgentConnector_ms": 0.14432856911107114}, "num_episodes": 9, "episode_return_max": 25.19258892299178, "episode_return_min": -35.306790498381964, "episode_return_mean": 2.713027127253574}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.741420938262, "num_env_steps_trained_throughput_per_sec": 282.741420938262, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 14367.111, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14367.072, "sample_time_ms": 1865.594, "learn_time_ms": 12483.838, "learn_throughput": 320.414, "synch_weights_time_ms": 15.823}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "9a319_00000", "date": "2024-08-10_18-48-44", "timestamp": 1723330124, "time_this_iter_s": 14.159837007522583, "time_total_s": 28.79169011116028, "pid": 68380, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 3, "grid_size": 50, "max_steps": 400, "screen_size": 600, "render_mode": "human"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3be8518b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28.79169011116028, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 33.11666666666667, "ram_util_percent": 82.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6760842754063032, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.120565344594049, "policy_loss": -0.005236821373365654, "vf_loss": 6.123589668375381, "vf_explained_var": 0.001603089135589329, "kl": 0.011062480388382825, "entropy": 1.5607102941959463, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 7050.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.438120731028418, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.949253398180008, "policy_loss": -0.01193461896473309, "vf_loss": 4.957769666115443, "vf_explained_var": 0.1403205110381047, "kl": 0.017091720454733814, "entropy": 1.4678162083029747, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 25.19258892299178, "episode_reward_min": -39.31369223077834, "episode_reward_mean": -0.17467440246583052, "episode_len_mean": 362.0, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 10860, "policy_reward_min": {"prey_policy": -12.59629446149588, "predator_policy": -36.43826202340203}, "policy_reward_max": {"prey_policy": 19.65684611538915, "predator_policy": 26.645650686231956}, "policy_reward_mean": {"prey_policy": 0.08733720123291491, "predator_policy": -0.08733720123291361}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.399067801846464, 25.19258892299178, 2.81361424521326, -26.694987482900927, 7.541850631181996, 13.763506021302002, 20.055257425936666, 21.845488106416607, 9.29573822725704, 11.664359168073004, -35.306790498381964, 14.212913505964641, 2.187960565163185, 6.5327498484682955, 15.091528812391044, -18.546224654586464, -0.8102276091124914, -5.818737415590853, 7.925995399877564, 17.14100625551274, -39.31369223077834, -2.779119793215589, -32.3899023210873, 6.402563461892105, -35.71463776227885, 0.1133768457359583, 8.049493560730827, 10.50931597089901, -10.029986204303945, 21.22383472510054], "episode_lengths": [400, 400, 400, 400, 400, 400, 271, 85, 400, 96, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [9.699533900923235, -12.59629446149588, -1.4068071226066277, 13.347493741450467, -3.7709253155909943, -6.881753010651001, -10.027628712968326, -10.9227440532083, -4.6478691136285235, -5.832179584036503, 17.65339524919098, -7.106456752982309, -1.093980282581596, -3.26637492423415, -7.545764406195533, 9.27311232729323, 0.4051138045562521, 2.9093687077954242, -3.9629976999387835, -8.570503127756359, 19.65684611538915, 1.3895598966077949, 16.194951160543646, -3.2012817309460595, 17.857318881139424, -0.05668842286797138, -4.024746780365412, -5.254657985449508, 5.014993102151976, -10.61191736255029], "policy_predator_policy_reward": [-12.384188832108844, 1.8723479280387636, -18.586760798699636, -3.0354770430048283, 25.09291313248358, 15.731447295008952, 12.480009990794414, -2.4094422688296433, -5.85014635414489, -6.063146823895341, -22.98567782717149, -10.993656573284579, 9.985604085604955, 4.593111068473387, -3.2659392073053617, 6.556168726004897, 8.198023030591358, 5.891067275356763, 8.067990221309186, 11.65870735755984, 10.356188560035989, 3.556640527940395, 11.300145573090074, 17.911446058594436, 2.803319496907072, 13.167729211756301, -2.027441367777808, 9.298926504823928, -4.929656591058002, 13.127268838343584, -14.80941699346409, -18.99619254205564, -19.154576212053207, 5.515910915820712, 19.6860277146767, -3.8825683715504837, 13.639265723735548, 3.7561504835136788, -14.11347535950443, 7.080450842023836, 3.596680164991639, -0.8780062343130197, 6.817754674684744, 2.367905686767461, 13.451632857134388, -36.43826202340203, 5.982046313893953, 2.636878727628389, 4.941815580256019, -1.6158412152691177, -4.541315778655623, -8.57002532848578, -6.761698317764029, 6.603617522863535, 13.01360611801206, -13.90845743480632, 12.783844416610606, 26.645650686231956, 12.46766658856059, -13.401807891523447, -15.196514931385561, -9.452308264129691, -34.321715150652174, -1.962017133954952, 3.297461304853302, -5.504123860721734, -17.398230266743084, -16.659022433561027, -14.527600781326818, -10.653405022826032, 9.295124755187201, 10.96212546047698, -27.634161432987415, -8.317277951962343, -17.62051725846851, -4.512816011489431, 12.06195349065612, -7.379072210562775, -2.5939733499474418, 18.714289880954585, -4.046076189910899, -8.805712441841884, 11.606317597845077, 12.963368800345318, -8.716226431246003, 5.1252637579431415, -11.454016633153067, 24.374121714532336, 13.429619175113444, -5.967988801994917]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7673952695305277, "mean_inference_ms": 1.6833876174553912, "mean_action_processing_ms": 0.297895720992332, "mean_env_wait_ms": 1.163618181180453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007978677749633789, "StateBufferConnector_ms": 0.004324913024902344, "ViewRequirementAgentConnector_ms": 0.13917088508605957}, "num_episodes": 11, "episode_return_max": 25.19258892299178, "episode_return_min": -39.31369223077834, "episode_return_mean": -0.17467440246583052}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.4990332244253, "num_env_steps_trained_throughput_per_sec": 292.4990332244253, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 14136.496, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14136.45, "sample_time_ms": 1786.203, "learn_time_ms": 12327.025, "learn_throughput": 324.49, "synch_weights_time_ms": 20.8}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "9a319_00000", "date": "2024-08-10_18-48-58", "timestamp": 1723330138, "time_this_iter_s": 13.6887788772583, "time_total_s": 42.48046898841858, "pid": 68380, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 3, "grid_size": 50, "max_steps": 400, "screen_size": 600, "render_mode": "human"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3be851940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 42.48046898841858, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 37.56315789473684, "ram_util_percent": 82.46315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0539928755227557, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.7584137155654584, "policy_loss": -0.0029494783019148314, "vf_loss": 6.760016790518524, "vf_explained_var": -0.024650488381690167, "kl": 0.006731990777184135, "entropy": 1.5685425659866197, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 9870.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.197887323796749, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.384979278345903, "policy_loss": -0.006302599683112931, "vf_loss": 5.3893072302142775, "vf_explained_var": 0.2338347042600314, "kl": 0.009873183746379521, "entropy": 1.431673306102554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 46.209218632182115, "episode_reward_min": -43.45695275475375, "episode_reward_mean": 0.4396072787686028, "episode_len_mean": 360.075, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 14403, "policy_reward_min": {"prey_policy": -23.104609316091068, "predator_policy": -36.43826202340203}, "policy_reward_max": {"prey_policy": 21.728476377376904, "predator_policy": 39.62213314342315}, "policy_reward_mean": {"prey_policy": -0.21980363938430134, "predator_policy": 0.219803639384302}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.399067801846464, 25.19258892299178, 2.81361424521326, -26.694987482900927, 7.541850631181996, 13.763506021302002, 20.055257425936666, 21.845488106416607, 9.29573822725704, 11.664359168073004, -35.306790498381964, 14.212913505964641, 2.187960565163185, 6.5327498484682955, 15.091528812391044, -18.546224654586464, -0.8102276091124914, -5.818737415590853, 7.925995399877564, 17.14100625551274, -39.31369223077834, -2.779119793215589, -32.3899023210873, 6.402563461892105, -35.71463776227885, 0.1133768457359583, 8.049493560730827, 10.50931597089901, -10.029986204303945, 21.22383472510054, 23.055213035148405, -43.45695275475375, -13.691132202830376, 46.209218632182115, 28.400691508781666, -21.758190342982044, 19.370877750091047, -24.41757454423179, 3.7561095180392927, 5.3562626252744625], "episode_lengths": [400, 400, 400, 400, 400, 400, 271, 85, 400, 96, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 307, 400, 36, 400], "policy_prey_policy_reward": [9.699533900923235, -12.59629446149588, -1.4068071226066277, 13.347493741450467, -3.7709253155909943, -6.881753010651001, -10.027628712968326, -10.9227440532083, -4.6478691136285235, -5.832179584036503, 17.65339524919098, -7.106456752982309, -1.093980282581596, -3.26637492423415, -7.545764406195533, 9.27311232729323, 0.4051138045562521, 2.9093687077954242, -3.9629976999387835, -8.570503127756359, 19.65684611538915, 1.3895598966077949, 16.194951160543646, -3.2012817309460595, 17.857318881139424, -0.05668842286797138, -4.024746780365412, -5.254657985449508, 5.014993102151976, -10.61191736255029, -11.527606517574213, 21.728476377376904, 6.845566101415193, -23.104609316091068, -14.200345754390845, 10.879095171491032, -9.685438875045532, 12.208787272115902, -1.8780547590196464, -2.678131312637231], "policy_predator_policy_reward": [-12.384188832108844, 1.8723479280387636, -18.586760798699636, -3.0354770430048283, 25.09291313248358, 15.731447295008952, 12.480009990794414, -2.4094422688296433, -5.85014635414489, -6.063146823895341, -22.98567782717149, -10.993656573284579, 9.985604085604955, 4.593111068473387, -3.2659392073053617, 6.556168726004897, 8.198023030591358, 5.891067275356763, 8.067990221309186, 11.65870735755984, 10.356188560035989, 3.556640527940395, 11.300145573090074, 17.911446058594436, 2.803319496907072, 13.167729211756301, -2.027441367777808, 9.298926504823928, -4.929656591058002, 13.127268838343584, -14.80941699346409, -18.99619254205564, -19.154576212053207, 5.515910915820712, 19.6860277146767, -3.8825683715504837, 13.639265723735548, 3.7561504835136788, -14.11347535950443, 7.080450842023836, 3.596680164991639, -0.8780062343130197, 6.817754674684744, 2.367905686767461, 13.451632857134388, -36.43826202340203, 5.982046313893953, 2.636878727628389, 4.941815580256019, -1.6158412152691177, -4.541315778655623, -8.57002532848578, -6.761698317764029, 6.603617522863535, 13.01360611801206, -13.90845743480632, 12.783844416610606, 26.645650686231956, 12.46766658856059, -13.401807891523447, -15.196514931385561, -9.452308264129691, -34.321715150652174, -1.962017133954952, 3.297461304853302, -5.504123860721734, -17.398230266743084, -16.659022433561027, -14.527600781326818, -10.653405022826032, 9.295124755187201, 10.96212546047698, -27.634161432987415, -8.317277951962343, -17.62051725846851, -4.512816011489431, 12.06195349065612, -7.379072210562775, -2.5939733499474418, 18.714289880954585, -4.046076189910899, -8.805712441841884, 11.606317597845077, 12.963368800345318, -8.716226431246003, 5.1252637579431415, -11.454016633153067, 24.374121714532336, 13.429619175113444, -5.967988801994917, -0.5155504024269568, 19.09791381108671, 16.000456144062838, -13.27899017829101, -15.890579221294026, -36.01585973254567, 9.701591607445344, -5.384086648571799, -24.854203263119096, 29.130292650736678, 0.5614021541133738, 39.62213314342315, -2.0874944821589914, 21.66134761336011, 23.027184131971392, -9.46983709526016, -10.740750122669088, -12.426698296543819, 4.214847331580154, 12.705013192116844, 12.13645610143958, -9.200400233441743, -7.133149767077963, -20.29281181582801, 1.1868559385655129, 1.6846108472191048, 2.762697491274322, -2.870217233821215, 8.3210274170903, 2.5835837546425893]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7645774576785265, "mean_inference_ms": 1.6805036653057663, "mean_action_processing_ms": 0.29634984265584224, "mean_env_wait_ms": 1.1484094517202024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007906556129455566, "StateBufferConnector_ms": 0.004809200763702393, "ViewRequirementAgentConnector_ms": 0.14291703701019287}, "num_episodes": 10, "episode_return_max": 46.209218632182115, "episode_return_min": -43.45695275475375, "episode_return_mean": 0.4396072787686028}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.39451077897013, "num_env_steps_trained_throughput_per_sec": 295.39451077897013, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13987.678, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13987.561, "sample_time_ms": 1801.829, "learn_time_ms": 12158.758, "learn_throughput": 328.981, "synch_weights_time_ms": 24.102}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "9a319_00000", "date": "2024-08-10_18-49-12", "timestamp": 1723330152, "time_this_iter_s": 13.581577062606812, "time_total_s": 56.06204605102539, "pid": 68380, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 3, "grid_size": 50, "max_steps": 400, "screen_size": 600, "render_mode": "human"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3be8515e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 56.06204605102539, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 42.515, "ram_util_percent": 82.405}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.336077122443111, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.306631117509612, "policy_loss": -0.004599736810575986, "vf_loss": 6.309133846201795, "vf_explained_var": -0.04977468047158938, "kl": 0.010485046319220797, "entropy": 1.5729647735331922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 12690.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0630822121786574, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.519331297030051, "policy_loss": -0.005014608382528725, "vf_loss": 4.522570114086071, "vf_explained_var": 0.1843482041110595, "kl": 0.008878933651326441, "entropy": 1.4093148016681274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 49.34714201553713, "episode_reward_min": -80.52126934817855, "episode_reward_mean": -3.6078026715906604, "episode_len_mean": 354.921568627451, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 18101, "policy_reward_min": {"prey_policy": -24.673571007768548, "predator_policy": -54.46701910139169}, "policy_reward_max": {"prey_policy": 40.260634674089225, "predator_policy": 39.62213314342315}, "policy_reward_mean": {"prey_policy": 1.803901335795334, "predator_policy": -1.8039013357953326}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.399067801846464, 25.19258892299178, 2.81361424521326, -26.694987482900927, 7.541850631181996, 13.763506021302002, 20.055257425936666, 21.845488106416607, 9.29573822725704, 11.664359168073004, -35.306790498381964, 14.212913505964641, 2.187960565163185, 6.5327498484682955, 15.091528812391044, -18.546224654586464, -0.8102276091124914, -5.818737415590853, 7.925995399877564, 17.14100625551274, -39.31369223077834, -2.779119793215589, -32.3899023210873, 6.402563461892105, -35.71463776227885, 0.1133768457359583, 8.049493560730827, 10.50931597089901, -10.029986204303945, 21.22383472510054, 23.055213035148405, -43.45695275475375, -13.691132202830376, 46.209218632182115, 28.400691508781666, -21.758190342982044, 19.370877750091047, -24.41757454423179, 3.7561095180392927, 5.3562626252744625, 49.34714201553713, -79.11587876154965, 11.839274036134336, -74.10841563444947, -23.86285809414266, 16.027522418696893, 15.143318260661523, 24.102348381300658, -69.0517439180392, 8.61833324216117, -80.52126934817855], "episode_lengths": [400, 400, 400, 400, 400, 400, 271, 85, 400, 96, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 307, 400, 36, 400, 400, 400, 400, 400, 400, 38, 60, 400, 400, 400, 400], "policy_prey_policy_reward": [9.699533900923235, -12.59629446149588, -1.4068071226066277, 13.347493741450467, -3.7709253155909943, -6.881753010651001, -10.027628712968326, -10.9227440532083, -4.6478691136285235, -5.832179584036503, 17.65339524919098, -7.106456752982309, -1.093980282581596, -3.26637492423415, -7.545764406195533, 9.27311232729323, 0.4051138045562521, 2.9093687077954242, -3.9629976999387835, -8.570503127756359, 19.65684611538915, 1.3895598966077949, 16.194951160543646, -3.2012817309460595, 17.857318881139424, -0.05668842286797138, -4.024746780365412, -5.254657985449508, 5.014993102151976, -10.61191736255029, -11.527606517574213, 21.728476377376904, 6.845566101415193, -23.104609316091068, -14.200345754390845, 10.879095171491032, -9.685438875045532, 12.208787272115902, -1.8780547590196464, -2.678131312637231, -24.673571007768548, 39.557939380774926, -5.919637018067164, 37.05420781722482, 11.931429047071315, -8.013761209348447, -7.57165913033076, -12.051174190650334, 34.525871959019625, -4.309166621080581, 40.260634674089225], "policy_predator_policy_reward": [-12.384188832108844, 1.8723479280387636, -18.586760798699636, -3.0354770430048283, 25.09291313248358, 15.731447295008952, 12.480009990794414, -2.4094422688296433, -5.85014635414489, -6.063146823895341, -22.98567782717149, -10.993656573284579, 9.985604085604955, 4.593111068473387, -3.2659392073053617, 6.556168726004897, 8.198023030591358, 5.891067275356763, 8.067990221309186, 11.65870735755984, 10.356188560035989, 3.556640527940395, 11.300145573090074, 17.911446058594436, 2.803319496907072, 13.167729211756301, -2.027441367777808, 9.298926504823928, -4.929656591058002, 13.127268838343584, -14.80941699346409, -18.99619254205564, -19.154576212053207, 5.515910915820712, 19.6860277146767, -3.8825683715504837, 13.639265723735548, 3.7561504835136788, -14.11347535950443, 7.080450842023836, 3.596680164991639, -0.8780062343130197, 6.817754674684744, 2.367905686767461, 13.451632857134388, -36.43826202340203, 5.982046313893953, 2.636878727628389, 4.941815580256019, -1.6158412152691177, -4.541315778655623, -8.57002532848578, -6.761698317764029, 6.603617522863535, 13.01360611801206, -13.90845743480632, 12.783844416610606, 26.645650686231956, 12.46766658856059, -13.401807891523447, -15.196514931385561, -9.452308264129691, -34.321715150652174, -1.962017133954952, 3.297461304853302, -5.504123860721734, -17.398230266743084, -16.659022433561027, -14.527600781326818, -10.653405022826032, 9.295124755187201, 10.96212546047698, -27.634161432987415, -8.317277951962343, -17.62051725846851, -4.512816011489431, 12.06195349065612, -7.379072210562775, -2.5939733499474418, 18.714289880954585, -4.046076189910899, -8.805712441841884, 11.606317597845077, 12.963368800345318, -8.716226431246003, 5.1252637579431415, -11.454016633153067, 24.374121714532336, 13.429619175113444, -5.967988801994917, -0.5155504024269568, 19.09791381108671, 16.000456144062838, -13.27899017829101, -15.890579221294026, -36.01585973254567, 9.701591607445344, -5.384086648571799, -24.854203263119096, 29.130292650736678, 0.5614021541133738, 39.62213314342315, -2.0874944821589914, 21.66134761336011, 23.027184131971392, -9.46983709526016, -10.740750122669088, -12.426698296543819, 4.214847331580154, 12.705013192116844, 12.13645610143958, -9.200400233441743, -7.133149767077963, -20.29281181582801, 1.1868559385655129, 1.6846108472191048, 2.762697491274322, -2.870217233821215, 8.3210274170903, 2.5835837546425893, 21.190041160853898, 24.282206760329977, 28.548465102121785, -54.46701910139169, -27.745345087381978, -36.46145395355102, 16.167620964273773, 15.244251465597934, -13.652961375670225, -34.036701592275556, -38.824555926058395, -38.30136593334061, -4.723667872905416, -14.802208111628808, -16.26841115667979, 9.121014417327292, -2.5245992519450517, 17.444868462663102, 28.01160091075443, -10.32637695385931, 5.029753434097172, 19.427659211388605, 21.00958134208395, -4.283717981521562, -26.66805217758516, -34.38854618181123, -42.52101751766245, 14.848562288361531, 12.880567293394673, -14.801629718514455, -40.17869541433511, -40.32732407522132, -40.27588453271115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7642350153437527, "mean_inference_ms": 1.6741765443226546, "mean_action_processing_ms": 0.295221190650376, "mean_env_wait_ms": 1.1416480776900628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007900069741641773, "StateBufferConnector_ms": 0.004625787921980315, "ViewRequirementAgentConnector_ms": 0.1425633243485993}, "num_episodes": 11, "episode_return_max": 49.34714201553713, "episode_return_min": -80.52126934817855, "episode_return_mean": -3.6078026715906604}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.7343492663468, "num_env_steps_trained_throughput_per_sec": 288.7343492663468, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 13960.857, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13960.743, "sample_time_ms": 1798.173, "learn_time_ms": 12134.624, "learn_throughput": 329.635, "synch_weights_time_ms": 25.359}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "9a319_00000", "date": "2024-08-10_18-49-26", "timestamp": 1723330166, "time_this_iter_s": 13.881808996200562, "time_total_s": 69.94385504722595, "pid": 68380, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 3, "grid_size": 50, "max_steps": 400, "screen_size": 600, "render_mode": "human"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3be8a83a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 69.94385504722595, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 43.2, "ram_util_percent": 82.185}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.360047039368474, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.7213540552355715, "policy_loss": -0.001484738268399469, "vf_loss": 5.722082461025698, "vf_explained_var": 0.010650595663287115, "kl": 0.003781696127398858, "entropy": 1.576779783659793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 15510.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.134258409682661, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.374271650115649, "policy_loss": -0.008480045520021426, "vf_loss": 4.380047000447909, "vf_explained_var": 0.130324316645662, "kl": 0.013523413510971713, "entropy": 1.3320338836560646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 49.34714201553713, "episode_reward_min": -80.52126934817855, "episode_reward_mean": -9.038949654783025, "episode_len_mean": 362.3114754098361, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 22101, "policy_reward_min": {"prey_policy": -24.673571007768548, "predator_policy": -54.46701910139169}, "policy_reward_max": {"prey_policy": 40.260634674089225, "predator_policy": 39.62213314342315}, "policy_reward_mean": {"prey_policy": 4.519474827391516, "predator_policy": -4.519474827391517}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.399067801846464, 25.19258892299178, 2.81361424521326, -26.694987482900927, 7.541850631181996, 13.763506021302002, 20.055257425936666, 21.845488106416607, 9.29573822725704, 11.664359168073004, -35.306790498381964, 14.212913505964641, 2.187960565163185, 6.5327498484682955, 15.091528812391044, -18.546224654586464, -0.8102276091124914, -5.818737415590853, 7.925995399877564, 17.14100625551274, -39.31369223077834, -2.779119793215589, -32.3899023210873, 6.402563461892105, -35.71463776227885, 0.1133768457359583, 8.049493560730827, 10.50931597089901, -10.029986204303945, 21.22383472510054, 23.055213035148405, -43.45695275475375, -13.691132202830376, 46.209218632182115, 28.400691508781666, -21.758190342982044, 19.370877750091047, -24.41757454423179, 3.7561095180392927, 5.3562626252744625, 49.34714201553713, -79.11587876154965, 11.839274036134336, -74.10841563444947, -23.86285809414266, 16.027522418696893, 15.143318260661523, 24.102348381300658, -69.0517439180392, 8.61833324216117, -80.52126934817855, -18.358113708956523, 25.67853083813436, -64.35037577967717, -55.27201791840516, -62.555361768470036, -7.016351094798008, 0.3392619748572845, -73.6618543574071, -62.61175331018897, -49.56995756572956], "episode_lengths": [400, 400, 400, 400, 400, 400, 271, 85, 400, 96, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 307, 400, 36, 400, 400, 400, 400, 400, 400, 38, 60, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [9.699533900923235, -12.59629446149588, -1.4068071226066277, 13.347493741450467, -3.7709253155909943, -6.881753010651001, -10.027628712968326, -10.9227440532083, -4.6478691136285235, -5.832179584036503, 17.65339524919098, -7.106456752982309, -1.093980282581596, -3.26637492423415, -7.545764406195533, 9.27311232729323, 0.4051138045562521, 2.9093687077954242, -3.9629976999387835, -8.570503127756359, 19.65684611538915, 1.3895598966077949, 16.194951160543646, -3.2012817309460595, 17.857318881139424, -0.05668842286797138, -4.024746780365412, -5.254657985449508, 5.014993102151976, -10.61191736255029, -11.527606517574213, 21.728476377376904, 6.845566101415193, -23.104609316091068, -14.200345754390845, 10.879095171491032, -9.685438875045532, 12.208787272115902, -1.8780547590196464, -2.678131312637231, -24.673571007768548, 39.557939380774926, -5.919637018067164, 37.05420781722482, 11.931429047071315, -8.013761209348447, -7.57165913033076, -12.051174190650334, 34.525871959019625, -4.309166621080581, 40.260634674089225, 9.179056854478254, -12.839265419067138, 32.17518788983856, 27.63600895920259, 31.277680884235018, 3.508175547399004, -0.16963098742864852, 36.83092717870359, 31.305876655094487, 24.784978782864776], "policy_predator_policy_reward": [-12.384188832108844, 1.8723479280387636, -18.586760798699636, -3.0354770430048283, 25.09291313248358, 15.731447295008952, 12.480009990794414, -2.4094422688296433, -5.85014635414489, -6.063146823895341, -22.98567782717149, -10.993656573284579, 9.985604085604955, 4.593111068473387, -3.2659392073053617, 6.556168726004897, 8.198023030591358, 5.891067275356763, 8.067990221309186, 11.65870735755984, 10.356188560035989, 3.556640527940395, 11.300145573090074, 17.911446058594436, 2.803319496907072, 13.167729211756301, -2.027441367777808, 9.298926504823928, -4.929656591058002, 13.127268838343584, -14.80941699346409, -18.99619254205564, -19.154576212053207, 5.515910915820712, 19.6860277146767, -3.8825683715504837, 13.639265723735548, 3.7561504835136788, -14.11347535950443, 7.080450842023836, 3.596680164991639, -0.8780062343130197, 6.817754674684744, 2.367905686767461, 13.451632857134388, -36.43826202340203, 5.982046313893953, 2.636878727628389, 4.941815580256019, -1.6158412152691177, -4.541315778655623, -8.57002532848578, -6.761698317764029, 6.603617522863535, 13.01360611801206, -13.90845743480632, 12.783844416610606, 26.645650686231956, 12.46766658856059, -13.401807891523447, -15.196514931385561, -9.452308264129691, -34.321715150652174, -1.962017133954952, 3.297461304853302, -5.504123860721734, -17.398230266743084, -16.659022433561027, -14.527600781326818, -10.653405022826032, 9.295124755187201, 10.96212546047698, -27.634161432987415, -8.317277951962343, -17.62051725846851, -4.512816011489431, 12.06195349065612, -7.379072210562775, -2.5939733499474418, 18.714289880954585, -4.046076189910899, -8.805712441841884, 11.606317597845077, 12.963368800345318, -8.716226431246003, 5.1252637579431415, -11.454016633153067, 24.374121714532336, 13.429619175113444, -5.967988801994917, -0.5155504024269568, 19.09791381108671, 16.000456144062838, -13.27899017829101, -15.890579221294026, -36.01585973254567, 9.701591607445344, -5.384086648571799, -24.854203263119096, 29.130292650736678, 0.5614021541133738, 39.62213314342315, -2.0874944821589914, 21.66134761336011, 23.027184131971392, -9.46983709526016, -10.740750122669088, -12.426698296543819, 4.214847331580154, 12.705013192116844, 12.13645610143958, -9.200400233441743, -7.133149767077963, -20.29281181582801, 1.1868559385655129, 1.6846108472191048, 2.762697491274322, -2.870217233821215, 8.3210274170903, 2.5835837546425893, 21.190041160853898, 24.282206760329977, 28.548465102121785, -54.46701910139169, -27.745345087381978, -36.46145395355102, 16.167620964273773, 15.244251465597934, -13.652961375670225, -34.036701592275556, -38.824555926058395, -38.30136593334061, -4.723667872905416, -14.802208111628808, -16.26841115667979, 9.121014417327292, -2.5245992519450517, 17.444868462663102, 28.01160091075443, -10.32637695385931, 5.029753434097172, 19.427659211388605, 21.00958134208395, -4.283717981521562, -26.66805217758516, -34.38854618181123, -42.52101751766245, 14.848562288361531, 12.880567293394673, -14.801629718514455, -40.17869541433511, -40.32732407522132, -40.27588453271115, -9.233580130910557, -5.222530441501821, -13.081059991022386, -19.387578300235315, 27.61129700003669, 30.29407755740001, -24.40028343212422, -26.97558325237746, -45.14969698501402, -6.462131613312103, -37.50189961380639, -38.94399565048927, -19.670071334201864, -38.69819280965345, -35.46477850884973, 0.8382553361713576, -10.151341101450818, -1.2114408769175533, 8.29409242511656, -10.685104988339948, 2.8999055255093396, -41.805418988356536, -35.48863315443053, -33.19872939332381, -32.96673915010559, -31.11363351692829, -29.837257298249607, -21.660280037279392, -5.654351404352084, -47.04030490696285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7668499548146333, "mean_inference_ms": 1.6786827632828762, "mean_action_processing_ms": 0.2950975896492137, "mean_env_wait_ms": 1.14445783048434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011164047678963084, "StateBufferConnector_ms": 0.005817804180207799, "ViewRequirementAgentConnector_ms": 0.15945395485299532}, "num_episodes": 10, "episode_return_max": 49.34714201553713, "episode_return_min": -80.52126934817855, "episode_return_mean": -9.038949654783025}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.4257470191887, "num_env_steps_trained_throughput_per_sec": 307.4257470191887, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 13802.595, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13802.494, "sample_time_ms": 1850.433, "learn_time_ms": 11925.901, "learn_throughput": 335.404, "synch_weights_time_ms": 23.907}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "9a319_00000", "date": "2024-08-10_18-49-39", "timestamp": 1723330179, "time_this_iter_s": 13.037184000015259, "time_total_s": 82.98103904724121, "pid": 68380, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 3, "grid_size": 50, "max_steps": 400, "screen_size": 600, "render_mode": "human"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3be8a8430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 82.98103904724121, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 36.70555555555555, "ram_util_percent": 82.67222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.350888759817215, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.012860835697634, "policy_loss": -0.0030559757197645646, "vf_loss": 6.015148568829746, "vf_explained_var": 0.10415459294268425, "kl": 0.007682407509504617, "entropy": 1.5747689979296204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 18330.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.031125832286974, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.626447866360347, "policy_loss": -0.008097883655379216, "vf_loss": 4.632597548266252, "vf_explained_var": 0.15177192532767853, "kl": 0.009740976542899476, "entropy": 1.3209525535504023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 49.34714201553713, "episode_reward_min": -80.52126934817855, "episode_reward_mean": -11.709764608276235, "episode_len_mean": 367.15714285714284, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 25701, "policy_reward_min": {"prey_policy": -24.673571007768548, "predator_policy": -54.46701910139169}, "policy_reward_max": {"prey_policy": 40.260634674089225, "predator_policy": 39.62213314342315}, "policy_reward_mean": {"prey_policy": 5.854882304138118, "predator_policy": -5.854882304138117}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.399067801846464, 25.19258892299178, 2.81361424521326, -26.694987482900927, 7.541850631181996, 13.763506021302002, 20.055257425936666, 21.845488106416607, 9.29573822725704, 11.664359168073004, -35.306790498381964, 14.212913505964641, 2.187960565163185, 6.5327498484682955, 15.091528812391044, -18.546224654586464, -0.8102276091124914, -5.818737415590853, 7.925995399877564, 17.14100625551274, -39.31369223077834, -2.779119793215589, -32.3899023210873, 6.402563461892105, -35.71463776227885, 0.1133768457359583, 8.049493560730827, 10.50931597089901, -10.029986204303945, 21.22383472510054, 23.055213035148405, -43.45695275475375, -13.691132202830376, 46.209218632182115, 28.400691508781666, -21.758190342982044, 19.370877750091047, -24.41757454423179, 3.7561095180392927, 5.3562626252744625, 49.34714201553713, -79.11587876154965, 11.839274036134336, -74.10841563444947, -23.86285809414266, 16.027522418696893, 15.143318260661523, 24.102348381300658, -69.0517439180392, 8.61833324216117, -80.52126934817855, -18.358113708956523, 25.67853083813436, -64.35037577967717, -55.27201791840516, -62.555361768470036, -7.016351094798008, 0.3392619748572845, -73.6618543574071, -62.61175331018897, -49.56995756572956, -76.37543512569903, -9.384973303394897, -13.302754968655217, -73.39470318096915, 13.79278656364447, -56.482106136126184, -58.13038375505078, -7.606150726449799, 12.576126995128716], "episode_lengths": [400, 400, 400, 400, 400, 400, 271, 85, 400, 96, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 307, 400, 36, 400, 400, 400, 400, 400, 400, 38, 60, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [9.699533900923235, -12.59629446149588, -1.4068071226066277, 13.347493741450467, -3.7709253155909943, -6.881753010651001, -10.027628712968326, -10.9227440532083, -4.6478691136285235, -5.832179584036503, 17.65339524919098, -7.106456752982309, -1.093980282581596, -3.26637492423415, -7.545764406195533, 9.27311232729323, 0.4051138045562521, 2.9093687077954242, -3.9629976999387835, -8.570503127756359, 19.65684611538915, 1.3895598966077949, 16.194951160543646, -3.2012817309460595, 17.857318881139424, -0.05668842286797138, -4.024746780365412, -5.254657985449508, 5.014993102151976, -10.61191736255029, -11.527606517574213, 21.728476377376904, 6.845566101415193, -23.104609316091068, -14.200345754390845, 10.879095171491032, -9.685438875045532, 12.208787272115902, -1.8780547590196464, -2.678131312637231, -24.673571007768548, 39.557939380774926, -5.919637018067164, 37.05420781722482, 11.931429047071315, -8.013761209348447, -7.57165913033076, -12.051174190650334, 34.525871959019625, -4.309166621080581, 40.260634674089225, 9.179056854478254, -12.839265419067138, 32.17518788983856, 27.63600895920259, 31.277680884235018, 3.508175547399004, -0.16963098742864852, 36.83092717870359, 31.305876655094487, 24.784978782864776, 38.18771756284947, 4.692486651697449, 6.651377484327602, 36.697351590484516, -6.896393281822246, 28.24105306806309, 29.065191877525372, 3.803075363224904, -6.288063497564358], "policy_predator_policy_reward": [-12.384188832108844, 1.8723479280387636, -18.586760798699636, -3.0354770430048283, 25.09291313248358, 15.731447295008952, 12.480009990794414, -2.4094422688296433, -5.85014635414489, -6.063146823895341, -22.98567782717149, -10.993656573284579, 9.985604085604955, 4.593111068473387, -3.2659392073053617, 6.556168726004897, 8.198023030591358, 5.891067275356763, 8.067990221309186, 11.65870735755984, 10.356188560035989, 3.556640527940395, 11.300145573090074, 17.911446058594436, 2.803319496907072, 13.167729211756301, -2.027441367777808, 9.298926504823928, -4.929656591058002, 13.127268838343584, -14.80941699346409, -18.99619254205564, -19.154576212053207, 5.515910915820712, 19.6860277146767, -3.8825683715504837, 13.639265723735548, 3.7561504835136788, -14.11347535950443, 7.080450842023836, 3.596680164991639, -0.8780062343130197, 6.817754674684744, 2.367905686767461, 13.451632857134388, -36.43826202340203, 5.982046313893953, 2.636878727628389, 4.941815580256019, -1.6158412152691177, -4.541315778655623, -8.57002532848578, -6.761698317764029, 6.603617522863535, 13.01360611801206, -13.90845743480632, 12.783844416610606, 26.645650686231956, 12.46766658856059, -13.401807891523447, -15.196514931385561, -9.452308264129691, -34.321715150652174, -1.962017133954952, 3.297461304853302, -5.504123860721734, -17.398230266743084, -16.659022433561027, -14.527600781326818, -10.653405022826032, 9.295124755187201, 10.96212546047698, -27.634161432987415, -8.317277951962343, -17.62051725846851, -4.512816011489431, 12.06195349065612, -7.379072210562775, -2.5939733499474418, 18.714289880954585, -4.046076189910899, -8.805712441841884, 11.606317597845077, 12.963368800345318, -8.716226431246003, 5.1252637579431415, -11.454016633153067, 24.374121714532336, 13.429619175113444, -5.967988801994917, -0.5155504024269568, 19.09791381108671, 16.000456144062838, -13.27899017829101, -15.890579221294026, -36.01585973254567, 9.701591607445344, -5.384086648571799, -24.854203263119096, 29.130292650736678, 0.5614021541133738, 39.62213314342315, -2.0874944821589914, 21.66134761336011, 23.027184131971392, -9.46983709526016, -10.740750122669088, -12.426698296543819, 4.214847331580154, 12.705013192116844, 12.13645610143958, -9.200400233441743, -7.133149767077963, -20.29281181582801, 1.1868559385655129, 1.6846108472191048, 2.762697491274322, -2.870217233821215, 8.3210274170903, 2.5835837546425893, 21.190041160853898, 24.282206760329977, 28.548465102121785, -54.46701910139169, -27.745345087381978, -36.46145395355102, 16.167620964273773, 15.244251465597934, -13.652961375670225, -34.036701592275556, -38.824555926058395, -38.30136593334061, -4.723667872905416, -14.802208111628808, -16.26841115667979, 9.121014417327292, -2.5245992519450517, 17.444868462663102, 28.01160091075443, -10.32637695385931, 5.029753434097172, 19.427659211388605, 21.00958134208395, -4.283717981521562, -26.66805217758516, -34.38854618181123, -42.52101751766245, 14.848562288361531, 12.880567293394673, -14.801629718514455, -40.17869541433511, -40.32732407522132, -40.27588453271115, -9.233580130910557, -5.222530441501821, -13.081059991022386, -19.387578300235315, 27.61129700003669, 30.29407755740001, -24.40028343212422, -26.97558325237746, -45.14969698501402, -6.462131613312103, -37.50189961380639, -38.94399565048927, -19.670071334201864, -38.69819280965345, -35.46477850884973, 0.8382553361713576, -10.151341101450818, -1.2114408769175533, 8.29409242511656, -10.685104988339948, 2.8999055255093396, -41.805418988356536, -35.48863315443053, -33.19872939332381, -32.96673915010559, -31.11363351692829, -29.837257298249607, -21.660280037279392, -5.654351404352084, -47.04030490696285, -44.02367395004685, -36.41796474341146, -34.121513995090055, 6.081760998217682, -4.738872442085039, -15.42034851122499, -5.786911598670127, -9.7401636803982, -4.427057173914488, -41.275463474655695, -31.70626276504737, -37.110328531750476, 5.0344239409403215, 8.83692853881464, 6.8178273657117, -31.978079226404567, -19.994571819971824, -32.750508157812774, -12.011600073328758, -28.751692312532114, -46.432283246715336, -5.542959024094351, -0.386933543840307, -5.479333521740056, -2.9475339389631436, 17.980255813209624, 3.831468618446607]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7702429658217749, "mean_inference_ms": 1.6840722251027431, "mean_action_processing_ms": 0.2953828658650934, "mean_env_wait_ms": 1.1434281000306308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010928426470075334, "StateBufferConnector_ms": 0.0057675157274518695, "ViewRequirementAgentConnector_ms": 0.16728707722255162}, "num_episodes": 9, "episode_return_max": 49.34714201553713, "episode_return_min": -80.52126934817855, "episode_return_mean": -11.709764608276235}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.6834171720263, "num_env_steps_trained_throughput_per_sec": 298.6834171720263, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 13743.955, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13743.863, "sample_time_ms": 1878.676, "learn_time_ms": 11838.219, "learn_throughput": 337.889, "synch_weights_time_ms": 24.81}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "9a319_00000", "date": "2024-08-10_18-49-52", "timestamp": 1723330192, "time_this_iter_s": 13.403434991836548, "time_total_s": 96.38447403907776, "pid": 68380, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 3, "grid_size": 50, "max_steps": 400, "screen_size": 600, "render_mode": "human"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3be8b1dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 96.38447403907776, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 42.47368421052632, "ram_util_percent": 82.33684210526314}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.624238969301078, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.3835560866281496, "policy_loss": -0.009639775827989404, "vf_loss": 5.391168336073558, "vf_explained_var": 0.2299149897715724, "kl": 0.020275318647943928, "entropy": 1.5602005102955703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 21150.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5247089251254997, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.3863593647877375, "policy_loss": -0.006906027381774038, "vf_loss": 4.391288827608029, "vf_explained_var": 0.32837158944457767, "kl": 0.009882805365320794, "entropy": 1.3418170891702175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 49.34714201553713, "episode_reward_min": -80.52126934817855, "episode_reward_mean": -14.171991012770293, "episode_len_mean": 370.8987341772152, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 29301, "policy_reward_min": {"prey_policy": -24.673571007768548, "predator_policy": -54.46701910139169}, "policy_reward_max": {"prey_policy": 40.260634674089225, "predator_policy": 39.62213314342315}, "policy_reward_mean": {"prey_policy": 7.085995506385145, "predator_policy": -7.085995506385146}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.399067801846464, 25.19258892299178, 2.81361424521326, -26.694987482900927, 7.541850631181996, 13.763506021302002, 20.055257425936666, 21.845488106416607, 9.29573822725704, 11.664359168073004, -35.306790498381964, 14.212913505964641, 2.187960565163185, 6.5327498484682955, 15.091528812391044, -18.546224654586464, -0.8102276091124914, -5.818737415590853, 7.925995399877564, 17.14100625551274, -39.31369223077834, -2.779119793215589, -32.3899023210873, 6.402563461892105, -35.71463776227885, 0.1133768457359583, 8.049493560730827, 10.50931597089901, -10.029986204303945, 21.22383472510054, 23.055213035148405, -43.45695275475375, -13.691132202830376, 46.209218632182115, 28.400691508781666, -21.758190342982044, 19.370877750091047, -24.41757454423179, 3.7561095180392927, 5.3562626252744625, 49.34714201553713, -79.11587876154965, 11.839274036134336, -74.10841563444947, -23.86285809414266, 16.027522418696893, 15.143318260661523, 24.102348381300658, -69.0517439180392, 8.61833324216117, -80.52126934817855, -18.358113708956523, 25.67853083813436, -64.35037577967717, -55.27201791840516, -62.555361768470036, -7.016351094798008, 0.3392619748572845, -73.6618543574071, -62.61175331018897, -49.56995756572956, -76.37543512569903, -9.384973303394897, -13.302754968655217, -73.39470318096915, 13.79278656364447, -56.482106136126184, -58.13038375505078, -7.606150726449799, 12.576126995128716, -49.74743815463084, -66.10610524830417, -43.995397764246924, -39.2628430187452, -51.83359712964816, -24.252784022019164, 17.995004688575545, 4.307668714954476, -47.008275495452246], "episode_lengths": [400, 400, 400, 400, 400, 400, 271, 85, 400, 96, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 307, 400, 36, 400, 400, 400, 400, 400, 400, 38, 60, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [9.699533900923235, -12.59629446149588, -1.4068071226066277, 13.347493741450467, -3.7709253155909943, -6.881753010651001, -10.027628712968326, -10.9227440532083, -4.6478691136285235, -5.832179584036503, 17.65339524919098, -7.106456752982309, -1.093980282581596, -3.26637492423415, -7.545764406195533, 9.27311232729323, 0.4051138045562521, 2.9093687077954242, -3.9629976999387835, -8.570503127756359, 19.65684611538915, 1.3895598966077949, 16.194951160543646, -3.2012817309460595, 17.857318881139424, -0.05668842286797138, -4.024746780365412, -5.254657985449508, 5.014993102151976, -10.61191736255029, -11.527606517574213, 21.728476377376904, 6.845566101415193, -23.104609316091068, -14.200345754390845, 10.879095171491032, -9.685438875045532, 12.208787272115902, -1.8780547590196464, -2.678131312637231, -24.673571007768548, 39.557939380774926, -5.919637018067164, 37.05420781722482, 11.931429047071315, -8.013761209348447, -7.57165913033076, -12.051174190650334, 34.525871959019625, -4.309166621080581, 40.260634674089225, 9.179056854478254, -12.839265419067138, 32.17518788983856, 27.63600895920259, 31.277680884235018, 3.508175547399004, -0.16963098742864852, 36.83092717870359, 31.305876655094487, 24.784978782864776, 38.18771756284947, 4.692486651697449, 6.651377484327602, 36.697351590484516, -6.896393281822246, 28.24105306806309, 29.065191877525372, 3.803075363224904, -6.288063497564358, 24.87371907731541, 33.05305262415204, 21.997698882123455, 19.631421509372604, 25.916798564824088, 12.126392011009568, -8.997502344287751, -2.1538343574772405, 23.504137747726123], "policy_predator_policy_reward": [-12.384188832108844, 1.8723479280387636, -18.586760798699636, -3.0354770430048283, 25.09291313248358, 15.731447295008952, 12.480009990794414, -2.4094422688296433, -5.85014635414489, -6.063146823895341, -22.98567782717149, -10.993656573284579, 9.985604085604955, 4.593111068473387, -3.2659392073053617, 6.556168726004897, 8.198023030591358, 5.891067275356763, 8.067990221309186, 11.65870735755984, 10.356188560035989, 3.556640527940395, 11.300145573090074, 17.911446058594436, 2.803319496907072, 13.167729211756301, -2.027441367777808, 9.298926504823928, -4.929656591058002, 13.127268838343584, -14.80941699346409, -18.99619254205564, -19.154576212053207, 5.515910915820712, 19.6860277146767, -3.8825683715504837, 13.639265723735548, 3.7561504835136788, -14.11347535950443, 7.080450842023836, 3.596680164991639, -0.8780062343130197, 6.817754674684744, 2.367905686767461, 13.451632857134388, -36.43826202340203, 5.982046313893953, 2.636878727628389, 4.941815580256019, -1.6158412152691177, -4.541315778655623, -8.57002532848578, -6.761698317764029, 6.603617522863535, 13.01360611801206, -13.90845743480632, 12.783844416610606, 26.645650686231956, 12.46766658856059, -13.401807891523447, -15.196514931385561, -9.452308264129691, -34.321715150652174, -1.962017133954952, 3.297461304853302, -5.504123860721734, -17.398230266743084, -16.659022433561027, -14.527600781326818, -10.653405022826032, 9.295124755187201, 10.96212546047698, -27.634161432987415, -8.317277951962343, -17.62051725846851, -4.512816011489431, 12.06195349065612, -7.379072210562775, -2.5939733499474418, 18.714289880954585, -4.046076189910899, -8.805712441841884, 11.606317597845077, 12.963368800345318, -8.716226431246003, 5.1252637579431415, -11.454016633153067, 24.374121714532336, 13.429619175113444, -5.967988801994917, -0.5155504024269568, 19.09791381108671, 16.000456144062838, -13.27899017829101, -15.890579221294026, -36.01585973254567, 9.701591607445344, -5.384086648571799, -24.854203263119096, 29.130292650736678, 0.5614021541133738, 39.62213314342315, -2.0874944821589914, 21.66134761336011, 23.027184131971392, -9.46983709526016, -10.740750122669088, -12.426698296543819, 4.214847331580154, 12.705013192116844, 12.13645610143958, -9.200400233441743, -7.133149767077963, -20.29281181582801, 1.1868559385655129, 1.6846108472191048, 2.762697491274322, -2.870217233821215, 8.3210274170903, 2.5835837546425893, 21.190041160853898, 24.282206760329977, 28.548465102121785, -54.46701910139169, -27.745345087381978, -36.46145395355102, 16.167620964273773, 15.244251465597934, -13.652961375670225, -34.036701592275556, -38.824555926058395, -38.30136593334061, -4.723667872905416, -14.802208111628808, -16.26841115667979, 9.121014417327292, -2.5245992519450517, 17.444868462663102, 28.01160091075443, -10.32637695385931, 5.029753434097172, 19.427659211388605, 21.00958134208395, -4.283717981521562, -26.66805217758516, -34.38854618181123, -42.52101751766245, 14.848562288361531, 12.880567293394673, -14.801629718514455, -40.17869541433511, -40.32732407522132, -40.27588453271115, -9.233580130910557, -5.222530441501821, -13.081059991022386, -19.387578300235315, 27.61129700003669, 30.29407755740001, -24.40028343212422, -26.97558325237746, -45.14969698501402, -6.462131613312103, -37.50189961380639, -38.94399565048927, -19.670071334201864, -38.69819280965345, -35.46477850884973, 0.8382553361713576, -10.151341101450818, -1.2114408769175533, 8.29409242511656, -10.685104988339948, 2.8999055255093396, -41.805418988356536, -35.48863315443053, -33.19872939332381, -32.96673915010559, -31.11363351692829, -29.837257298249607, -21.660280037279392, -5.654351404352084, -47.04030490696285, -44.02367395004685, -36.41796474341146, -34.121513995090055, 6.081760998217682, -4.738872442085039, -15.42034851122499, -5.786911598670127, -9.7401636803982, -4.427057173914488, -41.275463474655695, -31.70626276504737, -37.110328531750476, 5.0344239409403215, 8.83692853881464, 6.8178273657117, -31.978079226404567, -19.994571819971824, -32.750508157812774, -12.011600073328758, -28.751692312532114, -46.432283246715336, -5.542959024094351, -0.386933543840307, -5.479333521740056, -2.9475339389631436, 17.980255813209624, 3.831468618446607, -11.706314129391522, -50.68421265017036, -12.230630452384325, -28.025595781790145, -27.593891648514706, -43.53967044215139, -22.571544501392736, -22.337954885518762, -21.083597259458916, -27.533595876261792, -23.66023447795606, -7.7004341738999855, -17.396168837186238, -32.00827808015002, -28.34594877713605, -8.961921629292476, -25.066451156880383, -2.350803246855847, 16.910814560391334, 0.40878103686819145, 9.672911435603766, -11.319526679484419, 25.372869926610946, -7.5918401746947985, -14.197330562002051, -15.039028613082607, -41.27605406809367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7720148297051235, "mean_inference_ms": 1.686908407706485, "mean_action_processing_ms": 0.29528212687481037, "mean_env_wait_ms": 1.141674747790547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010747396493259865, "StateBufferConnector_ms": 0.005626980262466624, "ViewRequirementAgentConnector_ms": 0.16127085383934311}, "num_episodes": 9, "episode_return_max": 49.34714201553713, "episode_return_min": -80.52126934817855, "episode_return_mean": -14.171991012770293}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.7058237774214, "num_env_steps_trained_throughput_per_sec": 322.7058237774214, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 13575.36, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13575.276, "sample_time_ms": 1862.681, "learn_time_ms": 11687.21, "learn_throughput": 342.254, "synch_weights_time_ms": 23.434}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "9a319_00000", "date": "2024-08-10_18-50-05", "timestamp": 1723330205, "time_this_iter_s": 12.400427103042603, "time_total_s": 108.78490114212036, "pid": 68380, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 3, "grid_size": 50, "max_steps": 400, "screen_size": 600, "render_mode": "human"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3be8b4d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 108.78490114212036, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 33.39411764705883, "ram_util_percent": 81.62352941176471}}
